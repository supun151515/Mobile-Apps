(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["vendor"],{

/***/ "../node_modules/css-loader/dist/cjs.js?!../node_modules/nativescript-theme-core/css/core.light.css":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../node_modules/css-loader/dist/runtime/api.js")(false);
// Module
exports.push([module.i, "/*!\r\n * NativeScript Theme v1.0.6 (https://nativescript.org)\r\n * Copyright 2016-2016 The Theme Authors\r\n * Copyright 2016-2016 Telerik\r\n * Licensed under MIT (https://github.com/NativeScript/theme/blob/master/LICENSE)\r\n */.c-white{color:#fff}.c-bg-white{background-color:#fff}.c-black{color:#000}.c-bg-black{background-color:#000}.c-aqua{color:#00caab}.c-bg-aqua{background-color:#00caab}.c-blue{color:#3d5afe}.c-bg-blue{background-color:#3d5afe}.c-charcoal{color:#303030}.c-bg-charcoal{background-color:#303030}.c-brown{color:#795548}.c-bg-brown{background-color:#795548}.c-forest{color:#006968}.c-bg-forest{background-color:#006968}.c-grey{color:#e0e0e0}.c-bg-grey{background-color:#e0e0e0}.c-grey-light{color:#bababa}.c-bg-grey-light{background-color:#bababa}.c-grey-dark{color:#5c687c}.c-bg-grey-dark{background-color:#5c687c}.c-purple{color:#8130ff}.c-bg-purple{background-color:#8130ff}.c-lemon{color:#ffea00}.c-bg-lemon{background-color:#ffea00}.c-lime{color:#aee406}.c-bg-lime{background-color:#aee406}.c-orange{color:#f57c00}.c-bg-orange{background-color:#f57c00}.c-ruby{color:#ff1744}.c-bg-ruby{background-color:#ff1744}.c-sky{color:#30bcff}.c-bg-sky{background-color:#30bcff}.w-full{width:100%}.w-100{width:100}.h-full{height:100%}.h-100{height:100}.m-0{margin:0}.m-t-0{margin-top:0}.m-r-0{margin-right:0}.m-b-0{margin-bottom:0}.m-l-0{margin-left:0}.m-x-0{margin-right:0;margin-left:0}.m-y-0{margin-top:0;margin-bottom:0}.m-2{margin:2}.m-t-2{margin-top:2}.m-r-2{margin-right:2}.m-b-2{margin-bottom:2}.m-l-2{margin-left:2}.m-x-2{margin-right:2;margin-left:2}.m-y-2{margin-top:2;margin-bottom:2}.m-4{margin:4}.m-t-4{margin-top:4}.m-r-4{margin-right:4}.m-b-4{margin-bottom:4}.m-l-4{margin-left:4}.m-x-4{margin-right:4;margin-left:4}.m-y-4{margin-top:4;margin-bottom:4}.m-5{margin:5}.m-t-5{margin-top:5}.m-r-5{margin-right:5}.m-b-5{margin-bottom:5}.m-l-5{margin-left:5}.m-x-5{margin-right:5;margin-left:5}.m-y-5{margin-top:5;margin-bottom:5}.m-8{margin:8}.m-t-8{margin-top:8}.m-r-8{margin-right:8}.m-b-8{margin-bottom:8}.m-l-8{margin-left:8}.m-x-8{margin-right:8;margin-left:8}.m-y-8{margin-top:8;margin-bottom:8}.m-10{margin:10}.m-t-10{margin-top:10}.m-r-10{margin-right:10}.m-b-10{margin-bottom:10}.m-l-10{margin-left:10}.m-x-10{margin-right:10;margin-left:10}.m-y-10{margin-top:10;margin-bottom:10}.m-12{margin:12}.m-t-12{margin-top:12}.m-r-12{margin-right:12}.m-b-12{margin-bottom:12}.m-l-12{margin-left:12}.m-x-12{margin-right:12;margin-left:12}.m-y-12{margin-top:12;margin-bottom:12}.m-15{margin:15}.m-t-15{margin-top:15}.m-r-15{margin-right:15}.m-b-15{margin-bottom:15}.m-l-15{margin-left:15}.m-x-15{margin-right:15;margin-left:15}.m-y-15{margin-top:15;margin-bottom:15}.m-16{margin:16}.m-t-16{margin-top:16}.m-r-16{margin-right:16}.m-b-16{margin-bottom:16}.m-l-16{margin-left:16}.m-x-16{margin-right:16;margin-left:16}.m-y-16{margin-top:16;margin-bottom:16}.m-20{margin:20}.m-t-20{margin-top:20}.m-r-20{margin-right:20}.m-b-20{margin-bottom:20}.m-l-20{margin-left:20}.m-x-20{margin-right:20;margin-left:20}.m-y-20{margin-top:20;margin-bottom:20}.m-24{margin:24}.m-t-24{margin-top:24}.m-r-24{margin-right:24}.m-b-24{margin-bottom:24}.m-l-24{margin-left:24}.m-x-24{margin-right:24;margin-left:24}.m-y-24{margin-top:24;margin-bottom:24}.m-25{margin:25}.m-t-25{margin-top:25}.m-r-25{margin-right:25}.m-b-25{margin-bottom:25}.m-l-25{margin-left:25}.m-x-25{margin-right:25;margin-left:25}.m-y-25{margin-top:25;margin-bottom:25}.m-28{margin:28}.m-t-28{margin-top:28}.m-r-28{margin-right:28}.m-b-28{margin-bottom:28}.m-l-28{margin-left:28}.m-x-28{margin-right:28;margin-left:28}.m-y-28{margin-top:28;margin-bottom:28}.m-30{margin:30}.m-t-30{margin-top:30}.m-r-30{margin-right:30}.m-b-30{margin-bottom:30}.m-l-30{margin-left:30}.m-x-30{margin-right:30;margin-left:30}.m-y-30{margin-top:30;margin-bottom:30}.p-0{padding:0}.p-t-0{padding-top:0}.p-r-0{padding-right:0}.p-b-0{padding-bottom:0}.p-l-0{padding-left:0}.p-x-0{padding-right:0;padding-left:0}.p-y-0{padding-top:0;padding-bottom:0}.p-2{padding:2}.p-t-2{padding-top:2}.p-r-2{padding-right:2}.p-b-2{padding-bottom:2}.p-l-2{padding-left:2}.p-x-2{padding-right:2;padding-left:2}.p-y-2{padding-top:2;padding-bottom:2}.p-4{padding:4}.p-t-4{padding-top:4}.p-r-4{padding-right:4}.p-b-4{padding-bottom:4}.p-l-4{padding-left:4}.p-x-4{padding-right:4;padding-left:4}.p-y-4{padding-top:4;padding-bottom:4}.p-5{padding:5}.p-t-5{padding-top:5}.p-r-5{padding-right:5}.p-b-5{padding-bottom:5}.p-l-5{padding-left:5}.p-x-5{padding-right:5;padding-left:5}.p-y-5{padding-top:5;padding-bottom:5}.p-8{padding:8}.p-t-8{padding-top:8}.p-r-8{padding-right:8}.p-b-8{padding-bottom:8}.p-l-8{padding-left:8}.p-x-8{padding-right:8;padding-left:8}.p-y-8{padding-top:8;padding-bottom:8}.p-10{padding:10}.p-t-10{padding-top:10}.p-r-10{padding-right:10}.p-b-10{padding-bottom:10}.p-l-10{padding-left:10}.p-x-10{padding-right:10;padding-left:10}.p-y-10{padding-top:10;padding-bottom:10}.p-12{padding:12}.p-t-12{padding-top:12}.p-r-12{padding-right:12}.p-b-12{padding-bottom:12}.p-l-12{padding-left:12}.p-x-12{padding-right:12;padding-left:12}.p-y-12{padding-top:12;padding-bottom:12}.p-15{padding:15}.p-t-15{padding-top:15}.p-r-15{padding-right:15}.p-b-15{padding-bottom:15}.p-l-15{padding-left:15}.p-x-15{padding-right:15;padding-left:15}.p-y-15{padding-top:15;padding-bottom:15}.p-16{padding:16}.p-t-16{padding-top:16}.p-r-16{padding-right:16}.p-b-16{padding-bottom:16}.p-l-16{padding-left:16}.p-x-16{padding-right:16;padding-left:16}.p-y-16{padding-top:16;padding-bottom:16}.p-20{padding:20}.p-t-20{padding-top:20}.p-r-20{padding-right:20}.p-b-20{padding-bottom:20}.p-l-20{padding-left:20}.p-x-20{padding-right:20;padding-left:20}.p-y-20{padding-top:20;padding-bottom:20}.p-24{padding:24}.p-t-24{padding-top:24}.p-r-24{padding-right:24}.p-b-24{padding-bottom:24}.p-l-24{padding-left:24}.p-x-24{padding-right:24;padding-left:24}.p-y-24{padding-top:24;padding-bottom:24}.p-25{padding:25}.p-t-25{padding-top:25}.p-r-25{padding-right:25}.p-b-25{padding-bottom:25}.p-l-25{padding-left:25}.p-x-25{padding-right:25;padding-left:25}.p-y-25{padding-top:25;padding-bottom:25}.p-28{padding:28}.p-t-28{padding-top:28}.p-r-28{padding-right:28}.p-b-28{padding-bottom:28}.p-l-28{padding-left:28}.p-x-28{padding-right:28;padding-left:28}.p-y-28{padding-top:28;padding-bottom:28}.p-30{padding:30}.p-t-30{padding-top:30}.p-r-30{padding-right:30}.p-b-30{padding-bottom:30}.p-l-30{padding-left:30}.p-x-30{padding-right:30;padding-left:30}.p-y-30{padding-top:30;padding-bottom:30}.hr-light{height:1;background-color:#e0e0e0;width:100%}.hr-dark{height:1;background-color:#303030;width:100%}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.font-weight-normal{font-weight:normal}.font-weight-bold{font-weight:bold}.font-italic{font-style:italic}.t-10{font-size:10}.t-12{font-size:12}.t-14{font-size:14}.t-15{font-size:15}.t-16{font-size:16}.t-17{font-size:17}.t-18{font-size:18}.t-19{font-size:19}.t-20{font-size:20}.t-25{font-size:25}.t-30{font-size:30}.img-rounded{border-radius:5}.img-circle{border-radius:20}.img-thumbnail{border-radius:0}.invisible{visibility:collapse}.pull-left{horizontal-align:left}.pull-right{horizontal-align:right}.m-x-auto{horizontal-align:center}.m-y-auto{vertical-align:center}.text-primary{color:#30bcff}.text-danger{color:#d50000}.text-muted{color:#9e9e9e}.bg-primary{background-color:#30bcff;color:#fff}.bg-danger{background-color:#d50000;color:#fff}.action-bar{background-color:#F8F8F8;color:#212121}.action-bar .action-bar-title{font-weight:bold;font-size:17;vertical-align:center}.action-bar .action-item{font-weight:normal}.activity-indicator{color:#30bcff;width:30;height:30}.btn{color:#30bcff;background-color:transparent;min-height:36;min-width:64;padding:10 10 10 10;font-size:18;margin:8 16 8 16}.btn.btn-active:highlighted{color:#fff;background-color:#c0ebff}.btn-primary{background-color:#30bcff;border-color:#30bcff;color:#fff}.btn-primary.btn-active:highlighted{background-color:#01a0ec;border-color:#01a0ec}.btn-primary.btn-aqua{background-color:#00caab}.btn-primary.btn-blue{background-color:#3d5afe}.btn-primary.btn-brown{background-color:#795548}.btn-primary.btn-forest{background-color:#006968}.btn-primary.btn-grey{background-color:#5c687c}.btn-primary.btn-lemon{background-color:#ffea00;color:#000}.btn-primary.btn-lime{background-color:#aee406;color:#000}.btn-primary.btn-orange{background-color:#f57c00}.btn-primary.btn-purple{background-color:#8130ff}.btn-primary.btn-ruby{background-color:#ff1744}.btn-primary.btn-sky{background-color:#30bcff}.btn-outline{background-color:transparent;border-color:#30bcff;color:#30bcff}.btn-outline.btn-active:highlighted{background-color:#c0ebff}.btn[isEnabled=false]{color:#a4a4a4;background-color:#e0e0e0;border-color:#e0e0e0}.fa{font-family:FontAwesome, fontawesome-webfont}.form .input{padding:16 8 16 8;background-color:transparent}.form .input.input-border{border-width:1;border-color:#e0e0e0;border-radius:2;padding:16}.form .input.input-rounded{border-width:1;border-color:#e0e0e0;border-radius:28;padding:16}.form .input[isEnabled='false']{background-color:#fafafa}.form .input-field{margin:8}.form .input-field .label{font-size:12;color:#bababa}.form .input-field .input{padding:0;margin:0 0 8 0}.form .input-field .hr-light.active,.form .input-field .hr-dark.active{background-color:#30bcff}.form .input-field.input-sides .label{font-size:18;margin:0 0 8 0}.h1,.h2,.h3,.h4,.h5,.h6{margin-bottom:4;font-weight:normal;color:#212121}.body,.body2,.footnote{font-weight:normal;color:#757575}.h1{font-size:32}.h2{font-size:22}.h3{font-size:15}.h4{font-size:12}.h5{font-size:11}.h6{font-size:10}.body{font-size:14}.body2{font-size:17}.footnote{font-size:13}.list-group .list-group-item{color:#212121;font-size:16;margin:0;padding:16}.list-group .list-group-item Label{vertical-align:center}.list-group .list-group-item .thumb{stretch:fill;width:40;height:40;margin-right:16}.list-group .list-group-item.active{background-color:#e0e0e0}.list-group .list-group-item .list-group-item-text{color:#757575;font-size:14}.page{background-color:#fff}.progress{color:#30bcff;background-color:#bababa}.segmented-bar{font-size:13;background-color:#fff;color:#212121;selected-background-color:#30bcff}.sidedrawer-left,.sidedrawer-center{background-color:#fafafa}.sidedrawer-header{background-color:#fafafa;height:148;width:100%}.sidedrawer-left .sidedrawer-header{padding:16 16 0 16}.sidedrawer-center .sidedrawer-header{padding:20 15 0 15}.sidedrawer-header-image{background-color:#e0e0e0}.sidedrawer-left .sidedrawer-header-image{height:64;width:64;border-radius:32;horizontal-align:left;margin-bottom:36}.sidedrawer-center .sidedrawer-header-image{height:74;width:74;border-radius:37;horizontal-align:center;margin-bottom:24}.sidedrawer-header-brand{color:#737373}.sidedrawer-left .sidedrawer-header-brand{horizontal-align:left;font-size:14}.sidedrawer-center .sidedrawer-header-brand{horizontal-align:center;font-size:15}.sidedrawer-list-item{height:48;horizontal-align:left;width:100%;orientation:horizontal}.sidedrawer-list-item .sidedrawer-list-item-icon{width:24;text-align:center;font-size:20;height:48;vertical-align:center}.sidedrawer-list-item.active{color:#fff;background-color:#30bcff}.sidedrawer-list-item.active .sidedrawer-list-item-icon{color:#fff}.sidedrawer-left .sidedrawer-list-item-icon{margin:0 16 0 16}.sidedrawer-center .sidedrawer-list-item-icon{margin:0 0 0 15}.sidedrawer-list-item-text{horizontal-align:left;text-align:left;font-size:15;background-color:transparent;border-width:0.1;width:80%;vertical-align:center}.sidedrawer-left .sidedrawer-list-item-text{padding-left:16}.sidedrawer-center .sidedrawer-list-item-text{padding-left:15}.slider{background-color:#30bcff}.slider[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.switch[checked=true]{background-color:#30bcff;color:#30bcff}.switch[checked=true][isEnabled=false]{background-color:#e0e0e0;color:#fff}.switch[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.tab-view{selected-color:#30bcff;tabs-background-color:#fff}.tab-view .tab-view-item{background-color:#fff;tabs-background-color:#fff}#login-background{margin-top:-20;background-size:cover;background-position:center}.login-wrap{padding:0 40}.logo-wrap{margin:60 0 10 0;padding:20 0}.logo-wrap .login-logo{text-align:center;font-size:30;font-weight:bold;margin-bottom:10;opacity:1;color:#212121;opacity:.9}.logo-wrap .login-logo-sub{color:#212121;opacity:.8;text-align:center}.login-wrapper{padding:20;background-color:#fff;border-radius:3}.login-wrapper TextField{padding:10 10;margin:10 0 0 0}.go-back{font-size:14;text-align:center;color:#212121;margin-top:10}.action-bar .action-bar-title{font-weight:500;font-size:20}.action-bar .action-item{android-elevation:0;background-color:rgba(255,0,0,0);border-color:rgba(255,0,0,0);border-width:1}.btn{font-family:'Roboto Medium';font-size:14}.btn-primary{border-color:rgba(255,0,0,0)}.btn-outline{android-elevation:0;background-color:rgba(255,0,0,0);border-width:1;border-color:#30bcff;height:36;padding:0}.btn-rounded-sm{border-radius:2;height:36;padding:0}.btn-rounded-lg{border-radius:40;height:36;padding:0}.form{font-family:'Roboto Regular'}.form .input{font-size:16}.h1{font-size:34}.h2{font-size:24}.h3{font-size:16}.h5{font-size:11;font-weight:bold}.body2{font-size:14;font-weight:500}.sidedrawer-list-item-icon{margin:0 16 0 16;padding-top:14}.sidedrawer-list-item-icon,.sidedrawer-list-item{color:#737373}.sidedrawer-list-item{font-family:'Roboto Medium';font-size:14}.slider{color:#30bcff;margin:20 16}.switch{margin:14 16;color:#e0e0e0;background-color:#e0e0e0}.switch[checked=true]{color:#30bcff}\n", ""]);



/***/ }),

/***/ "../node_modules/css-loader/dist/runtime/api.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return '@media ' + item[2] + '{' + content + '}';
      } else {
        return content;
      }
    }).join('');
  }; // import a list of modules into the list


  list.i = function (modules, mediaQuery) {
    if (typeof modules === 'string') {
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    for (var i = 0; i < this.length; i++) {
      var id = this[i][0];

      if (id != null) {
        alreadyImportedModules[id] = true;
      }
    }

    for (i = 0; i < modules.length; i++) {
      var item = modules[i]; // skip already imported module
      // this implementation is not 100% perfect for weird media query combinations
      // when a module is imported multiple times with different media queries.
      // I hope this will never occur (Hey this way we have smaller bundles)

      if (item[0] == null || !alreadyImportedModules[item[0]]) {
        if (mediaQuery && !item[2]) {
          item[2] = mediaQuery;
        } else if (mediaQuery) {
          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';
        }

        list.push(item);
      }
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || '';
  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;
  return '/*# ' + data + ' */';
}

/***/ }),

/***/ "../node_modules/css-unit-converter/index.js":
/***/ (function(module, exports) {

var conversions = {
    // length
    'px': {
        'px': 1,
        'cm': 96.0/2.54,
        'mm': 96.0/25.4,
        'in': 96,
        'pt': 96.0/72.0,
        'pc': 16
    },
    'cm': {
        'px': 2.54/96.0,
        'cm': 1,
        'mm': 0.1,
        'in': 2.54,
        'pt': 2.54/72.0,
        'pc': 2.54/6.0
    },
    'mm': {
        'px': 25.4/96.0,
        'cm': 10,
        'mm': 1,
        'in': 25.4,
        'pt': 25.4/72.0,
        'pc': 25.4/6.0
    },
    'in': {
        'px': 1.0/96.0,
        'cm': 1.0/2.54,
        'mm': 1.0/25.4,
        'in': 1,
        'pt': 1.0/72.0,
        'pc': 1.0/6.0
    },
    'pt': {
        'px': 0.75,
        'cm': 72.0/2.54,
        'mm': 72.0/25.4,
        'in': 72,
        'pt': 1,
        'pc': 12
    },
    'pc': {
        'px': 6.0/96.0,
        'cm': 6.0/2.54,
        'mm': 6.0/25.4,
        'in': 6,
        'pt': 6.0/72.0,
        'pc': 1
    },
    // angle
    'deg': {
        'deg': 1,
        'grad': 0.9,
        'rad': 180/Math.PI,
        'turn': 360
    },
    'grad': {
        'deg': 400/360,
        'grad': 1,
        'rad': 200/Math.PI,
        'turn': 400
    },
    'rad': {
        'deg': Math.PI/180,
        'grad': Math.PI/200,
        'rad': 1,
        'turn': Math.PI*2
    },
    'turn': {
        'deg': 1/360,
        'grad': 1/400,
        'rad': 0.5/Math.PI,
        'turn': 1
    },
    // time
    's': {
        's': 1,
        'ms': 1/1000
    },
    'ms': {
        's': 1000,
        'ms': 1
    },
    // frequency
    'Hz': {
        'Hz': 1,
        'kHz': 1000
    },
    'kHz': {
        'Hz': 1/1000,
        'kHz': 1
    },
    // resolution
    'dpi': {
        'dpi': 1,
        'dpcm': 1.0/2.54,
        'dppx': 1/96
    },
    'dpcm': {
        'dpi': 2.54,
        'dpcm': 1,
        'dppx': 2.54/96.0
    },
    'dppx': {
        'dpi': 96,
        'dpcm': 96.0/2.54,
        'dppx': 1
    }
};

module.exports = function (value, sourceUnit, targetUnit, precision) {
    if (!conversions.hasOwnProperty(targetUnit))
        throw new Error("Cannot convert to " + targetUnit);

    if (!conversions[targetUnit].hasOwnProperty(sourceUnit))
        throw new Error("Cannot convert from " + sourceUnit + " to " + targetUnit);

    precision = Math.pow(10, parseInt(precision) || 5);
    return Math.round((conversions[targetUnit][sourceUnit] * value) * precision) / precision;
};


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/hmr-update.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const hot = __webpack_require__("../node_modules/nativescript-dev-webpack/hot.js");
const file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
function hmrUpdate() {
    const applicationFiles = file_system_1.knownFolders.currentApp();
    const latestHash = __webpack_require__["h"]();
    return hot(latestHash, filename => applicationFiles.getFile(filename));
}
exports.hmrUpdate = hmrUpdate;
//# sourceMappingURL=hmr-update.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var hmr_update_1 = __webpack_require__("../node_modules/nativescript-dev-webpack/hmr/hmr-update.js");
exports.hmrUpdate = hmr_update_1.hmrUpdate;
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hot.js":
/***/ (function(module, exports, __webpack_require__) {

const hmrPrefix = 'HMR:';
const log = {
    info: (message) => console.info(`${hmrPrefix} ${message}`),
    warn: (message) => console.warn(`${hmrPrefix} ${message}`),
    error: (message) => console.error(`${hmrPrefix} ${message}`),
};
const refresh = 'Application needs to be restarted in order to apply the changes.';
const hotOptions = {
    ignoreUnaccepted: false,
    ignoreDeclined: false,
    ignoreErrored: false,
    onUnaccepted(data) {
        const chain = [].concat(data.chain);
        const last = chain[chain.length - 1];

        if (last === 0) {
            chain.pop();
        }

        log.warn(`Ignored an update to unaccepted module: `);
        chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onDeclined(data) {
        log.warn(`Ignored an update to declined module:`);
        data.chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onErrored(data) {
        log.warn(
            `Ignored an error while updating module ${data.moduleId} <${data.type}>`
        );
        log.warn(data.error);
    },
};

let nextHash;
let currentHash;

function upToDate() {
    return nextHash.indexOf(__webpack_require__.h()) >= 0;
}

function result(modules, appliedModules) {
    const unaccepted = modules.filter(
        (moduleId) => appliedModules && appliedModules.indexOf(moduleId) < 0
    );

    if (unaccepted.length > 0) {
        log.warn('The following modules could not be updated:');

        for (const moduleId of unaccepted) {
            log.warn(`          ⦻ ${moduleId}`);
        }
    }

    if (!(appliedModules || []).length) {
        log.info('No Modules Updated.');
    } else {
        log.info('The following modules were updated:');

        for (const moduleId of appliedModules) {
            log.info(`         ↻ ${moduleId}`);
        }

        const numberIds = appliedModules.every(
            (moduleId) => typeof moduleId === 'number'
        );
        if (numberIds) {
            log.info(
                'Please consider using the NamedModulesPlugin for module names.'
            );
        }
    }
}

function check(options) {
    return module.hot
        .check()
        .then((modules) => {
            if (!modules) {
                log.warn(
                    `Cannot find update. ${refresh}`
                );
                return null;
            }

            return module.hot
                .apply(hotOptions)
                .then((appliedModules) => {
                    let nextCheck;
                    if (!upToDate()) {
                        nextCheck = check(options);
                    }

                    result(modules, appliedModules);

                    if (upToDate()) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.info(`Successfully applied update with hmr hash ${currentHash}. App is up to date.`);
                    }

                    return nextCheck || null;
                })
                .catch((err) => {
                    const status = module.hot.status();
                    if (['abort', 'fail'].indexOf(status) >= 0) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.error(`Cannot apply update with hmr hash ${currentHash}.`);
                        log.error(err.message || err.stack);
                    } else {
                        log.error(`Update failed: ${err.message || err.stack}`);
                    }
                });
        })
        .catch((err) => {
            const status = module.hot.status();
            if (['abort', 'fail'].indexOf(status) >= 0) {
                log.error(`Cannot check for update. ${refresh}`);
                log.error(err.message || err.stack);
            } else {
                log.error(`Update check failed: ${err.message || err.stack}`);
            }
        });
}

if (true) {
    log.info('Hot Module Replacement Enabled. Waiting for signal.');
} else {}

function update(latestHash, options) {
    nextHash = latestHash;
    if (!upToDate()) {
        const status = module.hot.status();

        if (status === 'idle') {
            //Do not modify message - CLI depends on this exact content to determine hmr operation status.
            log.info(`Checking for updates to the bundle with hmr hash ${currentHash}.`);
            return check(options);
        } else if (['abort', 'fail'].indexOf(status) >= 0) {
            log.warn(
                `Cannot apply update. A previous update ${status}ed. ${refresh}`
            );
        }
    }
};

function getNextHash(hash, getFileContent) {
    const file = getFileContent(`${hash}.hot-update.json`);
    return file.readText().then(hotUpdateContent => {
        if (hotUpdateContent) {
            const manifest = JSON.parse(hotUpdateContent);
            const newHash = manifest.h;
            return getNextHash(newHash, getFileContent);
        } else {
            return Promise.resolve(hash);
        }
    }).catch(error => Promise.reject(error));
}

module.exports = function checkState(initialHash, getFileContent) {
    currentHash = initialHash;
    return getNextHash(initialHash, getFileContent).then(nextHash => {
        if (nextHash != initialHash) {
            return update(nextHash, {});
        }
    })
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css-regular.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {const loadCss = __webpack_require__("../node_modules/nativescript-dev-webpack/load-application-css.js");

module.exports = function() {
    loadCss(function() {
        const appCssContext = __webpack_require__("./ sync ^\\.\\/app\\.(css|scss|less|sass)$");
        global.registerWebpackModules(appCssContext);
    });
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css.js":
/***/ (function(module, exports, __webpack_require__) {

module.exports = function (loadModuleFn) {
    const application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
    __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");

    loadModuleFn();

    application.loadAppCss();
}


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/index.js":
/***/ (function(module, exports, __webpack_require__) {

var parse = __webpack_require__("../node_modules/postcss-value-parser/lib/parse.js");
var walk = __webpack_require__("../node_modules/postcss-value-parser/lib/walk.js");
var stringify = __webpack_require__("../node_modules/postcss-value-parser/lib/stringify.js");

function ValueParser(value) {
  if (this instanceof ValueParser) {
    this.nodes = parse(value);
    return this;
  }
  return new ValueParser(value);
}

ValueParser.prototype.toString = function() {
  return Array.isArray(this.nodes) ? stringify(this.nodes) : "";
};

ValueParser.prototype.walk = function(cb, bubble) {
  walk(this.nodes, cb, bubble);
  return this;
};

ValueParser.unit = __webpack_require__("../node_modules/postcss-value-parser/lib/unit.js");

ValueParser.walk = walk;

ValueParser.stringify = stringify;

module.exports = ValueParser;


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/parse.js":
/***/ (function(module, exports) {

var openParentheses = "(".charCodeAt(0);
var closeParentheses = ")".charCodeAt(0);
var singleQuote = "'".charCodeAt(0);
var doubleQuote = '"'.charCodeAt(0);
var backslash = "\\".charCodeAt(0);
var slash = "/".charCodeAt(0);
var comma = ",".charCodeAt(0);
var colon = ":".charCodeAt(0);
var star = "*".charCodeAt(0);

module.exports = function(input) {
  var tokens = [];
  var value = input;

  var next, quote, prev, token, escape, escapePos, whitespacePos;
  var pos = 0;
  var code = value.charCodeAt(pos);
  var max = value.length;
  var stack = [{ nodes: tokens }];
  var balanced = 0;
  var parent;

  var name = "";
  var before = "";
  var after = "";

  while (pos < max) {
    // Whitespaces
    if (code <= 32) {
      next = pos;
      do {
        next += 1;
        code = value.charCodeAt(next);
      } while (code <= 32);
      token = value.slice(pos, next);

      prev = tokens[tokens.length - 1];
      if (code === closeParentheses && balanced) {
        after = token;
      } else if (prev && prev.type === "div") {
        prev.after = token;
      } else if (
        code === comma ||
        code === colon ||
        (code === slash && value.charCodeAt(next + 1) !== star)
      ) {
        before = token;
      } else {
        tokens.push({
          type: "space",
          sourceIndex: pos,
          value: token
        });
      }

      pos = next;

      // Quotes
    } else if (code === singleQuote || code === doubleQuote) {
      next = pos;
      quote = code === singleQuote ? "'" : '"';
      token = {
        type: "string",
        sourceIndex: pos,
        quote: quote
      };
      do {
        escape = false;
        next = value.indexOf(quote, next + 1);
        if (~next) {
          escapePos = next;
          while (value.charCodeAt(escapePos - 1) === backslash) {
            escapePos -= 1;
            escape = !escape;
          }
        } else {
          value += quote;
          next = value.length - 1;
          token.unclosed = true;
        }
      } while (escape);
      token.value = value.slice(pos + 1, next);

      tokens.push(token);
      pos = next + 1;
      code = value.charCodeAt(pos);

      // Comments
    } else if (code === slash && value.charCodeAt(pos + 1) === star) {
      token = {
        type: "comment",
        sourceIndex: pos
      };

      next = value.indexOf("*/", pos);
      if (next === -1) {
        token.unclosed = true;
        next = value.length;
      }

      token.value = value.slice(pos + 2, next);
      tokens.push(token);

      pos = next + 2;
      code = value.charCodeAt(pos);

      // Dividers
    } else if (code === slash || code === comma || code === colon) {
      token = value[pos];

      tokens.push({
        type: "div",
        sourceIndex: pos - before.length,
        value: token,
        before: before,
        after: ""
      });
      before = "";

      pos += 1;
      code = value.charCodeAt(pos);

      // Open parentheses
    } else if (openParentheses === code) {
      // Whitespaces after open parentheses
      next = pos;
      do {
        next += 1;
        code = value.charCodeAt(next);
      } while (code <= 32);
      token = {
        type: "function",
        sourceIndex: pos - name.length,
        value: name,
        before: value.slice(pos + 1, next)
      };
      pos = next;

      if (name === "url" && code !== singleQuote && code !== doubleQuote) {
        next -= 1;
        do {
          escape = false;
          next = value.indexOf(")", next + 1);
          if (~next) {
            escapePos = next;
            while (value.charCodeAt(escapePos - 1) === backslash) {
              escapePos -= 1;
              escape = !escape;
            }
          } else {
            value += ")";
            next = value.length - 1;
            token.unclosed = true;
          }
        } while (escape);
        // Whitespaces before closed
        whitespacePos = next;
        do {
          whitespacePos -= 1;
          code = value.charCodeAt(whitespacePos);
        } while (code <= 32);
        if (pos !== whitespacePos + 1) {
          token.nodes = [
            {
              type: "word",
              sourceIndex: pos,
              value: value.slice(pos, whitespacePos + 1)
            }
          ];
        } else {
          token.nodes = [];
        }
        if (token.unclosed && whitespacePos + 1 !== next) {
          token.after = "";
          token.nodes.push({
            type: "space",
            sourceIndex: whitespacePos + 1,
            value: value.slice(whitespacePos + 1, next)
          });
        } else {
          token.after = value.slice(whitespacePos + 1, next);
        }
        pos = next + 1;
        code = value.charCodeAt(pos);
        tokens.push(token);
      } else {
        balanced += 1;
        token.after = "";
        tokens.push(token);
        stack.push(token);
        tokens = token.nodes = [];
        parent = token;
      }
      name = "";

      // Close parentheses
    } else if (closeParentheses === code && balanced) {
      pos += 1;
      code = value.charCodeAt(pos);

      parent.after = after;
      after = "";
      balanced -= 1;
      stack.pop();
      parent = stack[balanced];
      tokens = parent.nodes;

      // Words
    } else {
      next = pos;
      do {
        if (code === backslash) {
          next += 1;
        }
        next += 1;
        code = value.charCodeAt(next);
      } while (
        next < max &&
        !(
          code <= 32 ||
          code === singleQuote ||
          code === doubleQuote ||
          code === comma ||
          code === colon ||
          code === slash ||
          code === openParentheses ||
          (code === closeParentheses && balanced)
        )
      );
      token = value.slice(pos, next);

      if (openParentheses === code) {
        name = token;
      } else {
        tokens.push({
          type: "word",
          sourceIndex: pos,
          value: token
        });
      }

      pos = next;
    }
  }

  for (pos = stack.length - 1; pos; pos -= 1) {
    stack[pos].unclosed = true;
  }

  return stack[0].nodes;
};


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/stringify.js":
/***/ (function(module, exports) {

function stringifyNode(node, custom) {
  var type = node.type;
  var value = node.value;
  var buf;
  var customResult;

  if (custom && (customResult = custom(node)) !== undefined) {
    return customResult;
  } else if (type === "word" || type === "space") {
    return value;
  } else if (type === "string") {
    buf = node.quote || "";
    return buf + value + (node.unclosed ? "" : buf);
  } else if (type === "comment") {
    return "/*" + value + (node.unclosed ? "" : "*/");
  } else if (type === "div") {
    return (node.before || "") + value + (node.after || "");
  } else if (Array.isArray(node.nodes)) {
    buf = stringify(node.nodes);
    if (type !== "function") {
      return buf;
    }
    return (
      value +
      "(" +
      (node.before || "") +
      buf +
      (node.after || "") +
      (node.unclosed ? "" : ")")
    );
  }
  return value;
}

function stringify(nodes, custom) {
  var result, i;

  if (Array.isArray(nodes)) {
    result = "";
    for (i = nodes.length - 1; ~i; i -= 1) {
      result = stringifyNode(nodes[i], custom) + result;
    }
    return result;
  }
  return stringifyNode(nodes, custom);
}

module.exports = stringify;


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/unit.js":
/***/ (function(module, exports) {

var minus = "-".charCodeAt(0);
var plus = "+".charCodeAt(0);
var dot = ".".charCodeAt(0);
var exp = "e".charCodeAt(0);
var EXP = "E".charCodeAt(0);

module.exports = function(value) {
  var pos = 0;
  var length = value.length;
  var dotted = false;
  var sciPos = -1;
  var containsNumber = false;
  var code;

  while (pos < length) {
    code = value.charCodeAt(pos);

    if (code >= 48 && code <= 57) {
      containsNumber = true;
    } else if (code === exp || code === EXP) {
      if (sciPos > -1) {
        break;
      }
      sciPos = pos;
    } else if (code === dot) {
      if (dotted) {
        break;
      }
      dotted = true;
    } else if (code === plus || code === minus) {
      if (pos !== 0) {
        break;
      }
    } else {
      break;
    }

    pos += 1;
  }

  if (sciPos + 1 === pos) pos--;

  return containsNumber
    ? {
        number: value.slice(0, pos),
        unit: value.slice(pos)
      }
    : false;
};


/***/ }),

/***/ "../node_modules/postcss-value-parser/lib/walk.js":
/***/ (function(module, exports) {

module.exports = function walk(nodes, cb, bubble) {
  var i, max, node, result;

  for (i = 0, max = nodes.length; i < max; i += 1) {
    node = nodes[i];
    if (!bubble) {
      result = cb(node, i, nodes);
    }

    if (
      result !== false &&
      node.type === "function" &&
      Array.isArray(node.nodes)
    ) {
      walk(node.nodes, cb, bubble);
    }

    if (bubble) {
      cb(node, i, nodes);
    }
  }
};


/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _postcssValueParser = __webpack_require__("../node_modules/postcss-value-parser/lib/index.js");

var _postcssValueParser2 = _interopRequireDefault(_postcssValueParser);

var _parser = __webpack_require__("../node_modules/reduce-css-calc/dist/parser.js");

var _reducer = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/reducer.js");

var _reducer2 = _interopRequireDefault(_reducer);

var _stringifier = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/stringifier.js");

var _stringifier2 = _interopRequireDefault(_stringifier);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// eslint-disable-line
var MATCH_CALC = /((?:\-[a-z]+\-)?calc)/;

exports.default = function (value) {
  var precision = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;

  return (0, _postcssValueParser2.default)(value).walk(function (node) {
    // skip anything which isn't a calc() function
    if (node.type !== 'function' || !MATCH_CALC.test(node.value)) return;

    // stringify calc expression and produce an AST
    var contents = _postcssValueParser2.default.stringify(node.nodes);

    // skip constant() and env()
    if (contents.indexOf('constant') >= 0 || contents.indexOf('env') >= 0) return;

    var ast = _parser.parser.parse(contents);

    // reduce AST to its simplest form, that is, either to a single value
    // or a simplified calc expression
    var reducedAst = (0, _reducer2.default)(ast, precision);

    // stringify AST and write it back
    node.type = 'word';
    node.value = (0, _stringifier2.default)(node.value, reducedAst, precision);
  }, true).toString();
};

module.exports = exports['default'];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/convert.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _cssUnitConverter = __webpack_require__("../node_modules/css-unit-converter/index.js");

var _cssUnitConverter2 = _interopRequireDefault(_cssUnitConverter);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function convertNodes(left, right, precision) {
  switch (left.type) {
    case 'LengthValue':
    case 'AngleValue':
    case 'TimeValue':
    case 'FrequencyValue':
    case 'ResolutionValue':
      return convertAbsoluteLength(left, right, precision);
    default:
      return { left: left, right: right };
  }
}

function convertAbsoluteLength(left, right, precision) {
  if (right.type === left.type) {
    right = {
      type: left.type,
      value: (0, _cssUnitConverter2.default)(right.value, right.unit, left.unit, precision),
      unit: left.unit
    };
  }
  return { left: left, right: right };
}

exports.default = convertNodes;
module.exports = exports['default'];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/reducer.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.flip = flip;

var _convert = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/convert.js");

var _convert2 = _interopRequireDefault(_convert);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function reduce(node, precision) {
  if (node.type === "MathExpression") return reduceMathExpression(node, precision);

  return node;
}

function isEqual(left, right) {
  return left.type === right.type && left.value === right.value;
}

function isValueType(type) {
  switch (type) {
    case 'LengthValue':
    case 'AngleValue':
    case 'TimeValue':
    case 'FrequencyValue':
    case 'ResolutionValue':
    case 'EmValue':
    case 'ExValue':
    case 'ChValue':
    case 'RemValue':
    case 'VhValue':
    case 'VwValue':
    case 'VminValue':
    case 'VmaxValue':
    case 'PercentageValue':
    case 'Value':
      return true;
  }
  return false;
}

function convertMathExpression(node, precision) {
  var nodes = (0, _convert2.default)(node.left, node.right, precision);
  var left = reduce(nodes.left, precision);
  var right = reduce(nodes.right, precision);

  if (left.type === "MathExpression" && right.type === "MathExpression") {

    if (left.operator === '/' && right.operator === '*' || left.operator === '-' && right.operator === '+' || left.operator === '*' && right.operator === '/' || left.operator === '+' && right.operator === '-') {

      if (isEqual(left.right, right.right)) nodes = (0, _convert2.default)(left.left, right.left, precision);else if (isEqual(left.right, right.left)) nodes = (0, _convert2.default)(left.left, right.right, precision);

      left = reduce(nodes.left, precision);
      right = reduce(nodes.right, precision);
    }
  }

  node.left = left;
  node.right = right;
  return node;
}

function flip(operator) {
  return operator === '+' ? '-' : '+';
}

function flipValue(node) {
  if (isValueType(node.type)) node.value = -node.value;else if (node.type == 'MathExpression') {
    node.left = flipValue(node.left);
    node.right = flipValue(node.right);
  }
  return node;
}

function reduceAddSubExpression(node, precision) {
  var _node = node,
      left = _node.left,
      right = _node.right,
      op = _node.operator;


  if (left.type === 'CssVariable' || right.type === 'CssVariable') return node;

  // something + 0 => something
  // something - 0 => something
  if (right.value === 0) return left;

  // 0 + something => something
  if (left.value === 0 && op === "+") return right;

  // 0 - something => -something
  if (left.value === 0 && op === "-") return flipValue(right);

  // value + value
  // value - value
  if (left.type === right.type && isValueType(left.type)) {
    node = Object.assign({}, left);
    if (op === "+") node.value = left.value + right.value;else node.value = left.value - right.value;
  }

  // value <op> (expr)
  if (isValueType(left.type) && (right.operator === '+' || right.operator === '-') && right.type === 'MathExpression') {
    // value + (value + something) => (value + value) + something
    // value + (value - something) => (value + value) - something
    // value - (value + something) => (value - value) - something
    // value - (value - something) => (value - value) + something
    if (left.type === right.left.type) {
      node = Object.assign({}, node);
      node.left = reduce({
        type: 'MathExpression',
        operator: op,
        left: left,
        right: right.left
      }, precision);
      node.right = right.right;
      node.operator = op === '-' ? flip(right.operator) : right.operator;
      return reduce(node, precision);
    }
    // value + (something + value) => (value + value) + something
    // value + (something - value) => (value - value) + something
    // value - (something + value) => (value - value) - something
    // value - (something - value) => (value + value) - something
    else if (left.type === right.right.type) {
        node = Object.assign({}, node);
        node.left = reduce({
          type: 'MathExpression',
          operator: op === '-' ? flip(right.operator) : right.operator,
          left: left,
          right: right.right
        }, precision);
        node.right = right.left;
        return reduce(node, precision);
      }
  }

  // (expr) <op> value
  if (left.type === 'MathExpression' && (left.operator === '+' || left.operator === '-') && isValueType(right.type)) {
    // (value + something) + value => (value + value) + something
    // (value - something) + value => (value + value) - something
    // (value + something) - value => (value - value) + something
    // (value - something) - value => (value - value) - something
    if (right.type === left.left.type) {
      node = Object.assign({}, left);
      node.left = reduce({
        type: 'MathExpression',
        operator: op,
        left: left.left,
        right: right
      }, precision);
      return reduce(node, precision);
    }
    // (something + value) + value => something + (value + value)
    // (something - value1) + value2 => something - (value2 - value1)
    // (something + value) - value => something + (value - value)
    // (something - value) - value => something - (value + value)
    else if (right.type === left.right.type) {
        node = Object.assign({}, left);
        if (left.operator === '-') {
          node.right = reduce({
            type: 'MathExpression',
            operator: op === '-' ? '+' : '-',
            left: right,
            right: left.right
          }, precision);
          node.operator = op === '-' ? '-' : '+';
        } else {
          node.right = reduce({
            type: 'MathExpression',
            operator: op,
            left: left.right,
            right: right
          }, precision);
        }
        if (node.right.value < 0) {
          node.right.value *= -1;
          node.operator = node.operator === '-' ? '+' : '-';
        }
        return reduce(node, precision);
      }
  }
  return node;
}

function reduceDivisionExpression(node, precision) {
  if (!isValueType(node.right.type)) return node;

  if (node.right.type !== 'Value') throw new Error('Cannot divide by "' + node.right.unit + '", number expected');

  if (node.right.value === 0) throw new Error('Cannot divide by zero');

  // (expr) / value
  if (node.left.type === 'MathExpression') {
    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {
      node.left.left.value /= node.right.value;
      node.left.right.value /= node.right.value;
      return reduce(node.left, precision);
    }
    return node;
  }
  // something / value
  else if (isValueType(node.left.type)) {
      node.left.value /= node.right.value;
      return node.left;
    }
  return node;
}

function reduceMultiplicationExpression(node) {
  // (expr) * value
  if (node.left.type === 'MathExpression' && node.right.type === 'Value') {
    if (isValueType(node.left.left.type) && isValueType(node.left.right.type)) {
      node.left.left.value *= node.right.value;
      node.left.right.value *= node.right.value;
      return node.left;
    }
  }
  // something * value
  else if (isValueType(node.left.type) && node.right.type === 'Value') {
      node.left.value *= node.right.value;
      return node.left;
    }
    // value * (expr)
    else if (node.left.type === 'Value' && node.right.type === 'MathExpression') {
        if (isValueType(node.right.left.type) && isValueType(node.right.right.type)) {
          node.right.left.value *= node.left.value;
          node.right.right.value *= node.left.value;
          return node.right;
        }
      }
      // value * something
      else if (node.left.type === 'Value' && isValueType(node.right.type)) {
          node.right.value *= node.left.value;
          return node.right;
        }
  return node;
}

function reduceMathExpression(node, precision) {
  node = convertMathExpression(node, precision);

  switch (node.operator) {
    case "+":
    case "-":
      return reduceAddSubExpression(node, precision);
    case "/":
      return reduceDivisionExpression(node, precision);
    case "*":
      return reduceMultiplicationExpression(node);
  }
  return node;
}

exports.default = reduce;

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/lib/stringifier.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (calc, node, precision) {
  var str = stringify(node, precision);

  if (node.type === "MathExpression") {
    // if calc expression couldn't be resolved to a single value, re-wrap it as
    // a calc()
    str = calc + "(" + str + ")";
  }
  return str;
};

var _reducer = __webpack_require__("../node_modules/reduce-css-calc/dist/lib/reducer.js");

var order = {
  "*": 0,
  "/": 0,
  "+": 1,
  "-": 1
};

function round(value, prec) {
  if (prec !== false) {
    var precision = Math.pow(10, prec);
    return Math.round(value * precision) / precision;
  }
  return value;
}

function stringify(node, prec) {
  switch (node.type) {
    case "MathExpression":
      {
        var left = node.left,
            right = node.right,
            op = node.operator;

        var str = "";

        if (left.type === 'MathExpression' && order[op] < order[left.operator]) str += "(" + stringify(left, prec) + ")";else str += stringify(left, prec);

        str += " " + node.operator + " ";

        if (right.type === 'MathExpression' && order[op] < order[right.operator]) str += "(" + stringify(right, prec) + ")";else if (right.type === 'MathExpression' && op === "-" && ["+", "-"].includes(right.operator)) {
          // fix #52 : a-(b+c) = a-b-c
          right.operator = (0, _reducer.flip)(right.operator);
          str += stringify(right, prec);
        } else str += stringify(right, prec);

        return str;
      }
    case "Value":
      return round(node.value, prec);
    case 'CssVariable':
      return node.value;
    default:
      return round(node.value, prec) + node.unit;
  }
}

module.exports = exports["default"];

/***/ }),

/***/ "../node_modules/reduce-css-calc/dist/parser.js":
/***/ (function(module, exports, __webpack_require__) {


/* parser generated by jison 0.6.1-215 */

/*
 * Returns a Parser object of the following structure:
 *
 *  Parser: {
 *    yy: {}     The so-called "shared state" or rather the *source* of it;
 *               the real "shared state" `yy` passed around to
 *               the rule actions, etc. is a derivative/copy of this one,
 *               not a direct reference!
 *  }
 *
 *  Parser.prototype: {
 *    yy: {},
 *    EOF: 1,
 *    TERROR: 2,
 *
 *    trace: function(errorMessage, ...),
 *
 *    JisonParserError: function(msg, hash),
 *
 *    quoteName: function(name),
 *               Helper function which can be overridden by user code later on: put suitable
 *               quotes around literal IDs in a description string.
 *
 *    originalQuoteName: function(name),
 *               The basic quoteName handler provided by JISON.
 *               `cleanupAfterParse()` will clean up and reset `quoteName()` to reference this function
 *               at the end of the `parse()`.
 *
 *    describeSymbol: function(symbol),
 *               Return a more-or-less human-readable description of the given symbol, when
 *               available, or the symbol itself, serving as its own 'description' for lack
 *               of something better to serve up.
 *
 *               Return NULL when the symbol is unknown to the parser.
 *
 *    symbols_: {associative list: name ==> number},
 *    terminals_: {associative list: number ==> name},
 *    nonterminals: {associative list: rule-name ==> {associative list: number ==> rule-alt}},
 *    terminal_descriptions_: (if there are any) {associative list: number ==> description},
 *    productions_: [...],
 *
 *    performAction: function parser__performAction(yytext, yyleng, yylineno, yyloc, yystate, yysp, yyvstack, yylstack, yystack, yysstack),
 *
 *               The function parameters and `this` have the following value/meaning:
 *               - `this`    : reference to the `yyval` internal object, which has members (`$` and `_$`)
 *                             to store/reference the rule value `$$` and location info `@$`.
 *
 *                 One important thing to note about `this` a.k.a. `yyval`: every *reduce* action gets
 *                 to see the same object via the `this` reference, i.e. if you wish to carry custom
 *                 data from one reduce action through to the next within a single parse run, then you
 *                 may get nasty and use `yyval` a.k.a. `this` for storing you own semi-permanent data.
 *
 *                 `this.yy` is a direct reference to the `yy` shared state object.
 *
 *                 `%parse-param`-specified additional `parse()` arguments have been added to this `yy`
 *                 object at `parse()` start and are therefore available to the action code via the
 *                 same named `yy.xxxx` attributes (where `xxxx` represents a identifier name from
 *                 the %parse-param` list.
 *
 *               - `yytext`  : reference to the lexer value which belongs to the last lexer token used
 *                             to match this rule. This is *not* the look-ahead token, but the last token
 *                             that's actually part of this rule.
 *
 *                 Formulated another way, `yytext` is the value of the token immediately preceeding
 *                 the current look-ahead token.
 *                 Caveats apply for rules which don't require look-ahead, such as epsilon rules.
 *
 *               - `yyleng`  : ditto as `yytext`, only now for the lexer.yyleng value.
 *
 *               - `yylineno`: ditto as `yytext`, only now for the lexer.yylineno value.
 *
 *               - `yyloc`   : ditto as `yytext`, only now for the lexer.yylloc lexer token location info.
 *
 *                               WARNING: since jison 0.4.18-186 this entry may be NULL/UNDEFINED instead
 *                               of an empty object when no suitable location info can be provided.
 *
 *               - `yystate` : the current parser state number, used internally for dispatching and
 *                               executing the action code chunk matching the rule currently being reduced.
 *
 *               - `yysp`    : the current state stack position (a.k.a. 'stack pointer')
 *
 *                 This one comes in handy when you are going to do advanced things to the parser
 *                 stacks, all of which are accessible from your action code (see the next entries below).
 *
 *                 Also note that you can access this and other stack index values using the new double-hash
 *                 syntax, i.e. `##$ === ##0 === yysp`, while `##1` is the stack index for all things
 *                 related to the first rule term, just like you have `$1`, `@1` and `#1`.
 *                 This is made available to write very advanced grammar action rules, e.g. when you want
 *                 to investigate the parse state stack in your action code, which would, for example,
 *                 be relevant when you wish to implement error diagnostics and reporting schemes similar
 *                 to the work described here:
 *
 *                 + Pottier, F., 2016. Reachability and error diagnosis in LR(1) automata.
 *                   In Journées Francophones des Languages Applicatifs.
 *
 *                 + Jeffery, C.L., 2003. Generating LR syntax error messages from examples.
 *                   ACM Transactions on Programming Languages and Systems (TOPLAS), 25(5), pp.631–640.
 *
 *               - `yyrulelength`: the current rule's term count, i.e. the number of entries occupied on the stack.
 *
 *                 This one comes in handy when you are going to do advanced things to the parser
 *                 stacks, all of which are accessible from your action code (see the next entries below).
 *
 *               - `yyvstack`: reference to the parser value stack. Also accessed via the `$1` etc.
 *                             constructs.
 *
 *               - `yylstack`: reference to the parser token location stack. Also accessed via
 *                             the `@1` etc. constructs.
 *
 *                             WARNING: since jison 0.4.18-186 this array MAY contain slots which are
 *                             UNDEFINED rather than an empty (location) object, when the lexer/parser
 *                             action code did not provide a suitable location info object when such a
 *                             slot was filled!
 *
 *               - `yystack` : reference to the parser token id stack. Also accessed via the
 *                             `#1` etc. constructs.
 *
 *                 Note: this is a bit of a **white lie** as we can statically decode any `#n` reference to
 *                 its numeric token id value, hence that code wouldn't need the `yystack` but *you* might
 *                 want access this array for your own purposes, such as error analysis as mentioned above!
 *
 *                 Note that this stack stores the current stack of *tokens*, that is the sequence of
 *                 already parsed=reduced *nonterminals* (tokens representing rules) and *terminals*
 *                 (lexer tokens *shifted* onto the stack until the rule they belong to is found and
 *                 *reduced*.
 *
 *               - `yysstack`: reference to the parser state stack. This one carries the internal parser
 *                             *states* such as the one in `yystate`, which are used to represent
 *                             the parser state machine in the *parse table*. *Very* *internal* stuff,
 *                             what can I say? If you access this one, you're clearly doing wicked things
 *
 *               - `...`     : the extra arguments you specified in the `%parse-param` statement in your
 *                             grammar definition file.
 *
 *    table: [...],
 *               State transition table
 *               ----------------------
 *
 *               index levels are:
 *               - `state`  --> hash table
 *               - `symbol` --> action (number or array)
 *
 *                 If the `action` is an array, these are the elements' meaning:
 *                 - index [0]: 1 = shift, 2 = reduce, 3 = accept
 *                 - index [1]: GOTO `state`
 *
 *                 If the `action` is a number, it is the GOTO `state`
 *
 *    defaultActions: {...},
 *
 *    parseError: function(str, hash, ExceptionClass),
 *    yyError: function(str, ...),
 *    yyRecovering: function(),
 *    yyErrOk: function(),
 *    yyClearIn: function(),
 *
 *    constructParseErrorInfo: function(error_message, exception_object, expected_token_set, is_recoverable),
 *               Helper function **which will be set up during the first invocation of the `parse()` method**.
 *               Produces a new errorInfo 'hash object' which can be passed into `parseError()`.
 *               See it's use in this parser kernel in many places; example usage:
 *
 *                   var infoObj = parser.constructParseErrorInfo('fail!', null,
 *                                     parser.collect_expected_token_set(state), true);
 *                   var retVal = parser.parseError(infoObj.errStr, infoObj, parser.JisonParserError);
 *
 *    originalParseError: function(str, hash, ExceptionClass),
 *               The basic `parseError` handler provided by JISON.
 *               `cleanupAfterParse()` will clean up and reset `parseError()` to reference this function
 *               at the end of the `parse()`.
 *
 *    options: { ... parser %options ... },
 *
 *    parse: function(input[, args...]),
 *               Parse the given `input` and return the parsed value (or `true` when none was provided by
 *               the root action, in which case the parser is acting as a *matcher*).
 *               You MAY use the additional `args...` parameters as per `%parse-param` spec of this grammar:
 *               these extra `args...` are added verbatim to the `yy` object reference as member variables.
 *
 *               WARNING:
 *               Parser's additional `args...` parameters (via `%parse-param`) MAY conflict with
 *               any attributes already added to `yy` by the jison run-time;
 *               when such a collision is detected an exception is thrown to prevent the generated run-time
 *               from silently accepting this confusing and potentially hazardous situation!
 *
 *               The lexer MAY add its own set of additional parameters (via the `%parse-param` line in
 *               the lexer section of the grammar spec): these will be inserted in the `yy` shared state
 *               object and any collision with those will be reported by the lexer via a thrown exception.
 *
 *    cleanupAfterParse: function(resultValue, invoke_post_methods, do_not_nuke_errorinfos),
 *               Helper function **which will be set up during the first invocation of the `parse()` method**.
 *               This helper API is invoked at the end of the `parse()` call, unless an exception was thrown
 *               and `%options no-try-catch` has been defined for this grammar: in that case this helper MAY
 *               be invoked by calling user code to ensure the `post_parse` callbacks are invoked and
 *               the internal parser gets properly garbage collected under these particular circumstances.
 *
 *    yyMergeLocationInfo: function(first_index, last_index, first_yylloc, last_yylloc, dont_look_back),
 *               Helper function **which will be set up during the first invocation of the `parse()` method**.
 *               This helper API can be invoked to calculate a spanning `yylloc` location info object.
 *
 *               Note: %epsilon rules MAY specify no `first_index` and `first_yylloc`, in which case
 *               this function will attempt to obtain a suitable location marker by inspecting the location stack
 *               backwards.
 *
 *               For more info see the documentation comment further below, immediately above this function's
 *               implementation.
 *
 *    lexer: {
 *        yy: {...},           A reference to the so-called "shared state" `yy` once
 *                             received via a call to the `.setInput(input, yy)` lexer API.
 *        EOF: 1,
 *        ERROR: 2,
 *        JisonLexerError: function(msg, hash),
 *        parseError: function(str, hash, ExceptionClass),
 *        setInput: function(input, [yy]),
 *        input: function(),
 *        unput: function(str),
 *        more: function(),
 *        reject: function(),
 *        less: function(n),
 *        pastInput: function(n),
 *        upcomingInput: function(n),
 *        showPosition: function(),
 *        test_match: function(regex_match_array, rule_index, ...),
 *        next: function(...),
 *        lex: function(...),
 *        begin: function(condition),
 *        pushState: function(condition),
 *        popState: function(),
 *        topState: function(),
 *        _currentRules: function(),
 *        stateStackSize: function(),
 *        cleanupAfterLex: function()
 *
 *        options: { ... lexer %options ... },
 *
 *        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START, ...),
 *        rules: [...],
 *        conditions: {associative list: name ==> set},
 *    }
 *  }
 *
 *
 *  token location info (@$, _$, etc.): {
 *    first_line: n,
 *    last_line: n,
 *    first_column: n,
 *    last_column: n,
 *    range: [start_number, end_number]
 *               (where the numbers are indexes into the input string, zero-based)
 *  }
 *
 * ---
 *
 * The `parseError` function receives a 'hash' object with these members for lexer and
 * parser errors:
 *
 *  {
 *    text:        (matched text)
 *    token:       (the produced terminal token, if any)
 *    token_id:    (the produced terminal token numeric ID, if any)
 *    line:        (yylineno)
 *    loc:         (yylloc)
 *  }
 *
 * parser (grammar) errors will also provide these additional members:
 *
 *  {
 *    expected:    (array describing the set of expected tokens;
 *                  may be UNDEFINED when we cannot easily produce such a set)
 *    state:       (integer (or array when the table includes grammar collisions);
 *                  represents the current internal state of the parser kernel.
 *                  can, for example, be used to pass to the `collect_expected_token_set()`
 *                  API to obtain the expected token set)
 *    action:      (integer; represents the current internal action which will be executed)
 *    new_state:   (integer; represents the next/planned internal state, once the current
 *                  action has executed)
 *    recoverable: (boolean: TRUE when the parser MAY have an error recovery rule
 *                  available for this particular error)
 *    state_stack: (array: the current parser LALR/LR internal state stack; this can be used,
 *                  for instance, for advanced error analysis and reporting)
 *    value_stack: (array: the current parser LALR/LR internal `$$` value stack; this can be used,
 *                  for instance, for advanced error analysis and reporting)
 *    location_stack: (array: the current parser LALR/LR internal location stack; this can be used,
 *                  for instance, for advanced error analysis and reporting)
 *    yy:          (object: the current parser internal "shared state" `yy`
 *                  as is also available in the rule actions; this can be used,
 *                  for instance, for advanced error analysis and reporting)
 *    lexer:       (reference to the current lexer instance used by the parser)
 *    parser:      (reference to the current parser instance)
 *  }
 *
 * while `this` will reference the current parser instance.
 *
 * When `parseError` is invoked by the lexer, `this` will still reference the related *parser*
 * instance, while these additional `hash` fields will also be provided:
 *
 *  {
 *    lexer:       (reference to the current lexer instance which reported the error)
 *  }
 *
 * When `parseError` is invoked by the parser due to a **JavaScript exception** being fired
 * from either the parser or lexer, `this` will still reference the related *parser*
 * instance, while these additional `hash` fields will also be provided:
 *
 *  {
 *    exception:   (reference to the exception thrown)
 *  }
 *
 * Please do note that in the latter situation, the `expected` field will be omitted as
 * this type of failure is assumed not to be due to *parse errors* but rather due to user
 * action code in either parser or lexer failing unexpectedly.
 *
 * ---
 *
 * You can specify parser options by setting / modifying the `.yy` object of your Parser instance.
 * These options are available:
 *
 * ### options which are global for all parser instances
 *
 *  Parser.pre_parse: function(yy)
 *                 optional: you can specify a pre_parse() function in the chunk following
 *                 the grammar, i.e. after the last `%%`.
 *  Parser.post_parse: function(yy, retval, parseInfo) { return retval; }
 *                 optional: you can specify a post_parse() function in the chunk following
 *                 the grammar, i.e. after the last `%%`. When it does not return any value,
 *                 the parser will return the original `retval`.
 *
 * ### options which can be set up per parser instance
 *
 *  yy: {
 *      pre_parse:  function(yy)
 *                 optional: is invoked before the parse cycle starts (and before the first
 *                 invocation of `lex()`) but immediately after the invocation of
 *                 `parser.pre_parse()`).
 *      post_parse: function(yy, retval, parseInfo) { return retval; }
 *                 optional: is invoked when the parse terminates due to success ('accept')
 *                 or failure (even when exceptions are thrown).
 *                 `retval` contains the return value to be produced by `Parser.parse()`;
 *                 this function can override the return value by returning another.
 *                 When it does not return any value, the parser will return the original
 *                 `retval`.
 *                 This function is invoked immediately before `parser.post_parse()`.
 *
 *      parseError: function(str, hash, ExceptionClass)
 *                 optional: overrides the default `parseError` function.
 *      quoteName: function(name),
 *                 optional: overrides the default `quoteName` function.
 *  }
 *
 *  parser.lexer.options: {
 *      pre_lex:  function()
 *                 optional: is invoked before the lexer is invoked to produce another token.
 *                 `this` refers to the Lexer object.
 *      post_lex: function(token) { return token; }
 *                 optional: is invoked when the lexer has produced a token `token`;
 *                 this function can override the returned token value by returning another.
 *                 When it does not return any (truthy) value, the lexer will return
 *                 the original `token`.
 *                 `this` refers to the Lexer object.
 *
 *      ranges: boolean
 *                 optional: `true` ==> token location info will include a .range[] member.
 *      flex: boolean
 *                 optional: `true` ==> flex-like lexing behaviour where the rules are tested
 *                 exhaustively to find the longest match.
 *      backtrack_lexer: boolean
 *                 optional: `true` ==> lexer regexes are tested in order and for invoked;
 *                 the lexer terminates the scan when a token is returned by the action code.
 *      xregexp: boolean
 *                 optional: `true` ==> lexer rule regexes are "extended regex format" requiring the
 *                 `XRegExp` library. When this `%option` has not been specified at compile time, all lexer
 *                 rule regexes have been written as standard JavaScript RegExp expressions.
 *  }
 */

        
    
            var parser = (function () {


// See also:
// http://stackoverflow.com/questions/1382107/whats-a-good-way-to-extend-error-in-javascript/#35881508
// but we keep the prototype.constructor and prototype.name assignment lines too for compatibility
// with userland code which might access the derived class in a 'classic' way.
function JisonParserError(msg, hash) {
    Object.defineProperty(this, 'name', {
        enumerable: false,
        writable: false,
        value: 'JisonParserError'
    });

    if (msg == null) msg = '???';

    Object.defineProperty(this, 'message', {
        enumerable: false,
        writable: true,
        value: msg
    });

    this.hash = hash;

    var stacktrace;
    if (hash && hash.exception instanceof Error) {
        var ex2 = hash.exception;
        this.message = ex2.message || msg;
        stacktrace = ex2.stack;
    }
    if (!stacktrace) {
        if (Error.hasOwnProperty('captureStackTrace')) {        // V8/Chrome engine
            Error.captureStackTrace(this, this.constructor);
        } else {
            stacktrace = (new Error(msg)).stack;
        }
    }
    if (stacktrace) {
        Object.defineProperty(this, 'stack', {
            enumerable: false,
            writable: false,
            value: stacktrace
        });
    }
}

if (typeof Object.setPrototypeOf === 'function') {
    Object.setPrototypeOf(JisonParserError.prototype, Error.prototype);
} else {
    JisonParserError.prototype = Object.create(Error.prototype);
}
JisonParserError.prototype.constructor = JisonParserError;
JisonParserError.prototype.name = 'JisonParserError';




        // helper: reconstruct the productions[] table
        function bp(s) {
            var rv = [];
            var p = s.pop;
            var r = s.rule;
            for (var i = 0, l = p.length; i < l; i++) {
                rv.push([
                    p[i],
                    r[i]
                ]);
            }
            return rv;
        }
    


        // helper: reconstruct the defaultActions[] table
        function bda(s) {
            var rv = {};
            var d = s.idx;
            var g = s.goto;
            for (var i = 0, l = d.length; i < l; i++) {
                var j = d[i];
                rv[j] = g[i];
            }
            return rv;
        }
    


        // helper: reconstruct the 'goto' table
        function bt(s) {
            var rv = [];
            var d = s.len;
            var y = s.symbol;
            var t = s.type;
            var a = s.state;
            var m = s.mode;
            var g = s.goto;
            for (var i = 0, l = d.length; i < l; i++) {
                var n = d[i];
                var q = {};
                for (var j = 0; j < n; j++) {
                    var z = y.shift();
                    switch (t.shift()) {
                    case 2:
                        q[z] = [
                            m.shift(),
                            g.shift()
                        ];
                        break;

                    case 0:
                        q[z] = a.shift();
                        break;

                    default:
                        // type === 1: accept
                        q[z] = [
                            3
                        ];
                    }
                }
                rv.push(q);
            }
            return rv;
        }
    


        // helper: runlength encoding with increment step: code, length: step (default step = 0)
        // `this` references an array
        function s(c, l, a) {
            a = a || 0;
            for (var i = 0; i < l; i++) {
                this.push(c);
                c += a;
            }
        }

        // helper: duplicate sequence from *relative* offset and length.
        // `this` references an array
        function c(i, l) {
            i = this.length - i;
            for (l += i; i < l; i++) {
                this.push(this[i]);
            }
        }

        // helper: unpack an array using helpers and data, all passed in an array argument 'a'.
        function u(a) {
            var rv = [];
            for (var i = 0, l = a.length; i < l; i++) {
                var e = a[i];
                // Is this entry a helper function?
                if (typeof e === 'function') {
                    i++;
                    e.apply(rv, a[i]);
                } else {
                    rv.push(e);
                }
            }
            return rv;
        }
    

var parser = {
    // Code Generator Information Report
    // ---------------------------------
    //
    // Options:
    //
    //   default action mode: ............. ["classic","merge"]
    //   test-compile action mode: ........ "parser:*,lexer:*"
    //   try..catch: ...................... true
    //   default resolve on conflict: ..... true
    //   on-demand look-ahead: ............ false
    //   error recovery token skip maximum: 3
    //   yyerror in parse actions is: ..... NOT recoverable,
    //   yyerror in lexer actions and other non-fatal lexer are:
    //   .................................. NOT recoverable,
    //   debug grammar/output: ............ false
    //   has partial LR conflict upgrade:   true
    //   rudimentary token-stack support:   false
    //   parser table compression mode: ... 2
    //   export debug tables: ............. false
    //   export *all* tables: ............. false
    //   module type: ..................... commonjs
    //   parser engine type: .............. lalr
    //   output main() in the module: ..... true
    //   has user-specified main(): ....... false
    //   has user-specified require()/import modules for main():
    //   .................................. false
    //   number of expected conflicts: .... 0
    //
    //
    // Parser Analysis flags:
    //
    //   no significant actions (parser is a language matcher only):
    //   .................................. false
    //   uses yyleng: ..................... false
    //   uses yylineno: ................... false
    //   uses yytext: ..................... false
    //   uses yylloc: ..................... false
    //   uses ParseError API: ............. false
    //   uses YYERROR: .................... false
    //   uses YYRECOVERING: ............... false
    //   uses YYERROK: .................... false
    //   uses YYCLEARIN: .................. false
    //   tracks rule values: .............. true
    //   assigns rule values: ............. true
    //   uses location tracking: .......... false
    //   assigns location: ................ false
    //   uses yystack: .................... false
    //   uses yysstack: ................... false
    //   uses yysp: ....................... true
    //   uses yyrulelength: ............... false
    //   uses yyMergeLocationInfo API: .... false
    //   has error recovery: .............. false
    //   has error reporting: ............. false
    //
    // --------- END OF REPORT -----------

trace: function no_op_trace() { },
JisonParserError: JisonParserError,
yy: {},
options: {
  type: "lalr",
  hasPartialLrUpgradeOnConflict: true,
  errorRecoveryTokenDiscardCount: 3
},
symbols_: {
  "$accept": 0,
  "$end": 1,
  "ADD": 3,
  "ANGLE": 14,
  "CHS": 20,
  "CSS_VAR": 12,
  "DIV": 6,
  "EMS": 18,
  "EOF": 1,
  "EXS": 19,
  "FREQ": 16,
  "LENGTH": 13,
  "LPAREN": 7,
  "MUL": 5,
  "NESTED_CALC": 9,
  "NUMBER": 11,
  "PERCENTAGE": 26,
  "PREFIX": 10,
  "REMS": 21,
  "RES": 17,
  "RPAREN": 8,
  "SUB": 4,
  "TIME": 15,
  "VHS": 22,
  "VMAXS": 25,
  "VMINS": 24,
  "VWS": 23,
  "css_value": 31,
  "css_variable": 30,
  "error": 2,
  "expression": 27,
  "math_expression": 28,
  "value": 29
},
terminals_: {
  1: "EOF",
  2: "error",
  3: "ADD",
  4: "SUB",
  5: "MUL",
  6: "DIV",
  7: "LPAREN",
  8: "RPAREN",
  9: "NESTED_CALC",
  10: "PREFIX",
  11: "NUMBER",
  12: "CSS_VAR",
  13: "LENGTH",
  14: "ANGLE",
  15: "TIME",
  16: "FREQ",
  17: "RES",
  18: "EMS",
  19: "EXS",
  20: "CHS",
  21: "REMS",
  22: "VHS",
  23: "VWS",
  24: "VMINS",
  25: "VMAXS",
  26: "PERCENTAGE"
},
TERROR: 2,
    EOF: 1,

    // internals: defined here so the object *structure* doesn't get modified by parse() et al,
    // thus helping JIT compilers like Chrome V8.
    originalQuoteName: null,
    originalParseError: null,
    cleanupAfterParse: null,
    constructParseErrorInfo: null,
    yyMergeLocationInfo: null,

    __reentrant_call_depth: 0,      // INTERNAL USE ONLY
    __error_infos: [],              // INTERNAL USE ONLY: the set of parseErrorInfo objects created since the last cleanup
    __error_recovery_infos: [],     // INTERNAL USE ONLY: the set of parseErrorInfo objects created since the last cleanup

    // APIs which will be set up depending on user action code analysis:
    //yyRecovering: 0,
    //yyErrOk: 0,
    //yyClearIn: 0,

    // Helper APIs
    // -----------

    // Helper function which can be overridden by user code later on: put suitable quotes around
    // literal IDs in a description string.
    quoteName: function parser_quoteName(id_str) {
        return '"' + id_str + '"';
    },

    // Return the name of the given symbol (terminal or non-terminal) as a string, when available.
    //
    // Return NULL when the symbol is unknown to the parser.
    getSymbolName: function parser_getSymbolName(symbol) {
        if (this.terminals_[symbol]) {
            return this.terminals_[symbol];
        }

        // Otherwise... this might refer to a RULE token i.e. a non-terminal: see if we can dig that one up.
        //
        // An example of this may be where a rule's action code contains a call like this:
        //
        //      parser.getSymbolName(#$)
        //
        // to obtain a human-readable name of the current grammar rule.
        var s = this.symbols_;
        for (var key in s) {
            if (s[key] === symbol) {
                return key;
            }
        }
        return null;
    },

    // Return a more-or-less human-readable description of the given symbol, when available,
    // or the symbol itself, serving as its own 'description' for lack of something better to serve up.
    //
    // Return NULL when the symbol is unknown to the parser.
    describeSymbol: function parser_describeSymbol(symbol) {
        if (symbol !== this.EOF && this.terminal_descriptions_ && this.terminal_descriptions_[symbol]) {
            return this.terminal_descriptions_[symbol];
        }
        else if (symbol === this.EOF) {
            return 'end of input';
        }
        var id = this.getSymbolName(symbol);
        if (id) {
            return this.quoteName(id);
        }
        return null;
    },

    // Produce a (more or less) human-readable list of expected tokens at the point of failure.
    //
    // The produced list may contain token or token set descriptions instead of the tokens
    // themselves to help turning this output into something that easier to read by humans
    // unless `do_not_describe` parameter is set, in which case a list of the raw, *numeric*,
    // expected terminals and nonterminals is produced.
    //
    // The returned list (array) will not contain any duplicate entries.
    collect_expected_token_set: function parser_collect_expected_token_set(state, do_not_describe) {
        var TERROR = this.TERROR;
        var tokenset = [];
        var check = {};
        // Has this (error?) state been outfitted with a custom expectations description text for human consumption?
        // If so, use that one instead of the less palatable token set.
        if (!do_not_describe && this.state_descriptions_ && this.state_descriptions_[state]) {
            return [
                this.state_descriptions_[state]
            ];
        }
        for (var p in this.table[state]) {
            p = +p;
            if (p !== TERROR) {
                var d = do_not_describe ? p : this.describeSymbol(p);
                if (d && !check[d]) {
                    tokenset.push(d);
                    check[d] = true;        // Mark this token description as already mentioned to prevent outputting duplicate entries.
                }
            }
        }
        return tokenset;
    },
productions_: bp({
  pop: u([
  27,
  s,
  [28, 10],
  29,
  29,
  30,
  s,
  [31, 15]
]),
  rule: u([
  2,
  s,
  [3, 5],
  4,
  7,
  s,
  [1, 4],
  2,
  s,
  [1, 15],
  2
])
}),
performAction: function parser__PerformAction(yystate /* action[1] */, yysp, yyvstack) {

          /* this == yyval */

          // the JS engine itself can go and remove these statements when `yy` turns out to be unused in any action code!
          var yy = this.yy;
          var yyparser = yy.parser;
          var yylexer = yy.lexer;

          

          switch (yystate) {
case 0:
    /*! Production::    $accept : expression $end */

    // default action (generated by JISON mode classic/merge :: 1,VT,VA,-,-,-,-,-,-):
    this.$ = yyvstack[yysp - 1];
    // END of default action (generated by JISON mode classic/merge :: 1,VT,VA,-,-,-,-,-,-)
    break;

case 1:
    /*! Production::    expression : math_expression EOF */

    // default action (generated by JISON mode classic/merge :: 2,VT,VA,-,-,-,-,-,-):
    this.$ = yyvstack[yysp - 1];
    // END of default action (generated by JISON mode classic/merge :: 2,VT,VA,-,-,-,-,-,-)
    
    
    return yyvstack[yysp - 1];
    break;

case 2:
    /*! Production::    math_expression : math_expression ADD math_expression */
case 3:
    /*! Production::    math_expression : math_expression SUB math_expression */
case 4:
    /*! Production::    math_expression : math_expression MUL math_expression */
case 5:
    /*! Production::    math_expression : math_expression DIV math_expression */

    this.$ = { type: 'MathExpression', operator: yyvstack[yysp - 1], left: yyvstack[yysp - 2], right: yyvstack[yysp] };
    break;

case 6:
    /*! Production::    math_expression : LPAREN math_expression RPAREN */
case 7:
    /*! Production::    math_expression : NESTED_CALC LPAREN math_expression RPAREN */
case 8:
    /*! Production::    math_expression : SUB PREFIX SUB NESTED_CALC LPAREN math_expression RPAREN */

    this.$ = yyvstack[yysp - 1];
    break;

case 9:
    /*! Production::    math_expression : css_variable */
case 10:
    /*! Production::    math_expression : css_value */
case 11:
    /*! Production::    math_expression : value */

    this.$ = yyvstack[yysp];
    break;

case 12:
    /*! Production::    value : NUMBER */

    this.$ = { type: 'Value', value: parseFloat(yyvstack[yysp]) };
    break;

case 13:
    /*! Production::    value : SUB NUMBER */

    this.$ = { type: 'Value', value: parseFloat(yyvstack[yysp]) * -1 };
    break;

case 14:
    /*! Production::    css_variable : CSS_VAR */

    this.$ = { type: 'CssVariable', value: yyvstack[yysp] };
    break;

case 15:
    /*! Production::    css_value : LENGTH */

    this.$ = { type: 'LengthValue', value: parseFloat(yyvstack[yysp]), unit: /[a-z]+/.exec(yyvstack[yysp])[0] };
    break;

case 16:
    /*! Production::    css_value : ANGLE */

    this.$ = { type: 'AngleValue', value: parseFloat(yyvstack[yysp]), unit: /[a-z]+/.exec(yyvstack[yysp])[0] };
    break;

case 17:
    /*! Production::    css_value : TIME */

    this.$ = { type: 'TimeValue', value: parseFloat(yyvstack[yysp]), unit: /[a-z]+/.exec(yyvstack[yysp])[0] };
    break;

case 18:
    /*! Production::    css_value : FREQ */

    this.$ = { type: 'FrequencyValue', value: parseFloat(yyvstack[yysp]), unit: /[a-z]+/.exec(yyvstack[yysp])[0] };
    break;

case 19:
    /*! Production::    css_value : RES */

    this.$ = { type: 'ResolutionValue', value: parseFloat(yyvstack[yysp]), unit: /[a-z]+/.exec(yyvstack[yysp])[0] };
    break;

case 20:
    /*! Production::    css_value : EMS */

    this.$ = { type: 'EmValue', value: parseFloat(yyvstack[yysp]), unit: 'em' };
    break;

case 21:
    /*! Production::    css_value : EXS */

    this.$ = { type: 'ExValue', value: parseFloat(yyvstack[yysp]), unit: 'ex' };
    break;

case 22:
    /*! Production::    css_value : CHS */

    this.$ = { type: 'ChValue', value: parseFloat(yyvstack[yysp]), unit: 'ch' };
    break;

case 23:
    /*! Production::    css_value : REMS */

    this.$ = { type: 'RemValue', value: parseFloat(yyvstack[yysp]), unit: 'rem' };
    break;

case 24:
    /*! Production::    css_value : VHS */

    this.$ = { type: 'VhValue', value: parseFloat(yyvstack[yysp]), unit: 'vh' };
    break;

case 25:
    /*! Production::    css_value : VWS */

    this.$ = { type: 'VwValue', value: parseFloat(yyvstack[yysp]), unit: 'vw' };
    break;

case 26:
    /*! Production::    css_value : VMINS */

    this.$ = { type: 'VminValue', value: parseFloat(yyvstack[yysp]), unit: 'vmin' };
    break;

case 27:
    /*! Production::    css_value : VMAXS */

    this.$ = { type: 'VmaxValue', value: parseFloat(yyvstack[yysp]), unit: 'vmax' };
    break;

case 28:
    /*! Production::    css_value : PERCENTAGE */

    this.$ = { type: 'PercentageValue', value: parseFloat(yyvstack[yysp]), unit: '%' };
    break;

case 29:
    /*! Production::    css_value : SUB css_value */

    var prev = yyvstack[yysp]; prev.value *= -1; this.$ = prev;
    break;

}
},
table: bt({
  len: u([
  24,
  1,
  5,
  23,
  1,
  18,
  s,
  [0, 20],
  s,
  [23, 4],
  c,
  [28, 3],
  0,
  0,
  16,
  6,
  6,
  s,
  [0, 3],
  5,
  1,
  0,
  1,
  23,
  5,
  0
]),
  symbol: u([
  4,
  7,
  9,
  s,
  [11, 21, 1],
  1,
  1,
  s,
  [3, 4, 1],
  c,
  [30, 19],
  c,
  [29, 4],
  7,
  4,
  10,
  11,
  c,
  [22, 14],
  31,
  c,
  [42, 23],
  c,
  [23, 69],
  c,
  [138, 4],
  8,
  c,
  [51, 24],
  4,
  c,
  [137, 15],
  c,
  [184, 5],
  8,
  c,
  [6, 6],
  c,
  [5, 5],
  9,
  7,
  c,
  [87, 28]
]),
  type: u([
  s,
  [2, 19],
  s,
  [0, 5],
  1,
  s,
  [2, 24],
  s,
  [0, 4],
  c,
  [22, 19],
  c,
  [42, 41],
  c,
  [23, 70],
  c,
  [28, 25],
  c,
  [45, 25],
  c,
  [59, 23]
]),
  state: u([
  1,
  2,
  8,
  6,
  7,
  30,
  c,
  [4, 3],
  33,
  36,
  c,
  [5, 3],
  37,
  c,
  [4, 3],
  38,
  c,
  [4, 3],
  39,
  c,
  [4, 3],
  41,
  c,
  [21, 4],
  46,
  c,
  [5, 3]
]),
  mode: u([
  s,
  [1, 177],
  s,
  [2, 3],
  c,
  [5, 5],
  c,
  [6, 4],
  s,
  [1, 31]
]),
  goto: u([
  5,
  3,
  4,
  24,
  s,
  [9, 15, 1],
  s,
  [25, 5, 1],
  c,
  [24, 19],
  31,
  35,
  32,
  34,
  c,
  [18, 14],
  c,
  [37, 19],
  c,
  [19, 57],
  c,
  [117, 4],
  40,
  c,
  [24, 19],
  42,
  35,
  c,
  [16, 14],
  s,
  [2, 3],
  28,
  29,
  2,
  s,
  [3, 3],
  28,
  29,
  3,
  c,
  [52, 4],
  43,
  44,
  45,
  c,
  [78, 23],
  47
])
}),
defaultActions: bda({
  idx: u([
  s,
  [6, 20, 1],
  33,
  34,
  38,
  39,
  40,
  43,
  47
]),
  goto: u([
  9,
  10,
  11,
  s,
  [14, 15, 1],
  12,
  1,
  29,
  13,
  s,
  [4, 5, 1]
])
}),
parseError: function parseError(str, hash, ExceptionClass) {
    if (hash.recoverable) {
        if (typeof this.trace === 'function') {
            this.trace(str);
        }
        hash.destroy();             // destroy... well, *almost*!
    } else {
        if (typeof this.trace === 'function') {
            this.trace(str);
        }
        if (!ExceptionClass) {
            ExceptionClass = this.JisonParserError;
        }
        throw new ExceptionClass(str, hash);
    }
},
parse: function parse(input) {
    var self = this;
    var stack = new Array(128);         // token stack: stores token which leads to state at the same index (column storage)
    var sstack = new Array(128);        // state stack: stores states (column storage)

    var vstack = new Array(128);        // semantic value stack

    var table = this.table;
    var sp = 0;                         // 'stack pointer': index into the stacks


    


    var symbol = 0;



    var TERROR = this.TERROR;
    var EOF = this.EOF;
    var ERROR_RECOVERY_TOKEN_DISCARD_COUNT = (this.options.errorRecoveryTokenDiscardCount | 0) || 3;
    var NO_ACTION = [0, 48 /* === table.length :: ensures that anyone using this new state will fail dramatically! */];

    var lexer;
    if (this.__lexer__) {
        lexer = this.__lexer__;
    } else {
        lexer = this.__lexer__ = Object.create(this.lexer);
    }

    var sharedState_yy = {
        parseError: undefined,
        quoteName: undefined,
        lexer: undefined,
        parser: undefined,
        pre_parse: undefined,
        post_parse: undefined,
        pre_lex: undefined,
        post_lex: undefined      // WARNING: must be written this way for the code expanders to work correctly in both ES5 and ES6 modes!
    };

    var ASSERT;
    if (typeof assert !== 'function') {
        ASSERT = function JisonAssert(cond, msg) {
            if (!cond) {
                throw new Error('assertion failed: ' + (msg || '***'));
            }
        };
    } else {
        ASSERT = assert;
    }

    this.yyGetSharedState = function yyGetSharedState() {
        return sharedState_yy;
    };








    function shallow_copy_noclobber(dst, src) {
        for (var k in src) {
            if (typeof dst[k] === 'undefined' && Object.prototype.hasOwnProperty.call(src, k)) {
                dst[k] = src[k];
            }
        }
    }

    // copy state
    shallow_copy_noclobber(sharedState_yy, this.yy);

    sharedState_yy.lexer = lexer;
    sharedState_yy.parser = this;






    // Does the shared state override the default `parseError` that already comes with this instance?
    if (typeof sharedState_yy.parseError === 'function') {
        this.parseError = function parseErrorAlt(str, hash, ExceptionClass) {
            if (!ExceptionClass) {
                ExceptionClass = this.JisonParserError;
            }
            return sharedState_yy.parseError.call(this, str, hash, ExceptionClass);
        };
    } else {
        this.parseError = this.originalParseError;
    }

    // Does the shared state override the default `quoteName` that already comes with this instance?
    if (typeof sharedState_yy.quoteName === 'function') {
        this.quoteName = function quoteNameAlt(id_str) {
            return sharedState_yy.quoteName.call(this, id_str);
        };
    } else {
        this.quoteName = this.originalQuoteName;
    }

    // set up the cleanup function; make it an API so that external code can re-use this one in case of
    // calamities or when the `%options no-try-catch` option has been specified for the grammar, in which
    // case this parse() API method doesn't come with a `finally { ... }` block any more!
    //
    // NOTE: as this API uses parse() as a closure, it MUST be set again on every parse() invocation,
    //       or else your `sharedState`, etc. references will be *wrong*!
    this.cleanupAfterParse = function parser_cleanupAfterParse(resultValue, invoke_post_methods, do_not_nuke_errorinfos) {
        var rv;

        if (invoke_post_methods) {
            var hash;

            if (sharedState_yy.post_parse || this.post_parse) {
                // create an error hash info instance: we re-use this API in a **non-error situation**
                // as this one delivers all parser internals ready for access by userland code.
                hash = this.constructParseErrorInfo(null /* no error! */, null /* no exception! */, null, false);
            }

            if (sharedState_yy.post_parse) {
                rv = sharedState_yy.post_parse.call(this, sharedState_yy, resultValue, hash);
                if (typeof rv !== 'undefined') resultValue = rv;
            }
            if (this.post_parse) {
                rv = this.post_parse.call(this, sharedState_yy, resultValue, hash);
                if (typeof rv !== 'undefined') resultValue = rv;
            }

            // cleanup:
            if (hash && hash.destroy) {
                hash.destroy();
            }
        }

        if (this.__reentrant_call_depth > 1) return resultValue;        // do not (yet) kill the sharedState when this is a reentrant run.

        // clean up the lingering lexer structures as well:
        if (lexer.cleanupAfterLex) {
            lexer.cleanupAfterLex(do_not_nuke_errorinfos);
        }

        // prevent lingering circular references from causing memory leaks:
        if (sharedState_yy) {
            sharedState_yy.lexer = undefined;
            sharedState_yy.parser = undefined;
            if (lexer.yy === sharedState_yy) {
                lexer.yy = undefined;
            }
        }
        sharedState_yy = undefined;
        this.parseError = this.originalParseError;
        this.quoteName = this.originalQuoteName;

        // nuke the vstack[] array at least as that one will still reference obsoleted user values.
        // To be safe, we nuke the other internal stack columns as well...
        stack.length = 0;               // fastest way to nuke an array without overly bothering the GC
        sstack.length = 0;

        vstack.length = 0;
        sp = 0;

        // nuke the error hash info instances created during this run.
        // Userland code must COPY any data/references
        // in the error hash instance(s) it is more permanently interested in.
        if (!do_not_nuke_errorinfos) {
            for (var i = this.__error_infos.length - 1; i >= 0; i--) {
                var el = this.__error_infos[i];
                if (el && typeof el.destroy === 'function') {
                    el.destroy();
                }
            }
            this.__error_infos.length = 0;


        }

        return resultValue;
    };






































































































































    // NOTE: as this API uses parse() as a closure, it MUST be set again on every parse() invocation,
    //       or else your `lexer`, `sharedState`, etc. references will be *wrong*!
    this.constructParseErrorInfo = function parser_constructParseErrorInfo(msg, ex, expected, recoverable) {
        var pei = {
            errStr: msg,
            exception: ex,
            text: lexer.match,
            value: lexer.yytext,
            token: this.describeSymbol(symbol) || symbol,
            token_id: symbol,
            line: lexer.yylineno,

            expected: expected,
            recoverable: recoverable,
            state: state,
            action: action,
            new_state: newState,
            symbol_stack: stack,
            state_stack: sstack,
            value_stack: vstack,

            stack_pointer: sp,
            yy: sharedState_yy,
            lexer: lexer,
            parser: this,

            // and make sure the error info doesn't stay due to potential
            // ref cycle via userland code manipulations.
            // These would otherwise all be memory leak opportunities!
            //
            // Note that only array and object references are nuked as those
            // constitute the set of elements which can produce a cyclic ref.
            // The rest of the members is kept intact as they are harmless.
            destroy: function destructParseErrorInfo() {
                // remove cyclic references added to error info:
                // info.yy = null;
                // info.lexer = null;
                // info.value = null;
                // info.value_stack = null;
                // ...
                var rec = !!this.recoverable;
                for (var key in this) {
                    if (this.hasOwnProperty(key) && typeof key === 'object') {
                        this[key] = undefined;
                    }
                }
                this.recoverable = rec;
            }
        };
        // track this instance so we can `destroy()` it once we deem it superfluous and ready for garbage collection!
        this.__error_infos.push(pei);
        return pei;
    };













    function getNonTerminalFromCode(symbol) {
        var tokenName = self.getSymbolName(symbol);
        if (!tokenName) {
            tokenName = symbol;
        }
        return tokenName;
    }


    function stdLex() {
        var token = lexer.lex();
        // if token isn't its numeric value, convert
        if (typeof token !== 'number') {
            token = self.symbols_[token] || token;
        }

        return token || EOF;
    }

    function fastLex() {
        var token = lexer.fastLex();
        // if token isn't its numeric value, convert
        if (typeof token !== 'number') {
            token = self.symbols_[token] || token;
        }

        return token || EOF;
    }

    var lex = stdLex;


    var state, action, r, t;
    var yyval = {
        $: true,
        _$: undefined,
        yy: sharedState_yy
    };
    var p;
    var yyrulelen;
    var this_production;
    var newState;
    var retval = false;


    try {
        this.__reentrant_call_depth++;

        lexer.setInput(input, sharedState_yy);

        // NOTE: we *assume* no lexer pre/post handlers are set up *after* 
        // this initial `setInput()` call: hence we can now check and decide
        // whether we'll go with the standard, slower, lex() API or the
        // `fast_lex()` one:
        if (typeof lexer.canIUse === 'function') {
            var lexerInfo = lexer.canIUse();
            if (lexerInfo.fastLex && typeof fastLex === 'function') {
                lex = fastLex;
            }
        } 



        vstack[sp] = null;
        sstack[sp] = 0;
        stack[sp] = 0;
        ++sp;





        if (this.pre_parse) {
            this.pre_parse.call(this, sharedState_yy);
        }
        if (sharedState_yy.pre_parse) {
            sharedState_yy.pre_parse.call(this, sharedState_yy);
        }

        newState = sstack[sp - 1];
        for (;;) {
            // retrieve state number from top of stack
            state = newState;               // sstack[sp - 1];

            // use default actions if available
            if (this.defaultActions[state]) {
                action = 2;
                newState = this.defaultActions[state];
            } else {
                // The single `==` condition below covers both these `===` comparisons in a single
                // operation:
                //
                //     if (symbol === null || typeof symbol === 'undefined') ...
                if (!symbol) {
                    symbol = lex();
                }
                // read action for current state and first input
                t = (table[state] && table[state][symbol]) || NO_ACTION;
                newState = t[1];
                action = t[0];











                // handle parse error
                if (!action) {
                    var errStr;
                    var errSymbolDescr = (this.describeSymbol(symbol) || symbol);
                    var expected = this.collect_expected_token_set(state);

                    // Report error
                    if (typeof lexer.yylineno === 'number') {
                        errStr = 'Parse error on line ' + (lexer.yylineno + 1) + ': ';
                    } else {
                        errStr = 'Parse error: ';
                    }
                    if (typeof lexer.showPosition === 'function') {
                        errStr += '\n' + lexer.showPosition(79 - 10, 10) + '\n';
                    }
                    if (expected.length) {
                        errStr += 'Expecting ' + expected.join(', ') + ', got unexpected ' + errSymbolDescr;
                    } else {
                        errStr += 'Unexpected ' + errSymbolDescr;
                    }
                    // we cannot recover from the error!
                    p = this.constructParseErrorInfo(errStr, null, expected, false);
                    r = this.parseError(p.errStr, p, this.JisonParserError);
                    if (typeof r !== 'undefined') {
                        retval = r;
                    }
                    break;
                }


            }










            switch (action) {
            // catch misc. parse failures:
            default:
                // this shouldn't happen, unless resolve defaults are off
                if (action instanceof Array) {
                    p = this.constructParseErrorInfo('Parse Error: multiple actions possible at state: ' + state + ', token: ' + symbol, null, null, false);
                    r = this.parseError(p.errStr, p, this.JisonParserError);
                    if (typeof r !== 'undefined') {
                        retval = r;
                    }
                    break;
                }
                // Another case of better safe than sorry: in case state transitions come out of another error recovery process
                // or a buggy LUT (LookUp Table):
                p = this.constructParseErrorInfo('Parsing halted. No viable error recovery approach available due to internal system failure.', null, null, false);
                r = this.parseError(p.errStr, p, this.JisonParserError);
                if (typeof r !== 'undefined') {
                    retval = r;
                }
                break;

            // shift:
            case 1:
                stack[sp] = symbol;
                vstack[sp] = lexer.yytext;

                sstack[sp] = newState; // push state

                ++sp;
                symbol = 0;




                // Pick up the lexer details for the current symbol as that one is not 'look-ahead' any more:




                continue;

            // reduce:
            case 2:



                this_production = this.productions_[newState - 1];  // `this.productions_[]` is zero-based indexed while states start from 1 upwards...
                yyrulelen = this_production[1];










                r = this.performAction.call(yyval, newState, sp - 1, vstack);

                if (typeof r !== 'undefined') {
                    retval = r;
                    break;
                }

                // pop off stack
                sp -= yyrulelen;

                // don't overwrite the `symbol` variable: use a local var to speed things up:
                var ntsymbol = this_production[0];    // push nonterminal (reduce)
                stack[sp] = ntsymbol;
                vstack[sp] = yyval.$;

                // goto new state = table[STATE][NONTERMINAL]
                newState = table[sstack[sp - 1]][ntsymbol];
                sstack[sp] = newState;
                ++sp;









                continue;

            // accept:
            case 3:
                if (sp !== -2) {
                    retval = true;
                    // Return the `$accept` rule's `$$` result, if available.
                    //
                    // Also note that JISON always adds this top-most `$accept` rule (with implicit,
                    // default, action):
                    //
                    //     $accept: <startSymbol> $end
                    //                  %{ $$ = $1; @$ = @1; %}
                    //
                    // which, combined with the parse kernel's `$accept` state behaviour coded below,
                    // will produce the `$$` value output of the <startSymbol> rule as the parse result,
                    // IFF that result is *not* `undefined`. (See also the parser kernel code.)
                    //
                    // In code:
                    //
                    //                  %{
                    //                      @$ = @1;            // if location tracking support is included
                    //                      if (typeof $1 !== 'undefined')
                    //                          return $1;
                    //                      else
                    //                          return true;           // the default parse result if the rule actions don't produce anything
                    //                  %}
                    sp--;
                    if (typeof vstack[sp] !== 'undefined') {
                        retval = vstack[sp];
                    }
                }
                break;
            }

            // break out of loop: we accept or fail with error
            break;
        }
    } catch (ex) {
        // report exceptions through the parseError callback too, but keep the exception intact
        // if it is a known parser or lexer error which has been thrown by parseError() already:
        if (ex instanceof this.JisonParserError) {
            throw ex;
        }
        else if (lexer && typeof lexer.JisonLexerError === 'function' && ex instanceof lexer.JisonLexerError) {
            throw ex;
        }

        p = this.constructParseErrorInfo('Parsing aborted due to exception.', ex, null, false);
        retval = false;
        r = this.parseError(p.errStr, p, this.JisonParserError);
        if (typeof r !== 'undefined') {
            retval = r;
        }
    } finally {
        retval = this.cleanupAfterParse(retval, true, true);
        this.__reentrant_call_depth--;
    }   // /finally

    return retval;
}
};
parser.originalParseError = parser.parseError;
parser.originalQuoteName = parser.quoteName;
/* lexer generated by jison-lex 0.6.1-215 */

/*
 * Returns a Lexer object of the following structure:
 *
 *  Lexer: {
 *    yy: {}     The so-called "shared state" or rather the *source* of it;
 *               the real "shared state" `yy` passed around to
 *               the rule actions, etc. is a direct reference!
 *
 *               This "shared context" object was passed to the lexer by way of 
 *               the `lexer.setInput(str, yy)` API before you may use it.
 *
 *               This "shared context" object is passed to the lexer action code in `performAction()`
 *               so userland code in the lexer actions may communicate with the outside world 
 *               and/or other lexer rules' actions in more or less complex ways.
 *
 *  }
 *
 *  Lexer.prototype: {
 *    EOF: 1,
 *    ERROR: 2,
 *
 *    yy:        The overall "shared context" object reference.
 *
 *    JisonLexerError: function(msg, hash),
 *
 *    performAction: function lexer__performAction(yy, yyrulenumber, YY_START),
 *
 *               The function parameters and `this` have the following value/meaning:
 *               - `this`    : reference to the `lexer` instance. 
 *                               `yy_` is an alias for `this` lexer instance reference used internally.
 *
 *               - `yy`      : a reference to the `yy` "shared state" object which was passed to the lexer
 *                             by way of the `lexer.setInput(str, yy)` API before.
 *
 *                             Note:
 *                             The extra arguments you specified in the `%parse-param` statement in your
 *                             **parser** grammar definition file are passed to the lexer via this object
 *                             reference as member variables.
 *
 *               - `yyrulenumber`   : index of the matched lexer rule (regex), used internally.
 *
 *               - `YY_START`: the current lexer "start condition" state.
 *
 *    parseError: function(str, hash, ExceptionClass),
 *
 *    constructLexErrorInfo: function(error_message, is_recoverable),
 *               Helper function.
 *               Produces a new errorInfo 'hash object' which can be passed into `parseError()`.
 *               See it's use in this lexer kernel in many places; example usage:
 *
 *                   var infoObj = lexer.constructParseErrorInfo('fail!', true);
 *                   var retVal = lexer.parseError(infoObj.errStr, infoObj, lexer.JisonLexerError);
 *
 *    options: { ... lexer %options ... },
 *
 *    lex: function(),
 *               Produce one token of lexed input, which was passed in earlier via the `lexer.setInput()` API.
 *               You MAY use the additional `args...` parameters as per `%parse-param` spec of the **lexer** grammar:
 *               these extra `args...` are added verbatim to the `yy` object reference as member variables.
 *
 *               WARNING:
 *               Lexer's additional `args...` parameters (via lexer's `%parse-param`) MAY conflict with
 *               any attributes already added to `yy` by the **parser** or the jison run-time; 
 *               when such a collision is detected an exception is thrown to prevent the generated run-time 
 *               from silently accepting this confusing and potentially hazardous situation! 
 *
 *    cleanupAfterLex: function(do_not_nuke_errorinfos),
 *               Helper function.
 *
 *               This helper API is invoked when the **parse process** has completed: it is the responsibility
 *               of the **parser** (or the calling userland code) to invoke this method once cleanup is desired. 
 *
 *               This helper may be invoked by user code to ensure the internal lexer gets properly garbage collected.
 *
 *    setInput: function(input, [yy]),
 *
 *
 *    input: function(),
 *
 *
 *    unput: function(str),
 *
 *
 *    more: function(),
 *
 *
 *    reject: function(),
 *
 *
 *    less: function(n),
 *
 *
 *    pastInput: function(n),
 *
 *
 *    upcomingInput: function(n),
 *
 *
 *    showPosition: function(),
 *
 *
 *    test_match: function(regex_match_array, rule_index),
 *
 *
 *    next: function(),
 *
 *
 *    begin: function(condition),
 *
 *
 *    pushState: function(condition),
 *
 *
 *    popState: function(),
 *
 *
 *    topState: function(),
 *
 *
 *    _currentRules: function(),
 *
 *
 *    stateStackSize: function(),
 *
 *
 *    performAction: function(yy, yy_, yyrulenumber, YY_START),
 *
 *
 *    rules: [...],
 *
 *
 *    conditions: {associative list: name ==> set},
 *  }
 *
 *
 *  token location info (`yylloc`): {
 *    first_line: n,
 *    last_line: n,
 *    first_column: n,
 *    last_column: n,
 *    range: [start_number, end_number]
 *               (where the numbers are indexes into the input string, zero-based)
 *  }
 *
 * ---
 *
 * The `parseError` function receives a 'hash' object with these members for lexer errors:
 *
 *  {
 *    text:        (matched text)
 *    token:       (the produced terminal token, if any)
 *    token_id:    (the produced terminal token numeric ID, if any)
 *    line:        (yylineno)
 *    loc:         (yylloc)
 *    recoverable: (boolean: TRUE when the parser MAY have an error recovery rule
 *                  available for this particular error)
 *    yy:          (object: the current parser internal "shared state" `yy`
 *                  as is also available in the rule actions; this can be used,
 *                  for instance, for advanced error analysis and reporting)
 *    lexer:       (reference to the current lexer instance used by the parser)
 *  }
 *
 * while `this` will reference the current lexer instance.
 *
 * When `parseError` is invoked by the lexer, the default implementation will
 * attempt to invoke `yy.parser.parseError()`; when this callback is not provided
 * it will try to invoke `yy.parseError()` instead. When that callback is also not
 * provided, a `JisonLexerError` exception will be thrown containing the error
 * message and `hash`, as constructed by the `constructLexErrorInfo()` API.
 *
 * Note that the lexer's `JisonLexerError` error class is passed via the
 * `ExceptionClass` argument, which is invoked to construct the exception
 * instance to be thrown, so technically `parseError` will throw the object
 * produced by the `new ExceptionClass(str, hash)` JavaScript expression.
 *
 * ---
 *
 * You can specify lexer options by setting / modifying the `.options` object of your Lexer instance.
 * These options are available:
 *
 * (Options are permanent.)
 *  
 *  yy: {
 *      parseError: function(str, hash, ExceptionClass)
 *                 optional: overrides the default `parseError` function.
 *  }
 *
 *  lexer.options: {
 *      pre_lex:  function()
 *                 optional: is invoked before the lexer is invoked to produce another token.
 *                 `this` refers to the Lexer object.
 *      post_lex: function(token) { return token; }
 *                 optional: is invoked when the lexer has produced a token `token`;
 *                 this function can override the returned token value by returning another.
 *                 When it does not return any (truthy) value, the lexer will return
 *                 the original `token`.
 *                 `this` refers to the Lexer object.
 *
 * WARNING: the next set of options are not meant to be changed. They echo the abilities of
 * the lexer as per when it was compiled!
 *
 *      ranges: boolean
 *                 optional: `true` ==> token location info will include a .range[] member.
 *      flex: boolean
 *                 optional: `true` ==> flex-like lexing behaviour where the rules are tested
 *                 exhaustively to find the longest match.
 *      backtrack_lexer: boolean
 *                 optional: `true` ==> lexer regexes are tested in order and for invoked;
 *                 the lexer terminates the scan when a token is returned by the action code.
 *      xregexp: boolean
 *                 optional: `true` ==> lexer rule regexes are "extended regex format" requiring the
 *                 `XRegExp` library. When this %option has not been specified at compile time, all lexer
 *                 rule regexes have been written as standard JavaScript RegExp expressions.
 *  }
 */


var lexer = function() {
  /**
   * See also:
   * http://stackoverflow.com/questions/1382107/whats-a-good-way-to-extend-error-in-javascript/#35881508
   * but we keep the prototype.constructor and prototype.name assignment lines too for compatibility
   * with userland code which might access the derived class in a 'classic' way.
   *
   * @public
   * @constructor
   * @nocollapse
   */
  function JisonLexerError(msg, hash) {
    Object.defineProperty(this, 'name', {
      enumerable: false,
      writable: false,
      value: 'JisonLexerError'
    });

    if (msg == null)
      msg = '???';

    Object.defineProperty(this, 'message', {
      enumerable: false,
      writable: true,
      value: msg
    });

    this.hash = hash;
    var stacktrace;

    if (hash && hash.exception instanceof Error) {
      var ex2 = hash.exception;
      this.message = ex2.message || msg;
      stacktrace = ex2.stack;
    }

    if (!stacktrace) {
      if (Error.hasOwnProperty('captureStackTrace')) {
        // V8
        Error.captureStackTrace(this, this.constructor);
      } else {
        stacktrace = new Error(msg).stack;
      }
    }

    if (stacktrace) {
      Object.defineProperty(this, 'stack', {
        enumerable: false,
        writable: false,
        value: stacktrace
      });
    }
  }

  if (typeof Object.setPrototypeOf === 'function') {
    Object.setPrototypeOf(JisonLexerError.prototype, Error.prototype);
  } else {
    JisonLexerError.prototype = Object.create(Error.prototype);
  }

  JisonLexerError.prototype.constructor = JisonLexerError;
  JisonLexerError.prototype.name = 'JisonLexerError';

  var lexer = {
    
// Code Generator Information Report
// ---------------------------------
//
// Options:
//
//   backtracking: .................... false
//   location.ranges: ................. false
//   location line+column tracking: ... true
//
//
// Forwarded Parser Analysis flags:
//
//   uses yyleng: ..................... false
//   uses yylineno: ................... false
//   uses yytext: ..................... false
//   uses yylloc: ..................... false
//   uses lexer values: ............... true / true
//   location tracking: ............... false
//   location assignment: ............. false
//
//
// Lexer Analysis flags:
//
//   uses yyleng: ..................... ???
//   uses yylineno: ................... ???
//   uses yytext: ..................... ???
//   uses yylloc: ..................... ???
//   uses ParseError API: ............. ???
//   uses yyerror: .................... ???
//   uses location tracking & editing:  ???
//   uses more() API: ................. ???
//   uses unput() API: ................ ???
//   uses reject() API: ............... ???
//   uses less() API: ................. ???
//   uses display APIs pastInput(), upcomingInput(), showPosition():
//        ............................. ???
//   uses describeYYLLOC() API: ....... ???
//
// --------- END OF REPORT -----------

EOF: 1,
    ERROR: 2,

    // JisonLexerError: JisonLexerError,        /// <-- injected by the code generator

    // options: {},                             /// <-- injected by the code generator

    // yy: ...,                                 /// <-- injected by setInput()

    __currentRuleSet__: null,                   /// INTERNAL USE ONLY: internal rule set cache for the current lexer state  

    __error_infos: [],                          /// INTERNAL USE ONLY: the set of lexErrorInfo objects created since the last cleanup  
    __decompressed: false,                      /// INTERNAL USE ONLY: mark whether the lexer instance has been 'unfolded' completely and is now ready for use  
    done: false,                                /// INTERNAL USE ONLY  
    _backtrack: false,                          /// INTERNAL USE ONLY  
    _input: '',                                 /// INTERNAL USE ONLY  
    _more: false,                               /// INTERNAL USE ONLY  
    _signaled_error_token: false,               /// INTERNAL USE ONLY  
    conditionStack: [],                         /// INTERNAL USE ONLY; managed via `pushState()`, `popState()`, `topState()` and `stateStackSize()`  
    match: '',                                  /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: tracks input which has been matched so far for the lexer token under construction. `match` is identical to `yytext` except that this one still contains the matched input string after `lexer.performAction()` has been invoked, where userland code MAY have changed/replaced the `yytext` value entirely!  
    matched: '',                                /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: tracks entire input which has been matched so far  
    matches: false,                             /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: tracks RE match result for last (successful) match attempt  
    yytext: '',                                 /// ADVANCED USE ONLY: tracks input which has been matched so far for the lexer token under construction; this value is transferred to the parser as the 'token value' when the parser consumes the lexer token produced through a call to the `lex()` API.  
    offset: 0,                                  /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: tracks the 'cursor position' in the input string, i.e. the number of characters matched so far  
    yyleng: 0,                                  /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: length of matched input for the token under construction (`yytext`)  
    yylineno: 0,                                /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: 'line number' at which the token under construction is located  
    yylloc: null,                               /// READ-ONLY EXTERNAL ACCESS - ADVANCED USE ONLY: tracks location info (lines + columns) for the token under construction  

    /**
     * INTERNAL USE: construct a suitable error info hash object instance for `parseError`.
     * 
     * @public
     * @this {RegExpLexer}
     */
    constructLexErrorInfo: function lexer_constructLexErrorInfo(msg, recoverable, show_input_position) {
      msg = '' + msg;

      // heuristic to determine if the error message already contains a (partial) source code dump
      // as produced by either `showPosition()` or `prettyPrintRange()`:
      if (show_input_position == undefined) {
        show_input_position = !(msg.indexOf('\n') > 0 && msg.indexOf('^') > 0);
      }

      if (this.yylloc && show_input_position) {
        if (typeof this.prettyPrintRange === 'function') {
          var pretty_src = this.prettyPrintRange(this.yylloc);

          if (!/\n\s*$/.test(msg)) {
            msg += '\n';
          }

          msg += '\n  Erroneous area:\n' + this.prettyPrintRange(this.yylloc);
        } else if (typeof this.showPosition === 'function') {
          var pos_str = this.showPosition();

          if (pos_str) {
            if (msg.length && msg[msg.length - 1] !== '\n' && pos_str[0] !== '\n') {
              msg += '\n' + pos_str;
            } else {
              msg += pos_str;
            }
          }
        }
      }

      /** @constructor */
      var pei = {
        errStr: msg,
        recoverable: !!recoverable,
        text: this.match,           // This one MAY be empty; userland code should use the `upcomingInput` API to obtain more text which follows the 'lexer cursor position'...  
        token: null,
        line: this.yylineno,
        loc: this.yylloc,
        yy: this.yy,
        lexer: this,

        /**
         * and make sure the error info doesn't stay due to potential
         * ref cycle via userland code manipulations.
         * These would otherwise all be memory leak opportunities!
         * 
         * Note that only array and object references are nuked as those
         * constitute the set of elements which can produce a cyclic ref.
         * The rest of the members is kept intact as they are harmless.
         * 
         * @public
         * @this {LexErrorInfo}
         */
        destroy: function destructLexErrorInfo() {
          // remove cyclic references added to error info:
          // info.yy = null;
          // info.lexer = null;
          // ...
          var rec = !!this.recoverable;

          for (var key in this) {
            if (this.hasOwnProperty(key) && typeof key === 'object') {
              this[key] = undefined;
            }
          }

          this.recoverable = rec;
        }
      };

      // track this instance so we can `destroy()` it once we deem it superfluous and ready for garbage collection!
      this.__error_infos.push(pei);

      return pei;
    },

    /**
     * handler which is invoked when a lexer error occurs.
     * 
     * @public
     * @this {RegExpLexer}
     */
    parseError: function lexer_parseError(str, hash, ExceptionClass) {
      if (!ExceptionClass) {
        ExceptionClass = this.JisonLexerError;
      }

      if (this.yy) {
        if (this.yy.parser && typeof this.yy.parser.parseError === 'function') {
          return this.yy.parser.parseError.call(this, str, hash, ExceptionClass) || this.ERROR;
        } else if (typeof this.yy.parseError === 'function') {
          return this.yy.parseError.call(this, str, hash, ExceptionClass) || this.ERROR;
        }
      }

      throw new ExceptionClass(str, hash);
    },

    /**
     * method which implements `yyerror(str, ...args)` functionality for use inside lexer actions.
     * 
     * @public
     * @this {RegExpLexer}
     */
    yyerror: function yyError(str /*, ...args */) {
      var lineno_msg = '';

      if (this.yylloc) {
        lineno_msg = ' on line ' + (this.yylineno + 1);
      }

      var p = this.constructLexErrorInfo(
        'Lexical error' + lineno_msg + ': ' + str,
        this.options.lexerErrorsAreRecoverable
      );

      // Add any extra args to the hash under the name `extra_error_attributes`:
      var args = Array.prototype.slice.call(arguments, 1);

      if (args.length) {
        p.extra_error_attributes = args;
      }

      return this.parseError(p.errStr, p, this.JisonLexerError) || this.ERROR;
    },

    /**
     * final cleanup function for when we have completed lexing the input;
     * make it an API so that external code can use this one once userland
     * code has decided it's time to destroy any lingering lexer error
     * hash object instances and the like: this function helps to clean
     * up these constructs, which *may* carry cyclic references which would
     * otherwise prevent the instances from being properly and timely
     * garbage-collected, i.e. this function helps prevent memory leaks!
     * 
     * @public
     * @this {RegExpLexer}
     */
    cleanupAfterLex: function lexer_cleanupAfterLex(do_not_nuke_errorinfos) {
      // prevent lingering circular references from causing memory leaks:
      this.setInput('', {});

      // nuke the error hash info instances created during this run.
      // Userland code must COPY any data/references
      // in the error hash instance(s) it is more permanently interested in.
      if (!do_not_nuke_errorinfos) {
        for (var i = this.__error_infos.length - 1; i >= 0; i--) {
          var el = this.__error_infos[i];

          if (el && typeof el.destroy === 'function') {
            el.destroy();
          }
        }

        this.__error_infos.length = 0;
      }

      return this;
    },

    /**
     * clear the lexer token context; intended for internal use only
     * 
     * @public
     * @this {RegExpLexer}
     */
    clear: function lexer_clear() {
      this.yytext = '';
      this.yyleng = 0;
      this.match = '';

      // - DO NOT reset `this.matched`
      this.matches = false;

      this._more = false;
      this._backtrack = false;
      var col = (this.yylloc ? this.yylloc.last_column : 0);

      this.yylloc = {
        first_line: this.yylineno + 1,
        first_column: col,
        last_line: this.yylineno + 1,
        last_column: col,
        range: [this.offset, this.offset]
      };
    },

    /**
     * resets the lexer, sets new input
     * 
     * @public
     * @this {RegExpLexer}
     */
    setInput: function lexer_setInput(input, yy) {
      this.yy = yy || this.yy || {};

      // also check if we've fully initialized the lexer instance,
      // including expansion work to be done to go from a loaded
      // lexer to a usable lexer:
      if (!this.__decompressed) {
        // step 1: decompress the regex list:
        var rules = this.rules;

        for (var i = 0, len = rules.length; i < len; i++) {
          var rule_re = rules[i];

          // compression: is the RE an xref to another RE slot in the rules[] table?
          if (typeof rule_re === 'number') {
            rules[i] = rules[rule_re];
          }
        }

        // step 2: unfold the conditions[] set to make these ready for use:
        var conditions = this.conditions;

        for (var k in conditions) {
          var spec = conditions[k];
          var rule_ids = spec.rules;
          var len = rule_ids.length;
          var rule_regexes = new Array(len + 1);             // slot 0 is unused; we use a 1-based index approach here to keep the hottest code in `lexer_next()` fast and simple! 
          var rule_new_ids = new Array(len + 1);

          for (var i = 0; i < len; i++) {
            var idx = rule_ids[i];
            var rule_re = rules[idx];
            rule_regexes[i + 1] = rule_re;
            rule_new_ids[i + 1] = idx;
          }

          spec.rules = rule_new_ids;
          spec.__rule_regexes = rule_regexes;
          spec.__rule_count = len;
        }

        this.__decompressed = true;
      }

      this._input = input || '';
      this.clear();
      this._signaled_error_token = false;
      this.done = false;
      this.yylineno = 0;
      this.matched = '';
      this.conditionStack = ['INITIAL'];
      this.__currentRuleSet__ = null;

      this.yylloc = {
        first_line: 1,
        first_column: 0,
        last_line: 1,
        last_column: 0,
        range: [0, 0]
      };

      this.offset = 0;
      return this;
    },

    /**
     * edit the remaining input via user-specified callback.
     * This can be used to forward-adjust the input-to-parse, 
     * e.g. inserting macro expansions and alike in the
     * input which has yet to be lexed.
     * The behaviour of this API contrasts the `unput()` et al
     * APIs as those act on the *consumed* input, while this
     * one allows one to manipulate the future, without impacting
     * the current `yyloc` cursor location or any history. 
     * 
     * Use this API to help implement C-preprocessor-like
     * `#include` statements, etc.
     * 
     * The provided callback must be synchronous and is
     * expected to return the edited input (string).
     *
     * The `cpsArg` argument value is passed to the callback
     * as-is.
     *
     * `callback` interface: 
     * `function callback(input, cpsArg)`
     * 
     * - `input` will carry the remaining-input-to-lex string
     *   from the lexer.
     * - `cpsArg` is `cpsArg` passed into this API.
     * 
     * The `this` reference for the callback will be set to
     * reference this lexer instance so that userland code
     * in the callback can easily and quickly access any lexer
     * API. 
     *
     * When the callback returns a non-string-type falsey value,
     * we assume the callback did not edit the input and we
     * will using the input as-is.
     *
     * When the callback returns a non-string-type value, it
     * is converted to a string for lexing via the `"" + retval`
     * operation. (See also why: http://2ality.com/2012/03/converting-to-string.html 
     * -- that way any returned object's `toValue()` and `toString()`
     * methods will be invoked in a proper/desirable order.)
     * 
     * @public
     * @this {RegExpLexer}
     */
    editRemainingInput: function lexer_editRemainingInput(callback, cpsArg) {
      var rv = callback.call(this, this._input, cpsArg);

      if (typeof rv !== 'string') {
        if (rv) {
          this._input = '' + rv;
        } 
        // else: keep `this._input` as is.  
      } else {
        this._input = rv;
      }

      return this;
    },

    /**
     * consumes and returns one char from the input
     * 
     * @public
     * @this {RegExpLexer}
     */
    input: function lexer_input() {
      if (!this._input) {
        //this.done = true;    -- don't set `done` as we want the lex()/next() API to be able to produce one custom EOF token match after this anyhow. (lexer can match special <<EOF>> tokens and perform user action code for a <<EOF>> match, but only does so *once*)
        return null;
      }

      var ch = this._input[0];
      this.yytext += ch;
      this.yyleng++;
      this.offset++;
      this.match += ch;
      this.matched += ch;

      // Count the linenumber up when we hit the LF (or a stand-alone CR).
      // On CRLF, the linenumber is incremented when you fetch the CR or the CRLF combo
      // and we advance immediately past the LF as well, returning both together as if
      // it was all a single 'character' only.
      var slice_len = 1;

      var lines = false;

      if (ch === '\n') {
        lines = true;
      } else if (ch === '\r') {
        lines = true;
        var ch2 = this._input[1];

        if (ch2 === '\n') {
          slice_len++;
          ch += ch2;
          this.yytext += ch2;
          this.yyleng++;
          this.offset++;
          this.match += ch2;
          this.matched += ch2;
          this.yylloc.range[1]++;
        }
      }

      if (lines) {
        this.yylineno++;
        this.yylloc.last_line++;
        this.yylloc.last_column = 0;
      } else {
        this.yylloc.last_column++;
      }

      this.yylloc.range[1]++;
      this._input = this._input.slice(slice_len);
      return ch;
    },

    /**
     * unshifts one char (or an entire string) into the input
     * 
     * @public
     * @this {RegExpLexer}
     */
    unput: function lexer_unput(ch) {
      var len = ch.length;
      var lines = ch.split(/(?:\r\n?|\n)/g);
      this._input = ch + this._input;
      this.yytext = this.yytext.substr(0, this.yytext.length - len);
      this.yyleng = this.yytext.length;
      this.offset -= len;
      this.match = this.match.substr(0, this.match.length - len);
      this.matched = this.matched.substr(0, this.matched.length - len);

      if (lines.length > 1) {
        this.yylineno -= lines.length - 1;
        this.yylloc.last_line = this.yylineno + 1;

        // Get last entirely matched line into the `pre_lines[]` array's
        // last index slot; we don't mind when other previously 
        // matched lines end up in the array too. 
        var pre = this.match;

        var pre_lines = pre.split(/(?:\r\n?|\n)/g);

        if (pre_lines.length === 1) {
          pre = this.matched;
          pre_lines = pre.split(/(?:\r\n?|\n)/g);
        }

        this.yylloc.last_column = pre_lines[pre_lines.length - 1].length;
      } else {
        this.yylloc.last_column -= len;
      }

      this.yylloc.range[1] = this.yylloc.range[0] + this.yyleng;
      this.done = false;
      return this;
    },

    /**
     * cache matched text and append it on next action
     * 
     * @public
     * @this {RegExpLexer}
     */
    more: function lexer_more() {
      this._more = true;
      return this;
    },

    /**
     * signal the lexer that this rule fails to match the input, so the
     * next matching rule (regex) should be tested instead.
     * 
     * @public
     * @this {RegExpLexer}
     */
    reject: function lexer_reject() {
      if (this.options.backtrack_lexer) {
        this._backtrack = true;
      } else {
        // when the `parseError()` call returns, we MUST ensure that the error is registered.
        // We accomplish this by signaling an 'error' token to be produced for the current
        // `.lex()` run.
        var lineno_msg = '';

        if (this.yylloc) {
          lineno_msg = ' on line ' + (this.yylineno + 1);
        }

        var p = this.constructLexErrorInfo(
          'Lexical error' + lineno_msg + ': You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).',
          false
        );

        this._signaled_error_token = this.parseError(p.errStr, p, this.JisonLexerError) || this.ERROR;
      }

      return this;
    },

    /**
     * retain first n characters of the match
     * 
     * @public
     * @this {RegExpLexer}
     */
    less: function lexer_less(n) {
      return this.unput(this.match.slice(n));
    },

    /**
     * return (part of the) already matched input, i.e. for error
     * messages.
     * 
     * Limit the returned string length to `maxSize` (default: 20).
     * 
     * Limit the returned string to the `maxLines` number of lines of
     * input (default: 1).
     * 
     * Negative limit values equal *unlimited*.
     * 
     * @public
     * @this {RegExpLexer}
     */
    pastInput: function lexer_pastInput(maxSize, maxLines) {
      var past = this.matched.substring(0, this.matched.length - this.match.length);

      if (maxSize < 0)
        maxSize = past.length;
      else if (!maxSize)
        maxSize = 20;

      if (maxLines < 0)
        maxLines = past.length;          // can't ever have more input lines than this! 
      else if (!maxLines)
        maxLines = 1;

      // `substr` anticipation: treat \r\n as a single character and take a little
      // more than necessary so that we can still properly check against maxSize
      // after we've transformed and limited the newLines in here:
      past = past.substr(-maxSize * 2 - 2);

      // now that we have a significantly reduced string to process, transform the newlines
      // and chop them, then limit them:
      var a = past.replace(/\r\n|\r/g, '\n').split('\n');

      a = a.slice(-maxLines);
      past = a.join('\n');

      // When, after limiting to maxLines, we still have too much to return,
      // do add an ellipsis prefix...
      if (past.length > maxSize) {
        past = '...' + past.substr(-maxSize);
      }

      return past;
    },

    /**
     * return (part of the) upcoming input, i.e. for error messages.
     * 
     * Limit the returned string length to `maxSize` (default: 20).
     * 
     * Limit the returned string to the `maxLines` number of lines of input (default: 1).
     * 
     * Negative limit values equal *unlimited*.
     *
     * > ### NOTE ###
     * >
     * > *"upcoming input"* is defined as the whole of the both
     * > the *currently lexed* input, together with any remaining input
     * > following that. *"currently lexed"* input is the input 
     * > already recognized by the lexer but not yet returned with
     * > the lexer token. This happens when you are invoking this API
     * > from inside any lexer rule action code block. 
     * >
     * 
     * @public
     * @this {RegExpLexer}
     */
    upcomingInput: function lexer_upcomingInput(maxSize, maxLines) {
      var next = this.match;

      if (maxSize < 0)
        maxSize = next.length + this._input.length;
      else if (!maxSize)
        maxSize = 20;

      if (maxLines < 0)
        maxLines = maxSize;          // can't ever have more input lines than this! 
      else if (!maxLines)
        maxLines = 1;

      // `substring` anticipation: treat \r\n as a single character and take a little
      // more than necessary so that we can still properly check against maxSize
      // after we've transformed and limited the newLines in here:
      if (next.length < maxSize * 2 + 2) {
        next += this._input.substring(0, maxSize * 2 + 2);   // substring is faster on Chrome/V8 
      }

      // now that we have a significantly reduced string to process, transform the newlines
      // and chop them, then limit them:
      var a = next.replace(/\r\n|\r/g, '\n').split('\n');

      a = a.slice(0, maxLines);
      next = a.join('\n');

      // When, after limiting to maxLines, we still have too much to return,
      // do add an ellipsis postfix...
      if (next.length > maxSize) {
        next = next.substring(0, maxSize) + '...';
      }

      return next;
    },

    /**
     * return a string which displays the character position where the
     * lexing error occurred, i.e. for error messages
     * 
     * @public
     * @this {RegExpLexer}
     */
    showPosition: function lexer_showPosition(maxPrefix, maxPostfix) {
      var pre = this.pastInput(maxPrefix).replace(/\s/g, ' ');
      var c = new Array(pre.length + 1).join('-');
      return pre + this.upcomingInput(maxPostfix).replace(/\s/g, ' ') + '\n' + c + '^';
    },

    /**
     * return an YYLLOC info object derived off the given context (actual, preceding, following, current).
     * Use this method when the given `actual` location is not guaranteed to exist (i.e. when
     * it MAY be NULL) and you MUST have a valid location info object anyway:
     * then we take the given context of the `preceding` and `following` locations, IFF those are available,
     * and reconstruct the `actual` location info from those.
     * If this fails, the heuristic is to take the `current` location, IFF available.
     * If this fails as well, we assume the sought location is at/around the current lexer position
     * and then produce that one as a response. DO NOTE that these heuristic/derived location info
     * values MAY be inaccurate!
     *
     * NOTE: `deriveLocationInfo()` ALWAYS produces a location info object *copy* of `actual`, not just
     * a *reference* hence all input location objects can be assumed to be 'constant' (function has no side-effects).
     * 
     * @public
     * @this {RegExpLexer}
     */
    deriveLocationInfo: function lexer_deriveYYLLOC(actual, preceding, following, current) {
      var loc = {
        first_line: 1,
        first_column: 0,
        last_line: 1,
        last_column: 0,
        range: [0, 0]
      };

      if (actual) {
        loc.first_line = actual.first_line | 0;
        loc.last_line = actual.last_line | 0;
        loc.first_column = actual.first_column | 0;
        loc.last_column = actual.last_column | 0;

        if (actual.range) {
          loc.range[0] = actual.range[0] | 0;
          loc.range[1] = actual.range[1] | 0;
        }
      }

      if (loc.first_line <= 0 || loc.last_line < loc.first_line) {
        // plan B: heuristic using preceding and following:
        if (loc.first_line <= 0 && preceding) {
          loc.first_line = preceding.last_line | 0;
          loc.first_column = preceding.last_column | 0;

          if (preceding.range) {
            loc.range[0] = actual.range[1] | 0;
          }
        }

        if ((loc.last_line <= 0 || loc.last_line < loc.first_line) && following) {
          loc.last_line = following.first_line | 0;
          loc.last_column = following.first_column | 0;

          if (following.range) {
            loc.range[1] = actual.range[0] | 0;
          }
        }

        // plan C?: see if the 'current' location is useful/sane too:
        if (loc.first_line <= 0 && current && (loc.last_line <= 0 || current.last_line <= loc.last_line)) {
          loc.first_line = current.first_line | 0;
          loc.first_column = current.first_column | 0;

          if (current.range) {
            loc.range[0] = current.range[0] | 0;
          }
        }

        if (loc.last_line <= 0 && current && (loc.first_line <= 0 || current.first_line >= loc.first_line)) {
          loc.last_line = current.last_line | 0;
          loc.last_column = current.last_column | 0;

          if (current.range) {
            loc.range[1] = current.range[1] | 0;
          }
        }
      }

      // sanitize: fix last_line BEFORE we fix first_line as we use the 'raw' value of the latter
      // or plan D heuristics to produce a 'sensible' last_line value:
      if (loc.last_line <= 0) {
        if (loc.first_line <= 0) {
          loc.first_line = this.yylloc.first_line;
          loc.last_line = this.yylloc.last_line;
          loc.first_column = this.yylloc.first_column;
          loc.last_column = this.yylloc.last_column;
          loc.range[0] = this.yylloc.range[0];
          loc.range[1] = this.yylloc.range[1];
        } else {
          loc.last_line = this.yylloc.last_line;
          loc.last_column = this.yylloc.last_column;
          loc.range[1] = this.yylloc.range[1];
        }
      }

      if (loc.first_line <= 0) {
        loc.first_line = loc.last_line;
        loc.first_column = 0;  // loc.last_column; 
        loc.range[1] = loc.range[0];
      }

      if (loc.first_column < 0) {
        loc.first_column = 0;
      }

      if (loc.last_column < 0) {
        loc.last_column = (loc.first_column > 0 ? loc.first_column : 80);
      }

      return loc;
    },

    /**
     * return a string which displays the lines & columns of input which are referenced 
     * by the given location info range, plus a few lines of context.
     * 
     * This function pretty-prints the indicated section of the input, with line numbers 
     * and everything!
     * 
     * This function is very useful to provide highly readable error reports, while
     * the location range may be specified in various flexible ways:
     * 
     * - `loc` is the location info object which references the area which should be
     *   displayed and 'marked up': these lines & columns of text are marked up by `^`
     *   characters below each character in the entire input range.
     * 
     * - `context_loc` is the *optional* location info object which instructs this
     *   pretty-printer how much *leading* context should be displayed alongside
     *   the area referenced by `loc`. This can help provide context for the displayed
     *   error, etc.
     * 
     *   When this location info is not provided, a default context of 3 lines is
     *   used.
     * 
     * - `context_loc2` is another *optional* location info object, which serves
     *   a similar purpose to `context_loc`: it specifies the amount of *trailing*
     *   context lines to display in the pretty-print output.
     * 
     *   When this location info is not provided, a default context of 1 line only is
     *   used.
     * 
     * Special Notes:
     * 
     * - when the `loc`-indicated range is very large (about 5 lines or more), then
     *   only the first and last few lines of this block are printed while a
     *   `...continued...` message will be printed between them.
     * 
     *   This serves the purpose of not printing a huge amount of text when the `loc`
     *   range happens to be huge: this way a manageable & readable output results
     *   for arbitrary large ranges.
     * 
     * - this function can display lines of input which whave not yet been lexed.
     *   `prettyPrintRange()` can access the entire input!
     * 
     * @public
     * @this {RegExpLexer}
     */
    prettyPrintRange: function lexer_prettyPrintRange(loc, context_loc, context_loc2) {
      loc = this.deriveLocationInfo(loc, context_loc, context_loc2);
      const CONTEXT = 3;
      const CONTEXT_TAIL = 1;
      const MINIMUM_VISIBLE_NONEMPTY_LINE_COUNT = 2;
      var input = this.matched + this._input;
      var lines = input.split('\n');
      var l0 = Math.max(1, (context_loc ? context_loc.first_line : loc.first_line - CONTEXT));
      var l1 = Math.max(1, (context_loc2 ? context_loc2.last_line : loc.last_line + CONTEXT_TAIL));
      var lineno_display_width = 1 + Math.log10(l1 | 1) | 0;
      var ws_prefix = new Array(lineno_display_width).join(' ');
      var nonempty_line_indexes = [];

      var rv = lines.slice(l0 - 1, l1 + 1).map(function injectLineNumber(line, index) {
        var lno = index + l0;
        var lno_pfx = (ws_prefix + lno).substr(-lineno_display_width);
        var rv = lno_pfx + ': ' + line;
        var errpfx = new Array(lineno_display_width + 1).join('^');
        var offset = 2 + 1;
        var len = 0;

        if (lno === loc.first_line) {
          offset += loc.first_column;

          len = Math.max(
            2,
            ((lno === loc.last_line ? loc.last_column : line.length)) - loc.first_column + 1
          );
        } else if (lno === loc.last_line) {
          len = Math.max(2, loc.last_column + 1);
        } else if (lno > loc.first_line && lno < loc.last_line) {
          len = Math.max(2, line.length + 1);
        }

        if (len) {
          var lead = new Array(offset).join('.');
          var mark = new Array(len).join('^');
          rv += '\n' + errpfx + lead + mark;

          if (line.trim().length > 0) {
            nonempty_line_indexes.push(index);
          }
        }

        rv = rv.replace(/\t/g, ' ');
        return rv;
      });

      // now make sure we don't print an overly large amount of error area: limit it 
      // to the top and bottom line count:
      if (nonempty_line_indexes.length > 2 * MINIMUM_VISIBLE_NONEMPTY_LINE_COUNT) {
        var clip_start = nonempty_line_indexes[MINIMUM_VISIBLE_NONEMPTY_LINE_COUNT - 1] + 1;
        var clip_end = nonempty_line_indexes[nonempty_line_indexes.length - MINIMUM_VISIBLE_NONEMPTY_LINE_COUNT] - 1;
        var intermediate_line = new Array(lineno_display_width + 1).join(' ') + '  (...continued...)';
        intermediate_line += '\n' + new Array(lineno_display_width + 1).join('-') + '  (---------------)';
        rv.splice(clip_start, clip_end - clip_start + 1, intermediate_line);
      }

      return rv.join('\n');
    },

    /**
     * helper function, used to produce a human readable description as a string, given
     * the input `yylloc` location object.
     * 
     * Set `display_range_too` to TRUE to include the string character index position(s)
     * in the description if the `yylloc.range` is available.
     * 
     * @public
     * @this {RegExpLexer}
     */
    describeYYLLOC: function lexer_describe_yylloc(yylloc, display_range_too) {
      var l1 = yylloc.first_line;
      var l2 = yylloc.last_line;
      var c1 = yylloc.first_column;
      var c2 = yylloc.last_column;
      var dl = l2 - l1;
      var dc = c2 - c1;
      var rv;

      if (dl === 0) {
        rv = 'line ' + l1 + ', ';

        if (dc <= 1) {
          rv += 'column ' + c1;
        } else {
          rv += 'columns ' + c1 + ' .. ' + c2;
        }
      } else {
        rv = 'lines ' + l1 + '(column ' + c1 + ') .. ' + l2 + '(column ' + c2 + ')';
      }

      if (yylloc.range && display_range_too) {
        var r1 = yylloc.range[0];
        var r2 = yylloc.range[1] - 1;

        if (r2 <= r1) {
          rv += ' {String Offset: ' + r1 + '}';
        } else {
          rv += ' {String Offset range: ' + r1 + ' .. ' + r2 + '}';
        }
      }

      return rv;
    },

    /**
     * test the lexed token: return FALSE when not a match, otherwise return token.
     * 
     * `match` is supposed to be an array coming out of a regex match, i.e. `match[0]`
     * contains the actually matched text string.
     * 
     * Also move the input cursor forward and update the match collectors:
     * 
     * - `yytext`
     * - `yyleng`
     * - `match`
     * - `matches`
     * - `yylloc`
     * - `offset`
     * 
     * @public
     * @this {RegExpLexer}
     */
    test_match: function lexer_test_match(match, indexed_rule) {
      var token, lines, backup, match_str, match_str_len;

      if (this.options.backtrack_lexer) {
        // save context
        backup = {
          yylineno: this.yylineno,

          yylloc: {
            first_line: this.yylloc.first_line,
            last_line: this.yylloc.last_line,
            first_column: this.yylloc.first_column,
            last_column: this.yylloc.last_column,
            range: this.yylloc.range.slice(0)
          },

          yytext: this.yytext,
          match: this.match,
          matches: this.matches,
          matched: this.matched,
          yyleng: this.yyleng,
          offset: this.offset,
          _more: this._more,
          _input: this._input,

          //_signaled_error_token: this._signaled_error_token,
          yy: this.yy,

          conditionStack: this.conditionStack.slice(0),
          done: this.done
        };
      }

      match_str = match[0];
      match_str_len = match_str.length;

      // if (match_str.indexOf('\n') !== -1 || match_str.indexOf('\r') !== -1) {
      lines = match_str.split(/(?:\r\n?|\n)/g);

      if (lines.length > 1) {
        this.yylineno += lines.length - 1;
        this.yylloc.last_line = this.yylineno + 1;
        this.yylloc.last_column = lines[lines.length - 1].length;
      } else {
        this.yylloc.last_column += match_str_len;
      }

      // }
      this.yytext += match_str;

      this.match += match_str;
      this.matched += match_str;
      this.matches = match;
      this.yyleng = this.yytext.length;
      this.yylloc.range[1] += match_str_len;

      // previous lex rules MAY have invoked the `more()` API rather than producing a token:
      // those rules will already have moved this `offset` forward matching their match lengths,
      // hence we must only add our own match length now:
      this.offset += match_str_len;

      this._more = false;
      this._backtrack = false;
      this._input = this._input.slice(match_str_len);

      // calling this method:
      //
      //   function lexer__performAction(yy, yyrulenumber, YY_START) {...}
      token = this.performAction.call(
        this,
        this.yy,
        indexed_rule,
        this.conditionStack[this.conditionStack.length - 1] /* = YY_START */
      );

      // otherwise, when the action codes are all simple return token statements:
      //token = this.simpleCaseActionClusters[indexed_rule];

      if (this.done && this._input) {
        this.done = false;
      }

      if (token) {
        return token;
      } else if (this._backtrack) {
        // recover context
        for (var k in backup) {
          this[k] = backup[k];
        }

        this.__currentRuleSet__ = null;
        return false;  // rule action called reject() implying the next rule should be tested instead. 
      } else if (this._signaled_error_token) {
        // produce one 'error' token as `.parseError()` in `reject()`
        // did not guarantee a failure signal by throwing an exception!
        token = this._signaled_error_token;

        this._signaled_error_token = false;
        return token;
      }

      return false;
    },

    /**
     * return next match in input
     * 
     * @public
     * @this {RegExpLexer}
     */
    next: function lexer_next() {
      if (this.done) {
        this.clear();
        return this.EOF;
      }

      if (!this._input) {
        this.done = true;
      }

      var token, match, tempMatch, index;

      if (!this._more) {
        this.clear();
      }

      var spec = this.__currentRuleSet__;

      if (!spec) {
        // Update the ruleset cache as we apparently encountered a state change or just started lexing.
        // The cache is set up for fast lookup -- we assume a lexer will switch states much less often than it will
        // invoke the `lex()` token-producing API and related APIs, hence caching the set for direct access helps
        // speed up those activities a tiny bit.
        spec = this.__currentRuleSet__ = this._currentRules();

        // Check whether a *sane* condition has been pushed before: this makes the lexer robust against
        // user-programmer bugs such as https://github.com/zaach/jison-lex/issues/19
        if (!spec || !spec.rules) {
          var lineno_msg = '';

          if (this.options.trackPosition) {
            lineno_msg = ' on line ' + (this.yylineno + 1);
          }

          var p = this.constructLexErrorInfo(
            'Internal lexer engine error' + lineno_msg + ': The lex grammar programmer pushed a non-existing condition name "' + this.topState() + '"; this is a fatal error and should be reported to the application programmer team!',
            false
          );

          // produce one 'error' token until this situation has been resolved, most probably by parse termination!
          return this.parseError(p.errStr, p, this.JisonLexerError) || this.ERROR;
        }
      }

      var rule_ids = spec.rules;
      var regexes = spec.__rule_regexes;
      var len = spec.__rule_count;

      // Note: the arrays are 1-based, while `len` itself is a valid index,
      // hence the non-standard less-or-equal check in the next loop condition!
      for (var i = 1; i <= len; i++) {
        tempMatch = this._input.match(regexes[i]);

        if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {
          match = tempMatch;
          index = i;

          if (this.options.backtrack_lexer) {
            token = this.test_match(tempMatch, rule_ids[i]);

            if (token !== false) {
              return token;
            } else if (this._backtrack) {
              match = undefined;
              continue;  // rule action called reject() implying a rule MISmatch. 
            } else {
              // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
              return false;
            }
          } else if (!this.options.flex) {
            break;
          }
        }
      }

      if (match) {
        token = this.test_match(match, rule_ids[index]);

        if (token !== false) {
          return token;
        }

        // else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)
        return false;
      }

      if (!this._input) {
        this.done = true;
        this.clear();
        return this.EOF;
      } else {
        var lineno_msg = '';

        if (this.options.trackPosition) {
          lineno_msg = ' on line ' + (this.yylineno + 1);
        }

        var p = this.constructLexErrorInfo(
          'Lexical error' + lineno_msg + ': Unrecognized text.',
          this.options.lexerErrorsAreRecoverable
        );

        var pendingInput = this._input;
        var activeCondition = this.topState();
        var conditionStackDepth = this.conditionStack.length;
        token = this.parseError(p.errStr, p, this.JisonLexerError) || this.ERROR;

        if (token === this.ERROR) {
          // we can try to recover from a lexer error that `parseError()` did not 'recover' for us
          // by moving forward at least one character at a time IFF the (user-specified?) `parseError()`
          // has not consumed/modified any pending input or changed state in the error handler:
          if (!this.matches && // and make sure the input has been modified/consumed ...
          pendingInput === this._input && // ...or the lexer state has been modified significantly enough
          // to merit a non-consuming error handling action right now.
          activeCondition === this.topState() && conditionStackDepth === this.conditionStack.length) {
            this.input();
          }
        }

        return token;
      }
    },

    /**
     * return next match that has a token
     * 
     * @public
     * @this {RegExpLexer}
     */
    lex: function lexer_lex() {
      var r;

      // allow the PRE/POST handlers set/modify the return token for maximum flexibility of the generated lexer:
      if (typeof this.pre_lex === 'function') {
        r = this.pre_lex.call(this, 0);
      }

      if (typeof this.options.pre_lex === 'function') {
        // (also account for a userdef function which does not return any value: keep the token as is)
        r = this.options.pre_lex.call(this, r) || r;
      }

      if (this.yy && typeof this.yy.pre_lex === 'function') {
        // (also account for a userdef function which does not return any value: keep the token as is)
        r = this.yy.pre_lex.call(this, r) || r;
      }

      while (!r) {
        r = this.next();
      }

      if (this.yy && typeof this.yy.post_lex === 'function') {
        // (also account for a userdef function which does not return any value: keep the token as is)
        r = this.yy.post_lex.call(this, r) || r;
      }

      if (typeof this.options.post_lex === 'function') {
        // (also account for a userdef function which does not return any value: keep the token as is)
        r = this.options.post_lex.call(this, r) || r;
      }

      if (typeof this.post_lex === 'function') {
        // (also account for a userdef function which does not return any value: keep the token as is)
        r = this.post_lex.call(this, r) || r;
      }

      return r;
    },

    /**
     * return next match that has a token. Identical to the `lex()` API but does not invoke any of the 
     * `pre_lex()` nor any of the `post_lex()` callbacks.
     * 
     * @public
     * @this {RegExpLexer}
     */
    fastLex: function lexer_fastLex() {
      var r;

      while (!r) {
        r = this.next();
      }

      return r;
    },

    /**
     * return info about the lexer state that can help a parser or other lexer API user to use the
     * most efficient means available. This API is provided to aid run-time performance for larger
     * systems which employ this lexer.
     * 
     * @public
     * @this {RegExpLexer}
     */
    canIUse: function lexer_canIUse() {
      var rv = {
        fastLex: !(typeof this.pre_lex === 'function' || typeof this.options.pre_lex === 'function' || this.yy && typeof this.yy.pre_lex === 'function' || this.yy && typeof this.yy.post_lex === 'function' || typeof this.options.post_lex === 'function' || typeof this.post_lex === 'function') && typeof this.fastLex === 'function'
      };

      return rv;
    },

    /**
     * backwards compatible alias for `pushState()`;
     * the latter is symmetrical with `popState()` and we advise to use
     * those APIs in any modern lexer code, rather than `begin()`.
     * 
     * @public
     * @this {RegExpLexer}
     */
    begin: function lexer_begin(condition) {
      return this.pushState(condition);
    },

    /**
     * activates a new lexer condition state (pushes the new lexer
     * condition state onto the condition stack)
     * 
     * @public
     * @this {RegExpLexer}
     */
    pushState: function lexer_pushState(condition) {
      this.conditionStack.push(condition);
      this.__currentRuleSet__ = null;
      return this;
    },

    /**
     * pop the previously active lexer condition state off the condition
     * stack
     * 
     * @public
     * @this {RegExpLexer}
     */
    popState: function lexer_popState() {
      var n = this.conditionStack.length - 1;

      if (n > 0) {
        this.__currentRuleSet__ = null;
        return this.conditionStack.pop();
      } else {
        return this.conditionStack[0];
      }
    },

    /**
     * return the currently active lexer condition state; when an index
     * argument is provided it produces the N-th previous condition state,
     * if available
     * 
     * @public
     * @this {RegExpLexer}
     */
    topState: function lexer_topState(n) {
      n = this.conditionStack.length - 1 - Math.abs(n || 0);

      if (n >= 0) {
        return this.conditionStack[n];
      } else {
        return 'INITIAL';
      }
    },

    /**
     * (internal) determine the lexer rule set which is active for the
     * currently active lexer condition state
     * 
     * @public
     * @this {RegExpLexer}
     */
    _currentRules: function lexer__currentRules() {
      if (this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1]) {
        return this.conditions[this.conditionStack[this.conditionStack.length - 1]];
      } else {
        return this.conditions['INITIAL'];
      }
    },

    /**
     * return the number of states currently on the stack
     * 
     * @public
     * @this {RegExpLexer}
     */
    stateStackSize: function lexer_stateStackSize() {
      return this.conditionStack.length;
    },

    options: {
      trackPosition: true
    },

    JisonLexerError: JisonLexerError,

    performAction: function lexer__performAction(yy, yyrulenumber, YY_START) {
      var yy_ = this;
      var YYSTATE = YY_START;

      switch (yyrulenumber) {
      case 0:
        /*! Conditions:: INITIAL */
        /*! Rule::       \s+ */
        /* skip whitespace */
        break;

      default:
        return this.simpleCaseActionClusters[yyrulenumber];
      }
    },

    simpleCaseActionClusters: {
      /*! Conditions:: INITIAL */
      /*! Rule::       \* */
      1: 5,

      /*! Conditions:: INITIAL */
      /*! Rule::       \/ */
      2: 6,

      /*! Conditions:: INITIAL */
      /*! Rule::       \+ */
      3: 3,

      /*! Conditions:: INITIAL */
      /*! Rule::       - */
      4: 4,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)px\b */
      5: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)cm\b */
      6: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)mm\b */
      7: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)in\b */
      8: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)pt\b */
      9: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)pc\b */
      10: 13,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)deg\b */
      11: 14,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)grad\b */
      12: 14,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)rad\b */
      13: 14,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)turn\b */
      14: 14,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)s\b */
      15: 15,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)ms\b */
      16: 15,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)Hz\b */
      17: 16,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)kHz\b */
      18: 16,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)dpi\b */
      19: 17,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)dpcm\b */
      20: 17,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)dppx\b */
      21: 17,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)em\b */
      22: 18,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)ex\b */
      23: 19,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)ch\b */
      24: 20,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)rem\b */
      25: 21,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)vw\b */
      26: 23,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)vh\b */
      27: 22,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)vmin\b */
      28: 24,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)vmax\b */
      29: 25,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)% */
      30: 26,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([0-9]+(\.[0-9]*)?|\.[0-9]+)\b */
      31: 11,

      /*! Conditions:: INITIAL */
      /*! Rule::       (calc) */
      32: 9,

      /*! Conditions:: INITIAL */
      /*! Rule::       (var\([^\)]*\)) */
      33: 12,

      /*! Conditions:: INITIAL */
      /*! Rule::       ([a-z]+) */
      34: 10,

      /*! Conditions:: INITIAL */
      /*! Rule::       \( */
      35: 7,

      /*! Conditions:: INITIAL */
      /*! Rule::       \) */
      36: 8,

      /*! Conditions:: INITIAL */
      /*! Rule::       $ */
      37: 1
    },

    rules: [
      /*  0: */  /^(?:\s+)/,
      /*  1: */  /^(?:\*)/,
      /*  2: */  /^(?:\/)/,
      /*  3: */  /^(?:\+)/,
      /*  4: */  /^(?:-)/,
      /*  5: */  /^(?:(\d+(\.\d*)?|\.\d+)px\b)/,
      /*  6: */  /^(?:(\d+(\.\d*)?|\.\d+)cm\b)/,
      /*  7: */  /^(?:(\d+(\.\d*)?|\.\d+)mm\b)/,
      /*  8: */  /^(?:(\d+(\.\d*)?|\.\d+)in\b)/,
      /*  9: */  /^(?:(\d+(\.\d*)?|\.\d+)pt\b)/,
      /* 10: */  /^(?:(\d+(\.\d*)?|\.\d+)pc\b)/,
      /* 11: */  /^(?:(\d+(\.\d*)?|\.\d+)deg\b)/,
      /* 12: */  /^(?:(\d+(\.\d*)?|\.\d+)grad\b)/,
      /* 13: */  /^(?:(\d+(\.\d*)?|\.\d+)rad\b)/,
      /* 14: */  /^(?:(\d+(\.\d*)?|\.\d+)turn\b)/,
      /* 15: */  /^(?:(\d+(\.\d*)?|\.\d+)s\b)/,
      /* 16: */  /^(?:(\d+(\.\d*)?|\.\d+)ms\b)/,
      /* 17: */  /^(?:(\d+(\.\d*)?|\.\d+)Hz\b)/,
      /* 18: */  /^(?:(\d+(\.\d*)?|\.\d+)kHz\b)/,
      /* 19: */  /^(?:(\d+(\.\d*)?|\.\d+)dpi\b)/,
      /* 20: */  /^(?:(\d+(\.\d*)?|\.\d+)dpcm\b)/,
      /* 21: */  /^(?:(\d+(\.\d*)?|\.\d+)dppx\b)/,
      /* 22: */  /^(?:(\d+(\.\d*)?|\.\d+)em\b)/,
      /* 23: */  /^(?:(\d+(\.\d*)?|\.\d+)ex\b)/,
      /* 24: */  /^(?:(\d+(\.\d*)?|\.\d+)ch\b)/,
      /* 25: */  /^(?:(\d+(\.\d*)?|\.\d+)rem\b)/,
      /* 26: */  /^(?:(\d+(\.\d*)?|\.\d+)vw\b)/,
      /* 27: */  /^(?:(\d+(\.\d*)?|\.\d+)vh\b)/,
      /* 28: */  /^(?:(\d+(\.\d*)?|\.\d+)vmin\b)/,
      /* 29: */  /^(?:(\d+(\.\d*)?|\.\d+)vmax\b)/,
      /* 30: */  /^(?:(\d+(\.\d*)?|\.\d+)%)/,
      /* 31: */  /^(?:(\d+(\.\d*)?|\.\d+)\b)/,
      /* 32: */  /^(?:(calc))/,
      /* 33: */  /^(?:(var\([^)]*\)))/,
      /* 34: */  /^(?:([a-z]+))/,
      /* 35: */  /^(?:\()/,
      /* 36: */  /^(?:\))/,
      /* 37: */  /^(?:$)/
    ],

    conditions: {
      'INITIAL': {
        rules: [
          0,
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37
        ],

        inclusive: true
      }
    }
  };

  return lexer;
}();
parser.lexer = lexer;



function Parser() {
  this.yy = {};
}
Parser.prototype = parser;
parser.Parser = Parser;

return new Parser();
})();

        


if (true) {
  exports.parser = parser;
  exports.Parser = parser.Parser;
  exports.parse = function () {
    return parser.parse.apply(parser, arguments);
  };
  
}


/***/ }),

/***/ "../node_modules/tns-core-modules/application/application-common.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var events = new observable_1.Observable();
var launched = false;
function setLaunched() {
    launched = true;
    events.off("launch", setLaunched);
}
events.on("launch", setLaunched);
if (profiling_1.level() > 0) {
    events.on("displayed", function () {
        var duration = profiling_1.uptime();
        var end = profiling_1.time();
        var start = end - duration;
        profiling_1.trace("Displayed in " + duration.toFixed(2) + "ms", start, end);
    });
}
function hasLaunched() {
    return launched;
}
exports.hasLaunched = hasLaunched;
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
exports.launchEvent = "launch";
exports.suspendEvent = "suspend";
exports.displayedEvent = "displayed";
exports.resumeEvent = "resume";
exports.exitEvent = "exit";
exports.lowMemoryEvent = "lowMemory";
exports.uncaughtErrorEvent = "uncaughtError";
exports.discardedErrorEvent = "discardedError";
exports.orientationChangedEvent = "orientationChanged";
var ORIENTATION_CSS_CLASSES = [
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.portrait,
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.landscape,
    "" + system_classes_1.CLASS_PREFIX + enums_1.DeviceOrientation.unknown
];
var cssFile = "./app.css";
var resources = {};
function getResources() {
    return resources;
}
exports.getResources = getResources;
function setResources(res) {
    resources = res;
}
exports.setResources = setResources;
exports.android = undefined;
exports.ios = undefined;
exports.on = events.on.bind(events);
exports.off = events.off.bind(events);
exports.notify = events.notify.bind(events);
exports.hasListeners = events.hasListeners.bind(events);
var app;
function setApplication(instance) {
    app = instance;
}
exports.setApplication = setApplication;
function livesync(rootView, context) {
    events.notify({ eventName: "livesync", object: app });
    var liveSyncCore = global.__onLiveSyncCore;
    var reapplyAppStyles = false;
    if (context && context.path) {
        var styleExtensions = ["css", "scss"];
        var appStylesFullFileName = getCssFileName();
        var appStylesFileName_1 = appStylesFullFileName.substring(0, appStylesFullFileName.lastIndexOf(".") + 1);
        reapplyAppStyles = styleExtensions.some(function (ext) { return context.path === appStylesFileName_1.concat(ext); });
    }
    if (rootView && reapplyAppStyles) {
        rootView._onCssStateChange();
    }
    else if (liveSyncCore) {
        liveSyncCore(context);
    }
}
exports.livesync = livesync;
function setCssFileName(cssFileName) {
    cssFile = cssFileName;
    events.notify({ eventName: "cssChanged", object: app, cssFile: cssFileName });
}
exports.setCssFileName = setCssFileName;
function getCssFileName() {
    return cssFile;
}
exports.getCssFileName = getCssFileName;
function loadAppCss() {
    try {
        events.notify({ eventName: "loadAppCss", object: app, cssFile: getCssFileName() });
    }
    catch (e) {
        throw new Error("The file " + getCssFileName() + " couldn't be loaded! " +
            "You may need to register it inside ./app/vendor.ts.");
    }
}
exports.loadAppCss = loadAppCss;
function orientationChanged(rootView, newOrientation) {
    var newOrientationCssClass = "" + system_classes_1.CLASS_PREFIX + newOrientation;
    if (!rootView.cssClasses.has(newOrientationCssClass)) {
        var removeCssClass_1 = function (c) {
            system_classes_1.removeFromRootViewCssClasses(c);
            rootView.cssClasses.delete(c);
        };
        ORIENTATION_CSS_CLASSES.forEach(function (c) { return removeCssClass_1(c); });
        system_classes_1.pushToRootViewCssClasses(newOrientationCssClass);
        rootView.cssClasses.add(newOrientationCssClass);
        rootView._onCssStateChange();
    }
}
exports.orientationChanged = orientationChanged;
global.__onUncaughtError = function (error) {
    events.notify({ eventName: exports.uncaughtErrorEvent, object: app, android: error, ios: error, error: error });
};
global.__onDiscardedError = function (error) {
    events.notify({ eventName: exports.discardedErrorEvent, object: app, error: error });
};
//# sourceMappingURL=application-common.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/application/application.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application_common_1 = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/application/application-common.js"));
var ActivityCreated = "activityCreated";
var ActivityDestroyed = "activityDestroyed";
var ActivityStarted = "activityStarted";
var ActivityPaused = "activityPaused";
var ActivityResumed = "activityResumed";
var ActivityStopped = "activityStopped";
var SaveActivityState = "saveActivityState";
var ActivityResult = "activityResult";
var ActivityBackPressed = "activityBackPressed";
var ActivityNewIntent = "activityNewIntent";
var ActivityRequestPermissions = "activityRequestPermissions";
var AndroidApplication = (function (_super) {
    __extends(AndroidApplication, _super);
    function AndroidApplication() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.callbacks = {};
        _this._registeredReceivers = {};
        _this._pendingReceiverRegistrations = new Array();
        return _this;
    }
    AndroidApplication.prototype.init = function (nativeApp) {
        if (this.nativeApp === nativeApp) {
            return;
        }
        if (this.nativeApp) {
            throw new Error("application.android already initialized.");
        }
        this.nativeApp = nativeApp;
        this.packageName = nativeApp.getPackageName();
        this.context = nativeApp.getApplicationContext();
        this.callbacks.lifecycleCallbacks = initLifecycleCallbacks();
        this.callbacks.componentCallbacks = initComponentCallbacks();
        this.nativeApp.registerActivityLifecycleCallbacks(this.callbacks.lifecycleCallbacks);
        this.nativeApp.registerComponentCallbacks(this.callbacks.componentCallbacks);
        this._registerPendingReceivers();
    };
    AndroidApplication.prototype._registerPendingReceivers = function () {
        var _this = this;
        this._pendingReceiverRegistrations.forEach(function (func) { return func(_this.context); });
        this._pendingReceiverRegistrations.length = 0;
    };
    Object.defineProperty(AndroidApplication.prototype, "orientation", {
        get: function () {
            if (!this._orientation) {
                var resources = this.context.getResources();
                var configuration = resources.getConfiguration();
                var orientation_1 = configuration.orientation;
                this._orientation = getOrientationValue(orientation_1);
            }
            return this._orientation;
        },
        set: function (value) {
            this._orientation = value;
        },
        enumerable: true,
        configurable: true
    });
    AndroidApplication.prototype.registerBroadcastReceiver = function (intentFilter, onReceiveCallback) {
        ensureBroadCastReceiverClass();
        var that = this;
        var registerFunc = function (context) {
            var receiver = new BroadcastReceiverClass(onReceiveCallback);
            context.registerReceiver(receiver, new android.content.IntentFilter(intentFilter));
            that._registeredReceivers[intentFilter] = receiver;
        };
        if (this.context) {
            registerFunc(this.context);
        }
        else {
            this._pendingReceiverRegistrations.push(registerFunc);
        }
    };
    AndroidApplication.prototype.unregisterBroadcastReceiver = function (intentFilter) {
        var receiver = this._registeredReceivers[intentFilter];
        if (receiver) {
            this.context.unregisterReceiver(receiver);
            this._registeredReceivers[intentFilter] = undefined;
            delete this._registeredReceivers[intentFilter];
        }
    };
    AndroidApplication.activityCreatedEvent = ActivityCreated;
    AndroidApplication.activityDestroyedEvent = ActivityDestroyed;
    AndroidApplication.activityStartedEvent = ActivityStarted;
    AndroidApplication.activityPausedEvent = ActivityPaused;
    AndroidApplication.activityResumedEvent = ActivityResumed;
    AndroidApplication.activityStoppedEvent = ActivityStopped;
    AndroidApplication.saveActivityStateEvent = SaveActivityState;
    AndroidApplication.activityResultEvent = ActivityResult;
    AndroidApplication.activityBackPressedEvent = ActivityBackPressed;
    AndroidApplication.activityNewIntentEvent = ActivityNewIntent;
    AndroidApplication.activityRequestPermissionsEvent = ActivityRequestPermissions;
    return AndroidApplication;
}(application_common_1.Observable));
exports.AndroidApplication = AndroidApplication;
var androidApp = new AndroidApplication();
exports.android = androidApp;
application_common_1.setApplication(androidApp);
var mainEntry;
var started = false;
var createRootFrame = { value: true };
function _start(entry) {
    if (started) {
        throw new Error("Application is already started.");
    }
    started = true;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    if (!androidApp.nativeApp) {
        var nativeApp = getNativeApplication();
        androidApp.init(nativeApp);
    }
}
exports._start = _start;
function _shouldCreateRootFrame() {
    return createRootFrame.value;
}
exports._shouldCreateRootFrame = _shouldCreateRootFrame;
function run(entry) {
    createRootFrame.value = false;
    _start(entry);
}
exports.run = run;
function addCss(cssText, attributeScoped) {
    application_common_1.notify({ eventName: "cssChanged", object: androidApp, cssText: cssText });
    if (!attributeScoped) {
        var rootView = getRootView();
        if (rootView) {
            rootView._onCssStateChange();
        }
    }
}
exports.addCss = addCss;
var CALLBACKS = "_callbacks";
function _resetRootView(entry) {
    var activity = androidApp.foregroundActivity;
    if (!activity) {
        throw new Error("Cannot find android activity.");
    }
    createRootFrame.value = false;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    var callbacks = activity[CALLBACKS];
    if (!callbacks) {
        throw new Error("Cannot find android activity callbacks.");
    }
    callbacks.resetActivityContent(activity);
}
exports._resetRootView = _resetRootView;
function getMainEntry() {
    return mainEntry;
}
exports.getMainEntry = getMainEntry;
function getRootView() {
    var activity = androidApp.foregroundActivity || androidApp.startActivity;
    if (!activity) {
        return undefined;
    }
    var callbacks = activity[CALLBACKS];
    return callbacks ? callbacks.getRootView() : undefined;
}
exports.getRootView = getRootView;
function getNativeApplication() {
    var nativeApp = androidApp.nativeApp;
    if (!nativeApp) {
        if (!nativeApp && com.tns.NativeScriptApplication) {
            nativeApp = com.tns.NativeScriptApplication.getInstance();
        }
        if (!nativeApp) {
            var clazz = java.lang.Class.forName("android.app.ActivityThread");
            if (clazz) {
                var method = clazz.getMethod("currentApplication", null);
                if (method) {
                    nativeApp = method.invoke(null, null);
                }
            }
        }
        if (!nativeApp) {
            throw new Error("Failed to retrieve native Android Application object. If you have a custom android.app.Application type implemented make sure that you've called the '<application-module>.android.init' method.");
        }
    }
    return nativeApp;
}
exports.getNativeApplication = getNativeApplication;
function orientation() {
    return androidApp.orientation;
}
exports.orientation = orientation;
application_common_1.on(application_common_1.orientationChangedEvent, function (args) {
    var rootView = getRootView();
    if (rootView) {
        application_common_1.orientationChanged(rootView, args.newValue);
    }
});
global.__onLiveSync = function __onLiveSync(context) {
    if (androidApp && androidApp.paused) {
        return;
    }
    var rootView = getRootView();
    application_common_1.livesync(rootView, context);
};
function getOrientationValue(orientation) {
    switch (orientation) {
        case android.content.res.Configuration.ORIENTATION_LANDSCAPE:
            return "landscape";
        case android.content.res.Configuration.ORIENTATION_PORTRAIT:
            return "portrait";
        default:
            return "unknown";
    }
}
function initLifecycleCallbacks() {
    var setThemeOnLaunch = profiling_1.profile("setThemeOnLaunch", function (activity) {
        var activityInfo = activity.getPackageManager().getActivityInfo(activity.getComponentName(), android.content.pm.PackageManager.GET_META_DATA);
        if (activityInfo.metaData) {
            var setThemeOnLaunch_1 = activityInfo.metaData.getInt("SET_THEME_ON_LAUNCH", -1);
            if (setThemeOnLaunch_1 !== -1) {
                activity.setTheme(setThemeOnLaunch_1);
            }
        }
    });
    var notifyActivityCreated = profiling_1.profile("notifyActivityCreated", function (activity, savedInstanceState) {
        androidApp.notify({ eventName: ActivityCreated, object: androidApp, activity: activity, bundle: savedInstanceState });
    });
    var subscribeForGlobalLayout = profiling_1.profile("subscribeForGlobalLayout", function (activity) {
        var rootView = activity.getWindow().getDecorView().getRootView();
        global.onGlobalLayoutListener = new android.view.ViewTreeObserver.OnGlobalLayoutListener({
            onGlobalLayout: function () {
                application_common_1.notify({ eventName: application_common_1.displayedEvent, object: androidApp, activity: activity });
                var viewTreeObserver = rootView.getViewTreeObserver();
                viewTreeObserver.removeOnGlobalLayoutListener(global.onGlobalLayoutListener);
            }
        });
        rootView.getViewTreeObserver().addOnGlobalLayoutListener(global.onGlobalLayoutListener);
    });
    var lifecycleCallbacks = new android.app.Application.ActivityLifecycleCallbacks({
        onActivityCreated: profiling_1.profile("onActivityCreated", function (activity, savedInstanceState) {
            setThemeOnLaunch(activity);
            if (!androidApp.startActivity) {
                androidApp.startActivity = activity;
            }
            notifyActivityCreated(activity, savedInstanceState);
            if (application_common_1.hasListeners(application_common_1.displayedEvent)) {
                subscribeForGlobalLayout(activity);
            }
        }),
        onActivityDestroyed: profiling_1.profile("onActivityDestroyed", function (activity) {
            if (activity === androidApp.foregroundActivity) {
                androidApp.foregroundActivity = undefined;
            }
            if (activity === androidApp.startActivity) {
                androidApp.startActivity = undefined;
            }
            androidApp.notify({ eventName: ActivityDestroyed, object: androidApp, activity: activity });
            gc();
        }),
        onActivityPaused: profiling_1.profile("onActivityPaused", function (activity) {
            if (activity.isNativeScriptActivity) {
                androidApp.paused = true;
                application_common_1.notify({ eventName: application_common_1.suspendEvent, object: androidApp, android: activity });
            }
            androidApp.notify({ eventName: ActivityPaused, object: androidApp, activity: activity });
        }),
        onActivityResumed: profiling_1.profile("onActivityResumed", function (activity) {
            androidApp.foregroundActivity = activity;
            androidApp.notify({ eventName: ActivityResumed, object: androidApp, activity: activity });
        }),
        onActivitySaveInstanceState: profiling_1.profile("onActivitySaveInstanceState", function (activity, outState) {
            androidApp.notify({ eventName: SaveActivityState, object: androidApp, activity: activity, bundle: outState });
        }),
        onActivityStarted: profiling_1.profile("onActivityStarted", function (activity) {
            androidApp.notify({ eventName: ActivityStarted, object: androidApp, activity: activity });
        }),
        onActivityStopped: profiling_1.profile("onActivityStopped", function (activity) {
            androidApp.notify({ eventName: ActivityStopped, object: androidApp, activity: activity });
        })
    });
    return lifecycleCallbacks;
}
function initComponentCallbacks() {
    var componentCallbacks = new android.content.ComponentCallbacks2({
        onLowMemory: profiling_1.profile("onLowMemory", function () {
            gc();
            java.lang.System.gc();
            application_common_1.notify({ eventName: application_common_1.lowMemoryEvent, object: this, android: this });
        }),
        onTrimMemory: profiling_1.profile("onTrimMemory", function (level) {
        }),
        onConfigurationChanged: profiling_1.profile("onConfigurationChanged", function (newConfig) {
            var newConfigOrientation = newConfig.orientation;
            var newOrientation = getOrientationValue(newConfigOrientation);
            if (androidApp.orientation !== newOrientation) {
                androidApp.orientation = newOrientation;
                application_common_1.notify({
                    eventName: application_common_1.orientationChangedEvent,
                    android: androidApp.nativeApp,
                    newValue: androidApp.orientation,
                    object: androidApp
                });
            }
        })
    });
    return componentCallbacks;
}
var BroadcastReceiverClass;
function ensureBroadCastReceiverClass() {
    if (BroadcastReceiverClass) {
        return;
    }
    var BroadcastReceiver = (function (_super) {
        __extends(BroadcastReceiver, _super);
        function BroadcastReceiver(onReceiveCallback) {
            var _this = _super.call(this) || this;
            _this._onReceiveCallback = onReceiveCallback;
            return global.__native(_this);
        }
        BroadcastReceiver.prototype.onReceive = function (context, intent) {
            if (this._onReceiveCallback) {
                this._onReceiveCallback(context, intent);
            }
        };
        return BroadcastReceiver;
    }(android.content.BroadcastReceiver));
    BroadcastReceiverClass = BroadcastReceiver;
}
//# sourceMappingURL=application.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/bundle-entry-points.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {if (true) {
    __webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
    global.registerModule("text/formatted-string", function () { return __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js"); });
    global.registerModule("text/span", function () { return __webpack_require__("../node_modules/tns-core-modules/text/span.js"); });
    global.registerModule("ui/action-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js"); });
    global.registerModule("ui/activity-indicator", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js"); });
    global.registerModule("ui/border", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/border/border.js"); });
    global.registerModule("ui/bottom-navigation", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js"); });
    global.registerModule("ui/button", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js"); });
    global.registerModule("ui/content-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"); });
    global.registerModule("ui/date-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker.js"); });
    global.registerModule("ui/frame", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js"); });
    global.registerModule("ui/html-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view.js"); });
    global.registerModule("ui/image", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/image/image.js"); });
    global.registerModule("ui/label", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js"); });
    global.registerModule("ui/layouts/absolute-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js"); });
    global.registerModule("ui/layouts/dock-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js"); });
    global.registerModule("ui/layouts/grid-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js"); });
    global.registerModule("ui/layouts/stack-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js"); });
    global.registerModule("ui/layouts/flexbox-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js"); });
    global.registerModule("ui/layouts/wrap-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js"); });
    global.registerModule("ui/list-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker.js"); });
    global.registerModule("ui/page", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/page/page.js"); });
    global.registerModule("ui/placeholder", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/placeholder/placeholder.js"); });
    global.registerModule("ui/progress", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress.js"); });
    global.registerModule("ui/proxy-view-container", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js"); });
    global.registerModule("ui/repeater", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/repeater/repeater.js"); });
    global.registerModule("ui/scroll-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js"); });
    global.registerModule("ui/search-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar.js"); });
    global.registerModule("ui/segmented-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js"); });
    global.registerModule("ui/slider", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider.js"); });
    global.registerModule("ui/switch", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch.js"); });
    global.registerModule("ui/tab-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"); });
    global.registerModule("ui/tab-navigation-base/tab-content-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"); });
    global.registerModule("ui/tabs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs.js"); });
    global.registerModule("ui/web-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view.js"); });
    global.registerModule("ui/text-field", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js"); });
    global.registerModule("ui/text-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-view/text-view.js"); });
    global.registerModule("ui/time-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker.js"); });
    global.registerModule("ui/list-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view.js"); });
}
//# sourceMappingURL=bundle-entry-points.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var knownColors = __webpack_require__("../node_modules/tns-core-modules/color/known-colors.js");
var SHARP = "#";
var HEX_REGEX = /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i;
var Color = (function () {
    function Color() {
        if (arguments.length === 1) {
            var arg = arguments[0];
            if (types.isString(arg)) {
                if (isRgbOrRgba(arg)) {
                    this._argb = argbFromRgbOrRgba(arg);
                }
                else if (knownColors.isKnownName(arg)) {
                    var hex = knownColors.getKnownColor(arg);
                    this._name = arg;
                    this._argb = this._argbFromString(hex);
                }
                else if (HEX_REGEX.test(arg)) {
                    var hex = this._normalizeHex(arg);
                    this._argb = this._argbFromString(hex);
                }
                else {
                    throw new Error("Invalid color: " + arg);
                }
            }
            else if (types.isNumber(arg)) {
                this._argb = arg >>> 0;
            }
            else {
                throw new Error("Expected 1 or 4 constructor parameters.");
            }
        }
        else if (arguments.length === 4) {
            this._argb = (arguments[0] & 0xFF) * 0x01000000
                + (arguments[1] & 0xFF) * 0x00010000
                + (arguments[2] & 0xFF) * 0x00000100
                + (arguments[3] & 0xFF) * 0x00000001;
        }
        else {
            throw new Error("Expected 1 or 4 constructor parameters.");
        }
    }
    Object.defineProperty(Color.prototype, "a", {
        get: function () { return (this._argb / 0x01000000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "r", {
        get: function () { return (this._argb / 0x00010000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "g", {
        get: function () { return (this._argb / 0x00000100) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "b", {
        get: function () { return (this._argb / 0x00000001) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "argb", {
        get: function () {
            return this._argb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "hex", {
        get: function () {
            if (this.a === 0xFF) {
                return ("#" + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
            else {
                return ("#" + this._componentToHex(this.a) + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Color.prototype._argbFromString = function (hex) {
        if (hex.charAt(0) === "#") {
            hex = hex.substr(1);
        }
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        else if (hex.length === 4) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];
        }
        var intVal = parseInt(hex, 16);
        if (hex.length === 6) {
            intVal = (intVal & 0x00FFFFFF) + 0xFF000000;
        }
        return intVal;
    };
    Color.prototype.equals = function (value) {
        return value && this.argb === value.argb;
    };
    Color.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.equals(value2);
    };
    Color.isValid = function (value) {
        if (types.isNullOrUndefined(value) || value instanceof Color) {
            return true;
        }
        if (!types.isString(value)) {
            return false;
        }
        if (knownColors.isKnownName(value)) {
            return true;
        }
        return HEX_REGEX.test(value) || isRgbOrRgba(value);
    };
    Color.prototype._componentToHex = function (component) {
        var hex = component.toString(16);
        if (hex.length === 1) {
            hex = "0" + hex;
        }
        return hex;
    };
    Color.prototype._normalizeHex = function (hexStr) {
        if (hexStr.charAt(0) === SHARP && hexStr.length === 4) {
            hexStr = hexStr.charAt(0)
                + hexStr.charAt(1) + hexStr.charAt(1)
                + hexStr.charAt(2) + hexStr.charAt(2)
                + hexStr.charAt(3) + hexStr.charAt(3);
        }
        return hexStr;
    };
    Color.prototype.toString = function () {
        return this.hex;
    };
    return Color;
}());
exports.Color = Color;
function isRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    return (toLower.indexOf("rgb(") === 0 || toLower.indexOf("rgba(") === 0) && toLower.indexOf(")") === (toLower.length - 1);
}
function argbFromRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    var parts = toLower.replace("rgba(", "").replace("rgb(", "").replace(")", "").trim().split(",");
    var r = 255;
    var g = 255;
    var b = 255;
    var a = 255;
    if (parts[0]) {
        r = parseInt(parts[0].trim());
    }
    if (parts[1]) {
        g = parseInt(parts[1].trim());
    }
    if (parts[2]) {
        b = parseInt(parts[2].trim());
    }
    if (parts[3]) {
        a = Math.round(parseFloat(parts[3].trim()) * 255);
    }
    return (a & 0xFF) * 0x01000000
        + (r & 0xFF) * 0x00010000
        + (g & 0xFF) * 0x00000100
        + (b & 0xFF) * 0x00000001;
}
//# sourceMappingURL=color-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var common = __webpack_require__("../node_modules/tns-core-modules/color/color-common.js");
var Color = (function (_super) {
    __extends(Color, _super);
    function Color() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return this.argb >> 0;
        },
        enumerable: true,
        configurable: true
    });
    return Color;
}(common.Color));
exports.Color = Color;
//# sourceMappingURL=color.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/known-colors.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _allColors = {};
function registerColor(name, value) {
    _allColors[name.toLowerCase()] = value;
    return value;
}
function isKnownName(name) {
    if (!name) {
        return undefined;
    }
    return name.toLowerCase() in _allColors;
}
exports.isKnownName = isKnownName;
function getKnownColor(name) {
    if (!name) {
        return undefined;
    }
    return _allColors[name.toLowerCase()];
}
exports.getKnownColor = getKnownColor;
exports.Transparent = registerColor("Transparent", "#00000000");
exports.AliceBlue = registerColor("AliceBlue", "#F0F8FF");
exports.AntiqueWhite = registerColor("AntiqueWhite", "#FAEBD7");
exports.Aqua = registerColor("Aqua", "#00FFFF");
exports.Aquamarine = registerColor("Aquamarine", "#7FFFD4");
exports.Azure = registerColor("Azure", "#F0FFFF");
exports.Beige = registerColor("Beige", "#F5F5DC");
exports.Bisque = registerColor("Bisque", "#FFE4C4");
exports.Black = registerColor("Black", "#000000");
exports.BlanchedAlmond = registerColor("BlanchedAlmond", "#FFEBCD");
exports.Blue = registerColor("Blue", "#0000FF");
exports.BlueViolet = registerColor("BlueViolet", "#8A2BE2");
exports.Brown = registerColor("Brown", "#A52A2A");
exports.BurlyWood = registerColor("BurlyWood", "#DEB887");
exports.CadetBlue = registerColor("CadetBlue", "#5F9EA0");
exports.Chartreuse = registerColor("Chartreuse", "#7FFF00");
exports.Chocolate = registerColor("Chocolate", "#D2691E");
exports.Coral = registerColor("Coral", "#FF7F50");
exports.CornflowerBlue = registerColor("CornflowerBlue", "#6495ED");
exports.Cornsilk = registerColor("Cornsilk", "#FFF8DC");
exports.Crimson = registerColor("Crimson", "#DC143C");
exports.Cyan = registerColor("Cyan", "#00FFFF");
exports.DarkBlue = registerColor("DarkBlue", "#00008B");
exports.DarkCyan = registerColor("DarkCyan", "#008B8B");
exports.DarkGoldenRod = registerColor("DarkGoldenRod", "#B8860B");
exports.DarkGray = registerColor("DarkGray", "#A9A9A9");
exports.DarkGreen = registerColor("DarkGreen", "#006400");
exports.DarkKhaki = registerColor("DarkKhaki", "#BDB76B");
exports.DarkMagenta = registerColor("DarkMagenta", "#8B008B");
exports.DarkOliveGreen = registerColor("DarkOliveGreen", "#556B2F");
exports.DarkOrange = registerColor("DarkOrange", "#FF8C00");
exports.DarkOrchid = registerColor("DarkOrchid", "#9932CC");
exports.DarkRed = registerColor("DarkRed", "#8B0000");
exports.DarkSalmon = registerColor("DarkSalmon", "#E9967A");
exports.DarkSeaGreen = registerColor("DarkSeaGreen", "#8FBC8F");
exports.DarkSlateBlue = registerColor("DarkSlateBlue", "#483D8B");
exports.DarkSlateGray = registerColor("DarkSlateGray", "#2F4F4F");
exports.DarkTurquoise = registerColor("DarkTurquoise", "#00CED1");
exports.DarkViolet = registerColor("DarkViolet", "#9400D3");
exports.DeepPink = registerColor("DeepPink", "#FF1493");
exports.DeepSkyBlue = registerColor("DeepSkyBlue", "#00BFFF");
exports.DimGray = registerColor("DimGray", "#696969");
exports.DodgerBlue = registerColor("DodgerBlue", "#1E90FF");
exports.FireBrick = registerColor("FireBrick", "#B22222");
exports.FloralWhite = registerColor("FloralWhite", "#FFFAF0");
exports.ForestGreen = registerColor("ForestGreen", "#228B22");
exports.Fuchsia = registerColor("Fuchsia", "#FF00FF");
exports.Gainsboro = registerColor("Gainsboro", "#DCDCDC");
exports.GhostWhite = registerColor("GhostWhite", "#F8F8FF");
exports.Gold = registerColor("Gold", "#FFD700");
exports.GoldenRod = registerColor("GoldenRod", "#DAA520");
exports.Gray = registerColor("Gray", "#808080");
exports.Green = registerColor("Green", "#008000");
exports.GreenYellow = registerColor("GreenYellow", "#ADFF2F");
exports.HoneyDew = registerColor("HoneyDew", "#F0FFF0");
exports.HotPink = registerColor("HotPink", "#FF69B4");
exports.IndianRed = registerColor("IndianRed", "#CD5C5C");
exports.Indigo = registerColor("Indigo", "#4B0082");
exports.Ivory = registerColor("Ivory", "#FFFFF0");
exports.Khaki = registerColor("Khaki", "#F0E68C");
exports.Lavender = registerColor("Lavender", "#E6E6FA");
exports.LavenderBlush = registerColor("LavenderBlush", "#FFF0F5");
exports.LawnGreen = registerColor("LawnGreen", "#7CFC00");
exports.LemonChiffon = registerColor("LemonChiffon", "#FFFACD");
exports.LightBlue = registerColor("LightBlue", "#ADD8E6");
exports.LightCoral = registerColor("LightCoral", "#F08080");
exports.LightCyan = registerColor("LightCyan", "#E0FFFF");
exports.LightGoldenRodYellow = registerColor("LightGoldenRodYellow", "#FAFAD2");
exports.LightGray = registerColor("LightGray", "#D3D3D3");
exports.LightGreen = registerColor("LightGreen", "#90EE90");
exports.LightPink = registerColor("LightPink", "#FFB6C1");
exports.LightSalmon = registerColor("LightSalmon", "#FFA07A");
exports.LightSeaGreen = registerColor("LightSeaGreen", "#20B2AA");
exports.LightSkyBlue = registerColor("LightSkyBlue", "#87CEFA");
exports.LightSlateGray = registerColor("LightSlateGray", "#778899");
exports.LightSteelBlue = registerColor("LightSteelBlue", "#B0C4DE");
exports.LightYellow = registerColor("LightYellow", "#FFFFE0");
exports.Lime = registerColor("Lime", "#00FF00");
exports.LimeGreen = registerColor("LimeGreen", "#32CD32");
exports.Linen = registerColor("Linen", "#FAF0E6");
exports.Magenta = registerColor("Magenta", "#FF00FF");
exports.Maroon = registerColor("Maroon", "#800000");
exports.MediumAquaMarine = registerColor("MediumAquaMarine", "#66CDAA");
exports.MediumBlue = registerColor("MediumBlue", "#0000CD");
exports.MediumOrchid = registerColor("MediumOrchid", "#BA55D3");
exports.MediumPurple = registerColor("MediumPurple", "#9370DB");
exports.MediumSeaGreen = registerColor("MediumSeaGreen", "#3CB371");
exports.MediumSlateBlue = registerColor("MediumSlateBlue", "#7B68EE");
exports.MediumSpringGreen = registerColor("MediumSpringGreen", "#00FA9A");
exports.MediumTurquoise = registerColor("MediumTurquoise", "#48D1CC");
exports.MediumVioletRed = registerColor("MediumVioletRed", "#C71585");
exports.MidnightBlue = registerColor("MidnightBlue", "#191970");
exports.MintCream = registerColor("MintCream", "#F5FFFA");
exports.MistyRose = registerColor("MistyRose", "#FFE4E1");
exports.Moccasin = registerColor("Moccasin", "#FFE4B5");
exports.NavajoWhite = registerColor("NavajoWhite", "#FFDEAD");
exports.Navy = registerColor("Navy", "#000080");
exports.OldLace = registerColor("OldLace", "#FDF5E6");
exports.Olive = registerColor("Olive", "#808000");
exports.OliveDrab = registerColor("OliveDrab", "#6B8E23");
exports.Orange = registerColor("Orange", "#FFA500");
exports.OrangeRed = registerColor("OrangeRed", "#FF4500");
exports.Orchid = registerColor("Orchid", "#DA70D6");
exports.PaleGoldenRod = registerColor("PaleGoldenRod", "#EEE8AA");
exports.PaleGreen = registerColor("PaleGreen", "#98FB98");
exports.PaleTurquoise = registerColor("PaleTurquoise", "#AFEEEE");
exports.PaleVioletRed = registerColor("PaleVioletRed", "#DB7093");
exports.PapayaWhip = registerColor("PapayaWhip", "#FFEFD5");
exports.PeachPuff = registerColor("PeachPuff", "#FFDAB9");
exports.Peru = registerColor("Peru", "#CD853F");
exports.Pink = registerColor("Pink", "#FFC0CB");
exports.Plum = registerColor("Plum", "#DDA0DD");
exports.PowderBlue = registerColor("PowderBlue", "#B0E0E6");
exports.Purple = registerColor("Purple", "#800080");
exports.RebeccaPurple = registerColor("RebeccaPurple", "#663399");
exports.Red = registerColor("Red", "#FF0000");
exports.RosyBrown = registerColor("RosyBrown", "#BC8F8F");
exports.RoyalBlue = registerColor("RoyalBlue", "#4169E1");
exports.SaddleBrown = registerColor("SaddleBrown", "#8B4513");
exports.Salmon = registerColor("Salmon", "#FA8072");
exports.SandyBrown = registerColor("SandyBrown", "#F4A460");
exports.SeaGreen = registerColor("SeaGreen", "#2E8B57");
exports.SeaShell = registerColor("SeaShell", "#FFF5EE");
exports.Sienna = registerColor("Sienna", "#A0522D");
exports.Silver = registerColor("Silver", "#C0C0C0");
exports.SkyBlue = registerColor("SkyBlue", "#87CEEB");
exports.SlateBlue = registerColor("SlateBlue", "#6A5ACD");
exports.SlateGray = registerColor("SlateGray", "#708090");
exports.Snow = registerColor("Snow", "#FFFAFA");
exports.SpringGreen = registerColor("SpringGreen", "#00FF7F");
exports.SteelBlue = registerColor("SteelBlue", "#4682B4");
exports.Tan = registerColor("Tan", "#D2B48C");
exports.Teal = registerColor("Teal", "#008080");
exports.Thistle = registerColor("Thistle", "#D8BFD8");
exports.Tomato = registerColor("Tomato", "#FF6347");
exports.Turquoise = registerColor("Turquoise", "#40E0D0");
exports.Violet = registerColor("Violet", "#EE82EE");
exports.Wheat = registerColor("Wheat", "#F5DEB3");
exports.White = registerColor("White", "#FFFFFF");
exports.WhiteSmoke = registerColor("WhiteSmoke", "#F5F5F5");
exports.Yellow = registerColor("Yellow", "#FFFF00");
exports.YellowGreen = registerColor("YellowGreen", "#9ACD32");
//# sourceMappingURL=known-colors.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css-value/index.js":
/***/ (function(module, exports) {


exports.parse = parse;

function parse(str) {
  return new Parser(str).parse();
}

function Parser(str) {
  this.str = str;
}

Parser.prototype.skip = function(m){
  this.str = this.str.slice(m[0].length);
};

Parser.prototype.comma = function(){
  var m = /^, */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return { type: 'comma', string: ',' };
};

Parser.prototype.ident = function(){
  var m = /^([\w-]+) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return {
    type: 'ident',
    string: m[1]
  }
};

Parser.prototype.int = function(){
  var m = /^(([-\+]?\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = ~~m[2];
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.float = function(){
  var m = /^(((?:[-\+]?\d+)?\.\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = parseFloat(m[2]);
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.number = function(){
  return this.float() || this.int();
};

Parser.prototype.double = function(){
  var m = /^"([^"]*)" */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: '"',
    string: '"' + m[1] + '"',
    value: m[1]
  }
};

Parser.prototype.single = function(){
  var m = /^'([^']*)' */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: "'",
    string: "'" + m[1] + "'",
    value: m[1]
  }
};

Parser.prototype.string = function(){
  return this.single() || this.double();
};


Parser.prototype.value = function(){
  return this.number()
    || this.ident()
    || this.string()
    || this.comma();
};

Parser.prototype.parse = function(){
  var vals = [];

  while (this.str.length) {
    var obj = this.value();
    if (!obj) throw new Error('failed to parse near `' + this.str.slice(0, 10) + '...`');
    vals.push(obj);
  }

  return vals;
};


/***/ }),

/***/ "../node_modules/tns-core-modules/css/index.js":
/***/ (function(module, exports, __webpack_require__) {

exports.parse = __webpack_require__("../node_modules/tns-core-modules/css/lib/parse/index.js");


/***/ }),

/***/ "../node_modules/tns-core-modules/css/lib/parse/index.js":
/***/ (function(module, exports) {

// http://www.w3.org/TR/CSS21/grammar.html
// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027
var commentre = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g

module.exports = function(css, options){
  options = options || {};

  /**
   * Positional.
   */

  var lineno = 1;
  var column = 1;

  /**
   * Update lineno and column based on `str`.
   */

  function updatePosition(str) {
    var lines = str.match(/\n/g);
    if (lines) lineno += lines.length;
    var i = str.lastIndexOf('\n');
    column = ~i ? str.length - i : column + str.length;
  }

  /**
   * Mark position and patch `node.position`.
   */

  function position() {
    var start = { line: lineno, column: column };
    return function(node){
      node.position = new Position(start);
      whitespace();
      return node;
    };
  }

  /**
   * Store position information for a node
   */

  function Position(start) {
    this.start = start;
    this.end = { line: lineno, column: column };
    this.source = options.source;
  }

  /**
   * Non-enumerable source string
   */

  Position.prototype.content = css;

  /**
   * Error `msg`.
   */

  var errorsList = [];

  function error(msg) {
    var err = new Error(options.source + ':' + lineno + ':' + column + ': ' + msg);
    err.reason = msg;
    err.filename = options.source;
    err.line = lineno;
    err.column = column;
    err.source = css;

    if (options.silent) {
      errorsList.push(err);
    } else {
      throw err;
    }
  }

  /**
   * Parse stylesheet.
   */

  function stylesheet() {
    var rulesList = rules();

    return {
      type: 'stylesheet',
      stylesheet: {
        rules: rulesList,
        parsingErrors: errorsList
      }
    };
  }

  /**
   * Opening brace.
   */

  function open() {
    return match(/^{\s*/);
  }

  /**
   * Closing brace.
   */

  function close() {
    return match(/^}/);
  }

  /**
   * Parse ruleset.
   */

  function rules() {
    var node;
    var rules = [];
    whitespace();
    comments(rules);
    while (css.length && css.charAt(0) != '}' && (node = atrule() || rule())) {
      if (node !== false) {
        rules.push(node);
        comments(rules);
      }
    }
    return rules;
  }

  /**
   * Match `re` and return captures.
   */

  function match(re) {
    var m = re.exec(css);
    if (!m) return;
    var str = m[0];
    updatePosition(str);
    css = css.slice(str.length);
    return m;
  }

  /**
   * Parse whitespace.
   */

  function whitespace() {
    match(/^\s*/);
  }

  /**
   * Parse comments;
   */

  function comments(rules) {
    var c;
    rules = rules || [];
    while (c = comment()) {
      if (c !== false) {
        rules.push(c);
      }
    }
    return rules;
  }

  /**
   * Parse comment.
   */

  function comment() {
    var pos = position();
    if ('/' != css.charAt(0) || '*' != css.charAt(1)) return;

    var i = 2;
    while ("" != css.charAt(i) && ('*' != css.charAt(i) || '/' != css.charAt(i + 1))) ++i;
    i += 2;

    if ("" === css.charAt(i-1)) {
      return error('End of comment missing');
    }

    var str = css.slice(2, i - 2);
    column += 2;
    updatePosition(str);
    css = css.slice(i);
    column += 2;

    return pos({
      type: 'comment',
      comment: str
    });
  }

  /**
   * Parse selector.
   */

  function selector() {
    var m = match(/^([^{]+)/);
    if (!m) return;
    /* @fix Remove all comments from selectors
     * http://ostermiller.org/findcomment.html */
    return trim(m[0])
      .replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, '')
      .replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function(m) {
        return m.replace(/,/g, '\u200C');
      })
      .split(/\s*(?![^(]*\)),\s*/)
      .map(function(s) {
        return s.replace(/\u200C/g, ',');
      });
  }

  /**
   * Parse declaration.
   */

  function declaration() {
    var pos = position();

    // prop
    var prop = match(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);
    if (!prop) return;
    prop = trim(prop[0]);

    // :
    if (!match(/^:\s*/)) return error("property missing ':'");

    // val
    var val = match(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);

    var ret = pos({
      type: 'declaration',
      property: prop.replace(commentre, ''),
      value: val ? trim(val[0]).replace(commentre, '') : ''
    });

    // ;
    match(/^[;\s]*/);

    return ret;
  }

  /**
   * Parse declarations.
   */

  function declarations() {
    var decls = [];

    if (!open()) return error("missing '{'");
    comments(decls);

    // declarations
    var decl;
    while (decl = declaration()) {
      if (decl !== false) {
        decls.push(decl);
        comments(decls);
      }
    }

    if (!close()) return error("missing '}'");
    return decls;
  }

  /**
   * Parse keyframe.
   */

  function keyframe() {
    var m;
    var vals = [];
    var pos = position();

    while (m = match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)) {
      vals.push(m[1]);
      match(/^,\s*/);
    }

    if (!vals.length) return;

    return pos({
      type: 'keyframe',
      values: vals,
      declarations: declarations()
    });
  }

  /**
   * Parse keyframes.
   */

  function atkeyframes() {
    var pos = position();
    var m = match(/^@([-\w]+)?keyframes\s*/);

    if (!m) return;
    var vendor = m[1];

    // identifier
    var m = match(/^([-\w]+)\s*/);
    if (!m) return error("@keyframes missing name");
    var name = m[1];

    if (!open()) return error("@keyframes missing '{'");

    var frame;
    var frames = comments();
    while (frame = keyframe()) {
      frames.push(frame);
      frames = frames.concat(comments());
    }

    if (!close()) return error("@keyframes missing '}'");

    return pos({
      type: 'keyframes',
      name: name,
      vendor: vendor,
      keyframes: frames
    });
  }

  /**
   * Parse supports.
   */

  function atsupports() {
    var pos = position();
    var m = match(/^@supports *([^{]+)/);

    if (!m) return;
    var supports = trim(m[1]);

    if (!open()) return error("@supports missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@supports missing '}'");

    return pos({
      type: 'supports',
      supports: supports,
      rules: style
    });
  }

  /**
   * Parse host.
   */

  function athost() {
    var pos = position();
    var m = match(/^@host\s*/);

    if (!m) return;

    if (!open()) return error("@host missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@host missing '}'");

    return pos({
      type: 'host',
      rules: style
    });
  }

  /**
   * Parse media.
   */

  function atmedia() {
    var pos = position();
    var m = match(/^@media *([^{]+)/);

    if (!m) return;
    var media = trim(m[1]);

    if (!open()) return error("@media missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@media missing '}'");

    return pos({
      type: 'media',
      media: media,
      rules: style
    });
  }


  /**
   * Parse custom-media.
   */

  function atcustommedia() {
    var pos = position();
    var m = match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);
    if (!m) return;

    return pos({
      type: 'custom-media',
      name: trim(m[1]),
      media: trim(m[2])
    });
  }

  /**
   * Parse paged media.
   */

  function atpage() {
    var pos = position();
    var m = match(/^@page */);
    if (!m) return;

    var sel = selector() || [];

    if (!open()) return error("@page missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@page missing '}'");

    return pos({
      type: 'page',
      selectors: sel,
      declarations: decls
    });
  }

  /**
   * Parse document.
   */

  function atdocument() {
    var pos = position();
    var m = match(/^@([-\w]+)?document *([^{]+)/);
    if (!m) return;

    var vendor = trim(m[1]);
    var doc = trim(m[2]);

    if (!open()) return error("@document missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@document missing '}'");

    return pos({
      type: 'document',
      document: doc,
      vendor: vendor,
      rules: style
    });
  }

  /**
   * Parse font-face.
   */

  function atfontface() {
    var pos = position();
    var m = match(/^@font-face\s*/);
    if (!m) return;

    if (!open()) return error("@font-face missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@font-face missing '}'");

    return pos({
      type: 'font-face',
      declarations: decls
    });
  }

  /**
   * Parse import
   */

  var atimport = _compileAtrule('import');

  /**
   * Parse charset
   */

  var atcharset = _compileAtrule('charset');

  /**
   * Parse namespace
   */

  var atnamespace = _compileAtrule('namespace');

  /**
   * Parse non-block at-rules
   */


  function _compileAtrule(name) {
    var re = new RegExp('^@' + name + '\\s*([^;]+);');
    return function() {
      var pos = position();
      var m = match(re);
      if (!m) return;
      var ret = { type: name };
      ret[name] = m[1].trim();
      return pos(ret);
    }
  }

  /**
   * Parse at rule.
   */

  function atrule() {
    if (css[0] != '@') return;

    return atkeyframes()
      || atmedia()
      || atcustommedia()
      || atsupports()
      || atimport()
      || atcharset()
      || atnamespace()
      || atdocument()
      || atpage()
      || athost()
      || atfontface();
  }

  /**
   * Parse rule.
   */

  function rule() {
    var pos = position();
    var sel = selector();

    if (!sel) return error('selector missing');
    comments();

    return pos({
      type: 'rule',
      selectors: sel,
      declarations: declarations()
    });
  }

  return addParent(stylesheet());
};

/**
 * Trim `str`.
 */

function trim(str) {
  return str ? str.replace(/^\s+|\s+$/g, '') : '';
}

/**
 * Adds non-enumerable parent node reference to each node.
 */

function addParent(obj, parent) {
  var isNode = obj && typeof obj.type === 'string';
  var childParent = isNode ? obj : parent;

  for (var k in obj) {
    var value = obj[k];
    if (Array.isArray(value)) {
      value.forEach(function(v) { addParent(v, childParent); });
    } else if (value && typeof value === 'object') {
      addParent(value, childParent);
    }
  }

  if (isNode) {
    Object.defineProperty(obj, 'parent', {
      configurable: true,
      writable: true,
      enumerable: false,
      value: parent || null
    });
  }

  return obj;
}


/***/ }),

/***/ "../node_modules/tns-core-modules/css/parser.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var urlRegEx = /\s*url\((?:('|")([^\1]*)\1|([^\)]*))\)\s*/gy;
function parseURL(text, start) {
    if (start === void 0) { start = 0; }
    urlRegEx.lastIndex = start;
    var result = urlRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = urlRegEx.lastIndex;
    var value = result[2] || result[3];
    return { start: start, end: end, value: value };
}
exports.parseURL = parseURL;
var hexColorRegEx = /\s*#((?:[0-9A-F]{8})|(?:[0-9A-F]{6})|(?:[0-9A-F]{3}))\s*/giy;
function parseHexColor(text, start) {
    if (start === void 0) { start = 0; }
    hexColorRegEx.lastIndex = start;
    var result = hexColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = hexColorRegEx.lastIndex;
    var hex = result[1];
    var argb;
    if (hex.length === 8) {
        argb = parseInt("0x" + hex);
    }
    else if (hex.length === 6) {
        argb = parseInt("0xFF" + hex);
    }
    else if (hex.length === 3) {
        argb = parseInt("0xFF" + hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]);
    }
    return { start: start, end: end, value: argb };
}
exports.parseHexColor = parseHexColor;
function rgbaToArgbNumber(r, g, b, a) {
    if (a === void 0) { a = 1; }
    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255 && a >= 0 && a <= 1) {
        return (Math.round(a * 0xFF) * 0x01000000) + (r * 0x010000) + (g * 0x000100) + (b * 0x000001);
    }
    else {
        return null;
    }
}
var rgbColorRegEx = /\s*(rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\))/gy;
function parseRGBColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbColorRegEx.lastIndex = start;
    var result = rgbColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbColorRegEx.lastIndex;
    var value = result[1] && rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]));
    return { start: start, end: end, value: value };
}
exports.parseRGBColor = parseRGBColor;
var rgbaColorRegEx = /\s*(rgba\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*,\s*([01]?\.?\d*)\s*\))/gy;
function parseRGBAColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbaColorRegEx.lastIndex = start;
    var result = rgbaColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbaColorRegEx.lastIndex;
    var value = rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]), parseFloat(result[5]));
    return { start: start, end: end, value: value };
}
exports.parseRGBAColor = parseRGBAColor;
var colors;
(function (colors) {
    colors[colors["transparent"] = 0] = "transparent";
    colors[colors["aliceblue"] = 4293982463] = "aliceblue";
    colors[colors["antiquewhite"] = 4294634455] = "antiquewhite";
    colors[colors["aqua"] = 4278255615] = "aqua";
    colors[colors["aquamarine"] = 4286578644] = "aquamarine";
    colors[colors["azure"] = 4293984255] = "azure";
    colors[colors["beige"] = 4294309340] = "beige";
    colors[colors["bisque"] = 4294960324] = "bisque";
    colors[colors["black"] = 4278190080] = "black";
    colors[colors["blanchedalmond"] = 4294962125] = "blanchedalmond";
    colors[colors["blue"] = 4278190335] = "blue";
    colors[colors["blueviolet"] = 4287245282] = "blueviolet";
    colors[colors["brown"] = 4289014314] = "brown";
    colors[colors["burlywood"] = 4292786311] = "burlywood";
    colors[colors["cadetblue"] = 4284456608] = "cadetblue";
    colors[colors["chartreuse"] = 4286578432] = "chartreuse";
    colors[colors["chocolate"] = 4291979550] = "chocolate";
    colors[colors["coral"] = 4294934352] = "coral";
    colors[colors["cornflowerblue"] = 4284782061] = "cornflowerblue";
    colors[colors["cornsilk"] = 4294965468] = "cornsilk";
    colors[colors["crimson"] = 4292613180] = "crimson";
    colors[colors["cyan"] = 4278255615] = "cyan";
    colors[colors["darkblue"] = 4278190219] = "darkblue";
    colors[colors["darkcyan"] = 4278225803] = "darkcyan";
    colors[colors["darkgoldenrod"] = 4290283019] = "darkgoldenrod";
    colors[colors["darkgray"] = 4289309097] = "darkgray";
    colors[colors["darkgreen"] = 4278215680] = "darkgreen";
    colors[colors["darkgrey"] = 4289309097] = "darkgrey";
    colors[colors["darkkhaki"] = 4290623339] = "darkkhaki";
    colors[colors["darkmagenta"] = 4287299723] = "darkmagenta";
    colors[colors["darkolivegreen"] = 4283788079] = "darkolivegreen";
    colors[colors["darkorange"] = 4294937600] = "darkorange";
    colors[colors["darkorchid"] = 4288230092] = "darkorchid";
    colors[colors["darkred"] = 4287299584] = "darkred";
    colors[colors["darksalmon"] = 4293498490] = "darksalmon";
    colors[colors["darkseagreen"] = 4287609999] = "darkseagreen";
    colors[colors["darkslateblue"] = 4282924427] = "darkslateblue";
    colors[colors["darkslategray"] = 4281290575] = "darkslategray";
    colors[colors["darkslategrey"] = 4281290575] = "darkslategrey";
    colors[colors["darkturquoise"] = 4278243025] = "darkturquoise";
    colors[colors["darkviolet"] = 4287889619] = "darkviolet";
    colors[colors["deeppink"] = 4294907027] = "deeppink";
    colors[colors["deepskyblue"] = 4278239231] = "deepskyblue";
    colors[colors["dimgray"] = 4285098345] = "dimgray";
    colors[colors["dimgrey"] = 4285098345] = "dimgrey";
    colors[colors["dodgerblue"] = 4280193279] = "dodgerblue";
    colors[colors["firebrick"] = 4289864226] = "firebrick";
    colors[colors["floralwhite"] = 4294966000] = "floralwhite";
    colors[colors["forestgreen"] = 4280453922] = "forestgreen";
    colors[colors["fuchsia"] = 4294902015] = "fuchsia";
    colors[colors["gainsboro"] = 4292664540] = "gainsboro";
    colors[colors["ghostwhite"] = 4294506751] = "ghostwhite";
    colors[colors["gold"] = 4294956800] = "gold";
    colors[colors["goldenrod"] = 4292519200] = "goldenrod";
    colors[colors["gray"] = 4286611584] = "gray";
    colors[colors["green"] = 4278222848] = "green";
    colors[colors["greenyellow"] = 4289593135] = "greenyellow";
    colors[colors["grey"] = 4286611584] = "grey";
    colors[colors["honeydew"] = 4293984240] = "honeydew";
    colors[colors["hotpink"] = 4294928820] = "hotpink";
    colors[colors["indianred"] = 4291648604] = "indianred";
    colors[colors["indigo"] = 4283105410] = "indigo";
    colors[colors["ivory"] = 4294967280] = "ivory";
    colors[colors["khaki"] = 4293977740] = "khaki";
    colors[colors["lavender"] = 4293322490] = "lavender";
    colors[colors["lavenderblush"] = 4294963445] = "lavenderblush";
    colors[colors["lawngreen"] = 4286381056] = "lawngreen";
    colors[colors["lemonchiffon"] = 4294965965] = "lemonchiffon";
    colors[colors["lightblue"] = 4289583334] = "lightblue";
    colors[colors["lightcoral"] = 4293951616] = "lightcoral";
    colors[colors["lightcyan"] = 4292935679] = "lightcyan";
    colors[colors["lightgoldenrodyellow"] = 4294638290] = "lightgoldenrodyellow";
    colors[colors["lightgray"] = 4292072403] = "lightgray";
    colors[colors["lightgreen"] = 4287688336] = "lightgreen";
    colors[colors["lightgrey"] = 4292072403] = "lightgrey";
    colors[colors["lightpink"] = 4294948545] = "lightpink";
    colors[colors["lightsalmon"] = 4294942842] = "lightsalmon";
    colors[colors["lightseagreen"] = 4280332970] = "lightseagreen";
    colors[colors["lightskyblue"] = 4287090426] = "lightskyblue";
    colors[colors["lightslategray"] = 4286023833] = "lightslategray";
    colors[colors["lightslategrey"] = 4286023833] = "lightslategrey";
    colors[colors["lightsteelblue"] = 4289774814] = "lightsteelblue";
    colors[colors["lightyellow"] = 4294967264] = "lightyellow";
    colors[colors["lime"] = 4278255360] = "lime";
    colors[colors["limegreen"] = 4281519410] = "limegreen";
    colors[colors["linen"] = 4294635750] = "linen";
    colors[colors["magenta"] = 4294902015] = "magenta";
    colors[colors["maroon"] = 4286578688] = "maroon";
    colors[colors["mediumaquamarine"] = 4284927402] = "mediumaquamarine";
    colors[colors["mediumblue"] = 4278190285] = "mediumblue";
    colors[colors["mediumorchid"] = 4290401747] = "mediumorchid";
    colors[colors["mediumpurple"] = 4287852763] = "mediumpurple";
    colors[colors["mediumseagreen"] = 4282168177] = "mediumseagreen";
    colors[colors["mediumslateblue"] = 4286277870] = "mediumslateblue";
    colors[colors["mediumspringgreen"] = 4278254234] = "mediumspringgreen";
    colors[colors["mediumturquoise"] = 4282962380] = "mediumturquoise";
    colors[colors["mediumvioletred"] = 4291237253] = "mediumvioletred";
    colors[colors["midnightblue"] = 4279834992] = "midnightblue";
    colors[colors["mintcream"] = 4294311930] = "mintcream";
    colors[colors["mistyrose"] = 4294960353] = "mistyrose";
    colors[colors["moccasin"] = 4294960309] = "moccasin";
    colors[colors["navajowhite"] = 4294958765] = "navajowhite";
    colors[colors["navy"] = 4278190208] = "navy";
    colors[colors["oldlace"] = 4294833638] = "oldlace";
    colors[colors["olive"] = 4286611456] = "olive";
    colors[colors["olivedrab"] = 4285238819] = "olivedrab";
    colors[colors["orange"] = 4294944000] = "orange";
    colors[colors["orangered"] = 4294919424] = "orangered";
    colors[colors["orchid"] = 4292505814] = "orchid";
    colors[colors["palegoldenrod"] = 4293847210] = "palegoldenrod";
    colors[colors["palegreen"] = 4288215960] = "palegreen";
    colors[colors["paleturquoise"] = 4289720046] = "paleturquoise";
    colors[colors["palevioletred"] = 4292571283] = "palevioletred";
    colors[colors["papayawhip"] = 4294963157] = "papayawhip";
    colors[colors["peachpuff"] = 4294957753] = "peachpuff";
    colors[colors["peru"] = 4291659071] = "peru";
    colors[colors["pink"] = 4294951115] = "pink";
    colors[colors["plum"] = 4292714717] = "plum";
    colors[colors["powderblue"] = 4289781990] = "powderblue";
    colors[colors["purple"] = 4286578816] = "purple";
    colors[colors["rebeccapurple"] = 4284887961] = "rebeccapurple";
    colors[colors["red"] = 4294901760] = "red";
    colors[colors["rosybrown"] = 4290547599] = "rosybrown";
    colors[colors["royalblue"] = 4282477025] = "royalblue";
    colors[colors["saddlebrown"] = 4287317267] = "saddlebrown";
    colors[colors["salmon"] = 4294606962] = "salmon";
    colors[colors["sandybrown"] = 4294222944] = "sandybrown";
    colors[colors["seagreen"] = 4281240407] = "seagreen";
    colors[colors["seashell"] = 4294964718] = "seashell";
    colors[colors["sienna"] = 4288696877] = "sienna";
    colors[colors["silver"] = 4290822336] = "silver";
    colors[colors["skyblue"] = 4287090411] = "skyblue";
    colors[colors["slateblue"] = 4285160141] = "slateblue";
    colors[colors["slategray"] = 4285563024] = "slategray";
    colors[colors["slategrey"] = 4285563024] = "slategrey";
    colors[colors["snow"] = 4294966010] = "snow";
    colors[colors["springgreen"] = 4278255487] = "springgreen";
    colors[colors["steelblue"] = 4282811060] = "steelblue";
    colors[colors["tan"] = 4291998860] = "tan";
    colors[colors["teal"] = 4278222976] = "teal";
    colors[colors["thistle"] = 4292394968] = "thistle";
    colors[colors["tomato"] = 4294927175] = "tomato";
    colors[colors["turquoise"] = 4282441936] = "turquoise";
    colors[colors["violet"] = 4293821166] = "violet";
    colors[colors["wheat"] = 4294303411] = "wheat";
    colors[colors["white"] = 4294967295] = "white";
    colors[colors["whitesmoke"] = 4294309365] = "whitesmoke";
    colors[colors["yellow"] = 4294967040] = "yellow";
    colors[colors["yellowgreen"] = 4288335154] = "yellowgreen";
})(colors = exports.colors || (exports.colors = {}));
function parseColorKeyword(value, start, keyword) {
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && keyword.value in colors) {
        var end = keyword.end;
        var value_1 = colors[keyword.value];
        return { start: start, end: end, value: value_1 };
    }
    return null;
}
exports.parseColorKeyword = parseColorKeyword;
function parseColor(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    return parseHexColor(value, start) || parseColorKeyword(value, start, keyword) || parseRGBColor(value, start) || parseRGBAColor(value, start);
}
exports.parseColor = parseColor;
var keywordRegEx = /\s*([a-z][\w\-]*)\s*/giy;
function parseKeyword(text, start) {
    if (start === void 0) { start = 0; }
    keywordRegEx.lastIndex = start;
    var result = keywordRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = keywordRegEx.lastIndex;
    var value = result[1];
    return { start: start, end: end, value: value };
}
var backgroundRepeatKeywords = new Set(["repeat", "repeat-x", "repeat-y", "no-repeat"]);
function parseRepeat(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && backgroundRepeatKeywords.has(keyword.value)) {
        var end = keyword.end;
        var value_2 = keyword.value;
        return { start: start, end: end, value: value_2 };
    }
    return null;
}
exports.parseRepeat = parseRepeat;
var unitRegEx = /\s*([\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?)([a-zA-Z]+|%)?\s*/gy;
function parseUnit(text, start) {
    if (start === void 0) { start = 0; }
    unitRegEx.lastIndex = start;
    var result = unitRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = unitRegEx.lastIndex;
    var value = parseFloat(result[1]);
    var unit = result[2] || "dip";
    return { start: start, end: end, value: { value: value, unit: unit } };
}
exports.parseUnit = parseUnit;
function parsePercentageOrLength(text, start) {
    if (start === void 0) { start = 0; }
    var unitResult = parseUnit(text, start);
    if (unitResult) {
        var start_1 = unitResult.start, end = unitResult.end;
        var value = unitResult.value;
        if (value.unit === "%") {
            value.value /= 100;
        }
        else if (!value.unit) {
            value.unit = "dip";
        }
        else if (value.unit === "px" || value.unit === "dip") {
        }
        else {
            return null;
        }
        return { start: start_1, end: end, value: value };
    }
    return null;
}
exports.parsePercentageOrLength = parsePercentageOrLength;
var angleUnitsToRadMap = {
    "deg": function (start, end, deg) { return ({ start: start, end: end, value: deg / 180 * Math.PI }); },
    "rad": function (start, end, rad) { return ({ start: start, end: end, value: rad }); },
    "grad": function (start, end, grad) { return ({ start: start, end: end, value: grad / 200 * Math.PI }); },
    "turn": function (start, end, turn) { return ({ start: start, end: end, value: turn * Math.PI * 2 }); }
};
function parseAngle(value, start) {
    if (start === void 0) { start = 0; }
    var angleResult = parseUnit(value, start);
    if (angleResult) {
        var start_2 = angleResult.start, end = angleResult.end, value_3 = angleResult.value;
        return (angleUnitsToRadMap[value_3.unit] || (function (_, __, ___) { return null; }))(start_2, end, value_3.value);
    }
    return null;
}
exports.parseAngle = parseAngle;
var backgroundSizeKeywords = new Set(["auto", "contain", "cover"]);
function parseBackgroundSize(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    var end = start;
    if (keyword && backgroundSizeKeywords.has(keyword.value)) {
        end = keyword.end;
        var value_4 = keyword.value;
        return { start: start, end: end, value: value_4 };
    }
    var firstLength = parsePercentageOrLength(value, end);
    if (firstLength) {
        end = firstLength.end;
        var secondLength = parsePercentageOrLength(value, firstLength.end);
        if (secondLength) {
            end = secondLength.end;
            return { start: start, end: end, value: { x: firstLength.value, y: secondLength.value } };
        }
        else {
            return { start: start, end: end, value: { x: firstLength.value, y: "auto" } };
        }
    }
    return null;
}
exports.parseBackgroundSize = parseBackgroundSize;
var backgroundPositionKeywords = Object.freeze(new Set(["left", "right", "top", "bottom", "center"]));
var backgroundPositionKeywordsDirection = {
    "left": "x",
    "right": "x",
    "center": "center",
    "top": "y",
    "bottom": "y"
};
function parseBackgroundPosition(text, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(text, start); }
    function formatH(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    function formatV(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    var end = start;
    if (keyword && backgroundPositionKeywords.has(keyword.value)) {
        end = keyword.end;
        var firstDirection = backgroundPositionKeywordsDirection[keyword.value];
        var firstLength = firstDirection !== "center" && parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
        }
        var secondKeyword = parseKeyword(text, end);
        if (secondKeyword && backgroundPositionKeywords.has(secondKeyword.value)) {
            end = secondKeyword.end;
            var secondDirection = backgroundPositionKeywordsDirection[secondKeyword.end];
            if (firstDirection === secondDirection && firstDirection !== "center") {
                return null;
            }
            var secondLength = secondDirection !== "center" && parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
            }
            if ((firstDirection === secondDirection && secondDirection === "center") || (firstDirection === "x" || secondDirection === "y")) {
                return { start: start, end: end, value: {
                        x: formatH(keyword, firstLength),
                        y: formatV(secondKeyword, secondLength)
                    } };
            }
            else {
                return { start: start, end: end, value: {
                        x: formatH(secondKeyword, secondLength),
                        y: formatV(keyword, firstLength),
                    } };
            }
        }
        else {
            if (firstDirection === "center") {
                return { start: start, end: end, value: { x: "center", y: "center" } };
            }
            else if (firstDirection === "x") {
                return { start: start, end: end, value: { x: formatH(keyword, firstLength), y: "center" } };
            }
            else {
                return { start: start, end: end, value: { x: "center", y: formatV(keyword, firstLength) } };
            }
        }
    }
    else {
        var firstLength = parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
            var secondLength = parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: { align: "top", offset: secondLength.value } } };
            }
            else {
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: "center" } };
            }
        }
        else {
            return null;
        }
    }
}
exports.parseBackgroundPosition = parseBackgroundPosition;
var directionRegEx = /\s*to\s*(left|right|top|bottom)\s*(left|right|top|bottom)?\s*/gy;
var sideDirections = {
    top: Math.PI * 0 / 2,
    right: Math.PI * 1 / 2,
    bottom: Math.PI * 2 / 2,
    left: Math.PI * 3 / 2
};
var cornerDirections = {
    top: {
        right: Math.PI * 1 / 4,
        left: Math.PI * 7 / 4
    },
    right: {
        top: Math.PI * 1 / 4,
        bottom: Math.PI * 3 / 4
    },
    bottom: {
        right: Math.PI * 3 / 4,
        left: Math.PI * 5 / 4
    },
    left: {
        top: Math.PI * 7 / 4,
        bottom: Math.PI * 5 / 4
    }
};
function parseDirection(text, start) {
    if (start === void 0) { start = 0; }
    directionRegEx.lastIndex = start;
    var result = directionRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = directionRegEx.lastIndex;
    var firstDirection = result[1];
    if (result[2]) {
        var secondDirection = result[2];
        var value = cornerDirections[firstDirection][secondDirection];
        return value === undefined ? null : { start: start, end: end, value: value };
    }
    else {
        return { start: start, end: end, value: sideDirections[firstDirection] };
    }
}
var openingBracketRegEx = /\s*\(\s*/gy;
var closingBracketRegEx = /\s*\)\s*/gy;
var closingBracketOrCommaRegEx = /\s*(\)|,)\s*/gy;
function parseArgumentsList(text, start, argument) {
    openingBracketRegEx.lastIndex = start;
    var openingBracket = openingBracketRegEx.exec(text);
    if (!openingBracket) {
        return null;
    }
    var end = openingBracketRegEx.lastIndex;
    var value = [];
    closingBracketRegEx.lastIndex = end;
    var closingBracket = closingBracketRegEx.exec(text);
    if (closingBracket) {
        return { start: start, end: end, value: value };
    }
    for (var index_1 = 0; true; index_1++) {
        var arg = argument(text, end, index_1);
        if (!arg) {
            return null;
        }
        end = arg.end;
        value.push(arg);
        closingBracketOrCommaRegEx.lastIndex = end;
        var closingBracketOrComma = closingBracketOrCommaRegEx.exec(text);
        if (closingBracketOrComma) {
            end = closingBracketOrCommaRegEx.lastIndex;
            if (closingBracketOrComma[1] === ",") {
                continue;
            }
            else if (closingBracketOrComma[1] === ")") {
                return { start: start, end: end, value: value };
            }
        }
        else {
            return null;
        }
    }
}
function parseColorStop(text, start) {
    if (start === void 0) { start = 0; }
    var color = parseColor(text, start);
    if (!color) {
        return null;
    }
    var end = color.end;
    var offset = parsePercentageOrLength(text, end);
    if (offset) {
        end = offset.end;
        return { start: start, end: end, value: { argb: color.value, offset: offset.value } };
    }
    return { start: start, end: end, value: { argb: color.value } };
}
exports.parseColorStop = parseColorStop;
var linearGradientStartRegEx = /\s*linear-gradient\s*/gy;
function parseLinearGradient(text, start) {
    if (start === void 0) { start = 0; }
    linearGradientStartRegEx.lastIndex = start;
    var lgs = linearGradientStartRegEx.exec(text);
    if (!lgs) {
        return null;
    }
    var end = linearGradientStartRegEx.lastIndex;
    var angle = Math.PI;
    var colors = [];
    var parsedArgs = parseArgumentsList(text, end, function (text, start, index) {
        if (index === 0) {
            var angleArg = parseAngle(text, start) || parseDirection(text, start);
            if (angleArg) {
                angle = angleArg.value;
                return angleArg;
            }
        }
        var colorStop = parseColorStop(text, start);
        if (colorStop) {
            colors.push(colorStop.value);
            return colorStop;
        }
        return null;
    });
    if (!parsedArgs) {
        return null;
    }
    end = parsedArgs.end;
    return { start: start, end: end, value: { angle: angle, colors: colors } };
}
exports.parseLinearGradient = parseLinearGradient;
var slashRegEx = /\s*(\/)\s*/gy;
function parseSlash(text, start) {
    slashRegEx.lastIndex = start;
    var slash = slashRegEx.exec(text);
    if (!slash) {
        return null;
    }
    var end = slashRegEx.lastIndex;
    return { start: start, end: end, value: "/" };
}
function parseBackground(text, start) {
    if (start === void 0) { start = 0; }
    var value = {};
    var end = start;
    while (end < text.length) {
        var keyword = parseKeyword(text, end);
        var color = parseColor(text, end, keyword);
        if (color) {
            value.color = color.value;
            end = color.end;
            continue;
        }
        var repeat = parseRepeat(text, end, keyword);
        if (repeat) {
            value.repeat = repeat.value;
            end = repeat.end;
            continue;
        }
        var position = parseBackgroundPosition(text, end, keyword);
        if (position) {
            position.value.text = text.substring(position.start, position.end);
            value.position = position.value;
            end = position.end;
            var slash = parseSlash(text, end);
            if (slash) {
                end = slash.end;
                var size = parseBackgroundSize(text, end);
                if (!size) {
                    return null;
                }
                value.size = size.value;
                end = size.end;
            }
            continue;
        }
        var url = parseURL(text, end);
        if (url) {
            value.image = url.value;
            end = url.end;
            continue;
        }
        var gradient = parseLinearGradient(text, end);
        if (gradient) {
            value.image = gradient.value;
            end = gradient.end;
            continue;
        }
        return null;
    }
    return { start: start, end: end, value: value };
}
exports.parseBackground = parseBackground;
var universalSelectorRegEx = /\*/gy;
function parseUniversalSelector(text, start) {
    if (start === void 0) { start = 0; }
    universalSelectorRegEx.lastIndex = start;
    var result = universalSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = universalSelectorRegEx.lastIndex;
    return { start: start, end: end, value: { type: "*" } };
}
exports.parseUniversalSelector = parseUniversalSelector;
var simpleIdentifierSelectorRegEx = /(#|\.|:|\b)([_-\w][_-\w\d\\/]*)/gy;
function parseSimpleIdentifierSelector(text, start) {
    if (start === void 0) { start = 0; }
    simpleIdentifierSelectorRegEx.lastIndex = start;
    var result = simpleIdentifierSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = simpleIdentifierSelectorRegEx.lastIndex;
    var type = result[1];
    var identifier = result[2].replace(/\\/g, "");
    var value = { type: type, identifier: identifier };
    return { start: start, end: end, value: value };
}
exports.parseSimpleIdentifierSelector = parseSimpleIdentifierSelector;
var attributeSelectorRegEx = /\[\s*([_-\w][_-\w\d]*)\s*(?:(=|\^=|\$=|\*=|\~=|\|=)\s*(?:([_-\w][_-\w\d]*)|"((?:[^\\"]|\\(?:"|n|r|f|\\|0-9a-f))*)"|'((?:[^\\']|\\(?:'|n|r|f|\\|0-9a-f))*)')\s*)?\]/gy;
function parseAttributeSelector(text, start) {
    attributeSelectorRegEx.lastIndex = start;
    var result = attributeSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = attributeSelectorRegEx.lastIndex;
    var property = result[1];
    if (result[2]) {
        var test_1 = result[2];
        var value = result[3] || result[4] || result[5];
        return { start: start, end: end, value: { type: "[]", property: property, test: test_1, value: value } };
    }
    return { start: start, end: end, value: { type: "[]", property: property } };
}
exports.parseAttributeSelector = parseAttributeSelector;
function parseSimpleSelector(text, start) {
    if (start === void 0) { start = 0; }
    return parseUniversalSelector(text, start) ||
        parseSimpleIdentifierSelector(text, start) ||
        parseAttributeSelector(text, start);
}
exports.parseSimpleSelector = parseSimpleSelector;
function parseSimpleSelectorSequence(text, start) {
    var simpleSelector = parseSimpleSelector(text, start);
    if (!simpleSelector) {
        return null;
    }
    var end = simpleSelector.end;
    var value = [];
    while (simpleSelector) {
        value.push(simpleSelector.value);
        end = simpleSelector.end;
        simpleSelector = parseSimpleSelector(text, end);
    }
    return { start: start, end: end, value: value };
}
exports.parseSimpleSelectorSequence = parseSimpleSelectorSequence;
var combinatorRegEx = /\s*(\+|~|>)?\s*/gy;
function parseCombinator(text, start) {
    if (start === void 0) { start = 0; }
    combinatorRegEx.lastIndex = start;
    var result = combinatorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = combinatorRegEx.lastIndex;
    var value = result[1] || " ";
    return { start: start, end: end, value: value };
}
exports.parseCombinator = parseCombinator;
var whiteSpaceRegEx = /\s*/gy;
function parseSelector(text, start) {
    if (start === void 0) { start = 0; }
    var end = start;
    whiteSpaceRegEx.lastIndex = end;
    var leadingWhiteSpace = whiteSpaceRegEx.exec(text);
    if (leadingWhiteSpace) {
        end = whiteSpaceRegEx.lastIndex;
    }
    var value = [];
    var combinator;
    var expectSimpleSelector = true;
    var pair;
    do {
        var simpleSelectorSequence = parseSimpleSelectorSequence(text, end);
        if (!simpleSelectorSequence) {
            if (expectSimpleSelector) {
                return null;
            }
            else {
                break;
            }
        }
        end = simpleSelectorSequence.end;
        if (combinator) {
            pair[1] = combinator.value;
        }
        pair = [simpleSelectorSequence.value, undefined];
        value.push(pair);
        combinator = parseCombinator(text, end);
        if (combinator) {
            end = combinator.end;
        }
        expectSimpleSelector = combinator && combinator.value !== " ";
    } while (combinator);
    return { start: start, end: end, value: value };
}
exports.parseSelector = parseSelector;
var whitespaceRegEx = /[\s\t\n\r\f]*/gym;
var singleQuoteStringRegEx = /'((?:[^\n\r\f\']|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?'|$)/gym;
var doubleQuoteStringRegEx = /"((?:[^\n\r\f\"]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?"|$)/gym;
var commentRegEx = /(\/\*(?:[^\*]|\*[^\/])*\*\/)/gym;
var numberRegEx = /[\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?/gym;
var nameRegEx = /-?(?:(?:[a-zA-Z_]|[^\x00-\x7F]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))(?:[a-zA-Z_0-9\-]*|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)/gym;
var CSS3Parser = (function () {
    function CSS3Parser(text) {
        this.text = text;
        this.nextInputCodePointIndex = 0;
    }
    CSS3Parser.prototype.tokenize = function () {
        var tokens = [];
        var inputToken;
        do {
            inputToken = this.consumeAToken();
            tokens.push(inputToken);
        } while (inputToken);
        return tokens;
    };
    CSS3Parser.prototype.consumeAToken = function () {
        if (this.reconsumedInputToken) {
            var result = this.reconsumedInputToken;
            this.reconsumedInputToken = null;
            return result;
        }
        var char = this.text[this.nextInputCodePointIndex];
        switch (char) {
            case "\"": return this.consumeAStringToken();
            case "'": return this.consumeAStringToken();
            case "(":
            case ")":
            case ",":
            case ":":
            case ";":
            case "[":
            case "]":
            case "{":
            case "}":
                this.nextInputCodePointIndex++;
                return char;
            case "#": return this.consumeAHashToken() || this.consumeADelimToken();
            case " ":
            case "\t":
            case "\n":
            case "\r":
            case "\f":
                return this.consumeAWhitespace();
            case "@": return this.consumeAtKeyword() || this.consumeADelimToken();
            case "\\": return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "0":
            case "1":
            case "2":
            case "3":
            case "4":
            case "5":
            case "6":
            case "7":
            case "8":
            case "9":
                return this.consumeANumericToken();
            case "u":
            case "U":
                if (this.text[this.nextInputCodePointIndex + 1] === "+") {
                    var thirdChar = this.text[this.nextInputCodePointIndex + 2];
                    if (thirdChar >= "0" && thirdChar <= "9" || thirdChar === "?") {
                        throw new Error("Unicode tokens not supported!");
                    }
                }
                return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "$":
            case "*":
            case "^":
            case "|":
            case "~":
                return this.consumeAMatchToken() || this.consumeADelimToken();
            case "-": return this.consumeANumericToken() || this.consumeAnIdentLikeToken() || this.consumeCDC() || this.consumeADelimToken();
            case "+":
            case ".":
                return this.consumeANumericToken() || this.consumeADelimToken();
            case "/": return this.consumeAComment() || this.consumeADelimToken();
            case "<": return this.consumeCDO() || this.consumeADelimToken();
            case undefined: return undefined;
            default: return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
        }
    };
    CSS3Parser.prototype.consumeADelimToken = function () {
        return { type: 2, text: this.text[this.nextInputCodePointIndex++] };
    };
    CSS3Parser.prototype.consumeAWhitespace = function () {
        whitespaceRegEx.lastIndex = this.nextInputCodePointIndex;
        whitespaceRegEx.exec(this.text);
        this.nextInputCodePointIndex = whitespaceRegEx.lastIndex;
        return " ";
    };
    CSS3Parser.prototype.consumeAHashToken = function () {
        this.nextInputCodePointIndex++;
        var hashName = this.consumeAName();
        if (hashName) {
            return { type: 12, text: "#" + hashName.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeCDO = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 4) === "<!--") {
            this.nextInputCodePointIndex += 4;
            return "<!--";
        }
        return null;
    };
    CSS3Parser.prototype.consumeCDC = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 3) === "-->") {
            this.nextInputCodePointIndex += 3;
            return "-->";
        }
        return null;
    };
    CSS3Parser.prototype.consumeAMatchToken = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "=") {
            var token = this.text.substr(this.nextInputCodePointIndex, 2);
            this.nextInputCodePointIndex += 2;
            return token;
        }
        return null;
    };
    CSS3Parser.prototype.consumeANumericToken = function () {
        numberRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = numberRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = numberRegEx.lastIndex;
        if (this.text[this.nextInputCodePointIndex] === "%") {
            return { type: 4, text: result[0] };
        }
        var name = this.consumeAName();
        if (name) {
            return { type: 5, text: result[0] + name.text };
        }
        return { type: 3, text: result[0] };
    };
    CSS3Parser.prototype.consumeAnIdentLikeToken = function () {
        var name = this.consumeAName();
        if (!name) {
            return null;
        }
        if (this.text[this.nextInputCodePointIndex] === "(") {
            this.nextInputCodePointIndex++;
            if (name.text.toLowerCase() === "url") {
                return this.consumeAURLToken();
            }
            return { type: 8, name: name.text, text: name.text + "(" };
        }
        return name;
    };
    CSS3Parser.prototype.consumeAStringToken = function () {
        var char = this.text[this.nextInputCodePointIndex];
        var result;
        if (char === "'") {
            singleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = singleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = singleQuoteStringRegEx.lastIndex;
        }
        else if (char === "\"") {
            doubleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = doubleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = doubleQuoteStringRegEx.lastIndex;
        }
        return { type: 1, text: result[0] };
    };
    CSS3Parser.prototype.consumeAURLToken = function () {
        var start = this.nextInputCodePointIndex - 3 - 1;
        var urlToken = { type: 7, text: undefined };
        this.consumeAWhitespace();
        if (this.nextInputCodePointIndex >= this.text.length) {
            return urlToken;
        }
        var nextInputCodePoint = this.text[this.nextInputCodePointIndex];
        if (nextInputCodePoint === "\"" || nextInputCodePoint === "'") {
            var stringToken = this.consumeAStringToken();
            urlToken.text = stringToken.text;
            this.consumeAWhitespace();
            if (this.text[this.nextInputCodePointIndex] === ")" || this.nextInputCodePointIndex >= this.text.length) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                urlToken.text = this.text.substring(start, end);
                return urlToken;
            }
            else {
                return null;
            }
        }
        while (this.nextInputCodePointIndex < this.text.length) {
            var char = this.text[this.nextInputCodePointIndex++];
            switch (char) {
                case ")": return urlToken;
                case " ":
                case "\t":
                case "\n":
                case "\r":
                case "\f":
                    this.consumeAWhitespace();
                    if (this.text[this.nextInputCodePointIndex] === ")") {
                        this.nextInputCodePointIndex++;
                        return urlToken;
                    }
                    else {
                        return null;
                    }
                case "\"":
                case "\'":
                    return null;
                case "\\":
                    throw new Error("Escaping not yet supported!");
                default:
                    urlToken.text += char;
            }
        }
        return urlToken;
    };
    CSS3Parser.prototype.consumeAName = function () {
        nameRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = nameRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = nameRegEx.lastIndex;
        return { type: 6, text: result[0] };
    };
    CSS3Parser.prototype.consumeAtKeyword = function () {
        this.nextInputCodePointIndex++;
        var name = this.consumeAName();
        if (name) {
            return { type: 11, text: name.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeAComment = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "*") {
            commentRegEx.lastIndex = this.nextInputCodePointIndex;
            var result = commentRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = commentRegEx.lastIndex;
            return this.consumeAToken();
        }
        return null;
    };
    CSS3Parser.prototype.reconsumeTheCurrentInputToken = function (currentInputToken) {
        this.reconsumedInputToken = currentInputToken;
    };
    CSS3Parser.prototype.parseAStylesheet = function () {
        this.topLevelFlag = true;
        var stylesheet = {
            rules: this.consumeAListOfRules()
        };
        return stylesheet;
    };
    CSS3Parser.prototype.consumeAListOfRules = function () {
        var rules = [];
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            switch (inputToken) {
                case " ": continue;
                case "<!--":
                case "-->":
                    if (this.topLevelFlag) {
                        continue;
                    }
                    this.reconsumeTheCurrentInputToken(inputToken);
                    var atRule = this.consumeAnAtRule();
                    if (atRule) {
                        rules.push(atRule);
                    }
                    continue;
            }
            if (inputToken.type === 11) {
                this.reconsumeTheCurrentInputToken(inputToken);
                var atRule = this.consumeAnAtRule();
                if (atRule) {
                    rules.push(atRule);
                }
                continue;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var qualifiedRule = this.consumeAQualifiedRule();
            if (qualifiedRule) {
                rules.push(qualifiedRule);
            }
        }
        return rules;
    };
    CSS3Parser.prototype.consumeAnAtRule = function () {
        var inputToken = this.consumeAToken();
        var atRule = {
            type: "at-rule",
            name: inputToken.text,
            prelude: [],
            block: undefined
        };
        while (inputToken = this.consumeAToken()) {
            if (inputToken === ";") {
                return atRule;
            }
            else if (inputToken === "{") {
                atRule.block = this.consumeASimpleBlock(inputToken);
                return atRule;
            }
            else if (inputToken.type === 9 && inputToken.associatedToken === "{") {
                atRule.block = inputToken;
                return atRule;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var component = this.consumeAComponentValue();
            if (component) {
                atRule.prelude.push(component);
            }
        }
        return atRule;
    };
    CSS3Parser.prototype.consumeAQualifiedRule = function () {
        var qualifiedRule = {
            type: "qualified-rule",
            prelude: [],
            block: undefined
        };
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            if (inputToken === "{") {
                var block = this.consumeASimpleBlock(inputToken);
                qualifiedRule.block = block;
                return qualifiedRule;
            }
            else if (inputToken.type === 9) {
                var simpleBlock = inputToken;
                if (simpleBlock.associatedToken === "{") {
                    qualifiedRule.block = simpleBlock;
                    return qualifiedRule;
                }
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var componentValue = this.consumeAComponentValue();
            if (componentValue) {
                qualifiedRule.prelude.push(componentValue);
            }
        }
        return null;
    };
    CSS3Parser.prototype.consumeAComponentValue = function () {
        var inputToken = this.consumeAToken();
        switch (inputToken) {
            case "{":
            case "[":
            case "(":
                this.nextInputCodePointIndex++;
                return this.consumeASimpleBlock(inputToken);
        }
        if (typeof inputToken === "object" && inputToken.type === 8) {
            return this.consumeAFunction(inputToken.name);
        }
        return inputToken;
    };
    CSS3Parser.prototype.consumeASimpleBlock = function (associatedToken) {
        var endianToken = {
            "[": "]",
            "{": "}",
            "(": ")"
        }[associatedToken];
        var start = this.nextInputCodePointIndex - 1;
        var block = {
            type: 9,
            text: undefined,
            associatedToken: associatedToken,
            values: []
        };
        var nextInputToken;
        while (nextInputToken = this.text[this.nextInputCodePointIndex]) {
            if (nextInputToken === endianToken) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                block.text = this.text.substring(start, end);
                return block;
            }
            var value = this.consumeAComponentValue();
            if (value) {
                block.values.push(value);
            }
        }
        block.text = this.text.substring(start);
        return block;
    };
    CSS3Parser.prototype.consumeAFunction = function (name) {
        var start = this.nextInputCodePointIndex;
        var funcToken = { type: 14, name: name, text: undefined, components: [] };
        do {
            if (this.nextInputCodePointIndex >= this.text.length) {
                funcToken.text = name + "(" + this.text.substring(start);
                return funcToken;
            }
            var nextInputToken = this.text[this.nextInputCodePointIndex];
            switch (nextInputToken) {
                case ")":
                    this.nextInputCodePointIndex++;
                    var end = this.nextInputCodePointIndex;
                    funcToken.text = name + "(" + this.text.substring(start, end);
                    return funcToken;
                default:
                    var component = this.consumeAComponentValue();
                    if (component) {
                        funcToken.components.push(component);
                    }
            }
        } while (true);
    };
    return CSS3Parser;
}());
exports.CSS3Parser = CSS3Parser;
var CSSNativeScript = (function () {
    function CSSNativeScript() {
    }
    CSSNativeScript.prototype.parseStylesheet = function (stylesheet) {
        return {
            type: "stylesheet",
            stylesheet: {
                rules: this.parseRules(stylesheet.rules)
            }
        };
    };
    CSSNativeScript.prototype.parseRules = function (rules) {
        var _this = this;
        return rules.map(function (rule) { return _this.parseRule(rule); });
    };
    CSSNativeScript.prototype.parseRule = function (rule) {
        if (rule.type === "at-rule") {
            return this.parseAtRule(rule);
        }
        else if (rule.type === "qualified-rule") {
            return this.parseQualifiedRule(rule);
        }
    };
    CSSNativeScript.prototype.parseAtRule = function (rule) {
        if (rule.name === "import") {
            return {
                import: rule.prelude.map(function (m) { return typeof m === "string" ? m : m.text; }).join("").trim(),
                type: "import"
            };
        }
        return;
    };
    CSSNativeScript.prototype.parseQualifiedRule = function (rule) {
        return {
            type: "rule",
            selectors: this.preludeToSelectorsStringArray(rule.prelude),
            declarations: this.ruleBlockToDeclarations(rule.block.values)
        };
    };
    CSSNativeScript.prototype.ruleBlockToDeclarations = function (declarationsInputTokens) {
        var declarations = [];
        var property = "";
        var value = "";
        var reading = "property";
        for (var i = 0; i < declarationsInputTokens.length; i++) {
            var inputToken = declarationsInputTokens[i];
            if (reading === "property") {
                if (inputToken === ":") {
                    reading = "value";
                }
                else if (typeof inputToken === "string") {
                    property += inputToken;
                }
                else {
                    property += inputToken.text;
                }
            }
            else {
                if (inputToken === ";") {
                    property = property.trim();
                    value = value.trim();
                    declarations.push({ type: "declaration", property: property, value: value });
                    property = "";
                    value = "";
                    reading = "property";
                }
                else if (typeof inputToken === "string") {
                    value += inputToken;
                }
                else {
                    value += inputToken.text;
                }
            }
        }
        property = property.trim();
        value = value.trim();
        if (property || value) {
            declarations.push({ type: "declaration", property: property, value: value });
        }
        return declarations;
    };
    CSSNativeScript.prototype.preludeToSelectorsStringArray = function (prelude) {
        var selectors = [];
        var selector = "";
        prelude.forEach(function (inputToken) {
            if (typeof inputToken === "string") {
                if (inputToken === ",") {
                    if (selector) {
                        selectors.push(selector.trim());
                    }
                    selector = "";
                }
                else {
                    selector += inputToken;
                }
            }
            else if (typeof inputToken === "object") {
                selector += inputToken.text;
            }
        });
        if (selector) {
            selectors.push(selector.trim());
        }
        return selectors;
    };
    return CSSNativeScript;
}());
exports.CSSNativeScript = CSSNativeScript;
//# sourceMappingURL=parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css/system-classes.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MODAL = "modal";
var ROOT = "root";
exports.CLASS_PREFIX = "ns-";
var modalRootViewCssClass = "" + exports.CLASS_PREFIX + MODAL;
var rootViewCssClasses = ["" + exports.CLASS_PREFIX + ROOT];
function getModalRootViewCssClass() {
    return modalRootViewCssClass;
}
exports.getModalRootViewCssClass = getModalRootViewCssClass;
function getRootViewCssClasses() {
    return rootViewCssClasses;
}
exports.getRootViewCssClasses = getRootViewCssClasses;
function pushToRootViewCssClasses(value) {
    rootViewCssClasses.push(value);
    return rootViewCssClasses.length;
}
exports.pushToRootViewCssClasses = pushToRootViewCssClasses;
function removeFromRootViewCssClasses(value) {
    var index = rootViewCssClasses.indexOf(value);
    var removedElement;
    if (index > -1) {
        removedElement = rootViewCssClasses.splice(index, 1);
    }
    return removedElement;
}
exports.removeFromRootViewCssClasses = removeFromRootViewCssClasses;
//# sourceMappingURL=system-classes.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable-array/observable-array.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var ChangeType = (function () {
    function ChangeType() {
    }
    ChangeType.Add = "add";
    ChangeType.Delete = "delete";
    ChangeType.Update = "update";
    ChangeType.Splice = "splice";
    return ChangeType;
}());
exports.ChangeType = ChangeType;
var CHANGE = "change";
var ObservableArray = (function (_super) {
    __extends(ObservableArray, _super);
    function ObservableArray() {
        var _this = _super.call(this) || this;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            _this._array = arguments[0].slice();
        }
        else {
            _this._array = Array.apply(null, arguments);
        }
        _this._addArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Add,
            index: null,
            removed: new Array(),
            addedCount: 1
        };
        _this._deleteArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Delete,
            index: null,
            removed: null,
            addedCount: 0
        };
        return _this;
    }
    ObservableArray.prototype.getItem = function (index) {
        return this._array[index];
    };
    ObservableArray.prototype.setItem = function (index, value) {
        var oldValue = this._array[index];
        this._array[index] = value;
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Update,
            index: index,
            removed: [oldValue],
            addedCount: 1
        });
    };
    Object.defineProperty(ObservableArray.prototype, "length", {
        get: function () {
            return this._array.length;
        },
        set: function (value) {
            if (types.isNumber(value) && this._array && this._array.length !== value) {
                this.splice(value, this._array.length - value);
            }
        },
        enumerable: true,
        configurable: true
    });
    ObservableArray.prototype.toString = function () {
        return this._array.toString();
    };
    ObservableArray.prototype.toLocaleString = function () {
        return this._array.toLocaleString();
    };
    ObservableArray.prototype.concat = function () {
        this._addArgs.index = this._array.length;
        var result = this._array.concat.apply(this._array, arguments);
        return result;
    };
    ObservableArray.prototype.join = function (separator) {
        return this._array.join(separator);
    };
    ObservableArray.prototype.pop = function () {
        this._deleteArgs.index = this._array.length - 1;
        var result = this._array.pop();
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.push = function () {
        this._addArgs.index = this._array.length;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            var source = arguments[0];
            for (var i = 0, l = source.length; i < l; i++) {
                this._array.push(source[i]);
            }
        }
        else {
            this._array.push.apply(this._array, arguments);
        }
        this._addArgs.addedCount = this._array.length - this._addArgs.index;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return this._array.length;
    };
    ObservableArray.prototype._notifyLengthChange = function () {
        var lengthChangedData = this._createPropertyChangeData("length", this._array.length);
        this.notify(lengthChangedData);
    };
    ObservableArray.prototype.reverse = function () {
        return this._array.reverse();
    };
    ObservableArray.prototype.shift = function () {
        var result = this._array.shift();
        this._deleteArgs.index = 0;
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.slice = function (start, end) {
        return this._array.slice(start, end);
    };
    ObservableArray.prototype.sort = function (compareFn) {
        return this._array.sort(compareFn);
    };
    ObservableArray.prototype.splice = function (start, deleteCount) {
        var length = this._array.length;
        var result = this._array.splice.apply(this._array, arguments);
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Splice,
            index: start,
            removed: result,
            addedCount: this._array.length + result.length - length
        });
        if (this._array.length !== length) {
            this._notifyLengthChange();
        }
        return result;
    };
    ObservableArray.prototype.unshift = function () {
        var length = this._array.length;
        var result = this._array.unshift.apply(this._array, arguments);
        this._addArgs.index = 0;
        this._addArgs.addedCount = result - length;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.indexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : 0;
        for (var i = index, l = this._array.length; i < l; i++) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.lastIndexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : this._array.length - 1;
        for (var i = index; i >= 0; i--) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.every = function (callbackfn, thisArg) {
        return this._array.every(callbackfn, thisArg);
    };
    ObservableArray.prototype.some = function (callbackfn, thisArg) {
        return this._array.some(callbackfn, thisArg);
    };
    ObservableArray.prototype.forEach = function (callbackfn, thisArg) {
        this._array.forEach(callbackfn, thisArg);
    };
    ObservableArray.prototype.map = function (callbackfn, thisArg) {
        return this._array.map(callbackfn, thisArg);
    };
    ObservableArray.prototype.filter = function (callbackfn, thisArg) {
        return this._array.filter(callbackfn, thisArg);
    };
    ObservableArray.prototype.reduce = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduce(callbackfn, initialValue) : this._array.reduce(callbackfn);
    };
    ObservableArray.prototype.reduceRight = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduceRight(callbackfn, initialValue) : this._array.reduceRight(callbackfn);
    };
    ObservableArray.changeEvent = CHANGE;
    return ObservableArray;
}(observable.Observable));
exports.ObservableArray = ObservableArray;
//# sourceMappingURL=observable-array.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable/observable.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _wrappedIndex = 0;
var WrappedValue = (function () {
    function WrappedValue(wrapped) {
        this.wrapped = wrapped;
    }
    WrappedValue.unwrap = function (value) {
        return (value instanceof WrappedValue) ? value.wrapped : value;
    };
    WrappedValue.wrap = function (value) {
        var w = _wrappedValues[_wrappedIndex++ % 5];
        w.wrapped = value;
        return w;
    };
    return WrappedValue;
}());
exports.WrappedValue = WrappedValue;
var _wrappedValues = [
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null)
];
var Observable = (function () {
    function Observable() {
        this._observers = {};
    }
    Observable.prototype.get = function (name) {
        return this[name];
    };
    Observable.prototype.set = function (name, value) {
        var oldValue = this[name];
        if (this[name] === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this[name] = newValue;
        this.notifyPropertyChange(name, newValue, oldValue);
    };
    Observable.prototype.on = function (eventNames, callback, thisArg) {
        this.addEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.once = function (event, callback, thisArg) {
        var list = this._getEventList(event, true);
        list.push({ callback: callback, thisArg: thisArg, once: true });
    };
    Observable.prototype.off = function (eventNames, callback, thisArg) {
        this.removeEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.addEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_1 = events[i].trim();
            var list = this._getEventList(event_1, true);
            list.push({
                callback: callback,
                thisArg: thisArg
            });
        }
    };
    Observable.prototype.removeEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (callback && typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_2 = events[i].trim();
            if (callback) {
                var list = this._getEventList(event_2, false);
                if (list) {
                    var index_1 = this._indexOfListener(list, callback, thisArg);
                    if (index_1 >= 0) {
                        list.splice(index_1, 1);
                    }
                    if (list.length === 0) {
                        delete this._observers[event_2];
                    }
                }
            }
            else {
                this._observers[event_2] = undefined;
                delete this._observers[event_2];
            }
        }
    };
    Observable.prototype.notify = function (data) {
        var observers = this._observers[data.eventName];
        if (!observers) {
            return;
        }
        for (var i = observers.length - 1; i >= 0; i--) {
            var entry = observers[i];
            if (entry.once) {
                observers.splice(i, 1);
            }
            if (entry.thisArg) {
                entry.callback.apply(entry.thisArg, [data]);
            }
            else {
                entry.callback(data);
            }
        }
    };
    Observable.prototype.notifyPropertyChange = function (name, value, oldValue) {
        this.notify(this._createPropertyChangeData(name, value, oldValue));
    };
    Observable.prototype.hasListeners = function (eventName) {
        return eventName in this._observers;
    };
    Observable.prototype._createPropertyChangeData = function (propertyName, value, oldValue) {
        return { eventName: Observable.propertyChangeEvent, object: this, propertyName: propertyName, value: value, oldValue: oldValue };
    };
    Observable.prototype._emit = function (eventNames) {
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_3 = events[i].trim();
            this.notify({ eventName: event_3, object: this });
        }
    };
    Observable.prototype._getEventList = function (eventName, createIfNeeded) {
        if (!eventName) {
            throw new TypeError("EventName must be valid string.");
        }
        var list = this._observers[eventName];
        if (!list && createIfNeeded) {
            list = [];
            this._observers[eventName] = list;
        }
        return list;
    };
    Observable.prototype._indexOfListener = function (list, callback, thisArg) {
        for (var i = 0; i < list.length; i++) {
            var entry = list[i];
            if (thisArg) {
                if (entry.callback === callback && entry.thisArg === thisArg) {
                    return i;
                }
            }
            else {
                if (entry.callback === callback) {
                    return i;
                }
            }
        }
        return -1;
    };
    Observable.propertyChangeEvent = "propertyChange";
    return Observable;
}());
exports.Observable = Observable;
var ObservableFromObject = (function (_super) {
    __extends(ObservableFromObject, _super);
    function ObservableFromObject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._map = {};
        return _this;
    }
    ObservableFromObject.prototype.get = function (name) {
        return this._map[name];
    };
    ObservableFromObject.prototype.set = function (name, value) {
        var currentValue = this._map[name];
        if (currentValue === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this._map[name] = newValue;
        this.notifyPropertyChange(name, newValue, currentValue);
    };
    return ObservableFromObject;
}(Observable));
function defineNewProperty(target, propertyName) {
    Object.defineProperty(target, propertyName, {
        get: function () {
            return target._map[propertyName];
        },
        set: function (value) {
            target.set(propertyName, value);
        },
        enumerable: true,
        configurable: true
    });
}
function addPropertiesFromObject(observable, source, recursive) {
    if (recursive === void 0) { recursive = false; }
    Object.keys(source).forEach(function (prop) {
        var value = source[prop];
        if (recursive
            && !Array.isArray(value)
            && value
            && typeof value === "object"
            && !(value instanceof Observable)) {
            value = fromObjectRecursive(value);
        }
        defineNewProperty(observable, prop);
        observable.set(prop, value);
    });
}
function fromObject(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, false);
    return observable;
}
exports.fromObject = fromObject;
function fromObjectRecursive(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, true);
    return observable;
}
exports.fromObjectRecursive = fromObjectRecursive;
//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/debugger.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var network;
function getNetwork() {
    return network;
}
exports.getNetwork = getNetwork;
function setNetwork(newNetwork) {
    network = newNetwork;
}
exports.setNetwork = setNetwork;
var dom;
function getDOM() {
    return dom;
}
exports.getDOM = getDOM;
function setDOM(newDOM) {
    dom = newDOM;
}
exports.setDOM = setDOM;
var css;
function getCSS() {
    return css;
}
exports.getCSS = getCSS;
function setCSS(newCSS) {
    css = newCSS;
}
exports.setCSS = setCSS;
var NetworkAgent;
(function (NetworkAgent) {
    function responseReceived(requestId, result, headers) {
        var requestIdStr = requestId.toString();
        var mimeType = headers["Content-Type"] || headers["content-type"] || "application/octet-stream";
        var contentLengthHeader = headers["Content-Length"] || headers["content-length"];
        var contentLength = parseInt(contentLengthHeader, 10);
        if (isNaN(contentLength)) {
            contentLength = 0;
        }
        var response = {
            url: result.url || "",
            status: result.statusCode,
            statusText: result.statusText || "",
            headers: headers,
            mimeType: mimeType,
            fromDiskCache: false,
            connectionReused: true,
            connectionId: 0,
            encodedDataLength: contentLength,
            securityState: "info"
        };
        var responseData = {
            requestId: requestIdStr,
            type: mimeTypeToType(response.mimeType),
            response: response,
            timestamp: getTimeStamp()
        };
        global.__inspector.responseReceived(responseData);
        global.__inspector.loadingFinished({
            requestId: requestIdStr,
            timestamp: getTimeStamp(),
            encodedDataLength: contentLength
        });
        var hasTextContent = responseData.type === "Document" || responseData.type === "Script";
        var data;
        if (!hasTextContent) {
            if (responseData.type === "Image") {
                var bitmap = result.responseAsImage;
                if (bitmap) {
                    var outputStream = new java.io.ByteArrayOutputStream();
                    bitmap.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, outputStream);
                    var base64Image = android.util.Base64.encodeToString(outputStream.toByteArray(), android.util.Base64.DEFAULT);
                    data = base64Image;
                }
            }
        }
        else {
            data = result.responseAsString;
        }
        var successfulRequestData = {
            requestId: requestIdStr,
            data: data,
            hasTextContent: hasTextContent
        };
        global.__inspector.dataForRequestId(successfulRequestData);
    }
    NetworkAgent.responseReceived = responseReceived;
    function requestWillBeSent(requestId, options) {
        var request = {
            url: options.url,
            method: options.method,
            headers: options.headers || {},
            postData: options.content ? options.content.toString() : "",
            initialPriority: "Medium",
            referrerPolicy: "no-referrer-when-downgrade"
        };
        var requestData = {
            requestId: requestId.toString(),
            url: request.url,
            request: request,
            timestamp: getTimeStamp(),
            type: "Document",
            wallTime: 0
        };
        global.__inspector.requestWillBeSent(requestData);
    }
    NetworkAgent.requestWillBeSent = requestWillBeSent;
    function getTimeStamp() {
        var d = new Date();
        return Math.round(d.getTime() / 1000);
    }
    function mimeTypeToType(mimeType) {
        var type = "Document";
        if (mimeType) {
            if (mimeType.indexOf("image") === 0) {
                type = "Image";
            }
            else if (mimeType.indexOf("javascript") !== -1 || mimeType.indexOf("json") !== -1) {
                type = "Script";
            }
        }
        return type;
    }
})(NetworkAgent = exports.NetworkAgent || (exports.NetworkAgent = {}));
//# sourceMappingURL=debugger.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var frameTopmost = function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js").topmost(); };
var unsetValue;
function unsetViewValue(view, name) {
    if (!unsetValue) {
        unsetValue = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").unsetValue;
    }
    view[name] = unsetValue;
}
function getViewById(nodeId) {
    var node = dom_node_1.getNodeById(nodeId);
    var view;
    if (node) {
        view = node.viewRef.get();
    }
    return view;
}
function getDocument() {
    var topMostFrame = frameTopmost();
    if (!topMostFrame) {
        return undefined;
    }
    try {
        topMostFrame.ensureDomNode();
    }
    catch (e) {
        console.log("ERROR in getDocument(): " + e);
    }
    return topMostFrame.domNode.toObject();
}
exports.getDocument = getDocument;
function getComputedStylesForNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        return view.domNode.getComputedProperties();
    }
    return [];
}
exports.getComputedStylesForNode = getComputedStylesForNode;
exports.removeNode = utils_1.mainThreadify(function removeNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        var parent_1 = view.parent;
        if (parent_1.removeChild) {
            parent_1.removeChild(view);
        }
        else if (parent_1.content === view) {
            parent_1.content = null;
        }
        else {
            console.log("Can't remove child from " + parent_1);
        }
    }
});
exports.setAttributeAsText = utils_1.mainThreadify(function setAttributeAsText(nodeId, text, name) {
    var view = getViewById(nodeId);
    if (view) {
        var hasOriginalAttribute = !!name.trim();
        if (text) {
            var textParts = text.split("=");
            if (textParts.length === 2) {
                var attrName = textParts[0];
                var attrValue = textParts[1].replace(/['"]+/g, "");
                if (name !== attrName && hasOriginalAttribute) {
                    unsetViewValue(view, name);
                    view[attrName] = attrValue;
                }
                else {
                    view[hasOriginalAttribute ? name : attrName] = attrValue;
                }
            }
        }
        else {
            unsetViewValue(view, name);
        }
        view.domNode.loadAttributes();
    }
});
//# sourceMappingURL=devtools-elements.common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var devtools_elements_common_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.common.js");
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
function attachDOMInspectorEventCallbacks(DOMDomainFrontend) {
    dom_node_1.registerInspectorEvents(DOMDomainFrontend);
    var originalChildNodeInserted = DOMDomainFrontend.childNodeInserted;
    DOMDomainFrontend.childNodeInserted = function (parentId, lastId, node) {
        originalChildNodeInserted(parentId, lastId, JSON.stringify(node.toObject()));
    };
}
exports.attachDOMInspectorEventCallbacks = attachDOMInspectorEventCallbacks;
function attachDOMInspectorCommandCallbacks(DOMDomainBackend) {
    DOMDomainBackend.getDocument = function () {
        return JSON.stringify(devtools_elements_common_1.getDocument());
    };
    DOMDomainBackend.getComputedStylesForNode = function (nodeId) {
        return JSON.stringify(devtools_elements_common_1.getComputedStylesForNode(nodeId));
    };
    DOMDomainBackend.removeNode = devtools_elements_common_1.removeNode;
    DOMDomainBackend.setAttributeAsText = devtools_elements_common_1.setAttributeAsText;
}
exports.attachDOMInspectorCommandCallbacks = attachDOMInspectorCommandCallbacks;
function attachCSSInspectorCommandCallbacks(CSSDomainFrontend) {
}
exports.attachCSSInspectorCommandCallbacks = attachCSSInspectorCommandCallbacks;
//# sourceMappingURL=devtools-elements.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/dom-node.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var registeredDomNodes = {};
var ELEMENT_NODE_TYPE = 1;
var ROOT_NODE_TYPE = 9;
var propertyBlacklist = [
    "effectivePaddingLeft",
    "effectivePaddingBottom",
    "effectivePaddingRight",
    "effectivePaddingTop",
    "effectiveBorderTopWidth",
    "effectiveBorderRightWidth",
    "effectiveBorderBottomWidth",
    "effectiveBorderLeftWidth",
    "effectiveMinWidth",
    "effectiveMinHeight",
    "effectiveWidth",
    "effectiveHeight",
    "effectiveMarginLeft",
    "effectiveMarginTop",
    "effectiveMarginRight",
    "effectiveMarginBottom",
    "nodeName",
    "nodeType",
    "decodeWidth",
    "decodeHeight",
    "ng-reflect-items",
    "domNode",
    "touchListenerIsSet",
    "bindingContext",
    "nativeView"
];
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
var percentLengthToStringLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js").PercentLength.convertToString; });
var getSetPropertiesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getSetProperties; });
var getComputedCssValuesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getComputedCssValues; });
function registerInspectorEvents(inspector) {
    inspectorFrontendInstance = inspector;
}
exports.registerInspectorEvents = registerInspectorEvents;
var inspectorFrontendInstance;
function notifyInspector(callback) {
    if (inspectorFrontendInstance) {
        callback(inspectorFrontendInstance);
    }
}
function valueToString(value) {
    if (typeof value === "undefined" || value === null) {
        return "";
    }
    else if (typeof value === "object" && value.unit) {
        return percentLengthToStringLazy()(value);
    }
    else {
        return value + "";
    }
}
function propertyFilter(_a) {
    var name = _a[0], value = _a[1];
    if (name[0] === "_") {
        return false;
    }
    if (value !== null && typeof value === "object") {
        return false;
    }
    if (propertyBlacklist.indexOf(name) >= 0) {
        return false;
    }
    return true;
}
function registerNode(domNode) {
    registeredDomNodes[domNode.nodeId] = domNode;
}
function unregisterNode(domNode) {
    delete registeredDomNodes[domNode.nodeId];
}
function getNodeById(id) {
    return registeredDomNodes[id];
}
exports.getNodeById = getNodeById;
var DOMNode = (function () {
    function DOMNode(view) {
        this.nodeValue = "";
        this.attributes = [];
        this.viewRef = new WeakRef(view);
        this.nodeType = view.typeName === "Frame" ? ROOT_NODE_TYPE : ELEMENT_NODE_TYPE;
        this.nodeId = view._domId;
        this.nodeName = view.typeName;
        this.localName = this.nodeName;
        this.loadAttributes();
        registerNode(this);
    }
    DOMNode.prototype.loadAttributes = function () {
        var _this = this;
        this.attributes = [];
        getSetPropertiesLazy()(this.viewRef.get())
            .filter(propertyFilter)
            .forEach(function (pair) { return _this.attributes.push(pair[0], pair[1] + ""); });
    };
    Object.defineProperty(DOMNode.prototype, "children", {
        get: function () {
            var view = this.viewRef.get();
            if (!view) {
                return [];
            }
            var res = [];
            view.eachChild(function (child) {
                child.ensureDomNode();
                res.push(child.domNode);
                return true;
            });
            return res;
        },
        enumerable: true,
        configurable: true
    });
    DOMNode.prototype.onChildAdded = function (childView) {
        var _this = this;
        notifyInspector(function (ins) {
            var view = _this.viewRef.get();
            var previousChild;
            view.eachChild(function (child) {
                if (child === childView) {
                    return false;
                }
                previousChild = child;
                return true;
            });
            var index = !!previousChild ? previousChild._domId : 0;
            childView.ensureDomNode();
            ins.childNodeInserted(_this.nodeId, index, childView.domNode);
        });
    };
    DOMNode.prototype.onChildRemoved = function (view) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.childNodeRemoved(_this.nodeId, view._domId);
        });
    };
    DOMNode.prototype.attributeModified = function (name, value) {
        var _this = this;
        notifyInspector(function (ins) {
            if (propertyBlacklist.indexOf(name) < 0) {
                ins.attributeModified(_this.nodeId, name, valueToString(value));
            }
        });
    };
    DOMNode.prototype.attributeRemoved = function (name) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.attributeRemoved(_this.nodeId, name);
        });
    };
    DOMNode.prototype.getComputedProperties = function () {
        var view = this.viewRef.get();
        if (!view) {
            return [];
        }
        var result = getComputedCssValuesLazy()(view)
            .filter(function (pair) { return pair[0][0] !== "_"; })
            .map(function (pair) {
            return {
                name: pair[0],
                value: valueToString(pair[1])
            };
        });
        return result;
    };
    DOMNode.prototype.dispose = function () {
        unregisterNode(this);
        this.viewRef.clear();
    };
    DOMNode.prototype.toObject = function () {
        return {
            nodeId: this.nodeId,
            nodeType: this.nodeType,
            nodeName: this.nodeName,
            localName: this.localName,
            nodeValue: this.nodeValue,
            children: this.children.map(function (c) { return c.toObject(); }),
            attributes: this.attributes,
            backendNodeId: 0
        };
    };
    return DOMNode;
}());
exports.DOMNode = DOMNode;
//# sourceMappingURL=dom-node.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {﻿(function () {
    'use strict';

    exports.XMLHttpRequest = global.XMLHttpRequest;
    exports.FormData = global.FormData;

    if (!exports.XMLHttpRequest) {
        var xhr = __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js");
        exports.XMLHttpRequest = xhr.XMLHttpRequest;
        exports.FormData = xhr.FormData;
    }

    function normalizeName(name) {
        if (typeof name !== 'string') {
            name = name.toString();
        }
        if (/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)) {
            throw new TypeError('Invalid character in header field name')
        }
        return name.toLowerCase()
    }

    function normalizeValue(value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return value
    }

    function Headers(headers) {
        this.map = {}

        if (headers instanceof Headers) {
            headers.forEach(function (value, name) {
                this.append(name, value)
            }, this)

        } else if (headers) {
            Object.getOwnPropertyNames(headers).forEach(function (name) {
                this.append(name, headers[name])
            }, this)
        }
    }

    Headers.prototype.append = function (name, value) {
        name = normalizeName(name)
        value = normalizeValue(value)
        var list = this.map[name]
        if (!list) {
            list = []
            this.map[name] = list
        }
        list.push(value)
    }

    Headers.prototype['delete'] = function (name) {
        delete this.map[normalizeName(name)]
    }

    Headers.prototype.get = function (name) {
        var values = this.map[normalizeName(name)]
        return values ? values[0] : null
    }

    Headers.prototype.getAll = function (name) {
        return this.map[normalizeName(name)] || []
    }

    Headers.prototype.has = function (name) {
        return this.map.hasOwnProperty(normalizeName(name))
    }

    Headers.prototype.set = function (name, value) {
        this.map[normalizeName(name)] = [normalizeValue(value)]
    }

    Headers.prototype.forEach = function (callback, thisArg) {
        Object.getOwnPropertyNames(this.map).forEach(function (name) {
            this.map[name].forEach(function (value) {
                callback.call(thisArg, value, name, this)
            }, this)
        }, this)
    }

    function consumed(body) {
        if (body.bodyUsed) {
            return Promise.reject(new TypeError('Already read'))
        }
        body.bodyUsed = true
    }

    function fileReaderReady(reader) {
        return new Promise(function (resolve, reject) {
            reader.onload = function () {
                resolve(reader.result)
            }
            reader.onerror = function () {
                reject(reader.error)
            }
        })
    }

    function readBlobAsArrayBuffer(blob) {
        var reader = new FileReader()
        reader.readAsArrayBuffer(blob)
        return fileReaderReady(reader)
    }

    function readBlobAsText(blob) {
        var reader = new FileReader()
        reader.readAsText(blob)
        return fileReaderReady(reader)
    }

    var support = {
        blob: 'FileReader' in exports && 'Blob' in exports && (function () {
            try {
                new Blob();
                return true
            } catch (e) {
                return false
            }
        })(),
        formData: 'FormData' in exports
    }

    function Body() {
        this.bodyUsed = false


        this._initBody = function (body) {
            this._bodyInit = body
            if (typeof body === 'string') {
                this._bodyText = body
            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
                this._bodyBlob = body
            } else if (support.formData && exports.FormData.prototype.isPrototypeOf(body)) {
                this._bodyFormData = body
            } else if (!body) {
                this._bodyText = ''
            } else {
                throw new Error('unsupported BodyInit type')
            }
        }

        if (support.blob) {
            this.blob = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return Promise.resolve(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as blob')
                } else {
                    return Promise.resolve(new Blob([this._bodyText]))
                }
            }

            this.arrayBuffer = function () {
                return this.blob().then(readBlobAsArrayBuffer)
            }

            this.text = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return readBlobAsText(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as text')
                } else {
                    return Promise.resolve(this._bodyText)
                }
            }
        } else {
            this.text = function () {
                var rejected = consumed(this)
                return rejected ? rejected : Promise.resolve(this._bodyText)
            }
        }

        if (support.formData) {
            this.formData = function () {
                return this.text().then(decode)
            }
        }

        this.json = function () {
            return this.text().then(JSON.parse)
        }

        return this
    }

    // HTTP methods whose capitalization should be normalized
    var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']

    function normalizeMethod(method) {
        var upcased = method.toUpperCase()
        return (methods.indexOf(upcased) > -1) ? upcased : method
    }

    function Request(url, options) {
        options = options || {}
        this.url = url

        this.credentials = options.credentials || 'omit'
        this.headers = new Headers(options.headers)
        this.method = normalizeMethod(options.method || 'GET')
        this.mode = options.mode || null
        this.referrer = null

        if ((this.method === 'GET' || this.method === 'HEAD') && options.body) {
            throw new TypeError('Body not allowed for GET or HEAD requests')
        }
        this._initBody(options.body)
    }

    function decode(body) {
        var form = new exports.FormData()
        body.trim().split('&').forEach(function (bytes) {
            if (bytes) {
                var split = bytes.split('=')
                var name = split.shift().replace(/\+/g, ' ')
                var value = split.join('=').replace(/\+/g, ' ')
                form.append(decodeURIComponent(name), decodeURIComponent(value))
            }
        })
        return form
    }

    function headers(xhr) {
        var head = new Headers()
        var pairs = xhr.getAllResponseHeaders().trim().split('\n')
        pairs.forEach(function (header) {
            var split = header.trim().split(':')
            var key = split.shift().trim()
            var value = split.join(':').trim()
            head.append(key, value)
        })
        return head
    }

    Body.call(Request.prototype)

    function Response(bodyInit, options) {
        if (!options) {
            options = {}
        }

        this._initBody(bodyInit)
        this.type = 'default'
        this.url = null
        this.status = options.status
        this.ok = this.status >= 200 && this.status < 300
        this.statusText = options.statusText
        this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)
        this.url = options.url || ''
    }

    Body.call(Response.prototype)

    exports.Headers = Headers;
    exports.Request = Request;
    exports.Response = Response;

    exports.fetch = function (input, init) {
        // TODO: Request constructor should accept input, init
        var request
        if (Request.prototype.isPrototypeOf(input) && !init) {
            request = input
        } else {
            request = new Request(input, init)
        }

        return new Promise(function (resolve, reject) {
            var xhr = new exports.XMLHttpRequest()

            function responseURL() {
                if ('responseURL' in xhr) {
                    return xhr.responseURL
                }

                // Avoid security warnings on getResponseHeader when not allowed by CORS
                if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {
                    return xhr.getResponseHeader('X-Request-URL')
                }

                return;
            }

            xhr.onload = function () {
                var status = (xhr.status === 1223) ? 204 : xhr.status
                if (status < 100 || status > 599) {
                    reject(new TypeError('Network request failed'))
                    return
                }
                var options = {
                    status: status,
                    statusText: xhr.statusText,
                    headers: headers(xhr),
                    url: responseURL()
                }
                //var body = 'response' in xhr ? xhr.response : xhr.responseText;
                resolve(new Response(xhr.responseText, options))
            }

            xhr.onerror = function (error) {
                reject(new TypeError(['Network request failed:', error.message].join(' ')))
            }

            xhr.open(request.method, request.url, true)

            if (request.credentials === 'include') {
                xhr.withCredentials = true
            }

            if ('responseType' in xhr && support.blob) {
                xhr.responseType = 'blob'
            }

            request.headers.forEach(function (value, name) {
                xhr.setRequestHeader(name, value)
            })

            xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)
        })
    }
    exports.fetch.polyfill = true

})();
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system-access.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var textModule = __webpack_require__("../node_modules/tns-core-modules/text/text.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var applicationContext;
function getApplicationContext() {
    if (!applicationContext) {
        applicationContext = application_1.getNativeApplication().getApplicationContext();
    }
    return applicationContext;
}
var FileSystemAccess = (function () {
    function FileSystemAccess() {
        this._pathSeparator = "/";
    }
    FileSystemAccess.prototype.getLastModified = function (path) {
        var javaFile = new java.io.File(path);
        return new Date(javaFile.lastModified());
    };
    FileSystemAccess.prototype.getFileSize = function (path) {
        var javaFile = new java.io.File(path);
        return javaFile.length();
    };
    FileSystemAccess.prototype.getParent = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            var parent_1 = javaFile.getParentFile();
            return { path: parent_1.getAbsolutePath(), name: parent_1.getName() };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFile = function (path, onError) {
        return this.ensureFile(new java.io.File(path), false, onError);
    };
    FileSystemAccess.prototype.getFolder = function (path, onError) {
        var javaFile = new java.io.File(path);
        var dirInfo = this.ensureFile(javaFile, true, onError);
        if (!dirInfo) {
            return undefined;
        }
        return { path: dirInfo.path, name: dirInfo.name };
    };
    FileSystemAccess.prototype.eachEntity = function (path, onEntity, onError) {
        if (!onEntity) {
            return;
        }
        this.enumEntities(path, onEntity, onError);
    };
    FileSystemAccess.prototype.getEntities = function (path, onError) {
        var fileInfos = new Array();
        var onEntity = function (entity) {
            fileInfos.push(entity);
            return true;
        };
        var errorOccurred;
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            errorOccurred = true;
        };
        this.enumEntities(path, onEntity, localError);
        if (!errorOccurred) {
            return fileInfos;
        }
        return null;
    };
    FileSystemAccess.prototype.fileExists = function (path) {
        var file = new java.io.File(path);
        return file.exists();
    };
    FileSystemAccess.prototype.folderExists = function (path) {
        var file = new java.io.File(path);
        return file.exists() && file.isDirectory();
    };
    FileSystemAccess.prototype.deleteFile = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.isFile()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a File entity." });
                }
                return;
            }
            if (!javaFile.delete()) {
                if (onError) {
                    onError({ message: "File deletion failed" });
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.deleteFolder = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a Folder entity." });
                }
                return;
            }
            this.deleteFolderContent(javaFile);
            if (!javaFile.delete()) {
                if (onError) {
                    onError({ message: "Folder deletion failed." });
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.emptyFolder = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError({ message: "The specified parameter is not a Folder entity." });
                }
                return;
            }
            this.deleteFolderContent(javaFile);
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.rename = function (path, newPath, onError) {
        var javaFile = new java.io.File(path);
        if (!javaFile.exists()) {
            if (onError) {
                onError(new Error("The file to rename does not exist"));
            }
            return;
        }
        var newFile = new java.io.File(newPath);
        if (newFile.exists()) {
            if (onError) {
                onError(new Error("A file with the same name already exists."));
            }
            return;
        }
        if (!javaFile.renameTo(newFile)) {
            if (onError) {
                onError(new Error("Failed to rename file '" + path + "' to '" + newPath + "'"));
            }
        }
    };
    FileSystemAccess.prototype.getDocumentsFolderPath = function () {
        var dir = getApplicationContext().getFilesDir();
        return dir.getAbsolutePath();
    };
    FileSystemAccess.prototype.getLogicalRootPath = function () {
        var dir = getApplicationContext().getFilesDir();
        return dir.getCanonicalPath();
    };
    FileSystemAccess.prototype.getTempFolderPath = function () {
        var dir = getApplicationContext().getCacheDir();
        return dir.getAbsolutePath();
    };
    FileSystemAccess.prototype.getCurrentAppPath = function () {
        return this.getLogicalRootPath() + "/app";
    };
    FileSystemAccess.prototype.read = function (path, onError) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileInputStream(javaFile);
            var bytes = Array.create("byte", javaFile.length());
            var dataInputStream = new java.io.DataInputStream(stream);
            dataInputStream.readFully(bytes);
            return bytes;
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.write = function (path, bytes, onError) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileOutputStream(javaFile);
            stream.write(bytes, 0, bytes.length);
            stream.close();
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.readText = function (path, onError, encoding) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileInputStream(javaFile);
            var actualEncoding = encoding;
            if (!actualEncoding) {
                actualEncoding = textModule.encoding.UTF_8;
            }
            var reader = new java.io.InputStreamReader(stream, actualEncoding);
            var bufferedReader = new java.io.BufferedReader(reader);
            var line = undefined;
            var result = "";
            while (true) {
                line = bufferedReader.readLine();
                if (line === null) {
                    break;
                }
                if (result.length > 0) {
                    result += "\n";
                }
                result += line;
            }
            if (actualEncoding === textModule.encoding.UTF_8) {
                result = FileSystemAccess._removeUtf8Bom(result);
            }
            bufferedReader.close();
            return result;
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess._removeUtf8Bom = function (s) {
        if (s.charCodeAt(0) === 0xFEFF) {
            s = s.slice(1);
        }
        return s;
    };
    FileSystemAccess.prototype.writeText = function (path, content, onError, encoding) {
        try {
            var javaFile = new java.io.File(path);
            var stream = new java.io.FileOutputStream(javaFile);
            var actualEncoding = encoding;
            if (!actualEncoding) {
                actualEncoding = textModule.encoding.UTF_8;
            }
            var writer = new java.io.OutputStreamWriter(stream, actualEncoding);
            writer.write(content);
            writer.close();
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.deleteFolderContent = function (file) {
        var filesList = file.listFiles();
        if (filesList.length === 0) {
            return true;
        }
        var childFile;
        var success = false;
        for (var i = 0; i < filesList.length; i++) {
            childFile = filesList[i];
            if (childFile.getCanonicalFile().isDirectory()) {
                success = this.deleteFolderContent(childFile);
                if (!success) {
                    break;
                }
            }
            success = childFile.delete();
        }
        return success;
    };
    FileSystemAccess.prototype.ensureFile = function (javaFile, isFolder, onError) {
        try {
            if (!javaFile.exists()) {
                var created = void 0;
                if (isFolder) {
                    created = javaFile.mkdirs();
                }
                else {
                    javaFile.getParentFile().mkdirs();
                    created = javaFile.createNewFile();
                }
                if (!created) {
                    if (onError) {
                        onError("Failed to create new java File for path " + javaFile.getAbsolutePath());
                    }
                    return undefined;
                }
                else {
                    javaFile.setReadable(true);
                    javaFile.setWritable(true);
                }
            }
            var path = javaFile.getAbsolutePath();
            return { path: path, name: javaFile.getName(), extension: this.getFileExtension(path) };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFileExtension = function (path) {
        var dotIndex = path.lastIndexOf(".");
        if (dotIndex && dotIndex >= 0 && dotIndex < path.length) {
            return path.substring(dotIndex);
        }
        return "";
    };
    FileSystemAccess.prototype.enumEntities = function (path, callback, onError) {
        try {
            var javaFile = new java.io.File(path);
            if (!javaFile.getCanonicalFile().isDirectory()) {
                if (onError) {
                    onError("There is no folder existing at path " + path);
                }
                return;
            }
            var filesList = javaFile.listFiles();
            var length_1 = filesList.length;
            var info = void 0;
            var retVal = void 0;
            for (var i = 0; i < length_1; i++) {
                javaFile = filesList[i];
                info = {
                    path: javaFile.getAbsolutePath(),
                    name: javaFile.getName()
                };
                if (javaFile.isFile()) {
                    info.extension = this.getFileExtension(info.path);
                }
                retVal = callback(info);
                if (retVal === false) {
                    break;
                }
            }
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
        }
    };
    FileSystemAccess.prototype.getPathSeparator = function () {
        return this._pathSeparator;
    };
    FileSystemAccess.prototype.normalizePath = function (path) {
        var file = new java.io.File(path);
        return file.getAbsolutePath();
    };
    FileSystemAccess.prototype.joinPath = function (left, right) {
        var file1 = new java.io.File(left);
        var file2 = new java.io.File(file1, right);
        return file2.getPath();
    };
    FileSystemAccess.prototype.joinPaths = function (paths) {
        if (!paths || paths.length === 0) {
            return "";
        }
        if (paths.length === 1) {
            return paths[0];
        }
        var result = paths[0];
        for (var i = 1; i < paths.length; i++) {
            result = this.joinPath(result, paths[i]);
        }
        return result;
    };
    return FileSystemAccess;
}());
exports.FileSystemAccess = FileSystemAccess;
//# sourceMappingURL=file-system-access.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var fileAccess;
function getFileAccess() {
    if (!fileAccess) {
        fileAccess = new file_system_access_1.FileSystemAccess();
    }
    return fileAccess;
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
function createFile(info) {
    var file = new File();
    file._path = info.path;
    file._name = info.name;
    file._extension = info.extension;
    return file;
}
function createFolder(info) {
    var documents = knownFolders.documents();
    if (info.path === documents.path) {
        return documents;
    }
    var temp = knownFolders.temp();
    if (info.path === temp.path) {
        return temp;
    }
    var folder = new Folder();
    folder._path = info.path;
    folder._name = info.name;
    return folder;
}
var FileSystemEntity = (function () {
    function FileSystemEntity() {
    }
    Object.defineProperty(FileSystemEntity.prototype, "parent", {
        get: function () {
            var onError = function (error) {
                throw error;
            };
            var folderInfo = getFileAccess().getParent(this.path, onError);
            if (!folderInfo) {
                return undefined;
            }
            return createFolder(folderInfo);
        },
        enumerable: true,
        configurable: true
    });
    FileSystemEntity.prototype.remove = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.removeSync(localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.removeSync = function (onError) {
        if (this._isKnown) {
            if (onError) {
                onError({ message: "Cannot delete known folder." });
            }
            return;
        }
        var fileAccess = getFileAccess();
        if (this instanceof File) {
            fileAccess.deleteFile(this.path, onError);
        }
        else if (this instanceof Folder) {
            fileAccess.deleteFolder(this.path, onError);
        }
    };
    FileSystemEntity.prototype.rename = function (newName) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.renameSync(newName, localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.renameSync = function (newName, onError) {
        if (this._isKnown) {
            if (onError) {
                onError(new Error("Cannot rename known folder."));
            }
            return;
        }
        var parentFolder = this.parent;
        if (!parentFolder) {
            if (onError) {
                onError(new Error("No parent folder."));
            }
            return;
        }
        var fileAccess = getFileAccess();
        var path = parentFolder.path;
        var newPath = fileAccess.joinPath(path, newName);
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            return null;
        };
        fileAccess.rename(this.path, newPath, localError);
        this._path = newPath;
        this._name = newName;
        if (this instanceof File) {
            this._extension = fileAccess.getFileExtension(newPath);
        }
    };
    Object.defineProperty(FileSystemEntity.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "path", {
        get: function () {
            return this._path;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "lastModified", {
        get: function () {
            var value = this._lastModified;
            if (!this._lastModified) {
                value = this._lastModified = getFileAccess().getLastModified(this.path);
            }
            return value;
        },
        enumerable: true,
        configurable: true
    });
    return FileSystemEntity;
}());
exports.FileSystemEntity = FileSystemEntity;
var File = (function (_super) {
    __extends(File, _super);
    function File() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    File.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var fileInfo = getFileAccess().getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    File.exists = function (path) {
        return getFileAccess().fileExists(path);
    };
    Object.defineProperty(File.prototype, "extension", {
        get: function () {
            return this._extension;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "isLocked", {
        get: function () {
            return !!this._locked;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "size", {
        get: function () {
            return getFileAccess().getFileSize(this.path);
        },
        enumerable: true,
        configurable: true
    });
    File.prototype.readSync = function (onError) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().read(this.path, localError);
        this._locked = false;
        return content;
    };
    File.prototype.writeSync = function (content, onError) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_1 = this;
            var localError = function (error) {
                that_1._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().write(this.path, content, localError);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.readText = function (encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var content = _this.readTextSync(localError, encoding);
            if (!hasError) {
                resolve(content);
            }
        });
    };
    File.prototype.readTextSync = function (onError, encoding) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().readText(this.path, localError, encoding);
        this._locked = false;
        return content;
    };
    File.prototype.writeText = function (content, encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.writeTextSync(content, localError, encoding);
            if (!hasError) {
                resolve();
            }
        });
    };
    File.prototype.writeTextSync = function (content, onError, encoding) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_2 = this;
            var localError = function (error) {
                that_2._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().writeText(this.path, content, localError, encoding);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.checkAccess = function () {
        if (this.isLocked) {
            throw new Error("Cannot access a locked file.");
        }
    };
    __decorate([
        profiling_1.profile
    ], File.prototype, "readTextSync", null);
    return File;
}(FileSystemEntity));
exports.File = File;
var Folder = (function (_super) {
    __extends(Folder, _super);
    function Folder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Folder.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var folderInfo = getFileAccess().getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.exists = function (path) {
        return getFileAccess().folderExists(path);
    };
    Folder.prototype.contains = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        if (fileAccess.fileExists(path)) {
            return true;
        }
        return fileAccess.folderExists(path);
    };
    Folder.prototype.clear = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var onError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.clearSync(onError);
            if (!hasError) {
                resolve();
            }
        });
    };
    Folder.prototype.clearSync = function (onError) {
        getFileAccess().emptyFolder(this.path, onError);
    };
    Object.defineProperty(Folder.prototype, "isKnown", {
        get: function () {
            return this._isKnown;
        },
        enumerable: true,
        configurable: true
    });
    Folder.prototype.getFile = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var fileInfo = fileAccess.getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    Folder.prototype.getFolder = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var folderInfo = fileAccess.getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.prototype.getEntities = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var entities = _this.getEntitiesSync(localError);
            if (!hasError) {
                resolve(entities);
            }
        });
    };
    Folder.prototype.getEntitiesSync = function (onError) {
        var fileInfos = getFileAccess().getEntities(this.path, onError);
        if (!fileInfos) {
            return null;
        }
        var entities = new Array();
        for (var i = 0; i < fileInfos.length; i++) {
            if (fileInfos[i].extension) {
                entities.push(createFile(fileInfos[i]));
            }
            else {
                entities.push(createFolder(fileInfos[i]));
            }
        }
        return entities;
    };
    Folder.prototype.eachEntity = function (onEntity) {
        if (!onEntity) {
            return;
        }
        var onSuccess = function (fileInfo) {
            var entity;
            if (fileInfo.extension) {
                entity = createFile(fileInfo);
            }
            else {
                entity = createFolder(fileInfo);
            }
            return onEntity(entity);
        };
        var onError = function (error) {
            throw error;
        };
        getFileAccess().eachEntity(this.path, onSuccess, onError);
    };
    return Folder;
}(FileSystemEntity));
exports.Folder = Folder;
var knownFolders;
(function (knownFolders) {
    var _documents;
    var _temp;
    var _app;
    function documents() {
        if (!_documents) {
            var path_1 = getFileAccess().getDocumentsFolderPath();
            _documents = new Folder();
            _documents._path = path_1;
            _documents._isKnown = true;
        }
        return _documents;
    }
    knownFolders.documents = documents;
    function temp() {
        if (!_temp) {
            var path_2 = getFileAccess().getTempFolderPath();
            _temp = new Folder();
            _temp._path = path_2;
            _temp._isKnown = true;
        }
        return _temp;
    }
    knownFolders.temp = temp;
    function currentApp() {
        if (!_app) {
            var path_3 = getFileAccess().getCurrentAppPath();
            _app = new Folder();
            _app._path = path_3;
            _app._isKnown = true;
        }
        return _app;
    }
    knownFolders.currentApp = currentApp;
    var ios;
    (function (ios) {
        function _checkPlatform(knownFolderName) {
            ensurePlatform();
            if (!platform.isIOS) {
                throw new Error("The \"" + knownFolderName + "\" known folder is available on iOS only!");
            }
        }
        var _library;
        function library() {
            _checkPlatform("library");
            if (!_library) {
                var existingFolderInfo = getExistingFolderInfo(5);
                if (existingFolderInfo) {
                    _library = existingFolderInfo.folder;
                    _library._path = existingFolderInfo.path;
                    _library._isKnown = true;
                }
            }
            return _library;
        }
        ios.library = library;
        var _developer;
        function developer() {
            _checkPlatform("developer");
            if (!_developer) {
                var existingFolderInfo = getExistingFolderInfo(6);
                if (existingFolderInfo) {
                    _developer = existingFolderInfo.folder;
                    _developer._path = existingFolderInfo.path;
                    _developer._isKnown = true;
                }
            }
            return _developer;
        }
        ios.developer = developer;
        var _desktop;
        function desktop() {
            _checkPlatform("desktop");
            if (!_desktop) {
                var existingFolderInfo = getExistingFolderInfo(12);
                if (existingFolderInfo) {
                    _desktop = existingFolderInfo.folder;
                    _desktop._path = existingFolderInfo.path;
                    _desktop._isKnown = true;
                }
            }
            return _desktop;
        }
        ios.desktop = desktop;
        var _downloads;
        function downloads() {
            _checkPlatform("downloads");
            if (!_downloads) {
                var existingFolderInfo = getExistingFolderInfo(15);
                if (existingFolderInfo) {
                    _downloads = existingFolderInfo.folder;
                    _downloads._path = existingFolderInfo.path;
                    _downloads._isKnown = true;
                }
            }
            return _downloads;
        }
        ios.downloads = downloads;
        var _movies;
        function movies() {
            _checkPlatform("movies");
            if (!_movies) {
                var existingFolderInfo = getExistingFolderInfo(17);
                if (existingFolderInfo) {
                    _movies = existingFolderInfo.folder;
                    _movies._path = existingFolderInfo.path;
                    _movies._isKnown = true;
                }
            }
            return _movies;
        }
        ios.movies = movies;
        var _music;
        function music() {
            _checkPlatform("music");
            if (!_music) {
                var existingFolderInfo = getExistingFolderInfo(18);
                if (existingFolderInfo) {
                    _music = existingFolderInfo.folder;
                    _music._path = existingFolderInfo.path;
                    _music._isKnown = true;
                }
            }
            return _music;
        }
        ios.music = music;
        var _pictures;
        function pictures() {
            _checkPlatform("pictures");
            if (!_pictures) {
                var existingFolderInfo = getExistingFolderInfo(19);
                if (existingFolderInfo) {
                    _pictures = existingFolderInfo.folder;
                    _pictures._path = existingFolderInfo.path;
                    _pictures._isKnown = true;
                }
            }
            return _pictures;
        }
        ios.pictures = pictures;
        var _sharedPublic;
        function sharedPublic() {
            _checkPlatform("sharedPublic");
            if (!_sharedPublic) {
                var existingFolderInfo = getExistingFolderInfo(21);
                if (existingFolderInfo) {
                    _sharedPublic = existingFolderInfo.folder;
                    _sharedPublic._path = existingFolderInfo.path;
                    _sharedPublic._isKnown = true;
                }
            }
            return _sharedPublic;
        }
        ios.sharedPublic = sharedPublic;
        function getExistingFolderInfo(pathDirectory) {
            var fileAccess = getFileAccess();
            var folderPath = fileAccess.getKnownPath(pathDirectory);
            var folderInfo = fileAccess.getExistingFolder(folderPath);
            if (folderInfo) {
                return {
                    folder: createFolder(folderInfo),
                    path: folderPath
                };
            }
            return undefined;
        }
    })(ios = knownFolders.ios || (knownFolders.ios = {}));
})(knownFolders = exports.knownFolders || (exports.knownFolders = {}));
var path;
(function (path_4) {
    function normalize(path) {
        return getFileAccess().normalizePath(path);
    }
    path_4.normalize = normalize;
    function join() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        var fileAccess = getFileAccess();
        return fileAccess.joinPaths(paths);
    }
    path_4.join = join;
    path_4.separator = getFileAccess().getPathSeparator();
})(path = exports.path || (exports.path = {}));
//# sourceMappingURL=file-system.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/core/globals-core.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/ts-helpers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/register-module-helpers.js");
global.moduleMerge = function (sourceExports, destExports) {
    for (var key in sourceExports) {
        destExports[key] = sourceExports[key];
    }
};
global.zonedCallback = function (callback) {
    if (global.zone) {
        return global.zone.bind(callback);
    }
    if (global.Zone) {
        return global.Zone.current.wrap(callback);
    }
    else {
        return callback;
    }
};
global.System = {
    import: function (path) {
        return new Promise(function (resolve, reject) {
            try {
                resolve(global.require(path));
            }
            catch (e) {
                reject(e);
            }
        });
    }
};
//# sourceMappingURL=globals-core.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/decorators.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function Deprecated(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_1 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is deprecated");
            return originalMethod_1.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is deprecated");
        return target;
    }
}
exports.Deprecated = Deprecated;
global.Deprecated = Deprecated;
function Experimental(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_2 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is experimental");
            return originalMethod_2.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is experimental");
        return target;
    }
}
exports.Experimental = Experimental;
global.Experimental = Experimental;
//# sourceMappingURL=decorators.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/globals.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/timers/timers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/dialogs/dialogs.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/fetch/fetch.js");
__webpack_require__("../node_modules/tns-core-modules/globals/decorators.js");
//# sourceMappingURL=globals.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("tns-core-modules/ui/dialogs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js"); });
polyfill_helpers_1.installPolyfills("tns-core-modules/ui/dialogs", ["alert", "confirm", "prompt", "login", "action"]);
//# sourceMappingURL=dialogs.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
__webpack_require__("../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("fetch", function () { return __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js"); });
polyfill_helpers_1.installPolyfills("fetch", ["fetch", "Headers", "Request", "Response"]);
//# sourceMappingURL=fetch.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
function registerOnGlobalContext(moduleName, exportName) {
    Object.defineProperty(global, exportName, {
        get: function () {
            var m = global.loadModule(moduleName);
            var resolvedValue = m[exportName];
            Object.defineProperty(global, exportName, { value: resolvedValue, configurable: true, writable: true });
            return resolvedValue;
        },
        configurable: true
    });
}
function installPolyfills(moduleName, exportNames) {
    if (global.__snapshot) {
        var loadedModule_1 = global.loadModule(moduleName);
        exportNames.forEach(function (exportName) { return global[exportName] = loadedModule_1[exportName]; });
    }
    else {
        exportNames.forEach(function (exportName) { return registerOnGlobalContext(moduleName, exportName); });
    }
}
exports.installPolyfills = installPolyfills;
//# sourceMappingURL=polyfill-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/timers/timers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("timer", function () { return __webpack_require__("../node_modules/tns-core-modules/timer/timer.js"); });
polyfill_helpers_1.installPolyfills("timer", ["setTimeout", "clearTimeout", "setInterval", "clearInterval"]);
//# sourceMappingURL=timers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/polyfills/xhr/xhr.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/core/globals-core.js");
var polyfill_helpers_1 = __webpack_require__("../node_modules/tns-core-modules/globals/polyfills/polyfill-helpers/polyfill-helpers.js");
global.registerModule("xhr", function () { return __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js"); });
polyfill_helpers_1.installPolyfills("xhr", ["XMLHttpRequest", "FormData"]);
//# sourceMappingURL=xhr.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/register-module-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var modules = new Map();
var modulesLoadedForUI = new Set();
var defaultExtensionMap = {
    ".js": ".js",
    ".ts": ".js",
    ".css": ".css",
    ".scss": ".css",
    ".less": ".css",
    ".sass": ".css",
    ".xml": ".xml"
};
global.moduleResolvers = [global.require];
global.registerModule = function (name, loader) {
    modules.set(name, { loader: loader, moduleId: name });
};
global._unregisterModule = function _unregisterModule(name) {
    modules.delete(name);
};
global._isModuleLoadedForUI = function _isModuleLoadedForUI(moduleName) {
    return modulesLoadedForUI.has(moduleName);
};
global.registerWebpackModules = function registerWebpackModules(context, extensionMap) {
    if (extensionMap === void 0) { extensionMap = {}; }
    context.keys().forEach(function (moduleId) {
        var extDotIndex = moduleId.lastIndexOf(".");
        var base = moduleId.substr(0, extDotIndex);
        var originalExt = moduleId.substr(extDotIndex);
        var registerExt = extensionMap[originalExt] || defaultExtensionMap[originalExt] || originalExt;
        var isSourceFile = originalExt !== registerExt;
        var registerName = base + registerExt;
        var registerWithName = function (nickName) {
            modules.set(nickName, {
                moduleId: moduleId,
                loader: function () {
                    return context(moduleId);
                }
            });
        };
        if (registerName.startsWith("./") && registerName.endsWith(".js")) {
            var jsNickNames = [
                registerName.substr(2, registerName.length - 5),
                registerName.substr(0, registerName.length - 3),
                registerName.substr(2),
            ];
            jsNickNames.forEach(function (jsNickName) {
                if (isSourceFile || !global.moduleExists(jsNickName)) {
                    registerWithName(jsNickName);
                }
            });
        }
        else if (registerName.startsWith("./")) {
            var moduleNickNames = [
                registerName.substr(2),
            ];
            moduleNickNames.forEach(function (moduleNickName) {
                if (!global.moduleExists(moduleNickName)) {
                    registerWithName(moduleNickName);
                }
            });
        }
        if (isSourceFile || !global.moduleExists(registerName)) {
            registerWithName(registerName);
        }
    });
};
global.moduleExists = function moduleExists(name) {
    return modules.has(name);
};
global.loadModule = function loadModule(name, isUIModule) {
    if (isUIModule === void 0) { isUIModule = false; }
    var moduleInfo = modules.get(name);
    if (moduleInfo) {
        if (isUIModule) {
            modulesLoadedForUI.add(moduleInfo.moduleId);
        }
        var result = moduleInfo.loader(name);
        if (result.enableAutoAccept) {
            result.enableAutoAccept();
        }
        return result;
    }
    var _loop_1 = function (resolver) {
        var result = resolver(name);
        if (result) {
            modules.set(name, { moduleId: name, loader: function () { return result; } });
            return { value: result };
        }
    };
    for (var _i = 0, _a = global.moduleResolvers; _i < _a.length; _i++) {
        var resolver = _a[_i];
        var state_1 = _loop_1(resolver);
        if (typeof state_1 === "object")
            return state_1.value;
    }
};
global.getRegisteredModules = function getRegisteredModules() {
    return Array.from(modules.keys());
};
//# sourceMappingURL=register-module-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/ts-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
if (!global.__extends) {
    global.__extends = function (d, b) {
        for (var p in b) {
            if (b.hasOwnProperty(p)) {
                d[p] = b[p];
            }
        }
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
}
var tslib = __webpack_require__("../node_modules/tslib/tslib.es6.js");
for (var _i = 0, _a = Object.keys(tslib); _i < _a.length; _i++) {
    var fnName = _a[_i];
    if (typeof tslib[fnName] !== "function") {
        continue;
    }
    if (fnName in global) {
        continue;
    }
    global[fnName] = tslib[fnName];
}
//# sourceMappingURL=ts-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
function getFilenameFromUrl(url) {
    var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    var slashPos = url.lastIndexOf("/") + 1;
    var questionMarkPos = url.lastIndexOf("?");
    var actualFileName;
    if (questionMarkPos !== -1) {
        actualFileName = url.substring(slashPos, questionMarkPos);
    }
    else {
        actualFileName = url.substring(slashPos);
    }
    var result = fs.path.join(fs.knownFolders.documents().path, actualFileName);
    return result;
}
exports.getFilenameFromUrl = getFilenameFromUrl;
//# sourceMappingURL=http-request-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var http_request_common_1 = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request-common.js");
var debugger_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var HttpResponseEncoding;
(function (HttpResponseEncoding) {
    HttpResponseEncoding[HttpResponseEncoding["UTF8"] = 0] = "UTF8";
    HttpResponseEncoding[HttpResponseEncoding["GBK"] = 1] = "GBK";
})(HttpResponseEncoding = exports.HttpResponseEncoding || (exports.HttpResponseEncoding = {}));
function parseJSON(source) {
    var src = source.trim();
    if (src.lastIndexOf(")") === src.length - 1) {
        return JSON.parse(src.substring(src.indexOf("(") + 1, src.lastIndexOf(")")));
    }
    return JSON.parse(src);
}
var requestIdCounter = 0;
var pendingRequests = {};
var imageSource;
function ensureImageSource() {
    if (!imageSource) {
        imageSource = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
    }
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
var fs;
function ensureFileSystem() {
    if (!fs) {
        fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    }
}
var completeCallback;
function ensureCompleteCallback() {
    if (completeCallback) {
        return;
    }
    completeCallback = new org.nativescript.widgets.Async.CompleteCallback({
        onComplete: function (result, context) {
            onRequestComplete(context, result);
        },
        onError: function (error, context) {
            onRequestError(error, context);
        },
    });
}
function onRequestComplete(requestId, result) {
    var callbacks = pendingRequests[requestId];
    delete pendingRequests[requestId];
    if (result.error) {
        callbacks.rejectCallback(new Error(result.error.toString()));
        return;
    }
    var headers = {};
    if (result.headers) {
        var jHeaders = result.headers;
        var length_1 = jHeaders.size();
        var pair = void 0;
        for (var i = 0; i < length_1; i++) {
            pair = jHeaders.get(i);
            addHeader(headers, pair.key, pair.value);
        }
    }
    if (global.__inspector && global.__inspector.isConnected) {
        debugger_1.NetworkAgent.responseReceived(requestId, result, headers);
    }
    callbacks.resolveCallback({
        content: {
            raw: result.raw,
            toString: function (encoding) {
                var str;
                if (encoding) {
                    str = decodeResponse(result.raw, encoding);
                }
                else {
                    str = result.responseAsString;
                }
                if (typeof str === "string") {
                    return str;
                }
                else {
                    throw new Error("Response content may not be converted to string");
                }
            },
            toJSON: function (encoding) {
                var str;
                if (encoding) {
                    str = decodeResponse(result.raw, encoding);
                }
                else {
                    str = result.responseAsString;
                }
                return parseJSON(str);
            },
            toImage: function () {
                ensureImageSource();
                return new Promise(function (resolveImage, rejectImage) {
                    if (result.responseAsImage != null) {
                        resolveImage(imageSource.fromNativeSource(result.responseAsImage));
                    }
                    else {
                        rejectImage(new Error("Response content may not be converted to an Image"));
                    }
                });
            },
            toFile: function (destinationFilePath) {
                ensureFileSystem();
                if (!destinationFilePath) {
                    destinationFilePath = http_request_common_1.getFilenameFromUrl(callbacks.url);
                }
                var stream;
                try {
                    var file = fs.File.fromPath(destinationFilePath);
                    var javaFile = new java.io.File(destinationFilePath);
                    stream = new java.io.FileOutputStream(javaFile);
                    stream.write(result.raw.toByteArray());
                    return file;
                }
                catch (exception) {
                    throw new Error("Cannot save file with path: " + destinationFilePath + ".");
                }
                finally {
                    if (stream) {
                        stream.close();
                    }
                }
            }
        },
        statusCode: result.statusCode,
        headers: headers
    });
}
function onRequestError(error, requestId) {
    var callbacks = pendingRequests[requestId];
    delete pendingRequests[requestId];
    if (callbacks) {
        callbacks.rejectCallback(new Error(error));
    }
}
function buildJavaOptions(options) {
    if (typeof options.url !== "string") {
        throw new Error("Http request must provide a valid url.");
    }
    var javaOptions = new org.nativescript.widgets.Async.Http.RequestOptions();
    javaOptions.url = options.url;
    if (typeof options.method === "string") {
        javaOptions.method = options.method;
    }
    if (typeof options.content === "string" || options.content instanceof FormData) {
        javaOptions.content = options.content.toString();
    }
    if (typeof options.timeout === "number") {
        javaOptions.timeout = options.timeout;
    }
    if (typeof options.dontFollowRedirects === "boolean") {
        javaOptions.dontFollowRedirects = options.dontFollowRedirects;
    }
    if (options.headers) {
        var arrayList = new java.util.ArrayList();
        var pair = org.nativescript.widgets.Async.Http.KeyValuePair;
        for (var key in options.headers) {
            arrayList.add(new pair(key, options.headers[key] + ""));
        }
        javaOptions.headers = arrayList;
    }
    ensurePlatform();
    var screen = platform.screen.mainScreen;
    javaOptions.screenWidth = screen.widthPixels;
    javaOptions.screenHeight = screen.heightPixels;
    return javaOptions;
}
function request(options) {
    if (options === undefined || options === null) {
        return;
    }
    return new Promise(function (resolve, reject) {
        try {
            var javaOptions = buildJavaOptions(options);
            if (global.__inspector && global.__inspector.isConnected) {
                debugger_1.NetworkAgent.requestWillBeSent(requestIdCounter, options);
            }
            var callbacks = {
                url: options.url,
                resolveCallback: resolve,
                rejectCallback: reject
            };
            pendingRequests[requestIdCounter] = callbacks;
            ensureCompleteCallback();
            org.nativescript.widgets.Async.Http.MakeRequest(javaOptions, completeCallback, new java.lang.Integer(requestIdCounter));
            requestIdCounter++;
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.request = request;
function decodeResponse(raw, encoding) {
    var charsetName = "UTF-8";
    if (encoding === HttpResponseEncoding.GBK) {
        charsetName = "GBK";
    }
    return raw.toString(charsetName);
}
function addHeader(headers, key, value) {
    if (!headers[key]) {
        headers[key] = value;
    }
    else if (Array.isArray(headers[key])) {
        headers[key].push(value);
    }
    else {
        var values = [headers[key]];
        values.push(value);
        headers[key] = values;
    }
}
exports.addHeader = addHeader;
//# sourceMappingURL=http-request.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var httpRequest = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js");
__export(__webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js"));
function getString(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var str = r.content.toString();
                resolve(str);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getString = getString;
function getJSON(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var json = r.content.toJSON();
                resolve(json);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getJSON = getJSON;
function getImage(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                resolve(r.content.toImage());
            }
            catch (err) {
                reject(err);
            }
        }, function (err) {
            reject(err);
        });
    });
}
exports.getImage = getImage;
function getFile(arg, destinationFilePath) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var file = r.content.toFile(destinationFilePath);
                resolve(file);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getFile = getFile;
//# sourceMappingURL=http.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var ImageAssetBase = (function (_super) {
    __extends(ImageAssetBase, _super);
    function ImageAssetBase() {
        var _this = _super.call(this) || this;
        _this._options = { keepAspectRatio: true, autoScaleFactor: true };
        return _this;
    }
    Object.defineProperty(ImageAssetBase.prototype, "options", {
        get: function () {
            return this._options;
        },
        set: function (value) {
            this._options = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageAssetBase.prototype, "nativeImage", {
        get: function () {
            return this._nativeImage;
        },
        set: function (value) {
            this._nativeImage = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAssetBase.prototype.getImageAsync = function (callback) {
    };
    return ImageAssetBase;
}(observable_1.Observable));
exports.ImageAssetBase = ImageAssetBase;
function getAspectSafeDimensions(sourceWidth, sourceHeight, reqWidth, reqHeight) {
    var widthCoef = sourceWidth / reqWidth;
    var heightCoef = sourceHeight / reqHeight;
    var aspectCoef = Math.min(widthCoef, heightCoef);
    return {
        width: Math.floor(sourceWidth / aspectCoef),
        height: Math.floor(sourceHeight / aspectCoef)
    };
}
exports.getAspectSafeDimensions = getAspectSafeDimensions;
function getRequestedImageSize(src, options) {
    var screen = platform_1.screen.mainScreen;
    var reqWidth = options.width || Math.min(src.width, screen.widthPixels);
    var reqHeight = options.height || Math.min(src.height, screen.heightPixels);
    if (options && options.keepAspectRatio) {
        var safeAspectSize = getAspectSafeDimensions(src.width, src.height, reqWidth, reqHeight);
        reqWidth = safeAspectSize.width;
        reqHeight = safeAspectSize.height;
    }
    return {
        width: reqWidth,
        height: reqHeight
    };
}
exports.getRequestedImageSize = getRequestedImageSize;
//# sourceMappingURL=image-asset-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_asset_common_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js"));
var ImageAsset = (function (_super) {
    __extends(ImageAsset, _super);
    function ImageAsset(asset) {
        var _this = _super.call(this) || this;
        var fileName = typeof asset === "string" ? asset.trim() : "";
        if (fileName.indexOf("~/") === 0) {
            fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
        }
        _this.android = fileName;
        return _this;
    }
    Object.defineProperty(ImageAsset.prototype, "android", {
        get: function () {
            return this._android;
        },
        set: function (value) {
            this._android = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAsset.prototype.getImageAsync = function (callback) {
        var bitmapOptions = new android.graphics.BitmapFactory.Options();
        bitmapOptions.inJustDecodeBounds = true;
        var bitmap = android.graphics.BitmapFactory.decodeFile(this.android, bitmapOptions);
        var sourceSize = {
            width: bitmapOptions.outWidth,
            height: bitmapOptions.outHeight
        };
        var requestedSize = image_asset_common_1.getRequestedImageSize(sourceSize, this.options);
        var sampleSize = org.nativescript.widgets.image.Fetcher.calculateInSampleSize(bitmapOptions.outWidth, bitmapOptions.outHeight, requestedSize.width, requestedSize.height);
        var finalBitmapOptions = new android.graphics.BitmapFactory.Options();
        finalBitmapOptions.inSampleSize = sampleSize;
        try {
            var error = null;
            bitmap = android.graphics.BitmapFactory.decodeFile(this.android, finalBitmapOptions);
            if (bitmap) {
                if (requestedSize.width !== bitmap.getWidth() || requestedSize.height !== bitmap.getHeight()) {
                    bitmap = android.graphics.Bitmap.createScaledBitmap(bitmap, requestedSize.width, requestedSize.height, true);
                }
                var rotationAngle = calculateAngleFromFile(this.android);
                if (rotationAngle !== 0) {
                    var matrix = new android.graphics.Matrix();
                    matrix.postRotate(rotationAngle);
                    bitmap = android.graphics.Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);
                }
            }
            if (!bitmap) {
                error = "Asset '" + this.android + "' cannot be found.";
            }
            callback(bitmap, error);
        }
        catch (ex) {
            callback(null, ex);
        }
    };
    return ImageAsset;
}(image_asset_common_1.ImageAssetBase));
exports.ImageAsset = ImageAsset;
function calculateAngleFromFile(filename) {
    var rotationAngle = 0;
    var ei = new android.media.ExifInterface(filename);
    var orientation = ei.getAttributeInt(android.media.ExifInterface.TAG_ORIENTATION, android.media.ExifInterface.ORIENTATION_NORMAL);
    switch (orientation) {
        case android.media.ExifInterface.ORIENTATION_ROTATE_90:
            rotationAngle = 90;
            break;
        case android.media.ExifInterface.ORIENTATION_ROTATE_180:
            rotationAngle = 180;
            break;
        case android.media.ExifInterface.ORIENTATION_ROTATE_270:
            rotationAngle = 270;
            break;
    }
    return rotationAngle;
}
//# sourceMappingURL=image-asset.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-source/image-source.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var http;
function ensureHttp() {
    if (!http) {
        http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
    }
}
var application;
var resources;
function getApplication() {
    if (!application) {
        application = application_1.getNativeApplication();
    }
    return application;
}
function getResources() {
    if (!resources) {
        resources = getApplication().getResources();
    }
    return resources;
}
var ImageSource = (function () {
    function ImageSource() {
    }
    ImageSource.prototype.fromAsset = function (asset) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            asset.getImageAsync(function (image, err) {
                if (image) {
                    _this.setNativeSource(image);
                    resolve(_this);
                }
                else {
                    reject(err);
                }
            });
        });
    };
    ImageSource.prototype.loadFromResource = function (name) {
        this.android = null;
        var res = getResources();
        if (res) {
            var identifier = res.getIdentifier(name, "drawable", getApplication().getPackageName());
            if (0 < identifier) {
                var bitmapDrawable = res.getDrawable(identifier);
                if (bitmapDrawable && bitmapDrawable.getBitmap) {
                    this.android = bitmapDrawable.getBitmap();
                }
            }
        }
        return this.android != null;
    };
    ImageSource.prototype.fromResource = function (name) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromResource(name));
        });
    };
    ImageSource.prototype.setRotationAngleFromFile = function (filename) {
        this.rotationAngle = 0;
        var ei = new android.media.ExifInterface(filename);
        var orientation = ei.getAttributeInt(android.media.ExifInterface.TAG_ORIENTATION, android.media.ExifInterface.ORIENTATION_NORMAL);
        switch (orientation) {
            case android.media.ExifInterface.ORIENTATION_ROTATE_90:
                this.rotationAngle = 90;
                break;
            case android.media.ExifInterface.ORIENTATION_ROTATE_180:
                this.rotationAngle = 180;
                break;
            case android.media.ExifInterface.ORIENTATION_ROTATE_270:
                this.rotationAngle = 270;
                break;
        }
    };
    ImageSource.prototype.loadFromFile = function (path) {
        var fileName = typeof path === "string" ? path.trim() : "";
        if (fileName.indexOf("~/") === 0) {
            fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
        }
        this.setRotationAngleFromFile(fileName);
        this.android = android.graphics.BitmapFactory.decodeFile(fileName, null);
        return this.android != null;
    };
    ImageSource.prototype.fromFile = function (path) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromFile(path));
        });
    };
    ImageSource.prototype.loadFromData = function (data) {
        this.android = android.graphics.BitmapFactory.decodeStream(data);
        return this.android != null;
    };
    ImageSource.prototype.fromData = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromData(data));
        });
    };
    ImageSource.prototype.loadFromBase64 = function (source) {
        if (typeof source === "string") {
            var bytes = android.util.Base64.decode(source, android.util.Base64.DEFAULT);
            this.android = android.graphics.BitmapFactory.decodeByteArray(bytes, 0, bytes.length);
        }
        return this.android != null;
    };
    ImageSource.prototype.fromBase64 = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            resolve(_this.loadFromBase64(data));
        });
    };
    ImageSource.prototype.loadFromFontIconCode = function (source, font, color) {
        var paint = new android.graphics.Paint();
        paint.setTypeface(font.getAndroidTypeface());
        paint.setAntiAlias(true);
        if (color) {
            paint.setColor(color.android);
        }
        var fontSize = utils_1.layout.toDevicePixels(font.fontSize);
        if (!fontSize) {
            fontSize = paint.getTextSize();
        }
        var density = utils_1.layout.getDisplayDensity();
        var scaledFontSize = fontSize * density;
        paint.setTextSize(scaledFontSize);
        var textBounds = new android.graphics.Rect();
        paint.getTextBounds(source, 0, source.length, textBounds);
        var textWidth = textBounds.width();
        var textHeight = textBounds.height();
        if (textWidth > 0 && textHeight > 0) {
            var bitmap = android.graphics.Bitmap
                .createBitmap(textWidth, textHeight, android.graphics.Bitmap.Config.ARGB_8888);
            var canvas = new android.graphics.Canvas(bitmap);
            canvas.drawText(source, -textBounds.left, -textBounds.top, paint);
            this.android = bitmap;
        }
        return this.android != null;
    };
    ImageSource.prototype.setNativeSource = function (source) {
        if (source && !(source instanceof android.graphics.Bitmap)) {
            throw new Error("The method setNativeSource() expects android.graphics.Bitmap instance.");
        }
        this.android = source;
    };
    ImageSource.prototype.saveToFile = function (path, format, quality) {
        if (quality === void 0) { quality = 100; }
        if (!this.android) {
            return false;
        }
        var targetFormat = getTargetFormat(format);
        var outputStream = new java.io.BufferedOutputStream(new java.io.FileOutputStream(path));
        var res = this.android.compress(targetFormat, quality, outputStream);
        outputStream.close();
        return res;
    };
    ImageSource.prototype.toBase64String = function (format, quality) {
        if (quality === void 0) { quality = 100; }
        if (!this.android) {
            return null;
        }
        var targetFormat = getTargetFormat(format);
        var outputStream = new java.io.ByteArrayOutputStream();
        var base64Stream = new android.util.Base64OutputStream(outputStream, android.util.Base64.NO_WRAP);
        this.android.compress(targetFormat, quality, base64Stream);
        base64Stream.close();
        outputStream.close();
        return outputStream.toString();
    };
    Object.defineProperty(ImageSource.prototype, "height", {
        get: function () {
            if (this.android) {
                return this.android.getHeight();
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "width", {
        get: function () {
            if (this.android) {
                return this.android.getWidth();
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "rotationAngle", {
        get: function () {
            return this._rotationAngle;
        },
        set: function (value) {
            this._rotationAngle = value;
        },
        enumerable: true,
        configurable: true
    });
    return ImageSource;
}());
exports.ImageSource = ImageSource;
function getTargetFormat(format) {
    switch (format) {
        case "jpeg":
        case "jpg":
            return android.graphics.Bitmap.CompressFormat.JPEG;
        default:
            return android.graphics.Bitmap.CompressFormat.PNG;
    }
}
function fromAsset(asset) {
    var image = new ImageSource();
    return image.fromAsset(asset);
}
exports.fromAsset = fromAsset;
function fromResource(name) {
    var image = new ImageSource();
    return image.loadFromResource(name) ? image : null;
}
exports.fromResource = fromResource;
function fromFile(path) {
    var image = new ImageSource();
    return image.loadFromFile(path) ? image : null;
}
exports.fromFile = fromFile;
function fromData(data) {
    var image = new ImageSource();
    return image.loadFromData(data) ? image : null;
}
exports.fromData = fromData;
function fromFontIconCode(source, font, color) {
    var image = new ImageSource();
    return image.loadFromFontIconCode(source, font, color) ? image : null;
}
exports.fromFontIconCode = fromFontIconCode;
function fromBase64(source) {
    var image = new ImageSource();
    return image.loadFromBase64(source) ? image : null;
}
exports.fromBase64 = fromBase64;
function fromNativeSource(source) {
    var imageSource = new ImageSource();
    imageSource.setNativeSource(source);
    return imageSource;
}
exports.fromNativeSource = fromNativeSource;
function fromUrl(url) {
    ensureHttp();
    return http.getImage(url);
}
exports.fromUrl = fromUrl;
function fromFileOrResource(path) {
    if (!utils_1.isFileOrResourcePath(path)) {
        throw new Error(path + " is not a valid file or resource.");
    }
    if (path.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        return fromResource(path.substr(utils_1.RESOURCE_PREFIX.length));
    }
    return fromFile(path);
}
exports.fromFileOrResource = fromFileOrResource;
//# sourceMappingURL=image-source.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/easysax/easysax.js":
/***/ (function(module, exports, __webpack_require__) {

﻿	/*
	new function() {
		var parser = new EasySAXParser();

		parser.ns('rss', { // or false
			rss: 'http://purl.org/rss/1.0/',
			atom: 'http://www.w3.org/2005/Atom',
			xhtml: 'http://www.w3.org/1999/xhtml',
			media: 'http://search.yahoo.com/mrss/'
		});


		parser.on('error', function(msg) {
			//console.log(msg)
		});

		parser.on('startNode', function(elem, attr, uq, tagend, getStrNode) {
			attr();
			return;
			if (tagend) {
				console.log('   '+str)
			} else {
				console.log('+  '+str)
			};
		});

		parser.on('endNode', function(elem, uq, tagstart, str) {
			return;
			if (!tagstart) console.log('-  ' + str)
		});

		parser.on('textNode', function(s, uq) {
			uq(s);
			return
			console.log('   '+s)
		});

		parser.on('cdata', function(data) {
		});


		parser.on('comment', function(text) {
			//console.log('--'+text+'--')
		});

		//parser.on('question', function() {}); // <? ... ?>
		//parser.on('attention', function() {}); // <!XXXXX zzzz="eeee">

		console.time('easysax');
		for(var z=1000;z--;) {
			parser.parse(xml)
		};
		console.timeEnd('easysax');
	};


	*/

// << ------------------------------------------------------------------------ >> //


if (true /*&& this == exports*/) {
	module.exports.EasySAXParser = EasySAXParser;
};

function EasySAXParser() {
	'use strict';

	if (!this) return null;

    this.angularSyntax = false;

	function nullFunc() {};

	this.onTextNode = nullFunc;
    this.onStartNode = nullFunc;
    this.onEndNode = nullFunc;
    this.onCDATA = nullFunc;
    this.onError = nullFunc;
    this.onComment = null;
    this.onQuestion = null;
    this.onAttention = null;
	this.is_onComment = this.is_onQuestion = this.is_onAttention = false;

	this.isNamespace = false;
    this.useNS = null;
    this.default_xmlns = null;
    this.xmlns = null;
	this.nsmatrix = {xmlns: this.xmlns};
	this.hasSurmiseNS = false;
	;


	this.attr_string = ''; // строка атрибутов
	this.attr_posstart = 0; //
	this.attr_res; // закешированный результат разбора атрибутов , null - разбор не проводился, object - хеш атрибутов, true - нет атрибутов, false - невалидный xml
}

EasySAXParser.prototype.on = function(name, cb) {
    if (typeof cb !== 'function') {
        if (cb !== null) return;
    };

    switch(name) {
        case 'error': this.onError = cb || nullFunc; break;
        case 'startNode': this.onStartNode = cb || nullFunc; break;
        case 'endNode': this.onEndNode = cb || nullFunc; break;
        case 'textNode': this.onTextNode = cb || nullFunc; break;
        case 'cdata': this.onCDATA = cb || nullFunc; break;

        case 'comment': this.onComment = cb; this.is_onComment = !!cb; break;
        case 'question': this.onQuestion = cb; this.is_onQuestion = !!cb; break; // <? ....  ?>
        case 'attention': this.onAttention = cb; this.is_onAttention = !!cb; break; // <!XXXXX zzzz="eeee">
    };
};

EasySAXParser.prototype.ns = function(root, ns) {
    if (!root || typeof root !== 'string' || !ns) {
        return;
    };

    var u, x = {}, ok, v, i;

    for(i in ns) {
        v = ns[i];
        if (typeof v === 'string') {
            if (root === v) ok = true;
            x[i] = v;
        };
    };

    if (ok) {
        this.isNamespace = true;
        this.default_xmlns = root;
        this.useNS = x;
    };
};


EasySAXParser.prototype.parse = function(xml) {
    if (typeof xml !== 'string') {
        return;
    };

    if (this.isNamespace) {
        this.nsmatrix = {xmlns: this.default_xmlns};

        parse(xml);

        this.nsmatrix = false;

    } else {
        parse(xml);
    };

    this.attr_res = true;
};

// -----------------------------------------------------

var xharsQuot={constructor: false, hasOwnProperty: false, isPrototypeOf: false, propertyIsEnumerable: false, toLocaleString: false, toString: false, valueOf: false
    , quot: '"'
    , QUOT: '"'
    , amp: '&'
    , AMP: '&'
    , nbsp: '\u00A0'
    , apos: '\''
    , lt: '<'
    , LT: '<'
    , gt: '>'
    , GT: '>'
    , copy: '\u00A9'
    , laquo: '\u00AB'
    , raquo: '\u00BB'
    , reg: '\u00AE'
    , deg: '\u00B0'
    , plusmn: '\u00B1'
    , sup2: '\u00B2'
    , sup3: '\u00B3'
    , micro: '\u00B5'
    , para: '\u00B6'
};


function rpEntities(s, d, x, z) {
    if (z) {
        return xharsQuot[z] || '\x01';
    };

    if (d) {
        return String.fromCodePoint(d);
    };

    return String.fromCodePoint(parseInt(x, 16));
};

function unEntities(s, i) {
    s = String(s);
    if (s.length > 3 && s.indexOf('&') !== -1) {
        if (s.indexOf('&gt;') !== -1) s = s.replace(/&gt;/g, '>');
        if (s.indexOf('&lt;') !== -1) s = s.replace(/&lt;/g, '<');
        if (s.indexOf('&quot;') !== -1) s = s.replace(/&quot;/g, '"');

        if (s.indexOf('&') !== -1) {
            s = s.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig, rpEntities);
        };
    };

    return s;
};


EasySAXParser.prototype.allowedAngularAttributeChars = function(w) {
    if (!this.angularSyntax) {
        return false;
    } else {
        return (
            w === 40 || // (
            w === 41 || // )
            w === 91 || // [
            w === 93 || // ]
            w === 94 || // ^
            w === 35    // #
        );
    }
};

	/*
		парсит атрибуты по требованию. Важно! - функция не генерирует исключения.

		если была ошибка разбора возврашается false
		если атрибутов нет и разбор удачен то возврашается true
		если есть атрибуты то возврашается обьект(хеш)
	*/

EasySAXParser.prototype.getAttrs = function() {
    if (this.attr_res !== null) {
        return this.attr_res;
    };

    /*
    if (xxtest !== u && attr_string.indexOf(xxtest) === -1) {
        / *
            // для ускорения
            if (getAttrs('html').type == 'html') {
                ...
            };
        * /
        return true;
    };
    */

    var u
    , res = {}
    , s = this.attr_string
    , i = this.attr_posstart
    , l = s.length
    , attr_list = this.hasSurmiseNS ? [] : false
    , name, value = ''
    , ok = false
    , noValueAttribute = false
    , j, w, nn, n
    , hasNewMatrix
    , alias, newalias
    ;

    aa:
    for(; i < l; i++) {
        w = s.charCodeAt(i);

        if (w===32 || (w<14 && w > 8) ) { // \f\n\r\t\v
            continue
        };

        // Check for valid attribute start char
        if ((w < 65 && !this.allowedAngularAttributeChars(w)) ||
                w > 122 || (w > 90 && w < 97 && !this.allowedAngularAttributeChars(w)) ) { // ожидаем символ
            return this.attr_res = false; // error. invalid char
        };

        for(j = i + 1; j < l; j++) { // проверяем все символы имени атрибута
            w = s.charCodeAt(j);

            if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                if (noValueAttribute) {
                    j--; //Started next attribute. Get back and break out of the loop.
                    break;
                } else {
                    continue;
                }
            };

            if (this.allowedAngularAttributeChars(w)) {
                continue;
            }

            if (w === 32 || (w > 8 && w < 14) ) {  // \f\n\r\t\v пробел
                noValueAttribute = true;
                continue;
            } else if (w === 61) { // "=" == 61
                noValueAttribute = false;
                break;
            } else {
                //console.log('error 2');
                if (!noValueAttribute)
                    return this.attr_res = false; // error. invalid char
            };

            break;
        };

        name = s.substring(i, j).trim();
        ok = true;

        if (name === 'xmlns:xmlns') {
            //console.log('error 6')
            return this.attr_res = false; // error. invalid name
        };

        w = s.charCodeAt(j+1);

        while (w = s.charCodeAt(j+1)) {
            if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                j++;
            } else {
                break;
            }
        }

        if (!noValueAttribute) {
            if (w === 34) {  // '"'
                j = s.indexOf('"', i = j+2 );

            } else {
                if (w === 39) {
                    j = s.indexOf('\'', i = j+2 );

                } else {  // "'"
                    return this.attr_res = false; // error. invalid char
                };
            };
        }

        if (j === -1) {
            //console.log('error 4')
            return this.attr_res = false; // error. invalid char
        };


        if (j+1 < l && !noValueAttribute) {
            w = s.charCodeAt(j+1);

            if (w > 32 || w < 9 || (w < 32 && w > 13)) {
                // error. invalid char
                //console.log('error 5')
                return this.attr_res = false;
            };
        };


        if (noValueAttribute) {
            value = '';
        } else {
            value = s.substring(i, j);
        }

        //i = j + 1; // след. семвол уже проверен потому проверять нужно следуюший
        i = j; // след. семвол уже проверен потому проверять нужно следуюший

        if (this.isNamespace) { //
            if (this.hasSurmiseNS) {
                // есть подозрение что в атрибутах присутствует xmlns

                if (newalias = name === 'xmlns' ? 'xmlns' : name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:' && name.substr(6) ) {
                    alias = this.useNS[unEntities(value)];

                    if (alias) {
                        if (this.nsmatrix[newalias] !== alias) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = alias;
                        };
                    } else {
                        if (this.nsmatrix[newalias]) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = false;
                        };
                    };

                    res[name] = value;
                    continue;
                };

                attr_list.push(name, value);
                continue;
            };

            w = name.length;
            while(--w) {
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)] ) {
                        res[w + name.substr(w)] = value;
                    };
                    continue aa;

                    // 'xml:base' ???
                };
            };
        };

        res[name] = value;
        noValueAttribute = false;
    };


    if (!ok) {
        return this.attr_res = true;  // атрибутов нет, ошибок тоже нет
    };


    if (this.hasSurmiseNS)  {
        bb:

        for (i = 0, l = attr_list.length; i < l; i++) {
            name = attr_list[i++];

            w = name.length;
            while(--w) { // name.indexOf(':')
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)]) {
                        res[w + name.substr(w)] = attr_list[i];
                    };
                    continue bb;
                    break;
                };
            };

            res[name] = attr_list[i];
        };
    };

    return this.attr_res = res;
};


// xml - string
EasySAXParser.prototype.parse = function(xml) {
    var u
    , xml = String(xml)
    , nodestack = []
    , stacknsmatrix = []
    //, string_node
    , elem
    , tagend = false
    , tagstart = false
    , j = 0, i = 0, k = 0, len
    , x, y, q, w
    , xmlns
    , stopIndex = 0
    , stop // используется при разборе "namespace" . если встретился неизвестное пространство то события не генерируются
    , _nsmatrix
    , ok
    , pos = 0, ln = 0, lnStart = -2, lnEnd = -1
    ;

    len = xml.length;
    function getStringNode() {
        return xml.substring(i, j+1)
    };
    function findLineAndColumnFromPos() {
        while (lnStart < lnEnd && lnEnd < pos) {
            lnStart = lnEnd;
            lnEnd = xml.indexOf("\n", lnEnd + 1);
            ++ln;
        }
        return { line: ln, column: pos - lnStart };
    }
    function position(p) {
        pos = p;
        return findLineAndColumnFromPos;
    }

    while(j !== -1) {
        stop = stopIndex > 0;

        if (xml.charCodeAt(j) === 60) { // "<"
            i = j;
        } else {
            i = xml.indexOf('<', j);
        };

        if (i === -1) { // конец разбора

            if (nodestack.length) {
                this.onError('end file', position(j));
                return;
            };

            return;
        };

        if (j !== i && !stop) {
            ok = this.onTextNode(xml.substring(j, i), unEntities, position(j));
            if (ok === false) return;
        };

        w = xml.charCodeAt(i+1);

        if (w === 33) { // "!"
            w = xml.charCodeAt(i+2);
            if (w === 91 && xml.substr(i+3, 6) === 'CDATA[') { // 91 == "["
                j = xml.indexOf(']]>', i);
                if (j === -1) {
                    this.onError('cdata', position(i));
                    return;
                };

                //x = xml.substring(i+9, j);
                if (!stop) {
                    ok = this.onCDATA(xml.substring(i+9, j), false, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            if (w === 45 && xml.charCodeAt(i+3) === 45) { // 45 == "-"
                j = xml.indexOf('-->', i);
                if (j === -1) {
                    this.onError('expected -->', position(i));
                    return;
                };


                if (this.is_onComment && !stop) {
                    ok = this.onComment(xml.substring(i+4, j), unEntities, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            j = xml.indexOf('>', i+1);
            if (j === -1) {
                this.onError('expected ">"', position(i + 1));
                return;
            };

            if (this.is_onAttention && !stop) {
                ok = this.onAttention(xml.substring(i, j+1), unEntities, position(i));
                if (ok === false) return;
            };

            j += 1;
            continue;

        } else {
            if (w === 63) { // "?"
                j = xml.indexOf('?>', i);
                if (j === -1) { // error
                    this.onError('...?>', position(i));
                    return;
                };

                if (this.is_onQuestion) {
                    ok = this.onQuestion(xml.substring(i, j+2), position(i));
                    if (ok === false) return;
                };

                j += 2;
                continue;
            };
        };

        var inside=false;
        for (k=i,j=-1;k<len;k++) {
            var c = xml.charCodeAt(k);
            if (!inside) {

                if (c === 34) { // '"'
                    inside = c;
                }
                else if (c === 39) { // "'"
                    inside = c;
                }
                else if (c === 62) { // <
                    j = k; break;
                }
            } else {
                if (c === inside) { inside = false; }
            }
        }

        if (j == -1) { // error
            this.onError('...>', position(i + 1));
            return;
        };

        this.attr_res = true; // атрибутов нет

        //if (xml.charCodeAt(i+1) === 47) { // </...
        if (w === 47) { // </...
            tagstart = false;
            tagend = true;

            // проверяем что должен быть закрыт тотже тег что и открывался
            x = elem = nodestack.pop();
            q = i + 2 + x.length;

            //console.log()
            if (xml.substring(i+2, q) !== x) {
                this.onError('close tagname', position(i + 2));
                return;
            };

            // проверим что в закрываюшем теге нет лишнего
            for(; q < j; q++) {
                w = xml.charCodeAt(q);

                if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                    continue;
                };

                this.onError('close tag', position(i + 2));
                return;
            };

        } else {
            if (xml.charCodeAt(j-1) ===  47) { // .../>
                x = elem = xml.substring(i+1, j-1);

                tagstart = true;
                tagend = true;
            } else {
                x = elem = xml.substring(i+1, j);

                tagstart = true;
                tagend = false;
            };

            if ( !(w > 96  && w < 123 || w > 64 && w <91) ) {
                this.onError('first char nodeName', position(i + 1));
                return;
            };

            for(q = 1, y = x.length; q < y; q++) {
                w = x.charCodeAt(q);

                if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                    continue;
                };

                if (w===32 || (w<14 && w > 8)) { // \f\n\r\t\v пробел
                    elem = x.substring(0, q)
                    this.attr_res = null; // возможно есть атирибуты
                    break;
                };

                this.onError('invalid nodeName', position(i + 1));
                return;
            };

            if (!tagend) {
                nodestack.push(elem);
            };
        };


        if (this.isNamespace) {
            if (stop) {
                if (tagend) {
                    if (!tagstart) {
                        if (--stopIndex === 0) {
                            this.nsmatrix = stacknsmatrix.pop();
                        };
                    };

                } else {
                    stopIndex += 1;
                };


                j += 1;
                continue;
            };

            _nsmatrix = this.nsmatrix;

            if (!tagend) {
                stacknsmatrix.push(this.nsmatrix);

                if (this.attr_res !== true) {
                    if (this.hasSurmiseNS = x.indexOf('xmlns', q) !== -1) {
                        this.attr_string = x;
                        this.attr_posstart = q;

                        this.getAttrs();

                        this.hasSurmiseNS = false;
                    };
                };
            };


            w = elem.indexOf(':');
            if (w !== -1) {
                xmlns = this.nsmatrix[elem.substring(0, w)];
                elem = elem.substr(w+1);

            } else {
                xmlns = this.nsmatrix.xmlns;
            };

            if (!xmlns) {
                if (tagend) {
                    if (tagstart) {
                        this.nsmatrix = _nsmatrix;
                    } else {
                        this.nsmatrix = stacknsmatrix.pop();
                    };
                } else {
                    stopIndex = 1; // первый элемент для которого не определено пространство имен
                    this.attr_res = true;
                };

                j += 1;
                continue;
            };

            elem = xmlns + ':' + elem;
        };

        //string_node = xml.substring(i, j+1); // текст ноды как есть

        if (tagstart) { // is_onStartNode
            this.attr_string = x;
            this.attr_posstart = q;

            var that = this;
            ok = this.onStartNode(elem, function() { return that.getAttrs() }, unEntities, tagend
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            this.attr_res = true;
        };

        if (tagend) {
            ok = this.onEndNode(elem, unEntities, tagstart
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            if (this.isNamespace) {
                if (tagstart) {
                    this.nsmatrix = _nsmatrix;
                } else {
                    this.nsmatrix = stacknsmatrix.pop();
                };
            };
        };

        j += 1;
    };
};


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/esprima/esprima.js":
/***/ (function(module, exports) {

﻿/*
  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

(function (global) {
    'use strict';

    var Token,
        TokenName,
        Syntax,
        Messages,
        source,
        index,
        length,
        delegate,
        lookahead,
        state;

    Token = {
        BooleanLiteral: 1,
        EOF: 2,
        Identifier: 3,
        Keyword: 4,
        NullLiteral: 5,
        NumericLiteral: 6,
        Punctuator: 7,
        StringLiteral: 8
    };

    TokenName = {};
    TokenName[Token.BooleanLiteral] = 'Boolean';
    TokenName[Token.EOF] = '<end>';
    TokenName[Token.Identifier] = 'Identifier';
    TokenName[Token.Keyword] = 'Keyword';
    TokenName[Token.NullLiteral] = 'Null';
    TokenName[Token.NumericLiteral] = 'Numeric';
    TokenName[Token.Punctuator] = 'Punctuator';
    TokenName[Token.StringLiteral] = 'String';

    Syntax = {
        ArrayExpression: 'ArrayExpression',
        BinaryExpression: 'BinaryExpression',
        CallExpression: 'CallExpression',
        ConditionalExpression: 'ConditionalExpression',
        EmptyStatement: 'EmptyStatement',
        ExpressionStatement: 'ExpressionStatement',
        Identifier: 'Identifier',
        Literal: 'Literal',
        LabeledStatement: 'LabeledStatement',
        LogicalExpression: 'LogicalExpression',
        MemberExpression: 'MemberExpression',
        ObjectExpression: 'ObjectExpression',
        Program: 'Program',
        Property: 'Property',
        ThisExpression: 'ThisExpression',
        UnaryExpression: 'UnaryExpression'
    };

    // Error messages should be identical to V8.
    Messages = {
        UnexpectedToken: 'Unexpected token %0',
        UnknownLabel: 'Undefined label \'%0\'',
        Redeclaration: '%0 \'%1\' has already been declared'
    };

    // Ensure the condition is true, otherwise throw an error.
    // This is only to have a better contract semantic, i.e. another safety net
    // to catch a logic error. The condition shall be fulfilled in normal case.
    // Do NOT use this to enforce a certain condition on any user input.

    function assert(condition, message) {
        if (!condition) {
            throw new Error('ASSERT: ' + message);
        }
    }

    function isDecimalDigit(ch) {
        return (ch >= 48 && ch <= 57);   // 0..9
    }


    // 7.2 White Space

    function isWhiteSpace(ch) {
        return (ch === 32) ||  // space
            (ch === 9) ||      // tab
            (ch === 0xB) ||
            (ch === 0xC) ||
            (ch === 0xA0) ||
            (ch >= 0x1680 && '\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);
    }

    // 7.3 Line Terminators

    function isLineTerminator(ch) {
        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);
    }

    // 7.6 Identifier Names and Identifiers

    function isIdentifierStart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122);          // a..z
    }

    function isIdentifierPart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122) ||        // a..z
            (ch >= 48 && ch <= 57);           // 0..9
    }

    // 7.6.1.1 Keywords

    function isKeyword(id) {
        return (id === 'this')
    }

    // 7.4 Comments

    function skipWhitespace() {
        while (index < length && isWhiteSpace(source.charCodeAt(index))) {
            ++index;
        }
    }

    function getIdentifier() {
        var start, ch;

        start = index++;
        while (index < length) {
            ch = source.charCodeAt(index);
            if (isIdentifierPart(ch)) {
                ++index;
            } else {
                break;
            }
        }

        return source.slice(start, index);
    }

    function scanIdentifier() {
        var start, id, type;

        start = index;

        id = getIdentifier();

        // There is no keyword or literal with only one character.
        // Thus, it must be an identifier.
        if (id.length === 1) {
            type = Token.Identifier;
        } else if (isKeyword(id)) {
            type = Token.Keyword;
        } else if (id === 'null') {
            type = Token.NullLiteral;
        } else if (id === 'true' || id === 'false') {
            type = Token.BooleanLiteral;
        } else {
            type = Token.Identifier;
        }

        return {
            type: type,
            value: id,
            range: [start, index]
        };
    }


    // 7.7 Punctuators

    function scanPunctuator() {
        var start = index,
            code = source.charCodeAt(index),
            code2,
            ch1 = source[index],
            ch2;

        switch (code) {

            // Check for most common single-character punctuators.
            case 46:   // . dot
            case 40:   // ( open bracket
            case 41:   // ) close bracket
            case 59:   // ; semicolon
            case 44:   // , comma
            case 123:  // { open curly brace
            case 125:  // } close curly brace
            case 91:   // [
            case 93:   // ]
            case 58:   // :
            case 63:   // ?
                ++index;
                return {
                    type: Token.Punctuator,
                    value: String.fromCharCode(code),
                    range: [start, index]
                };

            default:
                code2 = source.charCodeAt(index + 1);

                // '=' (char #61) marks an assignment or comparison operator.
                if (code2 === 61) {
                    switch (code) {
                        case 37:  // %
                        case 38:  // &
                        case 42:  // *:
                        case 43:  // +
                        case 45:  // -
                        case 47:  // /
                        case 60:  // <
                        case 62:  // >
                        case 124: // |
                            index += 2;
                            return {
                                type: Token.Punctuator,
                                value: String.fromCharCode(code) + String.fromCharCode(code2),
                                range: [start, index]
                            };

                        case 33: // !
                        case 61: // =
                            index += 2;

                            // !== and ===
                            if (source.charCodeAt(index) === 61) {
                                ++index;
                            }
                            return {
                                type: Token.Punctuator,
                                value: source.slice(start, index),
                                range: [start, index]
                            };
                        default:
                            break;
                    }
                }
                break;
        }

        // Peek more characters.

        ch2 = source[index + 1];

        // Other 2-character punctuators: && ||

        if (ch1 === ch2 && ('&|'.indexOf(ch1) >= 0)) {
            index += 2;
            return {
                type: Token.Punctuator,
                value: ch1 + ch2,
                range: [start, index]
            };
        }

        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {
            ++index;
            return {
                type: Token.Punctuator,
                value: ch1,
                range: [start, index]
            };
        }

        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
    }

    // 7.8.3 Numeric Literals
    function scanNumericLiteral() {
        var number, start, ch;

        ch = source[index];
        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),
            'Numeric literal must start with a decimal digit or a decimal point');

        start = index;
        number = '';
        if (ch !== '.') {
            number = source[index++];
            ch = source[index];

            // Hex number starts with '0x'.
            // Octal number starts with '0'.
            if (number === '0') {
                // decimal number starts with '0' such as '09' is illegal.
                if (ch && isDecimalDigit(ch.charCodeAt(0))) {
                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
                }
            }

            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === '.') {
            number += source[index++];
            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === 'e' || ch === 'E') {
            number += source[index++];

            ch = source[index];
            if (ch === '+' || ch === '-') {
                number += source[index++];
            }
            if (isDecimalDigit(source.charCodeAt(index))) {
                while (isDecimalDigit(source.charCodeAt(index))) {
                    number += source[index++];
                }
            } else {
                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
            }
        }

        if (isIdentifierStart(source.charCodeAt(index))) {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.NumericLiteral,
            value: parseFloat(number),
            range: [start, index]
        };
    }

    // 7.8.4 String Literals

    function scanStringLiteral() {
        var str = '', quote, start, ch, octal = false;

        quote = source[index];
        assert((quote === '\'' || quote === '"'),
            'String literal must starts with a quote');

        start = index;
        ++index;

        while (index < length) {
            ch = source[index++];

            if (ch === quote) {
                quote = '';
                break;
            } else if (ch === '\\') {
                ch = source[index++];
                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {
                    switch (ch) {
                        case 'n':
                            str += '\n';
                            break;
                        case 'r':
                            str += '\r';
                            break;
                        case 't':
                            str += '\t';
                            break;
                        case 'b':
                            str += '\b';
                            break;
                        case 'f':
                            str += '\f';
                            break;
                        case 'v':
                            str += '\x0B';
                            break;

                        default:
                            str += ch;
                            break;
                    }
                } else {
                    if (ch === '\r' && source[index] === '\n') {
                        ++index;
                    }
                }
            } else if (isLineTerminator(ch.charCodeAt(0))) {
                break;
            } else {
                str += ch;
            }
        }

        if (quote !== '') {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.StringLiteral,
            value: str,
            octal: octal,
            range: [start, index]
        };
    }

    function isIdentifierName(token) {
        return token.type === Token.Identifier ||
            token.type === Token.Keyword ||
            token.type === Token.BooleanLiteral ||
            token.type === Token.NullLiteral;
    }

    function advance() {
        var ch;

        skipWhitespace();

        if (index >= length) {
            return {
                type: Token.EOF,
                range: [index, index]
            };
        }

        ch = source.charCodeAt(index);

        // Very common: ( and ) and ;
        if (ch === 40 || ch === 41 || ch === 58) {
            return scanPunctuator();
        }

        // String literal starts with single quote (#39) or double quote (#34).
        if (ch === 39 || ch === 34) {
            return scanStringLiteral();
        }

        if (isIdentifierStart(ch)) {
            return scanIdentifier();
        }

        // Dot (.) char #46 can also start a floating-point number, hence the need
        // to check the next character.
        if (ch === 46) {
            if (isDecimalDigit(source.charCodeAt(index + 1))) {
                return scanNumericLiteral();
            }
            return scanPunctuator();
        }

        if (isDecimalDigit(ch)) {
            return scanNumericLiteral();
        }

        return scanPunctuator();
    }

    function lex() {
        var token;

        token = lookahead;
        index = token.range[1];

        lookahead = advance();

        index = token.range[1];

        return token;
    }

    function peek() {
        var pos;

        pos = index;
        lookahead = advance();
        index = pos;
    }

    // Throw an exception

    function throwError(token, messageFormat) {
        var error,
            args = Array.prototype.slice.call(arguments, 2),
            msg = messageFormat.replace(
                /%(\d)/g,
                function (whole, index) {
                    assert(index < args.length, 'Message reference must be in range');
                    return args[index];
                }
            );

        error = new Error(msg);
        error.index = index;
        error.description = msg;
        throw error;
    }

    // Throw an exception because of the token.

    function throwUnexpected(token) {
        throwError(token, Messages.UnexpectedToken, token.value);
    }

    // Expect the next token to match the specified punctuator.
    // If not, an exception will be thrown.

    function expect(value) {
        var token = lex();
        if (token.type !== Token.Punctuator || token.value !== value) {
            throwUnexpected(token);
        }
    }

    // Return true if the next token matches the specified punctuator.

    function match(value) {
        return lookahead.type === Token.Punctuator && lookahead.value === value;
    }

    // Return true if the next token matches the specified keyword

    function matchKeyword(keyword) {
        return lookahead.type === Token.Keyword && lookahead.value === keyword;
    }

    function consumeSemicolon() {
        // Catch the very common case first: immediately a semicolon (char #59).
        if (source.charCodeAt(index) === 59) {
            lex();
            return;
        }

        skipWhitespace();

        if (match(';')) {
            lex();
            return;
        }

        if (lookahead.type !== Token.EOF && !match('}')) {
            throwUnexpected(lookahead);
        }
    }

    // 11.1.4 Array Initialiser

    function parseArrayInitialiser() {
        var elements = [];

        expect('[');

        while (!match(']')) {
            if (match(',')) {
                lex();
                elements.push(null);
            } else {
                elements.push(parseExpression());

                if (!match(']')) {
                    expect(',');
                }
            }
        }

        expect(']');

        return delegate.createArrayExpression(elements);
    }

    // 11.1.5 Object Initialiser

    function parseObjectPropertyKey() {
        var token;

        skipWhitespace();
        token = lex();

        // Note: This function is called only from parseObjectProperty(), where
        // EOF and Punctuator tokens are already filtered out.
        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {
            return delegate.createLiteral(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseObjectProperty() {
        var token, key;

        token = lookahead;
        skipWhitespace();

        if (token.type === Token.EOF || token.type === Token.Punctuator) {
            throwUnexpected(token);
        }

        key = parseObjectPropertyKey();
        expect(':');
        return delegate.createProperty('init', key, parseExpression());
    }

    function parseObjectInitialiser() {
        var properties = [];

        expect('{');

        while (!match('}')) {
            properties.push(parseObjectProperty());

            if (!match('}')) {
                expect(',');
            }
        }

        expect('}');

        return delegate.createObjectExpression(properties);
    }

    // 11.1.6 The Grouping Operator

    function parseGroupExpression() {
        var expr;

        expect('(');

        expr = parseExpression();

        expect(')');

        return expr;
    }


    // 11.1 Primary Expressions

    function parsePrimaryExpression() {
        var type, token, expr;

        if (match('(')) {
            return parseGroupExpression();
        }

        type = lookahead.type;

        if (type === Token.Identifier) {
            expr = delegate.createIdentifier(lex().value);
        } else if (type === Token.StringLiteral || type === Token.NumericLiteral) {
            expr = delegate.createLiteral(lex());
        } else if (type === Token.Keyword) {
            if (matchKeyword('this')) {
                lex();
                expr = delegate.createThisExpression();
            }
        } else if (type === Token.BooleanLiteral) {
            token = lex();
            token.value = (token.value === 'true');
            expr = delegate.createLiteral(token);
        } else if (type === Token.NullLiteral) {
            token = lex();
            token.value = null;
            expr = delegate.createLiteral(token);
        } else if (match('[')) {
            expr = parseArrayInitialiser();
        } else if (match('{')) {
            expr = parseObjectInitialiser();
        }

        if (expr) {
            return expr;
        }

        throwUnexpected(lex());
    }

    // 11.2 Left-Hand-Side Expressions

    function parseArguments() {
        var args = [];

        expect('(');

        if (!match(')')) {
            while (index < length) {
                args.push(parseExpression());
                if (match(')')) {
                    break;
                }
                expect(',');
            }
        }

        expect(')');

        return args;
    }

    function parseNonComputedProperty() {
        var token;

        token = lex();

        if (!isIdentifierName(token)) {
            throwUnexpected(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseNonComputedMember() {
        expect('.');

        return parseNonComputedProperty();
    }

    function parseComputedMember() {
        var expr;

        expect('[');

        expr = parseExpression();

        expect(']');

        return expr;
    }

    function parseLeftHandSideExpression() {
        var expr, args, property;

        expr = parsePrimaryExpression();

        while (true) {
            if (match('[')) {
                property = parseComputedMember();
                expr = delegate.createMemberExpression('[', expr, property);
            } else if (match('.')) {
                property = parseNonComputedMember();
                expr = delegate.createMemberExpression('.', expr, property);
            } else if (match('(')) {
                args = parseArguments();
                expr = delegate.createCallExpression(expr, args);
            } else {
                break;
            }
        }

        return expr;
    }

    // 11.3 Postfix Expressions

    var parsePostfixExpression = parseLeftHandSideExpression;

    // 11.4 Unary Operators

    function parseUnaryExpression() {
        var token, expr;

        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {
            expr = parsePostfixExpression();
        } else if (match('+') || match('-') || match('!')) {
            token = lex();
            expr = parseUnaryExpression();
            expr = delegate.createUnaryExpression(token.value, expr);
        } else if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {
            throwError({}, Messages.UnexpectedToken);
        } else {
            expr = parsePostfixExpression();
        }

        return expr;
    }

    function binaryPrecedence(token) {
        var prec = 0;

        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {
            return 0;
        }

        switch (token.value) {
            case '||':
                prec = 1;
                break;

            case '&&':
                prec = 2;
                break;

            case '==':
            case '!=':
            case '===':
            case '!==':
                prec = 6;
                break;

            case '<':
            case '>':
            case '<=':
            case '>=':
            case 'instanceof':
                prec = 7;
                break;

            case 'in':
                prec = 7;
                break;

            case '+':
            case '-':
                prec = 9;
                break;

            case '*':
            case '/':
            case '%':
                prec = 11;
                break;

            default:
                break;
        }

        return prec;
    }

    // 11.5 Multiplicative Operators
    // 11.6 Additive Operators
    // 11.7 Bitwise Shift Operators
    // 11.8 Relational Operators
    // 11.9 Equality Operators
    // 11.10 Binary Bitwise Operators
    // 11.11 Binary Logical Operators

    function parseBinaryExpression() {
        var expr, token, prec, stack, right, operator, left, i;

        left = parseUnaryExpression();

        token = lookahead;
        prec = binaryPrecedence(token);
        if (prec === 0) {
            return left;
        }
        token.prec = prec;
        lex();

        right = parseUnaryExpression();

        stack = [left, token, right];

        while ((prec = binaryPrecedence(lookahead)) > 0) {

            // Reduce: make a binary expression from the three topmost entries.
            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {
                right = stack.pop();
                operator = stack.pop().value;
                left = stack.pop();
                expr = delegate.createBinaryExpression(operator, left, right);
                stack.push(expr);
            }

            // Shift.
            token = lex();
            token.prec = prec;
            stack.push(token);
            expr = parseUnaryExpression();
            stack.push(expr);
        }

        // Final reduce to clean-up the stack.
        i = stack.length - 1;
        expr = stack[i];
        while (i > 1) {
            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);
            i -= 2;
        }

        return expr;
    }


    // 11.12 Conditional Operator

    function parseConditionalExpression() {
        var expr, consequent, alternate;

        expr = parseBinaryExpression();

        if (match('?')) {
            lex();
            consequent = parseConditionalExpression();
            expect(':');
            alternate = parseConditionalExpression();

            expr = delegate.createConditionalExpression(expr, consequent, alternate);
        }

        return expr;
    }

    // Simplification since we do not support AssignmentExpression.
    var parseExpression = parseConditionalExpression;

    // Polymer Syntax extensions

    // Filter ::
    //   Identifier
    //   Identifier "(" ")"
    //   Identifier "(" FilterArguments ")"

    function parseFilter() {
        var identifier, args;

        identifier = lex();

        if (identifier.type !== Token.Identifier) {
            throwUnexpected(identifier);
        }

        args = match('(') ? parseArguments() : [];

        return delegate.createFilter(identifier.value, args);
    }

    // Filters ::
    //   "|" Filter
    //   Filters "|" Filter

    function parseFilters() {
        while (match('|')) {
            lex();
            parseFilter();
        }
    }

    // TopLevel ::
    //   LabelledExpressions
    //   AsExpression
    //   InExpression
    //   FilterExpression

    // AsExpression ::
    //   FilterExpression as Identifier

    // InExpression ::
    //   Identifier, Identifier in FilterExpression
    //   Identifier in FilterExpression

    // FilterExpression ::
    //   Expression
    //   Expression Filters

    function parseTopLevel() {
        skipWhitespace();
        peek();

        var expr = parseExpression();
        if (expr) {
            if (lookahead.value === ',' || lookahead.value == 'in' &&
                       expr.type === Syntax.Identifier) {
                parseInExpression(expr);
            } else {
                parseFilters();
                if (lookahead.value === 'as') {
                    parseAsExpression(expr);
                } else {
                    delegate.createTopLevel(expr);
                }
            }
        }

        if (lookahead.type !== Token.EOF) {
            throwUnexpected(lookahead);
        }
    }

    function parseAsExpression(expr) {
        lex();  // as
        var identifier = lex().value;
        delegate.createAsExpression(expr, identifier);
    }

    function parseInExpression(identifier) {
        var indexName;
        if (lookahead.value === ',') {
            lex();
            if (lookahead.type !== Token.Identifier)
                throwUnexpected(lookahead);
            indexName = lex().value;
        }

        lex();  // in
        var expr = parseExpression();
        parseFilters();
        delegate.createInExpression(identifier.name, indexName, expr);
    }

    function parse(code, inDelegate) {
        delegate = inDelegate;
        source = code;
        index = 0;
        length = source.length;
        lookahead = null;
        state = {
            labelSet: {}
        };

        return parseTopLevel();
    }

    global.esprima = {
        parse: parse
    };
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
﻿/*
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */



function detectEval() {
    // Don't test for eval if we're running in a Chrome App environment.
    // We check for APIs set that only exist in a Chrome App context.
    if (typeof chrome !== 'undefined' && chrome.app && chrome.app.runtime) {
        return false;
    }

    // Firefox OS Apps do not allow eval. This feature detection is very hacky
    // but even if some other platform adds support for this function this code
    // will continue to work.
    if (typeof navigator != 'undefined' && navigator.getDeviceStorage) {
        return false;
    }

    try {
        var f = new Function('', 'return true;');
        return f();
    } catch (ex) {
        return false;
    }
}

var hasEval = detectEval();

function isIndex(s) {
    return +s === s >>> 0 && s !== '';
}

function toNumber(s) {
    return +s;
}

function isObject(obj) {
    return obj === Object(obj);
}

var numberIsNaN = Number.isNaN || function (value) {
    return typeof value === 'number' && isNaN(value);
}

function areSameValue(left, right) {
    if (left === right)
        return left !== 0 || 1 / left === 1 / right;
    if (numberIsNaN(left) && numberIsNaN(right))
        return true;

    return left !== left && right !== right;
}

var createObject = ('__proto__' in {}) ?
  function (obj) { return obj; } :
  function (obj) {
      var proto = obj.__proto__;
      if (!proto)
          return obj;
      var newObject = Object.create(proto);
      Object.getOwnPropertyNames(obj).forEach(function (name) {
          Object.defineProperty(newObject, name,
                               Object.getOwnPropertyDescriptor(obj, name));
      });
      return newObject;
  };

var identStart = '[\$_a-zA-Z]';
var identPart = '[\$_a-zA-Z0-9]';
var identRegExp = new RegExp('^' + identStart + '+' + identPart + '*' + '$');

function getPathCharType(char) {
    if (char === undefined)
        return 'eof';

    var code = char.charCodeAt(0);

    switch (code) {
        case 0x5B: // [
        case 0x5D: // ]
        case 0x2E: // .
        case 0x22: // "
        case 0x27: // '
        case 0x30: // 0
            return char;

        case 0x5F: // _
        case 0x24: // $
            return 'ident';

        case 0x20: // Space
        case 0x09: // Tab
        case 0x0A: // Newline
        case 0x0D: // Return
        case 0xA0:  // No-break space
        case 0xFEFF:  // Byte Order Mark
        case 0x2028:  // Line Separator
        case 0x2029:  // Paragraph Separator
            return 'ws';
    }

    // a-z, A-Z
    if ((0x61 <= code && code <= 0x7A) || (0x41 <= code && code <= 0x5A))
        return 'ident';

    // 1-9
    if (0x31 <= code && code <= 0x39)
        return 'number';

    return 'else';
}

var pathStateMachine = {
    'beforePath': {
        'ws': ['beforePath'],
        'ident': ['inIdent', 'append'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'inPath': {
        'ws': ['inPath'],
        '.': ['beforeIdent'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'beforeIdent': {
        'ws': ['beforeIdent'],
        'ident': ['inIdent', 'append']
    },

    'inIdent': {
        'ident': ['inIdent', 'append'],
        '0': ['inIdent', 'append'],
        'number': ['inIdent', 'append'],
        'ws': ['inPath', 'push'],
        '.': ['beforeIdent', 'push'],
        '[': ['beforeElement', 'push'],
        'eof': ['afterPath', 'push']
    },

    'beforeElement': {
        'ws': ['beforeElement'],
        '0': ['afterZero', 'append'],
        'number': ['inIndex', 'append'],
        "'": ['inSingleQuote', 'append', ''],
        '"': ['inDoubleQuote', 'append', '']
    },

    'afterZero': {
        'ws': ['afterElement', 'push'],
        ']': ['inPath', 'push']
    },

    'inIndex': {
        '0': ['inIndex', 'append'],
        'number': ['inIndex', 'append'],
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    },

    'inSingleQuote': {
        "'": ['afterElement'],
        'eof': ['error'],
        'else': ['inSingleQuote', 'append']
    },

    'inDoubleQuote': {
        '"': ['afterElement'],
        'eof': ['error'],
        'else': ['inDoubleQuote', 'append']
    },

    'afterElement': {
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    }
}

function noop() { }

function parsePath(path) {
    var keys = [];
    var index = -1;
    var c, newChar, key, type, transition, action, typeMap, mode = 'beforePath';

    var actions = {
        push: function () {
            if (key === undefined)
                return;

            keys.push(key);
            key = undefined;
        },

        append: function () {
            if (key === undefined)
                key = newChar
            else
                key += newChar;
        }
    };

    function maybeUnescapeQuote() {
        if (index >= path.length)
            return;

        var nextChar = path[index + 1];
        if ((mode == 'inSingleQuote' && nextChar == "'") ||
            (mode == 'inDoubleQuote' && nextChar == '"')) {
            index++;
            newChar = nextChar;
            actions.append();
            return true;
        }
    }

    while (mode) {
        index++;
        c = path[index];

        if (c == '\\' && maybeUnescapeQuote(mode))
            continue;

        type = getPathCharType(c);
        typeMap = pathStateMachine[mode];
        transition = typeMap[type] || typeMap['else'] || 'error';

        if (transition == 'error')
            return; // parse error;

        mode = transition[0];
        action = actions[transition[1]] || noop;
        newChar = transition[2] === undefined ? c : transition[2];
        action();

        if (mode === 'afterPath') {
            return keys;
        }
    }

    return; // parse error
}

function isIdent(s) {
    return identRegExp.test(s);
}

var constructorIsPrivate = {};

function Path(parts, privateToken) {
    if (privateToken !== constructorIsPrivate)
        throw Error('Use Path.get to retrieve path objects');

    for (var i = 0; i < parts.length; i++) {
        this.push(String(parts[i]));
    }

    if (hasEval && this.length) {
        this.getValueFrom = this.compiledGetValueFromFn();
    }
}

// TODO(rafaelw): Make simple LRU cache
var pathCache = {};

function getPath(pathString) {
    if (pathString instanceof Path)
        return pathString;

    if (pathString == null || pathString.length == 0)
        pathString = '';

    if (typeof pathString != 'string') {
        if (isIndex(pathString.length)) {
            // Constructed with array-like (pre-parsed) keys
            return new Path(pathString, constructorIsPrivate);
        }

        pathString = String(pathString);
    }

    var path = pathCache[pathString];
    if (path)
        return path;

    var parts = parsePath(pathString);
    if (!parts)
        return invalidPath;

    var path = new Path(parts, constructorIsPrivate);
    pathCache[pathString] = path;
    return path;
}

Path.get = getPath;

function formatAccessor(key) {
    if (isIndex(key)) {
        return '[' + key + ']';
    } else {
        return '["' + key.replace(/"/g, '\\"') + '"]';
    }
}

Path.prototype = createObject({
    __proto__: [],
    valid: true,

    toString: function () {
        var pathString = '';
        for (var i = 0; i < this.length; i++) {
            var key = this[i];
            if (isIdent(key)) {
                pathString += i ? '.' + key : key;
            } else {
                pathString += formatAccessor(key);
            }
        }

        return pathString;
    },

    getValueFrom: function (obj, directObserver) {
        for (var i = 0; i < this.length; i++) {
            if (obj == null)
                return;
            obj = obj[this[i]];
        }
        return obj;
    },

    iterateObjects: function (obj, observe) {
        for (var i = 0; i < this.length; i++) {
            if (i)
                obj = obj[this[i - 1]];
            if (!isObject(obj))
                return;
            observe(obj, this[i]);
        }
    },

    compiledGetValueFromFn: function () {
        var str = '';
        var pathString = 'obj';
        str += 'if (obj != null';
        var i = 0;
        var key;
        for (; i < (this.length - 1) ; i++) {
            key = this[i];
            pathString += isIdent(key) ? '.' + key : formatAccessor(key);
            str += ' &&\n     ' + pathString + ' != null';
        }
        str += ')\n';

        var key = this[i];
        pathString += isIdent(key) ? '.' + key : formatAccessor(key);

        str += '  return ' + pathString + ';\nelse\n  return undefined;';
        return new Function('obj', str);
    },

    setValueFrom: function (obj, value) {
        if (!this.length)
            return false;

        for (var i = 0; i < this.length - 1; i++) {
            if (!isObject(obj))
                return false;
            obj = obj[this[i]];
        }

        if (!isObject(obj))
            return false;

        obj[this[i]] = value;
        return true;
    }
});

var invalidPath = new Path('', constructorIsPrivate);
invalidPath.valid = false;
invalidPath.getValueFrom = invalidPath.setValueFrom = function () { };

exports.Path = Path;


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js":
/***/ (function(module, exports, __webpack_require__) {

﻿// Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
// This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
// The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
// The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
// Code distributed by Google as part of the polymer project is also
// subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt

var esprima = __webpack_require__("../node_modules/tns-core-modules/js-libs/esprima/esprima.js").esprima;
var Path = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js").Path;

(function (global) {
    'use strict';

    // TODO(rafaelw): Implement simple LRU.
    var expressionParseCache = Object.create(null);

    function getExpression(expressionText) {
        var expression = expressionParseCache[expressionText];
        if (!expression) {
            var delegate = new ASTDelegate();
            esprima.parse(expressionText, delegate);
            expression = new Expression(delegate);
            expressionParseCache[expressionText] = expression;
        }
        return expression;
    }

    function Literal(value) {
        this.value = value;
        this.valueFn_ = undefined;
    }

    Literal.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var value = this.value;
                this.valueFn_ = function () {
                    return value;
                }
            }

            return this.valueFn_;
        }
    }

    function IdentPath(name) {
        this.name = name;
        this.path = Path.get(name);
    }

    IdentPath.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var name = this.name;
                var path = this.path;
                this.valueFn_ = function (model, observer, changedModel) {
                    if (observer)
                        observer.addPath(model, path);

                    if (changedModel) {
                        var result = path.getValueFrom(changedModel);
                        if (result !== undefined) {
                            return result;
                        }
                    }

                    return path.getValueFrom(model);
                }
            }

            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.path.length == 1) {
                model = findScope(model, this.path[0]);
            }

            return this.path.setValueFrom(model, newValue);
        }
    };

    function MemberExpression(object, property, accessor) {
        this.computed = accessor == '[';

        this.dynamicDeps = typeof object == 'function' ||
                           object.dynamicDeps ||
                           (this.computed && !(property instanceof Literal));

        this.simplePath =
            !this.dynamicDeps &&
            (property instanceof IdentPath || property instanceof Literal) &&
            (object instanceof MemberExpression || object instanceof IdentPath);

        this.object = this.simplePath ? object : getFn(object);
        this.property = !this.computed || this.simplePath ?
            property : getFn(property);
    }

    MemberExpression.prototype = {
        get fullPath() {
            if (!this.fullPath_) {

                var parts = this.object instanceof MemberExpression ?
                    this.object.fullPath.slice() : [this.object.name];
                parts.push(this.property instanceof IdentPath ?
                    this.property.name : this.property.value);
                this.fullPath_ = Path.get(parts);
            }

            return this.fullPath_;
        },

        valueFn: function () {
            if (!this.valueFn_) {
                var object = this.object;

                if (this.simplePath) {
                    var path = this.fullPath;

                    this.valueFn_ = function (model, observer) {
                        if (observer)
                            observer.addPath(model, path);

                        return path.getValueFrom(model);
                    };
                } else if (!this.computed) {
                    var path = Path.get(this.property.name);

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);

                        if (observer)
                            observer.addPath(context, path);

                        return path.getValueFrom(context);
                    }
                } else {
                    // Computed property.
                    var property = this.property;

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);
                        var propName = property(model, observer, filterRegistry);
                        if (observer)
                            observer.addPath(context, [propName]);

                        return context ? context[propName] : undefined;
                    };
                }
            }
            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.simplePath) {
                this.fullPath.setValueFrom(model, newValue);
                return newValue;
            }

            var object = this.object(model);
            var propName = this.property instanceof IdentPath ? this.property.name :
                this.property(model);
            return object[propName] = newValue;
        }
    };

    function Filter(name, args) {
        this.name = name;
        this.args = [];
        for (var i = 0; i < args.length; i++) {
            this.args[i] = getFn(args[i]);
        }
    }

    Filter.prototype = {
        transform: function (model, observer, filterRegistry, toModelDirection,
                            initialArgs) {
            var fn = filterRegistry[this.name];
            var context = model;
            if (fn) {
                context = undefined;
            } else {
                fn = context[this.name];
                if (!fn) {
                    console.error('Cannot find function or filter: ' + this.name);
                    return;
                }
            }

            // If toModelDirection is falsey, then the "normal" (dom-bound) direction
            // is used. Otherwise, it looks for a 'toModel' property function on the
            // object.
            if (toModelDirection) {
                fn = fn.toModel;
            } else if (typeof fn.toView == 'function') {
                fn = fn.toView;
            }

            if (typeof fn != 'function') {
                console.error('Cannot find function or filter: ' + this.name);
                return;
            }

            var args = initialArgs || [];
            for (var i = 0; i < this.args.length; i++) {
                args.push(getFn(this.args[i])(model, observer, filterRegistry));
            }

            return fn.apply(context, args);
        }
    };

    function notImplemented() { throw Error('Not Implemented'); }

    var unaryOperators = {
        '+': function (v) { return +v; },
        '-': function (v) { return -v; },
        '!': function (v) { return !v; }
    };

    var binaryOperators = {
        '+': function (l, r) { return l + r; },
        '-': function (l, r) { return l - r; },
        '*': function (l, r) { return l * r; },
        '/': function (l, r) { return l / r; },
        '%': function (l, r) { return l % r; },
        '<': function (l, r) { return l < r; },
        '>': function (l, r) { return l > r; },
        '<=': function (l, r) { return l <= r; },
        '>=': function (l, r) { return l >= r; },
        '==': function (l, r) { return l == r; },
        '!=': function (l, r) { return l != r; },
        '===': function (l, r) { return l === r; },
        '!==': function (l, r) { return l !== r; },
        '&&': function (l, r) { return l && r; },
        '||': function (l, r) { return l || r; },
    };

    function getFn(arg) {
        return typeof arg == 'function' ? arg : arg.valueFn();
    }

    function ASTDelegate() {
        this.expression = null;
        this.filters = [];
        this.deps = {};
        this.currentPath = undefined;
        this.scopeIdent = undefined;
        this.indexIdent = undefined;
        this.dynamicDeps = false;
    }

    ASTDelegate.prototype = {
        createUnaryExpression: function (op, argument) {
            if (!unaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            argument = getFn(argument);

            return function (model, observer, filterRegistry) {
                return unaryOperators[op](argument(model, observer, filterRegistry));
            };
        },

        createBinaryExpression: function (op, left, right) {
            if (!binaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            left = getFn(left);
            right = getFn(right);

            switch (op) {
                case '||':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) ||
                            right(model, observer, filterRegistry);
                    };
                case '&&':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) &&
                            right(model, observer, filterRegistry);
                    };
            }

            return function (model, observer, filterRegistry) {
                return binaryOperators[op](left(model, observer, filterRegistry),
                                           right(model, observer, filterRegistry));
            };
        },

        createConditionalExpression: function (test, consequent, alternate) {
            test = getFn(test);
            consequent = getFn(consequent);
            alternate = getFn(alternate);

            this.dynamicDeps = true;

            return function (model, observer, filterRegistry) {
                return test(model, observer, filterRegistry) ?
                    consequent(model, observer, filterRegistry) :
                    alternate(model, observer, filterRegistry);
            }
        },

        createIdentifier: function (name) {
            var ident = new IdentPath(name);
            ident.type = 'Identifier';
            return ident;
        },

        createMemberExpression: function (accessor, object, property) {
            var ex = new MemberExpression(object, property, accessor);
            if (ex.dynamicDeps)
                this.dynamicDeps = true;
            return ex;
        },

        createCallExpression: function (expression, args) {
            if (!(expression instanceof IdentPath))
                throw Error('Only identifier function invocations are allowed');

            var filter = new Filter(expression.name, args);

            return function (model, observer, filterRegistry) {
                return filter.transform(model, observer, filterRegistry, false);
            };
        },

        createLiteral: function (token) {
            return new Literal(token.value);
        },

        createArrayExpression: function (elements) {
            for (var i = 0; i < elements.length; i++)
                elements[i] = getFn(elements[i]);

            return function (model, observer, filterRegistry) {
                var arr = []
                for (var i = 0; i < elements.length; i++)
                    arr.push(elements[i](model, observer, filterRegistry));
                return arr;
            }
        },

        createProperty: function (kind, key, value) {
            return {
                key: key instanceof IdentPath ? key.name : key.value,
                value: value
            };
        },

        createObjectExpression: function (properties) {
            for (var i = 0; i < properties.length; i++)
                properties[i].value = getFn(properties[i].value);

            return function (model, observer, filterRegistry) {
                var obj = {};
                for (var i = 0; i < properties.length; i++)
                    obj[properties[i].key] =
                        properties[i].value(model, observer, filterRegistry);
                return obj;
            }
        },

        createFilter: function (name, args) {
            this.filters.push(new Filter(name, args));
        },

        createAsExpression: function (expression, scopeIdent) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
        },

        createInExpression: function (scopeIdent, indexIdent, expression) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
            this.indexIdent = indexIdent;
        },

        createTopLevel: function (expression) {
            this.expression = expression;
        },

        createThisExpression: notImplemented
    }

    function Expression(delegate) {
        this.scopeIdent = delegate.scopeIdent;
        this.indexIdent = delegate.indexIdent;

        if (!delegate.expression)
            throw Error('No expression found.');

        this.expression = delegate.expression;
        getFn(this.expression); // forces enumeration of path dependencies

        this.filters = delegate.filters;
        this.dynamicDeps = delegate.dynamicDeps;
    }

    Expression.prototype = {
        getValue: function (model, isBackConvert, changedModel, observer) {
            var value = getFn(this.expression)(model.context, observer, changedModel);
            for (var i = 0; i < this.filters.length; i++) {
                value = this.filters[i].transform(model.context, observer, model.context, isBackConvert, [value]);
            }

            return value;
        },

        setValue: function (model, newValue, filterRegistry) {
            var count = this.filters ? this.filters.length : 0;
            while (count-- > 0) {
                newValue = this.filters[count].transform(model, undefined,
                    filterRegistry, true, [newValue]);
            }

            if (this.expression.setValue)
                return this.expression.setValue(model, newValue);
        }
    }

    /**
     * Converts a style property name to a css property name. For example:
     * "WebkitUserSelect" to "-webkit-user-select"
     */
    function convertStylePropertyName(name) {
        return String(name).replace(/[A-Z]/g, function (c) {
            return '-' + c.toLowerCase();
        });
    }

    var parentScopeName = '@' + Math.random().toString(36).slice(2);

    // Single ident paths must bind directly to the appropriate scope object.
    // I.e. Pushed values in two-bindings need to be assigned to the actual model
    // object.
    function findScope(model, prop) {
        while (model[parentScopeName] &&
               !Object.prototype.hasOwnProperty.call(model, prop)) {
            model = model[parentScopeName];
        }

        return model;
    }

    function isLiteralExpression(pathString) {
        switch (pathString) {
            case '':
                return false;

            case 'false':
            case 'null':
            case 'true':
                return true;
        }

        if (!isNaN(Number(pathString)))
            return true;

        return false;
    };

    function PolymerExpressions() { }

    PolymerExpressions.prototype = {
        // "built-in" filters
        styleObject: function (value) {
            var parts = [];
            for (var key in value) {
                parts.push(convertStylePropertyName(key) + ': ' + value[key]);
            }
            return parts.join('; ');
        },

        tokenList: function (value) {
            var tokens = [];
            for (var key in value) {
                if (value[key])
                    tokens.push(key);
            }
            return tokens.join(' ');
        },

        // binding delegate API
        prepareInstancePositionChanged: function (template) {
            var indexIdent = template.polymerExpressionIndexIdent_;
            if (!indexIdent)
                return;

            return function (templateInstance, index) {
                templateInstance.model[indexIdent] = index;
            };
        },

        prepareInstanceModel: function (template) {
            var scopeName = template.polymerExpressionScopeIdent_;
            if (!scopeName)
                return;

            var parentScope = template.templateInstance ?
                template.templateInstance.model :
                template.model;

            var indexName = template.polymerExpressionIndexIdent_;

            return function (model) {
                return createScopeObject(parentScope, model, scopeName, indexName);
            };
        }
    };

    var createScopeObject = ('__proto__' in {}) ?
      function (parentScope, model, scopeName, indexName) {
          var scope = {};
          scope[scopeName] = model;
          scope[indexName] = undefined;
          scope[parentScopeName] = parentScope;
          scope.__proto__ = parentScope;
          return scope;
      } :
      function (parentScope, model, scopeName, indexName) {
          var scope = Object.create(parentScope);
          Object.defineProperty(scope, scopeName,
              { value: model, configurable: true, writable: true });
          Object.defineProperty(scope, indexName,
              { value: undefined, configurable: true, writable: true });
          Object.defineProperty(scope, parentScopeName,
              { value: parentScope, configurable: true, writable: true });
          return scope;
      };

    global.PolymerExpressions = PolymerExpressions;
    PolymerExpressions.getExpression = getExpression;
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/matrix/matrix.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
exports.getTransformMatrix = function (_a) {
    var property = _a.property, value = _a.value;
    return TRANSFORM_MATRIXES[property](value);
};
var TRANSFORM_MATRIXES = {
    "scale": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            x, 0, 0,
            0, y, 0,
            0, 0, 1,
        ];
    },
    "translate": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            1, 0, x,
            0, 1, y,
            0, 0, 1,
        ];
    },
    "rotate": function (angleInDeg) {
        var angleInRad = number_utils_1.degreesToRadians(angleInDeg);
        return [
            Math.cos(angleInRad), -Math.sin(angleInRad), 0,
            Math.sin(angleInRad), Math.cos(angleInRad), 0,
            0, 0, 1,
        ];
    },
};
exports.matrixArrayToCssMatrix = function (m) { return [
    m[0], m[3], m[1],
    m[4], m[2], m[5],
]; };
function multiplyAffine2d(m1, m2) {
    return [
        m1[0] * m2[0] + m1[1] * m2[3],
        m1[0] * m2[1] + m1[1] * m2[4],
        m1[0] * m2[2] + m1[1] * m2[5] + m1[2],
        m1[3] * m2[0] + m1[4] * m2[3],
        m1[3] * m2[1] + m1[4] * m2[4],
        m1[3] * m2[2] + m1[4] * m2[5] + m1[5]
    ];
}
exports.multiplyAffine2d = multiplyAffine2d;
function decompose2DTransformMatrix(matrix) {
    verifyTransformMatrix(matrix);
    var _a = __spreadArrays(matrix), A = _a[0], B = _a[1], C = _a[2], D = _a[3], E = _a[4], F = _a[5];
    var determinant = A * D - B * C;
    var translate = { x: E || 0, y: F || 0 };
    var rotate = 0;
    var scale = { x: 1, y: 1 };
    if (A || B) {
        var R = Math.sqrt(A * A + B * B);
        rotate = B > 0 ? Math.acos(A / R) : -Math.acos(A / R);
        scale = { x: R, y: determinant / R };
    }
    else if (C || D) {
        var R = Math.sqrt(C * C + D * D);
        rotate = Math.PI / 2 - (D > 0 ? Math.acos(-C / R) : -Math.acos(C / R));
        scale = { x: determinant / R, y: R };
    }
    rotate = number_utils_1.radiansToDegrees(rotate);
    return { translate: translate, rotate: rotate, scale: scale };
}
exports.decompose2DTransformMatrix = decompose2DTransformMatrix;
function verifyTransformMatrix(matrix) {
    if (matrix.length < 6) {
        throw new Error("Transform matrix should be 2x3.");
    }
}
//# sourceMappingURL=matrix.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var qualifier_matcher_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js");
var non_bundle_workflow_compat_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var ModuleNameResolver = (function () {
    function ModuleNameResolver(context, moduleListProvider) {
        if (moduleListProvider === void 0) { moduleListProvider = global.getRegisteredModules; }
        this.context = context;
        this.moduleListProvider = moduleListProvider;
        this._cache = {};
    }
    ModuleNameResolver.prototype.resolveModuleName = function (path, ext) {
        var key = path + ext;
        var result = this._cache[key];
        if (result === undefined) {
            result = this.resolveModuleNameImpl(path, ext);
            this._cache[key] = result;
        }
        if (trace_1.isEnabled()) {
            trace_1.write("path: '" + path + "' with ext: '" + ext + "' resolved: '" + result + "'", trace_1.categories.ModuleNameResolver);
        }
        return result;
    };
    ModuleNameResolver.prototype.clearCache = function () {
        this._cache = {};
    };
    ModuleNameResolver.prototype.resolveModuleNameImpl = function (path, ext) {
        var result = null;
        ext = ext ? "." + ext : "";
        if (false) {}
        var candidates = this.getCandidates(path, ext);
        result = qualifier_matcher_1.findMatch(path, ext, candidates, this.context);
        return result;
    };
    ModuleNameResolver.prototype.getCandidates = function (path, ext) {
        var candidates = this.moduleListProvider()
            .filter(function (moduleName) { return moduleName.startsWith(path) && (!ext || moduleName.endsWith(ext)); });
        return candidates;
    };
    return ModuleNameResolver;
}());
exports.ModuleNameResolver = ModuleNameResolver;
var resolverInstance;
function resolveModuleName(path, ext) {
    if (global.__snapshot) {
        return resolveModuleSnapshot(path, ext);
    }
    if (!resolverInstance) {
        resolverInstance = new ModuleNameResolver({
            width: platform_1.screen.mainScreen.widthDIPs,
            height: platform_1.screen.mainScreen.heightDIPs,
            os: platform_1.device.os,
            deviceType: platform_1.device.deviceType
        });
    }
    return resolverInstance.resolveModuleName(path, ext);
}
exports.resolveModuleName = resolveModuleName;
function resolveModuleSnapshot(path, ext) {
    trace_1.write("Resolving module in SNAPSHOT context - path: '" + path + "' with ext: '" + ext + "'", trace_1.categories.ModuleNameResolver);
    return new ModuleNameResolver({
        width: 400,
        height: 800,
        os: "Android",
        deviceType: "Phone"
    }).resolveModuleName(path, ext);
}
function clearCache() {
    if (resolverInstance) {
        resolverInstance.clearCache();
    }
}
exports.clearCache = clearCache;
function _setResolver(resolver) {
    resolverInstance = resolver;
}
exports._setResolver = _setResolver;
appCommonModule.on("livesync", function (args) { return clearCache(); });
appCommonModule.on("orientationChanged", function (args) {
    resolverInstance = undefined;
});
//# sourceMappingURL=module-name-resolver.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var cache = new Set();
var initialized = false;
function register(name, loader) {
    if (trace_1.isEnabled()) {
        trace_1.write("[Compat] Register module: " + name, trace_1.categories.ModuleNameResolver);
    }
    global.registerModule(name, loader);
    if (name.startsWith("tns_modules")) {
        var nonTnsModulesName = name.substr("tns_modules".length + 1);
        if (trace_1.isEnabled()) {
            trace_1.write("[Compat] Register module: " + nonTnsModulesName, trace_1.categories.ModuleNameResolver);
        }
        global.registerModule(nonTnsModulesName, loader);
    }
}
function processFile(file) {
    var filePathRelativeToApp = file.path.substr(fs.knownFolders.currentApp().path.length + 1);
    var loadContent = function () { return file.readTextSync(); };
    switch (file.extension.toLocaleLowerCase()) {
        case ".js":
            var noExtPath = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - ".js".length);
            register(filePathRelativeToApp, function () { return global.require(file.path); });
            register(noExtPath, function () { return global.require(file.path); });
            break;
        case ".css":
            register(filePathRelativeToApp, loadContent);
            break;
        case ".xml":
            register(filePathRelativeToApp, loadContent);
            break;
    }
    if (file.name === "package.json") {
        var json = global.require(file.path);
        if (json.main) {
            var name_1 = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - "package.json".length - 1);
            var requirePath_1 = fs.path.join(file.parent.path, json.main);
            register(name_1, function () { return global.require(requirePath_1); });
        }
    }
}
function processFolder(path) {
    if (cache.has(path)) {
        return true;
    }
    cache.add(path);
    if (trace_1.isEnabled()) {
        trace_1.write("[Compat] Processing folder: " + path, trace_1.categories.ModuleNameResolver);
    }
    var folderEmpty = true;
    if (fs.Folder.exists(path)) {
        var folder = fs.Folder.fromPath(path);
        folder.eachEntity(function (file) {
            if (file instanceof fs.File) {
                processFile(file);
                folderEmpty = false;
            }
            return true;
        });
    }
    return !folderEmpty;
}
function registerModulesFromFileSystem(moduleName) {
    initialize();
    var folderProcessed = false;
    var parentFolderProcessed = false;
    var path = fs.path.join(fs.knownFolders.currentApp().path, moduleName);
    if (fs.Folder.exists(path)) {
        folderProcessed = processFolder(path);
    }
    var parentName = moduleName.substr(0, moduleName.lastIndexOf(fs.path.separator));
    var parentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, parentName);
    if (fs.Folder.exists(parentFolderPath)) {
        parentFolderProcessed = processFolder(parentFolderPath);
    }
    if (folderProcessed || (parentFolderProcessed && parentName)) {
        return;
    }
    var tnsModulesPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", moduleName);
    if (fs.Folder.exists(tnsModulesPath)) {
        processFolder(tnsModulesPath);
    }
    if (parentName) {
        var tnsParentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", parentName);
        if (fs.Folder.exists(tnsParentFolderPath)) {
            processFolder(tnsParentFolderPath);
        }
    }
}
exports.registerModulesFromFileSystem = registerModulesFromFileSystem;
function initialize() {
    if (!initialized) {
        appCommonModule.on("livesync", function (args) { return cache.clear(); });
        initialized = true;
    }
}
//# sourceMappingURL=non-bundle-workflow-compat.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MIN_WH = "minWH";
var MIN_W = "minW";
var MIN_H = "minH";
var PRIORITY_STEP = 10000;
var minWidthHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_WH) === 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_WH.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualLength = Math.min(context.width, context.height);
        if (actualLength < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualLength - numVal);
    }
};
var minWidthQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_W) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_W.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualWidth = context.width;
        if (actualWidth < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualWidth - numVal);
    }
};
var minHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_H) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_H.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualHeight = context.height;
        if (actualHeight < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualHeight - numVal);
    }
};
var platformQualifier = {
    isMatch: function (value) {
        return value === "android" ||
            value === "ios";
    },
    getMatchValue: function (value, context) {
        return value === context.os.toLowerCase() ? 1 : -1;
    }
};
var orientationQualifier = {
    isMatch: function (value) {
        return value === "land" ||
            value === "port";
    },
    getMatchValue: function (value, context) {
        var isLandscape = (context.width > context.height) ? 1 : -1;
        return (value === "land") ? isLandscape : -isLandscape;
    }
};
var supportedQualifiers = [
    minWidthHeightQualifier,
    minWidthQualifier,
    minHeightQualifier,
    orientationQualifier,
    platformQualifier
];
function checkQualifiers(qualifiers, context) {
    var result = 0;
    var value;
    for (var i = 0; i < qualifiers.length; i++) {
        if (qualifiers[i]) {
            value = checkQualifier(qualifiers[i], context);
            if (value < 0) {
                return -1;
            }
            result += value;
        }
    }
    return result;
}
function checkQualifier(value, context) {
    var result;
    for (var i = 0; i < supportedQualifiers.length; i++) {
        if (supportedQualifiers[i].isMatch(value)) {
            result = supportedQualifiers[i].getMatchValue(value, context);
            if (result > 0) {
                result += (supportedQualifiers.length - i) * PRIORITY_STEP;
            }
            return result;
        }
    }
    return -1;
}
function findMatch(path, ext, candidates, context) {
    var bestValue = -1;
    var result = null;
    for (var i = 0; i < candidates.length; i++) {
        var filePath = candidates[i];
        var qualifiersStr = filePath.substr(path.length, filePath.length - path.length - (ext ? ext.length : 0));
        var qualifiers = qualifiersStr.split(".");
        var value = checkQualifiers(qualifiers, context);
        if (value >= 0 && value > bestValue) {
            bestValue = value;
            result = candidates[i];
        }
    }
    return result;
}
exports.findMatch = findMatch;
//# sourceMappingURL=qualifier-matcher.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/platform/platform.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var appModule = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var MIN_TABLET_PIXELS = 600;
var platformNames;
(function (platformNames) {
    platformNames.android = "Android";
    platformNames.ios = "iOS";
})(platformNames = exports.platformNames || (exports.platformNames = {}));
var Device = (function () {
    function Device() {
    }
    Object.defineProperty(Device.prototype, "manufacturer", {
        get: function () {
            if (!this._manufacturer) {
                this._manufacturer = android.os.Build.MANUFACTURER;
            }
            return this._manufacturer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "os", {
        get: function () {
            return platformNames.android;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "osVersion", {
        get: function () {
            if (!this._osVersion) {
                this._osVersion = android.os.Build.VERSION.RELEASE;
            }
            return this._osVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "model", {
        get: function () {
            if (!this._model) {
                this._model = android.os.Build.MODEL;
            }
            return this._model;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "sdkVersion", {
        get: function () {
            if (!this._sdkVersion) {
                this._sdkVersion = android.os.Build.VERSION.SDK;
            }
            return this._sdkVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "deviceType", {
        get: function () {
            if (!this._deviceType) {
                var dips = Math.min(screen.mainScreen.widthPixels, screen.mainScreen.heightPixels) / screen.mainScreen.scale;
                if (dips >= MIN_TABLET_PIXELS) {
                    this._deviceType = "Tablet";
                }
                else {
                    this._deviceType = "Phone";
                }
            }
            return this._deviceType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "uuid", {
        get: function () {
            if (!this._uuid) {
                var nativeApp = appModule.android.nativeApp;
                this._uuid = android.provider.Settings.Secure.getString(nativeApp.getContentResolver(), android.provider.Settings.Secure.ANDROID_ID);
            }
            return this._uuid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "language", {
        get: function () {
            if (!this._language) {
                this._language = java.util.Locale.getDefault().getLanguage().replace("_", "-");
            }
            return this._language;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "region", {
        get: function () {
            if (!this._region) {
                this._region = java.util.Locale.getDefault().getCountry();
            }
            return this._region;
        },
        enumerable: true,
        configurable: true
    });
    return Device;
}());
var MainScreen = (function () {
    function MainScreen() {
    }
    MainScreen.prototype.reinitMetrics = function () {
        if (!this._metrics) {
            this._metrics = new android.util.DisplayMetrics();
        }
        this.initMetrics();
    };
    MainScreen.prototype.initMetrics = function () {
        var nativeApp = appModule.getNativeApplication();
        nativeApp.getSystemService(android.content.Context.WINDOW_SERVICE).getDefaultDisplay().getRealMetrics(this._metrics);
    };
    Object.defineProperty(MainScreen.prototype, "metrics", {
        get: function () {
            if (!this._metrics) {
                appModule.on("cssChanged", this.reinitMetrics, this);
                appModule.on(appModule.orientationChangedEvent, this.reinitMetrics, this);
                this._metrics = new android.util.DisplayMetrics();
                this.initMetrics();
            }
            return this._metrics;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthPixels", {
        get: function () {
            return this.metrics.widthPixels;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightPixels", {
        get: function () {
            return this.metrics.heightPixels;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "scale", {
        get: function () {
            return this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthDIPs", {
        get: function () {
            return this.metrics.widthPixels / this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightDIPs", {
        get: function () {
            return this.metrics.heightPixels / this.metrics.density;
        },
        enumerable: true,
        configurable: true
    });
    return MainScreen;
}());
exports.device = new Device();
var screen;
(function (screen) {
    screen.mainScreen = new MainScreen();
})(screen = exports.screen || (exports.screen = {}));
exports.isAndroid = true;
exports.isIOS = false;
//# sourceMappingURL=platform.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/profiling/profiling.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function uptime() {
    return global.android ? org.nativescript.Process.getUpTime() : global.__tns_uptime();
}
exports.uptime = uptime;
function log(message) {
    if (global.__nslog) {
        global.__nslog("CONSOLE LOG: " + message);
    }
    console.log(message);
}
exports.log = log;
var timers = {};
var anyGlobal = global;
var profileNames = [];
exports.time = global.__time || Date.now;
function start(name) {
    var info = timers[name];
    if (info) {
        info.currentStart = exports.time();
        info.runCount++;
    }
    else {
        info = {
            totalTime: 0,
            count: 0,
            currentStart: exports.time(),
            runCount: 1
        };
        timers[name] = info;
        profileNames.push(name);
    }
}
exports.start = start;
function stop(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    if (info.runCount) {
        info.runCount--;
        if (info.runCount) {
            info.count++;
        }
        else {
            info.lastTime = exports.time() - info.currentStart;
            info.totalTime += info.lastTime;
            info.count++;
            info.currentStart = 0;
        }
    }
    else {
        throw new Error("Timer " + name + " paused more times than started.");
    }
    return info;
}
exports.stop = stop;
function timer(name) {
    return timers[name];
}
exports.timer = timer;
function print(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
    return info;
}
exports.print = print;
function isRunning(name) {
    var info = timers[name];
    return !!(info && info.runCount);
}
exports.isRunning = isRunning;
function countersProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    profileNames.push(name);
    return function () {
        start(name);
        try {
            return fn.apply(this, arguments);
        }
        finally {
            stop(name);
        }
    };
}
function timelineProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    return type === 1 ? function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + " " + this + "  (" + start + "ms. - " + end + "ms.)");
        }
    } : function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + "  (" + start + "ms. - " + end + "ms.)");
        }
    };
}
var Level;
(function (Level) {
    Level[Level["none"] = 0] = "none";
    Level[Level["lifecycle"] = 1] = "lifecycle";
    Level[Level["timeline"] = 2] = "timeline";
})(Level = exports.Level || (exports.Level = {}));
var tracingLevel = Level.none;
var profileFunctionFactory;
function enable(mode) {
    if (mode === void 0) { mode = "counters"; }
    profileFunctionFactory = mode && {
        counters: countersProfileFunctionFactory,
        timeline: timelineProfileFunctionFactory
    }[mode];
    tracingLevel = {
        lifecycle: Level.lifecycle,
        timeline: Level.timeline,
    }[mode] || Level.none;
}
exports.enable = enable;
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.profiling) {
        enable(appConfig.profiling);
    }
}
catch (e1) {
    try {
        console.log("Profiling startup failed to figure out defaults from package.json, error: " + e1);
    }
    catch (e2) {
    }
}
function disable() {
    profileFunctionFactory = undefined;
}
exports.disable = disable;
function profileFunction(fn, customName) {
    return profileFunctionFactory(fn, customName || fn.name);
}
var profileMethodUnnamed = function (target, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(target, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (target && target.constructor && target.constructor.name) {
        className = target.constructor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 1);
    return descriptor;
};
var profileStaticMethodUnnamed = function (ctor, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(ctor, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (ctor && ctor.name) {
        className = ctor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 0);
    return descriptor;
};
function profileMethodNamed(name) {
    return function (target, key, descriptor) {
        if (descriptor === undefined) {
            descriptor = Object.getOwnPropertyDescriptor(target, key);
        }
        var originalMethod = descriptor.value;
        descriptor.value = profileFunctionFactory(originalMethod, name);
        return descriptor;
    };
}
var voidMethodDecorator = function () {
};
function profile(nameFnOrTarget, fnOrKey, descriptor) {
    if (typeof nameFnOrTarget === "object" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "function" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileStaticMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "string" && typeof fnOrKey === "function") {
        if (!profileFunctionFactory) {
            return fnOrKey;
        }
        return profileFunction(fnOrKey, nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "function") {
        if (!profileFunctionFactory) {
            return nameFnOrTarget;
        }
        return profileFunction(nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "string") {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodNamed(nameFnOrTarget);
    }
    else {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodUnnamed;
    }
}
exports.profile = profile;
function dumpProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
        }
        else {
            console.log("---- [" + name + "] Never called");
        }
    });
}
exports.dumpProfiles = dumpProfiles;
function resetProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            if (info.runCount) {
                console.log("---- timer with name [" + name + "] is currently running and won't be reset");
            }
            else {
                timers[name] = undefined;
            }
        }
    });
}
exports.resetProfiles = resetProfiles;
function startCPUProfile(name) {
    if (anyGlobal.android) {
        __startCPUProfiler(name);
    }
}
exports.startCPUProfile = startCPUProfile;
function stopCPUProfile(name) {
    if (anyGlobal.android) {
        __stopCPUProfiler(name);
    }
}
exports.stopCPUProfile = stopCPUProfile;
function level() {
    return tracingLevel;
}
exports.level = level;
function trace(message, start, end) {
    log("Timeline: Modules: " + message + "  (" + start + "ms. - " + end + "ms.)");
}
exports.trace = trace;
//# sourceMappingURL=profiling.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/text/formatted-string.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var span_1 = __webpack_require__("../node_modules/tns-core-modules/text/span.js");
exports.Span = span_1.Span;
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.spans = "spans";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var FormattedString = (function (_super) {
    __extends(FormattedString, _super);
    function FormattedString() {
        var _this = _super.call(this) || this;
        _this._spans = new observable_array_1.ObservableArray();
        _this._spans.addEventListener(observable_array_1.ObservableArray.changeEvent, _this.onSpansCollectionChanged, _this);
        return _this;
    }
    Object.defineProperty(FormattedString.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "spans", {
        get: function () {
            if (!this._spans) {
                this._spans = new observable_array_1.ObservableArray();
            }
            return this._spans;
        },
        enumerable: true,
        configurable: true
    });
    FormattedString.prototype.toString = function () {
        var result = "";
        for (var i = 0, length_1 = this._spans.length; i < length_1; i++) {
            result += this._spans.getItem(i).text;
        }
        return result;
    };
    FormattedString.prototype._addArrayFromBuilder = function (name, value) {
        if (name === knownCollections.spans) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof span_1.Span) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype.onSpansCollectionChanged = function (eventData) {
        if (eventData.addedCount > 0) {
            for (var i = 0; i < eventData.addedCount; i++) {
                var span = eventData.object.getItem(eventData.index + i);
                this._addView(span);
                this.addPropertyChangeHandler(span);
            }
        }
        if (eventData.removed && eventData.removed.length > 0) {
            for (var p = 0; p < eventData.removed.length; p++) {
                var span = eventData.removed[p];
                this.removePropertyChangeHandler(span);
                this._removeView(span);
            }
        }
        this.notifyPropertyChange(".", this);
    };
    FormattedString.prototype.addPropertyChangeHandler = function (span) {
        var style = span.style;
        span.on(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.on("fontFamilyChange", this.onPropertyChange, this);
        style.on("fontSizeChange", this.onPropertyChange, this);
        style.on("fontStyleChange", this.onPropertyChange, this);
        style.on("fontWeightChange", this.onPropertyChange, this);
        style.on("textDecorationChange", this.onPropertyChange, this);
        style.on("colorChange", this.onPropertyChange, this);
        style.on("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.removePropertyChangeHandler = function (span) {
        var style = span.style;
        span.off(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.off("fontFamilyChange", this.onPropertyChange, this);
        style.off("fontSizeChange", this.onPropertyChange, this);
        style.off("fontStyleChange", this.onPropertyChange, this);
        style.off("fontWeightChange", this.onPropertyChange, this);
        style.off("textDecorationChange", this.onPropertyChange, this);
        style.off("colorChange", this.onPropertyChange, this);
        style.off("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.onPropertyChange = function (data) {
        this.notifyPropertyChange(data.propertyName, this);
    };
    FormattedString.prototype.eachChild = function (callback) {
        this.spans.forEach(function (v, i, arr) { return callback(v); });
    };
    return FormattedString;
}(view_1.ViewBase));
exports.FormattedString = FormattedString;
//# sourceMappingURL=formatted-string.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/span.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Span = (function (_super) {
    __extends(Span, _super);
    function Span() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Span.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "text", {
        get: function () {
            return this._text;
        },
        set: function (value) {
            if (this._text !== value) {
                this._text = value;
                this.notifyPropertyChange("text", value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Span.prototype._setTextInternal = function (value) {
        this._text = value;
    };
    return Span;
}(view_1.ViewBase));
exports.Span = Span;
//# sourceMappingURL=span.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/text.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var encoding;
(function (encoding) {
    encoding.ISO_8859_1 = "ISO-8859-1";
    encoding.US_ASCII = "US-ASCII";
    encoding.UTF_16 = "UTF-16";
    encoding.UTF_16BE = "UTF-16BE";
    encoding.UTF_16LE = "UTF-16LE";
    encoding.UTF_8 = "UTF-8";
})(encoding = exports.encoding || (exports.encoding = {}));
//# sourceMappingURL=text.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/timer/timer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var timeoutHandler;
var timeoutCallbacks = {};
var timerId = 0;
function createHandlerAndGetId() {
    if (!timeoutHandler) {
        timeoutHandler = new android.os.Handler(android.os.Looper.myLooper());
    }
    timerId++;
    return timerId;
}
function setTimeout(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    milliseconds += 0;
    var id = createHandlerAndGetId();
    var invoke = function () { return callback.apply(void 0, args); };
    var zoneBound = zonedCallback(invoke);
    var runnable = new java.lang.Runnable({
        run: function () {
            zoneBound();
            if (timeoutCallbacks[id]) {
                delete timeoutCallbacks[id];
            }
        }
    });
    if (!timeoutCallbacks[id]) {
        timeoutCallbacks[id] = runnable;
    }
    timeoutHandler.postDelayed(runnable, long(milliseconds));
    return id;
}
exports.setTimeout = setTimeout;
function clearTimeout(id) {
    var index = id;
    if (timeoutCallbacks[index]) {
        timeoutHandler.removeCallbacks(timeoutCallbacks[index]);
        delete timeoutCallbacks[index];
    }
}
exports.clearTimeout = clearTimeout;
function setInterval(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    milliseconds += 0;
    var id = createHandlerAndGetId();
    var handler = timeoutHandler;
    var invoke = function () { return callback.apply(void 0, args); };
    var zoneBound = zonedCallback(invoke);
    var runnable = new java.lang.Runnable({
        run: function () {
            zoneBound();
            if (timeoutCallbacks[id]) {
                handler.postDelayed(runnable, long(milliseconds));
            }
        }
    });
    if (!timeoutCallbacks[id]) {
        timeoutCallbacks[id] = runnable;
    }
    timeoutHandler.postDelayed(runnable, long(milliseconds));
    return id;
}
exports.setInterval = setInterval;
exports.clearInterval = clearTimeout;
//# sourceMappingURL=timer.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/trace/trace.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var enabled = false;
var _categories = {};
var _writers = [];
var _eventListeners = [];
var _errorHandler;
function enable() {
    enabled = true;
}
exports.enable = enable;
function disable() {
    enabled = false;
}
exports.disable = disable;
function isEnabled() {
    return enabled;
}
exports.isEnabled = isEnabled;
function isCategorySet(category) {
    return category in _categories;
}
exports.isCategorySet = isCategorySet;
function addWriter(writer) {
    _writers.push(writer);
}
exports.addWriter = addWriter;
function removeWriter(writer) {
    var index = _writers.indexOf(writer);
    if (index >= 0) {
        _writers.splice(index, 1);
    }
}
exports.removeWriter = removeWriter;
function clearWriters() {
    if (_writers.length > 0) {
        _writers.splice(0, _writers.length);
    }
}
exports.clearWriters = clearWriters;
function setCategories(categories) {
    _categories = {};
    addCategories(categories);
}
exports.setCategories = setCategories;
function addCategories(categories) {
    var split = categories.split(",");
    for (var i = 0; i < split.length; i++) {
        _categories[split[i].trim()] = true;
    }
}
exports.addCategories = addCategories;
function write(message, category, type) {
    var i;
    if (type === messageType.error) {
        for (i = 0; i < _writers.length; i++) {
            _writers[i].write(message, category, type);
        }
        return;
    }
    if (!enabled) {
        return;
    }
    if (!(category in _categories)) {
        return;
    }
    for (i = 0; i < _writers.length; i++) {
        _writers[i].write(message, category, type);
    }
}
exports.write = write;
function notifyEvent(object, name, data) {
    if (!enabled) {
        return;
    }
    var i, listener, filters;
    for (i = 0; i < _eventListeners.length; i++) {
        listener = _eventListeners[i];
        if (listener.filter) {
            filters = listener.filter.split(",");
            filters.forEach(function (value) {
                if (value.trim() === name) {
                    listener.on(object, name, data);
                }
            });
        }
        else {
            listener.on(object, name, data);
        }
    }
}
exports.notifyEvent = notifyEvent;
function addEventListener(listener) {
    _eventListeners.push(listener);
}
exports.addEventListener = addEventListener;
function removeEventListener(listener) {
    var index = _eventListeners.indexOf(listener);
    if (index >= 0) {
        _eventListeners.splice(index, 1);
    }
}
exports.removeEventListener = removeEventListener;
var messageType;
(function (messageType) {
    messageType.log = 0;
    messageType.info = 1;
    messageType.warn = 2;
    messageType.error = 3;
})(messageType = exports.messageType || (exports.messageType = {}));
var categories;
(function (categories) {
    categories.VisualTreeEvents = "VisualTreeEvents";
    categories.Layout = "Layout";
    categories.Style = "Style";
    categories.ViewHierarchy = "ViewHierarchy";
    categories.NativeLifecycle = "NativeLifecycle";
    categories.Debug = "Debug";
    categories.Navigation = "Navigation";
    categories.Test = "Test";
    categories.Binding = "Binding";
    categories.BindingError = "BindingError";
    categories.Error = "Error";
    categories.Animation = "Animation";
    categories.Transition = "Transition";
    categories.Livesync = "Livesync";
    categories.ModuleNameResolver = "ModuleNameResolver";
    categories.separator = ",";
    categories.All = [
        categories.VisualTreeEvents, categories.Layout, categories.Style,
        categories.ViewHierarchy, categories.NativeLifecycle,
        categories.Debug, categories.Navigation, categories.Test, categories.Binding,
        categories.Error, categories.Animation, categories.Transition, categories.Livesync,
        categories.ModuleNameResolver
    ]
        .join(categories.separator);
    function concat() {
        var result;
        for (var i = 0; i < arguments.length; i++) {
            if (!result) {
                result = arguments[i];
                continue;
            }
            result = result.concat(categories.separator, arguments[i]);
        }
        return result;
    }
    categories.concat = concat;
})(categories = exports.categories || (exports.categories = {}));
var ConsoleWriter = (function () {
    function ConsoleWriter() {
    }
    ConsoleWriter.prototype.write = function (message, category, type) {
        if (!console) {
            return;
        }
        var msgType;
        if (type === undefined) {
            msgType = messageType.log;
        }
        else {
            msgType = type;
        }
        switch (msgType) {
            case messageType.log:
                console.log(category + ": " + message);
                break;
            case messageType.info:
                console.info(category + ": " + message);
                break;
            case messageType.warn:
                console.warn(category + ": " + message);
                break;
            case messageType.error:
                console.error(category + ": " + message);
                break;
        }
    };
    return ConsoleWriter;
}());
addWriter(new ConsoleWriter());
var DefaultErrorHandler = (function () {
    function DefaultErrorHandler() {
    }
    DefaultErrorHandler.prototype.handlerError = function (error) {
        throw error;
    };
    return DefaultErrorHandler;
}());
exports.DefaultErrorHandler = DefaultErrorHandler;
setErrorHandler(new DefaultErrorHandler());
function getErrorHandler() {
    return _errorHandler;
}
exports.getErrorHandler = getErrorHandler;
function setErrorHandler(handler) {
    _errorHandler = handler;
}
exports.setErrorHandler = setErrorHandler;
function error(error) {
    if (!_errorHandler) {
        return;
    }
    if (typeof error === "string") {
        error = new Error(error);
    }
    _errorHandler.handlerError(error);
}
exports.error = error;
//# sourceMappingURL=trace.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.actionItems = "actionItems";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var ActionBarBase = (function (_super) {
    __extends(ActionBarBase, _super);
    function ActionBarBase() {
        var _this = _super.call(this) || this;
        _this._actionItems = new ActionItems(_this);
        return _this;
    }
    Object.defineProperty(ActionBarBase.prototype, "navigationButton", {
        get: function () {
            return this._navigationButton;
        },
        set: function (value) {
            if (this._navigationButton !== value) {
                if (this._navigationButton) {
                    this._removeView(this._navigationButton);
                    this._navigationButton.actionBar = undefined;
                }
                this._navigationButton = value;
                if (this._navigationButton) {
                    this._navigationButton.actionBar = this;
                    this._addView(this._navigationButton);
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "actionItems", {
        get: function () {
            return this._actionItems;
        },
        set: function (value) {
            throw new Error("actionItems property is read-only");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "titleView", {
        get: function () {
            return this._titleView;
        },
        set: function (value) {
            if (this._titleView !== value) {
                if (this._titleView) {
                    this._removeView(this._titleView);
                    this._titleView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._titleView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                }
                this._titleView = value;
                if (value) {
                    this._addView(value);
                    var style = value.style;
                    if (!view_1.horizontalAlignmentProperty.isSet(style)) {
                        style[view_1.horizontalAlignmentProperty.cssName] = "center";
                    }
                    if (!view_1.verticalAlignmentProperty.isSet(style)) {
                        style[view_1.verticalAlignmentProperty.cssName] = "middle";
                    }
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "_childrenCount", {
        get: function () {
            var actionViewsCount = 0;
            this._actionItems.getItems().forEach(function (actionItem) {
                if (actionItem.actionView) {
                    actionViewsCount++;
                }
            });
            return actionViewsCount + (this.titleView ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    ActionBarBase.prototype.update = function () {
    };
    ActionBarBase.prototype._onTitlePropertyChanged = function () {
    };
    ActionBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "actionItems") {
            this.actionItems.setItems(value);
        }
    };
    ActionBarBase.prototype.eachChildView = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
    };
    ActionBarBase.prototype.eachChild = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
        var navigationButton = this._navigationButton;
        if (navigationButton) {
            callback(navigationButton);
        }
        this.actionItems.getItems().forEach(function (actionItem) {
            callback(actionItem);
        });
    };
    ActionBarBase.prototype._isEmpty = function () {
        if (this.title ||
            this.titleView ||
            (this.android && this.android.icon) ||
            this.navigationButton ||
            this.actionItems.getItems().length > 0) {
            return false;
        }
        return true;
    };
    ActionBarBase = __decorate([
        view_1.CSSType("ActionBar")
    ], ActionBarBase);
    return ActionBarBase;
}(view_1.View));
exports.ActionBarBase = ActionBarBase;
var ActionItems = (function () {
    function ActionItems(actionBar) {
        this._items = new Array();
        this._actionBar = actionBar;
    }
    ActionItems.prototype.addItem = function (item) {
        if (!item) {
            throw new Error("Cannot add empty item");
        }
        this._items.push(item);
        item.actionBar = this._actionBar;
        this._actionBar._addView(item);
        this.invalidate();
    };
    ActionItems.prototype.removeItem = function (item) {
        if (!item) {
            throw new Error("Cannot remove empty item");
        }
        var itemIndex = this._items.indexOf(item);
        if (itemIndex < 0) {
            throw new Error("Cannot find item to remove");
        }
        this._items.splice(itemIndex, 1);
        this._actionBar._removeView(item);
        item.actionBar = undefined;
        this.invalidate();
    };
    ActionItems.prototype.getItems = function () {
        return this._items.slice();
    };
    ActionItems.prototype.getVisibleItems = function () {
        var visibleItems = [];
        this._items.forEach(function (item) {
            if (isVisible(item)) {
                visibleItems.push(item);
            }
        });
        return visibleItems;
    };
    ActionItems.prototype.getItemAt = function (index) {
        if (index < 0 || index >= this._items.length) {
            return undefined;
        }
        return this._items[index];
    };
    ActionItems.prototype.setItems = function (items) {
        while (this._items.length > 0) {
            this.removeItem(this._items[this._items.length - 1]);
        }
        for (var i = 0; i < items.length; i++) {
            this.addItem(items[i]);
        }
        this.invalidate();
    };
    ActionItems.prototype.invalidate = function () {
        if (this._actionBar) {
            this._actionBar.update();
        }
    };
    return ActionItems;
}());
exports.ActionItems = ActionItems;
var ActionItemBase = (function (_super) {
    __extends(ActionItemBase, _super);
    function ActionItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ActionItemBase.prototype, "actionView", {
        get: function () {
            return this._actionView;
        },
        set: function (value) {
            if (this._actionView !== value) {
                if (this._actionView) {
                    this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._actionView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._removeView(this._actionView);
                }
                this._actionView = value;
                if (this._actionView) {
                    this._addView(this._actionView);
                }
                if (this._actionBar) {
                    this._actionBar.update();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionItemBase.prototype, "actionBar", {
        get: function () {
            return this._actionBar;
        },
        set: function (value) {
            if (value !== this._actionBar) {
                this._actionBar = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    ActionItemBase.prototype.onLoaded = function () {
        if (this._actionView) {
            this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = "center";
            this._actionView.style[view_1.verticalAlignmentProperty.cssName] = "middle";
        }
        _super.prototype.onLoaded.call(this);
    };
    ActionItemBase.prototype._raiseTap = function () {
        this._emit(ActionItemBase.tapEvent);
    };
    ActionItemBase.prototype._addChildFromBuilder = function (name, value) {
        this.actionView = value;
    };
    ActionItemBase.prototype._onVisibilityChanged = function (visibility) {
        if (this.actionBar) {
            this.actionBar.update();
        }
    };
    ActionItemBase.prototype.eachChild = function (callback) {
        if (this._actionView) {
            callback(this._actionView);
        }
    };
    ActionItemBase.tapEvent = "tap";
    __decorate([
        profiling_1.profile
    ], ActionItemBase.prototype, "onLoaded", null);
    return ActionItemBase;
}(view_1.ViewBase));
exports.ActionItemBase = ActionItemBase;
function isVisible(item) {
    return item.visibility === "visible";
}
exports.isVisible = isVisible;
function onTitlePropertyChanged(actionBar, oldValue, newValue) {
    actionBar._onTitlePropertyChanged();
}
exports.titleProperty = new view_1.Property({ name: "title", valueChanged: onTitlePropertyChanged });
exports.titleProperty.register(ActionBarBase);
function onItemChanged(item, oldValue, newValue) {
    if (item.actionBar) {
        item.actionBar.update();
    }
}
function onVisibilityChanged(item, oldValue, newValue) {
    item._onVisibilityChanged(newValue);
}
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load action bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "alwaysOriginal" });
exports.iosIconRenderingModeProperty.register(ActionBarBase);
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", valueChanged: onItemChanged });
exports.textProperty.register(ActionItemBase);
exports.iconProperty = new view_1.Property({ name: "icon", valueChanged: onItemChanged });
exports.iconProperty.register(ActionItemBase);
exports.visibilityProperty = new view_1.Property({ name: "visibility", defaultValue: "visible", valueChanged: onVisibilityChanged });
exports.visibilityProperty.register(ActionItemBase);
exports.flatProperty = new view_1.Property({ name: "flat", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.flatProperty.register(ActionBarBase);
//# sourceMappingURL=action-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var action_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js"));
var R_ID_HOME = 0x0102002c;
var ACTION_ITEM_ID_OFFSET = 10000;
var DEFAULT_ELEVATION = 4;
var AppCompatTextView;
var actionItemIdGenerator = ACTION_ITEM_ID_OFFSET;
function generateItemId() {
    actionItemIdGenerator++;
    return actionItemIdGenerator;
}
var appResources;
var MenuItemClickListener;
function initializeMenuItemClickListener() {
    if (MenuItemClickListener) {
        return;
    }
    AppCompatTextView = androidx.appcompat.widget.AppCompatTextView;
    var MenuItemClickListenerImpl = (function (_super) {
        __extends(MenuItemClickListenerImpl, _super);
        function MenuItemClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        MenuItemClickListenerImpl.prototype.onMenuItemClick = function (item) {
            var itemId = item.getItemId();
            return this.owner._onAndroidItemSelected(itemId);
        };
        MenuItemClickListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.Toolbar.OnMenuItemClickListener])
        ], MenuItemClickListenerImpl);
        return MenuItemClickListenerImpl;
    }(java.lang.Object));
    MenuItemClickListener = MenuItemClickListenerImpl;
    appResources = application.android.context.getResources();
}
var ActionItem = (function (_super) {
    __extends(ActionItem, _super);
    function ActionItem() {
        var _this = _super.call(this) || this;
        _this._androidPosition = {
            position: "actionBar",
            systemIcon: undefined
        };
        _this._itemId = generateItemId();
        return _this;
    }
    Object.defineProperty(ActionItem.prototype, "android", {
        get: function () {
            return this._androidPosition;
        },
        set: function (value) {
            throw new Error("ActionItem.android is read-only");
        },
        enumerable: true,
        configurable: true
    });
    ActionItem.prototype._getItemId = function () {
        return this._itemId;
    };
    return ActionItem;
}(action_bar_common_1.ActionItemBase));
exports.ActionItem = ActionItem;
var AndroidActionBarSettings = (function () {
    function AndroidActionBarSettings(actionBar) {
        this._iconVisibility = "auto";
        this._actionBar = actionBar;
    }
    Object.defineProperty(AndroidActionBarSettings.prototype, "icon", {
        get: function () {
            return this._icon;
        },
        set: function (value) {
            if (value !== this._icon) {
                this._icon = value;
                this._actionBar._onIconPropertyChanged();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidActionBarSettings.prototype, "iconVisibility", {
        get: function () {
            return this._iconVisibility;
        },
        set: function (value) {
            if (value !== this._iconVisibility) {
                this._iconVisibility = value;
                this._actionBar._onIconPropertyChanged();
            }
        },
        enumerable: true,
        configurable: true
    });
    return AndroidActionBarSettings;
}());
exports.AndroidActionBarSettings = AndroidActionBarSettings;
var NavigationButton = (function (_super) {
    __extends(NavigationButton, _super);
    function NavigationButton() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return NavigationButton;
}(ActionItem));
exports.NavigationButton = NavigationButton;
var ActionBar = (function (_super) {
    __extends(ActionBar, _super);
    function ActionBar() {
        var _this = _super.call(this) || this;
        _this._android = new AndroidActionBarSettings(_this);
        return _this;
    }
    Object.defineProperty(ActionBar.prototype, "android", {
        get: function () {
            return this._android;
        },
        enumerable: true,
        configurable: true
    });
    ActionBar.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof NavigationButton) {
            this.navigationButton = value;
        }
        else if (value instanceof ActionItem) {
            this.actionItems.addItem(value);
        }
        else if (value instanceof action_bar_common_1.View) {
            this.titleView = value;
        }
    };
    ActionBar.prototype.createNativeView = function () {
        return new androidx.appcompat.widget.Toolbar(this._context);
    };
    ActionBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeMenuItemClickListener();
        var menuItemClickListener = new MenuItemClickListener(this);
        nativeView.setOnMenuItemClickListener(menuItemClickListener);
        nativeView.menuItemClickListener = menuItemClickListener;
    };
    ActionBar.prototype.disposeNativeView = function () {
        this.nativeViewProtected.menuItemClickListener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    ActionBar.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.update();
    };
    ActionBar.prototype.update = function () {
        if (!this.nativeViewProtected) {
            return;
        }
        var page = this.page;
        if (!page.frame || !page.frame._getNavBarVisible(page)) {
            this.nativeViewProtected.setVisibility(android.view.View.GONE);
            return;
        }
        this.nativeViewProtected.setVisibility(android.view.View.VISIBLE);
        this._addActionItems();
        this._updateTitleAndTitleView();
        this._updateIcon();
        this._updateNavigationButton();
    };
    ActionBar.prototype._onAndroidItemSelected = function (itemId) {
        if (this.navigationButton && itemId === R_ID_HOME) {
            this.navigationButton._raiseTap();
            return true;
        }
        var menuItem = undefined;
        var items = this.actionItems.getItems();
        for (var i = 0; i < items.length; i++) {
            if (items[i]._getItemId() === itemId) {
                menuItem = items[i];
                break;
            }
        }
        if (menuItem) {
            menuItem._raiseTap();
            return true;
        }
        return false;
    };
    ActionBar.prototype._updateNavigationButton = function () {
        var navButton = this.navigationButton;
        if (navButton && action_bar_common_1.isVisible(navButton)) {
            var systemIcon = navButton.android.systemIcon;
            if (systemIcon !== undefined) {
                var systemResourceId = getSystemResourceId(systemIcon);
                if (systemResourceId) {
                    this.nativeViewProtected.setNavigationIcon(systemResourceId);
                }
            }
            else if (navButton.icon) {
                var drawableOrId = getDrawableOrResourceId(navButton.icon, appResources);
                if (drawableOrId) {
                    this.nativeViewProtected.setNavigationIcon(drawableOrId);
                }
            }
            this.nativeViewProtected.setNavigationContentDescription(navButton.text || null);
            var navBtn_1 = new WeakRef(navButton);
            this.nativeViewProtected.setNavigationOnClickListener(new android.view.View.OnClickListener({
                onClick: function (v) {
                    var owner = navBtn_1.get();
                    if (owner) {
                        owner._raiseTap();
                    }
                }
            }));
        }
        else {
            this.nativeViewProtected.setNavigationIcon(null);
        }
    };
    ActionBar.prototype._updateIcon = function () {
        var visibility = getIconVisibility(this.android.iconVisibility);
        if (visibility) {
            var icon = this.android.icon;
            if (icon !== undefined) {
                var drawableOrId = getDrawableOrResourceId(icon, appResources);
                if (drawableOrId) {
                    this.nativeViewProtected.setLogo(drawableOrId);
                }
            }
            else {
                var defaultIcon = application.android.nativeApp.getApplicationInfo().icon;
                this.nativeViewProtected.setLogo(defaultIcon);
            }
        }
        else {
            this.nativeViewProtected.setLogo(null);
        }
    };
    ActionBar.prototype._updateTitleAndTitleView = function () {
        if (!this.titleView) {
            var title = this.title;
            if (title !== undefined) {
                this.nativeViewProtected.setTitle(title);
            }
            else {
                var appContext = application.android.context;
                var appInfo = appContext.getApplicationInfo();
                var appLabel = appContext.getPackageManager().getApplicationLabel(appInfo);
                if (appLabel) {
                    this.nativeViewProtected.setTitle(appLabel);
                }
            }
        }
    };
    ActionBar.prototype._addActionItems = function () {
        var menu = this.nativeViewProtected.getMenu();
        var items = this.actionItems.getVisibleItems();
        menu.clear();
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            var menuItem = menu.add(android.view.Menu.NONE, item._getItemId(), android.view.Menu.NONE, item.text + "");
            if (item.actionView && item.actionView.android) {
                item.android.position = "actionBar";
                menuItem.setActionView(item.actionView.android);
                ActionBar._setOnClickListener(item);
            }
            else if (item.android.systemIcon) {
                var systemResourceId = getSystemResourceId(item.android.systemIcon);
                if (systemResourceId) {
                    menuItem.setIcon(systemResourceId);
                }
            }
            else if (item.icon) {
                if (utils_1.isFontIconURI(item.icon)) {
                    var fontIconCode = item.icon.split("//")[1];
                    var font = item.style.fontInternal;
                    var color = item.style.color;
                    var is = image_source_1.fromFontIconCode(fontIconCode, font, color);
                    if (is && is.android) {
                        var drawable = new android.graphics.drawable.BitmapDrawable(appResources, is.android);
                        menuItem.setIcon(drawable);
                    }
                }
                else {
                    var drawableOrId = getDrawableOrResourceId(item.icon, appResources);
                    if (drawableOrId) {
                        menuItem.setIcon(drawableOrId);
                    }
                }
            }
            var showAsAction = getShowAsAction(item);
            menuItem.setShowAsAction(showAsAction);
        }
    };
    ActionBar._setOnClickListener = function (item) {
        var weakRef = new WeakRef(item);
        item.actionView.android.setOnClickListener(new android.view.View.OnClickListener({
            onClick: function (v) {
                var owner = weakRef.get();
                if (owner) {
                    owner._raiseTap();
                }
            }
        }));
    };
    ActionBar.prototype._onTitlePropertyChanged = function () {
        if (this.nativeViewProtected) {
            this._updateTitleAndTitleView();
        }
    };
    ActionBar.prototype._onIconPropertyChanged = function () {
        if (this.nativeViewProtected) {
            this._updateIcon();
        }
    };
    ActionBar.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (atIndex === void 0) { atIndex = Number.MAX_VALUE; }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (atIndex >= this.nativeViewProtected.getChildCount()) {
                this.nativeViewProtected.addView(child.nativeViewProtected);
            }
            else {
                this.nativeViewProtected.addView(child.nativeViewProtected, atIndex);
            }
            return true;
        }
        return false;
    };
    ActionBar.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            this.nativeViewProtected.removeView(child.nativeViewProtected);
        }
    };
    ActionBar.prototype[action_bar_common_1.colorProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        if (!defaultTitleTextColor) {
            var tv = getAppCompatTextView(nativeView);
            if (!tv) {
                var title = nativeView.getTitle();
                nativeView.setTitle("");
                tv = getAppCompatTextView(nativeView);
                if (title) {
                    nativeView.setTitle(title);
                }
            }
            defaultTitleTextColor = tv ? tv.getTextColors().getDefaultColor() : -570425344;
        }
        return defaultTitleTextColor;
    };
    ActionBar.prototype[action_bar_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof action_bar_common_1.Color ? value.android : value;
        this.nativeViewProtected.setTitleTextColor(color);
    };
    ActionBar.prototype[action_bar_common_1.flatProperty.setNative] = function (value) {
        var compat = androidx.core.view.ViewCompat;
        if (compat.setElevation) {
            if (value) {
                compat.setElevation(this.nativeViewProtected, 0);
            }
            else {
                var val = DEFAULT_ELEVATION * action_bar_common_1.layout.getDisplayDensity();
                compat.setElevation(this.nativeViewProtected, val);
            }
        }
    };
    return ActionBar;
}(action_bar_common_1.ActionBarBase));
exports.ActionBar = ActionBar;
function getAppCompatTextView(toolbar) {
    for (var i = 0, count = toolbar.getChildCount(); i < count; i++) {
        var child = toolbar.getChildAt(i);
        if (child instanceof AppCompatTextView) {
            return child;
        }
    }
    return null;
}
ActionBar.prototype.recycleNativeView = "auto";
var defaultTitleTextColor;
function getDrawableOrResourceId(icon, resources) {
    if (typeof icon !== "string") {
        return undefined;
    }
    var result = undefined;
    if (icon.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        var resourceId = resources.getIdentifier(icon.substr(utils_1.RESOURCE_PREFIX.length), "drawable", application.android.packageName);
        if (resourceId > 0) {
            result = resourceId;
        }
    }
    else {
        var drawable = void 0;
        var is = image_source_1.fromFileOrResource(icon);
        if (is) {
            drawable = new android.graphics.drawable.BitmapDrawable(appResources, is.android);
        }
        result = drawable;
    }
    if (!result) {
        action_bar_common_1.traceMissingIcon(icon);
    }
    return result;
}
function getShowAsAction(menuItem) {
    switch (menuItem.android.position) {
        case "actionBarIfRoom":
            return android.view.MenuItem.SHOW_AS_ACTION_IF_ROOM;
        case "popup":
            return android.view.MenuItem.SHOW_AS_ACTION_NEVER;
        case "actionBar":
        default:
            return android.view.MenuItem.SHOW_AS_ACTION_ALWAYS;
    }
}
function getIconVisibility(iconVisibility) {
    switch (iconVisibility) {
        case "always":
            return true;
        case "auto":
        case "never":
        default:
            return false;
    }
}
function getSystemResourceId(systemIcon) {
    return android.content.res.Resources.getSystem().getIdentifier(systemIcon, "drawable", "android");
}
//# sourceMappingURL=action-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ActivityIndicatorBase = (function (_super) {
    __extends(ActivityIndicatorBase, _super);
    function ActivityIndicatorBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicatorBase = __decorate([
        view_1.CSSType("ActivityIndicator")
    ], ActivityIndicatorBase);
    return ActivityIndicatorBase;
}(view_1.View));
exports.ActivityIndicatorBase = ActivityIndicatorBase;
ActivityIndicatorBase.prototype.recycleNativeView = "auto";
exports.busyProperty = new view_1.Property({ name: "busy", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.busyProperty.register(ActivityIndicatorBase);
//# sourceMappingURL=activity-indicator-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var activity_indicator_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js"));
var ActivityIndicator = (function (_super) {
    __extends(ActivityIndicator, _super);
    function ActivityIndicator() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicator.prototype.createNativeView = function () {
        var progressBar = new android.widget.ProgressBar(this._context);
        progressBar.setVisibility(android.view.View.INVISIBLE);
        progressBar.setIndeterminate(true);
        return progressBar;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.getDefault] = function () {
        return false;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.setNative] = function (value) {
        if (this.visibility === activity_indicator_common_1.Visibility.VISIBLE) {
            this.nativeViewProtected.setVisibility(value ? android.view.View.VISIBLE : android.view.View.INVISIBLE);
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.visibilityProperty.getDefault] = function () {
        return activity_indicator_common_1.Visibility.HIDDEN;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case activity_indicator_common_1.Visibility.VISIBLE:
                this.nativeViewProtected.setVisibility(this.busy ? android.view.View.VISIBLE : android.view.View.INVISIBLE);
                break;
            case activity_indicator_common_1.Visibility.HIDDEN:
                this.nativeViewProtected.setVisibility(android.view.View.INVISIBLE);
                break;
            case activity_indicator_common_1.Visibility.COLLAPSE:
                this.nativeViewProtected.setVisibility(android.view.View.GONE);
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: \"" + activity_indicator_common_1.Visibility.VISIBLE + "\", \"" + activity_indicator_common_1.Visibility.HIDDEN + "\", \"" + activity_indicator_common_1.Visibility.COLLAPSE + "\".");
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof activity_indicator_common_1.Color) {
            this.nativeViewProtected.getIndeterminateDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getIndeterminateDrawable().clearColorFilter();
        }
    };
    return ActivityIndicator;
}(activity_indicator_common_1.ActivityIndicatorBase));
exports.ActivityIndicator = ActivityIndicator;
//# sourceMappingURL=activity-indicator.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceCategories = trace_1.categories;
exports.traceType = trace_1.messageType;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Properties;
(function (Properties) {
    Properties.opacity = "opacity";
    Properties.backgroundColor = "backgroundColor";
    Properties.translate = "translate";
    Properties.rotate = "rotate";
    Properties.scale = "scale";
    Properties.height = "height";
    Properties.width = "width";
})(Properties = exports.Properties || (exports.Properties = {}));
var CubicBezierAnimationCurve = (function () {
    function CubicBezierAnimationCurve(x1, y1, x2, y2) {
        this.x1 = x1;
        this.y1 = y1;
        this.x2 = x2;
        this.y2 = y2;
    }
    return CubicBezierAnimationCurve;
}());
exports.CubicBezierAnimationCurve = CubicBezierAnimationCurve;
var AnimationBase = (function () {
    function AnimationBase(animationDefinitions, playSequentially) {
        if (!animationDefinitions || animationDefinitions.length === 0) {
            throw new Error("No animation definitions specified");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Analyzing " + animationDefinitions.length + " animation definitions...", trace_1.categories.Animation);
        }
        this._propertyAnimations = new Array();
        for (var i = 0, length_1 = animationDefinitions.length; i < length_1; i++) {
            if (animationDefinitions[i].curve) {
                animationDefinitions[i].curve = this._resolveAnimationCurve(animationDefinitions[i].curve);
            }
            this._propertyAnimations = this._propertyAnimations.concat(AnimationBase._createPropertyAnimations(animationDefinitions[i]));
        }
        if (this._propertyAnimations.length === 0) {
            throw new Error("Nothing to animate.");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Created " + this._propertyAnimations.length + " individual property animations.", trace_1.categories.Animation);
        }
        this._playSequentially = playSequentially;
    }
    AnimationBase.prototype._rejectAlreadyPlaying = function () {
        var reason = "Animation is already playing.";
        trace_1.write(reason, trace_1.categories.Animation, trace_1.messageType.warn);
        return new Promise(function (resolve, reject) {
            reject(reason);
        });
    };
    AnimationBase.prototype.play = function () {
        var _this_1 = this;
        var animationFinishedPromise = new Promise(function (resolve, reject) {
            _this_1._resolve = resolve;
            _this_1._reject = reject;
        });
        this.fixupAnimationPromise(animationFinishedPromise);
        this._isPlaying = true;
        return animationFinishedPromise;
    };
    AnimationBase.prototype.fixupAnimationPromise = function (promise) {
        var _this = this;
        promise.cancel = function () {
            _this.cancel();
        };
        var _then = promise.then;
        promise.then = function () {
            var r = _then.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
        var _catch = promise.catch;
        promise.catch = function () {
            var r = _catch.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
    };
    AnimationBase.prototype.cancel = function () {
    };
    Object.defineProperty(AnimationBase.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    AnimationBase.prototype._resolveAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._resolve();
    };
    AnimationBase.prototype._rejectAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._reject(new Error("Animation cancelled."));
    };
    AnimationBase._createPropertyAnimations = function (animationDefinition) {
        if (!animationDefinition.target) {
            throw new Error("No animation target specified.");
        }
        for (var item in animationDefinition) {
            if (animationDefinition[item] === undefined) {
                continue;
            }
            if ((item === Properties.opacity ||
                item === Properties.rotate ||
                item === "duration" ||
                item === "delay" ||
                item === "iterations") && typeof animationDefinition[item] !== "number") {
                throw new Error("Property " + item + " must be valid number. Value: " + animationDefinition[item]);
            }
            else if ((item === Properties.scale || item === Properties.translate) &&
                (typeof animationDefinition[item].x !== "number" || typeof animationDefinition[item].y !== "number")) {
                throw new Error("Property " + item + " must be valid Pair. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.backgroundColor && !color_1.Color.isValid(animationDefinition.backgroundColor)) {
                throw new Error("Property " + item + " must be valid color. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.width || item === Properties.height) {
                animationDefinition[item] = style_properties_1.PercentLength.parse(animationDefinition[item]);
            }
        }
        var propertyAnimations = new Array();
        if (animationDefinition.opacity !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.opacity,
                value: animationDefinition.opacity,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.backgroundColor !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.backgroundColor,
                value: typeof animationDefinition.backgroundColor === "string" ?
                    new color_1.Color(animationDefinition.backgroundColor) : animationDefinition.backgroundColor,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.translate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.translate,
                value: animationDefinition.translate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.scale !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.scale,
                value: animationDefinition.scale,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.rotate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.rotate,
                value: animationDefinition.rotate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.height !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.height,
                value: animationDefinition.height,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.width !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.width,
                value: animationDefinition.width,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (propertyAnimations.length === 0) {
            throw new Error("No known animation properties specified");
        }
        return propertyAnimations;
    };
    AnimationBase._getAnimationInfo = function (animation) {
        return JSON.stringify({
            target: animation.target.id,
            property: animation.property,
            value: animation.value,
            duration: animation.duration,
            delay: animation.delay,
            iterations: animation.iterations,
            curve: animation.curve
        });
    };
    return AnimationBase;
}());
exports.AnimationBase = AnimationBase;
//# sourceMappingURL=animation-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var animation_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js"));
var argbEvaluator;
function ensureArgbEvaluator() {
    if (!argbEvaluator) {
        argbEvaluator = new android.animation.ArgbEvaluator();
    }
}
var easeIn = lazy_1.default(function () { return new android.view.animation.AccelerateInterpolator(1); });
var easeOut = lazy_1.default(function () { return new android.view.animation.DecelerateInterpolator(1); });
var easeInOut = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
var linear = lazy_1.default(function () { return new android.view.animation.LinearInterpolator(); });
var bounce = lazy_1.default(function () { return new android.view.animation.BounceInterpolator(); });
var keyPrefix = "ui.animation.";
var propertyKeys = {};
propertyKeys[animation_common_1.Properties.backgroundColor] = Symbol(keyPrefix + animation_common_1.Properties.backgroundColor);
propertyKeys[animation_common_1.Properties.opacity] = Symbol(keyPrefix + animation_common_1.Properties.opacity);
propertyKeys[animation_common_1.Properties.rotate] = Symbol(keyPrefix + animation_common_1.Properties.rotate);
propertyKeys[animation_common_1.Properties.scale] = Symbol(keyPrefix + animation_common_1.Properties.scale);
propertyKeys[animation_common_1.Properties.translate] = Symbol(keyPrefix + animation_common_1.Properties.translate);
propertyKeys[animation_common_1.Properties.height] = Symbol(keyPrefix + animation_common_1.Properties.height);
propertyKeys[animation_common_1.Properties.width] = Symbol(keyPrefix + animation_common_1.Properties.width);
function _resolveAnimationCurve(curve) {
    switch (curve) {
        case "easeIn":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.AccelerateInterpolator(1).", animation_common_1.traceCategories.Animation);
            }
            return easeIn();
        case "easeOut":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.DecelerateInterpolator(1).", animation_common_1.traceCategories.Animation);
            }
            return easeOut();
        case "easeInOut":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.AccelerateDecelerateInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return easeInOut();
        case "linear":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.LinearInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return linear();
        case "spring":
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to android.view.animation.BounceInterpolator().", animation_common_1.traceCategories.Animation);
            }
            return bounce();
        case "ease":
            return androidx.core.view.animation.PathInterpolatorCompat.create(0.25, 0.1, 0.25, 1.0);
        default:
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animation curve resolved to original: " + curve, animation_common_1.traceCategories.Animation);
            }
            if (curve instanceof animation_common_1.CubicBezierAnimationCurve) {
                return androidx.core.view.animation.PathInterpolatorCompat.create(curve.x1, curve.y1, curve.x2, curve.y2);
            }
            else if (curve && curve.getInterpolation) {
                return curve;
            }
            else if (curve instanceof android.view.animation.LinearInterpolator) {
                return curve;
            }
            else {
                throw new Error("Invalid animation curve: " + curve);
            }
    }
}
exports._resolveAnimationCurve = _resolveAnimationCurve;
var Animation = (function (_super) {
    __extends(Animation, _super);
    function Animation(animationDefinitions, playSequentially) {
        var _this = _super.call(this, animationDefinitions, playSequentially) || this;
        _this._resetOnFinish = true;
        _this._valueSource = "animation";
        if (animationDefinitions.length > 0 && animationDefinitions[0].valueSource !== undefined) {
            _this._valueSource = animationDefinitions[0].valueSource;
        }
        var that = new WeakRef(_this);
        _this._animatorListener = new android.animation.Animator.AnimatorListener({
            onAnimationStart: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAndroidAnimationStart(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
            },
            onAnimationRepeat: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationRepeat(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
            },
            onAnimationEnd: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationEnd(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
                var thisRef = that.get();
                if (thisRef) {
                    thisRef._onAndroidAnimationEnd();
                }
            },
            onAnimationCancel: function (animator) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("MainAnimatorListener.onAnimationCancel(" + animator + ")", animation_common_1.traceCategories.Animation);
                }
                var thisRef = that.get();
                if (thisRef) {
                    thisRef._onAndroidAnimationCancel();
                }
            }
        });
        return _this;
    }
    Animation.prototype.play = function (resetOnFinish) {
        if (resetOnFinish !== undefined) {
            this._resetOnFinish = resetOnFinish;
        }
        if (this.isPlaying) {
            return this._rejectAlreadyPlaying();
        }
        if (this._animatorSet) {
            return this._play();
        }
        this._animators = new Array();
        this._propertyUpdateCallbacks = new Array();
        this._propertyResetCallbacks = new Array();
        for (var i = 0, length_1 = this._propertyAnimations.length; i < length_1; i++) {
            this._createAnimators(this._propertyAnimations[i]);
        }
        this._nativeAnimatorsArray = Array.create(android.animation.Animator, this._animators.length);
        for (var i = 0, length_2 = this._animators.length; i < length_2; i++) {
            this._nativeAnimatorsArray[i] = this._animators[i];
        }
        this._animatorSet = new android.animation.AnimatorSet();
        this._animatorSet.addListener(this._animatorListener);
        return this._play();
    };
    Animation.prototype.cancel = function () {
        if (!this.isPlaying) {
            animation_common_1.traceWrite("Animation is not currently playing.", animation_common_1.traceCategories.Animation, animation_common_1.traceType.warn);
            return;
        }
        animation_common_1.traceWrite("Cancelling AnimatorSet.", animation_common_1.traceCategories.Animation);
        this._animatorSet.cancel();
    };
    Animation.prototype._resolveAnimationCurve = function (curve) {
        return _resolveAnimationCurve(curve);
    };
    Animation.prototype._play = function () {
        var animationFinishedPromise = _super.prototype.play.call(this);
        if (platform_1.device.sdkVersion <= "23") {
            this._animatorSet = new android.animation.AnimatorSet();
            this._animatorSet.addListener(this._animatorListener);
        }
        if (this._animators.length > 0) {
            if (this._playSequentially) {
                this._animatorSet.playSequentially(this._nativeAnimatorsArray);
            }
            else {
                this._animatorSet.playTogether(this._nativeAnimatorsArray);
            }
        }
        if (animation_common_1.traceEnabled()) {
            animation_common_1.traceWrite("Starting " + this._nativeAnimatorsArray.length + " animations " + (this._playSequentially ? "sequentially." : "together."), animation_common_1.traceCategories.Animation);
        }
        this._animatorSet.setupStartValues();
        this._animatorSet.start();
        return animationFinishedPromise;
    };
    Animation.prototype._onAndroidAnimationEnd = function () {
        if (!this.isPlaying) {
            return;
        }
        this._propertyUpdateCallbacks.forEach(function (v) { return v(); });
        this._resolveAnimationFinishedPromise();
        if (this._resetOnFinish && this._target) {
            this._target._removeAnimation(this);
        }
    };
    Animation.prototype._onAndroidAnimationCancel = function () {
        this._propertyResetCallbacks.forEach(function (v) { return v(); });
        this._rejectAnimationFinishedPromise();
        if (this._target) {
            this._target._removeAnimation(this);
        }
    };
    Animation.prototype._createAnimators = function (propertyAnimation) {
        if (!propertyAnimation.target.nativeViewProtected) {
            return;
        }
        if (animation_common_1.traceEnabled()) {
            animation_common_1.traceWrite("Creating ObjectAnimator(s) for animation: " + Animation._getAnimationInfo(propertyAnimation) + "...", animation_common_1.traceCategories.Animation);
        }
        if (propertyAnimation.target === null || propertyAnimation.target === undefined) {
            throw new Error("Animation target cannot be null or undefined; property: " + propertyAnimation.property + "; value: " + propertyAnimation.value + ";");
        }
        if (propertyAnimation.property === null || propertyAnimation.property === undefined) {
            throw new Error("Animation property cannot be null or undefined; target: " + propertyAnimation.target + "; value: " + propertyAnimation.value + ";");
        }
        if (propertyAnimation.value === null || propertyAnimation.value === undefined) {
            throw new Error("Animation value cannot be null or undefined; target: " + propertyAnimation.target + "; property: " + propertyAnimation.property + ";");
        }
        this._target = propertyAnimation.target;
        var nativeArray;
        var nativeView = propertyAnimation.target.nativeViewProtected;
        var animators = new Array();
        var propertyUpdateCallbacks = new Array();
        var propertyResetCallbacks = new Array();
        var originalValue1;
        var originalValue2;
        var density = utils_1.layout.getDisplayDensity();
        var xyObjectAnimators;
        var animatorSet;
        var key = propertyKeys[propertyAnimation.property];
        if (key) {
            propertyAnimation.target[key] = propertyAnimation;
        }
        function checkAnimation(cb) {
            return function () {
                if (propertyAnimation.target[key] === propertyAnimation) {
                    delete propertyAnimation.target[key];
                    cb();
                }
            };
        }
        var setLocal = this._valueSource === "animation";
        var style = propertyAnimation.target.style;
        switch (propertyAnimation.property) {
            case animation_common_1.Properties.opacity:
                style_properties_1.opacityProperty._initDefaultNativeValue(style);
                originalValue1 = nativeView.getAlpha();
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.opacityProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.opacityProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.opacityProperty.setNative](propertyAnimation.target.style.opacity);
                    }
                }));
                animators.push(android.animation.ObjectAnimator.ofFloat(nativeView, "alpha", nativeArray));
                break;
            case animation_common_1.Properties.backgroundColor:
                style_properties_1.backgroundColorProperty._initDefaultNativeValue(style);
                ensureArgbEvaluator();
                originalValue1 = propertyAnimation.target.backgroundColor;
                nativeArray = Array.create(java.lang.Object, 2);
                nativeArray[0] = propertyAnimation.target.backgroundColor ? java.lang.Integer.valueOf(propertyAnimation.target.backgroundColor.argb) : java.lang.Integer.valueOf(-1);
                nativeArray[1] = java.lang.Integer.valueOf(propertyAnimation.value.argb);
                var animator = android.animation.ValueAnimator.ofObject(argbEvaluator, nativeArray);
                animator.addUpdateListener(new android.animation.ValueAnimator.AnimatorUpdateListener({
                    onAnimationUpdate: function (animator) {
                        var argb = animator.getAnimatedValue().intValue();
                        propertyAnimation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = new animation_common_1.Color(argb);
                    }
                }));
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.backgroundColorProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.backgroundColorProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected && propertyAnimation.target[style_properties_1.backgroundColorProperty.setNative]) {
                        propertyAnimation.target[style_properties_1.backgroundColorProperty.setNative](propertyAnimation.target.style.backgroundColor);
                    }
                }));
                animators.push(animator);
                break;
            case animation_common_1.Properties.translate:
                style_properties_1.translateXProperty._initDefaultNativeValue(style);
                style_properties_1.translateYProperty._initDefaultNativeValue(style);
                xyObjectAnimators = Array.create(android.animation.Animator, 2);
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.x * density;
                xyObjectAnimators[0] = android.animation.ObjectAnimator.ofFloat(nativeView, "translationX", nativeArray);
                xyObjectAnimators[0].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.y * density;
                xyObjectAnimators[1] = android.animation.ObjectAnimator.ofFloat(nativeView, "translationY", nativeArray);
                xyObjectAnimators[1].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                originalValue1 = nativeView.getTranslationX() / density;
                originalValue2 = nativeView.getTranslationY() / density;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = propertyAnimation.value.x;
                    propertyAnimation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = propertyAnimation.value.y;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.translateXProperty.name] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.translateYProperty.name] = originalValue2;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.translateXProperty.keyframe] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.translateYProperty.keyframe] = originalValue2;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.translateXProperty.setNative](propertyAnimation.target.style.translateX);
                        propertyAnimation.target[style_properties_1.translateYProperty.setNative](propertyAnimation.target.style.translateY);
                    }
                }));
                animatorSet = new android.animation.AnimatorSet();
                animatorSet.playTogether(xyObjectAnimators);
                animatorSet.setupStartValues();
                animators.push(animatorSet);
                break;
            case animation_common_1.Properties.scale:
                style_properties_1.scaleXProperty._initDefaultNativeValue(style);
                style_properties_1.scaleYProperty._initDefaultNativeValue(style);
                xyObjectAnimators = Array.create(android.animation.Animator, 2);
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.x;
                xyObjectAnimators[0] = android.animation.ObjectAnimator.ofFloat(nativeView, "scaleX", nativeArray);
                xyObjectAnimators[0].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value.y;
                xyObjectAnimators[1] = android.animation.ObjectAnimator.ofFloat(nativeView, "scaleY", nativeArray);
                xyObjectAnimators[1].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
                originalValue1 = nativeView.getScaleX();
                originalValue2 = nativeView.getScaleY();
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = propertyAnimation.value.x;
                    propertyAnimation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = propertyAnimation.value.y;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.scaleXProperty.name] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.scaleYProperty.name] = originalValue2;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.scaleXProperty.keyframe] = originalValue1;
                        propertyAnimation.target.style[style_properties_1.scaleYProperty.keyframe] = originalValue2;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.scaleXProperty.setNative](propertyAnimation.target.style.scaleX);
                        propertyAnimation.target[style_properties_1.scaleYProperty.setNative](propertyAnimation.target.style.scaleY);
                    }
                }));
                animatorSet = new android.animation.AnimatorSet();
                animatorSet.playTogether(xyObjectAnimators);
                animatorSet.setupStartValues();
                animators.push(animatorSet);
                break;
            case animation_common_1.Properties.rotate:
                style_properties_1.rotateProperty._initDefaultNativeValue(style);
                originalValue1 = nativeView.getRotation();
                nativeArray = Array.create("float", 1);
                nativeArray[0] = propertyAnimation.value;
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    if (setLocal) {
                        propertyAnimation.target.style[style_properties_1.rotateProperty.name] = originalValue1;
                    }
                    else {
                        propertyAnimation.target.style[style_properties_1.rotateProperty.keyframe] = originalValue1;
                    }
                    if (propertyAnimation.target.nativeViewProtected) {
                        propertyAnimation.target[style_properties_1.rotateProperty.setNative](propertyAnimation.target.style.rotate);
                    }
                }));
                animators.push(android.animation.ObjectAnimator.ofFloat(nativeView, "rotation", nativeArray));
                break;
            case animation_common_1.Properties.width:
            case animation_common_1.Properties.height: {
                var isVertical = propertyAnimation.property === "height";
                var extentProperty_1 = isVertical ? style_properties_1.heightProperty : style_properties_1.widthProperty;
                extentProperty_1._initDefaultNativeValue(style);
                nativeArray = Array.create("float", 2);
                var toValue = propertyAnimation.value;
                var parent_1 = propertyAnimation.target.parent;
                if (!parent_1) {
                    throw new Error("cannot animate " + propertyAnimation.property + " on root view");
                }
                var parentExtent = isVertical ? parent_1.getMeasuredHeight() : parent_1.getMeasuredWidth();
                toValue = style_properties_1.PercentLength.toDevicePixels(toValue, parentExtent, parentExtent) / platform_1.screen.mainScreen.scale;
                var nativeHeight = isVertical ? nativeView.getHeight() : nativeView.getWidth();
                var targetStyle_1 = setLocal ? extentProperty_1.name : extentProperty_1.keyframe;
                originalValue1 = nativeHeight / platform_1.screen.mainScreen.scale;
                nativeArray[0] = originalValue1;
                nativeArray[1] = toValue;
                var extentAnimator = android.animation.ValueAnimator.ofFloat(nativeArray);
                extentAnimator.addUpdateListener(new android.animation.ValueAnimator.AnimatorUpdateListener({
                    onAnimationUpdate: function (animator) {
                        var argb = animator.getAnimatedValue().floatValue();
                        propertyAnimation.target.style[setLocal ? extentProperty_1.name : extentProperty_1.keyframe] = argb;
                    }
                }));
                propertyUpdateCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[targetStyle_1] = propertyAnimation.value;
                }));
                propertyResetCallbacks.push(checkAnimation(function () {
                    propertyAnimation.target.style[targetStyle_1] = originalValue1;
                    if (propertyAnimation.target.nativeViewProtected) {
                        var setter = propertyAnimation.target[extentProperty_1.setNative];
                        setter(propertyAnimation.target.style[propertyAnimation.property]);
                    }
                }));
                animators.push(extentAnimator);
                break;
            }
            default:
                throw new Error("Animating property '" + propertyAnimation.property + "' is unsupported");
        }
        for (var i = 0, length_3 = animators.length; i < length_3; i++) {
            if (propertyAnimation.duration !== undefined) {
                animators[i].setDuration(propertyAnimation.duration);
            }
            if (propertyAnimation.delay !== undefined) {
                animators[i].setStartDelay(propertyAnimation.delay);
            }
            if (propertyAnimation.iterations !== undefined && animators[i] instanceof android.animation.ValueAnimator) {
                animators[i].setRepeatCount(Animation._getAndroidRepeatCount(propertyAnimation.iterations));
            }
            if (propertyAnimation.curve !== undefined) {
                animators[i].setInterpolator(propertyAnimation.curve);
            }
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Animator created: " + animators[i], animation_common_1.traceCategories.Animation);
            }
        }
        this._animators = this._animators.concat(animators);
        this._propertyUpdateCallbacks = this._propertyUpdateCallbacks.concat(propertyUpdateCallbacks);
        this._propertyResetCallbacks = this._propertyResetCallbacks.concat(propertyResetCallbacks);
    };
    Animation._getAndroidRepeatCount = function (iterations) {
        return (iterations === Number.POSITIVE_INFINITY) ? android.view.animation.Animation.INFINITE : iterations - 1;
    };
    return Animation;
}(animation_common_1.AnimationBase));
exports.Animation = Animation;
//# sourceMappingURL=animation.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/keyframe-animation.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Keyframes = (function () {
    function Keyframes() {
    }
    return Keyframes;
}());
exports.Keyframes = Keyframes;
var UnparsedKeyframe = (function () {
    function UnparsedKeyframe() {
    }
    return UnparsedKeyframe;
}());
exports.UnparsedKeyframe = UnparsedKeyframe;
var KeyframeDeclaration = (function () {
    function KeyframeDeclaration() {
    }
    return KeyframeDeclaration;
}());
exports.KeyframeDeclaration = KeyframeDeclaration;
var KeyframeInfo = (function () {
    function KeyframeInfo() {
        this.curve = enums_1.AnimationCurve.ease;
    }
    return KeyframeInfo;
}());
exports.KeyframeInfo = KeyframeInfo;
var KeyframeAnimationInfo = (function () {
    function KeyframeAnimationInfo() {
        this.name = "";
        this.duration = 0.3;
        this.delay = 0;
        this.iterations = 1;
        this.curve = "ease";
        this.isForwards = false;
        this.isReverse = false;
    }
    return KeyframeAnimationInfo;
}());
exports.KeyframeAnimationInfo = KeyframeAnimationInfo;
var KeyframeAnimation = (function () {
    function KeyframeAnimation() {
        this.delay = 0;
        this.iterations = 1;
    }
    KeyframeAnimation.keyframeAnimationFromInfo = function (info) {
        var length = info.keyframes.length;
        var animations = new Array();
        var startDuration = 0;
        if (info.isReverse) {
            for (var index_1 = length - 1; index_1 >= 0; index_1--) {
                var keyframe = info.keyframes[index_1];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
        }
        else {
            for (var index_2 = 0; index_2 < length; index_2++) {
                var keyframe = info.keyframes[index_2];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
            for (var index_3 = length - 1; index_3 > 0; index_3--) {
                var a1 = animations[index_3];
                var a2 = animations[index_3 - 1];
                if (a2["curve"] !== undefined) {
                    a1["curve"] = a2["curve"];
                    a2["curve"] = undefined;
                }
            }
        }
        animations.map(function (a) { return a["curve"] ? a : Object.assign(a, { curve: info.curve }); });
        var animation = new KeyframeAnimation();
        animation.delay = info.delay;
        animation.iterations = info.iterations;
        animation.animations = animations;
        animation._isForwards = info.isForwards;
        return animation;
    };
    KeyframeAnimation.parseKeyframe = function (info, keyframe, animations, startDuration) {
        var animation = {};
        for (var _i = 0, _a = keyframe.declarations; _i < _a.length; _i++) {
            var declaration = _a[_i];
            animation[declaration.property] = declaration.value;
        }
        var duration = keyframe.duration;
        if (duration === 0) {
            duration = 0.01;
        }
        else {
            duration = (info.duration * duration) - startDuration;
            startDuration += duration;
        }
        animation.duration = info.isReverse ? info.duration - duration : duration;
        animation.curve = keyframe.curve;
        animation.forceLayer = true;
        animation.valueSource = "keyframe";
        animations.push(animation);
        return startDuration;
    };
    Object.defineProperty(KeyframeAnimation.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    KeyframeAnimation.prototype.cancel = function () {
        if (!this.isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        this._isPlaying = false;
        for (var i = this._nativeAnimations.length - 1; i >= 0; i--) {
            var animation = this._nativeAnimations[i];
            if (animation.isPlaying) {
                animation.cancel();
            }
        }
        if (this._nativeAnimations.length > 0) {
            var animation = this._nativeAnimations[0];
            this._resetAnimationValues(this._target, animation);
        }
        this._resetAnimations();
    };
    KeyframeAnimation.prototype.play = function (view) {
        var _this = this;
        if (this._isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return new Promise(function (resolve) {
                resolve();
            });
        }
        var animationFinishedPromise = new Promise(function (resolve) {
            _this._resolve = resolve;
        });
        this._isPlaying = true;
        this._nativeAnimations = new Array();
        this._target = view;
        if (this.delay !== 0) {
            setTimeout(function () { return _this.animate(view, 0, _this.iterations); }, this.delay);
        }
        else {
            this.animate(view, 0, this.iterations);
        }
        return animationFinishedPromise;
    };
    KeyframeAnimation.prototype.animate = function (view, index, iterations) {
        var _this = this;
        if (!this._isPlaying) {
            return;
        }
        if (index === 0) {
            var animation = this.animations[0];
            if ("backgroundColor" in animation) {
                view.style[style_properties_1.backgroundColorProperty.keyframe] = animation.backgroundColor;
            }
            if ("scale" in animation) {
                view.style[style_properties_1.scaleXProperty.keyframe] = animation.scale.x;
                view.style[style_properties_1.scaleYProperty.keyframe] = animation.scale.y;
            }
            if ("translate" in animation) {
                view.style[style_properties_1.translateXProperty.keyframe] = animation.translate.x;
                view.style[style_properties_1.translateYProperty.keyframe] = animation.translate.y;
            }
            if ("rotate" in animation) {
                view.style[style_properties_1.rotateProperty.keyframe] = animation.rotate;
            }
            if ("opacity" in animation) {
                view.style[style_properties_1.opacityProperty.keyframe] = animation.opacity;
            }
            if ("height" in animation) {
                view.style[style_properties_1.heightProperty.keyframe] = animation.height;
            }
            if ("width" in animation) {
                view.style[style_properties_1.widthProperty.keyframe] = animation.width;
            }
            setTimeout(function () { return _this.animate(view, 1, iterations); }, 1);
        }
        else if (index < 0 || index >= this.animations.length) {
            iterations -= 1;
            if (iterations > 0) {
                this.animate(view, 0, iterations);
            }
            else {
                if (this._isForwards === false) {
                    var animation = this.animations[this.animations.length - 1];
                    this._resetAnimationValues(view, animation);
                }
                this._resolveAnimationFinishedPromise();
            }
        }
        else {
            var animation = void 0;
            var cachedAnimation = this._nativeAnimations[index - 1];
            if (cachedAnimation) {
                animation = cachedAnimation;
            }
            else {
                var animationDef = this.animations[index];
                animationDef.target = view;
                animation = new animation_1.Animation([animationDef]);
                this._nativeAnimations.push(animation);
            }
            var isLastIteration = iterations - 1 <= 0;
            animation.play(isLastIteration).then(function () {
                _this.animate(view, index + 1, iterations);
            }, function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            }).catch(function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            });
        }
    };
    KeyframeAnimation.prototype._resolveAnimationFinishedPromise = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
        this._resolve();
    };
    KeyframeAnimation.prototype._resetAnimations = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
    };
    KeyframeAnimation.prototype._resetAnimationValues = function (view, animation) {
        if ("backgroundColor" in animation) {
            view.style[style_properties_1.backgroundColorProperty.keyframe] = properties_1.unsetValue;
        }
        if ("scale" in animation) {
            view.style[style_properties_1.scaleXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.scaleYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("translate" in animation) {
            view.style[style_properties_1.translateXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.translateYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("rotate" in animation) {
            view.style[style_properties_1.rotateProperty.keyframe] = properties_1.unsetValue;
        }
        if ("opacity" in animation) {
            view.style[style_properties_1.opacityProperty.keyframe] = properties_1.unsetValue;
        }
        if ("height" in animation) {
            view.style[style_properties_1.heightProperty.keyframe] = properties_1.unsetValue;
        }
        if ("width" in animation) {
            view.style[style_properties_1.widthProperty.keyframe] = properties_1.unsetValue;
        }
    };
    return KeyframeAnimation;
}());
exports.KeyframeAnimation = KeyframeAnimation;
//# sourceMappingURL=keyframe-animation.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/border/border.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var Border = (function (_super) {
    __extends(Border, _super);
    function Border() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Border.prototype, "cornerRadius", {
        get: function () {
            if (typeof this.borderRadius === "number") {
                return this.borderRadius;
            }
            return 0;
        },
        set: function (value) {
            this.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Border.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = content_view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = content_view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = content_view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = content_view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var result = content_view_1.View.measureChild(this, this.layoutView, content_view_1.layout.makeMeasureSpec(width - horizontalBorderLength, widthMode), content_view_1.layout.makeMeasureSpec(height - verticalBorderLength, heightMode));
        var widthAndState = content_view_1.View.resolveSizeAndState(result.measuredWidth + horizontalBorderLength, width, widthMode, 0);
        var heightAndState = content_view_1.View.resolveSizeAndState(result.measuredHeight + verticalBorderLength, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Border.prototype.onLayout = function (left, top, right, bottom) {
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        content_view_1.View.layoutChild(this, this.layoutView, this.effectiveBorderLeftWidth, this.effectiveBorderTopWidth, right - left - horizontalBorderLength, bottom - top - verticalBorderLength);
    };
    Border = __decorate([
        Deprecated,
        content_view_1.CSSType("Border")
    ], Border);
    return Border;
}(content_view_1.ContentView));
exports.Border = Border;
Border.prototype.recycleNativeView = "auto";
//# sourceMappingURL=border.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_strip_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js");
var tab_strip_item_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 8;
var TABID = "_tabId";
var INDEX = "_index";
var ownerSymbol = Symbol("_owner");
var TabFragment;
var BottomNavigationBar;
var AttachStateChangeListener;
function makeFragmentName(viewId, id) {
    return "android:bottomnavigation:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (BottomNavigationBar) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find BottomNavigation");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var BottomNavigationBarImplementation = (function (_super) {
        __extends(BottomNavigationBarImplementation, _super);
        function BottomNavigationBarImplementation(context, owner) {
            var _this = _super.call(this, context) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        BottomNavigationBarImplementation.prototype.onSelectedPositionChange = function (position, prevPosition) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            owner.changeTab(position);
            var tabStripItems = owner.tabStrip && owner.tabStrip.items;
            if (position >= 0 && tabStripItems && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.selectEvent);
            }
            if (prevPosition >= 0 && tabStripItems && tabStripItems[prevPosition]) {
                tabStripItems[prevPosition]._emit(tab_strip_item_1.TabStripItem.unselectEvent);
            }
            owner.selectedIndex = position;
        };
        BottomNavigationBarImplementation.prototype.onTap = function (position) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            var tabStrip = owner.tabStrip;
            var tabStripItems = tabStrip && tabStrip.items;
            if (position >= 0 && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.tapEvent);
                tabStrip.notify({ eventName: tab_strip_1.TabStrip.itemTapEvent, object: tabStrip, index: position });
            }
            if (!owner.items[position]) {
                return false;
            }
            return true;
        };
        return BottomNavigationBarImplementation;
    }(org.nativescript.widgets.BottomNavigationBar));
    var AttachListener = (function (_super) {
        __extends(AttachListener, _super);
        function AttachListener() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        AttachListener.prototype.onViewAttachedToWindow = function (view) {
            var owner = view[ownerSymbol];
            if (owner) {
                owner._onAttachedToWindow();
            }
        };
        AttachListener.prototype.onViewDetachedFromWindow = function (view) {
            var owner = view[ownerSymbol];
            if (owner) {
                owner._onDetachedFromWindow();
            }
        };
        AttachListener = __decorate([
            Interfaces([android.view.View.OnAttachStateChangeListener])
        ], AttachListener);
        return AttachListener;
    }(java.lang.Object));
    TabFragment = TabFragmentImplementation;
    BottomNavigationBar = BottomNavigationBarImplementation;
    AttachStateChangeListener = new AttachListener();
}
function setElevation(bottomNavigationBar) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * utils_1.layout.getDisplayDensity();
        compat.setElevation(bottomNavigationBar, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var BottomNavigation = (function (_super) {
    __extends(BottomNavigation, _super);
    function BottomNavigation() {
        var _this = _super.call(this) || this;
        _this._contentViewId = -1;
        _this._attachedToWindow = false;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(BottomNavigation.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    BottomNavigation.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    BottomNavigation.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
        var contentView = new org.nativescript.widgets.ContentLayout(this._context);
        var contentViewLayoutParams = new org.nativescript.widgets.CommonLayoutParams();
        contentViewLayoutParams.row = 0;
        contentView.setLayoutParams(contentViewLayoutParams);
        nativeView.addView(contentView);
        nativeView.contentView = contentView;
        var bottomNavigationBar = new BottomNavigationBar(context, this);
        var bottomNavigationBarLayoutParams = new org.nativescript.widgets.CommonLayoutParams();
        bottomNavigationBarLayoutParams.row = 1;
        bottomNavigationBar.setLayoutParams(bottomNavigationBarLayoutParams);
        nativeView.addView(bottomNavigationBar);
        nativeView.bottomNavigationBar = bottomNavigationBar;
        setElevation(bottomNavigationBar);
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        if (primaryColor) {
            bottomNavigationBar.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    BottomNavigation.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._contentViewId < 0) {
            this._contentViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        nativeView.addOnAttachStateChangeListener(AttachStateChangeListener);
        nativeView[ownerSymbol] = this;
        this._contentView = nativeView.contentView;
        this._contentView.setId(this._contentViewId);
        this._bottomNavigationBar = nativeView.bottomNavigationBar;
        this._bottomNavigationBar.owner = this;
        if (this.tabStrip) {
            this.tabStrip.setNativeView(this._bottomNavigationBar);
        }
    };
    BottomNavigation.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = 0;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.content);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.content;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.content);
            }
        });
    };
    BottomNavigation.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this.tabStrip) {
            this.setTabStripItems(this.tabStrip.items);
        }
        else {
            this._bottomNavigationBar.setVisibility(android.view.View.GONE);
        }
        if (this._attachedToWindow) {
            this.changeTab(this.selectedIndex);
        }
    };
    BottomNavigation.prototype._onAttachedToWindow = function () {
        _super.prototype._onAttachedToWindow.call(this);
        this._attachedToWindow = true;
        this.changeTab(this.selectedIndex);
    };
    BottomNavigation.prototype._onDetachedFromWindow = function () {
        _super.prototype._onDetachedFromWindow.call(this);
        this._attachedToWindow = false;
    };
    BottomNavigation.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        if (this.tabStrip) {
            this.setTabStripItems(null);
        }
        var fragmentToDetach = this._currentFragment;
        if (fragmentToDetach) {
            this.destroyItem(fragmentToDetach.index, fragmentToDetach);
            this.commitCurrentTransaction();
        }
    };
    BottomNavigation.prototype.disposeNativeView = function () {
        this._bottomNavigationBar.setItems(null);
        this._bottomNavigationBar = null;
        this.nativeViewProtected.removeOnAttachStateChangeListener(AttachStateChangeListener);
        this.nativeViewProtected[ownerSymbol] = null;
        _super.prototype.disposeNativeView.call(this);
    };
    BottomNavigation.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeTabFragments();
    };
    BottomNavigation.prototype.disposeTabFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    Object.defineProperty(BottomNavigation.prototype, "currentTransaction", {
        get: function () {
            if (!this._currentTransaction) {
                var fragmentManager = this._getFragmentManager();
                this._currentTransaction = fragmentManager.beginTransaction();
            }
            return this._currentTransaction;
        },
        enumerable: true,
        configurable: true
    });
    BottomNavigation.prototype.commitCurrentTransaction = function () {
        if (this._currentTransaction) {
            this._currentTransaction.commitNowAllowingStateLoss();
            this._currentTransaction = null;
        }
    };
    BottomNavigation.prototype.changeTab = function (index) {
        if (index === -1) {
            return;
        }
        var fragmentToDetach = this._currentFragment;
        if (fragmentToDetach) {
            this.destroyItem(fragmentToDetach.index, fragmentToDetach);
        }
        var fragment = this.instantiateItem(this._contentView, index);
        this.setPrimaryItem(index, fragment);
        this.commitCurrentTransaction();
    };
    BottomNavigation.prototype.instantiateItem = function (container, position) {
        var name = makeFragmentName(container.getId(), position);
        var fragmentManager = this._getFragmentManager();
        var fragment = fragmentManager.findFragmentByTag(name);
        if (fragment != null) {
            this.currentTransaction.attach(fragment);
        }
        else {
            fragment = TabFragment.newInstance(this._domId, position);
            this.currentTransaction.add(container.getId(), fragment, name);
        }
        if (fragment !== this._currentFragment) {
            fragment.setMenuVisibility(false);
            fragment.setUserVisibleHint(false);
        }
        return fragment;
    };
    BottomNavigation.prototype.setPrimaryItem = function (position, fragment) {
        if (fragment !== this._currentFragment) {
            if (this._currentFragment != null) {
                this._currentFragment.setMenuVisibility(false);
                this._currentFragment.setUserVisibleHint(false);
            }
            if (fragment != null) {
                fragment.setMenuVisibility(true);
                fragment.setUserVisibleHint(true);
            }
            this._currentFragment = fragment;
            var tabItems = this.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
                this._loadUnloadTabItems(position);
            }
        }
    };
    BottomNavigation.prototype.destroyItem = function (position, fragment) {
        if (fragment) {
            this.currentTransaction.detach(fragment);
            if (this._currentFragment === fragment) {
                this._currentFragment = null;
            }
        }
        if (this.items && this.items[position]) {
            this.items[position].canBeLoaded = false;
        }
    };
    BottomNavigation.prototype.setTabStripItems = function (items) {
        var _this = this;
        if (!this.tabStrip || !items) {
            this._bottomNavigationBar.setItems(null);
            return;
        }
        var tabItems = new Array();
        items.forEach(function (item, i, arr) {
            item.index = i;
            if (items[i]) {
                var tabItemSpec = _this.createTabItemSpec(items[i]);
                tabItems.push(tabItemSpec);
            }
        });
        this._bottomNavigationBar.setItems(tabItems);
        items.forEach(function (item, i, arr) {
            var textView = _this._bottomNavigationBar.getTextViewForItemAt(i);
            item.setNativeView(textView);
        });
    };
    BottomNavigation.prototype.createTabItemSpec = function (tabStripItem) {
        var tabItemSpec = new org.nativescript.widgets.TabItemSpec();
        if (tabStripItem.isLoaded) {
            var titleLabel = tabStripItem.label;
            var title = titleLabel.text;
            var textTransform = titleLabel.style.textTransform;
            if (textTransform) {
                title = text_base_1.getTransformedText(title, textTransform);
            }
            tabItemSpec.title = title;
            var backgroundColor = tabStripItem.style.backgroundColor;
            if (backgroundColor) {
                tabItemSpec.backgroundColor = backgroundColor.android;
            }
            var color = titleLabel.style.color;
            if (color) {
                tabItemSpec.color = color.android;
            }
            var fontInternal = titleLabel.style.fontInternal;
            if (fontInternal) {
                tabItemSpec.fontSize = fontInternal.fontSize;
                tabItemSpec.typeFace = fontInternal.getAndroidTypeface();
            }
            var iconSource = tabStripItem.image && tabStripItem.image.src;
            if (iconSource) {
                var icon = this.getIcon(tabStripItem);
                if (icon) {
                    tabItemSpec.iconDrawable = icon;
                }
                else {
                }
            }
        }
        return tabItemSpec;
    };
    BottomNavigation.prototype.getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image && tabStripItem.image.src;
        var is;
        if (utils_1.isFontIconURI(iconSource)) {
            var fontIconCode = iconSource.split("//")[1];
            var target = tabStripItem.image ? tabStripItem.image : tabStripItem;
            var font = target.style.fontInternal;
            var color = target.style.color;
            is = image_source_1.fromFontIconCode(fontIconCode, font, color);
        }
        else {
            is = image_source_1.fromFileOrResource(iconSource);
        }
        var imageDrawable;
        if (is && is.android) {
            var image = is.android;
            if (this.tabStrip && this.tabStrip.isIconSizeFixed) {
                image = this.getFixedSizeIcon(image);
            }
            imageDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), image);
        }
        else {
        }
        return imageDrawable;
    };
    BottomNavigation.prototype.getFixedSizeIcon = function (image) {
        var inWidth = image.getWidth();
        var inHeight = image.getHeight();
        var iconSpecSize = tab_navigation_base_1.getIconSpecSize({ width: inWidth, height: inHeight });
        var widthPixels = iconSpecSize.width * utils_1.layout.getDisplayDensity();
        var heightPixels = iconSpecSize.height * utils_1.layout.getDisplayDensity();
        var scaledImage = android.graphics.Bitmap.createScaledBitmap(image, widthPixels, heightPixels, true);
        return scaledImage;
    };
    BottomNavigation.prototype.updateAndroidItemAt = function (index, spec) {
        this._bottomNavigationBar.updateItemAt(index, spec);
    };
    BottomNavigation.prototype.getTabBarBackgroundColor = function () {
        return this._bottomNavigationBar.getBackground();
    };
    BottomNavigation.prototype.setTabBarBackgroundColor = function (value) {
        if (value instanceof view_1.Color) {
            this._bottomNavigationBar.setBackgroundColor(value.android);
        }
        else {
            this._bottomNavigationBar.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    BottomNavigation.prototype.setTabBarItemTitle = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    BottomNavigation.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    BottomNavigation.prototype.setTabBarItemColor = function (tabStripItem, value) {
        if (typeof value === "number") {
            tabStripItem.nativeViewProtected.setTextColor(value);
        }
        else {
            tabStripItem.nativeViewProtected.setTextColor(value.android);
        }
    };
    BottomNavigation.prototype.setTabBarIconColor = function (tabStripItem, value) {
        var index = tabStripItem.index;
        var tabBarItem = this._bottomNavigationBar.getViewForItemAt(index);
        var imgView = tabBarItem.getChildAt(0);
        var drawable = this.getIcon(tabStripItem);
        imgView.setImageDrawable(drawable);
    };
    BottomNavigation.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
        tabStripItem.nativeViewProtected.setTextSize(value.fontSize);
        tabStripItem.nativeViewProtected.setTypeface(value.getAndroidTypeface());
    };
    BottomNavigation.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
        var titleLabel = tabStripItem.label;
        var title = text_base_1.getTransformedText(titleLabel.text, value);
        tabStripItem.nativeViewProtected.setText(title);
    };
    BottomNavigation.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        if (this.tabStrip) {
            this._bottomNavigationBar.setSelectedPosition(value);
        }
        else {
            this.changeTab(value);
        }
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        if (value) {
            value.forEach(function (item, i) {
                item.index = i;
            });
        }
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    BottomNavigation.prototype[tab_navigation_base_1.tabStripProperty.getDefault] = function () {
        return null;
    };
    BottomNavigation.prototype[tab_navigation_base_1.tabStripProperty.setNative] = function (value) {
        var items = this.tabStrip ? this.tabStrip.items : null;
        this.setTabStripItems(items);
    };
    BottomNavigation = __decorate([
        view_1.CSSType("BottomNavigation")
    ], BottomNavigation);
    return BottomNavigation;
}(tab_navigation_base_1.TabNavigationBase));
exports.BottomNavigation = BottomNavigation;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=bottom-navigation.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/binding-builder.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var expressionSymbolsRegex = /[\+\-\*\/%\?:<>=!\|&\(\)^~]/;
var bindingConstants;
(function (bindingConstants) {
    bindingConstants.sourceProperty = "sourceProperty";
    bindingConstants.targetProperty = "targetProperty";
    bindingConstants.expression = "expression";
    bindingConstants.twoWay = "twoWay";
    bindingConstants.source = "source";
    bindingConstants.bindingValueKey = "$value";
    bindingConstants.parentValueKey = "$parent";
    bindingConstants.parentsValueKey = "$parents";
    bindingConstants.newPropertyValueKey = "$newPropertyValue";
})(bindingConstants = exports.bindingConstants || (exports.bindingConstants = {}));
var hasEqualSignRegex = /=+/;
var equalSignComparisionOperatorsRegex = /(==|===|>=|<=|!=|!==)/;
exports.parentsRegex = /\$parents\s*\[\s*(['"]*)\w*\1\s*\]/g;
function isNamedParam(value) {
    var equalSignIndex = value.search(hasEqualSignRegex);
    if (equalSignIndex > -1) {
        var equalSignSurround = value.substr(equalSignIndex > 0 ? equalSignIndex - 1 : 0, 3);
        if (equalSignSurround.search(equalSignComparisionOperatorsRegex) === -1) {
            return true;
        }
    }
    return false;
}
function areNamedParams(params) {
    for (var i = 0; i < params.length; i++) {
        if (isNamedParam(params[i])) {
            return true;
        }
    }
    return false;
}
var namedParamConstants = {
    propName: "propName",
    propValue: "propValue"
};
function getPropertyNameValuePair(param, knownOptions, callback) {
    var nameValuePair = {};
    var propertyName = param.substr(0, param.indexOf("=")).trim();
    var propertyValue = param.substr(param.indexOf("=") + 1).trim();
    if (knownOptions) {
        if (!propertyName) {
            propertyName = knownOptions.defaultProperty;
        }
        else {
            propertyName = propertyName in knownOptions ? propertyName : null;
        }
    }
    if (propertyName) {
        if (callback) {
            nameValuePair = callback(propertyName, propertyValue);
        }
        else {
            nameValuePair[namedParamConstants.propName] = propertyName;
            nameValuePair[namedParamConstants.propValue] = propertyValue;
        }
        return nameValuePair;
    }
    return null;
}
function parseNamedProperties(parameterList, knownOptions, callback) {
    var result = {};
    var nameValuePair;
    for (var i = 0; i < parameterList.length; i++) {
        nameValuePair = getPropertyNameValuePair(parameterList[i], knownOptions, callback);
        if (nameValuePair) {
            result[nameValuePair[namedParamConstants.propName]] = nameValuePair[namedParamConstants.propValue];
        }
    }
    return result;
}
function getParamsArray(value) {
    var result = [];
    var skipComma = 0;
    var indexReached = 0;
    var singleQuoteBlock = false;
    var doubleQuoteBlock = false;
    for (var i = 0; i < value.length; i++) {
        if (value[i] === "\"") {
            doubleQuoteBlock = !doubleQuoteBlock;
        }
        if (value[i] === "'") {
            singleQuoteBlock = !singleQuoteBlock;
        }
        if (value[i] === "(" || value[i] === "[") {
            skipComma++;
        }
        if (value[i] === ")" || value[i] === "]") {
            skipComma--;
        }
        if (value[i] === "," && skipComma === 0 && !(singleQuoteBlock || doubleQuoteBlock)) {
            result.push(value.substr(indexReached, i - indexReached));
            indexReached = i + 1;
        }
    }
    result.push(value.substr(indexReached));
    return result;
}
function isExpression(expression) {
    if (expression.search(expressionSymbolsRegex) > -1) {
        var parentsMatches = expression.match(exports.parentsRegex);
        if (parentsMatches) {
            var restOfExpression = expression.substr(expression.indexOf(parentsMatches[0]) + parentsMatches[0].length);
            if (!(restOfExpression.search(expressionSymbolsRegex) > -1)) {
                return false;
            }
        }
        return true;
    }
    return false;
}
function getBindingOptions(name, value) {
    var namedParams = [];
    var params = getParamsArray(value);
    if (!areNamedParams(params)) {
        if (params.length === 1) {
            var trimmedValue = params[0].trim();
            var sourceProp = void 0;
            if (isExpression(trimmedValue)) {
                sourceProp = bindingConstants.bindingValueKey;
                namedParams.push(bindingConstants.expression + " = " + trimmedValue);
            }
            else {
                sourceProp = trimmedValue;
            }
            namedParams.push(bindingConstants.sourceProperty + " = " + sourceProp);
            namedParams.push(bindingConstants.twoWay + " = true");
        }
        else {
            namedParams.push(bindingConstants.sourceProperty + " = " + params[0].trim());
            namedParams.push(bindingConstants.expression + " = " + params[1].trim());
            var twoWay = params[2] ? params[2].toLowerCase().trim() === "true" : true;
            namedParams.push(bindingConstants.twoWay + " = " + twoWay);
        }
    }
    else {
        namedParams = params;
    }
    var bindingPropertyHandler = function (prop, value) {
        var result = {};
        result[namedParamConstants.propName] = prop;
        if (prop === bindingConstants.twoWay) {
            if (value === "true") {
                result[namedParamConstants.propValue] = true;
            }
            else {
                result[namedParamConstants.propValue] = false;
            }
        }
        else {
            result[namedParamConstants.propValue] = value;
        }
        return result;
    };
    var bindingOptionsParameters = parseNamedProperties(namedParams, xmlBindingProperties, bindingPropertyHandler);
    var bindOptions = {
        targetProperty: name
    };
    for (var prop in bindingOptionsParameters) {
        if (bindingOptionsParameters.hasOwnProperty(prop)) {
            bindOptions[prop] = bindingOptionsParameters[prop];
        }
    }
    if (bindOptions[bindingConstants.twoWay] === undefined) {
        bindOptions[bindingConstants.twoWay] = true;
    }
    return bindOptions;
}
exports.getBindingOptions = getBindingOptions;
var xmlBindingProperties = {
    sourceProperty: true,
    expression: true,
    twoWay: true,
    source: true,
    defaultProperty: bindingConstants.sourceProperty
};
//# sourceMappingURL=binding-builder.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var xml = __webpack_require__("../node_modules/tns-core-modules/xml/xml.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var component_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var ios = platform_1.platformNames.ios.toLowerCase();
var android = platform_1.platformNames.android.toLowerCase();
var defaultNameSpaceMatcher = /tns\.xsd$/i;
function parse(value, context) {
    if (typeof value === "function") {
        return value();
    }
    else {
        var exports_1 = context ? getExports(context) : undefined;
        var componentModule = parseInternal(value, exports_1);
        return componentModule && componentModule.component;
    }
}
exports.parse = parse;
function parseMultipleTemplates(value, context) {
    var dummyComponent = "<ListView><ListView.itemTemplates>" + value + "</ListView.itemTemplates></ListView>";
    return parseInternal(dummyComponent, context).component["itemTemplates"];
}
exports.parseMultipleTemplates = parseMultipleTemplates;
function load(pathOrOptions, context) {
    var componentModule;
    if (typeof pathOrOptions === "string") {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(pathOrOptions);
        componentModule = loadInternal(moduleName, context);
    }
    else {
        componentModule = loadCustomComponent(pathOrOptions.path, pathOrOptions.name, pathOrOptions.attributes, pathOrOptions.exports, pathOrOptions.page, true);
    }
    return componentModule && componentModule.component;
}
exports.load = load;
exports.createViewFromEntry = profiling_1.profile("createViewFromEntry", function (entry) {
    if (entry.create) {
        var view = entry.create();
        if (!view) {
            throw new Error("Failed to create View with entry.create() function.");
        }
        return view;
    }
    else if (entry.moduleName) {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(entry.moduleName);
        var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
        var moduleExports = resolvedCodeModuleName ? global.loadModule(resolvedCodeModuleName, true) : null;
        if (moduleExports && moduleExports.createPage) {
            var view = moduleExports.createPage();
            var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
            if (resolvedCssModuleName) {
                view.addCssFile(resolvedCssModuleName);
            }
            return view;
        }
        else {
            var componentModule = loadInternal(moduleName, moduleExports);
            var componentView = componentModule && componentModule.component;
            return componentView;
        }
    }
    throw new Error("Failed to load page XML file for module: " + entry.moduleName);
});
function loadInternal(moduleName, moduleExports) {
    var componentModule;
    var resolvedXmlModule = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    if (resolvedXmlModule) {
        var text = global.loadModule(resolvedXmlModule, true);
        componentModule = parseInternal(text, moduleExports, resolvedXmlModule, moduleName);
    }
    var componentView = componentModule && componentModule.component;
    if (componentView) {
        componentView.exports = moduleExports;
        componentView._moduleName = moduleName;
    }
    if (!componentModule) {
        throw new Error("Failed to load component from module: " + moduleName);
    }
    return componentModule;
}
function loadCustomComponent(componentNamespace, componentName, attributes, context, parentPage, isRootComponent, moduleNamePath) {
    if (isRootComponent === void 0) { isRootComponent = true; }
    if (!parentPage && context) {
        parentPage = context["_parentPage"];
        delete context["_parentPage"];
    }
    var result;
    componentNamespace = module_name_sanitizer_1.sanitizeModuleName(componentNamespace);
    var moduleName = componentNamespace + "/" + componentName;
    var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
    var resolvedXmlModuleName = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
    if (resolvedXmlModuleName) {
        var subExports = context;
        if (resolvedCodeModuleName) {
            subExports = global.loadModule(resolvedCodeModuleName, true);
        }
        if (!subExports) {
            subExports = {};
        }
        subExports["_parentPage"] = parentPage;
        result = loadInternal(moduleName, subExports);
        if (types_1.isDefined(result) && types_1.isDefined(result.component) && types_1.isDefined(attributes)) {
            for (var attr in attributes) {
                component_builder_1.setPropertyValue(result.component, subExports, context, attr, attributes[attr]);
            }
        }
    }
    else {
        result = component_builder_1.getComponentModule(componentName, componentNamespace, attributes, context, moduleNamePath, isRootComponent);
        if (!resolvedCssModuleName) {
            resolvedCssModuleName = module_name_resolver_1.resolveModuleName(componentNamespace, "css");
        }
    }
    if (parentPage && resolvedCssModuleName) {
        parentPage.addCssFile(resolvedCssModuleName);
    }
    return result;
}
function getExports(instance) {
    var isView = !!instance._domId;
    if (!isView) {
        return instance.exports || instance;
    }
    var exportObject = instance.exports;
    var parent = instance.parent;
    while (exportObject === undefined && parent) {
        exportObject = parent.exports;
        parent = parent.parent;
    }
    return exportObject;
}
function parseInternal(value, context, xmlModule, moduleName) {
    var start;
    var ui;
    var errorFormat = (debug_1.debug && xmlModule) ? xml2ui.SourceErrorFormat(xmlModule) : xml2ui.PositionErrorFormat;
    var componentSourceTracker = (debug_1.debug && xmlModule) ? xml2ui.ComponentSourceTracker(xmlModule) : function () {
    };
    (start = new xml2ui.XmlStringParser(errorFormat))
        .pipe(new xml2ui.PlatformFilter())
        .pipe(new xml2ui.XmlStateParser(ui = new xml2ui.ComponentParser(context, errorFormat, componentSourceTracker, moduleName)));
    start.parse(value);
    return ui.rootComponentModule;
}
var xml2ui;
(function (xml2ui) {
    var XmlProducerBase = (function () {
        function XmlProducerBase() {
        }
        XmlProducerBase.prototype.pipe = function (next) {
            this._next = next;
            return next;
        };
        XmlProducerBase.prototype.next = function (args) {
            this._next.parse(args);
        };
        return XmlProducerBase;
    }());
    xml2ui.XmlProducerBase = XmlProducerBase;
    var XmlStringParser = (function (_super) {
        __extends(XmlStringParser, _super);
        function XmlStringParser(error) {
            var _this = _super.call(this) || this;
            _this.error = error || PositionErrorFormat;
            return _this;
        }
        XmlStringParser.prototype.parse = function (value) {
            var _this = this;
            var xmlParser = new xml.XmlParser(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            }, function (e, p) {
                throw _this.error(e, p);
            }, true);
            if (types_1.isString(value)) {
                xmlParser.parse(value);
            }
        };
        return XmlStringParser;
    }(XmlProducerBase));
    xml2ui.XmlStringParser = XmlStringParser;
    function PositionErrorFormat(e, p) {
        return new debug_1.ScopeError(e, "Parsing XML at " + p.line + ":" + p.column);
    }
    xml2ui.PositionErrorFormat = PositionErrorFormat;
    function SourceErrorFormat(uri) {
        return function (e, p) {
            var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
            e = new debug_1.SourceError(e, source, "Building UI from XML.");
            return e;
        };
    }
    xml2ui.SourceErrorFormat = SourceErrorFormat;
    function ComponentSourceTracker(uri) {
        return function (component, p) {
            if (!debug_1.Source.get(component)) {
                var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
                debug_1.Source.set(component, source);
            }
        };
    }
    xml2ui.ComponentSourceTracker = ComponentSourceTracker;
    var PlatformFilter = (function (_super) {
        __extends(PlatformFilter, _super);
        function PlatformFilter() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        PlatformFilter.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    if (this.currentPlatformContext) {
                        throw new Error("Already in '" + this.currentPlatformContext + "' platform context and cannot switch to '" + args.elementName + "' platform! Platform tags cannot be nested.");
                    }
                    this.currentPlatformContext = args.elementName;
                    return;
                }
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    this.currentPlatformContext = undefined;
                    return;
                }
            }
            if (this.currentPlatformContext && !PlatformFilter.isCurentPlatform(this.currentPlatformContext)) {
                return;
            }
            this.next(args);
        };
        PlatformFilter.isPlatform = function (value) {
            if (value) {
                var toLower = value.toLowerCase();
                return toLower === android || toLower === ios;
            }
            return false;
        };
        PlatformFilter.isCurentPlatform = function (value) {
            return value && value.toLowerCase() === platform_1.device.os.toLowerCase();
        };
        return PlatformFilter;
    }(XmlProducerBase));
    xml2ui.PlatformFilter = PlatformFilter;
    var XmlArgsReplay = (function (_super) {
        __extends(XmlArgsReplay, _super);
        function XmlArgsReplay(args, errorFormat) {
            var _this = _super.call(this) || this;
            _this.args = args;
            _this.error = errorFormat;
            return _this;
        }
        XmlArgsReplay.prototype.replay = function () {
            var _this = this;
            this.args.forEach(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            });
        };
        return XmlArgsReplay;
    }(XmlProducerBase));
    xml2ui.XmlArgsReplay = XmlArgsReplay;
    var XmlStateParser = (function () {
        function XmlStateParser(state) {
            this.state = state;
        }
        XmlStateParser.prototype.parse = function (args) {
            this.state = this.state.parse(args);
        };
        return XmlStateParser;
    }());
    xml2ui.XmlStateParser = XmlStateParser;
    var TemplateParser = (function () {
        function TemplateParser(parent, templateProperty, setTemplateProperty) {
            if (setTemplateProperty === void 0) { setTemplateProperty = true; }
            this.parent = parent;
            this._context = templateProperty.context;
            this._recordedXmlStream = new Array();
            this._templateProperty = templateProperty;
            this._nestingLevel = 0;
            this._state = 0;
            this._setTemplateProperty = setTemplateProperty;
        }
        TemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                this.parseStartElement(args.prefix, args.namespace, args.elementName, args.attributes);
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                this.parseEndElement(args.prefix, args.elementName);
            }
            this._recordedXmlStream.push(args);
            return this._state === 2 ? this.parent : this;
        };
        Object.defineProperty(TemplateParser.prototype, "elementName", {
            get: function () {
                return this._templateProperty.elementName;
            },
            enumerable: true,
            configurable: true
        });
        TemplateParser.prototype.parseStartElement = function (prefix, namespace, elementName, attributes) {
            if (this._state === 0) {
                this._state = 1;
            }
            else if (this._state === 2) {
                throw new Error("Template must have exactly one root element but multiple elements were found.");
            }
            this._nestingLevel++;
        };
        TemplateParser.prototype.parseEndElement = function (prefix, elementName) {
            if (this._state === 0) {
                throw new Error("Template must have exactly one root element but none was found.");
            }
            else if (this._state === 2) {
                throw new Error("No more closing elements expected for this template.");
            }
            this._nestingLevel--;
            if (this._nestingLevel === 0) {
                this._state = 2;
                if (this._setTemplateProperty && this._templateProperty.name in this._templateProperty.parent.component) {
                    var template = this.buildTemplate();
                    this._templateProperty.parent.component[this._templateProperty.name] = template;
                }
            }
        };
        TemplateParser.prototype.buildTemplate = function () {
            var _this = this;
            var context = this._context;
            var errorFormat = this._templateProperty.errorFormat;
            var sourceTracker = this._templateProperty.sourceTracker;
            var template = profiling_1.profile("Template()", function () {
                var start;
                var ui;
                (start = new xml2ui.XmlArgsReplay(_this._recordedXmlStream, errorFormat))
                    .pipe(new XmlStateParser(ui = new ComponentParser(context, errorFormat, sourceTracker)));
                start.replay();
                return ui.rootComponentModule.component;
            });
            return template;
        };
        return TemplateParser;
    }());
    xml2ui.TemplateParser = TemplateParser;
    var MultiTemplateParser = (function () {
        function MultiTemplateParser(parent, templateProperty) {
            this.parent = parent;
            this.templateProperty = templateProperty;
            this._childParsers = new Array();
        }
        Object.defineProperty(MultiTemplateParser.prototype, "value", {
            get: function () { return this._value; },
            enumerable: true,
            configurable: true
        });
        MultiTemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement && args.elementName === "template") {
                var childParser = new TemplateParser(this, this.templateProperty, false);
                childParser["key"] = args.attributes["key"];
                this._childParsers.push(childParser);
                return childParser;
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                var name_1 = ComponentParser.getComplexPropertyName(args.elementName);
                if (name_1 === this.templateProperty.name) {
                    var templates = new Array();
                    for (var i = 0; i < this._childParsers.length; i++) {
                        templates.push({
                            key: this._childParsers[i]["key"],
                            createView: this._childParsers[i].buildTemplate()
                        });
                    }
                    this._value = templates;
                    return this.parent.parse(args);
                }
            }
            return this;
        };
        return MultiTemplateParser;
    }());
    xml2ui.MultiTemplateParser = MultiTemplateParser;
    var ComponentParser = (function () {
        function ComponentParser(context, errorFormat, sourceTracker, moduleName) {
            this.moduleName = moduleName;
            this.parents = new Array();
            this.complexProperties = new Array();
            this.context = context;
            this.error = errorFormat;
            this.sourceTracker = sourceTracker;
        }
        ComponentParser.prototype.buildComponent = function (args) {
            if (args.prefix && args.namespace) {
                return loadCustomComponent(args.namespace, args.elementName, args.attributes, this.context, this.currentRootView, !this.currentRootView, this.moduleName);
            }
            else {
                var namespace = args.namespace;
                if (defaultNameSpaceMatcher.test(namespace || "")) {
                    namespace = undefined;
                }
                return component_builder_1.getComponentModule(args.elementName, namespace, args.attributes, this.context, this.moduleName, !this.currentRootView);
            }
        };
        ComponentParser.prototype.parse = function (args) {
            var parent = this.parents[this.parents.length - 1];
            var complexProperty = this.complexProperties[this.complexProperties.length - 1];
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    var name_2 = ComponentParser.getComplexPropertyName(args.elementName);
                    var complexProperty_1 = {
                        parent: parent,
                        name: name_2,
                        items: []
                    };
                    this.complexProperties.push(complexProperty_1);
                    if (ComponentParser.isKnownTemplate(name_2, parent.exports)) {
                        return new TemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                    }
                    if (ComponentParser.isKnownMultiTemplate(name_2, parent.exports)) {
                        var parser = new MultiTemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                        complexProperty_1.parser = parser;
                        return parser;
                    }
                }
                else {
                    var componentModule = this.buildComponent(args);
                    if (componentModule) {
                        this.sourceTracker(componentModule.component, args.position);
                        if (parent) {
                            if (complexProperty) {
                                ComponentParser.addToComplexProperty(parent, complexProperty, componentModule);
                            }
                            else if (parent.component._addChildFromBuilder) {
                                parent.component._addChildFromBuilder(args.elementName, componentModule.component);
                            }
                        }
                        else if (this.parents.length === 0) {
                            this.rootComponentModule = componentModule;
                            if (this.rootComponentModule) {
                                this.currentRootView = this.rootComponentModule.component;
                                if (this.currentRootView.exports) {
                                    this.context = this.currentRootView.exports;
                                }
                            }
                        }
                        this.parents.push(componentModule);
                    }
                }
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    if (complexProperty) {
                        if (complexProperty.parser) {
                            parent.component[complexProperty.name] = complexProperty.parser.value;
                        }
                        else if (parent && parent.component._addArrayFromBuilder) {
                            parent.component._addArrayFromBuilder(complexProperty.name, complexProperty.items);
                            complexProperty.items = [];
                        }
                    }
                    this.complexProperties.pop();
                }
                else {
                    this.parents.pop();
                }
            }
            return this;
        };
        ComponentParser.isComplexProperty = function (name) {
            return types_1.isString(name) && name.indexOf(".") !== -1;
        };
        ComponentParser.getComplexPropertyName = function (fullName) {
            var name;
            if (types_1.isString(fullName)) {
                var names = fullName.split(".");
                name = names[names.length - 1];
            }
            return name;
        };
        ComponentParser.isKnownTemplate = function (name, exports) {
            return ComponentParser.KNOWNTEMPLATES in exports && exports[ComponentParser.KNOWNTEMPLATES] && name in exports[ComponentParser.KNOWNTEMPLATES];
        };
        ComponentParser.isKnownMultiTemplate = function (name, exports) {
            return ComponentParser.KNOWNMULTITEMPLATES in exports && exports[ComponentParser.KNOWNMULTITEMPLATES] && name in exports[ComponentParser.KNOWNMULTITEMPLATES];
        };
        ComponentParser.addToComplexProperty = function (parent, complexProperty, elementModule) {
            var parentComponent = parent.component;
            if (ComponentParser.isKnownCollection(complexProperty.name, parent.exports)) {
                complexProperty.items.push(elementModule.component);
            }
            else if (parentComponent._addChildFromBuilder) {
                parentComponent._addChildFromBuilder(complexProperty.name, elementModule.component);
            }
            else {
                parentComponent[complexProperty.name] = elementModule.component;
            }
        };
        ComponentParser.isKnownCollection = function (name, context) {
            return ComponentParser.KNOWNCOLLECTIONS in context && context[ComponentParser.KNOWNCOLLECTIONS] && name in context[ComponentParser.KNOWNCOLLECTIONS];
        };
        ComponentParser.KNOWNCOLLECTIONS = "knownCollections";
        ComponentParser.KNOWNTEMPLATES = "knownTemplates";
        ComponentParser.KNOWNMULTITEMPLATES = "knownMultiTemplates";
        __decorate([
            profiling_1.profile
        ], ComponentParser.prototype, "buildComponent", null);
        return ComponentParser;
    }());
    xml2ui.ComponentParser = ComponentParser;
})(xml2ui || (xml2ui = {}));
//# sourceMappingURL=builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var UI_PATH = "ui/";
var MODULES = {
    "TabViewItem": "ui/tab-view",
    "TabStrip": "ui/tab-navigation-base/tab-strip",
    "TabStripItem": "ui/tab-navigation-base/tab-strip-item",
    "TabContentItem": "ui/tab-navigation-base/tab-content-item",
    "FormattedString": "text/formatted-string",
    "Span": "text/span",
    "ActionItem": "ui/action-bar",
    "NavigationButton": "ui/action-bar",
    "SegmentedBarItem": "ui/segmented-bar",
};
var CODE_FILE = "codeFile";
var CSS_FILE = "cssFile";
var IMPORT = "import";
var createComponentInstance = profiling_1.profile("createComponentInstance", function (elementName, namespace) {
    var instance;
    var instanceModule;
    var resolvedModuleName;
    try {
        if (typeof namespace === "string") {
            resolvedModuleName = module_name_resolver_1.resolveModuleName(namespace, "");
            instanceModule = global.loadModule(resolvedModuleName, true);
        }
        else {
            resolvedModuleName = MODULES[elementName] || UI_PATH +
                (elementName.toLowerCase().indexOf("layout") !== -1 ? "layouts/" : "") +
                elementName.split(/(?=[A-Z])/).join("-").toLowerCase();
            instanceModule = global.loadModule(resolvedModuleName, false);
        }
        var instanceType = instanceModule[elementName] || Object;
        instance = new instanceType();
    }
    catch (ex) {
        var debug = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
        throw new debug.ScopeError(ex, "Module '" + resolvedModuleName + "' not found for element '" + (namespace ? namespace + ":" : "") + elementName + "'.");
    }
    return { instance: instance, instanceModule: instanceModule };
});
var getComponentModuleExports = profiling_1.profile("getComponentModuleExports", function (instance, moduleExports, attributes) {
    if (attributes) {
        var codeFileAttribute = attributes[CODE_FILE] || attributes[IMPORT];
        if (codeFileAttribute) {
            var resolvedCodeFileModule = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(codeFileAttribute), "");
            if (resolvedCodeFileModule) {
                moduleExports = global.loadModule(resolvedCodeFileModule, true);
                instance.exports = moduleExports;
            }
            else {
                throw new Error("Code file with path \"" + codeFileAttribute + "\" cannot be found! Looking for webpack module with name \"" + resolvedCodeFileModule + "\"");
            }
        }
    }
    return moduleExports;
});
var applyComponentCss = profiling_1.profile("applyComponentCss", function (instance, moduleName, attributes) {
    var cssApplied = false;
    if (attributes && attributes[CSS_FILE]) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(attributes[CSS_FILE]), "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
            cssApplied = true;
        }
        else {
            throw new Error("Css file with path \"" + attributes[CSS_FILE] + "\" cannot be found! Looking for webpack module with name \"" + resolvedCssModuleName + "\"");
        }
    }
    if (moduleName && !cssApplied) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
        }
    }
});
var applyComponentAttributes = profiling_1.profile("applyComponentAttributes", function (instance, instanceModule, moduleExports, attributes) {
    if (instance && instanceModule) {
        for (var attr in attributes) {
            var attrValue = attributes[attr];
            if (attr.indexOf(":") !== -1) {
                var platformName = attr.split(":")[0].trim();
                if (platformName.toLowerCase() === platform.device.os.toLowerCase()) {
                    attr = attr.split(":")[1].trim();
                }
                else {
                    continue;
                }
            }
            if (attr.indexOf(".") !== -1) {
                var subObj = instance;
                var properties = attr.split(".");
                var subPropName = properties[properties.length - 1];
                for (var i = 0; i < properties.length - 1; i++) {
                    if (subObj !== undefined && subObj !== null) {
                        subObj = subObj[properties[i]];
                    }
                }
                if (subObj !== undefined && subObj !== null) {
                    setPropertyValue(subObj, instanceModule, moduleExports, subPropName, attrValue);
                }
            }
            else {
                setPropertyValue(instance, instanceModule, moduleExports, attr, attrValue);
            }
        }
    }
});
function getComponentModule(elementName, namespace, attributes, moduleExports, moduleNamePath, isRootComponent) {
    elementName = elementName.split("-").map(function (s) { return s[0].toUpperCase() + s.substring(1); }).join("");
    var _a = createComponentInstance(elementName, namespace), instance = _a.instance, instanceModule = _a.instanceModule;
    moduleExports = getComponentModuleExports(instance, moduleExports, attributes);
    if (isRootComponent) {
        applyComponentCss(instance, moduleNamePath, attributes);
    }
    applyComponentAttributes(instance, instanceModule, moduleExports, attributes);
    var componentModule;
    if (instance && instanceModule) {
        componentModule = { component: instance, exports: instanceModule };
    }
    return componentModule;
}
exports.getComponentModule = getComponentModule;
function setPropertyValue(instance, instanceModule, exports, propertyName, propertyValue) {
    if (isBinding(propertyValue) && instance.bind) {
        var bindOptions = binding_builder_1.getBindingOptions(propertyName, getBindingExpressionFromAttribute(propertyValue));
        instance.bind({
            sourceProperty: bindOptions[binding_builder_1.bindingConstants.sourceProperty],
            targetProperty: bindOptions[binding_builder_1.bindingConstants.targetProperty],
            expression: bindOptions[binding_builder_1.bindingConstants.expression],
            twoWay: bindOptions[binding_builder_1.bindingConstants.twoWay]
        }, bindOptions[binding_builder_1.bindingConstants.source]);
    }
    else if (bindable_1.isEventOrGesture(propertyName, instance)) {
        var handler = exports && exports[propertyValue];
        if (typeof handler === "function") {
            instance.on(propertyName, handler);
        }
    }
    else if (isKnownFunction(propertyName, instance) && exports && typeof exports[propertyValue] === "function") {
        instance[propertyName] = exports[propertyValue];
    }
    else {
        instance[propertyName] = propertyValue;
    }
}
exports.setPropertyValue = setPropertyValue;
function getBindingExpressionFromAttribute(value) {
    return value.replace("{{", "").replace("}}", "").trim();
}
function isBinding(value) {
    var isBinding;
    if (typeof value === "string") {
        var str = value.trim();
        isBinding = str.indexOf("{{") === 0 && str.lastIndexOf("}}") === str.length - 2;
    }
    return isBinding;
}
var KNOWN_FUNCTIONS = "knownFunctions";
function isKnownFunction(name, instance) {
    return instance.constructor
        && KNOWN_FUNCTIONS in instance.constructor
        && instance.constructor[KNOWN_FUNCTIONS].indexOf(name) !== -1;
}
//# sourceMappingURL=component-builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function sanitizeModuleName(moduleName, removeExtension) {
    if (removeExtension === void 0) { removeExtension = true; }
    moduleName = moduleName.trim();
    if (moduleName.startsWith("~/")) {
        moduleName = moduleName.substring(2);
    }
    else if (moduleName.startsWith("~")) {
        moduleName = moduleName.substring(1);
    }
    else if (moduleName.startsWith("/")) {
        moduleName = moduleName.substring(1);
    }
    if (removeExtension) {
        var extToRemove = ["js", "ts", "xml", "html", "css", "scss"];
        var extensionRegEx = new RegExp("(.*)\\.(?:" + extToRemove.join("|") + ")", "i");
        moduleName = moduleName.replace(extensionRegEx, "$1");
    }
    return moduleName;
}
exports.sanitizeModuleName = sanitizeModuleName;
//# sourceMappingURL=module-name-sanitizer.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var ButtonBase = (function (_super) {
    __extends(ButtonBase, _super);
    function ButtonBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ButtonBase.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    ButtonBase.tapEvent = "tap";
    ButtonBase = __decorate([
        text_base_1.CSSType("Button")
    ], ButtonBase);
    return ButtonBase;
}(text_base_1.TextBase));
exports.ButtonBase = ButtonBase;
ButtonBase.prototype.recycleNativeView = "auto";
//# sourceMappingURL=button-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var button_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js"));
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var ClickListener;
var APILEVEL;
var AndroidButton;
function initializeClickListener() {
    if (ClickListener) {
        return;
    }
    var ClickListenerImpl = (function (_super) {
        __extends(ClickListenerImpl, _super);
        function ClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ClickListenerImpl.prototype.onClick = function (v) {
            var owner = this.owner;
            if (owner) {
                owner._emit(button_common_1.ButtonBase.tapEvent);
            }
        };
        ClickListenerImpl = __decorate([
            Interfaces([android.view.View.OnClickListener])
        ], ClickListenerImpl);
        return ClickListenerImpl;
    }(java.lang.Object));
    ClickListener = ClickListenerImpl;
}
var Button = (function (_super) {
    __extends(Button, _super);
    function Button() {
        var _this = _super.call(this) || this;
        if (!APILEVEL) {
            APILEVEL = android.os.Build.VERSION.SDK_INT;
        }
        return _this;
    }
    Button.prototype.createNativeView = function () {
        if (!AndroidButton) {
            AndroidButton = android.widget.Button;
        }
        return new AndroidButton(this._context);
    };
    Button.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeClickListener();
        var clickListener = new ClickListener(this);
        nativeView.setOnClickListener(clickListener);
        nativeView.clickListener = clickListener;
    };
    Button.prototype.disposeNativeView = function () {
        if (this.nativeViewProtected) {
            this.nativeViewProtected.clickListener.owner = null;
        }
        _super.prototype.disposeNativeView.call(this);
    };
    Button.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        if (this._stateListAnimator && APILEVEL >= 21) {
            this.nativeViewProtected.setStateListAnimator(this._stateListAnimator);
            this._stateListAnimator = undefined;
        }
    };
    Button.prototype._updateButtonStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            this._highlightedHandler = this._highlightedHandler || (function (args) {
                switch (args.action) {
                    case gestures_1.TouchAction.up:
                    case gestures_1.TouchAction.cancel:
                        _this._goToVisualState("normal");
                        break;
                    case gestures_1.TouchAction.down:
                        _this._goToVisualState("highlighted");
                        break;
                }
            });
            this.on(gestures_1.GestureTypes.touch, this._highlightedHandler);
        }
        else {
            this.off(gestures_1.GestureTypes.touch, this._highlightedHandler);
        }
    };
    Button.prototype[button_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    Button.prototype[button_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    Button.prototype[button_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    Button.prototype[button_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    Button.prototype[button_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    Button.prototype[button_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    Button.prototype[button_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    Button.prototype[button_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeViewProtected, button_common_1.Length.toDevicePixels(value, 0) + button_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    Button.prototype[button_common_1.zIndexProperty.setNative] = function (value) {
        if (APILEVEL >= 21) {
            var nativeView = this.nativeViewProtected;
            if (!this._stateListAnimator) {
                this._stateListAnimator = nativeView.getStateListAnimator();
            }
            nativeView.setStateListAnimator(null);
        }
        org.nativescript.widgets.ViewHelper.setZIndex(this.nativeViewProtected, value);
    };
    Button.prototype[button_common_1.textAlignmentProperty.setNative] = function (value) {
        var newValue = value === "initial" ? "center" : value;
        _super.prototype[button_common_1.textAlignmentProperty.setNative].call(this, newValue);
    };
    Button.prototype.getDefaultElevation = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return 2;
    };
    Button.prototype.getDefaultDynamicElevationOffset = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return 4;
    };
    __decorate([
        profiling_1.profile
    ], Button.prototype, "createNativeView", null);
    __decorate([
        button_common_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], Button.prototype, "_updateButtonStateChangeHandler", null);
    return Button;
}(button_common_1.ButtonBase));
exports.Button = Button;
//# sourceMappingURL=button.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/content-view/content-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ContentView = (function (_super) {
    __extends(ContentView, _super);
    function ContentView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ContentView.prototype, "content", {
        get: function () {
            return this._content;
        },
        set: function (value) {
            var oldView = this._content;
            if (this._content) {
                this._removeView(this._content);
            }
            this._content = value;
            if (this._content) {
                this._addView(this._content);
            }
            this._onContentChanged(oldView, value);
            if (view_1.isIOS && oldView !== value) {
                this.requestLayout();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "layoutView", {
        get: function () {
            var result;
            if (this._content) {
                var first_1 = true;
                this._content._eachLayoutView(function (child) {
                    if (first_1) {
                        first_1 = false;
                        result = child;
                    }
                    else {
                        throw new Error("More than one layout child inside a ContentView");
                    }
                });
            }
            return result;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "_childrenCount", {
        get: function () {
            return this._content ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    ContentView.prototype._onContentChanged = function (oldView, newView) {
    };
    ContentView.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.content = value;
        }
    };
    ContentView.prototype.eachChildView = function (callback) {
        var content = this._content;
        if (content) {
            callback(content);
        }
    };
    ContentView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = view_1.View.measureChild(this, this.layoutView, widthMeasureSpec, heightMeasureSpec);
        var width = view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var measureWidth = Math.max(result.measuredWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(result.measuredHeight, this.effectiveMinHeight);
        var widthAndState = view_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = view_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    ContentView.prototype.onLayout = function (left, top, right, bottom) {
        view_1.View.layoutChild(this, this.layoutView, 0, 0, right - left, bottom - top);
    };
    return ContentView;
}(view_1.CustomLayoutView));
exports.ContentView = ContentView;
ContentView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=content-view.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/bindable/bindable.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
exports.WrappedValue = observable_1.WrappedValue;
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceError = trace_1.error;
exports.traceCategories = trace_1.categories;
exports.traceNotifyEvent = trace_1.notifyEvent;
exports.isCategorySet = trace_1.isCategorySet;
exports.traceMessageType = trace_1.messageType;
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var polymerExpressions = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js");
var contextKey = "context";
var paramsRegex = /\[\s*(['"])*(\w*)\1\s*\]/;
var bc = binding_builder_1.bindingConstants;
var emptyArray = [];
var propertiesCache = {};
function getProperties(property) {
    if (!property) {
        return emptyArray;
    }
    var result = propertiesCache[property];
    if (result) {
        return result;
    }
    var parentsMatches = property.match(binding_builder_1.parentsRegex);
    result = property.replace(binding_builder_1.parentsRegex, "parentsMatch")
        .replace(/\]/g, "")
        .split(/\.|\[/);
    var parentsMatchesCounter = 0;
    for (var i = 0, resultLength = result.length; i < resultLength; i++) {
        if (result[i] === "parentsMatch") {
            result[i] = parentsMatches[parentsMatchesCounter++];
        }
    }
    propertiesCache[property] = result;
    return result;
}
function getEventOrGestureName(name) {
    return name.indexOf("on") === 0 ? name.substr(2, name.length - 2) : name;
}
exports.getEventOrGestureName = getEventOrGestureName;
function isGesture(eventOrGestureName) {
    var t = eventOrGestureName.trim().toLowerCase();
    return t === "tap"
        || t === "doubletap"
        || t === "pinch"
        || t === "pan"
        || t === "swipe"
        || t === "rotation"
        || t === "longpress"
        || t === "touch";
}
exports.isGesture = isGesture;
function isEventOrGesture(name, view) {
    if (typeof name === "string") {
        var eventOrGestureName = getEventOrGestureName(name);
        var evt = eventOrGestureName + "Event";
        return view.constructor && evt in view.constructor || isGesture(eventOrGestureName.toLowerCase());
    }
    return false;
}
exports.isEventOrGesture = isEventOrGesture;
var Binding = (function () {
    function Binding(target, options) {
        this.propertyChangeListeners = new Map();
        this.target = new WeakRef(target);
        this.options = options;
        this.sourceProperties = getProperties(options.sourceProperty);
        this.targetOptions = this.resolveOptions(target, getProperties(options.targetProperty));
        if (!this.targetOptions) {
            throw new Error("Invalid property: " + options.targetProperty + " for target: " + target);
        }
        if (options.twoWay) {
            var target_1 = this.targetOptions.instance.get();
            if (target_1 instanceof observable_1.Observable) {
                target_1.on(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
        }
    }
    Binding.prototype.onTargetPropertyChanged = function (data) {
        this.updateTwoWay(data.value);
    };
    Binding.prototype.loadedHandlerVisualTreeBinding = function (args) {
        var target = args.object;
        target.off("loaded", this.loadedHandlerVisualTreeBinding, this);
        var context = target.bindingContext;
        if (context !== undefined && context !== null) {
            this.update(context);
        }
    };
    Binding.prototype.clearSource = function () {
        var _this = this;
        this.propertyChangeListeners.forEach(function (observable, index, map) {
            weak_event_listener_1.removeWeakEventListener(observable, observable_1.Observable.propertyChangeEvent, _this.onSourcePropertyChanged, _this);
        });
        this.propertyChangeListeners.clear();
        if (this.source) {
            this.source.clear();
        }
        if (this.sourceOptions) {
            this.sourceOptions.instance.clear();
            this.sourceOptions = undefined;
        }
    };
    Binding.prototype.sourceAsObject = function (source) {
        var objectType = typeof source;
        if (objectType === "number") {
            source = new Number(source);
        }
        else if (objectType === "boolean") {
            source = new Boolean(source);
        }
        else if (objectType === "string") {
            source = new String(source);
        }
        return source;
    };
    Binding.prototype.bindingContextChanged = function (data) {
        var target = this.targetOptions.instance.get();
        if (!target) {
            this.unbind();
            return;
        }
        var value = data.value;
        if (value !== null && value !== undefined) {
            this.update(value);
        }
        else {
            this.clearBinding();
        }
    };
    Binding.prototype.bind = function (source) {
        var target = this.targetOptions.instance.get();
        if (this.sourceIsBindingContext && target instanceof observable_1.Observable && this.targetOptions.property !== "bindingContext") {
            target.on("bindingContextChange", this.bindingContextChanged, this);
        }
        this.update(source);
    };
    Binding.prototype.update = function (source) {
        this.clearSource();
        source = this.sourceAsObject(source);
        if (!types.isNullOrUndefined(source)) {
            this.source = new WeakRef(source);
            this.sourceOptions = this.resolveOptions(source, this.sourceProperties);
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue);
            this.addPropertyChangeListeners(this.source, this.sourceProperties);
        }
        else if (!this.sourceIsBindingContext) {
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue ? sourceValue : source);
        }
    };
    Binding.prototype.unbind = function () {
        var target = this.targetOptions.instance.get();
        if (target instanceof observable_1.Observable) {
            if (this.options.twoWay) {
                target.off(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
            if (this.sourceIsBindingContext && this.targetOptions.property !== "bindingContext") {
                target.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        if (this.targetOptions) {
            this.targetOptions = undefined;
        }
        this.sourceProperties = undefined;
        if (!this.source) {
            return;
        }
        this.clearSource();
    };
    Binding.prototype.resolveObjectsAndProperties = function (source, properties) {
        var result = [];
        var currentObject = source;
        var currentObjectChanged = false;
        for (var i = 0, propsArrayLength = properties.length; i < propsArrayLength; i++) {
            var property = properties[i];
            if (property === bc.bindingValueKey) {
                currentObjectChanged = true;
            }
            if (property === bc.parentValueKey || property.indexOf(bc.parentsValueKey) === 0) {
                var parentView = this.getParentView(this.target.get(), property).view;
                if (parentView) {
                    currentObject = parentView.bindingContext;
                }
                else {
                    var targetInstance = this.target.get();
                    targetInstance.off("loaded", this.loadedHandlerVisualTreeBinding, this);
                    targetInstance.on("loaded", this.loadedHandlerVisualTreeBinding, this);
                }
                currentObjectChanged = true;
            }
            if (currentObject) {
                result.push({ instance: currentObject, property: property });
            }
            else {
                break;
            }
            if (!currentObjectChanged && (i < propsArrayLength - 1)) {
                currentObject = currentObject ? currentObject[properties[i]] : null;
            }
            currentObjectChanged = false;
        }
        return result;
    };
    Binding.prototype.addPropertyChangeListeners = function (source, sourceProperty, parentProperies) {
        var objectsAndProperties = this.resolveObjectsAndProperties(source.get(), sourceProperty);
        var prop = parentProperies || "";
        for (var i = 0, length_1 = objectsAndProperties.length; i < length_1; i++) {
            var propName = objectsAndProperties[i].property;
            prop += "$" + propName;
            var currentObject = objectsAndProperties[i].instance;
            if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable && currentObject._isViewBase) {
                weak_event_listener_1.addWeakEventListener(currentObject, propName + "Change", this.onSourcePropertyChanged, this);
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
            else if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable) {
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
        }
    };
    Binding.prototype.prepareExpressionForUpdate = function () {
        var escapedSourceProperty = utils_1.escapeRegexSymbols(this.options.sourceProperty);
        var expRegex = new RegExp(escapedSourceProperty, "g");
        var resultExp = this.options.expression.replace(expRegex, bc.newPropertyValueKey);
        return resultExp;
    };
    Binding.prototype.updateTwoWay = function (value) {
        if (this.updating || !this.options.twoWay) {
            return;
        }
        var newValue = value;
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = value;
            changedModel[bc.newPropertyValueKey] = value;
            var sourcePropertyName = "";
            if (this.sourceOptions) {
                sourcePropertyName = this.sourceOptions.property;
            }
            else if (typeof this.options.sourceProperty === "string" && this.options.sourceProperty.indexOf(".") === -1) {
                sourcePropertyName = this.options.sourceProperty;
            }
            if (sourcePropertyName !== "") {
                changedModel[sourcePropertyName] = value;
            }
            var updateExpression = this.prepareExpressionForUpdate();
            this.prepareContextForExpression(changedModel, updateExpression, undefined);
            var expressionValue = this._getExpressionValue(updateExpression, true, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            newValue = expressionValue;
        }
        this.updateSource(newValue);
    };
    Binding.prototype._getExpressionValue = function (expression, isBackConvert, changedModel) {
        try {
            var exp_1 = polymerExpressions.PolymerExpressions.getExpression(expression);
            if (exp_1) {
                var context_1 = this.source && this.source.get && this.source.get() || global;
                var model = {};
                var addedProps = [];
                var resources = applicationCommon.getResources();
                for (var prop in resources) {
                    if (resources.hasOwnProperty(prop) && !context_1.hasOwnProperty(prop)) {
                        context_1[prop] = resources[prop];
                        addedProps.push(prop);
                    }
                }
                this.prepareContextForExpression(context_1, expression, addedProps);
                model[contextKey] = context_1;
                var result = exp_1.getValue(model, isBackConvert, changedModel ? changedModel : model);
                var addedPropsLength = addedProps.length;
                for (var i = 0; i < addedPropsLength; i++) {
                    delete context_1[addedProps[i]];
                }
                addedProps.length = 0;
                return result;
            }
            return new Error(expression + " is not a valid expression.");
        }
        catch (e) {
            var errorMessage = "Run-time error occured in file: " + e.sourceURL + " at line: " + e.line + " and column: " + e.column;
            return new Error(errorMessage);
        }
    };
    Binding.prototype.onSourcePropertyChanged = function (data) {
        var sourceProps = this.sourceProperties;
        var sourcePropsLength = sourceProps.length;
        var changedPropertyIndex = sourceProps.indexOf(data.propertyName);
        var parentProps = "";
        if (changedPropertyIndex > -1) {
            parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            while (this.propertyChangeListeners.get(parentProps) !== data.object) {
                changedPropertyIndex += sourceProps.slice(changedPropertyIndex + 1).indexOf(data.propertyName) + 1;
                parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            }
        }
        if (this.options.expression) {
            var expressionValue = this._getExpressionValue(this.options.expression, false, undefined);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                this.updateTarget(expressionValue);
            }
        }
        else {
            if (changedPropertyIndex > -1) {
                var props = sourceProps.slice(changedPropertyIndex + 1);
                var propsLength = props.length;
                if (propsLength > 0) {
                    var value = data.value;
                    for (var i = 0; i < propsLength; i++) {
                        value = value[props[i]];
                    }
                    this.updateTarget(value);
                }
                else if (data.propertyName === this.sourceOptions.property) {
                    this.updateTarget(data.value);
                }
            }
        }
        if (changedPropertyIndex > -1 && changedPropertyIndex < sourcePropsLength - 1) {
            var probablyChangedObject = this.propertyChangeListeners.get(parentProps);
            if (probablyChangedObject &&
                probablyChangedObject !== data.object[sourceProps[changedPropertyIndex]]) {
                for (var i = sourcePropsLength - 1; i > changedPropertyIndex; i--) {
                    var prop = "$" + sourceProps.slice(0, i + 1).join("$");
                    if (this.propertyChangeListeners.has(prop)) {
                        weak_event_listener_1.removeWeakEventListener(this.propertyChangeListeners.get(prop), observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                        this.propertyChangeListeners.delete(prop);
                    }
                }
                var newProps = sourceProps.slice(changedPropertyIndex + 1);
                var newObject = data.object[sourceProps[changedPropertyIndex]];
                if (!types.isNullOrUndefined(newObject) && typeof newObject === "object") {
                    this.addPropertyChangeListeners(new WeakRef(newObject), newProps, parentProps);
                }
            }
        }
    };
    Binding.prototype.prepareContextForExpression = function (model, expression, newProps) {
        var parentViewAndIndex;
        var parentView;
        var addedProps = newProps || [];
        if (expression.indexOf(bc.bindingValueKey) > -1) {
            model[bc.bindingValueKey] = model;
            addedProps.push(bc.bindingValueKey);
        }
        if (expression.indexOf(bc.parentValueKey) > -1) {
            parentView = this.getParentView(this.target.get(), bc.parentValueKey).view;
            if (parentView) {
                model[bc.parentValueKey] = parentView.bindingContext;
                addedProps.push(bc.parentValueKey);
            }
        }
        var parentsArray = expression.match(binding_builder_1.parentsRegex);
        if (parentsArray) {
            for (var i = 0; i < parentsArray.length; i++) {
                parentViewAndIndex = this.getParentView(this.target.get(), parentsArray[i]);
                if (parentViewAndIndex.view) {
                    model[bc.parentsValueKey] = model[bc.parentsValueKey] || {};
                    model[bc.parentsValueKey][parentViewAndIndex.index] = parentViewAndIndex.view.bindingContext;
                    addedProps.push(bc.parentsValueKey);
                }
            }
        }
    };
    Binding.prototype.getSourcePropertyValue = function () {
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = this.source ? this.source.get() : undefined;
            var expressionValue = this._getExpressionValue(this.options.expression, false, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                return expressionValue;
            }
        }
        if (this.sourceOptions) {
            var sourceOptionsInstance = this.sourceOptions.instance.get();
            if (this.sourceOptions.property === bc.bindingValueKey) {
                return sourceOptionsInstance;
            }
            else if ((sourceOptionsInstance instanceof observable_1.Observable) && (this.sourceOptions.property && this.sourceOptions.property !== "")) {
                return sourceOptionsInstance.get(this.sourceOptions.property);
            }
            else if (sourceOptionsInstance && this.sourceOptions.property && this.sourceOptions.property !== "" &&
                this.sourceOptions.property in sourceOptionsInstance) {
                return sourceOptionsInstance[this.sourceOptions.property];
            }
            else {
                trace_1.write("Property: '" + this.sourceOptions.property + "' is invalid or does not exist. SourceProperty: '" + this.options.sourceProperty + "'", trace_1.categories.Binding, trace_1.messageType.error);
            }
        }
        return null;
    };
    Binding.prototype.clearBinding = function () {
        this.clearSource();
        this.updateTarget(properties_1.unsetValue);
    };
    Binding.prototype.updateTarget = function (value) {
        if (this.updating) {
            return;
        }
        this.updateOptions(this.targetOptions, types.isNullOrUndefined(value) ? properties_1.unsetValue : value);
    };
    Binding.prototype.updateSource = function (value) {
        if (this.updating || !this.source || !this.source.get()) {
            return;
        }
        this.updateOptions(this.sourceOptions, value);
    };
    Binding.prototype.getParentView = function (target, property) {
        if (!target) {
            return { view: null, index: null };
        }
        var result;
        if (property === bc.parentValueKey) {
            result = target.parent;
        }
        var index = null;
        if (property.indexOf(bc.parentsValueKey) === 0) {
            result = target.parent;
            var indexParams = paramsRegex.exec(property);
            if (indexParams && indexParams.length > 1) {
                index = indexParams[2];
            }
            if (!isNaN(index)) {
                var indexAsInt = parseInt(index);
                while (indexAsInt > 0) {
                    result = result.parent;
                    indexAsInt--;
                }
            }
            else if (types.isString(index)) {
                while (result && result.typeName !== index) {
                    result = result.parent;
                }
            }
        }
        return { view: result, index: index };
    };
    Binding.prototype.resolveOptions = function (obj, properties) {
        var objectsAndProperties = this.resolveObjectsAndProperties(obj, properties);
        if (objectsAndProperties.length > 0) {
            var resolvedObj = objectsAndProperties[objectsAndProperties.length - 1].instance;
            var prop = objectsAndProperties[objectsAndProperties.length - 1].property;
            return {
                instance: new WeakRef(this.sourceAsObject(resolvedObj)),
                property: prop
            };
        }
        return null;
    };
    Binding.prototype.updateOptions = function (options, value) {
        var optionsInstance;
        if (options && options.instance) {
            optionsInstance = options.instance.get();
        }
        if (!optionsInstance) {
            return;
        }
        this.updating = true;
        try {
            if (isEventOrGesture(options.property, optionsInstance) &&
                types.isFunction(value)) {
                optionsInstance.off(options.property, null, optionsInstance.bindingContext);
                optionsInstance.on(options.property, value, optionsInstance.bindingContext);
            }
            else if (optionsInstance instanceof observable_1.Observable) {
                optionsInstance.set(options.property, value);
            }
            else {
                optionsInstance[options.property] = value;
            }
        }
        catch (ex) {
            trace_1.write("Binding error while setting property " + options.property + " of " + optionsInstance + ": " + ex, trace_1.categories.Binding, trace_1.messageType.error);
        }
        this.updating = false;
    };
    return Binding;
}());
exports.Binding = Binding;
//# sourceMappingURL=bindable.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/properties/properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var reduceCSSCalc = __webpack_require__("../node_modules/reduce-css-calc/dist/index.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var style_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style/style.js");
exports.Style = style_1.Style;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
exports.unsetValue = new Object();
var cssPropertyNames = [];
var symbolPropertyMap = {};
var cssSymbolPropertyMap = {};
var inheritableProperties = new Array();
var inheritableCssProperties = new Array();
function print(map) {
    var symbols = Object.getOwnPropertySymbols(map);
    for (var _i = 0, symbols_1 = symbols; _i < symbols_1.length; _i++) {
        var symbol = symbols_1[_i];
        var prop = map[symbol];
        if (!prop.registered) {
            console.log("Property " + prop.name + " not Registered!!!!!");
        }
    }
}
function _printUnregisteredProperties() {
    print(symbolPropertyMap);
    print(cssSymbolPropertyMap);
}
exports._printUnregisteredProperties = _printUnregisteredProperties;
function _getProperties() {
    return getPropertiesFromMap(symbolPropertyMap);
}
exports._getProperties = _getProperties;
function _getStyleProperties() {
    return getPropertiesFromMap(cssSymbolPropertyMap);
}
exports._getStyleProperties = _getStyleProperties;
var cssVariableExpressionRegexp = /\bvar\(\s*(--[^,\s]+?)(?:\s*,\s*(.+))?\s*\)/;
var cssVariableAllExpressionsRegexp = /\bvar\(\s*(--[^,\s]+?)(?:\s*,\s*(.+))?\s*\)/g;
function isCssVariable(property) {
    return /^--[^,\s]+?$/.test(property);
}
exports.isCssVariable = isCssVariable;
function isCssCalcExpression(value) {
    return /\bcalc\(/.test(value);
}
exports.isCssCalcExpression = isCssCalcExpression;
function isCssVariableExpression(value) {
    return cssVariableExpressionRegexp.test(value);
}
exports.isCssVariableExpression = isCssVariableExpression;
function _evaluateCssVariableExpression(view, cssName, value) {
    if (typeof value !== "string") {
        return value;
    }
    if (!isCssVariableExpression(value)) {
        return value;
    }
    var output = value.trim();
    var lastValue;
    while (lastValue !== output) {
        lastValue = output;
        output = output.replace(cssVariableAllExpressionsRegexp, function (matchStr, cssVariableName, fallbackStr) {
            var cssVariableValue = view.style.getCssVariable(cssVariableName);
            if (cssVariableValue !== null) {
                return cssVariableValue;
            }
            if (fallbackStr) {
                var fallbackOutput = _evaluateCssVariableExpression(view, cssName, fallbackStr);
                if (fallbackOutput) {
                    return fallbackOutput.split(",")[0];
                }
            }
            trace_1.write("Failed to get value for css-variable \"" + cssVariableName + "\" used in \"" + cssName + "\"=[" + value + "] to " + view, trace_1.categories.Style, trace_1.messageType.error);
            return "unset";
        });
    }
    return output;
}
exports._evaluateCssVariableExpression = _evaluateCssVariableExpression;
function _evaluateCssCalcExpression(value) {
    if (typeof value !== "string") {
        return value;
    }
    if (isCssCalcExpression(value)) {
        return reduceCSSCalc(value.replace(/([0-9]+(\.[0-9]+)?)dip\b/g, "$1"));
    }
    else {
        return value;
    }
}
exports._evaluateCssCalcExpression = _evaluateCssCalcExpression;
function getPropertiesFromMap(map) {
    var props = [];
    Object.getOwnPropertySymbols(map).forEach(function (symbol) { return props.push(map[symbol]); });
    return props;
}
var Property = (function () {
    function Property(options) {
        this.enumerable = true;
        this.configurable = true;
        var propertyName = options.name;
        this.name = propertyName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var equalityComparer = options.equalityComparer;
        var affectsLayout = options.affectsLayout;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        this.get = function () {
            return key in this ? this[key] : defaultValue;
        };
        this.nativeValueChange = function (owner, value) {
            var oldValue = key in owner ? owner[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                owner[key] = value;
                if (valueChanged) {
                    valueChanged(owner, oldValue, value);
                }
                if (owner.nativeViewProtected && !(defaultValueKey in owner)) {
                    owner[defaultValueKey] = owner[getDefault] ? owner[getDefault]() : defaultValue;
                }
                if (owner.hasListeners(eventName)) {
                    owner.notify({ object: owner, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    owner.requestLayout();
                }
                if (owner.domNode) {
                    owner.domNode.attributeModified(propertyName, value);
                }
            }
        };
        symbolPropertyMap[key] = this;
    }
    Property.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this);
    };
    Property.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return Property;
}());
exports.Property = Property;
Property.prototype.isStyleProperty = false;
var CoercibleProperty = (function (_super) {
    __extends(CoercibleProperty, _super);
    function CoercibleProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var defaultValue = _this.defaultValue;
        var coerceKey = Symbol(propertyName + ":coerceKey");
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var coerceCallback = options.coerceValue;
        var property = _this;
        _this.coerce = function (target) {
            var originalValue = coerceKey in target ? target[coerceKey] : defaultValue;
            target[propertyName] = originalValue;
        };
        _this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
                delete this[coerceKey];
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
                this[coerceKey] = value;
                value = coerceCallback(this, value);
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        return _this;
    }
    return CoercibleProperty;
}(Property));
exports.CoercibleProperty = CoercibleProperty;
var InheritedProperty = (function (_super) {
    __extends(InheritedProperty, _super);
    function InheritedProperty(options) {
        var _this = _super.call(this, options) || this;
        var name = options.name;
        var key = _this.key;
        var defaultValue = options.defaultValue;
        var sourceKey = Symbol(name + ":valueSourceKey");
        _this.sourceKey = sourceKey;
        var setBase = _this.set;
        var setFunc = function (valueSource) { return function (value) {
            var that = this;
            var unboxedValue;
            var newValueSource;
            if (value === exports.unsetValue) {
                var parent_1 = that.parent;
                if (parent_1 && parent_1[sourceKey] !== 0) {
                    unboxedValue = parent_1[name];
                    newValueSource = 1;
                }
                else {
                    unboxedValue = defaultValue;
                    newValueSource = 0;
                }
            }
            else {
                unboxedValue = value;
                newValueSource = valueSource;
            }
            var currentValue = that[key];
            setBase.call(that, unboxedValue);
            var newValue = that[key];
            that[sourceKey] = newValueSource;
            if (currentValue !== newValue) {
                var reset_1 = newValueSource === 0;
                that.eachChild(function (child) {
                    var childValueSource = child[sourceKey] || 0;
                    if (reset_1) {
                        if (childValueSource === 1) {
                            setFunc.call(child, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedValue.call(child, newValue);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setInheritedValue = setFunc(1);
        _this.setInheritedValue = setInheritedValue;
        _this.set = setFunc(3);
        inheritableProperties.push(_this);
        return _this;
    }
    return InheritedProperty;
}(Property));
exports.InheritedProperty = InheritedProperty;
var CssProperty = (function () {
    function CssProperty(options) {
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = options.cssName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var sourceKey = Symbol(propertyName + ":valueSourceKey");
        this.sourceKey = sourceKey;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        function setLocalValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                this[sourceKey] = 3;
                value = (valueConverter && typeof newValue === "string") ?
                    valueConverter(newValue) :
                    newValue;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function setCssValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var currentValueSource = this[sourceKey] || 0;
            if (currentValueSource === 3) {
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                value = valueConverter && typeof newValue === "string" ?
                    valueConverter(newValue) :
                    newValue;
                this[sourceKey] = 2;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function get() {
            return key in this ? this[key] : defaultValue;
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setLocalValue
        };
        cssSymbolPropertyMap[key] = this;
    }
    CssProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
    };
    CssProperty.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return CssProperty;
}());
exports.CssProperty = CssProperty;
CssProperty.prototype.isStyleProperty = true;
var CssAnimationProperty = (function () {
    function CssAnimationProperty(options) {
        var valueConverter = options.valueConverter, equalityComparer = options.equalityComparer, valueChanged = options.valueChanged, defaultValue = options.defaultValue;
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        CssAnimationProperty.properties[propertyName] = this;
        if (options.cssName && options.cssName !== propertyName) {
            CssAnimationProperty.properties[options.cssName] = this;
        }
        this._valueConverter = options.valueConverter;
        var cssLocalName = (options.cssName || propertyName);
        this.cssLocalName = cssLocalName;
        var cssName = "css:" + cssLocalName;
        this.cssName = cssName;
        var keyframeName = "keyframe:" + propertyName;
        this.keyframe = keyframeName;
        var defaultName = "default:" + propertyName;
        var defaultValueKey = Symbol(defaultName);
        this.defaultValueKey = defaultValueKey;
        this.defaultValue = defaultValue;
        var cssValue = Symbol(cssName);
        var styleValue = Symbol("local:" + propertyName);
        var keyframeValue = Symbol(keyframeName);
        var computedValue = Symbol("computed-value:" + propertyName);
        this.key = computedValue;
        var computedSource = Symbol("computed-source:" + propertyName);
        this.source = computedSource;
        this.getDefault = Symbol(propertyName + ":getDefault");
        var getDefault = this.getDefault;
        var setNative = this.setNative = Symbol(propertyName + ":setNative");
        var eventName = propertyName + "Change";
        var property = this;
        function descriptor(symbol, propertySource, enumerable, configurable, getsComputed) {
            return {
                enumerable: enumerable, configurable: configurable,
                get: getsComputed ? function () { return this[computedValue]; } : function () { return this[symbol]; },
                set: function (boxedValue) {
                    var view = this.viewRef.get();
                    if (!view) {
                        trace_1.write(boxedValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                        return;
                    }
                    var oldValue = this[computedValue];
                    var oldSource = this[computedSource];
                    var wasSet = oldSource !== 0;
                    var reset = boxedValue === exports.unsetValue || boxedValue === "";
                    if (reset) {
                        this[symbol] = exports.unsetValue;
                        if (this[computedSource] === propertySource) {
                            if (this[styleValue] !== exports.unsetValue) {
                                this[computedSource] = 3;
                                this[computedValue] = this[styleValue];
                            }
                            else if (this[cssValue] !== exports.unsetValue) {
                                this[computedSource] = 2;
                                this[computedValue] = this[cssValue];
                            }
                            else {
                                delete this[computedSource];
                                delete this[computedValue];
                            }
                        }
                    }
                    else {
                        if (valueConverter && typeof boxedValue === "string") {
                            boxedValue = valueConverter(boxedValue);
                        }
                        this[symbol] = boxedValue;
                        if (this[computedSource] <= propertySource) {
                            this[computedSource] = propertySource;
                            this[computedValue] = boxedValue;
                        }
                    }
                    var value = this[computedValue];
                    var source = this[computedSource];
                    var isSet = source !== 0;
                    var computedValueChanged = oldValue !== value && (!equalityComparer || !equalityComparer(oldValue, value));
                    if (computedValueChanged && valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative] && (computedValueChanged || isSet !== wasSet)) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (isSet) {
                                if (!wasSet && !(defaultValueKey in this)) {
                                    this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                                }
                                view[setNative](value);
                            }
                            else if (wasSet) {
                                if (defaultValueKey in this) {
                                    view[setNative](this[defaultValueKey]);
                                }
                                else {
                                    view[setNative](defaultValue);
                                }
                            }
                        }
                    }
                    if (computedValueChanged && this.hasListeners(eventName)) {
                        this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                    }
                }
            };
        }
        var defaultPropertyDescriptor = descriptor(defaultValueKey, 0, false, false, false);
        var cssPropertyDescriptor = descriptor(cssValue, 2, false, false, false);
        var stylePropertyDescriptor = descriptor(styleValue, 3, true, true, true);
        var keyframePropertyDescriptor = descriptor(keyframeValue, 4, false, false, false);
        symbolPropertyMap[computedValue] = this;
        cssSymbolPropertyMap[computedValue] = this;
        this.register = function (cls) {
            cls.prototype[computedValue] = options.defaultValue;
            cls.prototype[computedSource] = 0;
            cls.prototype[cssValue] = exports.unsetValue;
            cls.prototype[styleValue] = exports.unsetValue;
            cls.prototype[keyframeValue] = exports.unsetValue;
            Object.defineProperty(cls.prototype, defaultName, defaultPropertyDescriptor);
            Object.defineProperty(cls.prototype, cssName, cssPropertyDescriptor);
            Object.defineProperty(cls.prototype, propertyName, stylePropertyDescriptor);
            if (options.cssName && options.cssName !== options.name) {
                Object.defineProperty(cls.prototype, options.cssName, stylePropertyDescriptor);
            }
            Object.defineProperty(cls.prototype, keyframeName, keyframePropertyDescriptor);
        };
    }
    CssAnimationProperty.prototype._initDefaultNativeValue = function (target) {
        var view = target.viewRef.get();
        if (!view) {
            trace_1.write("_initDefaultNativeValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        var defaultValueKey = this.defaultValueKey;
        if (!(defaultValueKey in target)) {
            var getDefault = this.getDefault;
            target[defaultValueKey] = view[getDefault] ? view[getDefault]() : this.defaultValue;
        }
    };
    CssAnimationProperty._getByCssName = function (name) {
        return this.properties[name];
    };
    CssAnimationProperty._getPropertyNames = function () {
        return Object.keys(CssAnimationProperty.properties);
    };
    CssAnimationProperty.prototype.isSet = function (instance) {
        return instance[this.source] !== 0;
    };
    CssAnimationProperty.properties = {};
    return CssAnimationProperty;
}());
exports.CssAnimationProperty = CssAnimationProperty;
CssAnimationProperty.prototype.isStyleProperty = true;
var InheritedCssProperty = (function (_super) {
    __extends(InheritedCssProperty, _super);
    function InheritedCssProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var sourceKey = _this.sourceKey;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var eventName = propertyName + "Change";
        var defaultValue = options.defaultValue;
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = _this;
        var setFunc = function (valueSource) { return function (boxedValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(boxedValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = boxedValue === exports.unsetValue || boxedValue === "";
            var currentValueSource = this[sourceKey] || 0;
            if (reset) {
                if (valueSource === 2 && currentValueSource === 3) {
                    return;
                }
            }
            else {
                if (currentValueSource > valueSource) {
                    return;
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var value;
            var unsetNativeValue = false;
            if (reset) {
                var parent_2 = view.parent;
                var style = parent_2 ? parent_2.style : null;
                if (style && style[sourceKey] > 0) {
                    value = style[propertyName];
                    this[sourceKey] = 1;
                    this[key] = value;
                }
                else {
                    value = defaultValue;
                    delete this[sourceKey];
                    delete this[key];
                    unsetNativeValue = true;
                }
            }
            else {
                this[sourceKey] = valueSource;
                if (valueConverter && typeof boxedValue === "string") {
                    value = valueConverter(boxedValue);
                }
                else {
                    value = boxedValue;
                }
                this[key] = value;
            }
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (valueChanged) {
                    valueChanged(this, oldValue, value);
                }
                if (view[setNative]) {
                    if (view._suspendNativeUpdatesCount) {
                        if (view._suspendedUpdates) {
                            view._suspendedUpdates[propertyName] = property;
                        }
                    }
                    else {
                        if (unsetNativeValue) {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
                view.eachChild(function (child) {
                    var childStyle = child.style;
                    var childValueSource = childStyle[sourceKey] || 0;
                    if (reset) {
                        if (childValueSource === 1) {
                            setDefaultFunc.call(childStyle, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedFunc.call(childStyle, value);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setDefaultFunc = setFunc(0);
        var setInheritedFunc = setFunc(1);
        _this.setInheritedValue = setInheritedFunc;
        _this.cssValueDescriptor.set = setFunc(2);
        _this.localValueDescriptor.set = setFunc(3);
        inheritableCssProperties.push(_this);
        return _this;
    }
    return InheritedCssProperty;
}(CssProperty));
exports.InheritedCssProperty = InheritedCssProperty;
var ShorthandProperty = (function () {
    function ShorthandProperty(options) {
        this.name = options.name;
        var key = Symbol(this.name + ":propertyKey");
        this.key = key;
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = "" + options.cssName;
        var converter = options.converter;
        function setLocalValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setLocalValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.name] = v;
                }
            });
        }
        function setCssValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setCssValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.cssName] = v;
                }
            });
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setLocalValue
        };
        this.propertyBagDescriptor = {
            enumerable: false,
            configurable: true,
            set: function (value) {
                var _this = this;
                converter(value).forEach(function (_a) {
                    var property = _a[0], value = _a[1];
                    _this[property.cssLocalName] = value;
                });
            }
        };
        cssSymbolPropertyMap[key] = this;
    }
    ShorthandProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
        Object.defineProperty(cls.prototype.PropertyBag, this.cssLocalName, this.propertyBagDescriptor);
    };
    return ShorthandProperty;
}());
exports.ShorthandProperty = ShorthandProperty;
function inheritablePropertyValuesOn(view) {
    var array = new Array();
    for (var _i = 0, inheritableProperties_1 = inheritableProperties; _i < inheritableProperties_1.length; _i++) {
        var prop = inheritableProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = view[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: view[prop.name] });
        }
    }
    return array;
}
function inheritableCssPropertyValuesOn(style) {
    var array = new Array();
    for (var _i = 0, inheritableCssProperties_1 = inheritableCssProperties; _i < inheritableCssProperties_1.length; _i++) {
        var prop = inheritableCssProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = style[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: style[prop.name] });
        }
    }
    return array;
}
exports.initNativeView = profiling_1.profile("\"properties\".initNativeView", function initNativeView(view) {
    if (view._suspendedUpdates) {
        applyPendingNativeSetters(view);
    }
    else {
        applyAllNativeSetters(view);
    }
    view._suspendedUpdates = {};
});
function applyPendingNativeSetters(view) {
    var suspendedUpdates = view._suspendedUpdates;
    for (var propertyName in suspendedUpdates) {
        var property = suspendedUpdates[propertyName];
        var setNative = property.setNative;
        if (view[setNative]) {
            var getDefault = property.getDefault, isStyleProperty = property.isStyleProperty, defaultValueKey = property.defaultValueKey, defaultValue = property.defaultValue;
            var value = void 0;
            if (isStyleProperty) {
                var style = view.style;
                if (property.isSet(view.style)) {
                    if (!(defaultValueKey in style)) {
                        style[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view.style[propertyName];
                }
                else {
                    value = style[defaultValueKey];
                }
            }
            else {
                if (property.isSet(view)) {
                    if (!(defaultValueKey in view)) {
                        view[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view[propertyName];
                }
                else {
                    value = view[defaultValueKey];
                }
            }
            view[setNative](value);
        }
    }
}
exports.applyPendingNativeSetters = applyPendingNativeSetters;
function applyAllNativeSetters(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_2 = symbols; _i < symbols_2.length; _i++) {
        var symbol = symbols_2[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var setNative = property.setNative;
        var getDefault = property.getDefault;
        if (setNative in view) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in view)) {
                view[defaultValueKey] = view[getDefault] ? view[getDefault]() : property.defaultValue;
            }
            var value = view[symbol];
            view[setNative](value);
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_3 = symbols; _a < symbols_3.length; _a++) {
        var symbol = symbols_3[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in style)) {
                style[defaultValueKey] = view[property.getDefault] ? view[property.getDefault]() : property.defaultValue;
            }
            var value = style[symbol];
            view[property.setNative](value);
        }
    }
}
exports.applyAllNativeSetters = applyAllNativeSetters;
function resetNativeView(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_4 = symbols; _i < symbols_4.length; _i++) {
        var symbol = symbols_4[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in view) {
                view[property.setNative](view[property.defaultValueKey]);
                delete view[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_5 = symbols; _a < symbols_5.length; _a++) {
        var symbol = symbols_5[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in style) {
                view[property.setNative](style[property.defaultValueKey]);
                delete style[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
}
exports.resetNativeView = resetNativeView;
function clearInheritedProperties(view) {
    for (var _i = 0, inheritableProperties_2 = inheritableProperties; _i < inheritableProperties_2.length; _i++) {
        var prop = inheritableProperties_2[_i];
        var sourceKey = prop.sourceKey;
        if (view[sourceKey] === 1) {
            prop.set.call(view, exports.unsetValue);
        }
    }
    var style = view.style;
    for (var _a = 0, inheritableCssProperties_2 = inheritableCssProperties; _a < inheritableCssProperties_2.length; _a++) {
        var prop = inheritableCssProperties_2[_a];
        var sourceKey = prop.sourceKey;
        if (style[sourceKey] === 1) {
            prop.setInheritedValue.call(style, exports.unsetValue);
        }
    }
}
exports.clearInheritedProperties = clearInheritedProperties;
function resetCSSProperties(style) {
    var symbols = Object.getOwnPropertySymbols(style);
    for (var _i = 0, symbols_6 = symbols; _i < symbols_6.length; _i++) {
        var symbol = symbols_6[_i];
        var cssProperty = void 0;
        if (cssProperty = cssSymbolPropertyMap[symbol]) {
            style[cssProperty.cssName] = exports.unsetValue;
            if (cssProperty instanceof CssAnimationProperty) {
                style[cssProperty.keyframe] = exports.unsetValue;
            }
        }
    }
}
exports.resetCSSProperties = resetCSSProperties;
function propagateInheritableProperties(view, child) {
    var inheritablePropertyValues = inheritablePropertyValuesOn(view);
    for (var _i = 0, inheritablePropertyValues_1 = inheritablePropertyValues; _i < inheritablePropertyValues_1.length; _i++) {
        var pair = inheritablePropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = child[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(child, pair.value);
        }
    }
}
exports.propagateInheritableProperties = propagateInheritableProperties;
function propagateInheritableCssProperties(parentStyle, childStyle) {
    var inheritableCssPropertyValues = inheritableCssPropertyValuesOn(parentStyle);
    for (var _i = 0, inheritableCssPropertyValues_1 = inheritableCssPropertyValues; _i < inheritableCssPropertyValues_1.length; _i++) {
        var pair = inheritableCssPropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = childStyle[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(childStyle, pair.value, 1);
        }
    }
}
exports.propagateInheritableCssProperties = propagateInheritableCssProperties;
function makeValidator() {
    var values = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        values[_i] = arguments[_i];
    }
    var set = new Set(values);
    return function (value) { return set.has(value); };
}
exports.makeValidator = makeValidator;
function makeParser(isValid) {
    return function (value) {
        var lower = value && value.toLowerCase();
        if (isValid(lower)) {
            return lower;
        }
        else {
            throw new Error("Invalid value: " + value);
        }
    };
}
exports.makeParser = makeParser;
function getSetProperties(view) {
    var result = [];
    Object.getOwnPropertyNames(view).forEach(function (prop) {
        result.push([prop, view[prop]]);
    });
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_7 = symbols; _i < symbols_7.length; _i++) {
        var symbol = symbols_7[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var value = view[property.key];
        result.push([property.name, value]);
    }
    return result;
}
exports.getSetProperties = getSetProperties;
function getComputedCssValues(view) {
    var result = [];
    var style = view.style;
    for (var _i = 0, cssPropertyNames_1 = cssPropertyNames; _i < cssPropertyNames_1.length; _i++) {
        var prop = cssPropertyNames_1[_i];
        result.push([prop, style[prop]]);
    }
    result.push(["top", "auto"]);
    result.push(["left", "auto"]);
    result.push(["bottom", "auto"]);
    result.push(["right", "auto"]);
    return result;
}
exports.getComputedCssValues = getComputedCssValues;
//# sourceMappingURL=properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view-base/view-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.isIOS = platform_1.isIOS;
exports.isAndroid = platform_1.isAndroid;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.layout = utils_1.layout;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js"));
var ssm = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var domNodeModule;
function ensuredomNodeModule() {
    if (!domNodeModule) {
        domNodeModule = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
    }
}
var styleScopeModule;
function ensureStyleScopeModule() {
    if (!styleScopeModule) {
        styleScopeModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
    }
}
var defaultBindingSource = {};
function getAncestor(view, criterion) {
    var matcher = null;
    if (typeof criterion === "string") {
        matcher = function (view) { return view.typeName === criterion; };
    }
    else {
        matcher = function (view) { return view instanceof criterion; };
    }
    for (var parent_1 = view.parent; parent_1 != null; parent_1 = parent_1.parent) {
        if (matcher(parent_1)) {
            return parent_1;
        }
    }
    return null;
}
exports.getAncestor = getAncestor;
function getViewById(view, id) {
    if (!view) {
        return undefined;
    }
    if (view.id === id) {
        return view;
    }
    var retVal;
    var descendantsCallback = function (child) {
        if (child.id === id) {
            retVal = child;
            return false;
        }
        return true;
    };
    eachDescendant(view, descendantsCallback);
    return retVal;
}
exports.getViewById = getViewById;
function eachDescendant(view, callback) {
    if (!callback || !view) {
        return;
    }
    var continueIteration;
    var localCallback = function (child) {
        continueIteration = callback(child);
        if (continueIteration) {
            child.eachChild(localCallback);
        }
        return continueIteration;
    };
    view.eachChild(localCallback);
}
exports.eachDescendant = eachDescendant;
var viewIdCounter = 1;
var Flags;
(function (Flags) {
    Flags["superOnLoadedCalled"] = "Loaded";
    Flags["superOnUnloadedCalled"] = "Unloaded";
})(Flags || (Flags = {}));
var SuspendType;
(function (SuspendType) {
    SuspendType[SuspendType["Incremental"] = 0] = "Incremental";
    SuspendType[SuspendType["Loaded"] = 1048576] = "Loaded";
    SuspendType[SuspendType["NativeView"] = 2097152] = "NativeView";
    SuspendType[SuspendType["UISetup"] = 4194304] = "UISetup";
    SuspendType[SuspendType["IncrementalCountMask"] = -7340033] = "IncrementalCountMask";
})(SuspendType || (SuspendType = {}));
(function (SuspendType) {
    function toString(type) {
        return (type ? "suspended" : "resumed") + "(" +
            "Incremental: " + (type & SuspendType.IncrementalCountMask) + ", " +
            "Loaded: " + !(type & SuspendType.Loaded) + ", " +
            "NativeView: " + !(type & SuspendType.NativeView) + ", " +
            "UISetup: " + !(type & SuspendType.UISetup) +
            ")";
    }
    SuspendType.toString = toString;
})(SuspendType || (SuspendType = {}));
var ViewBase = (function (_super) {
    __extends(ViewBase, _super);
    function ViewBase() {
        var _this = _super.call(this) || this;
        _this._onLoadedCalled = false;
        _this._onUnloadedCalled = false;
        _this._cssState = new ssm.CssState(new WeakRef(_this));
        _this.pseudoClassAliases = {
            "highlighted": [
                "active",
                "pressed"
            ]
        };
        _this.cssClasses = new Set();
        _this.cssPseudoClasses = new Set();
        _this._domId = viewIdCounter++;
        _this._style = new properties_1.Style(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(ViewBase.prototype, "parentNode", {
        get: function () {
            return this._templateParent || this.parent;
        },
        set: function (node) {
            this._templateParent = node;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "nativeView", {
        get: function () {
            return this.nativeViewProtected;
        },
        set: function (value) {
            this.setNativeView(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "typeName", {
        get: function () {
            return types.getClass(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "style", {
        get: function () {
            return this._style;
        },
        set: function (inlineStyle) {
            if (typeof inlineStyle === "string") {
                this.setInlineStyle(inlineStyle);
            }
            else {
                throw new Error("View.style property is read-only.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "android", {
        get: function () {
            return this._androidView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "ios", {
        get: function () {
            return this._iosView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "isLoaded", {
        get: function () {
            return this._isLoaded;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "class", {
        get: function () {
            return this.className;
        },
        set: function (v) {
            this.className = v;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.getViewById = function (id) {
        return getViewById(this, id);
    };
    Object.defineProperty(ViewBase.prototype, "page", {
        get: function () {
            if (this.parent) {
                return this.parent.page;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.ensureDomNode = function () {
        if (!this.domNode) {
            ensuredomNodeModule();
            this.domNode = new domNodeModule.DOMNode(this);
        }
    };
    ViewBase.prototype.set = function (name, value) {
        this[name] = bindable_1.WrappedValue.unwrap(value);
    };
    ViewBase.prototype.onLoaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnLoadedCalled, true);
        if (this._isLoaded) {
            return;
        }
        this._isLoaded = true;
        this._cssState.onLoaded();
        this._resumeNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.loadView(child);
            return true;
        });
        this._emit("loaded");
    };
    ViewBase.prototype.onUnloaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnUnloadedCalled, true);
        if (!this._isLoaded) {
            return;
        }
        this._suspendNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.unloadView(child);
            return true;
        });
        this._isLoaded = false;
        this._cssState.onUnloaded();
        this._emit("unloaded");
    };
    ViewBase.prototype._suspendNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount | type;
        }
        else {
            this._suspendNativeUpdatesCount++;
        }
    };
    ViewBase.prototype._resumeNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount & ~type;
        }
        else {
            if ((this._suspendNativeUpdatesCount & SuspendType.IncrementalCountMask) === 0) {
                throw new Error("Invalid call to " + this + "._resumeNativeUpdates");
            }
            this._suspendNativeUpdatesCount--;
        }
        if (!this._suspendNativeUpdatesCount) {
            this.onResumeNativeUpdates();
        }
    };
    ViewBase.prototype._batchUpdate = function (callback) {
        try {
            this._suspendNativeUpdates(SuspendType.Incremental);
            return callback();
        }
        finally {
            this._resumeNativeUpdates(SuspendType.Incremental);
        }
    };
    ViewBase.prototype.setFlag = function (flag, value) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                this._onLoadedCalled = value;
                break;
            case Flags.superOnUnloadedCalled:
                this._onUnloadedCalled = value;
                break;
        }
    };
    ViewBase.prototype.isFlagSet = function (flag) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                return this._onLoadedCalled;
            case Flags.superOnUnloadedCalled:
                return this._onUnloadedCalled;
        }
    };
    ViewBase.prototype.callFunctionWithSuper = function (flag, func) {
        this.setFlag(flag, false);
        func();
        if (!this.isFlagSet(flag)) {
            throw new Error("super." + flag + " not called in " + this);
        }
    };
    ViewBase.prototype.callLoaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnLoadedCalled, function () { return _this.onLoaded(); });
    };
    ViewBase.prototype.callUnloaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnUnloadedCalled, function () { return _this.onUnloaded(); });
    };
    ViewBase.prototype.notifyPseudoClassChanged = function (pseudoClass) {
        this.notify({ eventName: ":" + pseudoClass, object: this });
    };
    ViewBase.prototype.getAllAliasedStates = function (name) {
        var allStates = [];
        allStates.push(name);
        if (name in this.pseudoClassAliases) {
            for (var i = 0; i < this.pseudoClassAliases[name].length; i++) {
                allStates.push(this.pseudoClassAliases[name][i]);
            }
        }
        return allStates;
    };
    ViewBase.prototype.addPseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (!this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.add(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.deletePseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.delete(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.bindingContextChanged = function (data) {
        this.bindings.get("bindingContext").bind(data.value);
    };
    ViewBase.prototype.bind = function (options, source) {
        if (source === void 0) { source = defaultBindingSource; }
        var targetProperty = options.targetProperty;
        this.unbind(targetProperty);
        if (!this.bindings) {
            this.bindings = new Map();
        }
        var binding = new bindable_1.Binding(this, options);
        this.bindings.set(targetProperty, binding);
        var bindingSource = source;
        if (bindingSource === defaultBindingSource) {
            bindingSource = this.bindingContext;
            binding.sourceIsBindingContext = true;
            if (targetProperty === "bindingContext") {
                this.bindingContextBoundToParentBindingContextChanged = true;
                var parent_2 = this.parent;
                if (parent_2) {
                    parent_2.on("bindingContextChange", this.bindingContextChanged, this);
                }
                else {
                    this.shouldAddHandlerToParentBindingContextChanged = true;
                }
            }
        }
        binding.bind(bindingSource);
    };
    ViewBase.prototype.unbind = function (property) {
        var bindings = this.bindings;
        if (!bindings) {
            return;
        }
        var binding = bindings.get(property);
        if (binding) {
            binding.unbind();
            bindings.delete(property);
            if (binding.sourceIsBindingContext) {
                if (property === "bindingContext") {
                    this.shouldAddHandlerToParentBindingContextChanged = false;
                    this.bindingContextBoundToParentBindingContextChanged = false;
                    var parent_3 = this.parent;
                    if (parent_3) {
                        parent_3.off("bindingContextChange", this.bindingContextChanged, this);
                    }
                }
            }
        }
    };
    ViewBase.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    ViewBase.prototype.eachChild = function (callback) {
    };
    ViewBase.prototype._addView = function (view, atIndex) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._addView(" + view + ", " + atIndex + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (!view) {
            throw new Error("Expecting a valid View instance.");
        }
        if (!(view instanceof ViewBase)) {
            throw new Error(view + " is not a valid View instance.");
        }
        if (view.parent) {
            throw new Error("View already has a parent. View: " + view + " Parent: " + view.parent);
        }
        view.parent = this;
        this._addViewCore(view, atIndex);
        view._parentChanged(null);
        if (this.domNode) {
            this.domNode.onChildAdded(view);
        }
    };
    ViewBase.prototype._addViewCore = function (view, atIndex) {
        properties_1.propagateInheritableProperties(this, view);
        view._inheritStyleScope(this._styleScope);
        properties_1.propagateInheritableCssProperties(this.style, view.style);
        if (this._context) {
            view._setupUI(this._context, atIndex);
        }
        if (this._isLoaded) {
            this.loadView(view);
        }
    };
    ViewBase.prototype.loadView = function (view) {
        if (view && !view.isLoaded) {
            view.callLoaded();
        }
    };
    ViewBase.prototype.unloadView = function (view) {
        if (view && view.isLoaded) {
            view.callUnloaded();
        }
    };
    ViewBase.prototype._removeView = function (view) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._removeView(" + view + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (view.parent !== this) {
            throw new Error("View not added to this instance. View: " + view + " CurrentParent: " + view.parent + " ExpectedParent: " + this);
        }
        if (this.domNode) {
            this.domNode.onChildRemoved(view);
        }
        this._removeViewCore(view);
        view.parent = undefined;
        view._parentChanged(this);
    };
    ViewBase.prototype._removeViewCore = function (view) {
        this.unloadView(view);
        if (view._context) {
            view._tearDownUI();
        }
    };
    ViewBase.prototype.createNativeView = function () {
        return undefined;
    };
    ViewBase.prototype.disposeNativeView = function () {
    };
    ViewBase.prototype.initNativeView = function () {
    };
    ViewBase.prototype.resetNativeView = function () {
    };
    ViewBase.prototype.resetNativeViewInternal = function () {
    };
    ViewBase.prototype._setupAsRootView = function (context) {
        this._setupUI(context);
    };
    ViewBase.prototype._setupUI = function (context, atIndex, parentIsLoaded) {
        if (this._context === context) {
            return;
        }
        else if (this._context) {
            this._tearDownUI(true);
        }
        this._context = context;
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            nativeView = this.createNativeView();
        }
        if (platform_1.isAndroid) {
            this._androidView = nativeView;
            if (nativeView) {
                if (this._isPaddingRelative === undefined) {
                    this._isPaddingRelative = nativeView.isPaddingRelative();
                }
                var result = nativeView.defaultPaddings;
                if (result === undefined) {
                    result = org.nativescript.widgets.ViewHelper.getPadding(nativeView);
                    nativeView.defaultPaddings = result;
                }
                this._defaultPaddingTop = result.top;
                this._defaultPaddingRight = result.right;
                this._defaultPaddingBottom = result.bottom;
                this._defaultPaddingLeft = result.left;
                var style = this.style;
                if (!style_properties_1.paddingTopProperty.isSet(style)) {
                    this.effectivePaddingTop = this._defaultPaddingTop;
                }
                if (!style_properties_1.paddingRightProperty.isSet(style)) {
                    this.effectivePaddingRight = this._defaultPaddingRight;
                }
                if (!style_properties_1.paddingBottomProperty.isSet(style)) {
                    this.effectivePaddingBottom = this._defaultPaddingBottom;
                }
                if (!style_properties_1.paddingLeftProperty.isSet(style)) {
                    this.effectivePaddingLeft = this._defaultPaddingLeft;
                }
            }
        }
        else {
            this._iosView = nativeView;
        }
        this.setNativeView(nativeView);
        if (this.parent) {
            var nativeIndex = this.parent._childIndexToNativeChildIndex(atIndex);
            this._isAddedToNativeVisualTree = this.parent._addViewToNativeVisualTree(this, nativeIndex);
        }
        this._resumeNativeUpdates(SuspendType.UISetup);
        this.eachChild(function (child) {
            child._setupUI(context);
            return true;
        });
    };
    ViewBase.prototype.setNativeView = function (value) {
        if (this.__nativeView === value) {
            return;
        }
        if (this.__nativeView) {
            this._suspendNativeUpdates(SuspendType.NativeView);
        }
        this.__nativeView = this.nativeViewProtected = value;
        if (this.__nativeView) {
            this._suspendedUpdates = undefined;
            this.initNativeView();
            this._resumeNativeUpdates(SuspendType.NativeView);
        }
    };
    ViewBase.prototype._tearDownUI = function (force) {
        if (!this._context) {
            return;
        }
        this.resetNativeViewInternal();
        this.eachChild(function (child) {
            child._tearDownUI(force);
            return true;
        });
        if (this.parent) {
            this.parent._removeViewFromNativeVisualTree(this);
        }
        this.disposeNativeView();
        this._suspendNativeUpdates(SuspendType.UISetup);
        if (platform_1.isAndroid) {
            this.setNativeView(null);
            this._androidView = null;
        }
        this._context = null;
        if (this.domNode) {
            this.domNode.dispose();
            this.domNode = undefined;
        }
    };
    ViewBase.prototype._childIndexToNativeChildIndex = function (index) {
        return index;
    };
    ViewBase.prototype._addViewToNativeVisualTree = function (view, atIndex) {
        if (view._isAddedToNativeVisualTree) {
            throw new Error("Child already added to the native visual tree.");
        }
        return true;
    };
    ViewBase.prototype._removeViewFromNativeVisualTree = function (view) {
        view._isAddedToNativeVisualTree = false;
    };
    ViewBase.prototype._goToVisualState = function (state) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + " going to state: " + state, bindable_1.traceCategories.Style);
        }
        if (state === this._visualState) {
            return;
        }
        this.deletePseudoClass(this._visualState);
        this._visualState = state;
        this.addPseudoClass(state);
    };
    ViewBase.prototype._applyXmlAttribute = function (attribute, value) {
        console.log("ViewBase._applyXmlAttribute(...) is deprecated; set attributes as plain properties instead");
        if (attribute === "style" || attribute === "rows" || attribute === "columns" || attribute === "fontAttributes") {
            this[attribute] = value;
            return true;
        }
        return false;
    };
    ViewBase.prototype.setInlineStyle = function (style) {
        if (typeof style !== "string") {
            throw new Error("Parameter should be valid CSS string!");
        }
        ensureStyleScopeModule();
        styleScopeModule.applyInlineStyle(this, style);
    };
    ViewBase.prototype._parentChanged = function (oldParent) {
        var newParent = this.parent;
        if (oldParent) {
            properties_1.clearInheritedProperties(this);
            if (this.bindingContextBoundToParentBindingContextChanged) {
                oldParent.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        else if (this.shouldAddHandlerToParentBindingContextChanged) {
            newParent.on("bindingContextChange", this.bindingContextChanged, this);
            this.bindings.get("bindingContext").bind(newParent.bindingContext);
        }
    };
    ViewBase.prototype.onResumeNativeUpdates = function () {
        properties_1.initNativeView(this);
    };
    ViewBase.prototype.toString = function () {
        var str = this.typeName;
        if (this.id) {
            str += "<" + this.id + ">";
        }
        else {
            str += "(" + this._domId + ")";
        }
        var source = debug_1.Source.get(this);
        if (source) {
            str += "@" + source + ";";
        }
        return str;
    };
    ViewBase.prototype._onCssStateChange = function () {
        this._cssState.onChange();
        eachDescendant(this, function (child) {
            child._cssState.onChange();
            return true;
        });
    };
    ViewBase.prototype._inheritStyleScope = function (styleScope) {
        if (this._isStyleScopeHost) {
            return;
        }
        if (this._styleScope !== styleScope) {
            this._styleScope = styleScope;
            this._onCssStateChange();
            this.eachChild(function (child) {
                child._inheritStyleScope(styleScope);
                return true;
            });
        }
    };
    ViewBase.prototype.showModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        return parent && parent.showModal.apply(parent, args);
    };
    ViewBase.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        if (parent) {
            parent.closeModal.apply(parent, args);
        }
    };
    ViewBase.prototype._dialogClosed = function () {
        eachDescendant(this, function (child) {
            child._dialogClosed();
            return true;
        });
    };
    ViewBase.prototype._onRootViewReset = function () {
        eachDescendant(this, function (child) {
            child._onRootViewReset();
            return true;
        });
    };
    ViewBase.loadedEvent = "loaded";
    ViewBase.unloadedEvent = "unloaded";
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "addPseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "deletePseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "requestLayout", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_addView", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_setupUI", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_tearDownUI", null);
    return ViewBase;
}(bindable_1.Observable));
exports.ViewBase = ViewBase;
ViewBase.prototype.isCollapsed = false;
ViewBase.prototype._oldLeft = 0;
ViewBase.prototype._oldTop = 0;
ViewBase.prototype._oldRight = 0;
ViewBase.prototype._oldBottom = 0;
ViewBase.prototype.effectiveMinWidth = 0;
ViewBase.prototype.effectiveMinHeight = 0;
ViewBase.prototype.effectiveWidth = 0;
ViewBase.prototype.effectiveHeight = 0;
ViewBase.prototype.effectiveMarginTop = 0;
ViewBase.prototype.effectiveMarginRight = 0;
ViewBase.prototype.effectiveMarginBottom = 0;
ViewBase.prototype.effectiveMarginLeft = 0;
ViewBase.prototype.effectivePaddingTop = 0;
ViewBase.prototype.effectivePaddingRight = 0;
ViewBase.prototype.effectivePaddingBottom = 0;
ViewBase.prototype.effectivePaddingLeft = 0;
ViewBase.prototype.effectiveBorderTopWidth = 0;
ViewBase.prototype.effectiveBorderRightWidth = 0;
ViewBase.prototype.effectiveBorderBottomWidth = 0;
ViewBase.prototype.effectiveBorderLeftWidth = 0;
ViewBase.prototype._defaultPaddingTop = 0;
ViewBase.prototype._defaultPaddingRight = 0;
ViewBase.prototype._defaultPaddingBottom = 0;
ViewBase.prototype._defaultPaddingLeft = 0;
ViewBase.prototype._isViewBase = true;
ViewBase.prototype.recycleNativeView = "never";
ViewBase.prototype._suspendNativeUpdatesCount =
    SuspendType.Loaded |
        SuspendType.NativeView |
        SuspendType.UISetup;
exports.bindingContextProperty = new properties_1.InheritedProperty({ name: "bindingContext" });
exports.bindingContextProperty.register(ViewBase);
exports.classNameProperty = new properties_1.Property({
    name: "className",
    valueChanged: function (view, oldValue, newValue) {
        var cssClasses = view.cssClasses;
        var modalViewCssClass = system_classes_1.getModalRootViewCssClass();
        var rootViewCssClasses = system_classes_1.getRootViewCssClasses();
        var shouldAddModalRootViewCssClass = cssClasses.has(modalViewCssClass);
        var shouldAddRootViewCssClasses = cssClasses.has(rootViewCssClasses[0]);
        cssClasses.clear();
        if (shouldAddModalRootViewCssClass) {
            cssClasses.add(modalViewCssClass);
        }
        else if (shouldAddRootViewCssClasses) {
            rootViewCssClasses.forEach(function (c) { return cssClasses.add(c); });
        }
        if (typeof newValue === "string" && newValue !== "") {
            newValue.split(" ").forEach(function (c) { return cssClasses.add(c); });
        }
        view._onCssStateChange();
    }
});
exports.classNameProperty.register(ViewBase);
exports.idProperty = new properties_1.Property({ name: "id", valueChanged: function (view, oldValue, newValue) { return view._onCssStateChange(); } });
exports.idProperty.register(ViewBase);
function booleanConverter(v) {
    var lowercase = (v + "").toLowerCase();
    if (lowercase === "true") {
        return true;
    }
    else if (lowercase === "false") {
        return false;
    }
    throw new Error("Invalid boolean: " + v);
}
exports.booleanConverter = booleanConverter;
//# sourceMappingURL=view-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var style_scope_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
exports.LinearGradient = linear_gradient_1.LinearGradient;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js"));
var animationModule;
function ensureAnimationModule() {
    if (!animationModule) {
        animationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
    }
}
function CSSType(type) {
    return function (cls) {
        cls.prototype.cssType = type;
    };
}
exports.CSSType = CSSType;
function viewMatchesModuleContext(view, context, types) {
    return context &&
        view._moduleName &&
        context.type &&
        types.some(function (type) { return type === context.type; }) &&
        context.path &&
        context.path.includes(view._moduleName);
}
exports.viewMatchesModuleContext = viewMatchesModuleContext;
function PseudoClassHandler() {
    var pseudoClasses = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        pseudoClasses[_i] = arguments[_i];
    }
    var stateEventNames = pseudoClasses.map(function (s) { return ":" + s; });
    var listeners = Symbol("listeners");
    return function (target, propertyKey, descriptor) {
        function update(change) {
            var prev = this[listeners] || 0;
            var next = prev + change;
            if (prev <= 0 && next > 0) {
                this[propertyKey](true);
            }
            else if (prev > 0 && next <= 0) {
                this[propertyKey](false);
            }
        }
        stateEventNames.forEach(function (s) { return target[s] = update; });
    };
}
exports.PseudoClassHandler = PseudoClassHandler;
exports._rootModalViews = new Array();
var ViewCommon = (function (_super) {
    __extends(ViewCommon, _super);
    function ViewCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._gestureObservers = {};
        return _this;
    }
    Object.defineProperty(ViewCommon.prototype, "css", {
        get: function () {
            var scope = this._styleScope;
            return scope && scope.css;
        },
        set: function (value) {
            this._updateStyleScope(undefined, undefined, value);
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.addCss = function (cssString) {
        this._updateStyleScope(undefined, cssString);
    };
    ViewCommon.prototype.addCssFile = function (cssFileName) {
        this._updateStyleScope(cssFileName);
    };
    ViewCommon.prototype.changeCssFile = function (cssFileName) {
        var scope = this._styleScope;
        if (scope && cssFileName) {
            scope.changeCssFile(cssFileName);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype._updateStyleScope = function (cssFileName, cssString, css) {
        var scope = this._styleScope;
        if (!scope) {
            scope = new style_scope_1.StyleScope();
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._inheritStyleScope(scope);
            this._isStyleScopeHost = true;
        }
        else {
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype.setScopeProperty = function (scope, cssFileName, cssString, css) {
        if (cssFileName !== undefined) {
            scope.addCssFile(cssFileName);
        }
        else if (cssString !== undefined) {
            scope.addCss(cssString);
        }
        else if (css !== undefined) {
            scope.css = css;
        }
    };
    ViewCommon.prototype._closeAllModalViewsInternal = function () {
        if (exports._rootModalViews && exports._rootModalViews.length > 0) {
            exports._rootModalViews.forEach(function (v) {
                v.closeModal();
            });
            return true;
        }
        return false;
    };
    ViewCommon.prototype._getRootModalViews = function () {
        return exports._rootModalViews;
    };
    ViewCommon.prototype._onLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._onLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (this._closeAllModalViewsInternal()) {
            return true;
        }
        if (this._handleLivesync(context)) {
            return true;
        }
        var handled = false;
        this.eachChildView(function (child) {
            if (child._onLivesync(context)) {
                handled = true;
                return false;
            }
        });
        return handled;
    };
    ViewCommon.prototype._handleLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._handleLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (viewMatchesModuleContext(this, context, ["style"])) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing CSS for " + this, view_base_1.traceCategories.Livesync);
            }
            var cssModuleName = module_name_sanitizer_1.sanitizeModuleName(context.path) + ".css";
            this.changeCssFile(cssModuleName);
            return true;
        }
        if (viewMatchesModuleContext(this, context, ["markup", "script"]) &&
            this.page &&
            this.page.frame) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing " + context.type + " for " + this + " inside " + this.page, view_base_1.traceCategories.Livesync);
            }
            return this.page.frame._handleLivesync({ type: context.type, path: this.page._moduleName });
        }
        return false;
    };
    ViewCommon.prototype._setupAsRootView = function (context) {
        _super.prototype._setupAsRootView.call(this, context);
        if (!this._styleScope) {
            this._updateStyleScope();
        }
    };
    ViewCommon.prototype._observe = function (type, callback, thisArg) {
        if (!this._gestureObservers[type]) {
            this._gestureObservers[type] = [];
        }
        this._gestureObservers[type].push(gestures_1.observe(this, type, callback, thisArg));
    };
    ViewCommon.prototype.getGestureObservers = function (type) {
        return this._gestureObservers[type];
    };
    ViewCommon.prototype.addEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            arg = view_base_1.getEventOrGestureName(arg);
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._observe(gesture, callback, thisArg);
            }
            else {
                var events = (arg).split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._observe(gst, callback, thisArg);
                        }
                        else {
                            _super.prototype.addEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.addEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._observe(arg, callback, thisArg);
        }
    };
    ViewCommon.prototype.removeEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._disconnectGestureObservers(gesture);
            }
            else {
                var events = arg.split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._disconnectGestureObservers(gst);
                        }
                        else {
                            _super.prototype.removeEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._disconnectGestureObservers(arg);
        }
    };
    ViewCommon.prototype.onBackPressed = function () {
        return false;
    };
    ViewCommon.prototype._getFragmentManager = function () {
        return undefined;
    };
    ViewCommon.prototype.getModalOptions = function (args) {
        if (args.length === 0) {
            throw new Error("showModal without parameters is deprecated. Please call showModal on a view instance instead.");
        }
        else {
            var options = null;
            if (args.length === 2) {
                options = args[1];
            }
            else {
                if (args[0] instanceof ViewCommon) {
                    console.log("showModal(view: ViewBase, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(view: ViewBase, modalOptions: ShowModalOptions) instead.");
                }
                else {
                    console.log("showModal(moduleName: string, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(moduleName: string, modalOptions: ShowModalOptions) instead.");
                }
                options = {
                    context: args[1],
                    closeCallback: args[2],
                    fullscreen: args[3],
                    animated: args[4],
                    stretched: args[5]
                };
            }
            var firstArgument = args[0];
            var view = firstArgument instanceof ViewCommon
                ? firstArgument : builder_1.createViewFromEntry({ moduleName: firstArgument });
            return { view: view, options: options };
        }
    };
    ViewCommon.prototype.showModal = function () {
        var _a = this.getModalOptions(arguments), view = _a.view, options = _a.options;
        view._showNativeModalView(this, options);
        return view;
    };
    ViewCommon.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var closeCallback = this._closeModalCallback;
        if (closeCallback) {
            closeCallback.apply(undefined, arguments);
        }
        else {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1.closeModal.apply(parent_1, args);
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "modal", {
        get: function () {
            return this._modal;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype._showNativeModalView = function (parent, options) {
        exports._rootModalViews.push(this);
        var modalRootViewCssClass = system_classes_1.getModalRootViewCssClass();
        this.cssClasses.add(modalRootViewCssClass);
        parent._modal = this;
        this._modalParent = parent;
        this._modalContext = options.context;
        var that = this;
        this._closeModalCallback = function () {
            var originalArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                originalArgs[_i] = arguments[_i];
            }
            if (that._closeModalCallback) {
                var modalIndex = exports._rootModalViews.indexOf(that);
                exports._rootModalViews.splice(modalIndex);
                that._modalParent = null;
                that._modalContext = null;
                that._closeModalCallback = null;
                that._dialogClosed();
                parent._modal = null;
                var whenClosedCallback = function () {
                    if (typeof options.closeCallback === "function") {
                        options.closeCallback.apply(undefined, originalArgs);
                    }
                };
                that._hideNativeModalView(parent, whenClosedCallback);
            }
        };
    };
    ViewCommon.prototype._raiseLayoutChangedEvent = function () {
        var args = {
            eventName: ViewCommon.layoutChangedEvent,
            object: this
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShownModallyEvent = function () {
        var args = {
            eventName: ViewCommon.shownModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShowingModallyEvent = function () {
        var args = {
            eventName: ViewCommon.showingModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._isEvent = function (name) {
        return this.constructor && name + "Event" in this.constructor;
    };
    ViewCommon.prototype._disconnectGestureObservers = function (type) {
        var observers = this.getGestureObservers(type);
        if (observers) {
            for (var i = 0; i < observers.length; i++) {
                observers[i].disconnect();
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "borderColor", {
        get: function () {
            return this.style.borderColor;
        },
        set: function (value) {
            this.style.borderColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopColor", {
        get: function () {
            return this.style.borderTopColor;
        },
        set: function (value) {
            this.style.borderTopColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightColor", {
        get: function () {
            return this.style.borderRightColor;
        },
        set: function (value) {
            this.style.borderRightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomColor", {
        get: function () {
            return this.style.borderBottomColor;
        },
        set: function (value) {
            this.style.borderBottomColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftColor", {
        get: function () {
            return this.style.borderLeftColor;
        },
        set: function (value) {
            this.style.borderLeftColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderWidth", {
        get: function () {
            return this.style.borderWidth;
        },
        set: function (value) {
            this.style.borderWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopWidth", {
        get: function () {
            return this.style.borderTopWidth;
        },
        set: function (value) {
            this.style.borderTopWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightWidth", {
        get: function () {
            return this.style.borderRightWidth;
        },
        set: function (value) {
            this.style.borderRightWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomWidth", {
        get: function () {
            return this.style.borderBottomWidth;
        },
        set: function (value) {
            this.style.borderBottomWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftWidth", {
        get: function () {
            return this.style.borderLeftWidth;
        },
        set: function (value) {
            this.style.borderLeftWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRadius", {
        get: function () {
            return this.style.borderRadius;
        },
        set: function (value) {
            this.style.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopLeftRadius", {
        get: function () {
            return this.style.borderTopLeftRadius;
        },
        set: function (value) {
            this.style.borderTopLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopRightRadius", {
        get: function () {
            return this.style.borderTopRightRadius;
        },
        set: function (value) {
            this.style.borderTopRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomRightRadius", {
        get: function () {
            return this.style.borderBottomRightRadius;
        },
        set: function (value) {
            this.style.borderBottomRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomLeftRadius", {
        get: function () {
            return this.style.borderBottomLeftRadius;
        },
        set: function (value) {
            this.style.borderBottomLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "background", {
        get: function () {
            return this.style.background;
        },
        set: function (value) {
            this.style.background = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundImage", {
        get: function () {
            return this.style.backgroundImage;
        },
        set: function (value) {
            this.style.backgroundImage = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundSize", {
        get: function () {
            return this.style.backgroundSize;
        },
        set: function (value) {
            this.style.backgroundSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundPosition", {
        get: function () {
            return this.style.backgroundPosition;
        },
        set: function (value) {
            this.style.backgroundPosition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundRepeat", {
        get: function () {
            return this.style.backgroundRepeat;
        },
        set: function (value) {
            this.style.backgroundRepeat = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minWidth", {
        get: function () {
            return this.style.minWidth;
        },
        set: function (value) {
            this.style.minWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minHeight", {
        get: function () {
            return this.style.minHeight;
        },
        set: function (value) {
            this.style.minHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "width", {
        get: function () {
            return this.style.width;
        },
        set: function (value) {
            this.style.width = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "height", {
        get: function () {
            return this.style.height;
        },
        set: function (value) {
            this.style.height = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "margin", {
        get: function () {
            return this.style.margin;
        },
        set: function (value) {
            this.style.margin = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginLeft", {
        get: function () {
            return this.style.marginLeft;
        },
        set: function (value) {
            this.style.marginLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginTop", {
        get: function () {
            return this.style.marginTop;
        },
        set: function (value) {
            this.style.marginTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginRight", {
        get: function () {
            return this.style.marginRight;
        },
        set: function (value) {
            this.style.marginRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginBottom", {
        get: function () {
            return this.style.marginBottom;
        },
        set: function (value) {
            this.style.marginBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "horizontalAlignment", {
        get: function () {
            return this.style.horizontalAlignment;
        },
        set: function (value) {
            this.style.horizontalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "verticalAlignment", {
        get: function () {
            return this.style.verticalAlignment;
        },
        set: function (value) {
            this.style.verticalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "visibility", {
        get: function () {
            return this.style.visibility;
        },
        set: function (value) {
            this.style.visibility = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "opacity", {
        get: function () {
            return this.style.opacity;
        },
        set: function (value) {
            this.style.opacity = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "rotate", {
        get: function () {
            return this.style.rotate;
        },
        set: function (value) {
            this.style.rotate = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateX", {
        get: function () {
            return this.style.translateX;
        },
        set: function (value) {
            this.style.translateX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateY", {
        get: function () {
            return this.style.translateY;
        },
        set: function (value) {
            this.style.translateY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleX", {
        get: function () {
            return this.style.scaleX;
        },
        set: function (value) {
            this.style.scaleX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleY", {
        get: function () {
            return this.style.scaleY;
        },
        set: function (value) {
            this.style.scaleY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidElevation", {
        get: function () {
            return this.style.androidElevation;
        },
        set: function (value) {
            this.style.androidElevation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidDynamicElevationOffset", {
        get: function () {
            return this.style.androidDynamicElevationOffset;
        },
        set: function (value) {
            this.style.androidDynamicElevationOffset = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutValid", {
        get: function () {
            return this._isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "cssType", {
        get: function () {
            if (!this._cssType) {
                this._cssType = this.typeName.toLowerCase();
            }
            return this._cssType;
        },
        set: function (type) {
            this._cssType = type.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutRequired", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
    };
    ViewCommon.prototype.layout = function (left, top, right, bottom) {
        this._setCurrentLayoutBounds(left, top, right, bottom);
    };
    ViewCommon.prototype.getMeasuredWidth = function () {
        return this._measuredWidth & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredHeight = function () {
        return this._measuredHeight & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredState = function () {
        return (this._measuredWidth & view_base_1.layout.MEASURED_STATE_MASK)
            | ((this._measuredHeight >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT)
                & (view_base_1.layout.MEASURED_STATE_MASK >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT));
    };
    ViewCommon.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        this._measuredWidth = measuredWidth;
        this._measuredHeight = measuredHeight;
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + " :setMeasuredDimension: " + measuredWidth + ", " + measuredHeight, view_base_1.traceCategories.Layout);
        }
    };
    ViewCommon.prototype.requestLayout = function () {
        this._isLayoutValid = false;
        _super.prototype.requestLayout.call(this);
    };
    ViewCommon.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_base_1.layout.UNSPECIFIED:
                result = Math.ceil(size);
                break;
            case view_base_1.layout.AT_MOST:
                if (specSize < size) {
                    result = Math.ceil(specSize) | view_base_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_base_1.layout.EXACTLY:
                result = Math.ceil(specSize);
                break;
        }
        return result | (childMeasuredState & view_base_1.layout.MEASURED_STATE_MASK);
    };
    ViewCommon.combineMeasuredStates = function (curState, newState) {
        return curState | newState;
    };
    ViewCommon.layoutChild = function (parent, child, left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        if (!child || child.isCollapsed) {
            return;
        }
        var childStyle = child.style;
        var childTop;
        var childLeft;
        var childWidth = child.getMeasuredWidth();
        var childHeight = child.getMeasuredHeight();
        var effectiveMarginTop = child.effectiveMarginTop;
        var effectiveMarginBottom = child.effectiveMarginBottom;
        var vAlignment;
        if (child.effectiveHeight >= 0 && childStyle.verticalAlignment === "stretch") {
            vAlignment = "middle";
        }
        else {
            vAlignment = childStyle.verticalAlignment;
        }
        switch (vAlignment) {
            case "top":
                childTop = top + effectiveMarginTop;
                break;
            case "middle":
                childTop = top + (bottom - top - childHeight + (effectiveMarginTop - effectiveMarginBottom)) / 2;
                break;
            case "bottom":
                childTop = bottom - childHeight - effectiveMarginBottom;
                break;
            case "stretch":
            default:
                childTop = top + effectiveMarginTop;
                childHeight = bottom - top - (effectiveMarginTop + effectiveMarginBottom);
                break;
        }
        var effectiveMarginLeft = child.effectiveMarginLeft;
        var effectiveMarginRight = child.effectiveMarginRight;
        var hAlignment;
        if (child.effectiveWidth >= 0 && childStyle.horizontalAlignment === "stretch") {
            hAlignment = "center";
        }
        else {
            hAlignment = childStyle.horizontalAlignment;
        }
        switch (hAlignment) {
            case "left":
                childLeft = left + effectiveMarginLeft;
                break;
            case "center":
                childLeft = left + (right - left - childWidth + (effectiveMarginLeft - effectiveMarginRight)) / 2;
                break;
            case "right":
                childLeft = right - childWidth - effectiveMarginRight;
                break;
            case "stretch":
            default:
                childLeft = left + effectiveMarginLeft;
                childWidth = right - left - (effectiveMarginLeft + effectiveMarginRight);
                break;
        }
        var childRight = Math.round(childLeft + childWidth);
        var childBottom = Math.round(childTop + childHeight);
        childLeft = Math.round(childLeft);
        childTop = Math.round(childTop);
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(child.parent + " :layoutChild: " + child + " " + childLeft + ", " + childTop + ", " + childRight + ", " + childBottom, view_base_1.traceCategories.Layout);
        }
        child.layout(childLeft, childTop, childRight, childBottom, setFrame);
    };
    ViewCommon.measureChild = function (parent, child, widthMeasureSpec, heightMeasureSpec) {
        var measureWidth = 0;
        var measureHeight = 0;
        if (child && !child.isCollapsed) {
            var widthSpec = parent ? parent._currentWidthMeasureSpec : widthMeasureSpec;
            var heightSpec = parent ? parent._currentHeightMeasureSpec : heightMeasureSpec;
            var width = view_base_1.layout.getMeasureSpecSize(widthSpec);
            var widthMode = view_base_1.layout.getMeasureSpecMode(widthSpec);
            var height = view_base_1.layout.getMeasureSpecSize(heightSpec);
            var heightMode = view_base_1.layout.getMeasureSpecMode(heightSpec);
            child._updateEffectiveLayoutValues(width, widthMode, height, heightMode);
            var style = child.style;
            var horizontalMargins = child.effectiveMarginLeft + child.effectiveMarginRight;
            var verticalMargins = child.effectiveMarginTop + child.effectiveMarginBottom;
            var childWidthMeasureSpec = ViewCommon.getMeasureSpec(widthMeasureSpec, horizontalMargins, child.effectiveWidth, style.horizontalAlignment === "stretch");
            var childHeightMeasureSpec = ViewCommon.getMeasureSpec(heightMeasureSpec, verticalMargins, child.effectiveHeight, style.verticalAlignment === "stretch");
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite(child.parent + " :measureChild: " + child + " " + view_base_1.layout.measureSpecToString(childWidthMeasureSpec) + ", " + view_base_1.layout.measureSpecToString(childHeightMeasureSpec) + "}", view_base_1.traceCategories.Layout);
            }
            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
            measureWidth = Math.round(child.getMeasuredWidth() + horizontalMargins);
            measureHeight = Math.round(child.getMeasuredHeight() + verticalMargins);
        }
        return { measuredWidth: measureWidth, measuredHeight: measureHeight };
    };
    ViewCommon.getMeasureSpec = function (parentSpec, margins, childLength, stretched) {
        var parentLength = view_base_1.layout.getMeasureSpecSize(parentSpec);
        var parentSpecMode = view_base_1.layout.getMeasureSpecMode(parentSpec);
        var resultSize;
        var resultMode;
        if (childLength >= 0) {
            resultSize = parentSpecMode === view_base_1.layout.UNSPECIFIED ? childLength : Math.min(parentLength, childLength);
            resultMode = view_base_1.layout.EXACTLY;
        }
        else {
            switch (parentSpecMode) {
                case view_base_1.layout.EXACTLY:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = stretched ? view_base_1.layout.EXACTLY : view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.AT_MOST:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.UNSPECIFIED:
                    resultSize = 0;
                    resultMode = view_base_1.layout.UNSPECIFIED;
                    break;
            }
        }
        return view_base_1.layout.makeMeasureSpec(resultSize, resultMode);
    };
    ViewCommon.prototype._setCurrentMeasureSpecs = function (widthMeasureSpec, heightMeasureSpec) {
        var changed = this._currentWidthMeasureSpec !== widthMeasureSpec || this._currentHeightMeasureSpec !== heightMeasureSpec;
        this._currentWidthMeasureSpec = widthMeasureSpec;
        this._currentHeightMeasureSpec = heightMeasureSpec;
        return changed;
    };
    ViewCommon.prototype._getCurrentLayoutBounds = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype._setCurrentLayoutBounds = function (left, top, right, bottom) {
        this._isLayoutValid = true;
        var boundsChanged = this._oldLeft !== left || this._oldTop !== top || this._oldRight !== right || this._oldBottom !== bottom;
        var sizeChanged = (this._oldRight - this._oldLeft !== right - left) || (this._oldBottom - this._oldTop !== bottom - top);
        this._oldLeft = left;
        this._oldTop = top;
        this._oldRight = right;
        this._oldBottom = bottom;
        return { boundsChanged: boundsChanged, sizeChanged: sizeChanged };
    };
    ViewCommon.prototype.eachChild = function (callback) {
        this.eachChildView(callback);
    };
    ViewCommon.prototype.eachChildView = function (callback) {
    };
    ViewCommon.prototype._getNativeViewsCount = function () {
        return this._isAddedToNativeVisualTree ? 1 : 0;
    };
    ViewCommon.prototype._eachLayoutView = function (callback) {
        return callback(this);
    };
    ViewCommon.prototype.focus = function () {
        return undefined;
    };
    ViewCommon.prototype.getSafeAreaInsets = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype.getLocationInWindow = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationOnScreen = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationRelativeTo = function (otherView) {
        return undefined;
    };
    ViewCommon.prototype.getActualSize = function () {
        var currentBounds = this._getCurrentLayoutBounds();
        if (!currentBounds) {
            return undefined;
        }
        return {
            width: view_base_1.layout.toDeviceIndependentPixels(currentBounds.right - currentBounds.left),
            height: view_base_1.layout.toDeviceIndependentPixels(currentBounds.bottom - currentBounds.top),
        };
    };
    ViewCommon.prototype.animate = function (animation) {
        return this.createAnimation(animation).play();
    };
    ViewCommon.prototype.createAnimation = function (animation) {
        ensureAnimationModule();
        if (!this._localAnimations) {
            this._localAnimations = new Set();
        }
        animation.target = this;
        var anim = new animationModule.Animation([animation]);
        this._localAnimations.add(anim);
        return anim;
    };
    ViewCommon.prototype._removeAnimation = function (animation) {
        var localAnimations = this._localAnimations;
        if (localAnimations && localAnimations.has(animation)) {
            localAnimations.delete(animation);
            if (animation.isPlaying) {
                animation.cancel();
            }
            return true;
        }
        return false;
    };
    ViewCommon.prototype.resetNativeView = function () {
        var _this = this;
        if (this._localAnimations) {
            this._localAnimations.forEach(function (a) { return _this._removeAnimation(a); });
        }
        _super.prototype.resetNativeView.call(this);
    };
    ViewCommon.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    ViewCommon.prototype._getValue = function () {
        throw new Error("The View._getValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._setValue = function () {
        throw new Error("The View._setValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._updateEffectiveLayoutValues = function (parentWidthMeasureSize, parentWidthMeasureMode, parentHeightMeasureSize, parentHeightMeasureMode) {
        var style = this.style;
        var availableWidth = parentWidthMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentWidthMeasureSize;
        this.effectiveWidth = style_properties_1.PercentLength.toDevicePixels(style.width, -2, availableWidth);
        this.effectiveMarginLeft = style_properties_1.PercentLength.toDevicePixels(style.marginLeft, 0, availableWidth);
        this.effectiveMarginRight = style_properties_1.PercentLength.toDevicePixels(style.marginRight, 0, availableWidth);
        var availableHeight = parentHeightMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentHeightMeasureSize;
        this.effectiveHeight = style_properties_1.PercentLength.toDevicePixels(style.height, -2, availableHeight);
        this.effectiveMarginTop = style_properties_1.PercentLength.toDevicePixels(style.marginTop, 0, availableHeight);
        this.effectiveMarginBottom = style_properties_1.PercentLength.toDevicePixels(style.marginBottom, 0, availableHeight);
    };
    ViewCommon.prototype._setNativeClipToBounds = function () {
    };
    ViewCommon.prototype._redrawNativeBackground = function (value) {
    };
    ViewCommon.prototype._onAttachedToWindow = function () {
    };
    ViewCommon.prototype._onDetachedFromWindow = function () {
    };
    ViewCommon.prototype._hasAncestorView = function (ancestorView) {
        var matcher = function (view) { return view === ancestorView; };
        for (var parent_2 = this.parent; parent_2 != null; parent_2 = parent_2.parent) {
            if (matcher(parent_2)) {
                return true;
            }
        }
        return false;
    };
    ViewCommon.layoutChangedEvent = "layoutChanged";
    ViewCommon.shownModallyEvent = "shownModally";
    ViewCommon.showingModallyEvent = "showingModally";
    return ViewCommon;
}(view_base_1.ViewBase));
exports.ViewCommon = ViewCommon;
exports.automationTextProperty = new view_base_1.Property({ name: "automationText" });
exports.automationTextProperty.register(ViewCommon);
exports.originXProperty = new view_base_1.Property({ name: "originX", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originXProperty.register(ViewCommon);
exports.originYProperty = new view_base_1.Property({ name: "originY", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originYProperty.register(ViewCommon);
exports.isEnabledProperty = new view_base_1.Property({
    name: "isEnabled",
    defaultValue: true,
    valueConverter: view_base_1.booleanConverter,
    valueChanged: function (target, oldValue, newValue) {
        target._goToVisualState(newValue ? "normal" : "disabled");
    }
});
exports.isEnabledProperty.register(ViewCommon);
exports.isUserInteractionEnabledProperty = new view_base_1.Property({ name: "isUserInteractionEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.isUserInteractionEnabledProperty.register(ViewCommon);
exports.iosOverflowSafeAreaProperty = new view_base_1.Property({ name: "iosOverflowSafeArea", defaultValue: false, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaProperty.register(ViewCommon);
exports.iosOverflowSafeAreaEnabledProperty = new view_base_1.InheritedProperty({ name: "iosOverflowSafeAreaEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaEnabledProperty.register(ViewCommon);
//# sourceMappingURL=view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js"));
var DOMID = "_domId";
var androidBackPressedEvent = "androidBackPressed";
var shortAnimTime = 17694720;
var statePressed = 16842919;
var stateEnabled = 16842910;
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var modalMap = new Map();
var TouchListener;
var DialogFragment;
function initializeTouchListener() {
    if (TouchListener) {
        return;
    }
    var TouchListenerImpl = (function (_super) {
        __extends(TouchListenerImpl, _super);
        function TouchListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = new WeakRef(owner);
            return global.__native(_this);
        }
        TouchListenerImpl.prototype.onTouch = function (view, event) {
            var owner = this.owner.get();
            if (!owner) {
                return;
            }
            owner.handleGestureTouch(event);
            var nativeView = owner.nativeViewProtected;
            if (!nativeView || !nativeView.onTouchEvent) {
                return false;
            }
            return nativeView.onTouchEvent(event);
        };
        TouchListenerImpl = __decorate([
            Interfaces([android.view.View.OnTouchListener])
        ], TouchListenerImpl);
        return TouchListenerImpl;
    }(java.lang.Object));
    TouchListener = TouchListenerImpl;
}
function initializeDialogFragment() {
    if (DialogFragment) {
        return;
    }
    var DialogImpl = (function (_super) {
        __extends(DialogImpl, _super);
        function DialogImpl(fragment, context, themeResId) {
            var _this = _super.call(this, context, themeResId) || this;
            _this.fragment = fragment;
            return global.__native(_this);
        }
        DialogImpl.prototype.onDetachedFromWindow = function () {
            _super.prototype.onDetachedFromWindow.call(this);
            this.fragment = null;
        };
        DialogImpl.prototype.onBackPressed = function () {
            var view = this.fragment.owner;
            var args = {
                eventName: "activityBackPressed",
                object: view,
                activity: view._context,
                cancel: false,
            };
            application_1.android.notify(args);
            if (args.cancel) {
                return;
            }
            view.notify(args);
            if (!args.cancel && !view.onBackPressed()) {
                _super.prototype.onBackPressed.call(this);
            }
        };
        return DialogImpl;
    }(android.app.Dialog));
    var DialogFragmentImpl = (function (_super) {
        __extends(DialogFragmentImpl, _super);
        function DialogFragmentImpl() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        DialogFragmentImpl.prototype.onCreateDialog = function (savedInstanceState) {
            var ownerId = this.getArguments().getInt(DOMID);
            var options = getModalOptions(ownerId);
            this.owner = options.owner;
            this._fullscreen = options.fullscreen;
            this._animated = options.animated;
            this._cancelable = options.cancelable;
            this._stretched = options.stretched;
            this._dismissCallback = options.dismissCallback;
            this._shownCallback = options.shownCallback;
            this.setStyle(androidx.fragment.app.DialogFragment.STYLE_NO_TITLE, 0);
            var theme = this.getTheme();
            if (this._fullscreen) {
                theme = this.getActivity().getApplicationInfo().theme;
            }
            var dialog = new DialogImpl(this, this.getActivity(), theme);
            if (!this._fullscreen && !this._stretched) {
                this.owner.horizontalAlignment = "center";
                this.owner.verticalAlignment = "middle";
            }
            else {
                this.owner.horizontalAlignment = "stretch";
                this.owner.verticalAlignment = "stretch";
            }
            if (this._animated) {
                dialog
                    .getWindow()
                    .setWindowAnimations(android.R.style.Animation_Dialog);
            }
            dialog.setCanceledOnTouchOutside(this._cancelable);
            return dialog;
        };
        DialogFragmentImpl.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var owner = this.owner;
            owner._setupAsRootView(this.getActivity());
            owner._isAddedToNativeVisualTree = true;
            return owner.nativeViewProtected;
        };
        DialogFragmentImpl.prototype.onStart = function () {
            _super.prototype.onStart.call(this);
            if (this._fullscreen) {
                var window_1 = this.getDialog().getWindow();
                var length_1 = android.view.ViewGroup.LayoutParams.MATCH_PARENT;
                window_1.setLayout(length_1, length_1);
                window_1.setBackgroundDrawable(new android.graphics.drawable.ColorDrawable(android.graphics.Color.WHITE));
            }
            var owner = this.owner;
            if (owner && !owner.isLoaded) {
                owner.callLoaded();
            }
            this._shownCallback();
        };
        DialogFragmentImpl.prototype.onDismiss = function (dialog) {
            _super.prototype.onDismiss.call(this, dialog);
            var manager = this.getFragmentManager();
            if (manager) {
                removeModal(this.owner._domId);
                this._dismissCallback();
            }
            var owner = this.owner;
            if (owner && owner.isLoaded) {
                owner.callUnloaded();
            }
        };
        DialogFragmentImpl.prototype.onDestroy = function () {
            _super.prototype.onDestroy.call(this);
            var owner = this.owner;
            if (owner) {
                if (owner.isLoaded) {
                    owner.callUnloaded();
                }
                owner._isAddedToNativeVisualTree = false;
                owner._tearDownUI(true);
            }
        };
        return DialogFragmentImpl;
    }(androidx.fragment.app.DialogFragment));
    DialogFragment = DialogFragmentImpl;
}
function saveModal(options) {
    modalMap.set(options.owner._domId, options);
}
function removeModal(domId) {
    modalMap.delete(domId);
}
function getModalOptions(domId) {
    return modalMap.get(domId);
}
var View = (function (_super) {
    __extends(View, _super);
    function View() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    View.prototype._observe = function (type, callback, thisArg) {
        _super.prototype._observe.call(this, type, callback, thisArg);
        if (this.isLoaded && !this.touchListenerIsSet) {
            this.setOnTouchListener();
        }
    };
    View.prototype.on = function (eventNames, callback, thisArg) {
        _super.prototype.on.call(this, eventNames, callback, thisArg);
        var isLayoutEvent = typeof eventNames === "string" ? eventNames.indexOf(view_common_1.ViewCommon.layoutChangedEvent) !== -1 : false;
        if (this.isLoaded && !this.layoutChangeListenerIsSet && isLayoutEvent) {
            this.setOnLayoutChangeListener();
        }
    };
    View.prototype.off = function (eventNames, callback, thisArg) {
        _super.prototype.off.call(this, eventNames, callback, thisArg);
        var isLayoutEvent = typeof eventNames === "string" ? eventNames.indexOf(view_common_1.ViewCommon.layoutChangedEvent) !== -1 : false;
        if (this.isLoaded && this.layoutChangeListenerIsSet && isLayoutEvent && !this.hasListeners(view_common_1.ViewCommon.layoutChangedEvent)) {
            this.nativeViewProtected.removeOnLayoutChangeListener(this.layoutChangeListener);
            this.layoutChangeListenerIsSet = false;
        }
    };
    View.prototype._getChildFragmentManager = function () {
        return null;
    };
    View.prototype._getRootFragmentManager = function () {
        if (!this._rootManager && this._context) {
            this._rootManager = this._context.getSupportFragmentManager();
        }
        return this._rootManager;
    };
    View.prototype._getFragmentManager = function () {
        var manager = this._manager;
        if (!manager) {
            var view = this;
            var frameOrTabViewItemFound = false;
            while (view) {
                var dialogFragment = view._dialogFragment;
                if (dialogFragment) {
                    manager = dialogFragment.getChildFragmentManager();
                    break;
                }
                if (view._hasFragments) {
                    if (frameOrTabViewItemFound) {
                        manager = view._getChildFragmentManager();
                        break;
                    }
                    frameOrTabViewItemFound = true;
                }
                view = view.parent;
            }
            if (!manager) {
                manager = this._getRootFragmentManager();
            }
            this._manager = manager;
        }
        return manager;
    };
    View.prototype.onLoaded = function () {
        this._manager = null;
        this._rootManager = null;
        _super.prototype.onLoaded.call(this);
        this.setOnTouchListener();
    };
    View.prototype.onUnloaded = function () {
        if (this.touchListenerIsSet) {
            this.nativeViewProtected.setOnTouchListener(null);
            this.touchListenerIsSet = false;
            this.nativeViewProtected.setClickable(this._isClickable);
        }
        this._manager = null;
        this._rootManager = null;
        _super.prototype.onUnloaded.call(this);
    };
    View.prototype.onBackPressed = function () {
        var topmostFrame = frame_stack_1.topmost();
        if (topmostFrame && topmostFrame._hasAncestorView(this)) {
            return topmostFrame.onBackPressed();
        }
        return false;
    };
    View.prototype.handleGestureTouch = function (event) {
        for (var type in this._gestureObservers) {
            var list = this._gestureObservers[type];
            list.forEach(function (element) {
                element.androidOnTouchEvent(event);
            });
        }
        if (this.parent instanceof View) {
            this.parent.handleGestureTouch(event);
        }
    };
    View.prototype.hasGestureObservers = function () {
        return this._gestureObservers && Object.keys(this._gestureObservers).length > 0;
    };
    View.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._isClickable = this.nativeViewProtected.isClickable();
        if (this.hasListeners(view_common_1.ViewCommon.layoutChangedEvent)) {
            this.setOnLayoutChangeListener();
        }
    };
    View.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        if (this.layoutChangeListenerIsSet) {
            this.layoutChangeListenerIsSet = false;
            this.nativeViewProtected.removeOnLayoutChangeListener(this.layoutChangeListener);
        }
    };
    View.prototype.setOnTouchListener = function () {
        if (!this.nativeViewProtected || !this.hasGestureObservers()) {
            return;
        }
        initializeTouchListener();
        this.touchListener = this.touchListener || new TouchListener(this);
        this.nativeViewProtected.setOnTouchListener(this.touchListener);
        this.touchListenerIsSet = true;
        if (this.nativeViewProtected.setClickable) {
            this.nativeViewProtected.setClickable(this.isUserInteractionEnabled);
        }
    };
    View.prototype.setOnLayoutChangeListener = function () {
        if (this.nativeViewProtected) {
            var owner_1 = this;
            this.layoutChangeListenerIsSet = true;
            this.layoutChangeListener = this.layoutChangeListener || new android.view.View.OnLayoutChangeListener({
                onLayoutChange: function (v, left, top, right, bottom, oldLeft, oldTop, oldRight, oldBottom) {
                    if (left !== oldLeft || top !== oldTop || right !== oldRight || bottom !== oldBottom) {
                        owner_1._raiseLayoutChangedEvent();
                    }
                }
            });
            this.nativeViewProtected.addOnLayoutChangeListener(this.layoutChangeListener);
        }
    };
    Object.defineProperty(View.prototype, "isLayoutRequired", {
        get: function () {
            return !this.isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "isLayoutValid", {
        get: function () {
            if (this.nativeViewProtected) {
                return !this.nativeViewProtected.isLayoutRequested();
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "_hasFragments", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.layoutNativeView = function (left, top, right, bottom) {
        if (this.nativeViewProtected) {
            this.nativeViewProtected.layout(left, top, right, bottom);
        }
    };
    View.prototype.requestLayout = function () {
        _super.prototype.requestLayout.call(this);
        if (this.nativeViewProtected) {
            this.nativeViewProtected.requestLayout();
        }
    };
    View.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        _super.prototype.measure.call(this, widthMeasureSpec, heightMeasureSpec);
        this.onMeasure(widthMeasureSpec, heightMeasureSpec);
    };
    View.prototype.layout = function (left, top, right, bottom) {
        _super.prototype.layout.call(this, left, top, right, bottom);
        this.onLayout(left, top, right, bottom);
    };
    View.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var view = this.nativeViewProtected;
        if (view) {
            view.measure(widthMeasureSpec, heightMeasureSpec);
            this.setMeasuredDimension(view.getMeasuredWidth(), view.getMeasuredHeight());
        }
    };
    View.prototype.onLayout = function (left, top, right, bottom) {
        var view = this.nativeViewProtected;
        if (view) {
            this.layoutNativeView(left, top, right, bottom);
        }
    };
    View.prototype._getCurrentLayoutBounds = function () {
        if (this.nativeViewProtected && !this.isCollapsed) {
            return {
                left: this.nativeViewProtected.getLeft(),
                top: this.nativeViewProtected.getTop(),
                right: this.nativeViewProtected.getRight(),
                bottom: this.nativeViewProtected.getBottom()
            };
        }
        else {
            return { left: 0, top: 0, right: 0, bottom: 0 };
        }
    };
    View.prototype.getMeasuredWidth = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.getMeasuredWidth();
        }
        return _super.prototype.getMeasuredWidth.call(this);
    };
    View.prototype.getMeasuredHeight = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.getMeasuredHeight();
        }
        return _super.prototype.getMeasuredHeight.call(this);
    };
    View.prototype.focus = function () {
        if (this.nativeViewProtected) {
            return this.nativeViewProtected.requestFocus();
        }
        return false;
    };
    View.prototype.getLocationInWindow = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var nativeArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationInWindow(nativeArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(nativeArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(nativeArray[1]),
        };
    };
    View.prototype.getLocationOnScreen = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var nativeArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationOnScreen(nativeArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(nativeArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(nativeArray[1]),
        };
    };
    View.prototype.getLocationRelativeTo = function (otherView) {
        if (!this.nativeViewProtected || !this.nativeViewProtected.getWindowToken() ||
            !otherView || !otherView.nativeViewProtected || !otherView.nativeViewProtected.getWindowToken() ||
            this.nativeViewProtected.getWindowToken() !== otherView.nativeViewProtected.getWindowToken()) {
            return undefined;
        }
        var myArray = Array.create("int", 2);
        this.nativeViewProtected.getLocationOnScreen(myArray);
        var otherArray = Array.create("int", 2);
        otherView.nativeViewProtected.getLocationOnScreen(otherArray);
        return {
            x: view_common_1.layout.toDeviceIndependentPixels(myArray[0] - otherArray[0]),
            y: view_common_1.layout.toDeviceIndependentPixels(myArray[1] - otherArray[1]),
        };
    };
    View.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_common_1.layout.UNSPECIFIED:
                result = size;
                break;
            case view_common_1.layout.AT_MOST:
                if (specSize < size) {
                    result = specSize | view_common_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_common_1.layout.EXACTLY:
                result = specSize;
                break;
        }
        return result | (childMeasuredState & view_common_1.layout.MEASURED_STATE_MASK);
    };
    View.prototype._showNativeModalView = function (parent, options) {
        var _this = this;
        _super.prototype._showNativeModalView.call(this, parent, options);
        initializeDialogFragment();
        var df = new DialogFragment();
        var args = new android.os.Bundle();
        args.putInt(DOMID, this._domId);
        df.setArguments(args);
        var dialogOptions = {
            owner: this,
            fullscreen: !!options.fullscreen,
            animated: !!options.animated,
            stretched: !!options.stretched,
            cancelable: options.android ? !!options.android.cancelable : true,
            shownCallback: function () { return _this._raiseShownModallyEvent(); },
            dismissCallback: function () { return _this.closeModal(); }
        };
        saveModal(dialogOptions);
        this._dialogFragment = df;
        this._raiseShowingModallyEvent();
        this._dialogFragment.show(parent._getRootFragmentManager(), this._domId.toString());
    };
    View.prototype._hideNativeModalView = function (parent, whenClosedCallback) {
        var manager = this._dialogFragment.getFragmentManager();
        if (manager) {
            this._dialogFragment.dismissAllowingStateLoss();
        }
        this._dialogFragment = null;
        whenClosedCallback();
    };
    View.prototype[view_common_1.isEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setEnabled(value);
    };
    View.prototype[view_common_1.originXProperty.getDefault] = function () {
        return this.nativeViewProtected.getPivotX();
    };
    View.prototype[view_common_1.originXProperty.setNative] = function (value) {
        org.nativescript.widgets.OriginPoint.setX(this.nativeViewProtected, value);
    };
    View.prototype[view_common_1.originYProperty.getDefault] = function () {
        return this.nativeViewProtected.getPivotY();
    };
    View.prototype[view_common_1.originYProperty.setNative] = function (value) {
        org.nativescript.widgets.OriginPoint.setY(this.nativeViewProtected, value);
    };
    View.prototype[view_common_1.automationTextProperty.getDefault] = function () {
        return this.nativeViewProtected.getContentDescription();
    };
    View.prototype[view_common_1.automationTextProperty.setNative] = function (value) {
        this.nativeViewProtected.setContentDescription(value);
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setClickable(value);
        this.nativeViewProtected.setFocusable(value);
    };
    View.prototype[style_properties_1.visibilityProperty.getDefault] = function () {
        var nativeVisibility = this.nativeViewProtected.getVisibility();
        switch (nativeVisibility) {
            case android.view.View.VISIBLE:
                return "visible";
            case android.view.View.INVISIBLE:
                return "hidden";
            case android.view.View.GONE:
                return "collapse";
            default:
                throw new Error("Unsupported android.view.View visibility: " + nativeVisibility + ". Currently supported values are android.view.View.VISIBLE, android.view.View.INVISIBLE, android.view.View.GONE.");
        }
    };
    View.prototype[style_properties_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case "visible":
                this.nativeViewProtected.setVisibility(android.view.View.VISIBLE);
                break;
            case "hidden":
                this.nativeViewProtected.setVisibility(android.view.View.INVISIBLE);
                break;
            case "collapse":
                this.nativeViewProtected.setVisibility(android.view.View.GONE);
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: visible, hidden, collapse.");
        }
    };
    View.prototype[style_properties_1.opacityProperty.getDefault] = function () {
        return this.nativeViewProtected.getAlpha();
    };
    View.prototype[style_properties_1.opacityProperty.setNative] = function (value) {
        this.nativeViewProtected.setAlpha(float(value));
    };
    View.prototype[style_properties_1.androidElevationProperty.getDefault] = function () {
        return this.getDefaultElevation();
    };
    View.prototype[style_properties_1.androidElevationProperty.setNative] = function (value) {
        if (sdkVersion() < 21) {
            return;
        }
        this.refreshStateListAnimator();
    };
    View.prototype[style_properties_1.androidDynamicElevationOffsetProperty.getDefault] = function () {
        return this.getDefaultDynamicElevationOffset();
    };
    View.prototype[style_properties_1.androidDynamicElevationOffsetProperty.setNative] = function (value) {
        if (sdkVersion() < 21) {
            return;
        }
        this.refreshStateListAnimator();
    };
    View.prototype.getDefaultElevation = function () {
        if (sdkVersion() < 21) {
            return 0;
        }
        return view_common_1.layout.toDeviceIndependentPixels(this.nativeViewProtected.getElevation());
    };
    View.prototype.getDefaultDynamicElevationOffset = function () {
        return 0;
    };
    View.prototype.refreshStateListAnimator = function () {
        var nativeView = this.nativeViewProtected;
        var ObjectAnimator = android.animation.ObjectAnimator;
        var AnimatorSet = android.animation.AnimatorSet;
        var duration = nativeView.getContext().getResources().getInteger(shortAnimTime) / 2;
        var elevation = this.androidElevation;
        if (typeof elevation === "undefined" || elevation === null) {
            elevation = this.getDefaultElevation();
        }
        elevation = view_common_1.layout.toDevicePixels(elevation);
        var z = view_common_1.layout.toDevicePixels(0);
        var pressedZ = this.androidDynamicElevationOffset;
        if (typeof pressedZ === "undefined" || pressedZ === null) {
            pressedZ = this.getDefaultDynamicElevationOffset();
        }
        pressedZ = view_common_1.layout.toDevicePixels(pressedZ);
        var pressedSet = new AnimatorSet();
        pressedSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [pressedZ])
                .setDuration(duration),
            ObjectAnimator.ofFloat(nativeView, "elevation", [elevation])
                .setDuration(0),
        ]));
        var notPressedSet = new AnimatorSet();
        notPressedSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [z])
                .setDuration(duration),
            ObjectAnimator.ofFloat(nativeView, "elevation", [elevation])
                .setDuration(0),
        ]));
        var defaultSet = new AnimatorSet();
        defaultSet.playTogether(java.util.Arrays.asList([
            ObjectAnimator.ofFloat(nativeView, "translationZ", [0]).setDuration(0),
            ObjectAnimator.ofFloat(nativeView, "elevation", [0]).setDuration(0),
        ]));
        var stateListAnimator = new android.animation.StateListAnimator();
        stateListAnimator.addState([statePressed, stateEnabled], pressedSet);
        stateListAnimator.addState([stateEnabled], notPressedSet);
        stateListAnimator.addState([], defaultSet);
        nativeView.setStateListAnimator(stateListAnimator);
    };
    View.prototype[style_properties_1.horizontalAlignmentProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getHorizontalAlignment(this.nativeViewProtected);
    };
    View.prototype[style_properties_1.horizontalAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp.gravity !== undefined) {
            switch (value) {
                case "left":
                    lp.gravity = android.view.Gravity.LEFT | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "center":
                    lp.gravity = android.view.Gravity.CENTER_HORIZONTAL | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "right":
                    lp.gravity = android.view.Gravity.RIGHT | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -2;
                    }
                    break;
                case "stretch":
                    lp.gravity = android.view.Gravity.FILL_HORIZONTAL | (lp.gravity & android.view.Gravity.VERTICAL_GRAVITY_MASK);
                    if (lp.weight < 0) {
                        lp.weight = -1;
                    }
                    break;
            }
            nativeView.setLayoutParams(lp);
        }
    };
    View.prototype[style_properties_1.verticalAlignmentProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getVerticalAlignment(this.nativeViewProtected);
    };
    View.prototype[style_properties_1.verticalAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp.gravity !== undefined) {
            switch (value) {
                case "top":
                    lp.gravity = android.view.Gravity.TOP | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "middle":
                    lp.gravity = android.view.Gravity.CENTER_VERTICAL | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "bottom":
                    lp.gravity = android.view.Gravity.BOTTOM | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -2;
                    }
                    break;
                case "stretch":
                    lp.gravity = android.view.Gravity.FILL_VERTICAL | (lp.gravity & android.view.Gravity.HORIZONTAL_GRAVITY_MASK);
                    if (lp.height < 0) {
                        lp.height = -1;
                    }
                    break;
            }
            nativeView.setLayoutParams(lp);
        }
    };
    View.prototype[style_properties_1.rotateProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setRotate(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.scaleXProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setScaleX(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.scaleYProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setScaleY(this.nativeViewProtected, float(value));
    };
    View.prototype[style_properties_1.translateXProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setTranslateX(this.nativeViewProtected, view_common_1.layout.toDevicePixels(value));
    };
    View.prototype[style_properties_1.translateYProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setTranslateY(this.nativeViewProtected, view_common_1.layout.toDevicePixels(value));
    };
    View.prototype[style_properties_1.zIndexProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.zIndexProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setZIndex(this.nativeViewProtected, value);
    };
    View.prototype[style_properties_1.backgroundInternalProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        var drawable = nativeView.getBackground();
        if (drawable) {
            var constantState = drawable.getConstantState();
            if (constantState) {
                try {
                    return constantState.newDrawable(nativeView.getResources());
                }
                catch (e) {
                    return drawable;
                }
            }
            else {
                return drawable;
            }
        }
        return null;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.setNative] = function (value) {
        this._redrawNativeBackground(value);
    };
    View.prototype[style_properties_1.minWidthProperty.setNative] = function (value) {
        if (this.parent instanceof CustomLayoutView && this.parent.nativeViewProtected) {
            this.parent._setChildMinWidthNative(this);
        }
        else {
            this._setMinWidthNative(this.minWidth);
        }
    };
    View.prototype[style_properties_1.minHeightProperty.setNative] = function (value) {
        if (this.parent instanceof CustomLayoutView && this.parent.nativeViewProtected) {
            this.parent._setChildMinHeightNative(this);
        }
        else {
            this._setMinHeightNative(this.minHeight);
        }
    };
    View.prototype._redrawNativeBackground = function (value) {
        if (value instanceof background_1.Background) {
            background_1.ad.onBackgroundOrBorderPropertyChanged(this);
        }
        else {
            var nativeView = this.nativeViewProtected;
            nativeView.setBackground(value);
            var style = this.style;
            var paddingTop = view_common_1.paddingTopProperty.isSet(style) ? this.effectivePaddingTop : this._defaultPaddingTop;
            var paddingRight = view_common_1.paddingRightProperty.isSet(style) ? this.effectivePaddingRight : this._defaultPaddingRight;
            var paddingBottom = view_common_1.paddingBottomProperty.isSet(style) ? this.effectivePaddingBottom : this._defaultPaddingBottom;
            var paddingLeft = view_common_1.paddingLeftProperty.isSet(style) ? this.effectivePaddingLeft : this._defaultPaddingLeft;
            if (this._isPaddingRelative) {
                nativeView.setPaddingRelative(paddingLeft, paddingTop, paddingRight, paddingBottom);
            }
            else {
                nativeView.setPadding(paddingLeft, paddingTop, paddingRight, paddingBottom);
            }
            nativeView.background = undefined;
        }
    };
    View.androidBackPressedEvent = androidBackPressedEvent;
    __decorate([
        profiling_1.profile
    ], View.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "requestLayout", null);
    return View;
}(view_common_1.ViewCommon));
exports.View = View;
var ContainerView = (function (_super) {
    __extends(ContainerView, _super);
    function ContainerView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ContainerView;
}(View));
exports.ContainerView = ContainerView;
var CustomLayoutView = (function (_super) {
    __extends(CustomLayoutView, _super);
    function CustomLayoutView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CustomLayoutView.prototype.createNativeView = function () {
        return new org.nativescript.widgets.ContentLayout(this._context);
    };
    CustomLayoutView.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (atIndex === void 0) { atIndex = Number.MAX_SAFE_INTEGER; }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + ".nativeView.addView(" + child + ".nativeView, " + atIndex + ")", view_common_1.traceCategories.VisualTreeEvents);
            }
            this.nativeViewProtected.addView(child.nativeViewProtected, atIndex);
            if (child instanceof View) {
                this._updateNativeLayoutParams(child);
            }
            return true;
        }
        return false;
    };
    CustomLayoutView.prototype._updateNativeLayoutParams = function (child) {
        this._setChildMinWidthNative(child);
        this._setChildMinHeightNative(child);
    };
    CustomLayoutView.prototype._setChildMinWidthNative = function (child) {
        child._setMinWidthNative(child.minWidth);
    };
    CustomLayoutView.prototype._setChildMinHeightNative = function (child) {
        child._setMinHeightNative(child.minHeight);
    };
    CustomLayoutView.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        var nativeView = this.nativeViewProtected;
        var childView = child.nativeViewProtected;
        if (nativeView && childView) {
            nativeView.removeView(childView);
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(nativeView + ".removeView(" + childView + ")", view_common_1.traceCategories.VisualTreeEvents);
                view_common_1.traceNotifyEvent(child, "childInLayoutRemovedFromNativeVisualTree");
            }
        }
    };
    return CustomLayoutView;
}(ContainerView));
exports.CustomLayoutView = CustomLayoutView;
var percentNotSupported = function (view, value) { throw new Error("PercentLength is not supported."); };
function createNativePercentLengthProperty(options) {
    var getter = options.getter, setter = options.setter, _a = options.auto, auto = _a === void 0 ? 0 : _a;
    var setPixels, getPixels, setPercent;
    if (getter) {
        View.prototype[getter] = function () {
            if (options) {
                setPixels = options.setPixels;
                getPixels = options.getPixels;
                setPercent = options.setPercent || percentNotSupported;
                options = null;
            }
            var value = getPixels(this.nativeViewProtected);
            if (value == auto) {
                return "auto";
            }
            else {
                return { value: value, unit: "px" };
            }
        };
    }
    if (setter) {
        View.prototype[setter] = function (length) {
            if (options) {
                setPixels = options.setPixels;
                getPixels = options.getPixels;
                setPercent = options.setPercent || percentNotSupported;
                options = null;
            }
            if (length == "auto") {
                setPixels(this.nativeViewProtected, auto);
            }
            else if (typeof length === "number") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(view_common_1.layout.toDevicePixels(length)));
            }
            else if (length.unit == "dip") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(view_common_1.layout.toDevicePixels(length.value)));
            }
            else if (length.unit == "px") {
                setPixels(this.nativeViewProtected, view_common_1.layout.round(length.value));
            }
            else if (length.unit == "%") {
                setPercent(this.nativeViewProtected, length.value);
            }
            else {
                throw new Error("Unsupported PercentLength " + length);
            }
        };
    }
}
createNativePercentLengthProperty({
    setter: style_properties_1.marginTopProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginTop; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginTopPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginRightProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginRight; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginRightPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginBottomProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginBottom; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginBottomPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.marginLeftProperty.setNative,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMarginLeft; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setMarginLeftPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.widthProperty.setNative,
    auto: -1,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setWidth; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setWidthPercent; }
});
createNativePercentLengthProperty({
    setter: style_properties_1.heightProperty.setNative,
    auto: -1,
    get setPixels() { return org.nativescript.widgets.ViewHelper.setHeight; },
    get setPercent() { return org.nativescript.widgets.ViewHelper.setHeightPercent; }
});
createNativePercentLengthProperty({
    setter: "_setMinWidthNative",
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMinWidth; }
});
createNativePercentLengthProperty({
    setter: "_setMinHeightNative",
    get setPixels() { return org.nativescript.widgets.ViewHelper.setMinHeight; }
});
//# sourceMappingURL=view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var handlersForEventName = new Map();
var sourcesMap = new WeakMap();
var TargetHandlerPair = (function () {
    function TargetHandlerPair(target, handler) {
        this.tagetRef = new WeakRef(target);
        this.handler = handler;
    }
    return TargetHandlerPair;
}());
function getHandlerForEventName(eventName) {
    var handler = handlersForEventName.get(eventName);
    if (!handler) {
        handler = function (eventData) {
            var source = eventData.object;
            var sourceEventMap = sourcesMap.get(source);
            if (!sourceEventMap) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                return;
            }
            var targetHandlerPairList = sourceEventMap.get(eventName);
            if (!targetHandlerPairList) {
                return;
            }
            var deadPairsIndexes = [];
            var pair;
            var target;
            for (var i = 0; i < targetHandlerPairList.length; i++) {
                pair = targetHandlerPairList[i];
                target = pair.tagetRef.get();
                if (target) {
                    pair.handler.call(target, eventData);
                }
                else {
                    deadPairsIndexes.push(i);
                }
            }
            if (deadPairsIndexes.length === targetHandlerPairList.length) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                sourceEventMap.delete(eventName);
            }
            else {
                for (var j = deadPairsIndexes.length - 1; j >= 0; j--) {
                    targetHandlerPairList.splice(deadPairsIndexes[j], 1);
                }
            }
        };
        handlersForEventName.set(eventName, handler);
    }
    return handler;
}
function validateArgs(source, eventName, handler, target) {
    if (!source) {
        throw new Error("source is null or undefined");
    }
    if (!target) {
        throw new Error("target is null or undefined");
    }
    if (typeof eventName !== "string") {
        throw new Error("eventName is not a string");
    }
    if (typeof handler !== "function") {
        throw new Error("handler is not a function");
    }
}
function addWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var shouldAttach = false;
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        sourceEventMap = new Map();
        sourcesMap.set(source, sourceEventMap);
        shouldAttach = true;
    }
    var pairList = sourceEventMap.get(eventName);
    if (!pairList) {
        pairList = new Array();
        sourceEventMap.set(eventName, pairList);
        shouldAttach = true;
    }
    pairList.push(new TargetHandlerPair(target, handler));
    if (shouldAttach) {
        source.addEventListener(eventName, getHandlerForEventName(eventName));
    }
}
exports.addWeakEventListener = addWeakEventListener;
function removeWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var handlerForEventWithName = handlersForEventName.get(eventName);
    if (!handlerForEventWithName) {
        return;
    }
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        return;
    }
    var targetHandlerPairList = sourceEventMap.get(eventName);
    if (!targetHandlerPairList) {
        return;
    }
    var targetHandlerPairsToRemove = [];
    var pair;
    var registeredTarget;
    for (var i = 0; i < targetHandlerPairList.length; i++) {
        pair = targetHandlerPairList[i];
        registeredTarget = pair.tagetRef.get();
        if (!registeredTarget || (registeredTarget === target && handler === pair.handler)) {
            targetHandlerPairsToRemove.push(i);
        }
    }
    if (targetHandlerPairsToRemove.length === targetHandlerPairList.length) {
        source.removeEventListener(eventName, handlerForEventWithName);
        sourceEventMap.delete(eventName);
    }
    else {
        for (var j = targetHandlerPairsToRemove.length - 1; j >= 0; j--) {
            targetHandlerPairList.splice(targetHandlerPairsToRemove[j], 1);
        }
    }
}
exports.removeWeakEventListener = removeWeakEventListener;
//# sourceMappingURL=weak-event-listener.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var defaultDate = new Date();
var dateComparer = function (x, y) { return (x <= y && x >= y); };
var DatePickerBase = (function (_super) {
    __extends(DatePickerBase, _super);
    function DatePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePickerBase = __decorate([
        view_1.CSSType("DatePicker")
    ], DatePickerBase);
    return DatePickerBase;
}(view_1.View));
exports.DatePickerBase = DatePickerBase;
DatePickerBase.prototype.recycleNativeView = "auto";
exports.yearProperty = new view_1.Property({
    name: "year",
    defaultValue: defaultDate.getFullYear(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.yearProperty.register(DatePickerBase);
exports.monthProperty = new view_1.Property({
    name: "month",
    defaultValue: defaultDate.getMonth() + 1,
    valueConverter: function (v) { return parseInt(v); },
});
exports.monthProperty.register(DatePickerBase);
exports.dayProperty = new view_1.Property({
    name: "day",
    defaultValue: defaultDate.getDate(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.dayProperty.register(DatePickerBase);
exports.maxDateProperty = new view_1.Property({
    name: "maxDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.maxDateProperty.register(DatePickerBase);
exports.minDateProperty = new view_1.Property({
    name: "minDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.minDateProperty.register(DatePickerBase);
exports.dateProperty = new view_1.Property({
    name: "date",
    defaultValue: defaultDate,
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.dateProperty.register(DatePickerBase);
//# sourceMappingURL=date-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var date_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js"));
var DateChangedListener;
function initializeDateChangedListener() {
    if (DateChangedListener) {
        return;
    }
    var DateChangedListenerImpl = (function (_super) {
        __extends(DateChangedListenerImpl, _super);
        function DateChangedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        DateChangedListenerImpl.prototype.onDateChanged = function (picker, year, month, day) {
            var owner = this.owner;
            var dateChanged = false;
            if (year !== owner.year) {
                date_picker_common_1.yearProperty.nativeValueChange(owner, year);
                dateChanged = true;
            }
            if (month !== (owner.month - 1)) {
                date_picker_common_1.monthProperty.nativeValueChange(owner, month + 1);
                dateChanged = true;
            }
            if (day !== owner.day) {
                date_picker_common_1.dayProperty.nativeValueChange(owner, day);
                dateChanged = true;
            }
            if (dateChanged) {
                date_picker_common_1.dateProperty.nativeValueChange(owner, new Date(year, month, day));
            }
        };
        DateChangedListenerImpl = __decorate([
            Interfaces([android.widget.DatePicker.OnDateChangedListener])
        ], DateChangedListenerImpl);
        return DateChangedListenerImpl;
    }(java.lang.Object));
    DateChangedListener = DateChangedListenerImpl;
}
var DatePicker = (function (_super) {
    __extends(DatePicker, _super);
    function DatePicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePicker.prototype.createNativeView = function () {
        var picker = new android.widget.DatePicker(this._context);
        picker.setCalendarViewShown(false);
        return picker;
    };
    DatePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeDateChangedListener();
        var nativeView = this.nativeViewProtected;
        var listener = new DateChangedListener(this);
        nativeView.init(this.year, this.month - 1, this.day, listener);
        nativeView.listener = listener;
    };
    DatePicker.prototype.disposeNativeView = function () {
        this.nativeViewProtected.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    DatePicker.prototype.updateNativeDate = function () {
        var nativeView = this.nativeViewProtected;
        var year = typeof this.year === "number" ? this.year : nativeView.getYear();
        var month = typeof this.month === "number" ? this.month - 1 : nativeView.getMonth();
        var day = typeof this.day === "number" ? this.day : nativeView.getDayOfMonth();
        this.date = new Date(year, month, day);
    };
    DatePicker.prototype[date_picker_common_1.yearProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getYear() !== value) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.monthProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getMonth() !== (value - 1)) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.dayProperty.setNative] = function (value) {
        if (this.nativeViewProtected.getDayOfMonth() !== value) {
            this.updateNativeDate();
        }
    };
    DatePicker.prototype[date_picker_common_1.dateProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (nativeView.getDayOfMonth() !== value.getDate()
            || nativeView.getMonth() !== value.getMonth()
            || nativeView.getYear() !== value.getFullYear()) {
            nativeView.updateDate(value.getFullYear(), value.getMonth(), value.getDate());
        }
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.getDefault] = function () {
        return this.nativeViewProtected.getMaxDate();
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.setNative] = function (value) {
        var newValue = value instanceof Date ? value.getTime() : value;
        this.nativeViewProtected.setMaxDate(newValue);
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.getDefault] = function () {
        return this.nativeViewProtected.getMinDate();
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.setNative] = function (value) {
        var newValue = value instanceof Date ? value.getTime() : value;
        this.nativeViewProtected.setMinDate(newValue);
    };
    return DatePicker;
}(date_picker_common_1.DatePickerBase));
exports.DatePicker = DatePicker;
//# sourceMappingURL=date-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
exports.STRING = "string";
exports.PROMPT = "Prompt";
exports.CONFIRM = "Confirm";
exports.ALERT = "Alert";
exports.LOGIN = "Login";
exports.OK = "OK";
exports.CANCEL = "Cancel";
var inputType;
(function (inputType) {
    inputType.text = "text";
    inputType.password = "password";
    inputType.email = "email";
    inputType.number = "number";
    inputType.decimal = "decimal";
    inputType.phone = "phone";
})(inputType = exports.inputType || (exports.inputType = {}));
var capitalizationType;
(function (capitalizationType) {
    capitalizationType.none = "none";
    capitalizationType.all = "all";
    capitalizationType.sentences = "sentences";
    capitalizationType.words = "words";
})(capitalizationType = exports.capitalizationType || (exports.capitalizationType = {}));
var frame;
function getCurrentPage() {
    if (!frame) {
        frame = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
    }
    var topmostFrame = frame.topmost();
    if (topmostFrame) {
        return topmostFrame.currentPage;
    }
    return undefined;
}
exports.getCurrentPage = getCurrentPage;
function applySelectors(view, callback) {
    var currentPage = getCurrentPage();
    if (currentPage) {
        var styleScope = currentPage._styleScope;
        if (styleScope) {
            view._inheritStyleScope(styleScope);
            view.onLoaded();
            callback(view);
            view.onUnloaded();
        }
    }
}
var button;
var label;
var textField;
function getButtonColors() {
    if (!button) {
        var Button = __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js").Button;
        button = new Button;
        if (platform_1.isIOS) {
            button._setupUI({});
        }
    }
    var buttonColor;
    var buttonBackgroundColor;
    applySelectors(button, function (btn) {
        buttonColor = btn.color;
        buttonBackgroundColor = btn.backgroundColor;
    });
    return { color: buttonColor, backgroundColor: buttonBackgroundColor };
}
exports.getButtonColors = getButtonColors;
function getLabelColor() {
    if (!label) {
        var Label = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js").Label;
        label = new Label;
        if (platform_1.isIOS) {
            label._setupUI({});
        }
    }
    var labelColor;
    applySelectors(label, function (lbl) {
        labelColor = lbl.color;
    });
    return labelColor;
}
exports.getLabelColor = getLabelColor;
function getTextFieldColor() {
    if (!textField) {
        var TextField = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js").TextField;
        textField = new TextField();
        if (platform_1.isIOS) {
            textField._setupUI({});
        }
    }
    var textFieldColor;
    applySelectors(textField, function (tf) {
        textFieldColor = tf.color;
    });
    return textFieldColor;
}
exports.getTextFieldColor = getTextFieldColor;
function isDialogOptions(arg) {
    return arg && (arg.message || arg.title);
}
exports.isDialogOptions = isDialogOptions;
function parseLoginOptions(args) {
    if (args.length === 1 && types_1.isObject(args[0])) {
        return args[0];
    }
    var options = { title: exports.LOGIN, okButtonText: exports.OK, cancelButtonText: exports.CANCEL };
    if (types_1.isString(args[0])) {
        options.message = args[0];
    }
    if (types_1.isString(args[1])) {
        options.userNameHint = args[1];
    }
    if (types_1.isString(args[2])) {
        options.passwordHint = args[2];
    }
    if (types_1.isString(args[3])) {
        options.userName = args[3];
    }
    if (types_1.isString(args[4])) {
        options.password = args[4];
    }
    return options;
}
exports.parseLoginOptions = parseLoginOptions;
//# sourceMappingURL=dialogs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var dialogs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js"));
function isString(value) {
    return typeof value === "string";
}
function createAlertDialog(options) {
    var alert = new android.app.AlertDialog.Builder(application_1.android.foregroundActivity);
    alert.setTitle(options && isString(options.title) ? options.title : "");
    alert.setMessage(options && isString(options.message) ? options.message : "");
    if (options && options.cancelable === false) {
        alert.setCancelable(false);
    }
    return alert;
}
function showDialog(builder) {
    var dlg = builder.show();
    var labelColor = dialogs_common_1.getLabelColor();
    if (labelColor) {
        var textViewId = dlg.getContext().getResources().getIdentifier("android:id/alertTitle", null, null);
        if (textViewId) {
            var tv = dlg.findViewById(textViewId);
            if (tv) {
                tv.setTextColor(labelColor.android);
            }
        }
        var messageTextViewId = dlg.getContext().getResources().getIdentifier("android:id/message", null, null);
        if (messageTextViewId) {
            var messageTextView = dlg.findViewById(messageTextViewId);
            if (messageTextView) {
                messageTextView.setTextColor(labelColor.android);
            }
        }
    }
    var _a = dialogs_common_1.getButtonColors(), color = _a.color, backgroundColor = _a.backgroundColor;
    if (color) {
        var buttons = [];
        for (var i = 0; i < 3; i++) {
            var id = dlg.getContext().getResources().getIdentifier("android:id/button" + i, null, null);
            buttons[i] = dlg.findViewById(id);
        }
        buttons.forEach(function (button) {
            if (button) {
                if (color) {
                    button.setTextColor(color.android);
                }
                if (backgroundColor) {
                    button.setBackgroundColor(backgroundColor.android);
                }
            }
        });
    }
}
function addButtonsToAlertDialog(alert, options, callback) {
    if (!options) {
        return;
    }
    if (options.okButtonText) {
        alert.setPositiveButton(options.okButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(true);
            }
        }));
    }
    if (options.cancelButtonText) {
        alert.setNegativeButton(options.cancelButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(false);
            }
        }));
    }
    if (options.neutralButtonText) {
        alert.setNeutralButton(options.neutralButtonText, new android.content.DialogInterface.OnClickListener({
            onClick: function (dialog, id) {
                dialog.cancel();
                callback(undefined);
            }
        }));
    }
    alert.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
        onDismiss: function () {
            callback(false);
        }
    }));
}
function alert(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.ALERT, okButtonText: dialogs_common_1.OK, message: arg + "" } : arg;
            var alert_1 = createAlertDialog(options);
            alert_1.setPositiveButton(options.okButtonText, new android.content.DialogInterface.OnClickListener({
                onClick: function (dialog, id) {
                    dialog.cancel();
                    resolve();
                }
            }));
            alert_1.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
                onDismiss: function () {
                    resolve();
                }
            }));
            showDialog(alert_1);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.alert = alert;
function confirm(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.CONFIRM, okButtonText: dialogs_common_1.OK, cancelButtonText: dialogs_common_1.CANCEL, message: arg + "" } : arg;
            var alert_2 = createAlertDialog(options);
            addButtonsToAlertDialog(alert_2, options, function (result) { resolve(result); });
            showDialog(alert_2);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.confirm = confirm;
function prompt(arg) {
    var options;
    var defaultOptions = {
        title: dialogs_common_1.PROMPT,
        okButtonText: dialogs_common_1.OK,
        cancelButtonText: dialogs_common_1.CANCEL,
        inputType: dialogs_common_1.inputType.text,
    };
    if (arguments.length === 1) {
        if (isString(arg)) {
            options = defaultOptions;
            options.message = arg;
        }
        else {
            options = arg;
        }
    }
    else if (arguments.length === 2) {
        if (isString(arguments[0]) && isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.defaultText = arguments[1];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var alert_3 = createAlertDialog(options);
            var input_1 = new android.widget.EditText(application_1.android.foregroundActivity);
            if (options) {
                if (options.inputType === dialogs_common_1.inputType.password) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD);
                }
                else if (options.inputType === dialogs_common_1.inputType.email) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS);
                }
                else if (options.inputType === dialogs_common_1.inputType.number) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_NUMBER);
                }
                else if (options.inputType === dialogs_common_1.inputType.decimal) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL);
                }
                else if (options.inputType === dialogs_common_1.inputType.phone) {
                    input_1.setInputType(android.text.InputType.TYPE_CLASS_PHONE);
                }
                switch (options.capitalizationType) {
                    case dialogs_common_1.capitalizationType.all: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS);
                        break;
                    }
                    case dialogs_common_1.capitalizationType.sentences: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES);
                        break;
                    }
                    case dialogs_common_1.capitalizationType.words: {
                        input_1.setInputType(input_1.getInputType() | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS);
                        break;
                    }
                }
            }
            input_1.setText(options && options.defaultText || "");
            alert_3.setView(input_1);
            var getText_1 = function () { return input_1.getText().toString(); };
            addButtonsToAlertDialog(alert_3, options, function (r) { resolve({ result: r, text: getText_1() }); });
            showDialog(alert_3);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.prompt = prompt;
function login() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var options = dialogs_common_1.parseLoginOptions(args);
    return new Promise(function (resolve, reject) {
        try {
            var context_1 = application_1.android.foregroundActivity;
            var alert_4 = createAlertDialog(options);
            var userNameInput_1 = new android.widget.EditText(context_1);
            userNameInput_1.setHint(options.userNameHint ? options.userNameHint : "");
            userNameInput_1.setText(options.userName ? options.userName : "");
            var passwordInput_1 = new android.widget.EditText(context_1);
            passwordInput_1.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD);
            passwordInput_1.setTypeface(android.graphics.Typeface.DEFAULT);
            passwordInput_1.setHint(options.passwordHint ? options.passwordHint : "");
            passwordInput_1.setText(options.password ? options.password : "");
            var layout = new android.widget.LinearLayout(context_1);
            layout.setOrientation(1);
            layout.addView(userNameInput_1);
            layout.addView(passwordInput_1);
            alert_4.setView(layout);
            addButtonsToAlertDialog(alert_4, options, function (r) {
                resolve({
                    result: r,
                    userName: userNameInput_1.getText().toString(),
                    password: passwordInput_1.getText().toString()
                });
            });
            showDialog(alert_4);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.login = login;
function action(arg) {
    var options;
    var defaultOptions = { title: null, cancelButtonText: dialogs_common_1.CANCEL };
    if (arguments.length === 1) {
        if (isString(arguments[0])) {
            options = defaultOptions;
            options.message = arguments[0];
        }
        else {
            options = arguments[0];
        }
    }
    else if (arguments.length === 2) {
        if (isString(arguments[0]) && isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
        }
    }
    else if (arguments.length === 3) {
        if (isString(arguments[0]) && isString(arguments[1]) && typeof arguments[2] !== "undefined") {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
            options.actions = arguments[2];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var activity = application_1.android.foregroundActivity || application_1.android.startActivity;
            var alert_5 = new android.app.AlertDialog.Builder(activity);
            var message = options && isString(options.message) ? options.message : "";
            var title = options && isString(options.title) ? options.title : "";
            if (options && options.cancelable === false) {
                alert_5.setCancelable(false);
            }
            if (title) {
                alert_5.setTitle(title);
                if (!options.actions) {
                    alert_5.setMessage(message);
                }
            }
            else {
                alert_5.setTitle(message);
            }
            if (options.actions) {
                alert_5.setItems(options.actions, new android.content.DialogInterface.OnClickListener({
                    onClick: function (dialog, which) {
                        resolve(options.actions[which]);
                    }
                }));
            }
            if (isString(options.cancelButtonText)) {
                alert_5.setNegativeButton(options.cancelButtonText, new android.content.DialogInterface.OnClickListener({
                    onClick: function (dialog, id) {
                        dialog.cancel();
                        resolve(options.cancelButtonText);
                    }
                }));
            }
            alert_5.setOnDismissListener(new android.content.DialogInterface.OnDismissListener({
                onDismiss: function () {
                    if (isString(options.cancelButtonText)) {
                        resolve(options.cancelButtonText);
                    }
                    else {
                        resolve("");
                    }
                }
            }));
            showDialog(alert_5);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.action = action;
//# sourceMappingURL=dialogs.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._focusHandler = function () { return _this._goToVisualState("focus"); };
        _this._blurHandler = function () { return _this._goToVisualState("blur"); };
        return _this;
    }
    EditableTextBase.prototype._updateTextBaseFocusStateHandler = function (subscribe) {
        var method = subscribe ? "on" : "off";
        this[method]("focus", this._focusHandler);
        this[method]("blur", this._blurHandler);
    };
    EditableTextBase.blurEvent = "blur";
    EditableTextBase.focusEvent = "focus";
    EditableTextBase.textChangeEvent = "textChange";
    __decorate([
        text_base_1.PseudoClassHandler("focus", "blur")
    ], EditableTextBase.prototype, "_updateTextBaseFocusStateHandler", null);
    return EditableTextBase;
}(text_base_1.TextBase));
exports.EditableTextBase = EditableTextBase;
exports.placeholderColorProperty = new text_base_1.CssProperty({ name: "placeholderColor", cssName: "placeholder-color", equalityComparer: text_base_1.Color.equals, valueConverter: function (v) { return new text_base_1.Color(v); } });
exports.placeholderColorProperty.register(text_base_1.Style);
var keyboardTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("datetime", "phone", "number", "url", "email"));
exports.keyboardTypeProperty = new text_base_1.Property({ name: "keyboardType", valueConverter: keyboardTypeConverter });
exports.keyboardTypeProperty.register(EditableTextBase);
var returnKeyTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("done", "next", "go", "search", "send"));
exports.returnKeyTypeProperty = new text_base_1.Property({ name: "returnKeyType", valueConverter: returnKeyTypeConverter });
exports.returnKeyTypeProperty.register(EditableTextBase);
exports.editableProperty = new text_base_1.Property({ name: "editable", defaultValue: true, valueConverter: text_base_1.booleanConverter });
exports.editableProperty.register(EditableTextBase);
exports.updateTextTriggerProperty = new text_base_1.Property({ name: "updateTextTrigger", defaultValue: "textChanged" });
exports.updateTextTriggerProperty.register(EditableTextBase);
var autocapitalizationTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("none", "words", "sentences", "allcharacters"));
exports.autocapitalizationTypeProperty = new text_base_1.Property({ name: "autocapitalizationType", defaultValue: "sentences", valueConverter: autocapitalizationTypeConverter });
exports.autocapitalizationTypeProperty.register(EditableTextBase);
exports.autocorrectProperty = new text_base_1.Property({ name: "autocorrect", valueConverter: text_base_1.booleanConverter });
exports.autocorrectProperty.register(EditableTextBase);
exports.hintProperty = new text_base_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(EditableTextBase);
exports.maxLengthProperty = new text_base_1.Property({ name: "maxLength", defaultValue: Number.POSITIVE_INFINITY, valueConverter: parseInt });
exports.maxLengthProperty.register(EditableTextBase);
//# sourceMappingURL=editable-text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js"));
var EditTextListeners;
function clearDismissTimer() {
    exports.dismissKeyboardOwner = null;
    if (exports.dismissKeyboardTimeoutId) {
        clearTimeout(exports.dismissKeyboardTimeoutId);
        exports.dismissKeyboardTimeoutId = null;
    }
}
function dismissSoftInput(owner) {
    clearDismissTimer();
    if (!exports.dismissKeyboardTimeoutId) {
        exports.dismissKeyboardTimeoutId = setTimeout(function () {
            var owner = exports.dismissKeyboardOwner && exports.dismissKeyboardOwner.get();
            var activity = (owner && owner._context);
            var nativeView = owner && owner.nativeViewProtected;
            exports.dismissKeyboardTimeoutId = null;
            exports.dismissKeyboardOwner = null;
            var focused = activity && activity.getCurrentFocus();
            if (!focused || !(focused instanceof android.widget.EditText)) {
                utils_1.ad.dismissSoftInput(nativeView);
            }
        }, 10);
    }
}
function initializeEditTextListeners() {
    if (EditTextListeners) {
        return;
    }
    var EditTextListenersImpl = (function (_super) {
        __extends(EditTextListenersImpl, _super);
        function EditTextListenersImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        EditTextListenersImpl.prototype.beforeTextChanged = function (text, start, count, after) {
        };
        EditTextListenersImpl.prototype.onTextChanged = function (text, start, before, count) {
        };
        EditTextListenersImpl.prototype.afterTextChanged = function (editable) {
            var owner = this.owner;
            if (!owner || owner._changeFromCode) {
                return;
            }
            switch (owner.updateTextTrigger) {
                case "focusLost":
                    owner._dirtyTextAccumulator = editable.toString();
                    break;
                case "textChanged":
                    editable_text_base_common_1.textProperty.nativeValueChange(owner, editable.toString());
                    break;
                default:
                    throw new Error("Invalid updateTextTrigger: " + owner.updateTextTrigger);
            }
        };
        EditTextListenersImpl.prototype.onFocusChange = function (view, hasFocus) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            if (hasFocus) {
                clearDismissTimer();
                owner.notify({ eventName: EditableTextBase.focusEvent, object: owner });
            }
            else {
                if (owner._dirtyTextAccumulator || owner._dirtyTextAccumulator === "") {
                    editable_text_base_common_1.textProperty.nativeValueChange(owner, owner._dirtyTextAccumulator);
                    owner._dirtyTextAccumulator = undefined;
                }
                owner.notify({ eventName: EditableTextBase.blurEvent, object: owner });
                dismissSoftInput(owner);
            }
        };
        EditTextListenersImpl.prototype.onEditorAction = function (textView, actionId, event) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            if (actionId === android.view.inputmethod.EditorInfo.IME_ACTION_DONE ||
                actionId === android.view.inputmethod.EditorInfo.IME_ACTION_UNSPECIFIED ||
                (event && event.getKeyCode() === android.view.KeyEvent.KEYCODE_ENTER)) {
                if (textView.getMaxLines() === 1) {
                    owner.dismissSoftInput();
                }
                owner._onReturnPress();
            }
            else if (actionId === android.view.inputmethod.EditorInfo.IME_ACTION_NEXT ||
                actionId === android.view.inputmethod.EditorInfo.IME_ACTION_PREVIOUS) {
                owner._onReturnPress();
            }
            return false;
        };
        EditTextListenersImpl = __decorate([
            Interfaces([android.text.TextWatcher, android.view.View.OnFocusChangeListener, android.widget.TextView.OnEditorActionListener])
        ], EditTextListenersImpl);
        return EditTextListenersImpl;
    }(java.lang.Object));
    EditTextListeners = EditTextListenersImpl;
}
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EditableTextBase.prototype._onReturnPress = function () {
    };
    EditableTextBase.prototype.createNativeView = function () {
        return new android.widget.EditText(this._context);
    };
    EditableTextBase.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var editText = this.nativeTextViewProtected;
        this._configureEditText(editText);
        initializeEditTextListeners();
        var listeners = new EditTextListeners(this);
        editText.addTextChangedListener(listeners);
        editText.setOnFocusChangeListener(listeners);
        editText.setOnEditorActionListener(listeners);
        editText.listener = listeners;
        this._inputType = editText.getInputType();
    };
    EditableTextBase.prototype.disposeNativeView = function () {
        this.nativeTextViewProtected.listener.owner = null;
        this._keyListenerCache = null;
        _super.prototype.disposeNativeView.call(this);
    };
    EditableTextBase.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeTextViewProtected.setInputType(this._inputType);
    };
    EditableTextBase.prototype.onUnloaded = function () {
        this.dismissSoftInput();
        _super.prototype.onUnloaded.call(this);
    };
    EditableTextBase.prototype.dismissSoftInput = function () {
        var nativeView = this.nativeTextViewProtected;
        if (!nativeView) {
            return;
        }
        utils_1.ad.dismissSoftInput(nativeView);
    };
    EditableTextBase.prototype.focus = function () {
        var nativeView = this.nativeTextViewProtected;
        if (!nativeView) {
            return;
        }
        var result = _super.prototype.focus.call(this);
        if (result) {
            utils_1.ad.showSoftInput(this.nativeTextViewProtected);
        }
        return result;
    };
    EditableTextBase.prototype._setInputType = function (inputType) {
        var nativeView = this.nativeTextViewProtected;
        try {
            this._changeFromCode = true;
            nativeView.setInputType(inputType);
        }
        finally {
            this._changeFromCode = false;
        }
        var listener = nativeView.getKeyListener();
        if (listener) {
            this._keyListenerCache = listener;
        }
        if (!this.editable) {
            nativeView.setKeyListener(null);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.textProperty.getDefault] = function () {
        return editable_text_base_common_1.resetSymbol;
    };
    EditableTextBase.prototype[editable_text_base_common_1.textProperty.setNative] = function (value) {
        try {
            this._changeFromCode = true;
            this._setNativeText(value === editable_text_base_common_1.resetSymbol);
        }
        finally {
            this._changeFromCode = false;
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getInputType();
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.setNative] = function (value) {
        var newInputType;
        switch (value) {
            case "datetime":
                newInputType = android.text.InputType.TYPE_CLASS_DATETIME | android.text.InputType.TYPE_DATETIME_VARIATION_NORMAL;
                break;
            case "phone":
                newInputType = android.text.InputType.TYPE_CLASS_PHONE;
                break;
            case "number":
                newInputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_NORMAL | android.text.InputType.TYPE_NUMBER_FLAG_SIGNED | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL;
                break;
            case "url":
                newInputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_URI;
                break;
            case "email":
                newInputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS;
                break;
            default:
                newInputType = value;
                break;
        }
        this._setInputType(newInputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.getDefault] = function () {
        var ime = this.nativeTextViewProtected.getImeOptions();
        switch (ime) {
            case android.view.inputmethod.EditorInfo.IME_ACTION_DONE:
                return "done";
            case android.view.inputmethod.EditorInfo.IME_ACTION_GO:
                return "go";
            case android.view.inputmethod.EditorInfo.IME_ACTION_NEXT:
                return "next";
            case android.view.inputmethod.EditorInfo.IME_ACTION_SEARCH:
                return "search";
            case android.view.inputmethod.EditorInfo.IME_ACTION_SEND:
                return "send";
            default:
                return ime.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.setNative] = function (value) {
        var newImeOptions;
        switch (value) {
            case "done":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_DONE;
                break;
            case "go":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_GO;
                break;
            case "next":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_NEXT;
                break;
            case "search":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_SEARCH;
                break;
            case "send":
                newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_SEND;
                break;
            default:
                var ime = +value;
                if (!isNaN(ime)) {
                    newImeOptions = ime;
                }
                else {
                    newImeOptions = android.view.inputmethod.EditorInfo.IME_ACTION_UNSPECIFIED;
                }
                break;
        }
        this.nativeTextViewProtected.setImeOptions(newImeOptions);
    };
    EditableTextBase.prototype[editable_text_base_common_1.editableProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        if (value) {
            nativeView.setKeyListener(this._keyListenerCache);
        }
        else {
            if (!this._keyListenerCache) {
                this._keyListenerCache = nativeView.getKeyListener();
            }
            nativeView.setKeyListener(null);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.getDefault] = function () {
        var inputType = this.nativeTextViewProtected.getInputType();
        if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS) === android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS) {
            return "words";
        }
        else if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES) === android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES) {
            return "sentences";
        }
        else if ((inputType & android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS) === android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS) {
            return "allcharacters";
        }
        else {
            return inputType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.setNative] = function (value) {
        var inputType = this.nativeTextViewProtected.getInputType();
        inputType = inputType & ~28672;
        switch (value) {
            case "none":
                break;
            case "words":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS;
                break;
            case "sentences":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                break;
            case "allcharacters":
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS;
                break;
            default:
                var number = +value;
                if (!isNaN(number)) {
                    inputType = number;
                }
                else {
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                }
                break;
        }
        this._setInputType(inputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.getDefault] = function () {
        var autocorrect = this.nativeTextViewProtected.getInputType();
        if ((autocorrect & android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT) === android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT) {
            return true;
        }
        return false;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.setNative] = function (value) {
        var inputType = this.nativeTextViewProtected.getInputType();
        switch (value) {
            case true:
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
                break;
            case false:
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
                break;
            default:
                break;
        }
        this._setInputType(inputType);
    };
    EditableTextBase.prototype[editable_text_base_common_1.hintProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getHint();
    };
    EditableTextBase.prototype[editable_text_base_common_1.hintProperty.setNative] = function (value) {
        var text = (value === null || value === undefined) ? null : value.toString();
        this.nativeTextViewProtected.setHint(text);
    };
    EditableTextBase.prototype[editable_text_base_common_1.placeholderColorProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getHintTextColors();
    };
    EditableTextBase.prototype[editable_text_base_common_1.placeholderColorProperty.setNative] = function (value) {
        var color = value instanceof editable_text_base_common_1.Color ? value.android : value;
        this.nativeTextViewProtected.setHintTextColor(color);
    };
    EditableTextBase.prototype[editable_text_base_common_1.textTransformProperty.setNative] = function (value) {
    };
    EditableTextBase.prototype[editable_text_base_common_1.maxLengthProperty.setNative] = function (value) {
        if (value === Number.POSITIVE_INFINITY) {
            this.nativeTextViewProtected.setFilters([]);
        }
        else {
            var lengthFilter = new android.text.InputFilter.LengthFilter(value);
            var filters = this.nativeTextViewProtected.getFilters();
            var newFilters = [];
            for (var i = 0; i < filters.length; i++) {
                var filter = filters[i];
                if (!(filter instanceof android.text.InputFilter.LengthFilter)) {
                    newFilters.push(filter);
                }
            }
            newFilters.push(lengthFilter);
            this.nativeTextViewProtected.setFilters(newFilters);
        }
    };
    return EditableTextBase;
}(editable_text_base_common_1.EditableTextBase));
exports.EditableTextBase = EditableTextBase;
//# sourceMappingURL=editable-text-base.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/enums/enums.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var KeyboardType;
(function (KeyboardType) {
    KeyboardType.datetime = "datetime";
    KeyboardType.phone = "phone";
    KeyboardType.number = "number";
    KeyboardType.url = "url";
    KeyboardType.email = "email";
})(KeyboardType = exports.KeyboardType || (exports.KeyboardType = {}));
var ReturnKeyType;
(function (ReturnKeyType) {
    ReturnKeyType.done = "done";
    ReturnKeyType.next = "next";
    ReturnKeyType.go = "go";
    ReturnKeyType.search = "search";
    ReturnKeyType.send = "send";
})(ReturnKeyType = exports.ReturnKeyType || (exports.ReturnKeyType = {}));
var TextAlignment;
(function (TextAlignment) {
    TextAlignment.left = "left";
    TextAlignment.center = "center";
    TextAlignment.right = "right";
})(TextAlignment = exports.TextAlignment || (exports.TextAlignment = {}));
var TextDecoration;
(function (TextDecoration) {
    TextDecoration.none = "none";
    TextDecoration.underline = "underline";
    TextDecoration.lineThrough = "line-through";
})(TextDecoration = exports.TextDecoration || (exports.TextDecoration = {}));
var TextTransform;
(function (TextTransform) {
    TextTransform.none = "none";
    TextTransform.capitalize = "capitalize";
    TextTransform.uppercase = "uppercase";
    TextTransform.lowercase = "lowercase";
})(TextTransform = exports.TextTransform || (exports.TextTransform = {}));
var WhiteSpace;
(function (WhiteSpace) {
    WhiteSpace.normal = "normal";
    WhiteSpace.nowrap = "nowrap";
})(WhiteSpace = exports.WhiteSpace || (exports.WhiteSpace = {}));
var Orientation;
(function (Orientation) {
    Orientation.horizontal = "horizontal";
    Orientation.vertical = "vertical";
})(Orientation = exports.Orientation || (exports.Orientation = {}));
var DeviceOrientation;
(function (DeviceOrientation) {
    DeviceOrientation.portrait = "portrait";
    DeviceOrientation.landscape = "landscape";
    DeviceOrientation.unknown = "unknown";
})(DeviceOrientation = exports.DeviceOrientation || (exports.DeviceOrientation = {}));
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.left = "left";
    HorizontalAlignment.center = "center";
    HorizontalAlignment.right = "right";
    HorizontalAlignment.stretch = "stretch";
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.top = "top";
    VerticalAlignment.middle = "middle";
    VerticalAlignment.bottom = "bottom";
    VerticalAlignment.stretch = "stretch";
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
var Stretch;
(function (Stretch) {
    Stretch.none = "none";
    Stretch.aspectFill = "aspectFill";
    Stretch.aspectFit = "aspectFit";
    Stretch.fill = "fill";
})(Stretch = exports.Stretch || (exports.Stretch = {}));
var Visibility;
(function (Visibility) {
    Visibility.visible = "visible";
    Visibility.collapse = "collapse";
    Visibility.collapsed = "collapsed";
})(Visibility = exports.Visibility || (exports.Visibility = {}));
var FontAttributes;
(function (FontAttributes) {
    FontAttributes.Normal = 0;
    FontAttributes.Bold = 1;
    FontAttributes.Italic = 1 << 1;
})(FontAttributes = exports.FontAttributes || (exports.FontAttributes = {}));
var DeviceType;
(function (DeviceType) {
    DeviceType.Phone = "Phone";
    DeviceType.Tablet = "Tablet";
})(DeviceType = exports.DeviceType || (exports.DeviceType = {}));
var UpdateTextTrigger;
(function (UpdateTextTrigger) {
    UpdateTextTrigger.focusLost = "focusLost";
    UpdateTextTrigger.textChanged = "textChanged";
})(UpdateTextTrigger = exports.UpdateTextTrigger || (exports.UpdateTextTrigger = {}));
var Accuracy;
(function (Accuracy) {
    Accuracy.any = 300;
    Accuracy.high = 3;
})(Accuracy = exports.Accuracy || (exports.Accuracy = {}));
var Dock;
(function (Dock) {
    Dock.left = "left";
    Dock.top = "top";
    Dock.right = "right";
    Dock.bottom = "bottom";
})(Dock = exports.Dock || (exports.Dock = {}));
var AutocapitalizationType;
(function (AutocapitalizationType) {
    AutocapitalizationType.none = "none";
    AutocapitalizationType.words = "words";
    AutocapitalizationType.sentences = "sentences";
    AutocapitalizationType.allCharacters = "allcharacters";
})(AutocapitalizationType = exports.AutocapitalizationType || (exports.AutocapitalizationType = {}));
var NavigationBarVisibility;
(function (NavigationBarVisibility) {
    NavigationBarVisibility.auto = "auto";
    NavigationBarVisibility.never = "never";
    NavigationBarVisibility.always = "always";
})(NavigationBarVisibility = exports.NavigationBarVisibility || (exports.NavigationBarVisibility = {}));
var AndroidActionBarIconVisibility;
(function (AndroidActionBarIconVisibility) {
    AndroidActionBarIconVisibility.auto = "auto";
    AndroidActionBarIconVisibility.never = "never";
    AndroidActionBarIconVisibility.always = "always";
})(AndroidActionBarIconVisibility = exports.AndroidActionBarIconVisibility || (exports.AndroidActionBarIconVisibility = {}));
var AndroidActionItemPosition;
(function (AndroidActionItemPosition) {
    AndroidActionItemPosition.actionBar = "actionBar";
    AndroidActionItemPosition.actionBarIfRoom = "actionBarIfRoom";
    AndroidActionItemPosition.popup = "popup";
})(AndroidActionItemPosition = exports.AndroidActionItemPosition || (exports.AndroidActionItemPosition = {}));
var IOSActionItemPosition;
(function (IOSActionItemPosition) {
    IOSActionItemPosition.left = "left";
    IOSActionItemPosition.right = "right";
})(IOSActionItemPosition = exports.IOSActionItemPosition || (exports.IOSActionItemPosition = {}));
var ImageFormat;
(function (ImageFormat) {
    ImageFormat.png = "png";
    ImageFormat.jpeg = "jpeg";
    ImageFormat.jpg = "jpg";
})(ImageFormat = exports.ImageFormat || (exports.ImageFormat = {}));
var FontStyle;
(function (FontStyle) {
    FontStyle.normal = "normal";
    FontStyle.italic = "italic";
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.thin = "100";
    FontWeight.extraLight = "200";
    FontWeight.light = "300";
    FontWeight.normal = "normal";
    FontWeight.medium = "500";
    FontWeight.semiBold = "600";
    FontWeight.bold = "bold";
    FontWeight.extraBold = "800";
    FontWeight.black = "900";
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.repeat = "repeat";
    BackgroundRepeat.repeatX = "repeat-x";
    BackgroundRepeat.repeatY = "repeat-y";
    BackgroundRepeat.noRepeat = "no-repeat";
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
var animation;
var AnimationCurve;
(function (AnimationCurve) {
    AnimationCurve.ease = "ease";
    AnimationCurve.easeIn = "easeIn";
    AnimationCurve.easeOut = "easeOut";
    AnimationCurve.easeInOut = "easeInOut";
    AnimationCurve.linear = "linear";
    AnimationCurve.spring = "spring";
    function cubicBezier(x1, y1, x2, y2) {
        animation = animation || __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
        return new animation.CubicBezierAnimationCurve(x1, y1, x2, y2);
    }
    AnimationCurve.cubicBezier = cubicBezier;
})(AnimationCurve = exports.AnimationCurve || (exports.AnimationCurve = {}));
var StatusBarStyle;
(function (StatusBarStyle) {
    StatusBarStyle.light = "light";
    StatusBarStyle.dark = "dark";
})(StatusBarStyle = exports.StatusBarStyle || (exports.StatusBarStyle = {}));
//# sourceMappingURL=enums.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/activity.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var globals = __webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var appModule = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
if (global.__snapshot) {
    globals.install();
}
var NativeScriptActivity = (function (_super) {
    __extends(NativeScriptActivity, _super);
    function NativeScriptActivity() {
        var _this = _super.call(this) || this;
        return global.__native(_this);
    }
    NativeScriptActivity.prototype.onCreate = function (savedInstanceState) {
        appModule.android.init(this.getApplication());
        this.isNativeScriptActivity = true;
        if (!this._callbacks) {
            frame_1.setActivityCallbacks(this);
        }
        this._callbacks.onCreate(this, savedInstanceState, this.getIntent(), _super.prototype.onCreate);
    };
    NativeScriptActivity.prototype.onNewIntent = function (intent) {
        this._callbacks.onNewIntent(this, intent, _super.prototype.setIntent, _super.prototype.onNewIntent);
    };
    NativeScriptActivity.prototype.onSaveInstanceState = function (outState) {
        this._callbacks.onSaveInstanceState(this, outState, _super.prototype.onSaveInstanceState);
    };
    NativeScriptActivity.prototype.onStart = function () {
        this._callbacks.onStart(this, _super.prototype.onStart);
    };
    NativeScriptActivity.prototype.onStop = function () {
        this._callbacks.onStop(this, _super.prototype.onStop);
    };
    NativeScriptActivity.prototype.onDestroy = function () {
        this._callbacks.onDestroy(this, _super.prototype.onDestroy);
    };
    NativeScriptActivity.prototype.onPostResume = function () {
        this._callbacks.onPostResume(this, _super.prototype.onPostResume);
    };
    NativeScriptActivity.prototype.onBackPressed = function () {
        this._callbacks.onBackPressed(this, _super.prototype.onBackPressed);
    };
    NativeScriptActivity.prototype.onRequestPermissionsResult = function (requestCode, permissions, grantResults) {
        this._callbacks.onRequestPermissionsResult(this, requestCode, permissions, grantResults, undefined);
    };
    NativeScriptActivity.prototype.onActivityResult = function (requestCode, resultCode, data) {
        this._callbacks.onActivityResult(this, requestCode, resultCode, data, _super.prototype.onActivityResult);
    };
    NativeScriptActivity = __decorate([
        JavaProxy("com.tns.NativeScriptActivity")
    ], NativeScriptActivity);
    return NativeScriptActivity;
}(androidx.appcompat.app.AppCompatActivity));
//# sourceMappingURL=activity.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var FragmentClass = (function (_super) {
    __extends(FragmentClass, _super);
    function FragmentClass() {
        var _this = _super.call(this) || this;
        return global.__native(_this);
    }
    FragmentClass.prototype.onHiddenChanged = function (hidden) {
        this._callbacks.onHiddenChanged(this, hidden, _super.prototype.onHiddenChanged);
    };
    FragmentClass.prototype.onCreateAnimator = function (transit, enter, nextAnim) {
        return this._callbacks.onCreateAnimator(this, transit, enter, nextAnim, _super.prototype.onCreateAnimator);
    };
    FragmentClass.prototype.onStop = function () {
        this._callbacks.onStop(this, _super.prototype.onStop);
    };
    FragmentClass.prototype.onCreate = function (savedInstanceState) {
        if (!this._callbacks) {
            frame_1.setFragmentCallbacks(this);
        }
        this.setHasOptionsMenu(true);
        this._callbacks.onCreate(this, savedInstanceState, _super.prototype.onCreate);
    };
    FragmentClass.prototype.onCreateView = function (inflater, container, savedInstanceState) {
        var result = this._callbacks.onCreateView(this, inflater, container, savedInstanceState, _super.prototype.onCreateView);
        return result;
    };
    FragmentClass.prototype.onSaveInstanceState = function (outState) {
        this._callbacks.onSaveInstanceState(this, outState, _super.prototype.onSaveInstanceState);
    };
    FragmentClass.prototype.onDestroyView = function () {
        this._callbacks.onDestroyView(this, _super.prototype.onDestroyView);
    };
    FragmentClass.prototype.onDestroy = function () {
        this._callbacks.onDestroy(this, _super.prototype.onDestroy);
    };
    FragmentClass.prototype.toString = function () {
        var callbacks = this._callbacks;
        if (callbacks) {
            return callbacks.toStringOverride(this, _super.prototype.toString);
        }
        else {
            _super.prototype.toString.call(this);
        }
    };
    FragmentClass = __decorate([
        JavaProxy("com.tns.FragmentClass")
    ], FragmentClass);
    return FragmentClass;
}(org.nativescript.widgets.FragmentBase));
frame_1.setFragmentClass(FragmentClass);
//# sourceMappingURL=fragment.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.transitions.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var slide_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/slide-transition.js");
var fade_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/fade-transition.js");
var flip_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/flip-transition.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var intEvaluator = lazy_1.default(function () { return new android.animation.IntEvaluator(); });
var defaultInterpolator = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
exports.waitingQueue = new Map();
exports.completedEntries = new Map();
var TransitionListener;
var AnimationListener;
function _setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, fragmentTransaction, frameId) {
    var currentFragment = currentEntry ? currentEntry.fragment : null;
    var newFragment = newEntry.fragment;
    var entries = exports.waitingQueue.get(frameId);
    if (entries && entries.size > 0) {
        throw new Error("Calling navigation before previous navigation finish.");
    }
    if (sdkVersion() >= 21) {
        allowTransitionOverlap(currentFragment);
        allowTransitionOverlap(newFragment);
    }
    var name = "";
    var transition;
    if (navigationTransition) {
        transition = navigationTransition.instance;
        name = navigationTransition.name ? navigationTransition.name.toLowerCase() : "";
    }
    var useLollipopTransition = !!(name && (name.indexOf("slide") === 0 || name === "fade" || name === "explode") && sdkVersion() >= 21);
    if (currentFragment &&
        currentFragment.getChildFragmentManager() &&
        currentFragment.getChildFragmentManager().getFragments().toArray().length > 0) {
        useLollipopTransition = false;
    }
    newEntry.useLollipopTransition = useLollipopTransition;
    if (!animated) {
        name = "none";
    }
    else if (transition) {
        name = "custom";
        useLollipopTransition = false;
    }
    else if (!useLollipopTransition && name.indexOf("slide") !== 0 && name !== "fade" && name.indexOf("flip") !== 0) {
        name = "default";
    }
    var currentFragmentNeedsDifferentAnimation = false;
    if (currentEntry) {
        _updateTransitions(currentEntry);
        if (currentEntry.transitionName !== name ||
            currentEntry.transition !== transition ||
            !!currentEntry.useLollipopTransition !== useLollipopTransition ||
            !useLollipopTransition) {
            clearExitAndReenterTransitions(currentEntry, true);
            currentFragmentNeedsDifferentAnimation = true;
        }
    }
    if (name === "none") {
        transition = new NoTransition(0, null);
    }
    else if (name === "default") {
        transition = new fade_transition_1.FadeTransition(150, null);
    }
    else if (useLollipopTransition) {
        if (name.indexOf("slide") === 0) {
            setupNewFragmentSlideTransition(navigationTransition, newEntry, name);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentSlideTransition(navigationTransition, currentEntry, name);
            }
        }
        else if (name === "fade") {
            setupNewFragmentFadeTransition(navigationTransition, newEntry);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentFadeTransition(navigationTransition, currentEntry);
            }
        }
        else if (name === "explode") {
            setupNewFragmentExplodeTransition(navigationTransition, newEntry);
            if (currentFragmentNeedsDifferentAnimation) {
                setupCurrentFragmentExplodeTransition(navigationTransition, currentEntry);
            }
        }
    }
    else if (name.indexOf("slide") === 0) {
        var direction = name.substr("slide".length) || "left";
        transition = new slide_transition_1.SlideTransition(direction, navigationTransition.duration, navigationTransition.curve);
    }
    else if (name === "fade") {
        transition = new fade_transition_1.FadeTransition(navigationTransition.duration, navigationTransition.curve);
    }
    else if (name.indexOf("flip") === 0) {
        var direction = name.substr("flip".length) || "right";
        transition = new flip_transition_1.FlipTransition(direction, navigationTransition.duration, navigationTransition.curve);
    }
    newEntry.transitionName = name;
    if (name === "custom") {
        newEntry.transition = transition;
    }
    if (transition) {
        if (fragmentTransaction) {
            fragmentTransaction.setCustomAnimations(-10, -20);
        }
        setupAllAnimation(newEntry, transition);
        if (currentFragmentNeedsDifferentAnimation) {
            setupExitAndPopEnterAnimation(currentEntry, transition);
        }
    }
    if (currentEntry) {
        currentEntry.transitionName = name;
        if (name === "custom") {
            currentEntry.transition = transition;
        }
    }
    setupDefaultAnimations(newEntry, new fade_transition_1.FadeTransition(150, null));
    printTransitions(currentEntry);
    printTransitions(newEntry);
}
exports._setAndroidFragmentTransitions = _setAndroidFragmentTransitions;
function _onFragmentCreateAnimator(entry, fragment, nextAnim, enter) {
    var animator;
    switch (nextAnim) {
        case -10:
            animator = entry.enterAnimator || entry.defaultEnterAnimator;
            break;
        case -20:
            animator = entry.exitAnimator || entry.defaultExitAnimator;
            break;
        case -30:
            animator = entry.popEnterAnimator;
            break;
        case -40:
            animator = entry.popExitAnimator;
            break;
    }
    if (!animator && sdkVersion() >= 21) {
        var view = fragment.getView();
        var jsParent = entry.resolvedPage.parent;
        var parent_1 = view.getParent() || (jsParent && jsParent.nativeViewProtected);
        var animatedEntries = _getAnimatedEntries(entry.frameId);
        if (!animatedEntries || !animatedEntries.has(entry)) {
            if (parent_1 && !parent_1.isLaidOut()) {
                animator = enter ? entry.defaultEnterAnimator : entry.defaultExitAnimator;
            }
        }
    }
    return animator;
}
exports._onFragmentCreateAnimator = _onFragmentCreateAnimator;
function _getAnimatedEntries(frameId) {
    return exports.waitingQueue.get(frameId);
}
exports._getAnimatedEntries = _getAnimatedEntries;
function _updateTransitions(entry) {
    var fragment = entry.fragment;
    var enterTransitionListener = entry.enterTransitionListener;
    if (enterTransitionListener && fragment) {
        fragment.setEnterTransition(enterTransitionListener.transition);
    }
    var exitTransitionListener = entry.exitTransitionListener;
    if (exitTransitionListener && fragment) {
        fragment.setExitTransition(exitTransitionListener.transition);
    }
    var reenterTransitionListener = entry.reenterTransitionListener;
    if (reenterTransitionListener && fragment) {
        fragment.setReenterTransition(reenterTransitionListener.transition);
    }
    var returnTransitionListener = entry.returnTransitionListener;
    if (returnTransitionListener && fragment) {
        fragment.setReturnTransition(returnTransitionListener.transition);
    }
}
exports._updateTransitions = _updateTransitions;
function _reverseTransitions(previousEntry, currentEntry) {
    var previousFragment = previousEntry.fragment;
    var currentFragment = currentEntry.fragment;
    var transitionUsed = false;
    if (sdkVersion() >= 21) {
        var returnTransitionListener = currentEntry.returnTransitionListener;
        if (returnTransitionListener) {
            transitionUsed = true;
            currentFragment.setExitTransition(returnTransitionListener.transition);
        }
        else {
            currentFragment.setExitTransition(null);
        }
        var reenterTransitionListener = previousEntry.reenterTransitionListener;
        if (reenterTransitionListener) {
            transitionUsed = true;
            previousFragment.setEnterTransition(reenterTransitionListener.transition);
        }
        else {
            previousFragment.setEnterTransition(null);
        }
    }
    return transitionUsed;
}
exports._reverseTransitions = _reverseTransitions;
function getTransitionListener(entry, transition) {
    if (!TransitionListener) {
        var TransitionListenerImpl = (function (_super) {
            __extends(TransitionListenerImpl, _super);
            function TransitionListenerImpl(entry, transition) {
                var _this = _super.call(this) || this;
                _this.entry = entry;
                _this.transition = transition;
                return global.__native(_this);
            }
            TransitionListenerImpl.prototype.onTransitionStart = function (transition) {
                var entry = this.entry;
                addToWaitingQueue(entry);
                if (trace_1.isEnabled()) {
                    trace_1.write("START " + toShortString(transition) + " transition for " + entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionEnd = function (transition) {
                var entry = this.entry;
                if (trace_1.isEnabled()) {
                    trace_1.write("END " + toShortString(transition) + " transition for " + entry.fragmentTag, trace_1.categories.Transition);
                }
                transitionOrAnimationCompleted(entry);
            };
            TransitionListenerImpl.prototype.onTransitionResume = function (transition) {
                if (trace_1.isEnabled()) {
                    var fragment = this.entry.fragmentTag;
                    trace_1.write("RESUME " + toShortString(transition) + " transition for " + fragment, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionPause = function (transition) {
                if (trace_1.isEnabled()) {
                    trace_1.write("PAUSE " + toShortString(transition) + " transition for " + this.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl.prototype.onTransitionCancel = function (transition) {
                if (trace_1.isEnabled()) {
                    trace_1.write("CANCEL " + toShortString(transition) + " transition for " + this.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            TransitionListenerImpl = __decorate([
                Interfaces([android.transition.Transition.TransitionListener])
            ], TransitionListenerImpl);
            return TransitionListenerImpl;
        }(java.lang.Object));
        TransitionListener = TransitionListenerImpl;
    }
    return new TransitionListener(entry, transition);
}
function getAnimationListener() {
    if (!AnimationListener) {
        var AnimationListenerImpl = (function (_super) {
            __extends(AnimationListenerImpl, _super);
            function AnimationListenerImpl() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            AnimationListenerImpl.prototype.onAnimationStart = function (animator) {
                var entry = animator.entry;
                addToWaitingQueue(entry);
                if (trace_1.isEnabled()) {
                    trace_1.write("START " + animator.transitionType + " for " + entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl.prototype.onAnimationRepeat = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("REPEAT " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl.prototype.onAnimationEnd = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("END " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
                transitionOrAnimationCompleted(animator.entry);
            };
            AnimationListenerImpl.prototype.onAnimationCancel = function (animator) {
                if (trace_1.isEnabled()) {
                    trace_1.write("CANCEL " + animator.transitionType + " for " + animator.entry.fragmentTag, trace_1.categories.Transition);
                }
            };
            AnimationListenerImpl = __decorate([
                Interfaces([android.animation.Animator.AnimatorListener])
            ], AnimationListenerImpl);
            return AnimationListenerImpl;
        }(java.lang.Object));
        AnimationListener = new AnimationListenerImpl();
    }
    return AnimationListener;
}
function addToWaitingQueue(entry) {
    var frameId = entry.frameId;
    var entries = exports.waitingQueue.get(frameId);
    if (!entries) {
        entries = new Set();
        exports.waitingQueue.set(frameId, entries);
    }
    entries.add(entry);
}
function clearAnimationListener(animator, listener) {
    if (!animator) {
        return;
    }
    animator.removeListener(listener);
    if (animator.entry && trace_1.isEnabled()) {
        var entry = animator.entry;
        trace_1.write("Clear " + animator.transitionType + " - " + entry.transition + " for " + entry.fragmentTag, trace_1.categories.Transition);
    }
    animator.entry = null;
}
function clearExitAndReenterTransitions(entry, removeListener) {
    if (sdkVersion() >= 21) {
        var fragment = entry.fragment;
        var exitListener = entry.exitTransitionListener;
        if (exitListener) {
            var exitTransition = fragment.getExitTransition();
            if (exitTransition) {
                if (removeListener) {
                    exitTransition.removeListener(exitListener);
                }
                fragment.setExitTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Exit " + exitTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.exitTransitionListener = null;
            }
        }
        var reenterListener = entry.reenterTransitionListener;
        if (reenterListener) {
            var reenterTransition = fragment.getReenterTransition();
            if (reenterTransition) {
                if (removeListener) {
                    reenterTransition.removeListener(reenterListener);
                }
                fragment.setReenterTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Reenter " + reenterTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.reenterTransitionListener = null;
            }
        }
    }
}
function _clearFragment(entry) {
    clearEntry(entry, false);
}
exports._clearFragment = _clearFragment;
function _clearEntry(entry) {
    clearEntry(entry, true);
}
exports._clearEntry = _clearEntry;
function clearEntry(entry, removeListener) {
    clearExitAndReenterTransitions(entry, removeListener);
    if (sdkVersion() >= 21) {
        var fragment = entry.fragment;
        var enterListener = entry.enterTransitionListener;
        if (enterListener) {
            var enterTransition = fragment.getEnterTransition();
            if (enterTransition) {
                if (removeListener) {
                    enterTransition.removeListener(enterListener);
                }
                fragment.setEnterTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Enter " + enterTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.enterTransitionListener = null;
            }
        }
        var returnListener = entry.returnTransitionListener;
        if (returnListener) {
            var returnTransition = fragment.getReturnTransition();
            if (returnTransition) {
                if (removeListener) {
                    returnTransition.removeListener(returnListener);
                }
                fragment.setReturnTransition(null);
                if (trace_1.isEnabled()) {
                    trace_1.write("Cleared Return " + returnTransition.getClass().getSimpleName() + " transition for " + fragment, trace_1.categories.Transition);
                }
            }
            if (removeListener) {
                entry.returnTransitionListener = null;
            }
        }
    }
    if (removeListener) {
        var listener = getAnimationListener();
        clearAnimationListener(entry.enterAnimator, listener);
        clearAnimationListener(entry.exitAnimator, listener);
        clearAnimationListener(entry.popEnterAnimator, listener);
        clearAnimationListener(entry.popExitAnimator, listener);
        clearAnimationListener(entry.defaultEnterAnimator, listener);
        clearAnimationListener(entry.defaultExitAnimator, listener);
    }
}
function allowTransitionOverlap(fragment) {
    if (fragment) {
        fragment.setAllowEnterTransitionOverlap(true);
        fragment.setAllowReturnTransitionOverlap(true);
    }
}
function setEnterTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.enterTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setEnterTransition(transition);
}
function setExitTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.exitTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setExitTransition(transition);
}
function setReenterTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.reenterTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setReenterTransition(transition);
}
function setReturnTransition(navigationTransition, entry, transition) {
    setUpNativeTransition(navigationTransition, transition);
    var listener = addNativeTransitionListener(entry, transition);
    entry.returnTransitionListener = listener;
    var fragment = entry.fragment;
    fragment.setReturnTransition(transition);
}
function setupNewFragmentSlideTransition(navTransition, entry, name) {
    setupCurrentFragmentSlideTransition(navTransition, entry, name);
    var direction = name.substr("slide".length) || "left";
    switch (direction) {
        case "left":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            break;
        case "right":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            break;
        case "top":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            break;
        case "bottom":
            setEnterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            setReturnTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            break;
    }
}
function setupCurrentFragmentSlideTransition(navTransition, entry, name) {
    var direction = name.substr("slide".length) || "left";
    switch (direction) {
        case "left":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.LEFT));
            break;
        case "right":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.RIGHT));
            break;
        case "top":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.TOP));
            break;
        case "bottom":
            setExitTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            setReenterTransition(navTransition, entry, new android.transition.Slide(android.view.Gravity.BOTTOM));
            break;
    }
}
function setupNewFragmentFadeTransition(navTransition, entry) {
    setupCurrentFragmentFadeTransition(navTransition, entry);
    var fadeInEnter = new android.transition.Fade(android.transition.Fade.IN);
    setEnterTransition(navTransition, entry, fadeInEnter);
    var fadeOutReturn = new android.transition.Fade(android.transition.Fade.OUT);
    setReturnTransition(navTransition, entry, fadeOutReturn);
}
function setupCurrentFragmentFadeTransition(navTransition, entry) {
    var fadeOutExit = new android.transition.Fade(android.transition.Fade.OUT);
    setExitTransition(navTransition, entry, fadeOutExit);
    var fadeInReenter = new android.transition.Fade(android.transition.Fade.IN);
    setReenterTransition(navTransition, entry, fadeInReenter);
}
function setupCurrentFragmentExplodeTransition(navTransition, entry) {
    setExitTransition(navTransition, entry, new android.transition.Explode());
    setReenterTransition(navTransition, entry, new android.transition.Explode());
}
function setupNewFragmentExplodeTransition(navTransition, entry) {
    setupCurrentFragmentExplodeTransition(navTransition, entry);
    setEnterTransition(navTransition, entry, new android.transition.Explode());
    setReturnTransition(navTransition, entry, new android.transition.Explode());
}
function setupExitAndPopEnterAnimation(entry, transition) {
    var listener = getAnimationListener();
    clearAnimationListener(entry.exitAnimator, listener);
    clearAnimationListener(entry.popEnterAnimator, listener);
    var exitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.exit);
    exitAnimator.transitionType = transition_1.AndroidTransitionType.exit;
    exitAnimator.entry = entry;
    exitAnimator.addListener(listener);
    entry.exitAnimator = exitAnimator;
    var popEnterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.popEnter);
    popEnterAnimator.transitionType = transition_1.AndroidTransitionType.popEnter;
    popEnterAnimator.entry = entry;
    popEnterAnimator.addListener(listener);
    entry.popEnterAnimator = popEnterAnimator;
}
function setupAllAnimation(entry, transition) {
    setupExitAndPopEnterAnimation(entry, transition);
    var listener = getAnimationListener();
    var enterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.enter);
    enterAnimator.transitionType = transition_1.AndroidTransitionType.enter;
    enterAnimator.entry = entry;
    enterAnimator.addListener(listener);
    entry.enterAnimator = enterAnimator;
    var popExitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.popExit);
    popExitAnimator.transitionType = transition_1.AndroidTransitionType.popExit;
    popExitAnimator.entry = entry;
    popExitAnimator.addListener(listener);
    entry.popExitAnimator = popExitAnimator;
}
function setupDefaultAnimations(entry, transition) {
    var listener = getAnimationListener();
    var enterAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.enter);
    enterAnimator.transitionType = transition_1.AndroidTransitionType.enter;
    enterAnimator.entry = entry;
    enterAnimator.addListener(listener);
    entry.defaultEnterAnimator = enterAnimator;
    var exitAnimator = transition.createAndroidAnimator(transition_1.AndroidTransitionType.exit);
    exitAnimator.transitionType = transition_1.AndroidTransitionType.exit;
    exitAnimator.entry = entry;
    exitAnimator.addListener(listener);
    entry.defaultExitAnimator = exitAnimator;
}
function setUpNativeTransition(navigationTransition, nativeTransition) {
    if (navigationTransition.duration) {
        nativeTransition.setDuration(navigationTransition.duration);
    }
    var interpolator = navigationTransition.curve ? animation_1._resolveAnimationCurve(navigationTransition.curve) : defaultInterpolator();
    nativeTransition.setInterpolator(interpolator);
}
function addNativeTransitionListener(entry, nativeTransition) {
    var listener = getTransitionListener(entry, nativeTransition);
    nativeTransition.addListener(listener);
    return listener;
}
function transitionOrAnimationCompleted(entry) {
    var frameId = entry.frameId;
    var entries = exports.waitingQueue.get(frameId);
    if (!entries) {
        return;
    }
    entries.delete(entry);
    if (entries.size === 0) {
        var frame_1 = entry.resolvedPage.frame;
        var previousCompletedAnimationEntry = exports.completedEntries.get(frameId);
        exports.completedEntries.delete(frameId);
        exports.waitingQueue.delete(frameId);
        var navigationContext_1 = frame_1._executingContext || { navigationType: frame_common_1.NavigationType.back };
        var current_1 = frame_1.isCurrent(entry) ? previousCompletedAnimationEntry : entry;
        current_1 = current_1 || entry;
        if (current_1) {
            setTimeout(function () { return frame_1.setCurrent(current_1, navigationContext_1.navigationType); });
        }
    }
    else {
        exports.completedEntries.set(frameId, entry);
    }
}
function toShortString(nativeTransition) {
    return nativeTransition.getClass().getSimpleName() + "@" + nativeTransition.hashCode().toString(16);
}
function printTransitions(entry) {
    if (entry && trace_1.isEnabled()) {
        var result = entry.fragmentTag + " Transitions:";
        if (entry.transitionName) {
            result += "transitionName=" + entry.transitionName + ", ";
        }
        if (entry.transition) {
            result += "enterAnimator=" + entry.enterAnimator + ", ";
            result += "exitAnimator=" + entry.exitAnimator + ", ";
            result += "popEnterAnimator=" + entry.popEnterAnimator + ", ";
            result += "popExitAnimator=" + entry.popExitAnimator + ", ";
        }
        if (sdkVersion() >= 21) {
            var fragment = entry.fragment;
            result += "" + (fragment.getEnterTransition() ? " enter=" + toShortString(fragment.getEnterTransition()) : "");
            result += "" + (fragment.getExitTransition() ? " exit=" + toShortString(fragment.getExitTransition()) : "");
            result += "" + (fragment.getReenterTransition() ? " popEnter=" + toShortString(fragment.getReenterTransition()) : "");
            result += "" + (fragment.getReturnTransition() ? " popExit=" + toShortString(fragment.getReturnTransition()) : "");
        }
        trace_1.write(result, trace_1.categories.Transition);
    }
}
function javaObjectArray() {
    var params = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        params[_i] = arguments[_i];
    }
    var nativeArray = Array.create(java.lang.Object, params.length);
    params.forEach(function (value, i) { return nativeArray[i] = value; });
    return nativeArray;
}
function createDummyZeroDurationAnimator() {
    var animator = android.animation.ValueAnimator.ofObject(intEvaluator(), javaObjectArray(java.lang.Integer.valueOf(0), java.lang.Integer.valueOf(1)));
    animator.setDuration(1);
    return animator;
}
var NoTransition = (function (_super) {
    __extends(NoTransition, _super);
    function NoTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NoTransition.prototype.createAndroidAnimator = function (transitionType) {
        return createDummyZeroDurationAnimator();
    };
    return NoTransition;
}(transition_1.Transition));
//# sourceMappingURL=fragment.transitions.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var NavigationType;
(function (NavigationType) {
    NavigationType[NavigationType["back"] = 0] = "back";
    NavigationType[NavigationType["forward"] = 1] = "forward";
    NavigationType[NavigationType["replace"] = 2] = "replace";
})(NavigationType = exports.NavigationType || (exports.NavigationType = {}));
function buildEntryFromArgs(arg) {
    var entry;
    if (typeof arg === "string") {
        entry = {
            moduleName: arg
        };
    }
    else if (typeof arg === "function") {
        entry = {
            create: arg
        };
    }
    else {
        entry = arg;
    }
    return entry;
}
var FrameBase = (function (_super) {
    __extends(FrameBase, _super);
    function FrameBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._backStack = new Array();
        _this._navigationQueue = new Array();
        _this._isInFrameStack = false;
        return _this;
    }
    FrameBase_1 = FrameBase;
    FrameBase.prototype._addChildFromBuilder = function (name, value) {
        throw new Error("Frame should not have a view. Use 'defaultPage' property instead.");
    };
    FrameBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.canGoBack = function () {
        var _this = this;
        var backstack = this._backStack.length;
        var previousForwardNotInBackstack = false;
        this._navigationQueue.forEach(function (item) {
            var entry = item.entry;
            var isBackNavigation = item.navigationType === NavigationType.back;
            if (isBackNavigation) {
                previousForwardNotInBackstack = false;
                if (!entry) {
                    backstack--;
                }
                else {
                    var backstackIndex = _this._backStack.indexOf(entry);
                    if (backstackIndex !== -1) {
                        backstack = backstackIndex;
                    }
                    else {
                        backstack--;
                    }
                }
            }
            else if (entry.entry.clearHistory) {
                previousForwardNotInBackstack = false;
                backstack = 0;
            }
            else {
                backstack++;
                if (previousForwardNotInBackstack) {
                    backstack--;
                }
                previousForwardNotInBackstack = entry.entry.backstackVisible === false;
            }
        });
        if (this._navigationQueue.length > 0 && !this._currentEntry) {
            backstack--;
        }
        return backstack > 0;
    };
    FrameBase.prototype.goBack = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK", view_1.traceCategories.Navigation);
        }
        if (!this.canGoBack()) {
            return;
        }
        if (backstackEntry) {
            var index_1 = this._backStack.indexOf(backstackEntry);
            if (index_1 < 0) {
                return;
            }
        }
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: true,
            navigationType: NavigationType.back
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype._removeEntry = function (removed) {
        var page = removed.resolvedPage;
        var frame = page.frame;
        page._frame = null;
        if (frame) {
            frame._removeView(page);
        }
        else {
            page._tearDownUI(true);
        }
        removed.resolvedPage = null;
    };
    FrameBase.prototype.navigate = function (param) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE", view_1.traceCategories.Navigation);
        }
        var entry = buildEntryFromArgs(param);
        var page = builder_1.createViewFromEntry(entry);
        this._pushInFrameStack();
        var backstackEntry = {
            entry: entry,
            resolvedPage: page,
            navDepth: undefined,
            fragmentTag: undefined
        };
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.forward
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.isCurrent = function (entry) {
        return this._currentEntry === entry;
    };
    FrameBase.prototype.setCurrent = function (entry, navigationType) {
        var newPage = entry.resolvedPage;
        if (!newPage.frame) {
            this._addView(newPage);
            newPage._frame = this;
        }
        this._currentEntry = entry;
        var isBack = navigationType === NavigationType.back;
        if (isBack) {
            this._pushInFrameStack();
        }
        newPage.onNavigatedTo(isBack);
        this._executingContext = null;
    };
    FrameBase.prototype._updateBackstack = function (entry, navigationType) {
        var _this = this;
        var isBack = navigationType === NavigationType.back;
        var isReplace = navigationType === NavigationType.replace;
        this.raiseCurrentPageNavigatedEvents(isBack);
        var current = this._currentEntry;
        if (isBack) {
            var index_2 = this._backStack.indexOf(entry);
            this._backStack.splice(index_2 + 1).forEach(function (e) { return _this._removeEntry(e); });
            this._backStack.pop();
        }
        else if (!isReplace) {
            if (entry.entry.clearHistory) {
                this._backStack.forEach(function (e) { return _this._removeEntry(e); });
                this._backStack.length = 0;
            }
            else if (FrameBase_1._isEntryBackstackVisible(current)) {
                this._backStack.push(current);
            }
        }
        if (current && this._backStack.indexOf(current) < 0) {
            this._removeEntry(current);
        }
    };
    FrameBase.prototype.isNestedWithin = function (parentFrameCandidate) {
        var frameAncestor = this;
        while (frameAncestor) {
            frameAncestor = view_common_1.getAncestor(frameAncestor, FrameBase_1);
            if (frameAncestor === parentFrameCandidate) {
                return true;
            }
        }
        return false;
    };
    FrameBase.prototype.raiseCurrentPageNavigatedEvents = function (isBack) {
        var page = this.currentPage;
        if (page) {
            if (page.isLoaded) {
                page.callUnloaded();
            }
            page.onNavigatedFrom(isBack);
        }
    };
    FrameBase.prototype._processNavigationQueue = function (page) {
        if (this._navigationQueue.length === 0) {
            return;
        }
        var entry = this._navigationQueue[0].entry;
        var currentNavigationPage = entry.resolvedPage;
        if (page !== currentNavigationPage) {
            return;
        }
        this._navigationQueue.shift();
        this._processNextNavigationEntry();
        this._updateActionBar();
    };
    FrameBase.prototype._findEntryForTag = function (fragmentTag) {
        var entry;
        if (this._currentEntry && this._currentEntry.fragmentTag === fragmentTag) {
            entry = this._currentEntry;
        }
        else {
            entry = this._backStack.find(function (value) { return value.fragmentTag === fragmentTag; });
            if (!entry) {
                var navigationItem = this._navigationQueue.find(function (value) { return value.entry.fragmentTag === fragmentTag; });
                entry = navigationItem ? navigationItem.entry : undefined;
            }
        }
        return entry;
    };
    FrameBase.prototype.navigationQueueIsEmpty = function () {
        return this._navigationQueue.length === 0;
    };
    FrameBase._isEntryBackstackVisible = function (entry) {
        if (!entry) {
            return false;
        }
        var backstackVisibleValue = entry.entry.backstackVisible;
        var backstackHidden = backstackVisibleValue !== undefined && !backstackVisibleValue;
        return !backstackHidden;
    };
    FrameBase.prototype._updateActionBar = function (page, disableNavBarAnimation) {
    };
    FrameBase.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext) {
            return;
        }
        if (this._navigationQueue.length > 0) {
            var navigationContext = this._navigationQueue[0];
            var isBackNavigation = navigationContext.navigationType === NavigationType.back;
            if (isBackNavigation) {
                this.performGoBack(navigationContext);
            }
            else {
                this.performNavigation(navigationContext);
            }
        }
    };
    FrameBase.prototype.performNavigation = function (navigationContext) {
        this._executingContext = navigationContext;
        var backstackEntry = navigationContext.entry;
        var isBackNavigation = navigationContext.navigationType === NavigationType.back;
        this._onNavigatingTo(backstackEntry, isBackNavigation);
        this._navigateCore(backstackEntry);
    };
    FrameBase.prototype.performGoBack = function (navigationContext) {
        var backstackEntry = navigationContext.entry;
        var backstack = this._backStack;
        if (!backstackEntry) {
            backstackEntry = backstack[backstack.length - 1];
            navigationContext.entry = backstackEntry;
        }
        this._executingContext = navigationContext;
        this._onNavigatingTo(backstackEntry, true);
        this._goBackCore(backstackEntry);
    };
    FrameBase.prototype._goBackCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._navigateCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._onNavigatingTo = function (backstackEntry, isBack) {
        if (this.currentPage) {
            this.currentPage.onNavigatingFrom(isBack);
        }
        backstackEntry.resolvedPage.onNavigatingTo(backstackEntry.entry.context, isBack, backstackEntry.entry.bindingContext);
    };
    Object.defineProperty(FrameBase.prototype, "animated", {
        get: function () {
            return this._animated;
        },
        set: function (value) {
            this._animated = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "transition", {
        get: function () {
            return this._transition;
        },
        set: function (value) {
            this._transition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "backStack", {
        get: function () {
            return this._backStack.slice();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentPage", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.resolvedPage;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentEntry", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.entry;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._pushInFrameStackRecursive = function () {
        this._pushInFrameStack();
        var framesToPush = [];
        for (var _i = 0, frameStack_1 = frame_stack_1.frameStack; _i < frameStack_1.length; _i++) {
            var frame = frameStack_1[_i];
            if (frame.isNestedWithin(this)) {
                framesToPush.push(frame);
            }
        }
        for (var _a = 0, framesToPush_1 = framesToPush; _a < framesToPush_1.length; _a++) {
            var frame = framesToPush_1[_a];
            frame._pushInFrameStack();
        }
    };
    FrameBase.prototype._pushInFrameStack = function () {
        frame_stack_1._pushInFrameStack(this);
    };
    FrameBase.prototype._popFromFrameStack = function () {
        frame_stack_1._popFromFrameStack(this);
    };
    FrameBase.prototype._removeFromFrameStack = function () {
        frame_stack_1._removeFromFrameStack(this);
    };
    FrameBase.prototype._dialogClosed = function () {
        this._removeFromFrameStack();
    };
    FrameBase.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this._removeFromFrameStack();
    };
    Object.defineProperty(FrameBase.prototype, "_childrenCount", {
        get: function () {
            if (this.currentPage) {
                return 1;
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype.eachChildView = function (callback) {
        var page = this.currentPage;
        if (page) {
            callback(page);
        }
    };
    FrameBase.prototype._getIsAnimatedNavigation = function (entry) {
        if (entry && entry.animated !== undefined) {
            return entry.animated;
        }
        if (this.animated !== undefined) {
            return this.animated;
        }
        return FrameBase_1.defaultAnimatedNavigation;
    };
    FrameBase.prototype._getNavigationTransition = function (entry) {
        if (entry) {
            if (view_1.isIOS && entry.transitioniOS !== undefined) {
                return entry.transitioniOS;
            }
            if (view_1.isAndroid && entry.transitionAndroid !== undefined) {
                return entry.transitionAndroid;
            }
            if (entry.transition !== undefined) {
                return entry.transition;
            }
        }
        if (this.transition !== undefined) {
            return this.transition;
        }
        return FrameBase_1.defaultTransition;
    };
    Object.defineProperty(FrameBase.prototype, "navigationBarHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._getNavBarVisible = function (page) {
        throw new Error();
    };
    FrameBase.prototype._addViewToNativeVisualTree = function (child) {
        return true;
    };
    FrameBase.prototype._removeViewFromNativeVisualTree = function (child) {
        child._isAddedToNativeVisualTree = false;
    };
    FrameBase.prototype._printFrameBackStack = function () {
        var length = this.backStack.length;
        var i = length - 1;
        console.log("Frame Back Stack: ");
        while (i >= 0) {
            var backstackEntry = this.backStack[i--];
            console.log("\t" + backstackEntry.resolvedPage);
        }
    };
    FrameBase.prototype._backstackEntryTrace = function (b) {
        var result = "" + b.resolvedPage;
        var backstackVisible = FrameBase_1._isEntryBackstackVisible(b);
        if (!backstackVisible) {
            result += " | INVISIBLE";
        }
        if (b.entry.clearHistory) {
            result += " | CLEAR HISTORY";
        }
        var animated = this._getIsAnimatedNavigation(b.entry);
        if (!animated) {
            result += " | NOT ANIMATED";
        }
        var t = this._getNavigationTransition(b.entry);
        if (t) {
            result += " | Transition[" + JSON.stringify(t) + "]";
        }
        return result;
    };
    FrameBase.prototype._onLivesync = function (context) {
        if (_super.prototype._onLivesync.call(this, context)) {
            return true;
        }
        if (!context) {
            return this.legacyLivesync();
        }
        return false;
    };
    FrameBase.prototype._handleLivesync = function (context) {
        if (_super.prototype._handleLivesync.call(this, context)) {
            return true;
        }
        if (this.currentPage &&
            view_common_1.viewMatchesModuleContext(this.currentPage, context, ["markup", "script"])) {
            view_1.traceWrite("Change Handled: Replacing page " + context.path, view_1.traceCategories.Livesync);
            this.replacePage(context.path);
            return true;
        }
        return false;
    };
    FrameBase.prototype.legacyLivesync = function () {
        if (view_1.traceEnabled()) {
            view_1.traceWrite(this + "._onLivesync()", view_1.traceCategories.Livesync);
        }
        if (!this._currentEntry || !this._currentEntry.entry) {
            return false;
        }
        var currentEntry = this._currentEntry.entry;
        var newEntry = {
            animated: false,
            clearHistory: true,
            context: currentEntry.context,
            create: currentEntry.create,
            moduleName: currentEntry.moduleName,
            backstackVisible: currentEntry.backstackVisible
        };
        if (newEntry.create) {
            var page = newEntry.create();
            if (page === this.currentPage) {
                return false;
            }
        }
        this.navigate(newEntry);
        return true;
    };
    FrameBase.prototype.replacePage = function (pagePath) {
        var currentBackstackEntry = this._currentEntry;
        var contextModuleName = module_name_sanitizer_1.sanitizeModuleName(pagePath);
        var newPage = builder_1.createViewFromEntry({ moduleName: contextModuleName });
        var newBackstackEntry = {
            entry: currentBackstackEntry.entry,
            resolvedPage: newPage,
            navDepth: currentBackstackEntry.navDepth,
            fragmentTag: currentBackstackEntry.fragmentTag,
            frameId: currentBackstackEntry.frameId
        };
        var navigationContext = {
            entry: newBackstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.replace
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    var FrameBase_1;
    FrameBase.androidOptionSelectedEvent = "optionSelected";
    FrameBase.defaultAnimatedNavigation = true;
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performNavigation", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performGoBack", null);
    FrameBase = FrameBase_1 = __decorate([
        view_1.CSSType("Frame")
    ], FrameBase);
    return FrameBase;
}(view_1.CustomLayoutView));
exports.FrameBase = FrameBase;
function getFrameById(id) {
    return frame_stack_1.frameStack.find(function (frame) { return frame.id && frame.id === id; });
}
exports.getFrameById = getFrameById;
function topmost() {
    return frame_stack_1.topmost();
}
exports.topmost = topmost;
function goBack() {
    var top = topmost();
    if (top && top.canGoBack()) {
        top.goBack();
        return true;
    }
    else if (top) {
        var parentFrameCanGoBack = false;
        var parentFrame = view_common_1.getAncestor(top, "Frame");
        while (parentFrame && !parentFrameCanGoBack) {
            if (parentFrame && parentFrame.canGoBack()) {
                parentFrameCanGoBack = true;
            }
            else {
                parentFrame = view_common_1.getAncestor(parentFrame, "Frame");
            }
        }
        if (parentFrame && parentFrameCanGoBack) {
            parentFrame.goBack();
            return true;
        }
    }
    if (frame_stack_1.frameStack.length > 1) {
        top._popFromFrameStack();
    }
    return false;
}
exports.goBack = goBack;
function _stack() {
    return frame_stack_1.frameStack;
}
exports._stack = _stack;
exports.defaultPage = new view_1.Property({
    name: "defaultPage", valueChanged: function (frame, oldValue, newValue) {
        frame.navigate({ moduleName: newValue });
    }
});
exports.defaultPage.register(FrameBase);
exports.actionBarVisibilityProperty = new view_1.Property({ name: "actionBarVisibility", defaultValue: "auto", affectsLayout: view_1.isIOS });
exports.actionBarVisibilityProperty.register(FrameBase);
//# sourceMappingURL=frame-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-stack.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
exports.frameStack = [];
function topmost() {
    if (exports.frameStack.length > 0) {
        return exports.frameStack[exports.frameStack.length - 1];
    }
    return undefined;
}
exports.topmost = topmost;
function _pushInFrameStack(frame) {
    if (frame._isInFrameStack && exports.frameStack[exports.frameStack.length - 1] === frame) {
        return;
    }
    if (frame._isInFrameStack) {
        var indexOfFrame = exports.frameStack.indexOf(frame);
        exports.frameStack.splice(indexOfFrame, 1);
    }
    exports.frameStack.push(frame);
    frame._isInFrameStack = true;
}
exports._pushInFrameStack = _pushInFrameStack;
function _popFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var top = topmost();
    if (top !== frame) {
        throw new Error("Cannot pop a Frame which is not at the top of the navigation stack.");
    }
    exports.frameStack.pop();
    frame._isInFrameStack = false;
}
exports._popFromFrameStack = _popFromFrameStack;
function _removeFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var index = exports.frameStack.indexOf(frame);
    exports.frameStack.splice(index, 1);
    frame._isInFrameStack = false;
}
exports._removeFromFrameStack = _removeFromFrameStack;
//# sourceMappingURL=frame-stack.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var fragment_transitions_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.transitions.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var system_classes_1 = __webpack_require__("../node_modules/tns-core-modules/css/system-classes.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js"));
var ANDROID_PLATFORM = "android";
var INTENT_EXTRA = "com.tns.activity";
var ROOT_VIEW_ID_EXTRA = "com.tns.activity.rootViewId";
var FRAMEID = "_frameId";
var CALLBACKS = "_callbacks";
var HMR_REPLACE_TRANSITION = "fade";
var ownerSymbol = Symbol("_owner");
var activityRootViewsMap = new Map();
var navDepth = -1;
var fragmentId = -1;
if (global && global.__inspector) {
    var devtools = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.js");
    devtools.attachDOMInspectorEventCallbacks(global.__inspector);
    devtools.attachDOMInspectorCommandCallbacks(global.__inspector);
}
function getAttachListener() {
    if (!exports.attachStateChangeListener) {
        var AttachListener = (function (_super) {
            __extends(AttachListener, _super);
            function AttachListener() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            AttachListener.prototype.onViewAttachedToWindow = function (view) {
                var owner = view[ownerSymbol];
                if (owner) {
                    owner._onAttachedToWindow();
                }
            };
            AttachListener.prototype.onViewDetachedFromWindow = function (view) {
                var owner = view[ownerSymbol];
                if (owner) {
                    owner._onDetachedFromWindow();
                }
            };
            AttachListener = __decorate([
                Interfaces([android.view.View.OnAttachStateChangeListener])
            ], AttachListener);
            return AttachListener;
        }(java.lang.Object));
        exports.attachStateChangeListener = new AttachListener();
    }
    return exports.attachStateChangeListener;
}
function reloadPage(context) {
    var activity = application.android.foregroundActivity;
    var callbacks = activity[CALLBACKS];
    if (callbacks) {
        var rootView = callbacks.getRootView();
        var isAppRootModuleChanged = context && context.path && context.path.includes(application.getMainEntry().moduleName) && context.type !== "style";
        if (isAppRootModuleChanged || !rootView || !rootView._onLivesync(context)) {
            callbacks.resetActivityContent(activity);
        }
    }
    else {
        frame_common_1.traceError(activity + "[CALLBACKS] is null or undefined");
    }
}
exports.reloadPage = reloadPage;
global.__onLiveSyncCore = reloadPage;
var Frame = (function (_super) {
    __extends(Frame, _super);
    function Frame() {
        var _this = _super.call(this) || this;
        _this._containerViewId = -1;
        _this._tearDownPending = false;
        _this._attachedToWindow = false;
        _this._android = new AndroidFrame(_this);
        return _this;
    }
    Object.defineProperty(Frame, "defaultAnimatedNavigation", {
        get: function () {
            return frame_common_1.FrameBase.defaultAnimatedNavigation;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultAnimatedNavigation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame, "defaultTransition", {
        get: function () {
            return frame_common_1.FrameBase.defaultTransition;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultTransition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "containerViewId", {
        get: function () {
            return this._containerViewId;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "android", {
        get: function () {
            return this._android;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype._onAttachedToWindow = function () {
        _super.prototype._onAttachedToWindow.call(this);
        this._attachedToWindow = true;
        this._processNextNavigationEntry();
    };
    Frame.prototype._onDetachedFromWindow = function () {
        _super.prototype._onDetachedFromWindow.call(this);
        this._attachedToWindow = false;
    };
    Frame.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext || !this._attachedToWindow) {
            return;
        }
        var animatedEntries = fragment_transitions_1._getAnimatedEntries(this._android.frameId);
        if (animatedEntries) {
            if (animatedEntries.size > 0) {
                return;
            }
        }
        var manager = this._getFragmentManager();
        var entry = this._currentEntry;
        if (entry && manager && !manager.findFragmentByTag(entry.fragmentTag)) {
            this._cachedAnimatorState = getAnimatorState(this._currentEntry);
            this._currentEntry = null;
            this._navigateCore(entry);
            this._currentEntry = entry;
        }
        else {
            _super.prototype._processNextNavigationEntry.call(this);
        }
    };
    Frame.prototype._getChildFragmentManager = function () {
        var backstackEntry;
        if (this._executingContext && this._executingContext.entry) {
            backstackEntry = this._executingContext.entry;
        }
        else {
            backstackEntry = this._currentEntry;
        }
        if (backstackEntry && backstackEntry.fragment && backstackEntry.fragment.isAdded()) {
            return backstackEntry.fragment.getChildFragmentManager();
        }
        return null;
    };
    Frame.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragment();
    };
    Frame.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.disposeCurrentFragment();
    };
    Frame.prototype.disposeCurrentFragment = function () {
        if (!this._currentEntry ||
            !this._currentEntry.fragment ||
            !this._currentEntry.fragment.isAdded()) {
            return;
        }
        var manager = this._getFragmentManager();
        var transaction = manager.beginTransaction();
        transaction.remove(this._currentEntry.fragment);
        transaction.commitNowAllowingStateLoss();
    };
    Frame.prototype.createFragment = function (backstackEntry, fragmentTag) {
        ensureFragmentClass();
        var newFragment = new fragmentClass();
        var args = new android.os.Bundle();
        args.putInt(FRAMEID, this._android.frameId);
        newFragment.setArguments(args);
        setFragmentCallbacks(newFragment);
        var callbacks = newFragment[CALLBACKS];
        callbacks.frame = this;
        callbacks.entry = backstackEntry;
        backstackEntry.fragment = newFragment;
        backstackEntry.fragmentTag = fragmentTag;
        backstackEntry.navDepth = navDepth;
        return newFragment;
    };
    Frame.prototype.setCurrent = function (entry, navigationType) {
        var current = this._currentEntry;
        var currentEntryChanged = current !== entry;
        if (currentEntryChanged) {
            this._updateBackstack(entry, navigationType);
            if (this._tearDownPending) {
                this._tearDownPending = false;
                if (!entry.recreated) {
                    clearEntry(entry);
                }
                if (current && !current.recreated) {
                    clearEntry(current);
                }
                var context_1 = this._context;
                if (context_1 && !entry.recreated) {
                    entry.fragment = this.createFragment(entry, entry.fragmentTag);
                    entry.resolvedPage._setupUI(context_1);
                }
                entry.recreated = false;
                if (current) {
                    current.recreated = false;
                }
            }
            _super.prototype.setCurrent.call(this, entry, navigationType);
            this._processNavigationQueue(entry.resolvedPage);
        }
        else {
            this._processNextNavigationEntry();
        }
        if (this._cachedAnimatorState) {
            restoreAnimatorState(this._currentEntry, this._cachedAnimatorState);
            this._cachedAnimatorState = null;
        }
        if (navigationType === frame_common_1.NavigationType.replace) {
            fragment_transitions_1._clearEntry(entry);
            var animated = this._getIsAnimatedNavigation(entry.entry);
            var navigationTransition = this._getNavigationTransition(entry.entry);
            var currentEntry = null;
            var newEntry = entry;
            var transaction = null;
            fragment_transitions_1._setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, transaction, this._android.frameId);
        }
    };
    Frame.prototype.onBackPressed = function () {
        if (this.canGoBack()) {
            this.goBack();
            return true;
        }
        if (!this.navigationQueueIsEmpty()) {
            var manager = this._getFragmentManager();
            if (manager) {
                manager.executePendingTransactions();
                return true;
            }
        }
        return false;
    };
    Frame.prototype._navigateCore = function (newEntry) {
        _super.prototype._navigateCore.call(this, newEntry);
        newEntry.frameId = this._android.frameId;
        var activity = this._android.activity;
        if (!activity) {
            var currentActivity = this._android.currentActivity;
            if (currentActivity) {
                startActivity(currentActivity, this._android.frameId);
            }
            return;
        }
        var manager = this._getFragmentManager();
        var clearHistory = newEntry.entry.clearHistory;
        var currentEntry = this._currentEntry;
        if (clearHistory) {
            navDepth = -1;
        }
        var isReplace = this._executingContext && this._executingContext.navigationType === frame_common_1.NavigationType.replace;
        if (!isReplace) {
            navDepth++;
        }
        fragmentId++;
        var newFragmentTag = "fragment" + fragmentId + "[" + navDepth + "]";
        var newFragment = this.createFragment(newEntry, newFragmentTag);
        var transaction = manager.beginTransaction();
        var animated = currentEntry ? this._getIsAnimatedNavigation(newEntry.entry) : false;
        var navigationTransition;
        if (isReplace) {
            animated = true;
            navigationTransition = { name: HMR_REPLACE_TRANSITION, duration: 100 };
        }
        else if (this._currentEntry) {
            navigationTransition = this._getNavigationTransition(newEntry.entry);
        }
        else {
            navigationTransition = null;
        }
        fragment_transitions_1._setAndroidFragmentTransitions(animated, navigationTransition, currentEntry, newEntry, transaction, this._android.frameId);
        if (currentEntry && animated && !navigationTransition) {
            transaction.setTransition(androidx.fragment.app.FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
        }
        transaction.replace(this.containerViewId, newFragment, newFragmentTag);
        transaction.commitAllowingStateLoss();
    };
    Frame.prototype._goBackCore = function (backstackEntry) {
        _super.prototype._goBackCore.call(this, backstackEntry);
        navDepth = backstackEntry.navDepth;
        var manager = this._getFragmentManager();
        var transaction = manager.beginTransaction();
        if (!backstackEntry.fragment) {
            backstackEntry.fragment = this.createFragment(backstackEntry, backstackEntry.fragmentTag);
            fragment_transitions_1._updateTransitions(backstackEntry);
        }
        var transitionReversed = fragment_transitions_1._reverseTransitions(backstackEntry, this._currentEntry);
        if (!transitionReversed) {
            transaction.setCustomAnimations(-30, -40);
        }
        transaction.replace(this.containerViewId, backstackEntry.fragment, backstackEntry.fragmentTag);
        transaction.commitAllowingStateLoss();
    };
    Frame.prototype._removeEntry = function (removed) {
        _super.prototype._removeEntry.call(this, removed);
        if (removed.fragment) {
            fragment_transitions_1._clearEntry(removed);
        }
        removed.fragment = null;
        removed.viewSavedState = null;
    };
    Frame.prototype.createNativeView = function () {
        return new org.nativescript.widgets.ContentLayout(this._context);
    };
    Frame.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var listener = getAttachListener();
        this.nativeViewProtected.addOnAttachStateChangeListener(listener);
        this.nativeViewProtected[ownerSymbol] = this;
        this._android.rootViewGroup = this.nativeViewProtected;
        if (this._containerViewId < 0) {
            this._containerViewId = android.view.View.generateViewId();
        }
        this._android.rootViewGroup.setId(this._containerViewId);
    };
    Frame.prototype.disposeNativeView = function () {
        var listener = getAttachListener();
        this.nativeViewProtected.removeOnAttachStateChangeListener(listener);
        this.nativeViewProtected[ownerSymbol] = null;
        this._tearDownPending = !!this._executingContext;
        var current = this._currentEntry;
        var executingEntry = this._executingContext ? this._executingContext.entry : null;
        this.backStack.forEach(function (entry) {
            if (entry !== executingEntry) {
                clearEntry(entry);
            }
        });
        if (current && !executingEntry) {
            clearEntry(current);
        }
        this._android.rootViewGroup = null;
        this._removeFromFrameStack();
        _super.prototype.disposeNativeView.call(this);
    };
    Frame.prototype._popFromFrameStack = function () {
        if (!this._isInFrameStack) {
            return;
        }
        _super.prototype._popFromFrameStack.call(this);
    };
    Frame.prototype._getNavBarVisible = function (page) {
        switch (this.actionBarVisibility) {
            case "never":
                return false;
            case "always":
                return true;
            default:
                if (page.actionBarHidden !== undefined) {
                    return !page.actionBarHidden;
                }
                if (this._android && this._android.showActionBar !== undefined) {
                    return this._android.showActionBar;
                }
                return true;
        }
    };
    Frame.prototype._saveFragmentsState = function () {
        this.backStack.forEach(function (entry) {
            var view = entry.resolvedPage.nativeViewProtected;
            if (!entry.viewSavedState && view) {
                var viewState = new android.util.SparseArray();
                view.saveHierarchyState(viewState);
                entry.viewSavedState = viewState;
            }
        });
    };
    __decorate([
        profiling_1.profile
    ], Frame.prototype, "_navigateCore", null);
    return Frame;
}(frame_common_1.FrameBase));
exports.Frame = Frame;
function cloneExpandedAnimator(expandedAnimator) {
    if (!expandedAnimator) {
        return null;
    }
    var clone = expandedAnimator.clone();
    clone.entry = expandedAnimator.entry;
    clone.transitionType = expandedAnimator.transitionType;
    return clone;
}
function getAnimatorState(entry) {
    var expandedEntry = entry;
    var animatorState = {};
    animatorState.enterAnimator = cloneExpandedAnimator(expandedEntry.enterAnimator);
    animatorState.exitAnimator = cloneExpandedAnimator(expandedEntry.exitAnimator);
    animatorState.popEnterAnimator = cloneExpandedAnimator(expandedEntry.popEnterAnimator);
    animatorState.popExitAnimator = cloneExpandedAnimator(expandedEntry.popExitAnimator);
    animatorState.transitionName = expandedEntry.transitionName;
    return animatorState;
}
function restoreAnimatorState(entry, snapshot) {
    var expandedEntry = entry;
    if (snapshot.enterAnimator) {
        expandedEntry.enterAnimator = snapshot.enterAnimator;
    }
    if (snapshot.exitAnimator) {
        expandedEntry.exitAnimator = snapshot.exitAnimator;
    }
    if (snapshot.popEnterAnimator) {
        expandedEntry.popEnterAnimator = snapshot.popEnterAnimator;
    }
    if (snapshot.popExitAnimator) {
        expandedEntry.popExitAnimator = snapshot.popExitAnimator;
    }
    expandedEntry.transitionName = snapshot.transitionName;
}
function clearEntry(entry) {
    if (entry.fragment) {
        fragment_transitions_1._clearFragment(entry);
    }
    entry.recreated = false;
    entry.fragment = null;
    var page = entry.resolvedPage;
    if (page._context) {
        entry.resolvedPage._tearDownUI(true);
    }
}
var framesCounter = 0;
var framesCache = new Array();
var AndroidFrame = (function (_super) {
    __extends(AndroidFrame, _super);
    function AndroidFrame(owner) {
        var _this = _super.call(this) || this;
        _this._showActionBar = true;
        _this._owner = owner;
        _this.frameId = framesCounter++;
        framesCache.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(AndroidFrame.prototype, "showActionBar", {
        get: function () {
            return this._showActionBar;
        },
        set: function (value) {
            if (this._showActionBar !== value) {
                this._showActionBar = value;
                if (this.owner.currentPage) {
                    this.owner.currentPage.actionBar.update();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "activity", {
        get: function () {
            var activity = this.owner._context;
            if (activity) {
                return activity;
            }
            var currView = this._owner.parent;
            while (currView) {
                if (currView instanceof Frame) {
                    return currView.android.activity;
                }
                currView = currView.parent;
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "actionBar", {
        get: function () {
            var activity = this.currentActivity;
            if (!activity) {
                return undefined;
            }
            var bar = activity.getActionBar();
            if (!bar) {
                return undefined;
            }
            return bar;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "currentActivity", {
        get: function () {
            var activity = this.activity;
            if (activity) {
                return activity;
            }
            var frames = frame_common_1._stack();
            for (var length_1 = frames.length, i = length_1 - 1; i >= 0; i--) {
                activity = frames[i].android.activity;
                if (activity) {
                    return activity;
                }
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AndroidFrame.prototype, "owner", {
        get: function () {
            return this._owner;
        },
        enumerable: true,
        configurable: true
    });
    AndroidFrame.prototype.canGoBack = function () {
        if (!this.activity) {
            return false;
        }
        return this.activity.getIntent().getAction() !== android.content.Intent.ACTION_MAIN;
    };
    AndroidFrame.prototype.fragmentForPage = function (entry) {
        var tag = entry && entry.fragmentTag;
        if (tag) {
            return this.owner._getFragmentManager().findFragmentByTag(tag);
        }
        return undefined;
    };
    return AndroidFrame;
}(frame_common_1.Observable));
function findPageForFragment(fragment, frame) {
    var fragmentTag = fragment.getTag();
    if (frame_common_1.traceEnabled()) {
        frame_common_1.traceWrite("Finding page for " + fragmentTag + ".", frame_common_1.traceCategories.NativeLifecycle);
    }
    var entry;
    var current = frame._currentEntry;
    var executingContext = frame._executingContext;
    if (current && current.fragmentTag === fragmentTag) {
        entry = current;
    }
    else if (executingContext && executingContext.entry && executingContext.entry.fragmentTag === fragmentTag) {
        entry = executingContext.entry;
    }
    var page;
    if (entry) {
        entry.recreated = true;
        page = entry.resolvedPage;
    }
    if (page) {
        var callbacks = fragment[CALLBACKS];
        callbacks.frame = frame;
        callbacks.entry = entry;
        entry.fragment = fragment;
        fragment_transitions_1._updateTransitions(entry);
    }
    else {
        throw new Error("Could not find a page for " + fragmentTag + ".");
    }
}
function startActivity(activity, frameId) {
    var intent = new android.content.Intent(activity, activity.getClass());
    intent.setAction(android.content.Intent.ACTION_DEFAULT);
    intent.putExtra(INTENT_EXTRA, frameId);
    activity.startActivity(intent);
}
function getFrameByNumberId(frameId) {
    for (var i = 0; i < framesCache.length; i++) {
        var aliveFrame = framesCache[i].get();
        if (aliveFrame && aliveFrame.frameId === frameId) {
            return aliveFrame.owner;
        }
    }
    return null;
}
function ensureFragmentClass() {
    if (fragmentClass) {
        return;
    }
    __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.js");
    if (!fragmentClass) {
        throw new Error("Failed to initialize the extended androidx.fragment.app.Fragment class");
    }
}
var fragmentClass;
function setFragmentClass(clazz) {
    if (fragmentClass) {
        throw new Error("Fragment class already initialized");
    }
    fragmentClass = clazz;
}
exports.setFragmentClass = setFragmentClass;
var FragmentCallbacksImplementation = (function () {
    function FragmentCallbacksImplementation() {
    }
    FragmentCallbacksImplementation.prototype.onHiddenChanged = function (fragment, hidden, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onHiddenChanged(" + hidden + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, hidden);
    };
    FragmentCallbacksImplementation.prototype.onCreateAnimator = function (fragment, transit, enter, nextAnim, superFunc) {
        if (!enter && fragment.getRemovingParentFragment()) {
            return superFunc.call(fragment, transit, enter, nextAnim);
        }
        var nextAnimString;
        switch (nextAnim) {
            case -10:
                nextAnimString = "enter";
                break;
            case -20:
                nextAnimString = "exit";
                break;
            case -30:
                nextAnimString = "popEnter";
                break;
            case -40:
                nextAnimString = "popExit";
                break;
        }
        var animator = fragment_transitions_1._onFragmentCreateAnimator(this.entry, fragment, nextAnim, enter);
        if (!animator) {
            animator = superFunc.call(fragment, transit, enter, nextAnim);
        }
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreateAnimator(" + transit + ", " + (enter ? "enter" : "exit") + ", " + nextAnimString + "): " + (animator ? "animator" : "no animator"), frame_common_1.traceCategories.NativeLifecycle);
        }
        return animator;
    };
    FragmentCallbacksImplementation.prototype.onCreate = function (fragment, savedInstanceState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreate(" + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, savedInstanceState);
        if (!this.entry) {
            var args = fragment.getArguments();
            var frameId = args.getInt(FRAMEID);
            var frame = getFrameByNumberId(frameId);
            if (!frame) {
                throw new Error("Cannot find Frame for " + fragment);
            }
            findPageForFragment(fragment, frame);
        }
    };
    FragmentCallbacksImplementation.prototype.onCreateView = function (fragment, inflater, container, savedInstanceState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onCreateView(inflater, container, " + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        var entry = this.entry;
        if (!entry) {
            frame_common_1.traceError(fragment + ".onCreateView: entry is null or undefined");
            return null;
        }
        var page = entry.resolvedPage;
        if (!page) {
            frame_common_1.traceError(fragment + ".onCreateView: entry has no resolvedPage");
            return null;
        }
        var frame = this.frame;
        if (!frame) {
            frame_common_1.traceError(fragment + ".onCreateView: this.frame is null or undefined");
            return null;
        }
        if (page.parent === frame) {
            if (!page._context) {
                var context_2 = container && container.getContext() || inflater && inflater.getContext();
                page._setupUI(context_2);
            }
        }
        else {
            if (!frame._styleScope) {
                page._updateStyleScope();
            }
            frame._addView(page);
        }
        if (frame.isLoaded && !page.isLoaded) {
            page.callLoaded();
        }
        var savedState = entry.viewSavedState;
        if (savedState) {
            page.nativeViewProtected.restoreHierarchyState(savedState);
            entry.viewSavedState = null;
        }
        var nativeView = page.nativeViewProtected;
        if (nativeView != null) {
            var parentView = nativeView.getParent();
            if (parentView instanceof android.view.ViewGroup) {
                if (parentView.getChildCount() === 0) {
                    parentView.addViewInLayout(nativeView, -1, new org.nativescript.widgets.CommonLayoutParams());
                }
                parentView.removeAllViews();
            }
        }
        return page.nativeViewProtected;
    };
    FragmentCallbacksImplementation.prototype.onSaveInstanceState = function (fragment, outState, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onSaveInstanceState(" + outState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment, outState);
    };
    FragmentCallbacksImplementation.prototype.onDestroyView = function (fragment, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onDestroyView()", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment);
    };
    FragmentCallbacksImplementation.prototype.onDestroy = function (fragment, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(fragment + ".onDestroy()", frame_common_1.traceCategories.NativeLifecycle);
        }
        superFunc.call(fragment);
        var entry = this.entry;
        if (!entry) {
            frame_common_1.traceError(fragment + ".onDestroy: entry is null or undefined");
            return null;
        }
        entry.fragment = null;
        var page = entry.resolvedPage;
        if (!page) {
            frame_common_1.traceError(fragment + ".onDestroy: entry has no resolvedPage");
            return null;
        }
    };
    FragmentCallbacksImplementation.prototype.onStop = function (fragment, superFunc) {
        superFunc.call(fragment);
    };
    FragmentCallbacksImplementation.prototype.toStringOverride = function (fragment, superFunc) {
        var entry = this.entry;
        if (entry) {
            return entry.fragmentTag + "<" + entry.resolvedPage + ">";
        }
        else {
            return "NO ENTRY, " + superFunc.call(fragment);
        }
    };
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onHiddenChanged", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreateAnimator", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreate", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onCreateView", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onSaveInstanceState", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onDestroyView", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onDestroy", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "onStop", null);
    __decorate([
        profiling_1.profile
    ], FragmentCallbacksImplementation.prototype, "toStringOverride", null);
    return FragmentCallbacksImplementation;
}());
var ActivityCallbacksImplementation = (function () {
    function ActivityCallbacksImplementation() {
    }
    ActivityCallbacksImplementation.prototype.getRootView = function () {
        return this._rootView;
    };
    ActivityCallbacksImplementation.prototype.onCreate = function (activity, savedInstanceState, intentOrSuperFunc, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("Activity.onCreate(" + savedInstanceState + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        var intent = superFunc ? intentOrSuperFunc : undefined;
        if (!superFunc) {
            console.log("AndroidActivityCallbacks.onCreate(activity: any, savedInstanceState: any, superFunc: Function) " +
                "is deprecated. Use AndroidActivityCallbacks.onCreate(activity: any, savedInstanceState: any, intent: any, superFunc: Function) instead.");
            superFunc = intentOrSuperFunc;
        }
        var isRestart = !!savedInstanceState && exports.moduleLoaded;
        superFunc.call(activity, isRestart ? savedInstanceState : null);
        if (savedInstanceState) {
            var rootViewId = savedInstanceState.getInt(ROOT_VIEW_ID_EXTRA, -1);
            if (rootViewId !== -1 && activityRootViewsMap.has(rootViewId)) {
                this._rootView = activityRootViewsMap.get(rootViewId).get();
            }
        }
        if (intent && intent.getAction()) {
            application.android.notify({
                eventName: application.AndroidApplication.activityNewIntentEvent,
                object: application.android,
                activity: activity,
                intent: intent
            });
        }
        this.setActivityContent(activity, savedInstanceState, true);
        exports.moduleLoaded = true;
    };
    ActivityCallbacksImplementation.prototype.onSaveInstanceState = function (activity, outState, superFunc) {
        superFunc.call(activity, outState);
        var rootView = this._rootView;
        if (rootView instanceof Frame) {
            outState.putInt(INTENT_EXTRA, rootView.android.frameId);
            rootView._saveFragmentsState();
        }
        outState.putInt(ROOT_VIEW_ID_EXTRA, rootView._domId);
    };
    ActivityCallbacksImplementation.prototype.onNewIntent = function (activity, intent, superSetIntentFunc, superFunc) {
        superFunc.call(activity, intent);
        superSetIntentFunc.call(activity, intent);
        application.android.notify({
            eventName: application.AndroidApplication.activityNewIntentEvent,
            object: application.android,
            activity: activity,
            intent: intent
        });
    };
    ActivityCallbacksImplementation.prototype.onStart = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onStart();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView && !rootView.isLoaded) {
            rootView.callLoaded();
        }
    };
    ActivityCallbacksImplementation.prototype.onStop = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onStop();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    ActivityCallbacksImplementation.prototype.onPostResume = function (activity, superFunc) {
        superFunc.call(activity);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onPostResume();", frame_common_1.traceCategories.NativeLifecycle);
        }
        if (activity.isNativeScriptActivity) {
            var args = {
                eventName: application.resumeEvent,
                object: application.android,
                android: activity
            };
            application.notify(args);
            application.android.paused = false;
        }
    };
    ActivityCallbacksImplementation.prototype.onDestroy = function (activity, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onDestroy();", frame_common_1.traceCategories.NativeLifecycle);
        }
        var rootView = this._rootView;
        if (rootView) {
            rootView._tearDownUI(true);
        }
        var exitArgs = { eventName: application.exitEvent, object: application.android, android: activity };
        application.notify(exitArgs);
        superFunc.call(activity);
    };
    ActivityCallbacksImplementation.prototype.onBackPressed = function (activity, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onBackPressed;", frame_common_1.traceCategories.NativeLifecycle);
        }
        var args = {
            eventName: "activityBackPressed",
            object: application.android,
            activity: activity,
            cancel: false,
        };
        application.android.notify(args);
        if (args.cancel) {
            return;
        }
        var view = this._rootView;
        var callSuper = false;
        if (view instanceof Frame) {
            callSuper = !frame_common_1.goBack();
        }
        else {
            var viewArgs = {
                eventName: "activityBackPressed",
                object: view,
                activity: activity,
                cancel: false,
            };
            view.notify(viewArgs);
            if (!viewArgs.cancel && !view.onBackPressed()) {
                callSuper = true;
            }
        }
        if (callSuper) {
            superFunc.call(activity);
        }
    };
    ActivityCallbacksImplementation.prototype.onRequestPermissionsResult = function (activity, requestCode, permissions, grantResults, superFunc) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onRequestPermissionsResult;", frame_common_1.traceCategories.NativeLifecycle);
        }
        application.android.notify({
            eventName: "activityRequestPermissions",
            object: application.android,
            activity: activity,
            requestCode: requestCode,
            permissions: permissions,
            grantResults: grantResults
        });
    };
    ActivityCallbacksImplementation.prototype.onActivityResult = function (activity, requestCode, resultCode, data, superFunc) {
        superFunc.call(activity, requestCode, resultCode, data);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("NativeScriptActivity.onActivityResult(" + requestCode + ", " + resultCode + ", " + data + ")", frame_common_1.traceCategories.NativeLifecycle);
        }
        application.android.notify({
            eventName: "activityResult",
            object: application.android,
            activity: activity,
            requestCode: requestCode,
            resultCode: resultCode,
            intent: data
        });
    };
    ActivityCallbacksImplementation.prototype.resetActivityContent = function (activity) {
        if (this._rootView) {
            var manager = this._rootView._getFragmentManager();
            manager.executePendingTransactions();
            this._rootView._onRootViewReset();
        }
        this._rootView = null;
        this.setActivityContent(activity, null, false);
        this._rootView.callLoaded();
    };
    ActivityCallbacksImplementation.prototype.setActivityContent = function (activity, savedInstanceState, fireLaunchEvent) {
        var _this = this;
        var shouldCreateRootFrame = application._shouldCreateRootFrame();
        var rootView = this._rootView;
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("Frame.setActivityContent rootView: " + rootView + " shouldCreateRootFrame: " + shouldCreateRootFrame + " fireLaunchEvent: " + fireLaunchEvent, frame_common_1.traceCategories.NativeLifecycle);
        }
        if (!rootView) {
            var mainEntry = application.getMainEntry();
            var intent = activity.getIntent();
            if (fireLaunchEvent) {
                rootView = notifyLaunch(intent, savedInstanceState);
            }
            if (!rootView) {
                if (!mainEntry) {
                    throw new Error("Main entry is missing. App cannot be started. Verify app bootstrap.");
                }
                if (shouldCreateRootFrame) {
                    var extras = intent.getExtras();
                    var frameId = -1;
                    if (extras) {
                        frameId = extras.getInt(INTENT_EXTRA, -1);
                    }
                    if (savedInstanceState && frameId < 0) {
                        frameId = savedInstanceState.getInt(INTENT_EXTRA, -1);
                    }
                    if (!rootView) {
                        rootView = getFrameByNumberId(frameId) || new Frame();
                    }
                    if (rootView instanceof Frame) {
                        rootView.navigate(mainEntry);
                    }
                    else {
                        throw new Error("A Frame must be used to navigate to a Page.");
                    }
                }
                else {
                    rootView = builder_1.createViewFromEntry(mainEntry);
                }
            }
            this._rootView = rootView;
            activityRootViewsMap.set(rootView._domId, new WeakRef(rootView));
            var deviceType = platform_1.device.deviceType.toLowerCase();
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + ANDROID_PLATFORM);
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + deviceType);
            system_classes_1.pushToRootViewCssClasses("" + system_classes_1.CLASS_PREFIX + application.android.orientation);
            var rootViewCssClasses = system_classes_1.getRootViewCssClasses();
            rootViewCssClasses.forEach(function (c) { return _this._rootView.cssClasses.add(c); });
        }
        if (shouldCreateRootFrame) {
            rootView._setupUI(activity);
        }
        else {
            rootView._setupAsRootView(activity);
        }
        activity.setContentView(rootView.nativeViewProtected, new org.nativescript.widgets.CommonLayoutParams());
    };
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onCreate", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onSaveInstanceState", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onNewIntent", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onStart", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onStop", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onPostResume", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onDestroy", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onBackPressed", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onRequestPermissionsResult", null);
    __decorate([
        profiling_1.profile
    ], ActivityCallbacksImplementation.prototype, "onActivityResult", null);
    return ActivityCallbacksImplementation;
}());
var notifyLaunch = profiling_1.profile("notifyLaunch", function notifyLaunch(intent, savedInstanceState) {
    var launchArgs = {
        eventName: application.launchEvent,
        object: application.android,
        android: intent, savedInstanceState: savedInstanceState
    };
    application.notify(launchArgs);
    application.notify({ eventName: "loadAppCss", object: this, cssFile: application.getCssFileName() });
    return launchArgs.root;
});
function setActivityCallbacks(activity) {
    activity[CALLBACKS] = new ActivityCallbacksImplementation();
}
exports.setActivityCallbacks = setActivityCallbacks;
function setFragmentCallbacks(fragment) {
    fragment[CALLBACKS] = new FragmentCallbacksImplementation();
}
exports.setFragmentCallbacks = setFragmentCallbacks;
//# sourceMappingURL=frame.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures-common.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var GestureTypes;
(function (GestureTypes) {
    GestureTypes[GestureTypes["tap"] = 1] = "tap";
    GestureTypes[GestureTypes["doubleTap"] = 2] = "doubleTap";
    GestureTypes[GestureTypes["pinch"] = 4] = "pinch";
    GestureTypes[GestureTypes["pan"] = 8] = "pan";
    GestureTypes[GestureTypes["swipe"] = 16] = "swipe";
    GestureTypes[GestureTypes["rotation"] = 32] = "rotation";
    GestureTypes[GestureTypes["longPress"] = 64] = "longPress";
    GestureTypes[GestureTypes["touch"] = 128] = "touch";
})(GestureTypes = exports.GestureTypes || (exports.GestureTypes = {}));
var GestureStateTypes;
(function (GestureStateTypes) {
    GestureStateTypes[GestureStateTypes["cancelled"] = 0] = "cancelled";
    GestureStateTypes[GestureStateTypes["began"] = 1] = "began";
    GestureStateTypes[GestureStateTypes["changed"] = 2] = "changed";
    GestureStateTypes[GestureStateTypes["ended"] = 3] = "ended";
})(GestureStateTypes = exports.GestureStateTypes || (exports.GestureStateTypes = {}));
var SwipeDirection;
(function (SwipeDirection) {
    SwipeDirection[SwipeDirection["right"] = 1] = "right";
    SwipeDirection[SwipeDirection["left"] = 2] = "left";
    SwipeDirection[SwipeDirection["up"] = 4] = "up";
    SwipeDirection[SwipeDirection["down"] = 8] = "down";
})(SwipeDirection = exports.SwipeDirection || (exports.SwipeDirection = {}));
var TouchAction;
(function (TouchAction) {
    TouchAction.down = "down";
    TouchAction.up = "up";
    TouchAction.move = "move";
    TouchAction.cancel = "cancel";
})(TouchAction = exports.TouchAction || (exports.TouchAction = {}));
function toString(type, separator) {
    var types = new Array();
    if (type & GestureTypes.tap) {
        types.push("tap");
    }
    if (type & GestureTypes.doubleTap) {
        types.push("doubleTap");
    }
    if (type & GestureTypes.pinch) {
        types.push("pinch");
    }
    if (type & GestureTypes.pan) {
        types.push("pan");
    }
    if (type & GestureTypes.swipe) {
        types.push("swipe");
    }
    if (type & GestureTypes.rotation) {
        types.push("rotation");
    }
    if (type & GestureTypes.longPress) {
        types.push("longPress");
    }
    if (type & GestureTypes.touch) {
        types.push("touch");
    }
    return types.join(separator);
}
exports.toString = toString;
function fromString(type) {
    var t = type.trim().toLowerCase();
    if (t === "tap") {
        return GestureTypes.tap;
    }
    else if (t === "doubletap") {
        return GestureTypes.doubleTap;
    }
    else if (t === "pinch") {
        return GestureTypes.pinch;
    }
    else if (t === "pan") {
        return GestureTypes.pan;
    }
    else if (t === "swipe") {
        return GestureTypes.swipe;
    }
    else if (t === "rotation") {
        return GestureTypes.rotation;
    }
    else if (t === "longpress") {
        return GestureTypes.longPress;
    }
    else if (t === "touch") {
        return GestureTypes.touch;
    }
    return undefined;
}
exports.fromString = fromString;
var GesturesObserverBase = (function () {
    function GesturesObserverBase(target, callback, context) {
        this._target = target;
        this._callback = callback;
        this._context = context;
    }
    Object.defineProperty(GesturesObserverBase.prototype, "callback", {
        get: function () {
            return this._callback;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "target", {
        get: function () {
            return this._target;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "context", {
        get: function () {
            return this._context;
        },
        enumerable: true,
        configurable: true
    });
    GesturesObserverBase.prototype.disconnect = function () {
        if (this.target) {
            var list = this.target.getGestureObservers(this.type);
            if (list && list.length > 0) {
                for (var i = 0; i < list.length; i++) {
                    if (list[i].callback === this.callback) {
                        break;
                    }
                }
                list.length = 0;
                this.target._gestureObservers[this.type] = undefined;
                delete this.target._gestureObservers[this.type];
            }
        }
        this._target = null;
        this._callback = null;
        this._context = null;
    };
    return GesturesObserverBase;
}());
exports.GesturesObserverBase = GesturesObserverBase;
//# sourceMappingURL=gestures-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var gestures_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var timer = __webpack_require__("../node_modules/tns-core-modules/timer/timer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js"));
var TapAndDoubleTapGestureListener;
function initializeTapAndDoubleTapGestureListener() {
    if (TapAndDoubleTapGestureListener) {
        return;
    }
    var TapAndDoubleTapGestureListenerImpl = (function (_super) {
        __extends(TapAndDoubleTapGestureListenerImpl, _super);
        function TapAndDoubleTapGestureListenerImpl(observer, target, type) {
            var _this = _super.call(this) || this;
            _this._lastUpTime = 0;
            _this._observer = observer;
            _this._target = target;
            _this._type = type;
            return global.__native(_this);
        }
        TapAndDoubleTapGestureListenerImpl.prototype.onSingleTapUp = function (motionEvent) {
            this._handleSingleTap(motionEvent);
            this._lastUpTime = Date.now();
            return true;
        };
        TapAndDoubleTapGestureListenerImpl.prototype.onDown = function (motionEvent) {
            var tapTime = Date.now();
            if ((tapTime - this._lastUpTime) <= TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout) {
                this._handleDoubleTap(motionEvent);
            }
            return true;
        };
        TapAndDoubleTapGestureListenerImpl.prototype.onLongPress = function (motionEvent) {
            if (this._type & gestures_common_1.GestureTypes.longPress) {
                var args = _getArgs(gestures_common_1.GestureTypes.longPress, this._target, motionEvent);
                _executeCallback(this._observer, args);
            }
        };
        TapAndDoubleTapGestureListenerImpl.prototype._handleSingleTap = function (motionEvent) {
            var _this = this;
            if (this._target.getGestureObservers(gestures_common_1.GestureTypes.doubleTap)) {
                this._tapTimeoutId = timer.setTimeout(function () {
                    if (_this._type & gestures_common_1.GestureTypes.tap) {
                        var args = _getArgs(gestures_common_1.GestureTypes.tap, _this._target, motionEvent);
                        _executeCallback(_this._observer, args);
                    }
                    timer.clearTimeout(_this._tapTimeoutId);
                }, TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout);
            }
            else {
                if (this._type & gestures_common_1.GestureTypes.tap) {
                    var args = _getArgs(gestures_common_1.GestureTypes.tap, this._target, motionEvent);
                    _executeCallback(this._observer, args);
                }
            }
        };
        TapAndDoubleTapGestureListenerImpl.prototype._handleDoubleTap = function (motionEvent) {
            if (this._tapTimeoutId) {
                timer.clearTimeout(this._tapTimeoutId);
            }
            if (this._type & gestures_common_1.GestureTypes.doubleTap) {
                var args = _getArgs(gestures_common_1.GestureTypes.doubleTap, this._target, motionEvent);
                _executeCallback(this._observer, args);
            }
        };
        TapAndDoubleTapGestureListenerImpl.DoubleTapTimeout = android.view.ViewConfiguration.getDoubleTapTimeout();
        return TapAndDoubleTapGestureListenerImpl;
    }(android.view.GestureDetector.SimpleOnGestureListener));
    TapAndDoubleTapGestureListener = TapAndDoubleTapGestureListenerImpl;
}
var PinchGestureListener;
function initializePinchGestureListener() {
    if (PinchGestureListener) {
        return;
    }
    var PinchGestureListenerImpl = (function (_super) {
        __extends(PinchGestureListenerImpl, _super);
        function PinchGestureListenerImpl(observer, target) {
            var _this = _super.call(this) || this;
            _this._observer = observer;
            _this._target = target;
            return global.__native(_this);
        }
        PinchGestureListenerImpl.prototype.onScaleBegin = function (detector) {
            this._scale = detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.began);
            _executeCallback(this._observer, args);
            return true;
        };
        PinchGestureListenerImpl.prototype.onScale = function (detector) {
            this._scale *= detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.changed);
            _executeCallback(this._observer, args);
            return true;
        };
        PinchGestureListenerImpl.prototype.onScaleEnd = function (detector) {
            this._scale *= detector.getScaleFactor();
            var args = new PinchGestureEventData(this._target, detector, this._scale, this._target, gestures_common_1.GestureStateTypes.ended);
            _executeCallback(this._observer, args);
        };
        return PinchGestureListenerImpl;
    }(android.view.ScaleGestureDetector.SimpleOnScaleGestureListener));
    PinchGestureListener = PinchGestureListenerImpl;
}
var SwipeGestureListener;
function initializeSwipeGestureListener() {
    if (SwipeGestureListener) {
        return;
    }
    var SwipeGestureListenerImpl = (function (_super) {
        __extends(SwipeGestureListenerImpl, _super);
        function SwipeGestureListenerImpl(observer, target) {
            var _this = _super.call(this) || this;
            _this._observer = observer;
            _this._target = target;
            return global.__native(_this);
        }
        SwipeGestureListenerImpl.prototype.onDown = function (motionEvent) {
            return true;
        };
        SwipeGestureListenerImpl.prototype.onFling = function (initialEvent, currentEvent, velocityX, velocityY) {
            var result = false;
            var args;
            try {
                var deltaY = currentEvent.getY() - initialEvent.getY();
                var deltaX = currentEvent.getX() - initialEvent.getX();
                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    if (Math.abs(deltaX) > SWIPE_THRESHOLD
                        && Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
                        if (deltaX > 0) {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.right, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                        else {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.left, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                    }
                }
                else {
                    if (Math.abs(deltaY) > SWIPE_THRESHOLD
                        && Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
                        if (deltaY > 0) {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.down, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                        else {
                            args = _getSwipeArgs(gestures_common_1.SwipeDirection.up, this._target, initialEvent, currentEvent);
                            _executeCallback(this._observer, args);
                            result = true;
                        }
                    }
                }
            }
            catch (ex) {
            }
            return result;
        };
        return SwipeGestureListenerImpl;
    }(android.view.GestureDetector.SimpleOnGestureListener));
    SwipeGestureListener = SwipeGestureListenerImpl;
}
var SWIPE_THRESHOLD = 100;
var SWIPE_VELOCITY_THRESHOLD = 100;
var INVALID_POINTER_ID = -1;
var TO_DEGREES = (180 / Math.PI);
function observe(target, type, callback, context) {
    var observer = new GesturesObserver(target, callback, context);
    observer.observe(type);
    return observer;
}
exports.observe = observe;
var GesturesObserver = (function (_super) {
    __extends(GesturesObserver, _super);
    function GesturesObserver() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GesturesObserver.prototype.observe = function (type) {
        var _this = this;
        if (this.target) {
            this.type = type;
            this._onTargetLoaded = function (args) {
                _this._attach(_this.target, type);
            };
            this._onTargetUnloaded = function (args) {
                _this._detach();
            };
            this.target.on("loaded", this._onTargetLoaded);
            this.target.on("unloaded", this._onTargetUnloaded);
            if (this.target.isLoaded) {
                this._attach(this.target, type);
            }
        }
    };
    GesturesObserver.prototype.disconnect = function () {
        this._detach();
        if (this.target) {
            this.target.off("loaded", this._onTargetLoaded);
            this.target.off("unloaded", this._onTargetUnloaded);
            this._onTargetLoaded = null;
            this._onTargetUnloaded = null;
        }
        _super.prototype.disconnect.call(this);
    };
    GesturesObserver.prototype._detach = function () {
        this._notifyTouch = false;
        this._simpleGestureDetector = null;
        this._scaleGestureDetector = null;
        this._swipeGestureDetector = null;
        this._panGestureDetector = null;
        this._rotateGestureDetector = null;
        this._eventData = null;
    };
    GesturesObserver.prototype._attach = function (target, type) {
        this._detach();
        if ((type & gestures_common_1.GestureTypes.tap) || (type & gestures_common_1.GestureTypes.doubleTap) || (type & gestures_common_1.GestureTypes.longPress)) {
            initializeTapAndDoubleTapGestureListener();
            this._simpleGestureDetector = new androidx.core.view.GestureDetectorCompat(target._context, new TapAndDoubleTapGestureListener(this, this.target, type));
        }
        if (type & gestures_common_1.GestureTypes.pinch) {
            initializePinchGestureListener();
            this._scaleGestureDetector = new android.view.ScaleGestureDetector(target._context, new PinchGestureListener(this, this.target));
        }
        if (type & gestures_common_1.GestureTypes.swipe) {
            initializeSwipeGestureListener();
            this._swipeGestureDetector = new androidx.core.view.GestureDetectorCompat(target._context, new SwipeGestureListener(this, this.target));
        }
        if (type & gestures_common_1.GestureTypes.pan) {
            this._panGestureDetector = new CustomPanGestureDetector(this, this.target);
        }
        if (type & gestures_common_1.GestureTypes.rotation) {
            this._rotateGestureDetector = new CustomRotateGestureDetector(this, this.target);
        }
        if (type & gestures_common_1.GestureTypes.touch) {
            this._notifyTouch = true;
        }
    };
    GesturesObserver.prototype.androidOnTouchEvent = function (motionEvent) {
        if (this._notifyTouch) {
            if (!this._eventData) {
                this._eventData = new TouchGestureEventData();
            }
            this._eventData.prepare(this.target, motionEvent);
            _executeCallback(this, this._eventData);
        }
        if (this._simpleGestureDetector) {
            this._simpleGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._scaleGestureDetector) {
            this._scaleGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._swipeGestureDetector) {
            this._swipeGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._panGestureDetector) {
            this._panGestureDetector.onTouchEvent(motionEvent);
        }
        if (this._rotateGestureDetector) {
            this._rotateGestureDetector.onTouchEvent(motionEvent);
        }
    };
    return GesturesObserver;
}(gestures_common_1.GesturesObserverBase));
exports.GesturesObserver = GesturesObserver;
function _getArgs(type, view, e) {
    return {
        type: type,
        view: view,
        android: e,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(type),
    };
}
function _getSwipeArgs(direction, view, initialEvent, currentEvent) {
    return {
        type: gestures_common_1.GestureTypes.swipe,
        view: view,
        android: { initial: initialEvent, current: currentEvent },
        direction: direction,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.swipe),
    };
}
function _getPanArgs(deltaX, deltaY, view, state, initialEvent, currentEvent) {
    return {
        type: gestures_common_1.GestureTypes.pan,
        view: view,
        android: { initial: initialEvent, current: currentEvent },
        deltaX: deltaX,
        deltaY: deltaY,
        ios: undefined,
        object: view,
        eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.pan),
        state: state
    };
}
function _executeCallback(observer, args) {
    if (observer && observer.callback) {
        observer.callback.call(observer._context, args);
    }
}
var PinchGestureEventData = (function () {
    function PinchGestureEventData(view, android, scale, object, state) {
        this.view = view;
        this.android = android;
        this.scale = scale;
        this.object = object;
        this.state = state;
        this.type = gestures_common_1.GestureTypes.pinch;
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.pinch);
    }
    PinchGestureEventData.prototype.getFocusX = function () {
        return this.android.getFocusX() / utils_1.layout.getDisplayDensity();
    };
    PinchGestureEventData.prototype.getFocusY = function () {
        return this.android.getFocusY() / utils_1.layout.getDisplayDensity();
    };
    return PinchGestureEventData;
}());
var CustomPanGestureDetector = (function () {
    function CustomPanGestureDetector(observer, target) {
        this.observer = observer;
        this.target = target;
        this.isTracking = false;
        this.density = utils_1.layout.getDisplayDensity();
    }
    CustomPanGestureDetector.prototype.onTouchEvent = function (event) {
        switch (event.getActionMasked()) {
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_CANCEL:
                this.trackStop(event, false);
                break;
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                this.trackStop(event, true);
                break;
            case android.view.MotionEvent.ACTION_MOVE:
                if (!this.isTracking) {
                    this.trackStart(event);
                }
                this.trackChange(event);
                break;
        }
        return true;
    };
    CustomPanGestureDetector.prototype.trackStop = function (currentEvent, cacheEvent) {
        if (this.isTracking) {
            var args = _getPanArgs(this.deltaX, this.deltaY, this.target, gestures_common_1.GestureStateTypes.ended, null, currentEvent);
            _executeCallback(this.observer, args);
            this.deltaX = undefined;
            this.deltaY = undefined;
            this.isTracking = false;
        }
        if (cacheEvent) {
            this.lastEventCache = currentEvent;
        }
        else {
            this.lastEventCache = undefined;
        }
    };
    CustomPanGestureDetector.prototype.trackStart = function (currentEvent) {
        var inital = this.getEventCoordinates(this.lastEventCache ? this.lastEventCache : currentEvent);
        this.initialX = inital.x;
        this.initialY = inital.y;
        this.isTracking = true;
        var args = _getPanArgs(0, 0, this.target, gestures_common_1.GestureStateTypes.began, null, currentEvent);
        _executeCallback(this.observer, args);
    };
    CustomPanGestureDetector.prototype.trackChange = function (currentEvent) {
        var current = this.getEventCoordinates(currentEvent);
        this.deltaX = current.x - this.initialX;
        this.deltaY = current.y - this.initialY;
        var args = _getPanArgs(this.deltaX, this.deltaY, this.target, gestures_common_1.GestureStateTypes.changed, null, currentEvent);
        _executeCallback(this.observer, args);
    };
    CustomPanGestureDetector.prototype.getEventCoordinates = function (event) {
        var count = event.getPointerCount();
        if (count === 1) {
            return {
                x: event.getRawX() / this.density,
                y: event.getRawY() / this.density
            };
        }
        else {
            var offX = event.getRawX() - event.getX();
            var offY = event.getRawY() - event.getY();
            var res = { x: 0, y: 0 };
            for (var i = 0; i < count; i++) {
                res.x += event.getX(i) + offX;
                res.y += event.getY(i) + offY;
            }
            res.x /= (count * this.density);
            res.y /= (count * this.density);
            return res;
        }
    };
    return CustomPanGestureDetector;
}());
var CustomRotateGestureDetector = (function () {
    function CustomRotateGestureDetector(observer, target) {
        this.observer = observer;
        this.target = target;
        this.trackedPtrId1 = INVALID_POINTER_ID;
        this.trackedPtrId2 = INVALID_POINTER_ID;
    }
    Object.defineProperty(CustomRotateGestureDetector.prototype, "isTracking", {
        get: function () {
            return this.trackedPtrId1 !== INVALID_POINTER_ID && this.trackedPtrId2 !== INVALID_POINTER_ID;
        },
        enumerable: true,
        configurable: true
    });
    CustomRotateGestureDetector.prototype.onTouchEvent = function (event) {
        var pointerID = event.getPointerId(event.getActionIndex());
        var wasTracking = this.isTracking;
        switch (event.getActionMasked()) {
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
                var assigned = false;
                if (this.trackedPtrId1 === INVALID_POINTER_ID && pointerID !== this.trackedPtrId2) {
                    this.trackedPtrId1 = pointerID;
                    assigned = true;
                }
                else if (this.trackedPtrId2 === INVALID_POINTER_ID && pointerID !== this.trackedPtrId1) {
                    this.trackedPtrId2 = pointerID;
                    assigned = true;
                }
                if (assigned && this.isTracking) {
                    this.angle = 0;
                    this.initalPointersAngle = this.getPointersAngle(event);
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.began);
                }
                break;
            case android.view.MotionEvent.ACTION_MOVE:
                if (this.isTracking) {
                    this.updateAngle(event);
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.changed);
                }
                break;
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                if (pointerID === this.trackedPtrId1) {
                    this.trackedPtrId1 = INVALID_POINTER_ID;
                }
                else if (pointerID === this.trackedPtrId2) {
                    this.trackedPtrId2 = INVALID_POINTER_ID;
                }
                if (wasTracking && !this.isTracking) {
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.ended);
                }
                break;
            case android.view.MotionEvent.ACTION_CANCEL:
                this.trackedPtrId1 = INVALID_POINTER_ID;
                this.trackedPtrId2 = INVALID_POINTER_ID;
                if (wasTracking) {
                    this.executeCallback(event, gestures_common_1.GestureStateTypes.cancelled);
                }
                break;
        }
        return true;
    };
    CustomRotateGestureDetector.prototype.executeCallback = function (event, state) {
        var args = {
            type: gestures_common_1.GestureTypes.rotation,
            view: this.target,
            android: event,
            rotation: this.angle,
            ios: undefined,
            object: this.target,
            eventName: gestures_common_1.toString(gestures_common_1.GestureTypes.rotation),
            state: state
        };
        _executeCallback(this.observer, args);
    };
    CustomRotateGestureDetector.prototype.updateAngle = function (event) {
        var newPointersAngle = this.getPointersAngle(event);
        var result = ((newPointersAngle - this.initalPointersAngle) * TO_DEGREES) % 360;
        if (result < -180) {
            result += 360;
        }
        if (result > 180) {
            result -= 360;
        }
        this.angle = result;
    };
    CustomRotateGestureDetector.prototype.getPointersAngle = function (event) {
        var firstX = event.getX(event.findPointerIndex(this.trackedPtrId1));
        var firstY = event.getY(event.findPointerIndex(this.trackedPtrId1));
        var secondX = event.getX(event.findPointerIndex(this.trackedPtrId2));
        var secondY = event.getY(event.findPointerIndex(this.trackedPtrId2));
        return Math.atan2((secondY - firstY), (secondX - firstX));
    };
    return CustomRotateGestureDetector;
}());
var Pointer = (function () {
    function Pointer(id, event) {
        this.event = event;
        this.ios = undefined;
        this.android = id;
    }
    Pointer.prototype.getX = function () {
        return this.event.getX(this.android) / utils_1.layout.getDisplayDensity();
    };
    Pointer.prototype.getY = function () {
        return this.event.getY(this.android) / utils_1.layout.getDisplayDensity();
    };
    return Pointer;
}());
var TouchGestureEventData = (function () {
    function TouchGestureEventData() {
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.touch);
        this.type = gestures_common_1.GestureTypes.touch;
        this.ios = undefined;
    }
    TouchGestureEventData.prototype.prepare = function (view, e) {
        this.view = view;
        this.object = view;
        this.android = e;
        this.action = this.getActionType(e);
        this._activePointers = undefined;
        this._allPointers = undefined;
    };
    TouchGestureEventData.prototype.getPointerCount = function () {
        return this.android.getPointerCount();
    };
    TouchGestureEventData.prototype.getActivePointers = function () {
        if (!this._activePointers) {
            this._activePointers = [new Pointer(this.android.getActionIndex(), this.android)];
        }
        return this._activePointers;
    };
    TouchGestureEventData.prototype.getAllPointers = function () {
        if (!this._allPointers) {
            this._allPointers = [];
            for (var i = 0; i < this.getPointerCount(); i++) {
                this._allPointers.push(new Pointer(i, this.android));
            }
        }
        return this._allPointers;
    };
    TouchGestureEventData.prototype.getX = function () {
        return this.getActivePointers()[0].getX();
    };
    TouchGestureEventData.prototype.getY = function () {
        return this.getActivePointers()[0].getY();
    };
    TouchGestureEventData.prototype.getActionType = function (e) {
        switch (e.getActionMasked()) {
            case android.view.MotionEvent.ACTION_DOWN:
            case android.view.MotionEvent.ACTION_POINTER_DOWN:
                return gestures_common_1.TouchAction.down;
            case android.view.MotionEvent.ACTION_MOVE:
                return gestures_common_1.TouchAction.move;
            case android.view.MotionEvent.ACTION_UP:
            case android.view.MotionEvent.ACTION_POINTER_UP:
                return gestures_common_1.TouchAction.up;
            case android.view.MotionEvent.ACTION_CANCEL:
                return gestures_common_1.TouchAction.cancel;
        }
        return "";
    };
    return TouchGestureEventData;
}());
//# sourceMappingURL=gestures.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var HtmlViewBase = (function (_super) {
    __extends(HtmlViewBase, _super);
    function HtmlViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlViewBase = __decorate([
        view_1.CSSType("HtmlView")
    ], HtmlViewBase);
    return HtmlViewBase;
}(view_1.View));
exports.HtmlViewBase = HtmlViewBase;
HtmlViewBase.prototype.recycleNativeView = "auto";
exports.htmlProperty = new view_1.Property({ name: "html", defaultValue: "", affectsLayout: true });
exports.htmlProperty.register(HtmlViewBase);
//# sourceMappingURL=html-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var html_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js"));
var HtmlView = (function (_super) {
    __extends(HtmlView, _super);
    function HtmlView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlView.prototype.createNativeView = function () {
        return new android.widget.TextView(this._context);
    };
    HtmlView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.setLinksClickable(true);
        nativeView.setMovementMethod(android.text.method.LinkMovementMethod.getInstance());
    };
    HtmlView.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.setAutoLinkMask(0);
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.getDefault] = function () {
        return "";
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.setNative] = function (value) {
        var mask = 15;
        if (value.search(/<a\s/i) >= 0) {
            mask = 0;
        }
        this.nativeViewProtected.setAutoLinkMask(mask);
        this.nativeViewProtected.setText(android.text.Html.fromHtml(value));
    };
    return HtmlView;
}(html_view_common_1.HtmlViewBase));
exports.HtmlView = HtmlView;
//# sourceMappingURL=html-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var image_asset_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset.js");
exports.ImageAsset = image_asset_1.ImageAsset;
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
exports.ImageSource = image_source_1.ImageSource;
exports.fromAsset = image_source_1.fromAsset;
exports.fromNativeSource = image_source_1.fromNativeSource;
exports.fromUrl = image_source_1.fromUrl;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isDataURI = utils_1.isDataURI;
exports.isFontIconURI = utils_1.isFontIconURI;
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
exports.RESOURCE_PREFIX = utils_1.RESOURCE_PREFIX;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ImageBase = (function (_super) {
    __extends(ImageBase, _super);
    function ImageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ImageBase.prototype, "tintColor", {
        get: function () {
            return this.style.tintColor;
        },
        set: function (value) {
            this.style.tintColor = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageBase.prototype._createImageSourceFromSrc = function (value) {
        var _this = this;
        var originalValue = value;
        var sync = this.loadMode === "sync";
        if (typeof value === "string" || value instanceof String) {
            value = value.trim();
            this.imageSource = null;
            this["_url"] = value;
            this.isLoading = true;
            var source_1 = new image_source_1.ImageSource();
            var imageLoaded = function () {
                var currentValue = _this.src;
                if (currentValue !== originalValue) {
                    return;
                }
                _this.imageSource = source_1;
                _this.isLoading = false;
            };
            if (utils_1.isFontIconURI(value)) {
                var fontIconCode = value.split("//")[1];
                if (fontIconCode !== undefined) {
                    var font = this.style.fontInternal;
                    var color = this.style.color;
                    source_1.loadFromFontIconCode(fontIconCode, font, color);
                    imageLoaded();
                }
            }
            else if (utils_1.isDataURI(value)) {
                var base64Data = value.split(",")[1];
                if (base64Data !== undefined) {
                    if (sync) {
                        source_1.loadFromBase64(base64Data);
                        imageLoaded();
                    }
                    else {
                        source_1.fromBase64(base64Data).then(imageLoaded);
                    }
                }
            }
            else if (utils_1.isFileOrResourcePath(value)) {
                if (value.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
                    var resPath = value.substr(utils_1.RESOURCE_PREFIX.length);
                    if (sync) {
                        source_1.loadFromResource(resPath);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromResource(resPath).then(imageLoaded);
                    }
                }
                else {
                    if (sync) {
                        source_1.loadFromFile(value);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromFile(value).then(imageLoaded);
                    }
                }
            }
            else {
                this.imageSource = null;
                image_source_1.fromUrl(value).then(function (r) {
                    if (_this["_url"] === value) {
                        _this.imageSource = r;
                        _this.isLoading = false;
                    }
                }, function (err) {
                    _this.isLoading = false;
                    if (view_1.traceEnabled()) {
                        if (typeof err === "object" && err.message) {
                            err = err.message;
                        }
                        view_1.traceWrite(err, view_1.traceCategories.Debug);
                    }
                });
            }
        }
        else if (value instanceof image_source_1.ImageSource) {
            this.imageSource = value;
            this.isLoading = false;
        }
        else if (value instanceof image_asset_1.ImageAsset) {
            image_source_1.fromAsset(value).then(function (result) {
                _this.imageSource = result;
                _this.isLoading = false;
            });
        }
        else {
            this.imageSource = image_source_1.fromNativeSource(value);
            this.isLoading = false;
        }
    };
    ImageBase = __decorate([
        view_1.CSSType("Image")
    ], ImageBase);
    return ImageBase;
}(view_1.View));
exports.ImageBase = ImageBase;
ImageBase.prototype.recycleNativeView = "auto";
exports.imageSourceProperty = new view_1.Property({ name: "imageSource" });
exports.imageSourceProperty.register(ImageBase);
exports.srcProperty = new view_1.Property({ name: "src" });
exports.srcProperty.register(ImageBase);
exports.loadModeProperty = new view_1.Property({ name: "loadMode", defaultValue: "sync" });
exports.loadModeProperty.register(ImageBase);
exports.isLoadingProperty = new view_1.Property({ name: "isLoading", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isLoadingProperty.register(ImageBase);
exports.stretchProperty = new view_1.Property({ name: "stretch", defaultValue: "aspectFit", affectsLayout: view_1.isIOS });
exports.stretchProperty.register(ImageBase);
exports.tintColorProperty = new view_1.InheritedCssProperty({ name: "tintColor", cssName: "tint-color", equalityComparer: view_1.Color.equals, valueConverter: function (value) { return new view_1.Color(value); } });
exports.tintColorProperty.register(view_1.Style);
exports.decodeHeightProperty = new view_1.Property({ name: "decodeHeight", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeHeightProperty.register(ImageBase);
exports.decodeWidthProperty = new view_1.Property({ name: "decodeWidth", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeWidthProperty.register(ImageBase);
//# sourceMappingURL=image-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js"));
var FILE_PREFIX = "file:///";
var ASYNC = "async";
var AndroidImageView;
var ImageLoadedListener;
function initializeImageLoadedListener() {
    if (ImageLoadedListener) {
        return;
    }
    var ImageLoadedListenerImpl = (function (_super) {
        __extends(ImageLoadedListenerImpl, _super);
        function ImageLoadedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ImageLoadedListenerImpl.prototype.onImageLoaded = function (success) {
            var owner = this.owner;
            if (owner) {
                owner.isLoading = false;
            }
        };
        ImageLoadedListenerImpl = __decorate([
            Interfaces([org.nativescript.widgets.image.Worker.OnImageLoadedListener])
        ], ImageLoadedListenerImpl);
        return ImageLoadedListenerImpl;
    }(java.lang.Object));
    ImageLoadedListener = ImageLoadedListenerImpl;
}
var Image = (function (_super) {
    __extends(Image, _super);
    function Image() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.useCache = true;
        return _this;
    }
    Image.prototype.createNativeView = function () {
        if (!AndroidImageView) {
            AndroidImageView = org.nativescript.widgets.ImageView;
        }
        return new AndroidImageView(this._context);
    };
    Image.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeImageLoadedListener();
        var nativeView = this.nativeViewProtected;
        var listener = new ImageLoadedListener(this);
        nativeView.setImageLoadedListener(listener);
        nativeView.listener = listener;
    };
    Image.prototype.disposeNativeView = function () {
        this.nativeViewProtected.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Image.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.setImageMatrix(new android.graphics.Matrix());
    };
    Image.prototype._createImageSourceFromSrc = function (value) {
        var imageView = this.nativeViewProtected;
        if (!imageView) {
            return;
        }
        if (!value) {
            imageView.setUri(null, 0, 0, false, false, true);
            return;
        }
        var screen = platform.screen.mainScreen;
        var decodeWidth = Math.min(image_common_1.Length.toDevicePixels(this.decodeWidth, 0), screen.widthPixels);
        var decodeHeight = Math.min(image_common_1.Length.toDevicePixels(this.decodeHeight, 0), screen.heightPixels);
        var keepAspectRatio = this._calculateKeepAspectRatio();
        if (value instanceof image_common_1.ImageAsset) {
            if (value.options) {
                decodeWidth = value.options.width || decodeWidth;
                decodeHeight = value.options.height || decodeHeight;
                keepAspectRatio = !!value.options.keepAspectRatio;
            }
            value = value.android;
        }
        var async = this.loadMode === ASYNC;
        if (typeof value === "string" || value instanceof String) {
            value = value.trim();
            this.isLoading = true;
            if (image_common_1.isFontIconURI(value) || image_common_1.isDataURI(value)) {
                _super.prototype._createImageSourceFromSrc.call(this, value);
            }
            else if (image_common_1.isFileOrResourcePath(value)) {
                if (value.indexOf(image_common_1.RESOURCE_PREFIX) === 0) {
                    imageView.setUri(value, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, async);
                }
                else {
                    var fileName = value;
                    if (fileName.indexOf("~/") === 0) {
                        fileName = file_system_1.knownFolders.currentApp().path + "/" + fileName.replace("~/", "");
                    }
                    imageView.setUri(FILE_PREFIX + fileName, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, async);
                }
            }
            else {
                imageView.setUri(value, decodeWidth, decodeHeight, keepAspectRatio, this.useCache, true);
            }
        }
        else {
            _super.prototype._createImageSourceFromSrc.call(this, value);
        }
    };
    Image.prototype._calculateKeepAspectRatio = function () {
        return this.stretch === "fill" ? false : true;
    };
    Image.prototype[image_common_1.stretchProperty.getDefault] = function () {
        return "aspectFit";
    };
    Image.prototype[image_common_1.stretchProperty.setNative] = function (value) {
        switch (value) {
            case "aspectFit":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.FIT_CENTER);
                break;
            case "aspectFill":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.CENTER_CROP);
                break;
            case "fill":
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.FIT_XY);
                break;
            case "none":
            default:
                this.nativeViewProtected.setScaleType(android.widget.ImageView.ScaleType.MATRIX);
                break;
        }
    };
    Image.prototype[image_common_1.tintColorProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.tintColorProperty.setNative] = function (value) {
        if (value === undefined) {
            this.nativeViewProtected.clearColorFilter();
        }
        else {
            this.nativeViewProtected.setColorFilter(value.android);
        }
    };
    Image.prototype[image_common_1.imageSourceProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.imageSourceProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (value && value.android) {
            var rotation = value.rotationAngle ? value.rotationAngle : 0;
            nativeView.setRotationAngle(rotation);
            nativeView.setImageBitmap(value.android);
        }
        else {
            nativeView.setRotationAngle(0);
            nativeView.setImageBitmap(null);
        }
    };
    Image.prototype[image_common_1.srcProperty.getDefault] = function () {
        return undefined;
    };
    Image.prototype[image_common_1.srcProperty.setNative] = function (value) {
        this._createImageSourceFromSrc(value);
    };
    return Image;
}(image_common_1.ImageBase));
exports.Image = Image;
//# sourceMappingURL=image.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/label/label.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var TextView;
var Label = (function (_super) {
    __extends(Label, _super);
    function Label() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Label.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    Label.prototype.createNativeView = function () {
        if (!TextView) {
            TextView = android.widget.TextView;
        }
        return new TextView(this._context);
    };
    Label.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var textView = this.nativeTextViewProtected;
        textView.setSingleLine(true);
        textView.setEllipsize(android.text.TextUtils.TruncateAt.END);
    };
    Label.prototype[text_base_1.whiteSpaceProperty.setNative] = function (value) {
        var newValue = value === "initial" ? "nowrap" : value;
        _super.prototype[text_base_1.whiteSpaceProperty.setNative].call(this, newValue);
    };
    __decorate([
        profiling_1.profile
    ], Label.prototype, "createNativeView", null);
    Label = __decorate([
        text_base_1.CSSType("Label")
    ], Label);
    return Label;
}(text_base_1.TextBase));
exports.Label = Label;
Label.prototype._isSingleLine = true;
Label.prototype.recycleNativeView = "auto";
//# sourceMappingURL=label.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
layout_base_1.View.prototype.effectiveLeft = 0;
layout_base_1.View.prototype.effectiveTop = 0;
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var AbsoluteLayoutBase = (function (_super) {
    __extends(AbsoluteLayoutBase, _super);
    function AbsoluteLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayoutBase.getLeft = function (element) {
        return validateArgs(element).left;
    };
    AbsoluteLayoutBase.setLeft = function (element, value) {
        validateArgs(element).left = value;
    };
    AbsoluteLayoutBase.getTop = function (element) {
        return validateArgs(element).top;
    };
    AbsoluteLayoutBase.setTop = function (element, value) {
        validateArgs(element).top = value;
    };
    AbsoluteLayoutBase.prototype.onLeftChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase.prototype.onTopChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase = __decorate([
        layout_base_1.CSSType("AbsoluteLayout")
    ], AbsoluteLayoutBase);
    return AbsoluteLayoutBase;
}(layout_base_1.LayoutBase));
exports.AbsoluteLayoutBase = AbsoluteLayoutBase;
AbsoluteLayoutBase.prototype.recycleNativeView = "auto";
exports.leftProperty = new layout_base_1.Property({
    name: "left", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveLeft = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onLeftChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.leftProperty.register(layout_base_1.View);
exports.topProperty = new layout_base_1.Property({
    name: "top", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveTop = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onTopChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.topProperty.register(layout_base_1.View);
//# sourceMappingURL=absolute-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var absolute_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js"));
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
            setter.call(this, lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
absolute_layout_common_1.View.prototype[absolute_layout_common_1.topProperty.setNative] = makeNativeSetter(function (lp, value) { lp.top = absolute_layout_common_1.Length.toDevicePixels(value, 0); });
absolute_layout_common_1.View.prototype[absolute_layout_common_1.leftProperty.setNative] = makeNativeSetter(function (lp, value) { lp.left = absolute_layout_common_1.Length.toDevicePixels(value, 0); });
var AbsoluteLayout = (function (_super) {
    __extends(AbsoluteLayout, _super);
    function AbsoluteLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.AbsoluteLayout(this._context);
    };
    return AbsoluteLayout;
}(absolute_layout_common_1.AbsoluteLayoutBase));
exports.AbsoluteLayout = AbsoluteLayout;
//# sourceMappingURL=absolute-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var DockLayoutBase = (function (_super) {
    __extends(DockLayoutBase, _super);
    function DockLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayoutBase.getDock = function (element) {
        return validateArgs(element).dock;
    };
    DockLayoutBase.setDock = function (element, value) {
        validateArgs(element).dock = value;
    };
    DockLayoutBase.prototype.onDockChanged = function (view, oldValue, newValue) {
    };
    DockLayoutBase = __decorate([
        layout_base_1.CSSType("DockLayout")
    ], DockLayoutBase);
    return DockLayoutBase;
}(layout_base_1.LayoutBase));
exports.DockLayoutBase = DockLayoutBase;
DockLayoutBase.prototype.recycleNativeView = "auto";
var dockConverter = layout_base_1.makeParser(layout_base_1.makeValidator("left", "top", "right", "bottom"));
exports.dockProperty = new layout_base_1.Property({
    name: "dock", defaultValue: "left", valueChanged: function (target, oldValue, newValue) {
        if (target instanceof layout_base_1.View) {
            var layout = target.parent;
            if (layout instanceof DockLayoutBase) {
                layout.onDockChanged(target, oldValue, newValue);
            }
        }
    }, valueConverter: dockConverter
});
exports.dockProperty.register(layout_base_1.View);
exports.stretchLastChildProperty = new layout_base_1.Property({
    name: "stretchLastChild", defaultValue: true, affectsLayout: layout_base_1.isIOS, valueConverter: layout_base_1.booleanConverter
});
exports.stretchLastChildProperty.register(DockLayoutBase);
//# sourceMappingURL=dock-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var dock_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js"));
dock_layout_common_1.View.prototype[dock_layout_common_1.dockProperty.setNative] = function (value) {
    var nativeView = this.nativeViewProtected;
    var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
    if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
        switch (value) {
            case "left":
                lp.dock = org.nativescript.widgets.Dock.left;
                break;
            case "top":
                lp.dock = org.nativescript.widgets.Dock.top;
                break;
            case "right":
                lp.dock = org.nativescript.widgets.Dock.right;
                break;
            case "bottom":
                lp.dock = org.nativescript.widgets.Dock.bottom;
                break;
            default:
                throw new Error("Invalid value for dock property: " + value);
        }
        nativeView.setLayoutParams(lp);
    }
};
var DockLayout = (function (_super) {
    __extends(DockLayout, _super);
    function DockLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.DockLayout(this._context);
    };
    DockLayout.prototype[dock_layout_common_1.stretchLastChildProperty.getDefault] = function () {
        return true;
    };
    DockLayout.prototype[dock_layout_common_1.stretchLastChildProperty.setNative] = function (value) {
        this.nativeViewProtected.setStretchLastChild(value);
    };
    return DockLayout;
}(dock_layout_common_1.DockLayoutBase));
exports.DockLayout = DockLayout;
//# sourceMappingURL=dock-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
exports.ORDER_DEFAULT = 1;
exports.FLEX_GROW_DEFAULT = 0.0;
exports.FLEX_SHRINK_DEFAULT = 1.0;
var FlexDirection;
(function (FlexDirection) {
    FlexDirection.ROW = "row";
    FlexDirection.ROW_REVERSE = "row-reverse";
    FlexDirection.COLUMN = "column";
    FlexDirection.COLUMN_REVERSE = "column-reverse";
    FlexDirection.isValid = layout_base_1.makeValidator(FlexDirection.ROW, FlexDirection.ROW_REVERSE, FlexDirection.COLUMN, FlexDirection.COLUMN_REVERSE);
    FlexDirection.parse = layout_base_1.makeParser(FlexDirection.isValid);
})(FlexDirection = exports.FlexDirection || (exports.FlexDirection = {}));
var FlexWrap;
(function (FlexWrap) {
    FlexWrap.NOWRAP = "nowrap";
    FlexWrap.WRAP = "wrap";
    FlexWrap.WRAP_REVERSE = "wrap-reverse";
    FlexWrap.isValid = layout_base_1.makeValidator(FlexWrap.NOWRAP, FlexWrap.WRAP, FlexWrap.WRAP_REVERSE);
    FlexWrap.parse = layout_base_1.makeParser(FlexWrap.isValid);
})(FlexWrap = exports.FlexWrap || (exports.FlexWrap = {}));
var JustifyContent;
(function (JustifyContent) {
    JustifyContent.FLEX_START = "flex-start";
    JustifyContent.FLEX_END = "flex-end";
    JustifyContent.CENTER = "center";
    JustifyContent.SPACE_BETWEEN = "space-between";
    JustifyContent.SPACE_AROUND = "space-around";
    JustifyContent.isValid = layout_base_1.makeValidator(JustifyContent.FLEX_START, JustifyContent.FLEX_END, JustifyContent.CENTER, JustifyContent.SPACE_BETWEEN, JustifyContent.SPACE_AROUND);
    JustifyContent.parse = layout_base_1.makeParser(JustifyContent.isValid);
})(JustifyContent = exports.JustifyContent || (exports.JustifyContent = {}));
var FlexBasisPercent;
(function (FlexBasisPercent) {
    FlexBasisPercent.DEFAULT = -1;
})(FlexBasisPercent = exports.FlexBasisPercent || (exports.FlexBasisPercent = {}));
var AlignItems;
(function (AlignItems) {
    AlignItems.FLEX_START = "flex-start";
    AlignItems.FLEX_END = "flex-end";
    AlignItems.CENTER = "center";
    AlignItems.BASELINE = "baseline";
    AlignItems.STRETCH = "stretch";
    AlignItems.isValid = layout_base_1.makeValidator(AlignItems.FLEX_START, AlignItems.FLEX_END, AlignItems.CENTER, AlignItems.BASELINE, AlignItems.STRETCH);
    AlignItems.parse = layout_base_1.makeParser(AlignItems.isValid);
})(AlignItems = exports.AlignItems || (exports.AlignItems = {}));
var AlignContent;
(function (AlignContent) {
    AlignContent.FLEX_START = "flex-start";
    AlignContent.FLEX_END = "flex-end";
    AlignContent.CENTER = "center";
    AlignContent.SPACE_BETWEEN = "space-between";
    AlignContent.SPACE_AROUND = "space-around";
    AlignContent.STRETCH = "stretch";
    AlignContent.isValid = layout_base_1.makeValidator(AlignContent.FLEX_START, AlignContent.FLEX_END, AlignContent.CENTER, AlignContent.SPACE_BETWEEN, AlignContent.SPACE_AROUND, AlignContent.STRETCH);
    AlignContent.parse = layout_base_1.makeParser(AlignContent.isValid);
})(AlignContent = exports.AlignContent || (exports.AlignContent = {}));
var Order;
(function (Order) {
    function isValid(value) {
        return isFinite(parseInt(value));
    }
    Order.isValid = isValid;
    Order.parse = parseInt;
})(Order = exports.Order || (exports.Order = {}));
var FlexGrow;
(function (FlexGrow) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexGrow.isValid = isValid;
    FlexGrow.parse = parseFloat;
})(FlexGrow = exports.FlexGrow || (exports.FlexGrow = {}));
var FlexShrink;
(function (FlexShrink) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexShrink.isValid = isValid;
    FlexShrink.parse = parseFloat;
})(FlexShrink = exports.FlexShrink || (exports.FlexShrink = {}));
var FlexWrapBefore;
(function (FlexWrapBefore) {
    function isValid(value) {
        if (typeof value === "boolean") {
            return true;
        }
        if (typeof value === "string") {
            var str = value.trim().toLowerCase();
            return str === "true" || str === "false";
        }
        return false;
    }
    FlexWrapBefore.isValid = isValid;
    function parse(value) {
        return value && value.toString().trim().toLowerCase() === "true";
    }
    FlexWrapBefore.parse = parse;
})(FlexWrapBefore = exports.FlexWrapBefore || (exports.FlexWrapBefore = {}));
var AlignSelf;
(function (AlignSelf) {
    AlignSelf.AUTO = "auto";
    AlignSelf.FLEX_START = "flex-start";
    AlignSelf.FLEX_END = "flex-end";
    AlignSelf.CENTER = "center";
    AlignSelf.BASELINE = "baseline";
    AlignSelf.STRETCH = "stretch";
    AlignSelf.isValid = layout_base_1.makeValidator(AlignSelf.AUTO, AlignSelf.FLEX_START, AlignSelf.FLEX_END, AlignSelf.CENTER, AlignSelf.BASELINE, AlignSelf.STRETCH);
    AlignSelf.parse = layout_base_1.makeParser(AlignSelf.isValid);
})(AlignSelf = exports.AlignSelf || (exports.AlignSelf = {}));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var FlexboxLayoutBase = (function (_super) {
    __extends(FlexboxLayoutBase, _super);
    function FlexboxLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexDirection", {
        get: function () {
            return this.style.flexDirection;
        },
        set: function (value) {
            this.style.flexDirection = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexWrap", {
        get: function () {
            return this.style.flexWrap;
        },
        set: function (value) {
            this.style.flexWrap = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "justifyContent", {
        get: function () {
            return this.style.justifyContent;
        },
        set: function (value) {
            this.style.justifyContent = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignItems", {
        get: function () {
            return this.style.alignItems;
        },
        set: function (value) {
            this.style.alignItems = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignContent", {
        get: function () {
            return this.style.alignContent;
        },
        set: function (value) {
            this.style.alignContent = value;
        },
        enumerable: true,
        configurable: true
    });
    FlexboxLayoutBase.setOrder = function (view, order) {
        validateArgs(view).style.order = order;
    };
    FlexboxLayoutBase.getOrder = function (view) {
        return validateArgs(view).style.order;
    };
    FlexboxLayoutBase.setFlexGrow = function (view, grow) {
        validateArgs(view).style.flexGrow = grow;
    };
    FlexboxLayoutBase.getFlexGrow = function (view) {
        return validateArgs(view).style.flexGrow;
    };
    FlexboxLayoutBase.setFlexShrink = function (view, shrink) {
        validateArgs(view).style.flexShrink = shrink;
    };
    FlexboxLayoutBase.getFlexShrink = function (view) {
        return validateArgs(view).style.flexShrink;
    };
    FlexboxLayoutBase.setAlignSelf = function (view, align) {
        validateArgs(view).style.alignSelf = align;
    };
    FlexboxLayoutBase.getAlignSelf = function (view) {
        return validateArgs(view).style.alignSelf;
    };
    FlexboxLayoutBase.setFlexWrapBefore = function (view, wrap) {
        validateArgs(view).style.flexWrapBefore = wrap;
    };
    FlexboxLayoutBase.getFlexWrapBefore = function (view) {
        return validateArgs(view).style.flexWrapBefore;
    };
    FlexboxLayoutBase = __decorate([
        layout_base_1.CSSType("FlexboxLayout")
    ], FlexboxLayoutBase);
    return FlexboxLayoutBase;
}(layout_base_1.LayoutBase));
exports.FlexboxLayoutBase = FlexboxLayoutBase;
FlexboxLayoutBase.prototype.recycleNativeView = "auto";
exports.flexDirectionProperty = new layout_base_1.CssProperty({ name: "flexDirection", cssName: "flex-direction", defaultValue: FlexDirection.ROW, affectsLayout: layout_base_1.isIOS, valueConverter: FlexDirection.parse });
exports.flexDirectionProperty.register(layout_base_1.Style);
exports.flexWrapProperty = new layout_base_1.CssProperty({ name: "flexWrap", cssName: "flex-wrap", defaultValue: "nowrap", affectsLayout: layout_base_1.isIOS, valueConverter: FlexWrap.parse });
exports.flexWrapProperty.register(layout_base_1.Style);
exports.justifyContentProperty = new layout_base_1.CssProperty({ name: "justifyContent", cssName: "justify-content", defaultValue: JustifyContent.FLEX_START, affectsLayout: layout_base_1.isIOS, valueConverter: JustifyContent.parse });
exports.justifyContentProperty.register(layout_base_1.Style);
exports.alignItemsProperty = new layout_base_1.CssProperty({ name: "alignItems", cssName: "align-items", defaultValue: AlignItems.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignItems.parse });
exports.alignItemsProperty.register(layout_base_1.Style);
exports.alignContentProperty = new layout_base_1.CssProperty({ name: "alignContent", cssName: "align-content", defaultValue: AlignContent.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignContent.parse });
exports.alignContentProperty.register(layout_base_1.Style);
exports.orderProperty = new layout_base_1.CssProperty({ name: "order", cssName: "order", defaultValue: exports.ORDER_DEFAULT, valueConverter: Order.parse });
exports.orderProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "order", {
    get: function () {
        return this.style.order;
    },
    set: function (value) {
        this.style.order = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexGrowProperty = new layout_base_1.CssProperty({ name: "flexGrow", cssName: "flex-grow", defaultValue: exports.FLEX_GROW_DEFAULT, valueConverter: FlexGrow.parse });
exports.flexGrowProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexGrow", {
    get: function () {
        return this.style.flexGrow;
    },
    set: function (value) {
        this.style.flexGrow = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexShrinkProperty = new layout_base_1.CssProperty({ name: "flexShrink", cssName: "flex-shrink", defaultValue: exports.FLEX_SHRINK_DEFAULT, valueConverter: FlexShrink.parse });
exports.flexShrinkProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexShrink", {
    get: function () {
        return this.style.flexShrink;
    },
    set: function (value) {
        this.style.flexShrink = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexWrapBeforeProperty = new layout_base_1.CssProperty({ name: "flexWrapBefore", cssName: "flex-wrap-before", defaultValue: false, valueConverter: FlexWrapBefore.parse });
exports.flexWrapBeforeProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexWrapBefore", {
    get: function () {
        return this.style.flexWrapBefore;
    },
    set: function (value) {
        this.style.flexWrapBefore = value;
    },
    enumerable: true,
    configurable: true
});
exports.alignSelfProperty = new layout_base_1.CssProperty({ name: "alignSelf", cssName: "align-self", defaultValue: AlignSelf.AUTO, valueConverter: AlignSelf.parse });
exports.alignSelfProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "alignSelf", {
    get: function () {
        return this.style.alignSelf;
    },
    set: function (value) {
        this.style.alignSelf = value;
    },
    enumerable: true,
    configurable: true
});
var flexFlowProperty = new layout_base_1.ShorthandProperty({
    name: "flexFlow", cssName: "flex-flow",
    getter: function () {
        return this.flexDirection + " " + this.flexWrap;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexDirectionProperty, value]);
            properties.push([exports.flexWrapProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length >= 1 && FlexDirection.isValid(values[0])) {
                    properties.push([exports.flexDirectionProperty, FlexDirection.parse(values[0])]);
                }
                if (value.length >= 2 && FlexWrap.isValid(values[1])) {
                    properties.push([exports.flexWrapProperty, FlexWrap.parse(values[1])]);
                }
            }
        }
        return properties;
    }
});
flexFlowProperty.register(layout_base_1.Style);
var flexProperty = new layout_base_1.ShorthandProperty({
    name: "flex", cssName: "flex",
    getter: function () {
        return this.flexGrow + " " + this.flexShrink;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexGrowProperty, value]);
            properties.push([exports.flexShrinkProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length === 1) {
                    switch (values[0]) {
                        case "inital":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "auto":
                            properties.push([exports.flexGrowProperty, 1]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "none":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 0]);
                            break;
                        default:
                            if (FlexGrow.isValid(values[0])) {
                                properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                                properties.push([exports.flexShrinkProperty, 1]);
                            }
                    }
                }
                if (values.length >= 2) {
                    if (FlexGrow.isValid(values[0]) && FlexShrink.isValid(values[1])) {
                        properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                        properties.push([exports.flexShrinkProperty, FlexShrink.parse(values[1])]);
                    }
                }
            }
        }
        return properties;
    }
});
flexProperty.register(layout_base_1.Style);
//# sourceMappingURL=flexbox-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
var _a, _b, _c, _d, _e, _f;
Object.defineProperty(exports, "__esModule", { value: true });
var flexbox_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js"));
var widgetFlexboxLayout;
var widgetLayoutParams;
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new widgetLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            setter(lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.orderProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.order = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexGrowProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.flexGrow = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexShrinkProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.flexShrink = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexWrapBeforeProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.wrapBefore = value; });
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.alignSelfProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.alignSelf = alignSelfMap[value]; });
var flexDirectionMap = (_a = {},
    _a[flexbox_layout_common_1.FlexDirection.ROW] = 0,
    _a[flexbox_layout_common_1.FlexDirection.ROW_REVERSE] = 1,
    _a[flexbox_layout_common_1.FlexDirection.COLUMN] = 2,
    _a[flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE] = 3,
    _a);
var flexWrapMap = (_b = {},
    _b[flexbox_layout_common_1.FlexWrap.NOWRAP] = 0,
    _b[flexbox_layout_common_1.FlexWrap.WRAP] = 1,
    _b[flexbox_layout_common_1.FlexWrap.WRAP_REVERSE] = 2,
    _b);
var justifyContentMap = (_c = {},
    _c[flexbox_layout_common_1.JustifyContent.FLEX_START] = 0,
    _c[flexbox_layout_common_1.JustifyContent.FLEX_END] = 1,
    _c[flexbox_layout_common_1.JustifyContent.CENTER] = 2,
    _c[flexbox_layout_common_1.JustifyContent.SPACE_BETWEEN] = 3,
    _c[flexbox_layout_common_1.JustifyContent.SPACE_AROUND] = 4,
    _c);
var alignItemsMap = (_d = {},
    _d[flexbox_layout_common_1.AlignItems.FLEX_START] = 0,
    _d[flexbox_layout_common_1.AlignItems.FLEX_END] = 1,
    _d[flexbox_layout_common_1.AlignItems.CENTER] = 2,
    _d[flexbox_layout_common_1.AlignItems.BASELINE] = 3,
    _d[flexbox_layout_common_1.AlignItems.STRETCH] = 4,
    _d);
var alignContentMap = (_e = {},
    _e[flexbox_layout_common_1.AlignContent.FLEX_START] = 0,
    _e[flexbox_layout_common_1.AlignContent.FLEX_END] = 1,
    _e[flexbox_layout_common_1.AlignContent.CENTER] = 2,
    _e[flexbox_layout_common_1.AlignContent.SPACE_BETWEEN] = 3,
    _e[flexbox_layout_common_1.AlignContent.SPACE_AROUND] = 4,
    _e[flexbox_layout_common_1.AlignContent.STRETCH] = 5,
    _e);
var alignSelfMap = (_f = {},
    _f[flexbox_layout_common_1.AlignSelf.AUTO] = -1,
    _f[flexbox_layout_common_1.AlignSelf.FLEX_START] = 0,
    _f[flexbox_layout_common_1.AlignSelf.FLEX_END] = 1,
    _f[flexbox_layout_common_1.AlignSelf.CENTER] = 2,
    _f[flexbox_layout_common_1.AlignSelf.BASELINE] = 3,
    _f[flexbox_layout_common_1.AlignSelf.STRETCH] = 4,
    _f);
var FlexboxLayout = (function (_super) {
    __extends(FlexboxLayout, _super);
    function FlexboxLayout() {
        var _this = _super.call(this) || this;
        if (!widgetFlexboxLayout) {
            widgetFlexboxLayout = org.nativescript.widgets.FlexboxLayout;
            widgetLayoutParams = widgetFlexboxLayout.LayoutParams;
        }
        return _this;
    }
    FlexboxLayout.prototype.createNativeView = function () {
        return new widgetFlexboxLayout(this._context);
    };
    FlexboxLayout.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeViewProtected.invalidateOrdersCache();
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexDirectionProperty.getDefault] = function () {
        return flexbox_layout_common_1.flexDirectionProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexDirectionProperty.setNative] = function (flexDirection) {
        this.nativeViewProtected.setFlexDirection(flexDirectionMap[flexDirection]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexWrapProperty.getDefault] = function () {
        return flexbox_layout_common_1.flexWrapProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.flexWrapProperty.setNative] = function (flexWrap) {
        this.nativeViewProtected.setFlexWrap(flexWrapMap[flexWrap]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.justifyContentProperty.getDefault] = function () {
        return flexbox_layout_common_1.justifyContentProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.justifyContentProperty.setNative] = function (justifyContent) {
        this.nativeViewProtected.setJustifyContent(justifyContentMap[justifyContent]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignItemsProperty.getDefault] = function () {
        return flexbox_layout_common_1.alignItemsProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignItemsProperty.setNative] = function (alignItems) {
        this.nativeViewProtected.setAlignItems(alignItemsMap[alignItems]);
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignContentProperty.getDefault] = function () {
        return flexbox_layout_common_1.alignContentProperty.defaultValue;
    };
    FlexboxLayout.prototype[flexbox_layout_common_1.alignContentProperty.setNative] = function (alignContent) {
        this.nativeViewProtected.setAlignContent(alignContentMap[alignContent]);
    };
    FlexboxLayout.prototype._updateNativeLayoutParams = function (child) {
        _super.prototype._updateNativeLayoutParams.call(this, child);
        var lp = child.nativeViewProtected.getLayoutParams();
        var style = child.style;
        lp.order = style.order;
        lp.flexGrow = style.flexGrow;
        lp.flexShrink = style.flexShrink;
        lp.wrapBefore = style.flexWrapBefore;
        lp.alignSelf = alignSelfMap[style.alignSelf];
        child.nativeViewProtected.setLayoutParams(lp);
    };
    FlexboxLayout.prototype._setChildMinWidthNative = function (child) {
        child._setMinWidthNative(0);
        var nativeView = child.nativeViewProtected;
        var lp = nativeView.getLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            lp.minWidth = flexbox_layout_common_1.Length.toDevicePixels(child.style.minWidth, 0);
            nativeView.setLayoutParams(lp);
        }
    };
    FlexboxLayout.prototype._setChildMinHeightNative = function (child) {
        child._setMinHeightNative(0);
        var nativeView = child.nativeViewProtected;
        var lp = nativeView.getLayoutParams();
        if (lp instanceof widgetLayoutParams) {
            lp.minHeight = flexbox_layout_common_1.Length.toDevicePixels(child.style.minHeight, 0);
            nativeView.setLayoutParams(lp);
        }
    };
    return FlexboxLayout;
}(flexbox_layout_common_1.FlexboxLayoutBase));
exports.FlexboxLayout = FlexboxLayout;
//# sourceMappingURL=flexbox-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefined.");
    }
    return element;
}
layout_base_1.View.prototype.row = 0;
layout_base_1.View.prototype.col = 0;
layout_base_1.View.prototype.rowSpan = 1;
layout_base_1.View.prototype.colSpan = 1;
Object.defineProperty(layout_base_1.View.prototype, "column", {
    get: function () { return this.col; },
    set: function (value) { this.col = value; },
    enumerable: true,
    configurable: true
});
Object.defineProperty(layout_base_1.View.prototype, "columnSpan", {
    get: function () { return this.colSpan; },
    set: function (value) { this.colSpan = value; },
    enumerable: true,
    configurable: true
});
function validateItemSpec(itemSpec) {
    if (!itemSpec) {
        throw new Error("Value cannot be undefined.");
    }
    if (itemSpec.owner) {
        throw new Error("itemSpec is already added to GridLayout.");
    }
}
function convertGridLength(value) {
    if (value === GridUnitType.AUTO) {
        return ItemSpec.create(1, GridUnitType.AUTO);
    }
    else if (value.indexOf("*") !== -1) {
        var starCount = parseInt(value.replace("*", "") || "1");
        return ItemSpec.create(starCount, GridUnitType.STAR);
    }
    else if (!isNaN(parseInt(value))) {
        return ItemSpec.create(parseInt(value), GridUnitType.PIXEL);
    }
    else {
        throw new Error("Cannot parse item spec from string: " + value);
    }
}
function parseAndAddItemSpecs(value, func) {
    var arr = value.split(/[\s,]+/);
    for (var i = 0, length_1 = arr.length; i < length_1; i++) {
        var str = arr[i].trim();
        if (str.length > 0) {
            func(convertGridLength(arr[i].trim()));
        }
    }
}
var ItemSpec = (function (_super) {
    __extends(ItemSpec, _super);
    function ItemSpec() {
        var _this = _super.call(this) || this;
        _this._actualLength = 0;
        if (arguments.length === 0) {
            _this._value = 1;
            _this._unitType = GridUnitType.STAR;
        }
        else if (arguments.length === 2) {
            var value = arguments[0];
            var type = arguments[1];
            if (typeof value === "number" && typeof type === "string") {
                if (value < 0 || isNaN(value) || !isFinite(value)) {
                    throw new Error("Value should not be negative, NaN or Infinity: " + value);
                }
                _this._value = value;
                _this._unitType = GridUnitType.parse(type);
            }
            else {
                throw new Error("First argument should be number, second argument should be string.");
            }
        }
        else {
            throw new Error("ItemSpec expects 0 or 2 arguments");
        }
        _this.index = -1;
        return _this;
    }
    ItemSpec.create = function (value, type) {
        var spec = new ItemSpec();
        spec._value = value;
        spec._unitType = type;
        return spec;
    };
    Object.defineProperty(ItemSpec.prototype, "actualLength", {
        get: function () {
            return this._actualLength;
        },
        enumerable: true,
        configurable: true
    });
    ItemSpec.equals = function (value1, value2) {
        return (value1.gridUnitType === value2.gridUnitType) && (value1.value === value2.value) && (value1.owner === value2.owner) && (value1.index === value2.index);
    };
    Object.defineProperty(ItemSpec.prototype, "gridUnitType", {
        get: function () {
            return this._unitType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAbsolute", {
        get: function () {
            return this._unitType === GridUnitType.PIXEL;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAuto", {
        get: function () {
            return this._unitType === GridUnitType.AUTO;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isStar", {
        get: function () {
            return this._unitType === GridUnitType.STAR;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "value", {
        get: function () {
            return this._value;
        },
        enumerable: true,
        configurable: true
    });
    return ItemSpec;
}(layout_base_1.Observable));
exports.ItemSpec = ItemSpec;
var GridLayoutBase = (function (_super) {
    __extends(GridLayoutBase, _super);
    function GridLayoutBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._rows = new Array();
        _this._cols = new Array();
        return _this;
    }
    GridLayoutBase_1 = GridLayoutBase;
    GridLayoutBase.getColumn = function (element) {
        return validateArgs(element).col;
    };
    GridLayoutBase.setColumn = function (element, value) {
        validateArgs(element).col = value;
    };
    GridLayoutBase.getColumnSpan = function (element) {
        return validateArgs(element).colSpan;
    };
    GridLayoutBase.setColumnSpan = function (element, value) {
        validateArgs(element).colSpan = value;
    };
    GridLayoutBase.getRow = function (element) {
        return validateArgs(element).row;
    };
    GridLayoutBase.setRow = function (element, value) {
        validateArgs(element).row = value;
    };
    GridLayoutBase.getRowSpan = function (element) {
        return validateArgs(element).rowSpan;
    };
    GridLayoutBase.setRowSpan = function (element, value) {
        validateArgs(element).rowSpan = value;
    };
    GridLayoutBase.prototype.addRow = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._rows.push(itemSpec);
        this._onRowAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addColumn = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._cols.push(itemSpec);
        this._onColumnAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addChildAtCell = function (view, row, column, rowSpan, columnSpan) {
        this.addChild(view);
        GridLayoutBase_1.setRow(view, row);
        GridLayoutBase_1.setColumn(view, column);
        if (rowSpan) {
            GridLayoutBase_1.setRowSpan(view, rowSpan);
        }
        if (columnSpan) {
            GridLayoutBase_1.setColumnSpan(view, columnSpan);
        }
    };
    GridLayoutBase.prototype.removeRow = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._rows.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Row is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._rows.splice(index, 1);
        this._onRowRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumn = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._cols.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Column is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._cols.splice(index, 1);
        this._onColumnRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumns = function () {
        for (var i = this._cols.length - 1; i >= 0; i--) {
            var colSpec = this._cols[i];
            this._onColumnRemoved(colSpec, i);
            colSpec.index = -1;
        }
        this._cols.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.removeRows = function () {
        for (var i = this._rows.length - 1; i >= 0; i--) {
            var rowSpec = this._rows[i];
            this._onRowRemoved(rowSpec, i);
            rowSpec.index = -1;
        }
        this._rows.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype._onRowAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onColumnAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onRowRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype._onColumnRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype.getColumns = function () {
        return this._cols.slice();
    };
    GridLayoutBase.prototype.getRows = function () {
        return this._rows.slice();
    };
    Object.defineProperty(GridLayoutBase.prototype, "columnsInternal", {
        get: function () {
            return this._cols;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "rowsInternal", {
        get: function () {
            return this._rows;
        },
        enumerable: true,
        configurable: true
    });
    GridLayoutBase.prototype.invalidate = function () {
    };
    Object.defineProperty(GridLayoutBase.prototype, "rows", {
        set: function (value) {
            var _this = this;
            this.removeRows();
            parseAndAddItemSpecs(value, function (spec) { return _this.addRow(spec); });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "columns", {
        set: function (value) {
            var _this = this;
            this.removeColumns();
            parseAndAddItemSpecs(value, function (spec) { return _this.addColumn(spec); });
        },
        enumerable: true,
        configurable: true
    });
    var GridLayoutBase_1;
    GridLayoutBase = GridLayoutBase_1 = __decorate([
        layout_base_1.CSSType("GridLayout")
    ], GridLayoutBase);
    return GridLayoutBase;
}(layout_base_1.LayoutBase));
exports.GridLayoutBase = GridLayoutBase;
GridLayoutBase.prototype.recycleNativeView = "auto";
exports.columnProperty = new layout_base_1.Property({
    name: "col", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.columnProperty.register(layout_base_1.View);
exports.columnSpanProperty = new layout_base_1.Property({
    name: "colSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.columnSpanProperty.register(layout_base_1.View);
exports.rowProperty = new layout_base_1.Property({
    name: "row", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.rowProperty.register(layout_base_1.View);
exports.rowSpanProperty = new layout_base_1.Property({
    name: "rowSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.rowSpanProperty.register(layout_base_1.View);
var GridUnitType;
(function (GridUnitType) {
    GridUnitType.PIXEL = "pixel";
    GridUnitType.STAR = "star";
    GridUnitType.AUTO = "auto";
    GridUnitType.isValid = layout_base_1.makeValidator(GridUnitType.PIXEL, GridUnitType.STAR, GridUnitType.AUTO);
    GridUnitType.parse = layout_base_1.makeParser(GridUnitType.isValid);
})(GridUnitType = exports.GridUnitType || (exports.GridUnitType = {}));
//# sourceMappingURL=grid-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var grid_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js"));
function makeNativeSetter(setter) {
    return function (value) {
        var nativeView = this.nativeViewProtected;
        var lp = nativeView.getLayoutParams() || new org.nativescript.widgets.CommonLayoutParams();
        if (lp instanceof org.nativescript.widgets.CommonLayoutParams) {
            setter(lp, value);
            nativeView.setLayoutParams(lp);
        }
    };
}
grid_layout_common_1.View.prototype[grid_layout_common_1.rowProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.row = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.columnProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.column = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.rowSpanProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.rowSpan = value; });
grid_layout_common_1.View.prototype[grid_layout_common_1.columnSpanProperty.setNative] = makeNativeSetter(function (lp, value) { return lp.columnSpan = value; });
function createNativeSpec(itemSpec) {
    switch (itemSpec.gridUnitType) {
        case grid_layout_common_1.GridUnitType.AUTO:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value, org.nativescript.widgets.GridUnitType.auto);
        case grid_layout_common_1.GridUnitType.STAR:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value, org.nativescript.widgets.GridUnitType.star);
        case grid_layout_common_1.GridUnitType.PIXEL:
            return new org.nativescript.widgets.ItemSpec(itemSpec.value * grid_layout_common_1.layout.getDisplayDensity(), org.nativescript.widgets.GridUnitType.pixel);
        default:
            throw new Error("Invalid gridUnitType: " + itemSpec.gridUnitType);
    }
}
var ItemSpec = (function (_super) {
    __extends(ItemSpec, _super);
    function ItemSpec() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ItemSpec.prototype, "actualLength", {
        get: function () {
            if (this.nativeSpec) {
                return Math.round(this.nativeSpec.getActualLength() / grid_layout_common_1.layout.getDisplayDensity());
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    return ItemSpec;
}(grid_layout_common_1.ItemSpec));
exports.ItemSpec = ItemSpec;
var GridLayout = (function (_super) {
    __extends(GridLayout, _super);
    function GridLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GridLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.GridLayout(this._context);
    };
    GridLayout.prototype.initNativeView = function () {
        var _this = this;
        _super.prototype.initNativeView.call(this);
        this.rowsInternal.forEach(function (itemSpec, index, rows) { _this._onRowAdded(itemSpec); }, this);
        this.columnsInternal.forEach(function (itemSpec, index, rows) { _this._onColumnAdded(itemSpec); }, this);
    };
    GridLayout.prototype.resetNativeView = function () {
        for (var i = this.rowsInternal.length; i--; i >= 0) {
            var itemSpec = this.rowsInternal[i];
            this._onRowRemoved(itemSpec, i);
        }
        for (var i = this.columnsInternal.length; i--; i >= 0) {
            var itemSpec = this.columnsInternal[i];
            this._onColumnRemoved(itemSpec, i);
        }
        _super.prototype.resetNativeView.call(this);
    };
    GridLayout.prototype._onRowAdded = function (itemSpec) {
        if (this.nativeViewProtected) {
            var nativeSpec = createNativeSpec(itemSpec);
            itemSpec.nativeSpec = nativeSpec;
            this.nativeViewProtected.addRow(nativeSpec);
        }
    };
    GridLayout.prototype._onColumnAdded = function (itemSpec) {
        if (this.nativeViewProtected) {
            var nativeSpec = createNativeSpec(itemSpec);
            itemSpec.nativeSpec = nativeSpec;
            this.nativeViewProtected.addColumn(nativeSpec);
        }
    };
    GridLayout.prototype._onRowRemoved = function (itemSpec, index) {
        itemSpec.nativeSpec = null;
        if (this.nativeViewProtected) {
            this.nativeViewProtected.removeRowAt(index);
        }
    };
    GridLayout.prototype._onColumnRemoved = function (itemSpec, index) {
        itemSpec.nativeSpec = null;
        if (this.nativeViewProtected) {
            this.nativeViewProtected.removeColumnAt(index);
        }
    };
    GridLayout.prototype.invalidate = function () {
    };
    return GridLayout;
}(grid_layout_common_1.GridLayoutBase));
exports.GridLayout = GridLayout;
//# sourceMappingURL=grid-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var LayoutBaseCommon = (function (_super) {
    __extends(LayoutBaseCommon, _super);
    function LayoutBaseCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._subViews = new Array();
        return _this;
    }
    LayoutBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.addChild(value);
        }
    };
    LayoutBaseCommon.prototype.getChildrenCount = function () {
        return this._subViews.length;
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "_childrenCount", {
        get: function () {
            return this._subViews.length;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype.getChildAt = function (index) {
        return this._subViews[index];
    };
    LayoutBaseCommon.prototype.getChildIndex = function (child) {
        return this._subViews.indexOf(child);
    };
    LayoutBaseCommon.prototype.getChildById = function (id) {
        return view_1.getViewById(this, id);
    };
    LayoutBaseCommon.prototype._registerLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype._unregisterLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype.addChild = function (child) {
        this._subViews.push(child);
        this._addView(child);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.insertChild = function (child, atIndex) {
        this._subViews.splice(atIndex, 0, child);
        this._addView(child, atIndex);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChild = function (child) {
        this._removeView(child);
        var index = this._subViews.indexOf(child);
        this._subViews.splice(index, 1);
        this._unregisterLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChildren = function () {
        while (this.getChildrenCount() !== 0) {
            this.removeChild(this._subViews[this.getChildrenCount() - 1]);
        }
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype._childIndexToNativeChildIndex = function (index) {
        if (index === undefined) {
            return undefined;
        }
        var result = 0;
        for (var i = 0; i < index && i < this._subViews.length; i++) {
            result += this._subViews[i]._getNativeViewsCount();
        }
        return result;
    };
    LayoutBaseCommon.prototype.eachChildView = function (callback) {
        for (var i = 0, length_1 = this._subViews.length; i < length_1; i++) {
            var retVal = callback(this._subViews[i]);
            if (retVal === false) {
                break;
            }
        }
    };
    LayoutBaseCommon.prototype.eachLayoutChild = function (callback) {
        var lastChild = null;
        this.eachChildView(function (cv) {
            cv._eachLayoutView(function (lv) {
                if (lastChild && !lastChild.isCollapsed) {
                    callback(lastChild, false);
                }
                lastChild = lv;
            });
            return true;
        });
        if (lastChild && !lastChild.isCollapsed) {
            callback(lastChild, true);
        }
    };
    return LayoutBaseCommon;
}(view_1.CustomLayoutView));
exports.LayoutBaseCommon = LayoutBaseCommon;
exports.clipToBoundsProperty = new view_1.Property({ name: "clipToBounds", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.clipToBoundsProperty.register(LayoutBaseCommon);
exports.isPassThroughParentEnabledProperty = new view_1.Property({ name: "isPassThroughParentEnabled", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isPassThroughParentEnabledProperty.register(LayoutBaseCommon);
//# sourceMappingURL=layout-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js"));
var LayoutBase = (function (_super) {
    __extends(LayoutBase, _super);
    function LayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.getDefault] = function () {
        return true;
    };
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.setNative] = function (value) {
        console.warn("clipToBounds with value false is not supported on Android. You can use this.android.getParent().setClipChildren(false) as an alternative");
    };
    LayoutBase.prototype[layout_base_common_1.isPassThroughParentEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setPassThroughParent(value);
    };
    LayoutBase.prototype[layout_base_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    LayoutBase.prototype[layout_base_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    LayoutBase.prototype[layout_base_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeViewProtected, layout_base_common_1.Length.toDevicePixels(value, 0) + layout_base_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    return LayoutBase;
}(layout_base_common_1.LayoutBaseCommon));
exports.LayoutBase = LayoutBase;
//# sourceMappingURL=layout-base.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var StackLayoutBase = (function (_super) {
    __extends(StackLayoutBase, _super);
    function StackLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StackLayoutBase = __decorate([
        layout_base_1.CSSType("StackLayout")
    ], StackLayoutBase);
    return StackLayoutBase;
}(layout_base_1.LayoutBase));
exports.StackLayoutBase = StackLayoutBase;
StackLayoutBase.prototype.recycleNativeView = "auto";
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "vertical", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(StackLayoutBase);
//# sourceMappingURL=stack-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var stack_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js"));
var StackLayout = (function (_super) {
    __extends(StackLayout, _super);
    function StackLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StackLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.StackLayout(this._context);
    };
    StackLayout.prototype[stack_layout_common_1.orientationProperty.setNative] = function (value) {
        this.nativeViewProtected.setOrientation(value === "vertical" ? org.nativescript.widgets.Orientation.vertical : org.nativescript.widgets.Orientation.horizontal);
    };
    return StackLayout;
}(stack_layout_common_1.StackLayoutBase));
exports.StackLayout = StackLayout;
//# sourceMappingURL=stack-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var WrapLayoutBase = (function (_super) {
    __extends(WrapLayoutBase, _super);
    function WrapLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WrapLayoutBase = __decorate([
        layout_base_1.CSSType("WrapLayout")
    ], WrapLayoutBase);
    return WrapLayoutBase;
}(layout_base_1.LayoutBase));
exports.WrapLayoutBase = WrapLayoutBase;
WrapLayoutBase.prototype.recycleNativeView = "auto";
exports.itemWidthProperty = new layout_base_1.Property({
    name: "itemWidth", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemWidth = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemWidthProperty.register(WrapLayoutBase);
exports.itemHeightProperty = new layout_base_1.Property({
    name: "itemHeight", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemHeight = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemHeightProperty.register(WrapLayoutBase);
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "horizontal", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(WrapLayoutBase);
//# sourceMappingURL=wrap-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var wrap_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js"));
var WrapLayout = (function (_super) {
    __extends(WrapLayout, _super);
    function WrapLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WrapLayout.prototype.createNativeView = function () {
        return new org.nativescript.widgets.WrapLayout(this._context);
    };
    WrapLayout.prototype[wrap_layout_common_1.orientationProperty.setNative] = function (value) {
        this.nativeViewProtected.setOrientation(value === "vertical" ? org.nativescript.widgets.Orientation.vertical : org.nativescript.widgets.Orientation.horizontal);
    };
    WrapLayout.prototype[wrap_layout_common_1.itemWidthProperty.setNative] = function (value) {
        this.nativeViewProtected.setItemWidth(wrap_layout_common_1.Length.toDevicePixels(value, -1));
    };
    WrapLayout.prototype[wrap_layout_common_1.itemHeightProperty.setNative] = function (value) {
        this.nativeViewProtected.setItemHeight(wrap_layout_common_1.Length.toDevicePixels(value, -1));
    };
    return WrapLayout;
}(wrap_layout_common_1.WrapLayoutBase));
exports.WrapLayout = WrapLayout;
//# sourceMappingURL=wrap-layout.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ListPickerBase = (function (_super) {
    __extends(ListPickerBase, _super);
    function ListPickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPickerBase.prototype._getItemAsString = function (index) {
        var items = this.items;
        if (!items) {
            return " ";
        }
        var item = this.isItemsSource ? this.items.getItem(index) : this.items[index];
        return (item === undefined || item === null) ? index + "" : this.parseItem(item);
    };
    ListPickerBase.prototype.parseItem = function (item) {
        return this.textField ? item[this.textField] + "" : item + "";
    };
    ListPickerBase.prototype.updateSelectedValue = function (index) {
        var newVal = null;
        if (index >= 0) {
            var item = this.items[index];
            newVal = this.valueField ? item[this.valueField] : item;
        }
        if (this.selectedValue !== newVal) {
            this.set("selectedValue", newVal);
        }
    };
    ListPickerBase = __decorate([
        view_1.CSSType("ListPicker")
    ], ListPickerBase);
    return ListPickerBase;
}(view_1.View));
exports.ListPickerBase = ListPickerBase;
ListPickerBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueConverter: function (v) { return parseInt(v); },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        target.updateSelectedValue(value);
        return value;
    }
});
exports.selectedIndexProperty.register(ListPickerBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        var getItem = newValue && newValue.getItem;
        target.isItemsSource = typeof getItem === "function";
    }
});
exports.itemsProperty.register(ListPickerBase);
exports.textFieldProperty = new view_1.Property({
    name: "textField",
    defaultValue: ""
});
exports.textFieldProperty.register(ListPickerBase);
exports.valueFieldProperty = new view_1.Property({
    name: "valueField",
    defaultValue: ""
});
exports.valueFieldProperty.register(ListPickerBase);
exports.selectedValueProperty = new view_1.Property({
    name: "selectedValue",
    defaultValue: null
});
exports.selectedValueProperty.register(ListPickerBase);
//# sourceMappingURL=list-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js"));
var sdkVersion = lazy_1.default(function () { return parseInt(platform_1.device.sdkVersion); });
var Formatter;
var ValueChangeListener;
function initializeNativeClasses() {
    if (Formatter) {
        return;
    }
    var FormatterImpl = (function (_super) {
        __extends(FormatterImpl, _super);
        function FormatterImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FormatterImpl.prototype.format = function (index) {
            return this.owner._getItemAsString(index);
        };
        FormatterImpl = __decorate([
            Interfaces([android.widget.NumberPicker.Formatter])
        ], FormatterImpl);
        return FormatterImpl;
    }(java.lang.Object));
    var ValueChangeListenerImpl = (function (_super) {
        __extends(ValueChangeListenerImpl, _super);
        function ValueChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ValueChangeListenerImpl.prototype.onValueChange = function (picker, oldValue, newValue) {
            list_picker_common_1.selectedIndexProperty.nativeValueChange(this.owner, newValue);
            this.owner.updateSelectedValue(newValue);
        };
        ValueChangeListenerImpl = __decorate([
            Interfaces([android.widget.NumberPicker.OnValueChangeListener])
        ], ValueChangeListenerImpl);
        return ValueChangeListenerImpl;
    }(java.lang.Object));
    Formatter = FormatterImpl;
    ValueChangeListener = ValueChangeListenerImpl;
}
function getEditText(picker) {
    for (var i = 0, count = picker.getChildCount(); i < count; i++) {
        var child = picker.getChildAt(i);
        if (child instanceof android.widget.EditText) {
            return child;
        }
    }
    return null;
}
var selectorWheelPaintField;
function getSelectorWheelPaint(picker) {
    if (!selectorWheelPaintField) {
        selectorWheelPaintField = picker.getClass().getDeclaredField("mSelectorWheelPaint");
        selectorWheelPaintField.setAccessible(true);
    }
    return selectorWheelPaintField.get(picker);
}
var ListPicker = (function (_super) {
    __extends(ListPicker, _super);
    function ListPicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPicker.prototype.createNativeView = function () {
        var picker = new android.widget.NumberPicker(this._context);
        picker.setDescendantFocusability(android.widget.NumberPicker.FOCUS_BLOCK_DESCENDANTS);
        picker.setMinValue(0);
        picker.setMaxValue(0);
        picker.setValue(0);
        picker.setWrapSelectorWheel(false);
        return picker;
    };
    ListPicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeNativeClasses();
        var nativeView = this.nativeViewProtected;
        if (sdkVersion() < 29) {
            this._selectorWheelPaint = getSelectorWheelPaint(nativeView);
        }
        var formatter = new Formatter(this);
        nativeView.setFormatter(formatter);
        nativeView.formatter = formatter;
        var valueChangedListener = new ValueChangeListener(this);
        nativeView.setOnValueChangedListener(valueChangedListener);
        nativeView.valueChangedListener = valueChangedListener;
        var editText = getEditText(nativeView);
        if (editText) {
            nativeView.editText = editText;
            editText.setFilters([]);
            editText.setText(" ", android.widget.TextView.BufferType.NORMAL);
        }
    };
    ListPicker.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.formatter.owner = null;
        nativeView.valueChangedListener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    ListPicker.prototype._fixNumberPickerRendering = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.setFormatter(null);
        nativeView.setFormatter(nativeView.formatter);
        var editText = nativeView.editText;
        if (editText) {
            editText.setFilters([]);
            editText.invalidate();
        }
        nativeView.invalidate();
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.setNative] = function (value) {
        if (value >= 0) {
            this.nativeViewProtected.setValue(value);
        }
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.setNative] = function (value) {
        var maxValue = value && value.length > 0 ? value.length - 1 : 0;
        this.nativeViewProtected.setMaxValue(maxValue);
        this._fixNumberPickerRendering();
        list_picker_common_1.selectedIndexProperty.coerce(this);
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.getDefault] = function () {
        if (this._selectorWheelPaint) {
            return this._selectorWheelPaint.getColor();
        }
        return this.nativeView.getTextColor();
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof list_picker_common_1.Color ? value.android : value;
        if (this._selectorWheelPaint) {
            this._selectorWheelPaint.setColor(color);
            var editText = this.nativeViewProtected.editText;
            if (editText) {
                editText.setTextColor(color);
            }
        }
        else {
            this.nativeView.setTextColor(color);
        }
    };
    return ListPicker;
}(list_picker_common_1.ListPickerBase));
exports.ListPicker = ListPicker;
//# sourceMappingURL=list-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var knownMultiTemplates;
(function (knownMultiTemplates) {
    knownMultiTemplates.itemTemplates = "itemTemplates";
})(knownMultiTemplates = exports.knownMultiTemplates || (exports.knownMultiTemplates = {}));
var autoEffectiveRowHeight = -1;
var ListViewBase = (function (_super) {
    __extends(ListViewBase, _super);
    function ListViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._itemIdGenerator = function (_item, index) { return index; };
        _this._itemTemplateSelectorBindable = new label_1.Label();
        _this._defaultTemplate = {
            key: "default",
            createView: function () {
                if (_this.itemTemplate) {
                    return builder_1.parse(_this.itemTemplate, _this);
                }
                return undefined;
            }
        };
        _this._itemTemplatesInternal = new Array(_this._defaultTemplate);
        _this._effectiveRowHeight = autoEffectiveRowHeight;
        return _this;
    }
    Object.defineProperty(ListViewBase.prototype, "separatorColor", {
        get: function () {
            return this.style.separatorColor;
        },
        set: function (value) {
            this.style.separatorColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemTemplateSelector", {
        get: function () {
            return this._itemTemplateSelector;
        },
        set: function (value) {
            var _this = this;
            if (typeof value === "string") {
                this._itemTemplateSelectorBindable.bind({
                    sourceProperty: null,
                    targetProperty: "templateKey",
                    expression: value
                });
                this._itemTemplateSelector = function (item, index, items) {
                    item["$index"] = index;
                    if (_this._itemTemplateSelectorBindable.bindingContext === item) {
                        _this._itemTemplateSelectorBindable.bindingContext = null;
                    }
                    _this._itemTemplateSelectorBindable.bindingContext = item;
                    return _this._itemTemplateSelectorBindable.get("templateKey");
                };
            }
            else if (typeof value === "function") {
                this._itemTemplateSelector = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemIdGenerator", {
        get: function () {
            return this._itemIdGenerator;
        },
        set: function (generatorFn) {
            this._itemIdGenerator = generatorFn;
        },
        enumerable: true,
        configurable: true
    });
    ListViewBase.prototype.refresh = function () {
    };
    ListViewBase.prototype.scrollToIndex = function (index) {
    };
    ListViewBase.prototype.scrollToIndexAnimated = function (index) {
    };
    ListViewBase.prototype._getItemTemplate = function (index) {
        var templateKey = "default";
        if (this.itemTemplateSelector) {
            var dataItem = this._getDataItem(index);
            templateKey = this._itemTemplateSelector(dataItem, index, this.items);
        }
        for (var i = 0, length_1 = this._itemTemplatesInternal.length; i < length_1; i++) {
            if (this._itemTemplatesInternal[i].key === templateKey) {
                return this._itemTemplatesInternal[i];
            }
        }
        return this._itemTemplatesInternal[0];
    };
    ListViewBase.prototype._prepareItem = function (item, index) {
        if (item) {
            item.bindingContext = this._getDataItem(index);
        }
    };
    ListViewBase.prototype._getDataItem = function (index) {
        var thisItems = this.items;
        return thisItems.getItem ? thisItems.getItem(index) : thisItems[index];
    };
    ListViewBase.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    ListViewBase.prototype._onItemsChanged = function (args) {
        this.refresh();
    };
    ListViewBase.prototype._onRowHeightPropertyChanged = function (oldValue, newValue) {
        this.refresh();
    };
    ListViewBase.prototype.isItemAtIndexVisible = function (index) {
        return false;
    };
    ListViewBase.prototype.updateEffectiveRowHeight = function () {
        exports.rowHeightProperty.coerce(this);
    };
    ListViewBase.itemLoadingEvent = "itemLoading";
    ListViewBase.itemTapEvent = "itemTap";
    ListViewBase.loadMoreItemsEvent = "loadMoreItems";
    ListViewBase.knownFunctions = ["itemTemplateSelector", "itemIdGenerator"];
    ListViewBase = __decorate([
        view_1.CSSType("ListView")
    ], ListViewBase);
    return ListViewBase;
}(view_1.ContainerView));
exports.ListViewBase = ListViewBase;
ListViewBase.prototype.recycleNativeView = "auto";
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof view_1.Observable) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof view_1.Observable) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target.refresh();
    }
});
exports.itemsProperty.register(ListViewBase);
exports.itemTemplateProperty = new view_1.Property({
    name: "itemTemplate", valueChanged: function (target) {
        target.refresh();
    }
});
exports.itemTemplateProperty.register(ListViewBase);
exports.itemTemplatesProperty = new view_1.Property({
    name: "itemTemplates", valueConverter: function (value) {
        if (typeof value === "string") {
            return builder_1.parseMultipleTemplates(value);
        }
        return value;
    }
});
exports.itemTemplatesProperty.register(ListViewBase);
var defaultRowHeight = "auto";
exports.rowHeightProperty = new view_1.CoercibleProperty({
    name: "rowHeight", defaultValue: defaultRowHeight, equalityComparer: view_1.Length.equals,
    coerceValue: function (target, value) {
        return target.nativeViewProtected ? value : defaultRowHeight;
    },
    valueChanged: function (target, oldValue, newValue) {
        target._effectiveRowHeight = view_1.Length.toDevicePixels(newValue, autoEffectiveRowHeight);
        target._onRowHeightPropertyChanged(oldValue, newValue);
    }, valueConverter: view_1.Length.parse
});
exports.rowHeightProperty.register(ListViewBase);
exports.iosEstimatedRowHeightProperty = new view_1.Property({
    name: "iosEstimatedRowHeight", valueConverter: function (v) { return view_1.Length.parse(v); }
});
exports.iosEstimatedRowHeightProperty.register(ListViewBase);
exports.separatorColorProperty = new view_1.CssProperty({ name: "separatorColor", cssName: "separator-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.separatorColorProperty.register(view_1.Style);
//# sourceMappingURL=list-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var proxy_view_container_1 = __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js");
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js"));
var ITEMLOADING = list_view_common_1.ListViewBase.itemLoadingEvent;
var LOADMOREITEMS = list_view_common_1.ListViewBase.loadMoreItemsEvent;
var ITEMTAP = list_view_common_1.ListViewBase.itemTapEvent;
var ItemClickListener;
function initializeItemClickListener() {
    if (ItemClickListener) {
        return;
    }
    var ItemClickListenerImpl = (function (_super) {
        __extends(ItemClickListenerImpl, _super);
        function ItemClickListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ItemClickListenerImpl.prototype.onItemClick = function (parent, convertView, index, id) {
            var owner = this.owner;
            var view = owner._realizedTemplates.get(owner._getItemTemplate(index).key).get(convertView);
            owner.notify({ eventName: ITEMTAP, object: owner, index: index, view: view });
        };
        ItemClickListenerImpl = __decorate([
            Interfaces([android.widget.AdapterView.OnItemClickListener])
        ], ItemClickListenerImpl);
        return ItemClickListenerImpl;
    }(java.lang.Object));
    ItemClickListener = ItemClickListenerImpl;
}
var ListView = (function (_super) {
    __extends(ListView, _super);
    function ListView() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._androidViewId = -1;
        _this._realizedItems = new Map();
        _this._realizedTemplates = new Map();
        return _this;
    }
    ListView.prototype.createNativeView = function () {
        var listView = new android.widget.ListView(this._context);
        listView.setDescendantFocusability(android.view.ViewGroup.FOCUS_AFTER_DESCENDANTS);
        listView.setCacheColorHint(android.graphics.Color.TRANSPARENT);
        return listView;
    };
    ListView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this.updateEffectiveRowHeight();
        var nativeView = this.nativeViewProtected;
        initializeItemClickListener();
        ensureListViewAdapterClass();
        var adapter = new ListViewAdapterClass(this);
        nativeView.setAdapter(adapter);
        nativeView.adapter = adapter;
        var itemClickListener = new ItemClickListener(this);
        nativeView.setOnItemClickListener(itemClickListener);
        nativeView.itemClickListener = itemClickListener;
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        nativeView.setId(this._androidViewId);
    };
    ListView.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.setAdapter(null);
        nativeView.itemClickListener.owner = null;
        nativeView.adapter.owner = null;
        this.clearRealizedCells();
        _super.prototype.disposeNativeView.call(this);
    };
    ListView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.requestLayout();
    };
    ListView.prototype.refresh = function () {
        var nativeView = this.nativeViewProtected;
        if (!nativeView || !nativeView.getAdapter()) {
            return;
        }
        this._realizedItems.forEach(function (view, nativeView) {
            if (!(view.bindingContext instanceof list_view_common_1.Observable)) {
                view.bindingContext = null;
            }
        });
        nativeView.getAdapter().notifyDataSetChanged();
    };
    ListView.prototype.scrollToIndex = function (index) {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.setSelection(index);
        }
    };
    ListView.prototype.scrollToIndexAnimated = function (index) {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.smoothScrollToPosition(index);
        }
    };
    Object.defineProperty(ListView.prototype, "_childrenCount", {
        get: function () {
            return this._realizedItems.size;
        },
        enumerable: true,
        configurable: true
    });
    ListView.prototype.eachChildView = function (callback) {
        this._realizedItems.forEach(function (view, nativeView) {
            if (view.parent instanceof ListView) {
                callback(view);
            }
            else {
                if (view.parent) {
                    callback(view.parent);
                }
            }
        });
    };
    ListView.prototype._dumpRealizedTemplates = function () {
        console.log("Realized Templates:");
        this._realizedTemplates.forEach(function (value, index) {
            console.log("\t" + index + ":");
            value.forEach(function (value, index) {
                console.log("\t\t" + index.hashCode() + ": " + value);
            });
        });
        console.log("Realized Items Size: " + this._realizedItems.size);
    };
    ListView.prototype.clearRealizedCells = function () {
        var _this = this;
        this._realizedItems.forEach(function (view, nativeView) {
            if (view.parent) {
                if (!(view.parent instanceof ListView)) {
                    _this._removeView(view.parent);
                }
                view.parent._removeView(view);
            }
        });
        this._realizedItems.clear();
        this._realizedTemplates.clear();
    };
    ListView.prototype.isItemAtIndexVisible = function (index) {
        var nativeView = this.nativeViewProtected;
        var start = nativeView.getFirstVisiblePosition();
        var end = nativeView.getLastVisiblePosition();
        return (index >= start && index <= end);
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        return {
            dividerHeight: nativeView.getDividerHeight(),
            divider: nativeView.getDivider()
        };
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (value instanceof list_view_common_1.Color) {
            nativeView.setDivider(new android.graphics.drawable.ColorDrawable(value.android));
            nativeView.setDividerHeight(1);
        }
        else {
            nativeView.setDivider(value.divider);
            nativeView.setDividerHeight(value.dividerHeight);
        }
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.getDefault] = function () {
        return null;
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.setNative] = function (value) {
        this._itemTemplatesInternal = new Array(this._defaultTemplate);
        if (value) {
            this._itemTemplatesInternal = this._itemTemplatesInternal.concat(value);
        }
        this.nativeViewProtected.setAdapter(new ListViewAdapterClass(this));
        this.refresh();
    };
    __decorate([
        profiling_1.profile
    ], ListView.prototype, "createNativeView", null);
    return ListView;
}(list_view_common_1.ListViewBase));
exports.ListView = ListView;
var ListViewAdapterClass;
function ensureListViewAdapterClass() {
    if (ListViewAdapterClass) {
        return;
    }
    var ListViewAdapter = (function (_super) {
        __extends(ListViewAdapter, _super);
        function ListViewAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        ListViewAdapter.prototype.getCount = function () {
            return this.owner && this.owner.items && this.owner.items.length ? this.owner.items.length : 0;
        };
        ListViewAdapter.prototype.getItem = function (i) {
            if (this.owner && this.owner.items && i < this.owner.items.length) {
                var getItem = this.owner.items.getItem;
                return getItem ? getItem.call(this.owner.items, i) : this.owner.items[i];
            }
            return null;
        };
        ListViewAdapter.prototype.getItemId = function (i) {
            var item = this.getItem(i);
            var id = i;
            if (this.owner && item && this.owner.items) {
                id = this.owner.itemIdGenerator(item, i, this.owner.items);
            }
            return long(id);
        };
        ListViewAdapter.prototype.hasStableIds = function () {
            return true;
        };
        ListViewAdapter.prototype.getViewTypeCount = function () {
            return this.owner._itemTemplatesInternal.length;
        };
        ListViewAdapter.prototype.getItemViewType = function (index) {
            var template = this.owner._getItemTemplate(index);
            var itemViewType = this.owner._itemTemplatesInternal.indexOf(template);
            return itemViewType;
        };
        ListViewAdapter.prototype.getView = function (index, convertView, parent) {
            if (!this.owner) {
                return null;
            }
            var totalItemCount = this.owner.items ? this.owner.items.length : 0;
            if (index === (totalItemCount - 1)) {
                this.owner.notify({ eventName: LOADMOREITEMS, object: this.owner });
            }
            var template = this.owner._getItemTemplate(index);
            var view;
            if (convertView) {
                view = this.owner._realizedTemplates.get(template.key).get(convertView);
                if (!view) {
                    throw new Error("There is no entry with key '" + convertView + "' in the realized views cache for template with key'" + template.key + "'.");
                }
            }
            else {
                view = template.createView();
            }
            var args = {
                eventName: ITEMLOADING, object: this.owner, index: index, view: view,
                android: parent,
                ios: undefined
            };
            this.owner.notify(args);
            if (!args.view) {
                args.view = this.owner._getDefaultItemContent(index);
            }
            if (args.view) {
                if (this.owner._effectiveRowHeight > -1) {
                    args.view.height = this.owner.rowHeight;
                }
                else {
                    args.view.height = list_view_common_1.unsetValue;
                }
                this.owner._prepareItem(args.view, index);
                if (!args.view.parent) {
                    if (args.view instanceof layout_base_1.LayoutBase &&
                        !(args.view instanceof proxy_view_container_1.ProxyViewContainer)) {
                        this.owner._addView(args.view);
                        convertView = args.view.nativeViewProtected;
                    }
                    else {
                        var sp = new stack_layout_1.StackLayout();
                        sp.addChild(args.view);
                        this.owner._addView(sp);
                        convertView = sp.nativeViewProtected;
                    }
                }
                var realizedItemsForTemplateKey = this.owner._realizedTemplates.get(template.key);
                if (!realizedItemsForTemplateKey) {
                    realizedItemsForTemplateKey = new Map();
                    this.owner._realizedTemplates.set(template.key, realizedItemsForTemplateKey);
                }
                realizedItemsForTemplateKey.set(convertView, args.view);
                this.owner._realizedItems.set(convertView, args.view);
            }
            return convertView;
        };
        __decorate([
            profiling_1.profile
        ], ListViewAdapter.prototype, "getView", null);
        return ListViewAdapter;
    }(android.widget.BaseAdapter));
    ListViewAdapterClass = ListViewAdapter;
}
//# sourceMappingURL=list-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var action_bar_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var PageBase = (function (_super) {
    __extends(PageBase, _super);
    function PageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PageBase_1 = PageBase;
    Object.defineProperty(PageBase.prototype, "navigationContext", {
        get: function () {
            return this._navigationContext;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "actionBar", {
        get: function () {
            if (!this._actionBar) {
                this.hasActionBar = true;
                this._actionBar = new action_bar_1.ActionBar();
                this._addView(this._actionBar);
            }
            return this._actionBar;
        },
        set: function (value) {
            if (!value) {
                throw new Error("ActionBar cannot be null or undefined.");
            }
            if (this._actionBar !== value) {
                if (this._actionBar) {
                    this._removeView(this._actionBar);
                }
                this.hasActionBar = true;
                this._actionBar = value;
                this._addView(this._actionBar);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "statusBarStyle", {
        get: function () {
            return this.style.statusBarStyle;
        },
        set: function (value) {
            this.style.statusBarStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "androidStatusBarBackground", {
        get: function () {
            return this.style.androidStatusBarBackground;
        },
        set: function (value) {
            this.style.androidStatusBarBackground = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "page", {
        get: function () {
            return this;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof action_bar_1.ActionBar) {
            this.actionBar = value;
        }
        else {
            _super.prototype._addChildFromBuilder.call(this, name, value);
        }
    };
    PageBase.prototype.getKeyframeAnimationWithName = function (animationName) {
        return this._styleScope.getKeyframeAnimationWithName(animationName);
    };
    Object.defineProperty(PageBase.prototype, "frame", {
        get: function () {
            var frame = this.parent;
            return frame instanceof frame_1.Frame ? frame : undefined;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype.createNavigatedData = function (eventName, isBackNavigation) {
        return {
            eventName: eventName,
            object: this,
            context: this.navigationContext,
            isBackNavigation: isBackNavigation
        };
    };
    PageBase.prototype.onNavigatingTo = function (context, isBackNavigation, bindingContext) {
        this._navigationContext = context;
        if (isBackNavigation && this._styleScope) {
            this._styleScope.ensureSelectors();
            if (!this._cssState.isSelectorsLatestVersionApplied()) {
                this._onCssStateChange();
            }
        }
        if (!isBackNavigation && bindingContext !== undefined && bindingContext !== null) {
            this.bindingContext = bindingContext;
        }
        this.notify(this.createNavigatedData(PageBase_1.navigatingToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedTo = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatingFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatingFromEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedFromEvent, isBackNavigation));
        this._navigationContext = undefined;
    };
    PageBase.prototype.eachChildView = function (callback) {
        _super.prototype.eachChildView.call(this, callback);
        if (this.actionBar) {
            callback(this.actionBar);
        }
    };
    Object.defineProperty(PageBase.prototype, "_childrenCount", {
        get: function () {
            return (this.content ? 1 : 0) + (this._actionBar ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    var PageBase_1;
    PageBase.navigatingToEvent = "navigatingTo";
    PageBase.navigatedToEvent = "navigatedTo";
    PageBase.navigatingFromEvent = "navigatingFrom";
    PageBase.navigatedFromEvent = "navigatedFrom";
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingFrom", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedFrom", null);
    PageBase = PageBase_1 = __decorate([
        content_view_1.CSSType("Page")
    ], PageBase);
    return PageBase;
}(content_view_1.ContentView));
exports.PageBase = PageBase;
PageBase.prototype.recycleNativeView = "never";
exports.actionBarHiddenProperty = new content_view_1.Property({ name: "actionBarHidden", affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.actionBarHiddenProperty.register(PageBase);
exports.backgroundSpanUnderStatusBarProperty = new content_view_1.Property({ name: "backgroundSpanUnderStatusBar", defaultValue: false, affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.backgroundSpanUnderStatusBarProperty.register(PageBase);
exports.enableSwipeBackNavigationProperty = new content_view_1.Property({ name: "enableSwipeBackNavigation", defaultValue: true, valueConverter: content_view_1.booleanConverter });
exports.enableSwipeBackNavigationProperty.register(PageBase);
exports.statusBarStyleProperty = new content_view_1.CssProperty({ name: "statusBarStyle", cssName: "status-bar-style" });
exports.statusBarStyleProperty.register(content_view_1.Style);
exports.androidStatusBarBackgroundProperty = new content_view_1.CssProperty({
    name: "androidStatusBarBackground", cssName: "android-status-bar-background",
    equalityComparer: content_view_1.Color.equals, valueConverter: function (v) { return new content_view_1.Color(v); }
});
exports.androidStatusBarBackgroundProperty.register(content_view_1.Style);
//# sourceMappingURL=page-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var page_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js");
var action_bar_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js");
var grid_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js"));
var SYSTEM_UI_FLAG_LIGHT_STATUS_BAR = 0x00002000;
var STATUS_BAR_LIGHT_BCKG = -657931;
var STATUS_BAR_DARK_BCKG = 1711276032;
var Page = (function (_super) {
    __extends(Page, _super);
    function Page() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Page.prototype.createNativeView = function () {
        var layout = new org.nativescript.widgets.GridLayout(this._context);
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        return layout;
    };
    Page.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this.nativeViewProtected.setBackgroundColor(-1);
    };
    Page.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (this.nativeViewProtected && child.nativeViewProtected) {
            if (child instanceof action_bar_1.ActionBar) {
                grid_layout_1.GridLayout.setRow(child, 0);
                child.horizontalAlignment = "stretch";
                child.verticalAlignment = "top";
            }
            else {
                grid_layout_1.GridLayout.setRow(child, 1);
            }
        }
        return _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
    };
    Page.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this.actionBarHidden !== undefined) {
            this.updateActionBar();
        }
    };
    Page.prototype.updateActionBar = function () {
        this.actionBar.update();
    };
    Page.prototype[page_common_1.actionBarHiddenProperty.setNative] = function (value) {
        this.updateActionBar();
    };
    Page.prototype[page_common_1.statusBarStyleProperty.getDefault] = function () {
        if (platform_1.device.sdkVersion >= "21") {
            var window_1 = this._context.getWindow();
            var decorView = window_1.getDecorView();
            return {
                color: window_1.getStatusBarColor(),
                systemUiVisibility: decorView.getSystemUiVisibility()
            };
        }
        return null;
    };
    Page.prototype[page_common_1.statusBarStyleProperty.setNative] = function (value) {
        if (platform_1.device.sdkVersion >= "21") {
            var window_2 = this._context.getWindow();
            var decorView = window_2.getDecorView();
            if (value === "light") {
                window_2.setStatusBarColor(STATUS_BAR_LIGHT_BCKG);
                decorView.setSystemUiVisibility(SYSTEM_UI_FLAG_LIGHT_STATUS_BAR);
            }
            else if (value === "dark") {
                window_2.setStatusBarColor(STATUS_BAR_DARK_BCKG);
                decorView.setSystemUiVisibility(0);
            }
            else {
                window_2.setStatusBarColor(value.color);
                decorView.setSystemUiVisibility(value.systemUiVisibility);
            }
        }
    };
    Page.prototype[page_common_1.androidStatusBarBackgroundProperty.getDefault] = function () {
        if (platform_1.device.sdkVersion >= "21") {
            var window_3 = this._context.getWindow();
            return window_3.getStatusBarColor();
        }
        return null;
    };
    Page.prototype[page_common_1.androidStatusBarBackgroundProperty.setNative] = function (value) {
        if (platform_1.device.sdkVersion >= "21") {
            var window_4 = this._context.getWindow();
            var color = value instanceof page_common_1.Color ? value.android : value;
            window_4.setStatusBarColor(color);
        }
    };
    __decorate([
        profiling_1.profile
    ], Page.prototype, "onLoaded", null);
    return Page;
}(page_common_1.PageBase));
exports.Page = Page;
//# sourceMappingURL=page.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/placeholder/placeholder.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Placeholder = (function (_super) {
    __extends(Placeholder, _super);
    function Placeholder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Placeholder_1 = Placeholder;
    Placeholder.prototype.createNativeView = function () {
        var args = { eventName: Placeholder_1.creatingViewEvent, object: this, view: undefined, context: this._context };
        this.notify(args);
        return args.view;
    };
    var Placeholder_1;
    Placeholder.creatingViewEvent = "creatingView";
    Placeholder = Placeholder_1 = __decorate([
        view_1.CSSType("Placeholder")
    ], Placeholder);
    return Placeholder;
}(view_1.View));
exports.Placeholder = Placeholder;
//# sourceMappingURL=placeholder.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ProgressBase = (function (_super) {
    __extends(ProgressBase, _super);
    function ProgressBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ProgressBase = __decorate([
        view_1.CSSType("Progress")
    ], ProgressBase);
    return ProgressBase;
}(view_1.View));
exports.ProgressBase = ProgressBase;
ProgressBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value",
    defaultValue: 0,
    coerceValue: function (t, v) {
        return v < 0 ? 0 : Math.min(v, t.maxValue);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.valueProperty.register(ProgressBase);
exports.maxValueProperty = new view_1.Property({
    name: "maxValue",
    defaultValue: 100,
    valueChanged: function (target, oldValue, newValue) {
        exports.valueProperty.coerce(target);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.maxValueProperty.register(ProgressBase);
//# sourceMappingURL=progress-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var progress_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js"));
var R_ATTR_PROGRESS_BAR_STYLE_HORIZONTAL = 0x01010078;
var Progress = (function (_super) {
    __extends(Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.createNativeView = function () {
        return new android.widget.ProgressBar(this._context, null, R_ATTR_PROGRESS_BAR_STYLE_HORIZONTAL);
    };
    Progress.prototype[progress_common_1.valueProperty.getDefault] = function () {
        return 0;
    };
    Progress.prototype[progress_common_1.valueProperty.setNative] = function (value) {
        this.nativeViewProtected.setProgress(value);
    };
    Progress.prototype[progress_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Progress.prototype[progress_common_1.maxValueProperty.setNative] = function (value) {
        this.nativeViewProtected.setMax(value);
    };
    Progress.prototype[progress_common_1.colorProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.colorProperty.setNative] = function (value) {
        var progressDrawable = this.nativeViewProtected.getProgressDrawable();
        if (!progressDrawable) {
            return;
        }
        if (value instanceof progress_common_1.Color) {
            progressDrawable.setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            progressDrawable.clearColorFilter();
        }
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.setNative] = function (value) {
        var progressDrawable = this.nativeViewProtected.getProgressDrawable();
        if (!progressDrawable) {
            return;
        }
        if (progressDrawable instanceof android.graphics.drawable.LayerDrawable && progressDrawable.getNumberOfLayers() > 0) {
            var backgroundDrawable = progressDrawable.getDrawable(0);
            if (backgroundDrawable) {
                if (value instanceof progress_common_1.Color) {
                    backgroundDrawable.setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
                }
                else {
                    backgroundDrawable.clearColorFilter();
                }
            }
        }
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Progress;
}(progress_common_1.ProgressBase));
exports.Progress = Progress;
//# sourceMappingURL=progress.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var ProxyViewContainer = (function (_super) {
    __extends(ProxyViewContainer, _super);
    function ProxyViewContainer() {
        var _this = _super.call(this) || this;
        _this.nativeViewProtected = undefined;
        return _this;
    }
    Object.defineProperty(ProxyViewContainer.prototype, "ios", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "android", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "isLayoutRequested", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    ProxyViewContainer.prototype.createNativeView = function () {
        return undefined;
    };
    ProxyViewContainer.prototype._getNativeViewsCount = function () {
        var result = 0;
        this.eachChildView(function (cv) {
            result += cv._getNativeViewsCount();
            return true;
        });
        return result;
    };
    ProxyViewContainer.prototype._eachLayoutView = function (callback) {
        this.eachChildView(function (cv) {
            if (!cv.isCollapsed) {
                cv._eachLayoutView(callback);
            }
            return true;
        });
    };
    ProxyViewContainer.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ViewContainer._addViewToNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            var baseIndex = 0;
            var insideIndex = 0;
            if (parent instanceof layout_base_1.LayoutBase) {
                baseIndex = parent._childIndexToNativeChildIndex(parent.getChildIndex(this));
            }
            if (atIndex !== undefined) {
                insideIndex = this._childIndexToNativeChildIndex(atIndex);
            }
            else {
                insideIndex = this._getNativeViewsCount();
            }
            if (layout_base_1.traceEnabled()) {
                layout_base_1.traceWrite("ProxyViewContainer._addViewToNativeVisualTree at: " + atIndex + " base: " + baseIndex + " additional: " + insideIndex, layout_base_1.traceCategories.ViewHierarchy);
            }
            return parent._addViewToNativeVisualTree(child, baseIndex + insideIndex);
        }
        return false;
    };
    ProxyViewContainer.prototype._removeViewFromNativeVisualTree = function (child) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ProxyViewContainer._removeViewFromNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            return parent._removeViewFromNativeVisualTree(child);
        }
    };
    ProxyViewContainer.prototype._registerLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._registerLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._unregisterLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._unregisterLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._parentChanged = function (oldParent) {
        _super.prototype._parentChanged.call(this, oldParent);
        var addingToParent = this.parent && !oldParent;
        var newLayout = this.parent;
        var oldLayout = oldParent;
        if (addingToParent && newLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                newLayout._registerLayoutChild(child);
                return true;
            });
        }
        else if (oldLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                oldLayout._unregisterLayoutChild(child);
                return true;
            });
        }
    };
    ProxyViewContainer = __decorate([
        layout_base_1.CSSType("ProxyViewContainer")
    ], ProxyViewContainer);
    return ProxyViewContainer;
}(layout_base_1.LayoutBase));
exports.ProxyViewContainer = ProxyViewContainer;
//# sourceMappingURL=proxy-view-container.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/repeater/repeater.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var Repeater = (function (_super) {
    __extends(Repeater, _super);
    function Repeater() {
        var _this = _super.call(this) || this;
        _this._isDirty = false;
        _this.itemsLayout = new stack_layout_1.StackLayout();
        return _this;
    }
    Repeater.prototype.onLoaded = function () {
        if (this._isDirty) {
            this.refresh();
        }
        _super.prototype.onLoaded.call(this);
    };
    Repeater.prototype._requestRefresh = function () {
        this._isDirty = true;
        if (this.isLoaded) {
            this.refresh();
        }
    };
    Repeater.prototype.refresh = function () {
        if (this.itemsLayout) {
            this.itemsLayout.removeChildren();
        }
        if (!this.items) {
            return;
        }
        var length = this.items.length;
        for (var i = 0; i < length; i++) {
            var viewToAdd = this.itemTemplate ? builder_1.parse(this.itemTemplate, this) : this._getDefaultItemContent(i);
            var dataItem = this._getDataItem(i);
            viewToAdd.bindingContext = dataItem;
            this.itemsLayout.addChild(viewToAdd);
        }
        this._isDirty = false;
    };
    Repeater.prototype._onItemsChanged = function (data) {
        this._requestRefresh();
    };
    Repeater.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    Repeater.prototype._getDataItem = function (index) {
        var items = this.items;
        return items.getItem ? items.getItem(index) : this.items[index];
    };
    Object.defineProperty(Repeater.prototype, "_childrenCount", {
        get: function () {
            return this.itemsLayout ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    Repeater.prototype.eachChildView = function (callback) {
        if (this.itemsLayout) {
            callback(this.itemsLayout);
        }
    };
    Repeater.prototype.onLayout = function (left, top, right, bottom) {
        var insets = this.getSafeAreaInsets();
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childLeft = paddingLeft;
        var childTop = paddingTop;
        var childRight = right - left - paddingRight;
        var childBottom = bottom - top - paddingBottom;
        layout_base_1.View.layoutChild(this, this.itemsLayout, childLeft, childTop, childRight, childBottom);
    };
    Repeater.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = layout_base_1.View.measureChild(this, this.itemsLayout, widthMeasureSpec, heightMeasureSpec);
        var width = layout_base_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = layout_base_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = layout_base_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = layout_base_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = layout_base_1.View.resolveSizeAndState(result.measuredWidth, width, widthMode, 0);
        var heightAndState = layout_base_1.View.resolveSizeAndState(result.measuredHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    __decorate([
        profiling_1.profile
    ], Repeater.prototype, "onLoaded", null);
    Repeater = __decorate([
        layout_base_1.CSSType("Repeater")
    ], Repeater);
    return Repeater;
}(layout_base_1.CustomLayoutView));
exports.Repeater = Repeater;
Repeater.prototype.recycleNativeView = "auto";
exports.itemTemplateProperty = new layout_base_1.Property({
    name: "itemTemplate", affectsLayout: true, valueChanged: function (target) {
        target._requestRefresh();
    }
});
exports.itemTemplateProperty.register(Repeater);
exports.itemsProperty = new layout_base_1.Property({
    name: "items", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target._requestRefresh();
    }
});
exports.itemsProperty.register(Repeater);
exports.itemsLayoutProperty = new layout_base_1.Property({
    name: "itemsLayout", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue) {
            target._removeView(oldValue);
            oldValue.removeChildren();
        }
        if (newValue) {
            target._addView(newValue);
        }
        target._requestRefresh();
    }
});
exports.itemsLayoutProperty.register(Repeater);
//# sourceMappingURL=repeater.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var ScrollViewBase = (function (_super) {
    __extends(ScrollViewBase, _super);
    function ScrollViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._scrollChangeCount = 0;
        return _this;
    }
    ScrollViewBase_1 = ScrollViewBase;
    ScrollViewBase.prototype.addEventListener = function (arg, callback, thisArg) {
        _super.prototype.addEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount++;
            this.attach();
        }
    };
    ScrollViewBase.prototype.removeEventListener = function (arg, callback, thisArg) {
        _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount--;
            this.dettach();
        }
    };
    ScrollViewBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.attach();
    };
    ScrollViewBase.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.dettach();
    };
    ScrollViewBase.prototype.attach = function () {
        if (this._scrollChangeCount > 0 && this.isLoaded) {
            this.attachNative();
        }
    };
    ScrollViewBase.prototype.dettach = function () {
        if (this._scrollChangeCount === 0 && this.isLoaded) {
            this.dettachNative();
        }
    };
    ScrollViewBase.prototype.attachNative = function () {
    };
    ScrollViewBase.prototype.dettachNative = function () {
    };
    Object.defineProperty(ScrollViewBase.prototype, "horizontalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "verticalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableWidth", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    var ScrollViewBase_1;
    ScrollViewBase.scrollEvent = "scroll";
    __decorate([
        profiling_1.profile
    ], ScrollViewBase.prototype, "onLoaded", null);
    ScrollViewBase = ScrollViewBase_1 = __decorate([
        content_view_1.CSSType("ScrollView")
    ], ScrollViewBase);
    return ScrollViewBase;
}(content_view_1.ContentView));
exports.ScrollViewBase = ScrollViewBase;
var converter = content_view_1.makeParser(content_view_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new content_view_1.Property({
    name: "orientation", defaultValue: "vertical", affectsLayout: true,
    valueChanged: function (target, oldValue, newValue) {
        target._onOrientationChanged();
    },
    valueConverter: converter
});
exports.orientationProperty.register(ScrollViewBase);
exports.scrollBarIndicatorVisibleProperty = new content_view_1.Property({
    name: "scrollBarIndicatorVisible", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.scrollBarIndicatorVisibleProperty.register(ScrollViewBase);
exports.isScrollEnabledProperty = new content_view_1.Property({
    name: "isScrollEnabled", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.isScrollEnabledProperty.register(ScrollViewBase);
//# sourceMappingURL=scroll-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var scroll_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js"));
var ScrollView = (function (_super) {
    __extends(ScrollView, _super);
    function ScrollView() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._androidViewId = -1;
        _this._lastScrollX = -1;
        _this._lastScrollY = -1;
        return _this;
    }
    Object.defineProperty(ScrollView.prototype, "horizontalOffset", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView) {
                return 0;
            }
            return nativeView.getScrollX() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "verticalOffset", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView) {
                return 0;
            }
            return nativeView.getScrollY() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableWidth", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView || this.orientation !== "horizontal") {
                return 0;
            }
            return nativeView.getScrollableLength() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableHeight", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (!nativeView || this.orientation !== "vertical") {
                return 0;
            }
            return nativeView.getScrollableLength() / scroll_view_common_1.layout.getDisplayDensity();
        },
        enumerable: true,
        configurable: true
    });
    ScrollView.prototype[scroll_view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setClickable(value);
        this.nativeViewProtected.setFocusable(value);
        this.nativeViewProtected.setScrollEnabled(value);
    };
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.getDefault] = function () {
        return this.nativeViewProtected.getScrollEnabled();
    };
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setScrollEnabled(value);
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.getDefault] = function () {
        return true;
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.setNative] = function (value) {
        if (this.orientation === "horizontal") {
            this.nativeViewProtected.setHorizontalScrollBarEnabled(value);
        }
        else {
            this.nativeViewProtected.setVerticalScrollBarEnabled(value);
        }
    };
    ScrollView.prototype.scrollToVerticalOffset = function (value, animated) {
        var nativeView = this.nativeViewProtected;
        if (nativeView && this.orientation === "vertical" && this.isScrollEnabled) {
            value *= scroll_view_common_1.layout.getDisplayDensity();
            if (animated) {
                nativeView.smoothScrollTo(0, value);
            }
            else {
                nativeView.scrollTo(0, value);
            }
        }
    };
    ScrollView.prototype.scrollToHorizontalOffset = function (value, animated) {
        var nativeView = this.nativeViewProtected;
        if (nativeView && this.orientation === "horizontal" && this.isScrollEnabled) {
            value *= scroll_view_common_1.layout.getDisplayDensity();
            if (animated) {
                nativeView.smoothScrollTo(value, 0);
            }
            else {
                nativeView.scrollTo(value, 0);
            }
        }
    };
    ScrollView.prototype.createNativeView = function () {
        return this.orientation === "horizontal" ? new org.nativescript.widgets.HorizontalScrollView(this._context) : new org.nativescript.widgets.VerticalScrollView(this._context);
    };
    ScrollView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        this.nativeViewProtected.setId(this._androidViewId);
    };
    ScrollView.prototype._onOrientationChanged = function () {
        if (this.nativeViewProtected) {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1._removeView(this);
                parent_1._addView(this);
            }
        }
    };
    ScrollView.prototype.attachNative = function () {
        var that = new WeakRef(this);
        this.handler = new android.view.ViewTreeObserver.OnScrollChangedListener({
            onScrollChanged: function () {
                var owner = that.get();
                if (owner) {
                    owner._onScrollChanged();
                }
            }
        });
        this.nativeViewProtected.getViewTreeObserver().addOnScrollChangedListener(this.handler);
    };
    ScrollView.prototype._onScrollChanged = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            var newScrollX = nativeView.getScrollX();
            var newScrollY = nativeView.getScrollY();
            if (newScrollX !== this._lastScrollX || newScrollY !== this._lastScrollY) {
                this.notify({
                    object: this,
                    eventName: ScrollView.scrollEvent,
                    scrollX: newScrollX / scroll_view_common_1.layout.getDisplayDensity(),
                    scrollY: newScrollY / scroll_view_common_1.layout.getDisplayDensity()
                });
                this._lastScrollX = newScrollX;
                this._lastScrollY = newScrollY;
            }
        }
    };
    ScrollView.prototype.dettachNative = function () {
        this.nativeViewProtected.getViewTreeObserver().removeOnScrollChangedListener(this.handler);
        this.handler = null;
    };
    return ScrollView;
}(scroll_view_common_1.ScrollViewBase));
exports.ScrollView = ScrollView;
ScrollView.prototype.recycleNativeView = "never";
//# sourceMappingURL=scroll-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SearchBarBase = (function (_super) {
    __extends(SearchBarBase, _super);
    function SearchBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBarBase.submitEvent = "submit";
    SearchBarBase.clearEvent = "clear";
    SearchBarBase = __decorate([
        view_1.CSSType("SearchBar")
    ], SearchBarBase);
    return SearchBarBase;
}(view_1.View));
exports.SearchBarBase = SearchBarBase;
SearchBarBase.prototype.recycleNativeView = "auto";
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isIOS });
exports.textProperty.register(SearchBarBase);
exports.hintProperty = new view_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(SearchBarBase);
exports.textFieldHintColorProperty = new view_1.Property({ name: "textFieldHintColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldHintColorProperty.register(SearchBarBase);
exports.textFieldBackgroundColorProperty = new view_1.Property({ name: "textFieldBackgroundColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldBackgroundColorProperty.register(SearchBarBase);
//# sourceMappingURL=search-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var search_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js"));
var SEARCHTEXT = Symbol("searchText");
var QUERY = Symbol("query");
var QueryTextListener;
var CloseListener;
function initializeNativeClasses() {
    if (QueryTextListener) {
        return;
    }
    var CompatQueryTextListenerImpl = (function (_super) {
        __extends(CompatQueryTextListenerImpl, _super);
        function CompatQueryTextListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CompatQueryTextListenerImpl.prototype.onQueryTextChange = function (newText) {
            var owner = this.owner;
            search_bar_common_1.textProperty.nativeValueChange(owner, newText);
            if (newText === "" && this[SEARCHTEXT] !== newText) {
                owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
            }
            this[SEARCHTEXT] = newText;
            this[QUERY] = undefined;
            return true;
        };
        CompatQueryTextListenerImpl.prototype.onQueryTextSubmit = function (query) {
            var owner = this.owner;
            if (query !== "" && this[QUERY] !== query) {
                owner._emit(search_bar_common_1.SearchBarBase.submitEvent);
            }
            this[QUERY] = query;
            return true;
        };
        CompatQueryTextListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.SearchView.OnQueryTextListener])
        ], CompatQueryTextListenerImpl);
        return CompatQueryTextListenerImpl;
    }(java.lang.Object));
    var CompatCloseListenerImpl = (function (_super) {
        __extends(CompatCloseListenerImpl, _super);
        function CompatCloseListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CompatCloseListenerImpl.prototype.onClose = function () {
            this.owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
            return true;
        };
        CompatCloseListenerImpl = __decorate([
            Interfaces([androidx.appcompat.widget.SearchView.OnCloseListener])
        ], CompatCloseListenerImpl);
        return CompatCloseListenerImpl;
    }(java.lang.Object));
    QueryTextListener = CompatQueryTextListenerImpl;
    CloseListener = CompatCloseListenerImpl;
}
function enableSearchView(nativeView, value) {
    nativeView.setEnabled(value);
    if (!(nativeView instanceof android.view.ViewGroup)) {
        return;
    }
    for (var i = 0; i < nativeView.getChildCount(); i++) {
        var child = nativeView.getChildAt(i);
        enableSearchView(child, value);
    }
}
function enableUserInteractionSearchView(nativeView, value) {
    nativeView.setClickable(value);
    nativeView.setFocusable(value);
    if (!(nativeView instanceof android.view.ViewGroup)) {
        return;
    }
    for (var i = 0; i < nativeView.getChildCount(); i++) {
        var child = nativeView.getChildAt(i);
        enableUserInteractionSearchView(child, value);
    }
}
var SearchBar = (function (_super) {
    __extends(SearchBar, _super);
    function SearchBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBar.prototype.dismissSoftInput = function () {
        utils_1.ad.dismissSoftInput(this.nativeViewProtected);
    };
    SearchBar.prototype.focus = function () {
        var result = _super.prototype.focus.call(this);
        if (result) {
            utils_1.ad.showSoftInput(this.nativeViewProtected);
        }
        return result;
    };
    SearchBar.prototype.createNativeView = function () {
        var nativeView = new androidx.appcompat.widget.SearchView(this._context);
        nativeView.setIconified(false);
        return nativeView;
    };
    SearchBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeNativeClasses();
        var queryTextListener = new QueryTextListener(this);
        nativeView.setOnQueryTextListener(queryTextListener);
        nativeView.queryTextListener = queryTextListener;
        var closeListener = new CloseListener(this);
        nativeView.setOnCloseListener(closeListener);
        nativeView.closeListener = closeListener;
    };
    SearchBar.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.closeListener.owner = null;
        nativeView.queryTextListener.owner = null;
        this._searchPlate = null;
        this._searchTextView = null;
        _super.prototype.disposeNativeView.call(this);
    };
    SearchBar.prototype[search_bar_common_1.isEnabledProperty.setNative] = function (value) {
        enableSearchView(this.nativeViewProtected, value);
    };
    SearchBar.prototype[search_bar_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        enableUserInteractionSearchView(this.nativeViewProtected, value);
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.getDefault] = function () {
        var result = this.nativeViewProtected.getDrawingCacheBackgroundColor();
        return result;
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.setNative] = function (value) {
        var color;
        if (typeof value === "number") {
            color = value;
        }
        else {
            color = value.android;
        }
        this.nativeViewProtected.setBackgroundColor(color);
        var searchPlate = this._getSearchPlate();
        searchPlate.setBackgroundColor(color);
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getCurrentTextColor();
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.setNative] = function (value) {
        var color = (typeof value === "number") ? value : value.android;
        var textView = this._getTextView();
        textView.setTextColor(color);
    };
    SearchBar.prototype[search_bar_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this._getTextView().getTextSize() };
    };
    SearchBar.prototype[search_bar_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this._getTextView().setTextSize(value);
        }
        else {
            this._getTextView().setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.getDefault] = function () {
        return this._getTextView().getTypeface();
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.setNative] = function (value) {
        this._getTextView().setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    SearchBar.prototype[search_bar_common_1.textProperty.getDefault] = function () {
        return "";
    };
    SearchBar.prototype[search_bar_common_1.textProperty.setNative] = function (value) {
        var text = (value === null || value === undefined) ? "" : value.toString();
        this.nativeViewProtected.setQuery(text, false);
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.setNative] = function (value) {
        if (value === null || value === undefined) {
            this.nativeViewProtected.setQueryHint(null);
        }
        else {
            this.nativeViewProtected.setQueryHint(value.toString());
        }
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getBackground();
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.setNative] = function (value) {
        var textView = this._getTextView();
        if (value instanceof search_bar_common_1.Color) {
            textView.setBackgroundColor(value.android);
        }
        else {
            textView.setBackground(value);
        }
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.getDefault] = function () {
        var textView = this._getTextView();
        return textView.getCurrentTextColor();
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.setNative] = function (value) {
        var textView = this._getTextView();
        var color = value instanceof search_bar_common_1.Color ? value.android : value;
        textView.setHintTextColor(color);
    };
    SearchBar.prototype._getTextView = function () {
        if (!this._searchTextView) {
            var pkgName = this.nativeViewProtected.getContext().getPackageName();
            var id = this.nativeViewProtected.getContext().getResources().getIdentifier("search_src_text", "id", pkgName);
            this._searchTextView = this.nativeViewProtected.findViewById(id);
        }
        return this._searchTextView;
    };
    SearchBar.prototype._getSearchPlate = function () {
        if (!this._searchPlate) {
            var pkgName = this.nativeViewProtected.getContext().getPackageName();
            var id = this.nativeViewProtected.getContext().getResources().getIdentifier("search_plate", "id", pkgName);
            this._searchPlate = this.nativeViewProtected.findViewById(id);
        }
        return this._searchPlate;
    };
    return SearchBar;
}(search_bar_common_1.SearchBarBase));
exports.SearchBar = SearchBar;
//# sourceMappingURL=search-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var SegmentedBarItemBase = (function (_super) {
    __extends(SegmentedBarItemBase, _super);
    function SegmentedBarItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(SegmentedBarItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            var strValue = (value !== null && value !== undefined) ? value.toString() : "";
            if (this._title !== strValue) {
                this._title = strValue;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarItemBase = __decorate([
        view_1.CSSType("SegmentedBarItem")
    ], SegmentedBarItemBase);
    return SegmentedBarItemBase;
}(view_1.ViewBase));
exports.SegmentedBarItemBase = SegmentedBarItemBase;
var SegmentedBarBase = (function (_super) {
    __extends(SegmentedBarBase, _super);
    function SegmentedBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(SegmentedBarBase.prototype, "selectedBackgroundColor", {
        get: function () {
            return this.style.selectedBackgroundColor;
        },
        set: function (value) {
            this.style.selectedBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    SegmentedBarBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "SegmentedBarItem") {
            var item = value;
            var items = this.items;
            if (!items) {
                items = new Array();
                items.push(item);
                this.items = items;
            }
            else {
                items.push(item);
                this._addView(item);
            }
            if (this.nativeViewProtected) {
                this[exports.itemsProperty.setNative](items);
            }
        }
    };
    SegmentedBarBase.prototype.onItemsChanged = function (oldItems, newItems) {
        if (oldItems) {
            for (var i = 0, count = oldItems.length; i < count; i++) {
                this._removeView(oldItems[i]);
            }
        }
        if (newItems) {
            for (var i = 0, count = newItems.length; i < count; i++) {
                this._addView(newItems[i]);
            }
        }
    };
    SegmentedBarBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    SegmentedBarBase.selectedIndexChangedEvent = "selectedIndexChanged";
    SegmentedBarBase = __decorate([
        view_1.CSSType("SegmentedBar")
    ], SegmentedBarBase);
    return SegmentedBarBase;
}(view_1.View));
exports.SegmentedBarBase = SegmentedBarBase;
SegmentedBarBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueChanged: function (target, oldValue, newValue) {
        target.notify({ eventName: SegmentedBarBase.selectedIndexChangedEvent, object: target, oldIndex: oldValue, newIndex: newValue });
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(SegmentedBarBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(SegmentedBarBase);
exports.selectedBackgroundColorProperty = new view_1.InheritedCssProperty({ name: "selectedBackgroundColor", cssName: "selected-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedBackgroundColorProperty.register(view_1.Style);
//# sourceMappingURL=segmented-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var segmented_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js"));
var R_ID_TABS = 0x01020013;
var R_ID_TABCONTENT = 0x01020011;
var R_ATTR_STATE_SELECTED = 0x010100a1;
var TITLE_TEXT_VIEW_ID = 16908310;
var apiLevel;
var selectedIndicatorThickness;
var TabHost;
var TabChangeListener;
var TabContentFactory;
function initializeNativeClasses() {
    if (TabChangeListener) {
        return;
    }
    apiLevel = android.os.Build.VERSION.SDK_INT;
    selectedIndicatorThickness = segmented_bar_common_1.layout.toDevicePixels(apiLevel >= 21 ? 2 : 5);
    var TabChangeListenerImpl = (function (_super) {
        __extends(TabChangeListenerImpl, _super);
        function TabChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabChangeListenerImpl.prototype.onTabChanged = function (id) {
            var owner = this.owner;
            if (owner.shouldChangeSelectedIndex()) {
                owner.selectedIndex = parseInt(id);
            }
        };
        TabChangeListenerImpl = __decorate([
            Interfaces([android.widget.TabHost.OnTabChangeListener])
        ], TabChangeListenerImpl);
        return TabChangeListenerImpl;
    }(java.lang.Object));
    var TabContentFactoryImpl = (function (_super) {
        __extends(TabContentFactoryImpl, _super);
        function TabContentFactoryImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabContentFactoryImpl.prototype.createTabContent = function (tag) {
            var tv = new android.widget.TextView(this.owner._context);
            tv.setVisibility(android.view.View.GONE);
            tv.setMaxLines(1);
            tv.setEllipsize(android.text.TextUtils.TruncateAt.END);
            return tv;
        };
        TabContentFactoryImpl = __decorate([
            Interfaces([android.widget.TabHost.TabContentFactory])
        ], TabContentFactoryImpl);
        return TabContentFactoryImpl;
    }(java.lang.Object));
    var TabHostImpl = (function (_super) {
        __extends(TabHostImpl, _super);
        function TabHostImpl(context, attrs) {
            var _this = _super.call(this, context, attrs) || this;
            return global.__native(_this);
        }
        TabHostImpl.prototype.onAttachedToWindow = function () {
        };
        return TabHostImpl;
    }(android.widget.TabHost));
    TabHost = TabHostImpl;
    TabChangeListener = TabChangeListenerImpl;
    TabContentFactory = TabContentFactoryImpl;
}
var SegmentedBarItem = (function (_super) {
    __extends(SegmentedBarItem, _super);
    function SegmentedBarItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBarItem.prototype.setupNativeView = function (tabIndex) {
        var titleTextView = this.parent.nativeViewProtected.getTabWidget().getChildAt(tabIndex).findViewById(TITLE_TEXT_VIEW_ID);
        this.setNativeView(titleTextView);
        if (titleTextView) {
            if (this.titleDirty) {
                this._update();
            }
        }
    };
    SegmentedBarItem.prototype._update = function () {
        var tv = this.nativeViewProtected;
        if (tv) {
            var title = this.title;
            title = (title === null || title === undefined) ? "" : title;
            tv.setText(title);
            this.titleDirty = false;
        }
        else {
            this.titleDirty = true;
        }
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.getCurrentTextColor();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof segmented_bar_common_1.Color ? value.android : value;
        this.nativeViewProtected.setTextColor(color);
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeViewProtected.getTextSize() };
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this.nativeViewProtected.setTextSize(value);
        }
        else {
            this.nativeViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.getTypeface();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.fontInternalProperty.setNative] = function (value) {
        this.nativeViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.getDefault] = function () {
        var viewGroup = this.nativeViewProtected.getParent();
        return viewGroup.getBackground();
    };
    SegmentedBarItem.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var viewGroup = nativeView.getParent();
        if (value instanceof segmented_bar_common_1.Color) {
            var color = value.android;
            var backgroundDrawable = viewGroup.getBackground();
            if (apiLevel > 21 && backgroundDrawable) {
                var newDrawable = tryCloneDrawable(backgroundDrawable, nativeView.getResources());
                newDrawable.setColorFilter(color, android.graphics.PorterDuff.Mode.SRC_IN);
                viewGroup.setBackground(newDrawable);
            }
            else {
                var stateDrawable = new android.graphics.drawable.StateListDrawable();
                var colorDrawable = new org.nativescript.widgets.SegmentedBarColorDrawable(color, selectedIndicatorThickness);
                var arr = Array.create("int", 1);
                arr[0] = R_ATTR_STATE_SELECTED;
                stateDrawable.addState(arr, colorDrawable);
                stateDrawable.setBounds(0, 15, viewGroup.getRight(), viewGroup.getBottom());
                viewGroup.setBackground(stateDrawable);
            }
        }
        else {
            var backgroundDrawable = tryCloneDrawable(value, nativeView.getResources());
            viewGroup.setBackground(backgroundDrawable);
        }
    };
    return SegmentedBarItem;
}(segmented_bar_common_1.SegmentedBarItemBase));
exports.SegmentedBarItem = SegmentedBarItem;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
var SegmentedBar = (function (_super) {
    __extends(SegmentedBar, _super);
    function SegmentedBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBar.prototype.shouldChangeSelectedIndex = function () {
        return !this._addingTab;
    };
    SegmentedBar.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new TabHost(context, null);
        var tabHostLayout = new android.widget.LinearLayout(context);
        tabHostLayout.setOrientation(android.widget.LinearLayout.VERTICAL);
        var tabWidget = new android.widget.TabWidget(context);
        tabWidget.setId(R_ID_TABS);
        tabHostLayout.addView(tabWidget);
        var frame = new android.widget.FrameLayout(context);
        frame.setId(R_ID_TABCONTENT);
        frame.setVisibility(android.view.View.GONE);
        tabHostLayout.addView(frame);
        nativeView.addView(tabHostLayout);
        return nativeView;
    };
    SegmentedBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        var listener = new TabChangeListener(this);
        nativeView.setOnTabChangedListener(listener);
        nativeView.listener = listener;
        nativeView.setup();
        this._tabContentFactory = this._tabContentFactory || new TabContentFactory(this);
    };
    SegmentedBar.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    SegmentedBar.prototype.insertTab = function (tabItem, index) {
        var tabHost = this.nativeViewProtected;
        var tab = tabHost.newTabSpec(index + "");
        tab.setIndicator(tabItem.title + "");
        tab.setContent(this._tabContentFactory);
        this._addingTab = true;
        tabHost.addTab(tab);
        tabItem.setupNativeView(index);
        this._addingTab = false;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.setNative] = function (value) {
        this.nativeViewProtected.setCurrentTab(value);
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.setNative] = function (value) {
        var _this = this;
        this.nativeViewProtected.clearAllTabs();
        var newItems = value;
        if (newItems) {
            newItems.forEach(function (item, i, arr) { return _this.insertTab(item, i); });
        }
        segmented_bar_common_1.selectedIndexProperty.coerce(this);
    };
    return SegmentedBar;
}(segmented_bar_common_1.SegmentedBarBase));
exports.SegmentedBar = SegmentedBar;
//# sourceMappingURL=segmented-bar.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SliderBase = (function (_super) {
    __extends(SliderBase, _super);
    function SliderBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SliderBase = __decorate([
        view_1.CSSType("Slider")
    ], SliderBase);
    return SliderBase;
}(view_1.View));
exports.SliderBase = SliderBase;
SliderBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value", defaultValue: 0, coerceValue: function (target, value) {
        value = Math.max(value, target.minValue);
        value = Math.min(value, target.maxValue);
        return value;
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.valueProperty.register(SliderBase);
exports.minValueProperty = new view_1.Property({
    name: "minValue", defaultValue: 0, valueChanged: function (target, oldValue, newValue) {
        exports.maxValueProperty.coerce(target);
        exports.valueProperty.coerce(target);
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.minValueProperty.register(SliderBase);
exports.maxValueProperty = new view_1.CoercibleProperty({
    name: "maxValue", defaultValue: 100, coerceValue: function (target, value) {
        var minValue = target.minValue;
        if (value < minValue) {
            value = minValue;
        }
        return value;
    },
    valueChanged: function (target, oldValue, newValue) { return exports.valueProperty.coerce(target); },
    valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.maxValueProperty.register(SliderBase);
//# sourceMappingURL=slider-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var slider_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js"));
var SeekBar;
var SeekBarChangeListener;
function initializeListenerClass() {
    if (!SeekBarChangeListener) {
        var SeekBarChangeListenerImpl = (function (_super) {
            __extends(SeekBarChangeListenerImpl, _super);
            function SeekBarChangeListenerImpl() {
                var _this = _super.call(this) || this;
                return global.__native(_this);
            }
            SeekBarChangeListenerImpl.prototype.onProgressChanged = function (seekBar, progress, fromUser) {
                var owner = seekBar.owner;
                if (owner && !owner._supressNativeValue) {
                    var newValue = progress + owner.minValue;
                    slider_common_1.valueProperty.nativeValueChange(owner, newValue);
                }
            };
            SeekBarChangeListenerImpl.prototype.onStartTrackingTouch = function (seekBar) {
            };
            SeekBarChangeListenerImpl.prototype.onStopTrackingTouch = function (seekBar) {
            };
            SeekBarChangeListenerImpl = __decorate([
                Interfaces([android.widget.SeekBar.OnSeekBarChangeListener])
            ], SeekBarChangeListenerImpl);
            return SeekBarChangeListenerImpl;
        }(java.lang.Object));
        SeekBarChangeListener = new SeekBarChangeListenerImpl();
    }
}
function getListener() {
    return SeekBarChangeListener;
}
var Slider = (function (_super) {
    __extends(Slider, _super);
    function Slider() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Slider.prototype.createNativeView = function () {
        if (!SeekBar) {
            SeekBar = android.widget.SeekBar;
        }
        return new SeekBar(this._context);
    };
    Slider.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.owner = this;
        initializeListenerClass();
        var listener = getListener();
        nativeView.setOnSeekBarChangeListener(listener);
    };
    Slider.prototype.disposeNativeView = function () {
        this.nativeViewProtected.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Slider.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.setMax(100);
        nativeView.setProgress(0);
        nativeView.setKeyProgressIncrement(1);
    };
    Slider.prototype.setNativeValuesSilently = function () {
        this._supressNativeValue = true;
        var nativeView = this.nativeViewProtected;
        try {
            nativeView.setMax(this.maxValue - this.minValue);
            nativeView.setProgress(this.value - this.minValue);
        }
        finally {
            this._supressNativeValue = false;
        }
    };
    Slider.prototype[slider_common_1.valueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.minValueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Slider.prototype[slider_common_1.maxValueProperty.setNative] = function (value) {
        this.setNativeValuesSilently();
    };
    Slider.prototype[slider_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    Slider.prototype[slider_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof slider_common_1.Color) {
            this.nativeViewProtected.getThumb().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getThumb().clearColorFilter();
        }
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.setNative] = function (value) {
        if (value instanceof slider_common_1.Color) {
            this.nativeViewProtected.getProgressDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getProgressDrawable().clearColorFilter();
        }
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Slider;
}(slider_common_1.SliderBase));
exports.Slider = Slider;
//# sourceMappingURL=slider.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var Background = (function () {
    function Background() {
        this.borderTopWidth = 0;
        this.borderRightWidth = 0;
        this.borderBottomWidth = 0;
        this.borderLeftWidth = 0;
        this.borderTopLeftRadius = 0;
        this.borderTopRightRadius = 0;
        this.borderBottomLeftRadius = 0;
        this.borderBottomRightRadius = 0;
    }
    Background.prototype.clone = function () {
        var clone = new Background();
        clone.color = this.color;
        clone.image = this.image;
        clone.repeat = this.repeat;
        clone.position = this.position;
        clone.size = this.size;
        clone.borderTopColor = this.borderTopColor;
        clone.borderRightColor = this.borderRightColor;
        clone.borderBottomColor = this.borderBottomColor;
        clone.borderLeftColor = this.borderLeftColor;
        clone.borderTopWidth = this.borderTopWidth;
        clone.borderRightWidth = this.borderRightWidth;
        clone.borderBottomWidth = this.borderBottomWidth;
        clone.borderLeftWidth = this.borderLeftWidth;
        clone.borderTopLeftRadius = this.borderTopLeftRadius;
        clone.borderTopRightRadius = this.borderTopRightRadius;
        clone.borderBottomRightRadius = this.borderBottomRightRadius;
        clone.borderBottomLeftRadius = this.borderBottomLeftRadius;
        clone.clipPath = this.clipPath;
        return clone;
    };
    Background.prototype.withColor = function (value) {
        var clone = this.clone();
        clone.color = value;
        return clone;
    };
    Background.prototype.withImage = function (value) {
        var clone = this.clone();
        clone.image = value;
        return clone;
    };
    Background.prototype.withRepeat = function (value) {
        var clone = this.clone();
        clone.repeat = value;
        return clone;
    };
    Background.prototype.withPosition = function (value) {
        var clone = this.clone();
        clone.position = value;
        return clone;
    };
    Background.prototype.withSize = function (value) {
        var clone = this.clone();
        clone.size = value;
        return clone;
    };
    Background.prototype.withBorderTopColor = function (value) {
        var clone = this.clone();
        clone.borderTopColor = value;
        return clone;
    };
    Background.prototype.withBorderRightColor = function (value) {
        var clone = this.clone();
        clone.borderRightColor = value;
        return clone;
    };
    Background.prototype.withBorderBottomColor = function (value) {
        var clone = this.clone();
        clone.borderBottomColor = value;
        return clone;
    };
    Background.prototype.withBorderLeftColor = function (value) {
        var clone = this.clone();
        clone.borderLeftColor = value;
        return clone;
    };
    Background.prototype.withBorderTopWidth = function (value) {
        var clone = this.clone();
        clone.borderTopWidth = value;
        return clone;
    };
    Background.prototype.withBorderRightWidth = function (value) {
        var clone = this.clone();
        clone.borderRightWidth = value;
        return clone;
    };
    Background.prototype.withBorderBottomWidth = function (value) {
        var clone = this.clone();
        clone.borderBottomWidth = value;
        return clone;
    };
    Background.prototype.withBorderLeftWidth = function (value) {
        var clone = this.clone();
        clone.borderLeftWidth = value;
        return clone;
    };
    Background.prototype.withBorderTopLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderTopLeftRadius = value;
        return clone;
    };
    Background.prototype.withBorderTopRightRadius = function (value) {
        var clone = this.clone();
        clone.borderTopRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomRightRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomLeftRadius = value;
        return clone;
    };
    Background.prototype.withClipPath = function (value) {
        var clone = this.clone();
        clone.clipPath = value;
        return clone;
    };
    Background.prototype.isEmpty = function () {
        return !this.color
            && !this.image
            && !this.hasBorderWidth()
            && !this.hasBorderRadius()
            && !this.clipPath;
    };
    Background.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        var imagesEqual = false;
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            imagesEqual = linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            imagesEqual = value1.image === value2.image;
        }
        return color_1.Color.equals(value1.color, value2.color)
            && imagesEqual
            && value1.position === value2.position
            && value1.repeat === value2.repeat
            && value1.size === value2.size
            && color_1.Color.equals(value1.borderTopColor, value2.borderTopColor)
            && color_1.Color.equals(value1.borderRightColor, value2.borderRightColor)
            && color_1.Color.equals(value1.borderBottomColor, value2.borderBottomColor)
            && color_1.Color.equals(value1.borderLeftColor, value2.borderLeftColor)
            && value1.borderTopWidth === value2.borderTopWidth
            && value1.borderRightWidth === value2.borderRightWidth
            && value1.borderBottomWidth === value2.borderBottomWidth
            && value1.borderLeftWidth === value2.borderLeftWidth
            && value1.borderTopLeftRadius === value2.borderTopLeftRadius
            && value1.borderTopRightRadius === value2.borderTopRightRadius
            && value1.borderBottomRightRadius === value2.borderBottomRightRadius
            && value1.borderBottomLeftRadius === value2.borderBottomLeftRadius
            && value1.clipPath === value2.clipPath;
    };
    Background.prototype.hasBorderColor = function () {
        return !!this.borderTopColor || !!this.borderRightColor || !!this.borderBottomColor || !!this.borderLeftColor;
    };
    Background.prototype.hasBorderWidth = function () {
        return this.borderTopWidth > 0
            || this.borderRightWidth > 0
            || this.borderBottomWidth > 0
            || this.borderLeftWidth > 0;
    };
    Background.prototype.hasBorderRadius = function () {
        return this.borderTopLeftRadius > 0
            || this.borderTopRightRadius > 0
            || this.borderBottomRightRadius > 0
            || this.borderBottomLeftRadius > 0;
    };
    Background.prototype.hasUniformBorderColor = function () {
        return color_1.Color.equals(this.borderTopColor, this.borderRightColor)
            && color_1.Color.equals(this.borderTopColor, this.borderBottomColor)
            && color_1.Color.equals(this.borderTopColor, this.borderLeftColor);
    };
    Background.prototype.hasUniformBorderWidth = function () {
        return this.borderTopWidth === this.borderRightWidth
            && this.borderTopWidth === this.borderBottomWidth
            && this.borderTopWidth === this.borderLeftWidth;
    };
    Background.prototype.hasUniformBorderRadius = function () {
        return this.borderTopLeftRadius === this.borderTopRightRadius
            && this.borderTopLeftRadius === this.borderBottomRightRadius
            && this.borderTopLeftRadius === this.borderBottomLeftRadius;
    };
    Background.prototype.hasUniformBorder = function () {
        return this.hasUniformBorderColor()
            && this.hasUniformBorderWidth()
            && this.hasUniformBorderRadius();
    };
    Background.prototype.getUniformBorderColor = function () {
        if (this.hasUniformBorderColor()) {
            return this.borderTopColor;
        }
        return undefined;
    };
    Background.prototype.getUniformBorderWidth = function () {
        if (this.hasUniformBorderWidth()) {
            return this.borderTopWidth;
        }
        return 0;
    };
    Background.prototype.getUniformBorderRadius = function () {
        if (this.hasUniformBorderRadius()) {
            return this.borderTopLeftRadius;
        }
        return 0;
    };
    Background.prototype.toString = function () {
        return "isEmpty: " + this.isEmpty() + "; color: " + this.color + "; image: " + this.image + "; repeat: " + this.repeat + "; position: " + this.position + "; size: " + this.size + "; borderTopColor: " + this.borderTopColor + "; borderRightColor: " + this.borderRightColor + "; borderBottomColor: " + this.borderBottomColor + "; borderLeftColor: " + this.borderLeftColor + "; borderTopWidth: " + this.borderTopWidth + "; borderRightWidth: " + this.borderRightWidth + "; borderBottomWidth: " + this.borderBottomWidth + "; borderLeftWidth: " + this.borderLeftWidth + "; borderTopLeftRadius: " + this.borderTopLeftRadius + "; borderTopRightRadius: " + this.borderTopRightRadius + "; borderBottomRightRadius: " + this.borderBottomRightRadius + "; borderBottomLeftRadius: " + this.borderBottomLeftRadius + "; clipPath: " + this.clipPath + ";";
    };
    Background.default = new Background();
    return Background;
}());
exports.Background = Background;
//# sourceMappingURL=background-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var css_value_1 = __webpack_require__("../node_modules/tns-core-modules/css-value/index.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/background-common.js"));
var ad;
(function (ad) {
    var SDK;
    function getSDK() {
        if (!SDK) {
            SDK = android.os.Build.VERSION.SDK_INT;
        }
        return SDK;
    }
    function isSetColorFilterOnlyWidget(nativeView) {
        return (nativeView instanceof android.widget.Button ||
            (nativeView instanceof androidx.appcompat.widget.Toolbar
                && getSDK() >= 21));
    }
    function onBackgroundOrBorderPropertyChanged(view) {
        var nativeView = view.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var background = view.style.backgroundInternal;
        var drawable = nativeView.getBackground();
        var androidView = view;
        if (androidView._cachedDrawable === undefined && drawable) {
            var constantState = drawable.getConstantState();
            androidView._cachedDrawable = constantState || drawable;
        }
        if (isSetColorFilterOnlyWidget(nativeView)
            && drawable
            && !(drawable instanceof org.nativescript.widgets.BorderDrawable)
            && !background.hasBorderWidth()
            && !background.hasBorderRadius()
            && !background.clipPath
            && !background.image
            && background.color) {
            var backgroundColor = drawable.backgroundColor = background.color.android;
            drawable.mutate();
            drawable.setColorFilter(backgroundColor, android.graphics.PorterDuff.Mode.SRC_IN);
            drawable.invalidateSelf();
            drawable.backgroundColor = backgroundColor;
        }
        else if (!background.isEmpty()) {
            var backgroundDrawable = drawable;
            if (!(drawable instanceof org.nativescript.widgets.BorderDrawable)) {
                backgroundDrawable = new org.nativescript.widgets.BorderDrawable(utils_1.layout.getDisplayDensity(), view.toString());
                refreshBorderDrawable(view, backgroundDrawable);
                nativeView.setBackground(backgroundDrawable);
            }
            else {
                refreshBorderDrawable(view, backgroundDrawable);
            }
        }
        else {
            var cachedDrawable = androidView._cachedDrawable;
            var defaultDrawable = void 0;
            if (cachedDrawable instanceof android.graphics.drawable.Drawable.ConstantState) {
                defaultDrawable = cachedDrawable.newDrawable(nativeView.getResources());
            }
            else if (cachedDrawable instanceof android.graphics.drawable.Drawable) {
                defaultDrawable = cachedDrawable;
            }
            else {
                defaultDrawable = null;
            }
            nativeView.setBackground(defaultDrawable);
            androidView._cachedDrawable = undefined;
        }
        var leftPadding = Math.ceil(view.effectiveBorderLeftWidth + view.effectivePaddingLeft);
        var topPadding = Math.ceil(view.effectiveBorderTopWidth + view.effectivePaddingTop);
        var rightPadding = Math.ceil(view.effectiveBorderRightWidth + view.effectivePaddingRight);
        var bottomPadding = Math.ceil(view.effectiveBorderBottomWidth + view.effectivePaddingBottom);
        nativeView.setPadding(leftPadding, topPadding, rightPadding, bottomPadding);
    }
    ad.onBackgroundOrBorderPropertyChanged = onBackgroundOrBorderPropertyChanged;
})(ad = exports.ad || (exports.ad = {}));
function fromBase64(source) {
    var bytes = android.util.Base64.decode(source, android.util.Base64.DEFAULT);
    return android.graphics.BitmapFactory.decodeByteArray(bytes, 0, bytes.length);
}
function fromGradient(gradient) {
    var colors = Array.create("int", gradient.colorStops.length);
    var stops = Array.create("float", gradient.colorStops.length);
    var hasStops = false;
    gradient.colorStops.forEach(function (stop, index) {
        colors[index] = stop.color.android;
        if (stop.offset) {
            stops[index] = stop.offset.value;
            hasStops = true;
        }
    });
    var alpha = gradient.angle / (Math.PI * 2);
    var startX = Math.pow(Math.sin(Math.PI * (alpha + 0.75)), 2);
    var startY = Math.pow(Math.sin(Math.PI * (alpha + 0.5)), 2);
    var endX = Math.pow(Math.sin(Math.PI * (alpha + 0.25)), 2);
    var endY = Math.pow(Math.sin(Math.PI * alpha), 2);
    return new org.nativescript.widgets.LinearGradientDefinition(startX, startY, endX, endY, colors, hasStops ? stops : null);
}
var pattern = /url\(('|")(.*?)\1\)/;
function refreshBorderDrawable(view, borderDrawable) {
    var nativeView = view.nativeViewProtected;
    var context = nativeView.getContext();
    var background = view.style.backgroundInternal;
    if (background) {
        var backgroundPositionParsedCSSValues = createNativeCSSValueArray(background.position);
        var backgroundSizeParsedCSSValues = createNativeCSSValueArray(background.size);
        var blackColor = -16777216;
        var imageUri = void 0;
        if (background.image && typeof background.image === "string") {
            imageUri = background.image;
            var match = imageUri.match(pattern);
            if (match && match[2]) {
                imageUri = match[2];
            }
        }
        var bitmap = null;
        if (utils_1.isDataURI(imageUri)) {
            var base64Data = imageUri.split(",")[1];
            if (base64Data !== undefined) {
                bitmap = fromBase64(base64Data);
                imageUri = null;
            }
        }
        else if (utils_1.isFileOrResourcePath(imageUri)) {
            if (imageUri.indexOf(utils_1.RESOURCE_PREFIX) !== 0) {
                var fileName = imageUri;
                if (fileName.indexOf("~/") === 0) {
                    fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
                }
                imageUri = utils_1.FILE_PREFIX + fileName;
            }
        }
        var gradient = null;
        if (background.image && background.image instanceof linear_gradient_1.LinearGradient) {
            gradient = fromGradient(background.image);
        }
        borderDrawable.refresh(background.borderTopColor ? background.borderTopColor.android : blackColor, background.borderRightColor ? background.borderRightColor.android : blackColor, background.borderBottomColor ? background.borderBottomColor.android : blackColor, background.borderLeftColor ? background.borderLeftColor.android : blackColor, background.borderTopWidth, background.borderRightWidth, background.borderBottomWidth, background.borderLeftWidth, background.borderTopLeftRadius, background.borderTopRightRadius, background.borderBottomRightRadius, background.borderBottomLeftRadius, background.clipPath, background.color ? background.color.android : 0, imageUri, bitmap, gradient, context, background.repeat, background.position, backgroundPositionParsedCSSValues, background.size, backgroundSizeParsedCSSValues);
    }
}
function createNativeCSSValueArray(css) {
    if (!css) {
        return null;
    }
    var cssValues = css_value_1.parse(css);
    var nativeArray = Array.create(org.nativescript.widgets.CSSValue, cssValues.length);
    for (var i = 0, length_1 = cssValues.length; i < length_1; i++) {
        nativeArray[i] = new org.nativescript.widgets.CSSValue(cssValues[i].type, cssValues[i].string, cssValues[i].unit, cssValues[i].value);
    }
    return nativeArray;
}
var CacheMode;
(function (CacheMode) {
    CacheMode[CacheMode["none"] = 0] = "none";
    CacheMode[CacheMode["memory"] = 1] = "memory";
    CacheMode[CacheMode["diskAndMemory"] = 2] = "diskAndMemory";
})(CacheMode = exports.CacheMode || (exports.CacheMode = {}));
var currentCacheMode;
var imageFetcher;
function initImageCache(context, mode, memoryCacheSize, diskCacheSize) {
    if (mode === void 0) { mode = CacheMode.diskAndMemory; }
    if (memoryCacheSize === void 0) { memoryCacheSize = 0.25; }
    if (diskCacheSize === void 0) { diskCacheSize = 10 * 1024 * 1024; }
    if (currentCacheMode === mode) {
        return;
    }
    currentCacheMode = mode;
    if (!imageFetcher) {
        imageFetcher = org.nativescript.widgets.image.Fetcher.getInstance(context);
    }
    else {
        imageFetcher.clearCache();
    }
    var params = new org.nativescript.widgets.image.Cache.CacheParams();
    params.memoryCacheEnabled = mode !== CacheMode.none;
    params.setMemCacheSizePercent(memoryCacheSize);
    params.diskCacheEnabled = mode === CacheMode.diskAndMemory;
    params.diskCacheSize = diskCacheSize;
    var imageCache = org.nativescript.widgets.image.Cache.getInstance(params);
    imageFetcher.addImageCache(imageCache);
    imageFetcher.initCache();
}
exports.initImageCache = initImageCache;
function onLivesync(args) {
    if (imageFetcher) {
        imageFetcher.clearCache();
    }
}
application.on("livesync", onLivesync);
application.android.on("activityStarted", profiling_1.profile("initImageCache", function (args) {
    if (!imageFetcher) {
        initImageCache(args.activity);
    }
    else {
        imageFetcher.initCache();
    }
}));
application.android.on("activityStopped", profiling_1.profile("closeImageCache", function (args) {
    if (imageFetcher) {
        imageFetcher.closeCache();
    }
}));
//# sourceMappingURL=background.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/converters.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var STYLE_CURVE_MAP = Object.freeze({
    "ease": enums_1.AnimationCurve.ease,
    "linear": enums_1.AnimationCurve.linear,
    "ease-in": enums_1.AnimationCurve.easeIn,
    "ease-out": enums_1.AnimationCurve.easeOut,
    "ease-in-out": enums_1.AnimationCurve.easeInOut,
    "spring": enums_1.AnimationCurve.spring,
});
function timeConverter(value) {
    var result = parseFloat(value);
    if (value.indexOf("ms") === -1) {
        result = result * 1000;
    }
    return Math.max(0.0, result);
}
exports.timeConverter = timeConverter;
function animationTimingFunctionConverter(value) {
    return value ?
        STYLE_CURVE_MAP[value] || parseCubicBezierCurve(value) :
        enums_1.AnimationCurve.ease;
}
exports.animationTimingFunctionConverter = animationTimingFunctionConverter;
function parseCubicBezierCurve(value) {
    var coordsString = /\((.*?)\)/.exec(value);
    var coords = coordsString && coordsString[1]
        .split(",")
        .map(stringToBezieCoords);
    if (value.startsWith("cubic-bezier") &&
        coordsString &&
        coords.length === 4) {
        var _a = __spreadArrays(coords), x1 = _a[0], x2 = _a[1], y1_1 = _a[2], y2 = _a[3];
        return enums_1.AnimationCurve.cubicBezier(x1, x2, y1_1, y2);
    }
    else {
        throw new Error("Invalid value for animation: " + value);
    }
}
function stringToBezieCoords(value) {
    var result = parseFloat(value);
    if (result < 0) {
        return 0;
    }
    else if (result > 1) {
        return 1;
    }
    return result;
}
//# sourceMappingURL=converters.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-animation-parser.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var keyframe_animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
var converters_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/converters.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var ANIMATION_PROPERTY_HANDLERS = Object.freeze({
    "animation-name": function (info, value) { return info.name = value; },
    "animation-duration": function (info, value) { return info.duration = converters_1.timeConverter(value); },
    "animation-delay": function (info, value) { return info.delay = converters_1.timeConverter(value); },
    "animation-timing-function": function (info, value) { return info.curve = converters_1.animationTimingFunctionConverter(value); },
    "animation-iteration-count": function (info, value) { return info.iterations = value === "infinite" ? Number.MAX_VALUE : parseFloat(value); },
    "animation-direction": function (info, value) { return info.isReverse = value === "reverse"; },
    "animation-fill-mode": function (info, value) { return info.isForwards = value === "forwards"; }
});
var CssAnimationParser = (function () {
    function CssAnimationParser() {
    }
    CssAnimationParser.keyframeAnimationsFromCSSDeclarations = function (declarations) {
        if (declarations === null || declarations === undefined) {
            return undefined;
        }
        var animations = new Array();
        var animationInfo = undefined;
        declarations.forEach(function (_a) {
            var property = _a.property, value = _a.value;
            if (property === "animation") {
                keyframeAnimationsFromCSSProperty(value, animations);
            }
            else {
                var propertyHandler = ANIMATION_PROPERTY_HANDLERS[property];
                if (propertyHandler) {
                    if (animationInfo === undefined) {
                        animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
                        animations.push(animationInfo);
                    }
                    propertyHandler(animationInfo, value);
                }
            }
        });
        return animations.length === 0 ? undefined : animations;
    };
    CssAnimationParser.keyframesArrayFromCSS = function (keyframes) {
        var parsedKeyframes = new Array();
        for (var _i = 0, keyframes_1 = keyframes; _i < keyframes_1.length; _i++) {
            var keyframe = keyframes_1[_i];
            var declarations = parseKeyframeDeclarations(keyframe.declarations);
            for (var _a = 0, _b = keyframe.values; _a < _b.length; _a++) {
                var time_1 = _b[_a];
                if (time_1 === "from") {
                    time_1 = 0;
                }
                else if (time_1 === "to") {
                    time_1 = 1;
                }
                else {
                    time_1 = parseFloat(time_1) / 100;
                    if (time_1 < 0) {
                        time_1 = 0;
                    }
                    if (time_1 > 100) {
                        time_1 = 100;
                    }
                }
                var current = parsedKeyframes[time_1];
                if (current === undefined) {
                    current = {};
                    current.duration = time_1;
                    parsedKeyframes[time_1] = current;
                }
                for (var _c = 0, _d = keyframe.declarations; _c < _d.length; _c++) {
                    var declaration = _d[_c];
                    if (declaration.property === "animation-timing-function") {
                        current.curve = converters_1.animationTimingFunctionConverter(declaration.value);
                    }
                }
                current.declarations = declarations;
            }
        }
        var array = new Array();
        for (var parsedKeyframe in parsedKeyframes) {
            array.push(parsedKeyframes[parsedKeyframe]);
        }
        array.sort(function (a, b) { return a.duration - b.duration; });
        return array;
    };
    return CssAnimationParser;
}());
exports.CssAnimationParser = CssAnimationParser;
function keyframeAnimationsFromCSSProperty(value, animations) {
    if (typeof value === "string") {
        var values = value.split(/[,]+/);
        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {
            var parsedValue = values_1[_i];
            var animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
            var arr = parsedValue.trim().split(/[ ]+/);
            if (arr.length > 0) {
                animationInfo.name = arr[0];
            }
            if (arr.length > 1) {
                animationInfo.duration = converters_1.timeConverter(arr[1]);
            }
            if (arr.length > 2) {
                animationInfo.curve = converters_1.animationTimingFunctionConverter(arr[2]);
            }
            if (arr.length > 3) {
                animationInfo.delay = converters_1.timeConverter(arr[3]);
            }
            if (arr.length > 4) {
                animationInfo.iterations = parseInt(arr[4]);
            }
            if (arr.length > 5) {
                animationInfo.isReverse = arr[4] === "reverse";
            }
            if (arr.length > 6) {
                animationInfo.isForwards = arr[5] === "forwards";
            }
            if (arr.length > 7) {
                throw new Error("Invalid value for animation: " + value);
            }
            animations.push(animationInfo);
        }
    }
}
function parseKeyframeDeclarations(unparsedKeyframeDeclarations) {
    var declarations = unparsedKeyframeDeclarations
        .reduce(function (declarations, _a) {
        var unparsedProperty = _a.property, unparsedValue = _a.value;
        var property = properties_1.CssAnimationProperty._getByCssName(unparsedProperty);
        if (typeof unparsedProperty === "string" && property && property._valueConverter) {
            declarations[property.name] = property._valueConverter(unparsedValue);
        }
        else if (typeof unparsedValue === "string" && unparsedProperty === "transform") {
            var transformations = style_properties_1.transformConverter(unparsedValue);
            Object.assign(declarations, transformations);
        }
        return declarations;
    }, {});
    return Object.keys(declarations).map(function (property) { return ({ property: property, value: declarations[property] }); });
}
exports.parseKeyframeDeclarations = parseKeyframeDeclarations;
//# sourceMappingURL=css-animation-parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var Match;
(function (Match) {
    Match.Dynamic = true;
    Match.Static = false;
})(Match || (Match = {}));
function getNodeDirectSibling(node) {
    if (!node.parent || !node.parent.getChildIndex || !node.parent.getChildAt) {
        return null;
    }
    var nodeIndex = node.parent.getChildIndex(node);
    if (nodeIndex === 0) {
        return null;
    }
    return node.parent.getChildAt(nodeIndex - 1);
}
function SelectorProperties(specificity, rarity, dynamic) {
    if (dynamic === void 0) { dynamic = false; }
    return function (cls) {
        cls.prototype.specificity = specificity;
        cls.prototype.rarity = rarity;
        cls.prototype.combinator = undefined;
        cls.prototype.dynamic = dynamic;
        return cls;
    };
}
var SelectorCore = (function () {
    function SelectorCore() {
    }
    SelectorCore.prototype.lookupSort = function (sorter, base) { sorter.sortAsUniversal(base || this); };
    SelectorCore = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], SelectorCore);
    return SelectorCore;
}());
exports.SelectorCore = SelectorCore;
var SimpleSelector = (function (_super) {
    __extends(SimpleSelector, _super);
    function SimpleSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SimpleSelector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        else if (this.mayMatch(node)) {
            this.trackChanges(node, map);
            return true;
        }
        return false;
    };
    SimpleSelector.prototype.mayMatch = function (node) { return this.match(node); };
    SimpleSelector.prototype.trackChanges = function (node, map) {
    };
    return SimpleSelector;
}(SelectorCore));
exports.SimpleSelector = SimpleSelector;
function wrap(text) {
    return text ? " " + text + " " : "";
}
var InvalidSelector = (function (_super) {
    __extends(InvalidSelector, _super);
    function InvalidSelector(e) {
        var _this = _super.call(this) || this;
        _this.e = e;
        return _this;
    }
    InvalidSelector.prototype.toString = function () { return "<error: " + this.e + ">"; };
    InvalidSelector.prototype.match = function (node) { return false; };
    InvalidSelector.prototype.lookupSort = function (sorter, base) {
    };
    InvalidSelector = __decorate([
        SelectorProperties(0, 4, Match.Static)
    ], InvalidSelector);
    return InvalidSelector;
}(SimpleSelector));
exports.InvalidSelector = InvalidSelector;
var UniversalSelector = (function (_super) {
    __extends(UniversalSelector, _super);
    function UniversalSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UniversalSelector.prototype.toString = function () { return "*" + wrap(this.combinator); };
    UniversalSelector.prototype.match = function (node) { return true; };
    UniversalSelector = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], UniversalSelector);
    return UniversalSelector;
}(SimpleSelector));
exports.UniversalSelector = UniversalSelector;
var IdSelector = (function (_super) {
    __extends(IdSelector, _super);
    function IdSelector(id) {
        var _this = _super.call(this) || this;
        _this.id = id;
        return _this;
    }
    IdSelector.prototype.toString = function () { return "#" + this.id + wrap(this.combinator); };
    IdSelector.prototype.match = function (node) { return node.id === this.id; };
    IdSelector.prototype.lookupSort = function (sorter, base) { sorter.sortById(this.id, base || this); };
    IdSelector = __decorate([
        SelectorProperties(65536, 3, Match.Static)
    ], IdSelector);
    return IdSelector;
}(SimpleSelector));
exports.IdSelector = IdSelector;
var TypeSelector = (function (_super) {
    __extends(TypeSelector, _super);
    function TypeSelector(cssType) {
        var _this = _super.call(this) || this;
        _this.cssType = cssType;
        return _this;
    }
    TypeSelector.prototype.toString = function () { return "" + this.cssType + wrap(this.combinator); };
    TypeSelector.prototype.match = function (node) { return node.cssType === this.cssType; };
    TypeSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByType(this.cssType, base || this); };
    TypeSelector = __decorate([
        SelectorProperties(1, 1, Match.Static)
    ], TypeSelector);
    return TypeSelector;
}(SimpleSelector));
exports.TypeSelector = TypeSelector;
var ClassSelector = (function (_super) {
    __extends(ClassSelector, _super);
    function ClassSelector(cssClass) {
        var _this = _super.call(this) || this;
        _this.cssClass = cssClass;
        return _this;
    }
    ClassSelector.prototype.toString = function () { return "." + this.cssClass + wrap(this.combinator); };
    ClassSelector.prototype.match = function (node) { return node.cssClasses && node.cssClasses.has(this.cssClass); };
    ClassSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByClass(this.cssClass, base || this); };
    ClassSelector = __decorate([
        SelectorProperties(256, 2, Match.Static)
    ], ClassSelector);
    return ClassSelector;
}(SimpleSelector));
exports.ClassSelector = ClassSelector;
var AttributeSelector = (function (_super) {
    __extends(AttributeSelector, _super);
    function AttributeSelector(attribute, test, value) {
        var _this = _super.call(this) || this;
        _this.attribute = attribute;
        _this.test = test;
        _this.value = value;
        if (!test) {
            _this.match = function (node) { return !types_1.isNullOrUndefined(node[attribute]); };
            return _this;
        }
        if (!value) {
            _this.match = function (node) { return false; };
        }
        var escapedValue = utils_common_1.escapeRegexSymbols(value);
        var regexp = null;
        switch (test) {
            case "^=":
                regexp = new RegExp("^" + escapedValue);
                break;
            case "$=":
                regexp = new RegExp(escapedValue + "$");
                break;
            case "*=":
                regexp = new RegExp(escapedValue);
                break;
            case "=":
                regexp = new RegExp("^" + escapedValue + "$");
                break;
            case "~=":
                if (/\s/.test(value)) {
                    _this.match = function (node) { return false; };
                    return _this;
                }
                regexp = new RegExp("(^|\\s)" + escapedValue + "(\\s|$)");
                break;
            case "|=":
                regexp = new RegExp("^" + escapedValue + "(-|$)");
                break;
        }
        if (regexp) {
            _this.match = function (node) { return regexp.test(node[attribute] + ""); };
            return _this;
        }
        else {
            _this.match = function (node) { return false; };
            return _this;
        }
    }
    AttributeSelector.prototype.toString = function () { return "[" + this.attribute + wrap(this.test) + ((this.test && this.value) || "") + "]" + wrap(this.combinator); };
    AttributeSelector.prototype.match = function (node) { return false; };
    AttributeSelector.prototype.mayMatch = function (node) { return true; };
    AttributeSelector.prototype.trackChanges = function (node, map) { map.addAttribute(node, this.attribute); };
    AttributeSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], AttributeSelector);
    return AttributeSelector;
}(SimpleSelector));
exports.AttributeSelector = AttributeSelector;
var PseudoClassSelector = (function (_super) {
    __extends(PseudoClassSelector, _super);
    function PseudoClassSelector(cssPseudoClass) {
        var _this = _super.call(this) || this;
        _this.cssPseudoClass = cssPseudoClass;
        return _this;
    }
    PseudoClassSelector.prototype.toString = function () { return ":" + this.cssPseudoClass + wrap(this.combinator); };
    PseudoClassSelector.prototype.match = function (node) { return node.cssPseudoClasses && node.cssPseudoClasses.has(this.cssPseudoClass); };
    PseudoClassSelector.prototype.mayMatch = function (node) { return true; };
    PseudoClassSelector.prototype.trackChanges = function (node, map) { map.addPseudoClass(node, this.cssPseudoClass); };
    PseudoClassSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], PseudoClassSelector);
    return PseudoClassSelector;
}(SimpleSelector));
exports.PseudoClassSelector = PseudoClassSelector;
var SimpleSelectorSequence = (function (_super) {
    __extends(SimpleSelectorSequence, _super);
    function SimpleSelectorSequence(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.head = _this.selectors.reduce(function (prev, curr) { return !prev || (curr.rarity > prev.rarity) ? curr : prev; }, null);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    SimpleSelectorSequence.prototype.toString = function () { return "" + this.selectors.join("") + wrap(this.combinator); };
    SimpleSelectorSequence.prototype.match = function (node) { return this.selectors.every(function (sel) { return sel.match(node); }); };
    SimpleSelectorSequence.prototype.mayMatch = function (node) {
        return this.selectors.every(function (sel) { return sel.mayMatch(node); });
    };
    SimpleSelectorSequence.prototype.trackChanges = function (node, map) {
        this.selectors.forEach(function (sel) { return sel.trackChanges(node, map); });
    };
    SimpleSelectorSequence.prototype.lookupSort = function (sorter, base) {
        this.head.lookupSort(sorter, base || this);
    };
    return SimpleSelectorSequence;
}(SimpleSelector));
exports.SimpleSelectorSequence = SimpleSelectorSequence;
var Selector = (function (_super) {
    __extends(Selector, _super);
    function Selector(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        var supportedCombinator = [undefined, " ", ">", "+"];
        var siblingGroup;
        var lastGroup;
        var groups = [];
        selectors.reverse().forEach(function (sel) {
            if (supportedCombinator.indexOf(sel.combinator) === -1) {
                throw new Error("Unsupported combinator \"" + sel.combinator + "\".");
            }
            if (sel.combinator === undefined || sel.combinator === " ") {
                groups.push(lastGroup = [siblingGroup = []]);
            }
            if (sel.combinator === ">") {
                lastGroup.push(siblingGroup = []);
            }
            siblingGroup.push(sel);
        });
        _this.groups = groups.map(function (g) {
            return new Selector.ChildGroup(g.map(function (sg) {
                return new Selector.SiblingGroup(sg);
            }));
        });
        _this.last = selectors[0];
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    Selector.prototype.toString = function () { return this.selectors.join(""); };
    Selector.prototype.match = function (node) {
        return this.groups.every(function (group, i) {
            if (i === 0) {
                node = group.match(node);
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    if (node = group.match(ancestor)) {
                        return true;
                    }
                }
                return false;
            }
        });
    };
    Selector.prototype.lookupSort = function (sorter, base) {
        this.last.lookupSort(sorter, this);
    };
    Selector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        var bounds = [];
        var mayMatch = this.groups.every(function (group, i) {
            if (i === 0) {
                var nextNode = group.mayMatch(node);
                bounds.push({ left: node, right: node });
                node = nextNode;
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    var nextNode = group.mayMatch(ancestor);
                    if (nextNode) {
                        bounds.push({ left: ancestor, right: null });
                        node = nextNode;
                        return true;
                    }
                }
                return false;
            }
        });
        if (!mayMatch) {
            return false;
        }
        if (!map) {
            return mayMatch;
        }
        for (var i = 0; i < this.groups.length; i++) {
            var group_1 = this.groups[i];
            if (!group_1.dynamic) {
                continue;
            }
            var bound = bounds[i];
            var node_1 = bound.left;
            do {
                if (group_1.mayMatch(node_1)) {
                    group_1.trackChanges(node_1, map);
                }
            } while ((node_1 !== bound.right) && (node_1 = node_1.parent));
        }
        return mayMatch;
    };
    return Selector;
}(SelectorCore));
exports.Selector = Selector;
(function (Selector) {
    var ChildGroup = (function () {
        function ChildGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        ChildGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.match(node); }) ? node : null;
        };
        ChildGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.mayMatch(node); }) ? node : null;
        };
        ChildGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = node.parent) && sel.trackChanges(node, map); });
        };
        return ChildGroup;
    }());
    Selector.ChildGroup = ChildGroup;
    var SiblingGroup = (function () {
        function SiblingGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        SiblingGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.match(node); }) ? node : null;
        };
        SiblingGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.mayMatch(node); }) ? node : null;
        };
        SiblingGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.trackChanges(node, map); });
        };
        return SiblingGroup;
    }());
    Selector.SiblingGroup = SiblingGroup;
})(Selector = exports.Selector || (exports.Selector = {}));
exports.Selector = Selector;
var RuleSet = (function () {
    function RuleSet(selectors, declarations) {
        var _this = this;
        this.selectors = selectors;
        this.declarations = declarations;
        this.selectors.forEach(function (sel) { return sel.ruleset = _this; });
    }
    RuleSet.prototype.toString = function () { return this.selectors.join(", ") + " {" + this.declarations.map(function (d, i) { return "" + (i === 0 ? " " : "") + d.property + ": " + d.value; }).join("; ") + " }"; };
    RuleSet.prototype.lookupSort = function (sorter) { this.selectors.forEach(function (sel) { return sel.lookupSort(sorter); }); };
    return RuleSet;
}());
exports.RuleSet = RuleSet;
function fromAstNodes(astRules) {
    return astRules.filter(isRule).map(function (rule) {
        var declarations = rule.declarations.filter(isDeclaration).map(createDeclaration);
        var selectors = rule.selectors.map(createSelector);
        var ruleset = new RuleSet(selectors, declarations);
        return ruleset;
    });
}
exports.fromAstNodes = fromAstNodes;
function createDeclaration(decl) {
    return { property: decl.property.toLowerCase(), value: decl.value };
}
function createSimpleSelectorFromAst(ast) {
    switch (ast.type) {
        case "*": return new UniversalSelector();
        case "#": return new IdSelector(ast.identifier);
        case "": return new TypeSelector(ast.identifier.replace(/-/, "").toLowerCase());
        case ".": return new ClassSelector(ast.identifier);
        case ":": return new PseudoClassSelector(ast.identifier);
        case "[]": return ast.test ? new AttributeSelector(ast.property, ast.test, ast.value) : new AttributeSelector(ast.property);
    }
}
function createSimpleSelectorSequenceFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty simple selector sequence."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorFromAst(ast[0]);
    }
    else {
        return new SimpleSelectorSequence(ast.map(createSimpleSelectorFromAst));
    }
}
function createSelectorFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty selector."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorSequenceFromAst(ast[0][0]);
    }
    else {
        var simpleSelectorSequences = [];
        var simpleSelectorSequence = void 0;
        var combinator = void 0;
        for (var i = 0; i < ast.length; i++) {
            simpleSelectorSequence = createSimpleSelectorSequenceFromAst(ast[i][0]);
            combinator = ast[i][1];
            if (combinator) {
                simpleSelectorSequence.combinator = combinator;
            }
            simpleSelectorSequences.push(simpleSelectorSequence);
        }
        return new Selector(simpleSelectorSequences);
    }
}
function createSelector(sel) {
    try {
        var parsedSelector = parser.parseSelector(sel);
        if (!parsedSelector) {
            return new InvalidSelector(new Error("Empty selector"));
        }
        return createSelectorFromAst(parsedSelector.value);
    }
    catch (e) {
        return new InvalidSelector(e);
    }
}
exports.createSelector = createSelector;
function isRule(node) {
    return node.type === "rule";
}
function isDeclaration(node) {
    return node.type === "declaration";
}
var SelectorsMap = (function () {
    function SelectorsMap(rulesets) {
        var _this = this;
        this.id = {};
        this.class = {};
        this.type = {};
        this.universal = [];
        this.position = 0;
        rulesets.forEach(function (rule) { return rule.lookupSort(_this); });
    }
    SelectorsMap.prototype.query = function (node) {
        var _this = this;
        var selectorClasses = [
            this.universal,
            this.id[node.id],
            this.type[node.cssType]
        ];
        if (node.cssClasses) {
            node.cssClasses.forEach(function (c) { return selectorClasses.push(_this.class[c]); });
        }
        var selectors = selectorClasses
            .filter(function (arr) { return !!arr; })
            .reduce(function (cur, next) { return cur.concat(next); }, []);
        var selectorsMatch = new SelectorsMatch();
        selectorsMatch.selectors = selectors
            .filter(function (sel) { return sel.sel.accumulateChanges(node, selectorsMatch); })
            .sort(function (a, b) { return a.sel.specificity - b.sel.specificity || a.pos - b.pos; })
            .map(function (docSel) { return docSel.sel; });
        return selectorsMatch;
    };
    SelectorsMap.prototype.sortById = function (id, sel) { this.addToMap(this.id, id, sel); };
    SelectorsMap.prototype.sortByClass = function (cssClass, sel) {
        this.addToMap(this.class, cssClass, sel);
    };
    SelectorsMap.prototype.sortByType = function (cssType, sel) {
        this.addToMap(this.type, cssType, sel);
    };
    SelectorsMap.prototype.sortAsUniversal = function (sel) { this.universal.push(this.makeDocSelector(sel)); };
    SelectorsMap.prototype.addToMap = function (map, head, sel) {
        this.position++;
        var list = map[head];
        if (list) {
            list.push(this.makeDocSelector(sel));
        }
        else {
            map[head] = [this.makeDocSelector(sel)];
        }
    };
    SelectorsMap.prototype.makeDocSelector = function (sel) {
        return { sel: sel, pos: this.position++ };
    };
    return SelectorsMap;
}());
exports.SelectorsMap = SelectorsMap;
var SelectorsMatch = (function () {
    function SelectorsMatch() {
        this.changeMap = new Map();
    }
    SelectorsMatch.prototype.addAttribute = function (node, attribute) {
        var deps = this.properties(node);
        if (!deps.attributes) {
            deps.attributes = new Set();
        }
        deps.attributes.add(attribute);
    };
    SelectorsMatch.prototype.addPseudoClass = function (node, pseudoClass) {
        var deps = this.properties(node);
        if (!deps.pseudoClasses) {
            deps.pseudoClasses = new Set();
        }
        deps.pseudoClasses.add(pseudoClass);
    };
    SelectorsMatch.prototype.properties = function (node) {
        var set = this.changeMap.get(node);
        if (!set) {
            this.changeMap.set(node, set = {});
        }
        return set;
    };
    return SelectorsMatch;
}());
exports.SelectorsMatch = SelectorsMatch;
//# sourceMappingURL=css-selector.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var Font = (function () {
    function Font(fontFamily, fontSize, fontStyle, fontWeight) {
        this.fontFamily = fontFamily;
        this.fontSize = fontSize;
        this.fontStyle = fontStyle;
        this.fontWeight = fontWeight;
    }
    Object.defineProperty(Font.prototype, "isItalic", {
        get: function () {
            return this.fontStyle === FontStyle.ITALIC;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Font.prototype, "isBold", {
        get: function () {
            return this.fontWeight === FontWeight.SEMI_BOLD ||
                this.fontWeight === FontWeight.BOLD ||
                this.fontWeight === "700" ||
                this.fontWeight === FontWeight.EXTRA_BOLD ||
                this.fontWeight === FontWeight.BLACK;
        },
        enumerable: true,
        configurable: true
    });
    Font.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.fontFamily === value2.fontFamily &&
            value1.fontSize === value2.fontSize &&
            value1.fontStyle === value2.fontStyle &&
            value1.fontWeight === value2.fontWeight;
    };
    Font.default = undefined;
    return Font;
}());
exports.Font = Font;
var FontStyle;
(function (FontStyle) {
    FontStyle.NORMAL = "normal";
    FontStyle.ITALIC = "italic";
    FontStyle.isValid = properties_1.makeValidator(FontStyle.NORMAL, FontStyle.ITALIC);
    FontStyle.parse = properties_1.makeParser(FontStyle.isValid);
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.THIN = "100";
    FontWeight.EXTRA_LIGHT = "200";
    FontWeight.LIGHT = "300";
    FontWeight.NORMAL = "normal";
    FontWeight.MEDIUM = "500";
    FontWeight.SEMI_BOLD = "600";
    FontWeight.BOLD = "bold";
    FontWeight.EXTRA_BOLD = "800";
    FontWeight.BLACK = "900";
    FontWeight.isValid = properties_1.makeValidator(FontWeight.THIN, FontWeight.EXTRA_LIGHT, FontWeight.LIGHT, FontWeight.NORMAL, "400", FontWeight.MEDIUM, FontWeight.SEMI_BOLD, FontWeight.BOLD, "700", FontWeight.EXTRA_BOLD, FontWeight.BLACK);
    FontWeight.parse = properties_1.makeParser(FontWeight.isValid);
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
function parseFontFamily(value) {
    var result = new Array();
    if (!value) {
        return result;
    }
    var split = value.split(",");
    for (var i = 0; i < split.length; i++) {
        var str = split[i].trim().replace(/['"]+/g, "");
        if (str) {
            result.push(str);
        }
    }
    return result;
}
exports.parseFontFamily = parseFontFamily;
var genericFontFamilies;
(function (genericFontFamilies) {
    genericFontFamilies.serif = "serif";
    genericFontFamilies.sansSerif = "sans-serif";
    genericFontFamilies.monospace = "monospace";
    genericFontFamilies.system = "system";
})(genericFontFamilies = exports.genericFontFamilies || (exports.genericFontFamilies = {}));
var styles = new Set();
[
    FontStyle.NORMAL,
    FontStyle.ITALIC
].forEach(function (val, i, a) { return styles.add(val); });
var weights = new Set();
[
    FontWeight.THIN,
    FontWeight.EXTRA_LIGHT,
    FontWeight.LIGHT,
    FontWeight.NORMAL,
    "400",
    FontWeight.MEDIUM,
    FontWeight.SEMI_BOLD,
    FontWeight.BOLD,
    "700",
    FontWeight.EXTRA_BOLD,
    FontWeight.BLACK
].forEach(function (val, i, a) { return weights.add(val); });
function parseFont(fontValue) {
    var result = {
        fontStyle: "normal",
        fontVariant: "normal",
        fontWeight: "normal"
    };
    var parts = fontValue.split(/\s+/);
    var part;
    while (part = parts.shift()) {
        if (part === "normal") {
        }
        else if (part === "small-caps") {
            result.fontVariant = part;
        }
        else if (styles.has(part)) {
            result.fontStyle = part;
        }
        else if (weights.has(part)) {
            result.fontWeight = part;
        }
        else if (!result.fontSize) {
            var sizes = part.split("/");
            result.fontSize = sizes[0];
            result.lineHeight = sizes.length > 1 ? sizes[1] : undefined;
        }
        else {
            result.fontFamily = part;
            if (parts.length) {
                result.fontFamily += " " + parts.join(" ");
            }
            break;
        }
    }
    return result;
}
exports.parseFont = parseFont;
//# sourceMappingURL=font-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js"));
var FONTS_BASE_PATH = "/fonts/";
var typefaceCache = new Map();
var appAssets;
var Font = (function (_super) {
    __extends(Font, _super);
    function Font(family, size, style, weight) {
        return _super.call(this, family, size, style, weight) || this;
    }
    Font.prototype.withFontFamily = function (family) {
        return new Font(family, this.fontSize, this.fontStyle, this.fontWeight);
    };
    Font.prototype.withFontStyle = function (style) {
        return new Font(this.fontFamily, this.fontSize, style, this.fontWeight);
    };
    Font.prototype.withFontWeight = function (weight) {
        return new Font(this.fontFamily, this.fontSize, this.fontStyle, weight);
    };
    Font.prototype.withFontSize = function (size) {
        return new Font(this.fontFamily, size, this.fontStyle, this.fontWeight);
    };
    Font.prototype.getAndroidTypeface = function () {
        if (!this._typeface) {
            this._typeface = createTypeface(this);
        }
        return this._typeface;
    };
    Font.prototype.getUIFont = function (defaultFont) {
        return undefined;
    };
    Font.default = new Font(undefined, undefined, "normal", "normal");
    return Font;
}(font_common_1.Font));
exports.Font = Font;
function loadFontFromFile(fontFamily) {
    appAssets = appAssets || application.android.context.getAssets();
    if (!appAssets) {
        return null;
    }
    var result = typefaceCache.get(fontFamily);
    if (result === undefined) {
        result = null;
        var fontAssetPath = void 0;
        var basePath = fs.path.join(fs.knownFolders.currentApp().path, "fonts", fontFamily);
        if (fs.File.exists(basePath + ".ttf")) {
            fontAssetPath = FONTS_BASE_PATH + fontFamily + ".ttf";
        }
        else if (fs.File.exists(basePath + ".otf")) {
            fontAssetPath = FONTS_BASE_PATH + fontFamily + ".otf";
        }
        else {
            if (trace_1.isEnabled()) {
                trace_1.write("Could not find font file for " + fontFamily, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        if (fontAssetPath) {
            try {
                fontAssetPath = fs.path.join(fs.knownFolders.currentApp().path, fontAssetPath);
                result = android.graphics.Typeface.createFromFile(fontAssetPath);
            }
            catch (e) {
                if (trace_1.isEnabled()) {
                    trace_1.write("Error loading font asset: " + fontAssetPath, trace_1.categories.Error, trace_1.messageType.error);
                }
            }
        }
        typefaceCache.set(fontFamily, result);
    }
    return result;
}
function createTypeface(font) {
    var fontStyle = 0;
    if (font.isBold) {
        fontStyle |= android.graphics.Typeface.BOLD;
    }
    if (font.isItalic) {
        fontStyle |= android.graphics.Typeface.ITALIC;
    }
    var fonts = font_common_1.parseFontFamily(font.fontFamily);
    var result = null;
    for (var i = 0; i < fonts.length; i++) {
        switch (fonts[i].toLowerCase()) {
            case font_common_1.genericFontFamilies.serif:
                result = android.graphics.Typeface.create("serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            case font_common_1.genericFontFamilies.sansSerif:
            case font_common_1.genericFontFamilies.system:
                result = android.graphics.Typeface.create("sans-serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            case font_common_1.genericFontFamilies.monospace:
                result = android.graphics.Typeface.create("monospace" + getFontWeightSuffix(font.fontWeight), fontStyle);
                break;
            default:
                result = loadFontFromFile(fonts[i]);
                if (result && fontStyle) {
                    result = android.graphics.Typeface.create(result, fontStyle);
                }
                break;
        }
        if (result) {
            break;
        }
    }
    if (!result) {
        result = android.graphics.Typeface.create("sans-serif" + getFontWeightSuffix(font.fontWeight), fontStyle);
    }
    return result;
}
function getFontWeightSuffix(fontWeight) {
    switch (fontWeight) {
        case font_common_1.FontWeight.THIN:
            return android.os.Build.VERSION.SDK_INT >= 16 ? "-thin" : "";
        case font_common_1.FontWeight.EXTRA_LIGHT:
        case font_common_1.FontWeight.LIGHT:
            return android.os.Build.VERSION.SDK_INT >= 16 ? "-light" : "";
        case font_common_1.FontWeight.NORMAL:
        case "400":
        case undefined:
        case null:
            return "";
        case font_common_1.FontWeight.MEDIUM:
        case font_common_1.FontWeight.SEMI_BOLD:
            return android.os.Build.VERSION.SDK_INT >= 21 ? "-medium" : "";
        case font_common_1.FontWeight.BOLD:
        case "700":
        case font_common_1.FontWeight.EXTRA_BOLD:
            return "";
        case font_common_1.FontWeight.BLACK:
            return android.os.Build.VERSION.SDK_INT >= 21 ? "-black" : "";
        default:
            throw new Error("Invalid font weight: \"" + fontWeight + "\"");
    }
}
//# sourceMappingURL=font.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/linear-gradient.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var LinearGradient = (function () {
    function LinearGradient() {
    }
    LinearGradient.parse = function (value) {
        var result = new LinearGradient();
        result.angle = value.angle;
        result.colorStops = value.colors.map(function (color) {
            var offset = color.offset || null;
            var offsetUnit;
            if (offset && offset.unit === "%") {
                offsetUnit = {
                    unit: "%",
                    value: offset.value
                };
            }
            return {
                color: new color_1.Color(color.argb),
                offset: offsetUnit
            };
        });
        return result;
    };
    LinearGradient.equals = function (first, second) {
        if (!first && !second) {
            return true;
        }
        else if (!first || !second) {
            return false;
        }
        if (first.angle !== second.angle) {
            return false;
        }
        if (first.colorStops.length !== second.colorStops.length) {
            return false;
        }
        for (var i = 0; i < first.colorStops.length; i++) {
            var firstStop = first.colorStops[i];
            var secondStop = second.colorStops[i];
            if (firstStop.offset !== secondStop.offset) {
                return false;
            }
            if (!color_1.Color.equals(firstStop.color, secondStop.color)) {
                return false;
            }
        }
        return true;
    };
    return LinearGradient;
}());
exports.LinearGradient = LinearGradient;
//# sourceMappingURL=linear-gradient.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
var matrix_1 = __webpack_require__("../node_modules/tns-core-modules/matrix/matrix.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
function equalsCommon(a, b) {
    if (a == "auto") {
        return b == "auto";
    }
    if (typeof a === "number") {
        if (b == "auto") {
            return false;
        }
        if (typeof b === "number") {
            return a == b;
        }
        if (!b) {
            return false;
        }
        return b.unit == "dip" && a == b.value;
    }
    if (b == "auto") {
        return false;
    }
    if (typeof b === "number") {
        return a ? (a.unit == "dip" && a.value == b) : false;
    }
    if (!a || !b) {
        return false;
    }
    return a.value == b.value && a.unit == b.unit;
}
function convertToStringCommon(length) {
    if (length == "auto") {
        return "auto";
    }
    if (typeof length === "number") {
        return length.toString();
    }
    var val = length.value;
    if (length.unit === "%") {
        val *= 100;
    }
    return val + length.unit;
}
function toDevicePixelsCommon(length, auto, parentAvailableWidth) {
    if (auto === void 0) { auto = Number.NaN; }
    if (parentAvailableWidth === void 0) { parentAvailableWidth = Number.NaN; }
    if (length == "auto") {
        return auto;
    }
    if (typeof length === "number") {
        return utils_1.layout.round(utils_1.layout.toDevicePixels(length));
    }
    if (!length) {
        return auto;
    }
    switch (length.unit) {
        case "px":
            return utils_1.layout.round(length.value);
        case "%":
            return utils_1.layout.round(parentAvailableWidth * length.value);
        case "dip":
        default:
            return utils_1.layout.round(utils_1.layout.toDevicePixels(length.value));
    }
}
var PercentLength;
(function (PercentLength) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            var percentIndex = stringValue.indexOf("%");
            if (percentIndex !== -1) {
                var value = void 0;
                if (percentIndex !== (stringValue.length - 1) || percentIndex === 0) {
                    value = Number.NaN;
                }
                else {
                    value = parseFloat(stringValue.substring(0, stringValue.length - 1).trim()) / 100;
                }
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "%", value: value };
            }
            else if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    PercentLength.parse = parse;
    PercentLength.equals = equalsCommon;
    PercentLength.toDevicePixels = toDevicePixelsCommon;
    PercentLength.convertToString = convertToStringCommon;
})(PercentLength = exports.PercentLength || (exports.PercentLength = {}));
var Length;
(function (Length) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    Length.parse = parse;
    Length.equals = equalsCommon;
    Length.toDevicePixels = toDevicePixelsCommon;
    Length.convertToString = convertToStringCommon;
})(Length = exports.Length || (exports.Length = {}));
exports.zeroLength = { value: 0, unit: "px" };
exports.minWidthProperty = new properties_1.CssProperty({
    name: "minWidth", cssName: "min-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinWidth = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minWidthProperty.register(properties_1.Style);
exports.minHeightProperty = new properties_1.CssProperty({
    name: "minHeight", cssName: "min-height", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinHeight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minHeightProperty.register(properties_1.Style);
exports.widthProperty = new properties_1.CssAnimationProperty({
    name: "width", cssName: "width", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse
});
exports.widthProperty.register(properties_1.Style);
exports.heightProperty = new properties_1.CssAnimationProperty({
    name: "height", cssName: "height", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse,
});
exports.heightProperty.register(properties_1.Style);
var marginProperty = new properties_1.ShorthandProperty({
    name: "margin", cssName: "margin",
    getter: function () {
        if (PercentLength.equals(this.marginTop, this.marginRight) &&
            PercentLength.equals(this.marginTop, this.marginBottom) &&
            PercentLength.equals(this.marginTop, this.marginLeft)) {
            return this.marginTop;
        }
        return PercentLength.convertToString(this.marginTop) + " " + PercentLength.convertToString(this.marginRight) + " " + PercentLength.convertToString(this.marginBottom) + " " + PercentLength.convertToString(this.marginLeft);
    },
    converter: convertToMargins
});
marginProperty.register(properties_1.Style);
exports.marginLeftProperty = new properties_1.CssProperty({ name: "marginLeft", cssName: "margin-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginLeftProperty.register(properties_1.Style);
exports.marginRightProperty = new properties_1.CssProperty({ name: "marginRight", cssName: "margin-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginRightProperty.register(properties_1.Style);
exports.marginTopProperty = new properties_1.CssProperty({ name: "marginTop", cssName: "margin-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginTopProperty.register(properties_1.Style);
exports.marginBottomProperty = new properties_1.CssProperty({ name: "marginBottom", cssName: "margin-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginBottomProperty.register(properties_1.Style);
var paddingProperty = new properties_1.ShorthandProperty({
    name: "padding", cssName: "padding",
    getter: function () {
        if (Length.equals(this.paddingTop, this.paddingRight) &&
            Length.equals(this.paddingTop, this.paddingBottom) &&
            Length.equals(this.paddingTop, this.paddingLeft)) {
            return this.paddingTop;
        }
        return Length.convertToString(this.paddingTop) + " " + Length.convertToString(this.paddingRight) + " " + Length.convertToString(this.paddingBottom) + " " + Length.convertToString(this.paddingLeft);
    },
    converter: convertToPaddings
});
paddingProperty.register(properties_1.Style);
exports.paddingLeftProperty = new properties_1.CssProperty({
    name: "paddingLeft", cssName: "padding-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingLeft = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingLeftProperty.register(properties_1.Style);
exports.paddingRightProperty = new properties_1.CssProperty({
    name: "paddingRight", cssName: "padding-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingRight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingRightProperty.register(properties_1.Style);
exports.paddingTopProperty = new properties_1.CssProperty({
    name: "paddingTop", cssName: "padding-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingTop = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingTopProperty.register(properties_1.Style);
exports.paddingBottomProperty = new properties_1.CssProperty({
    name: "paddingBottom", cssName: "padding-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingBottom = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingBottomProperty.register(properties_1.Style);
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.LEFT = "left";
    HorizontalAlignment.CENTER = "center";
    HorizontalAlignment.RIGHT = "right";
    HorizontalAlignment.STRETCH = "stretch";
    HorizontalAlignment.isValid = properties_1.makeValidator(HorizontalAlignment.LEFT, HorizontalAlignment.CENTER, HorizontalAlignment.RIGHT, HorizontalAlignment.STRETCH);
    HorizontalAlignment.parse = properties_1.makeParser(HorizontalAlignment.isValid);
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
exports.horizontalAlignmentProperty = new properties_1.CssProperty({ name: "horizontalAlignment", cssName: "horizontal-align", defaultValue: HorizontalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: HorizontalAlignment.parse });
exports.horizontalAlignmentProperty.register(properties_1.Style);
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.TOP = "top";
    VerticalAlignment.MIDDLE = "middle";
    VerticalAlignment.BOTTOM = "bottom";
    VerticalAlignment.STRETCH = "stretch";
    VerticalAlignment.isValid = properties_1.makeValidator(VerticalAlignment.TOP, VerticalAlignment.MIDDLE, VerticalAlignment.BOTTOM, VerticalAlignment.STRETCH);
    VerticalAlignment.parse = function (value) { return value.toLowerCase() === "center" ? VerticalAlignment.MIDDLE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(VerticalAlignment.isValid);
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
exports.verticalAlignmentProperty = new properties_1.CssProperty({ name: "verticalAlignment", cssName: "vertical-align", defaultValue: VerticalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: VerticalAlignment.parse });
exports.verticalAlignmentProperty.register(properties_1.Style);
function parseThickness(value) {
    if (typeof value === "string") {
        var arr = value.split(/[ ,]+/);
        var top_1;
        var right = void 0;
        var bottom = void 0;
        var left = void 0;
        if (arr.length === 1) {
            top_1 = arr[0];
            right = arr[0];
            bottom = arr[0];
            left = arr[0];
        }
        else if (arr.length === 2) {
            top_1 = arr[0];
            bottom = arr[0];
            right = arr[1];
            left = arr[1];
        }
        else if (arr.length === 3) {
            top_1 = arr[0];
            right = arr[1];
            left = arr[1];
            bottom = arr[2];
        }
        else if (arr.length === 4) {
            top_1 = arr[0];
            right = arr[1];
            bottom = arr[2];
            left = arr[3];
        }
        else {
            throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
        }
        return {
            top: top_1,
            right: right,
            bottom: bottom,
            left: left
        };
    }
    else {
        return value;
    }
}
function convertToMargins(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.marginTopProperty, PercentLength.parse(thickness.top)],
            [exports.marginRightProperty, PercentLength.parse(thickness.right)],
            [exports.marginBottomProperty, PercentLength.parse(thickness.bottom)],
            [exports.marginLeftProperty, PercentLength.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.marginTopProperty, value],
            [exports.marginRightProperty, value],
            [exports.marginBottomProperty, value],
            [exports.marginLeftProperty, value]
        ];
    }
}
function convertToPaddings(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.paddingTopProperty, Length.parse(thickness.top)],
            [exports.paddingRightProperty, Length.parse(thickness.right)],
            [exports.paddingBottomProperty, Length.parse(thickness.bottom)],
            [exports.paddingLeftProperty, Length.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.paddingTopProperty, value],
            [exports.paddingRightProperty, value],
            [exports.paddingBottomProperty, value],
            [exports.paddingLeftProperty, value]
        ];
    }
}
exports.rotateProperty = new properties_1.CssAnimationProperty({ name: "rotate", cssName: "rotate", defaultValue: 0, valueConverter: parseFloat });
exports.rotateProperty.register(properties_1.Style);
exports.scaleXProperty = new properties_1.CssAnimationProperty({ name: "scaleX", cssName: "scaleX", defaultValue: 1, valueConverter: parseFloat });
exports.scaleXProperty.register(properties_1.Style);
exports.scaleYProperty = new properties_1.CssAnimationProperty({ name: "scaleY", cssName: "scaleY", defaultValue: 1, valueConverter: parseFloat });
exports.scaleYProperty.register(properties_1.Style);
function parseDIPs(value) {
    if (value.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(value.replace("px", "").trim()));
    }
    else {
        return parseFloat(value.replace("dip", "").trim());
    }
}
exports.translateXProperty = new properties_1.CssAnimationProperty({ name: "translateX", cssName: "translateX", defaultValue: 0, valueConverter: parseDIPs });
exports.translateXProperty.register(properties_1.Style);
exports.translateYProperty = new properties_1.CssAnimationProperty({ name: "translateY", cssName: "translateY", defaultValue: 0, valueConverter: parseDIPs });
exports.translateYProperty.register(properties_1.Style);
var transformProperty = new properties_1.ShorthandProperty({
    name: "transform", cssName: "transform",
    getter: function () {
        var scaleX = this.scaleX;
        var scaleY = this.scaleY;
        var translateX = this.translateX;
        var translateY = this.translateY;
        var rotate = this.rotate;
        var result = "";
        if (translateX !== 0 || translateY !== 0) {
            result += "translate(" + translateX + ", " + translateY + ") ";
        }
        if (scaleX !== 1 || scaleY !== 1) {
            result += "scale(" + scaleX + ", " + scaleY + ") ";
        }
        if (rotate !== 0) {
            result += "rotate (" + rotate + ")";
        }
        return result.trim();
    },
    converter: convertToTransform
});
transformProperty.register(properties_1.Style);
var IDENTITY_TRANSFORMATION = {
    translate: { x: 0, y: 0 },
    rotate: 0,
    scale: { x: 1, y: 1 },
};
var TRANSFORM_SPLITTER = new RegExp(/\s*(.+?)\((.*?)\)/g);
var TRANSFORMATIONS = Object.freeze([
    "rotate",
    "translate",
    "translate3d",
    "translateX",
    "translateY",
    "scale",
    "scale3d",
    "scaleX",
    "scaleY",
]);
var STYLE_TRANSFORMATION_MAP = Object.freeze({
    "scale": function (value) { return ({ property: "scale", value: value }); },
    "scale3d": function (value) { return ({ property: "scale", value: value }); },
    "scaleX": function (_a) {
        var x = _a.x;
        return ({ property: "scale", value: { x: x, y: IDENTITY_TRANSFORMATION.scale.y } });
    },
    "scaleY": function (_a) {
        var y = _a.y;
        return ({ property: "scale", value: { y: y, x: IDENTITY_TRANSFORMATION.scale.x } });
    },
    "translate": function (value) { return ({ property: "translate", value: value }); },
    "translate3d": function (value) { return ({ property: "translate", value: value }); },
    "translateX": function (_a) {
        var x = _a.x;
        return ({ property: "translate", value: { x: x, y: IDENTITY_TRANSFORMATION.translate.y } });
    },
    "translateY": function (_a) {
        var y = _a.y;
        return ({ property: "translate", value: { y: y, x: IDENTITY_TRANSFORMATION.translate.x } });
    },
    "rotate": function (value) { return ({ property: "rotate", value: value }); },
});
function convertToTransform(value) {
    if (value === properties_1.unsetValue) {
        value = "none";
    }
    var _a = transformConverter(value), translate = _a.translate, rotate = _a.rotate, scale = _a.scale;
    return [
        [exports.translateXProperty, translate.x],
        [exports.translateYProperty, translate.y],
        [exports.scaleXProperty, scale.x],
        [exports.scaleYProperty, scale.y],
        [exports.rotateProperty, rotate],
    ];
}
function transformConverter(text) {
    var transformations = parseTransformString(text);
    if (text === "none" || text === "" || !transformations.length) {
        return IDENTITY_TRANSFORMATION;
    }
    var usedTransforms = transformations.map(function (t) { return t.property; });
    if (!utils_1.hasDuplicates(usedTransforms)) {
        var fullTransformations_1 = __assign({}, IDENTITY_TRANSFORMATION);
        transformations.forEach(function (transform) {
            fullTransformations_1[transform.property] = transform.value;
        });
        return fullTransformations_1;
    }
    var affineMatrix = transformations
        .map(matrix_1.getTransformMatrix)
        .reduce(matrix_1.multiplyAffine2d);
    var cssMatrix = matrix_1.matrixArrayToCssMatrix(affineMatrix);
    return matrix_1.decompose2DTransformMatrix(cssMatrix);
}
exports.transformConverter = transformConverter;
function parseTransformString(text) {
    var matches = [];
    var match;
    while ((match = TRANSFORM_SPLITTER.exec(text)) !== null) {
        var property = match[1];
        var value = convertTransformValue(property, match[2]);
        if (TRANSFORMATIONS.indexOf(property) !== -1) {
            matches.push(normalizeTransformation({ property: property, value: value }));
        }
    }
    return matches;
}
function normalizeTransformation(_a) {
    var property = _a.property, value = _a.value;
    return STYLE_TRANSFORMATION_MAP[property](value);
}
function convertTransformValue(property, stringValue) {
    var _a = stringValue.split(",").map(parseFloat), x = _a[0], _b = _a[1], y = _b === void 0 ? x : _b;
    if (property === "rotate") {
        return stringValue.slice(-3) === "rad" ? number_utils_1.radiansToDegrees(x) : x;
    }
    return { x: x, y: y };
}
var backgroundProperty = new properties_1.ShorthandProperty({
    name: "background", cssName: "background",
    getter: function () {
        return this.backgroundColor + " " + this.backgroundImage + " " + this.backgroundRepeat + " " + this.backgroundPosition;
    },
    converter: convertToBackgrounds
});
backgroundProperty.register(properties_1.Style);
exports.backgroundInternalProperty = new properties_1.CssProperty({
    name: "backgroundInternal",
    cssName: "_backgroundInternal",
    defaultValue: background_1.Background.default
});
exports.backgroundInternalProperty.register(properties_1.Style);
exports.backgroundImageProperty = new properties_1.CssProperty({
    name: "backgroundImage", cssName: "background-image", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withImage(newValue);
        target.backgroundInternal = background;
    },
    equalityComparer: function (value1, value2) {
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            return linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            return value1 === value2;
        }
    },
    valueConverter: function (value) {
        if (typeof value === "string") {
            var parsed = parser.parseBackground(value);
            if (parsed) {
                var background = parsed.value;
                value = (typeof background.image === "object") ? linear_gradient_1.LinearGradient.parse(background.image) : value;
            }
        }
        return value;
    }
});
exports.backgroundImageProperty.register(properties_1.Style);
exports.backgroundColorProperty = new properties_1.CssAnimationProperty({
    name: "backgroundColor", cssName: "background-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.backgroundColorProperty.register(properties_1.Style);
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.REPEAT = "repeat";
    BackgroundRepeat.REPEAT_X = "repeat-x";
    BackgroundRepeat.REPEAT_Y = "repeat-y";
    BackgroundRepeat.NO_REPEAT = "no-repeat";
    BackgroundRepeat.isValid = properties_1.makeValidator(BackgroundRepeat.REPEAT, BackgroundRepeat.REPEAT_X, BackgroundRepeat.REPEAT_Y, BackgroundRepeat.NO_REPEAT);
    BackgroundRepeat.parse = properties_1.makeParser(BackgroundRepeat.isValid);
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
exports.backgroundRepeatProperty = new properties_1.CssProperty({
    name: "backgroundRepeat", cssName: "background-repeat", valueConverter: BackgroundRepeat.parse,
    valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withRepeat(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundRepeatProperty.register(properties_1.Style);
exports.backgroundSizeProperty = new properties_1.CssProperty({
    name: "backgroundSize", cssName: "background-size", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withSize(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundSizeProperty.register(properties_1.Style);
exports.backgroundPositionProperty = new properties_1.CssProperty({
    name: "backgroundPosition", cssName: "background-position", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withPosition(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundPositionProperty.register(properties_1.Style);
function convertToBackgrounds(value) {
    if (typeof value === "string") {
        var backgrounds = parser.parseBackground(value).value;
        var backgroundColor = backgrounds.color ? new color_1.Color(backgrounds.color) : properties_1.unsetValue;
        var backgroundImage = void 0;
        if (typeof backgrounds.image === "object" && backgrounds.image) {
            backgroundImage = linear_gradient_1.LinearGradient.parse(backgrounds.image);
        }
        else {
            backgroundImage = backgrounds.image || properties_1.unsetValue;
        }
        var backgroundRepeat = backgrounds.repeat || properties_1.unsetValue;
        var backgroundPosition = backgrounds.position ? backgrounds.position.text : properties_1.unsetValue;
        return [
            [exports.backgroundColorProperty, backgroundColor],
            [exports.backgroundImageProperty, backgroundImage],
            [exports.backgroundRepeatProperty, backgroundRepeat],
            [exports.backgroundPositionProperty, backgroundPosition]
        ];
    }
    else {
        return [
            [exports.backgroundColorProperty, properties_1.unsetValue],
            [exports.backgroundImageProperty, properties_1.unsetValue],
            [exports.backgroundRepeatProperty, properties_1.unsetValue],
            [exports.backgroundPositionProperty, properties_1.unsetValue]
        ];
    }
}
function parseBorderColor(value) {
    var result = { top: undefined, right: undefined, bottom: undefined, left: undefined };
    if (value.indexOf("rgb") === 0) {
        result.top = result.right = result.bottom = result.left = new color_1.Color(value);
        return result;
    }
    var arr = value.split(/[ ,]+/);
    if (arr.length === 1) {
        var arr0 = new color_1.Color(arr[0]);
        result.top = arr0;
        result.right = arr0;
        result.bottom = arr0;
        result.left = arr0;
    }
    else if (arr.length === 2) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr0;
        result.left = arr1;
    }
    else if (arr.length === 3) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr1;
    }
    else if (arr.length === 4) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        var arr3 = new color_1.Color(arr[3]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr3;
    }
    else {
        throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
    }
    return result;
}
var borderColorProperty = new properties_1.ShorthandProperty({
    name: "borderColor", cssName: "border-color",
    getter: function () {
        if (color_1.Color.equals(this.borderTopColor, this.borderRightColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderBottomColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderLeftColor)) {
            return this.borderTopColor;
        }
        else {
            return this.borderTopColor + " " + this.borderRightColor + " " + this.borderBottomColor + " " + this.borderLeftColor;
        }
    },
    converter: function (value) {
        if (typeof value === "string") {
            var fourColors = parseBorderColor(value);
            return [
                [exports.borderTopColorProperty, fourColors.top],
                [exports.borderRightColorProperty, fourColors.right],
                [exports.borderBottomColorProperty, fourColors.bottom],
                [exports.borderLeftColorProperty, fourColors.left]
            ];
        }
        else {
            return [
                [exports.borderTopColorProperty, value],
                [exports.borderRightColorProperty, value],
                [exports.borderBottomColorProperty, value],
                [exports.borderLeftColorProperty, value]
            ];
        }
    }
});
borderColorProperty.register(properties_1.Style);
exports.borderTopColorProperty = new properties_1.CssProperty({
    name: "borderTopColor", cssName: "border-top-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderTopColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderTopColorProperty.register(properties_1.Style);
exports.borderRightColorProperty = new properties_1.CssProperty({
    name: "borderRightColor", cssName: "border-right-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderRightColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderRightColorProperty.register(properties_1.Style);
exports.borderBottomColorProperty = new properties_1.CssProperty({
    name: "borderBottomColor", cssName: "border-bottom-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderBottomColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderBottomColorProperty.register(properties_1.Style);
exports.borderLeftColorProperty = new properties_1.CssProperty({
    name: "borderLeftColor", cssName: "border-left-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderLeftColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderLeftColorProperty.register(properties_1.Style);
var borderWidthProperty = new properties_1.ShorthandProperty({
    name: "borderWidth", cssName: "border-width",
    getter: function () {
        if (Length.equals(this.borderTopWidth, this.borderRightWidth) &&
            Length.equals(this.borderTopWidth, this.borderBottomWidth) &&
            Length.equals(this.borderTopWidth, this.borderLeftWidth)) {
            return this.borderTopWidth;
        }
        else {
            return Length.convertToString(this.borderTopWidth) + " " + Length.convertToString(this.borderRightWidth) + " " + Length.convertToString(this.borderBottomWidth) + " " + Length.convertToString(this.borderLeftWidth);
        }
    },
    converter: function (value) {
        if (typeof value === "string" && value !== "auto") {
            var borderWidths = parseThickness(value);
            return [
                [exports.borderTopWidthProperty, borderWidths.top],
                [exports.borderRightWidthProperty, borderWidths.right],
                [exports.borderBottomWidthProperty, borderWidths.bottom],
                [exports.borderLeftWidthProperty, borderWidths.left]
            ];
        }
        else {
            return [
                [exports.borderTopWidthProperty, value],
                [exports.borderRightWidthProperty, value],
                [exports.borderBottomWidthProperty, value],
                [exports.borderLeftWidthProperty, value]
            ];
        }
    }
});
borderWidthProperty.register(properties_1.Style);
exports.borderTopWidthProperty = new properties_1.CssProperty({
    name: "borderTopWidth", cssName: "border-top-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderTopWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderTopWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopWidthProperty.register(properties_1.Style);
exports.borderRightWidthProperty = new properties_1.CssProperty({
    name: "borderRightWidth", cssName: "border-right-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-right-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderRightWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderRightWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderRightWidthProperty.register(properties_1.Style);
exports.borderBottomWidthProperty = new properties_1.CssProperty({
    name: "borderBottomWidth", cssName: "border-bottom-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderBottomWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderBottomWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomWidthProperty.register(properties_1.Style);
exports.borderLeftWidthProperty = new properties_1.CssProperty({
    name: "borderLeftWidth", cssName: "border-left-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-left-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderLeftWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderLeftWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderLeftWidthProperty.register(properties_1.Style);
var borderRadiusProperty = new properties_1.ShorthandProperty({
    name: "borderRadius", cssName: "border-radius",
    getter: function () {
        if (Length.equals(this.borderTopLeftRadius, this.borderTopRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomLeftRadius)) {
            return this.borderTopLeftRadius;
        }
        return Length.convertToString(this.borderTopLeftRadius) + " " + Length.convertToString(this.borderTopRightRadius) + " " + Length.convertToString(this.borderBottomRightRadius) + " " + Length.convertToString(this.borderBottomLeftRadius);
    },
    converter: function (value) {
        if (typeof value === "string") {
            var borderRadius = parseThickness(value);
            return [
                [exports.borderTopLeftRadiusProperty, borderRadius.top],
                [exports.borderTopRightRadiusProperty, borderRadius.right],
                [exports.borderBottomRightRadiusProperty, borderRadius.bottom],
                [exports.borderBottomLeftRadiusProperty, borderRadius.left]
            ];
        }
        else {
            return [
                [exports.borderTopLeftRadiusProperty, value],
                [exports.borderTopRightRadiusProperty, value],
                [exports.borderBottomRightRadiusProperty, value],
                [exports.borderBottomLeftRadiusProperty, value]
            ];
        }
    }
});
borderRadiusProperty.register(properties_1.Style);
exports.borderTopLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderTopLeftRadius", cssName: "border-top-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopLeftRadiusProperty.register(properties_1.Style);
exports.borderTopRightRadiusProperty = new properties_1.CssProperty({
    name: "borderTopRightRadius", cssName: "border-top-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopRightRadiusProperty.register(properties_1.Style);
exports.borderBottomRightRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomRightRadius", cssName: "border-bottom-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomRightRadiusProperty.register(properties_1.Style);
exports.borderBottomLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomLeftRadius", cssName: "border-bottom-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomLeftRadiusProperty.register(properties_1.Style);
function isNonNegativeFiniteNumber(value) {
    return isFinite(value) && !isNaN(value) && value >= 0;
}
var supportedPaths = ["rect", "circle", "ellipse", "polygon", "inset"];
function isClipPathValid(value) {
    if (!value) {
        return true;
    }
    var functionName = value.substring(0, value.indexOf("(")).trim();
    return supportedPaths.indexOf(functionName) !== -1;
}
exports.clipPathProperty = new properties_1.CssProperty({
    name: "clipPath", cssName: "clip-path", valueChanged: function (target, oldValue, newValue) {
        if (!isClipPathValid(newValue)) {
            throw new Error("clip-path is not valid.");
        }
        var background = target.backgroundInternal.withClipPath(newValue);
        target.backgroundInternal = background;
    }
});
exports.clipPathProperty.register(properties_1.Style);
function isFloatValueConverter(value) {
    var newValue = parseFloat(value);
    if (isNaN(newValue)) {
        throw new Error("Invalid value: " + newValue);
    }
    return newValue;
}
exports.zIndexProperty = new properties_1.CssProperty({ name: "zIndex", cssName: "z-index", valueConverter: isFloatValueConverter });
exports.zIndexProperty.register(properties_1.Style);
function opacityConverter(value) {
    var newValue = parseFloat(value);
    if (!isNaN(newValue) && 0 <= newValue && newValue <= 1) {
        return newValue;
    }
    throw new Error("Opacity should be between [0, 1]. Value: " + newValue);
}
exports.opacityProperty = new properties_1.CssAnimationProperty({ name: "opacity", cssName: "opacity", defaultValue: 1, valueConverter: opacityConverter });
exports.opacityProperty.register(properties_1.Style);
exports.colorProperty = new properties_1.InheritedCssProperty({ name: "color", cssName: "color", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.colorProperty.register(properties_1.Style);
exports.fontInternalProperty = new properties_1.CssProperty({ name: "fontInternal", cssName: "_fontInternal", defaultValue: font_1.Font.default });
exports.fontInternalProperty.register(properties_1.Style);
exports.fontFamilyProperty = new properties_1.InheritedCssProperty({
    name: "fontFamily", cssName: "font-family", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontFamily !== newValue) {
            var newFont = currentFont.withFontFamily(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontFamilyProperty.register(properties_1.Style);
exports.fontSizeProperty = new properties_1.InheritedCssProperty({
    name: "fontSize", cssName: "font-size", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontSize !== newValue) {
            var newFont = currentFont.withFontSize(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    },
    valueConverter: function (v) { return parseFloat(v); }
});
exports.fontSizeProperty.register(properties_1.Style);
exports.fontStyleProperty = new properties_1.InheritedCssProperty({
    name: "fontStyle", cssName: "font-style", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontStyle.NORMAL, valueConverter: font_1.FontStyle.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontStyle !== newValue) {
            var newFont = currentFont.withFontStyle(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontStyleProperty.register(properties_1.Style);
exports.fontWeightProperty = new properties_1.InheritedCssProperty({
    name: "fontWeight", cssName: "font-weight", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontWeight.NORMAL, valueConverter: font_1.FontWeight.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontWeight !== newValue) {
            var newFont = currentFont.withFontWeight(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontWeightProperty.register(properties_1.Style);
var fontProperty = new properties_1.ShorthandProperty({
    name: "font", cssName: "font",
    getter: function () {
        return this.fontStyle + " " + this.fontWeight + " " + this.fontSize + " " + this.fontFamily;
    },
    converter: function (value) {
        if (value === properties_1.unsetValue) {
            return [
                [exports.fontStyleProperty, properties_1.unsetValue],
                [exports.fontWeightProperty, properties_1.unsetValue],
                [exports.fontSizeProperty, properties_1.unsetValue],
                [exports.fontFamilyProperty, properties_1.unsetValue]
            ];
        }
        else {
            var font = font_1.parseFont(value);
            var fontSize = parseFloat(font.fontSize);
            return [
                [exports.fontStyleProperty, font.fontStyle],
                [exports.fontWeightProperty, font.fontWeight],
                [exports.fontSizeProperty, fontSize],
                [exports.fontFamilyProperty, font.fontFamily]
            ];
        }
    }
});
fontProperty.register(properties_1.Style);
var Visibility;
(function (Visibility) {
    Visibility.VISIBLE = "visible";
    Visibility.HIDDEN = "hidden";
    Visibility.COLLAPSE = "collapse";
    Visibility.isValid = properties_1.makeValidator(Visibility.VISIBLE, Visibility.HIDDEN, Visibility.COLLAPSE);
    Visibility.parse = function (value) { return value.toLowerCase() === "collapsed" ? Visibility.COLLAPSE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(Visibility.isValid);
})(Visibility = exports.Visibility || (exports.Visibility = {}));
exports.visibilityProperty = new properties_1.CssProperty({
    name: "visibility", cssName: "visibility", defaultValue: Visibility.VISIBLE, affectsLayout: platform_1.isIOS, valueConverter: Visibility.parse, valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.isCollapsed = (newValue === Visibility.COLLAPSE);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }
});
exports.visibilityProperty.register(properties_1.Style);
exports.androidElevationProperty = new properties_1.CssProperty({ name: "androidElevation", cssName: "android-elevation", valueConverter: parseFloat });
exports.androidElevationProperty.register(properties_1.Style);
exports.androidDynamicElevationOffsetProperty = new properties_1.CssProperty({ name: "androidDynamicElevationOffset", cssName: "android-dynamic-elevation-offset", valueConverter: parseFloat });
exports.androidDynamicElevationOffsetProperty.register(properties_1.Style);
//# sourceMappingURL=style-properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-scope.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var css_1 = __webpack_require__("../node_modules/tns-core-modules/css/index.js");
var parser_1 = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var css_selector_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var keyframeAnimationModule;
function ensureKeyframeAnimationModule() {
    if (!keyframeAnimationModule) {
        keyframeAnimationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
    }
}
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var cssAnimationParserModule;
function ensureCssAnimationParserModule() {
    if (!cssAnimationParserModule) {
        cssAnimationParserModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-animation-parser.js");
    }
}
var parser = "rework";
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.cssParser === "nativescript") {
        parser = "nativescript";
    }
}
catch (e) {
}
function evaluateCssExpressions(view, property, value) {
    var newValue = properties_1._evaluateCssVariableExpression(view, property, value);
    if (newValue === "unset") {
        return properties_1.unsetValue;
    }
    value = newValue;
    try {
        value = properties_1._evaluateCssCalcExpression(value);
    }
    catch (e) {
        trace_1.write("Failed to evaluate css-calc for property [" + property + "] for expression [" + value + "] to " + view + ". " + e.stack, trace_1.categories.Error, trace_1.messageType.error);
        return properties_1.unsetValue;
    }
    return value;
}
function mergeCssSelectors() {
    applicationCssSelectors = applicationSelectors.slice();
    applicationCssSelectors.push.apply(applicationCssSelectors, applicationAdditionalSelectors);
    applicationCssSelectorVersion++;
}
exports.mergeCssSelectors = mergeCssSelectors;
var applicationCssSelectors = [];
var applicationCssSelectorVersion = 0;
var applicationSelectors = [];
var applicationAdditionalSelectors = [];
var applicationKeyframes = {};
var animationsSymbol = Symbol("animations");
var pattern = /('|")(.*?)\1/;
var CSSSource = (function () {
    function CSSSource(_ast, _url, _file, _keyframes, _source) {
        this._ast = _ast;
        this._url = _url;
        this._file = _file;
        this._keyframes = _keyframes;
        this._source = _source;
        this._selectors = [];
        this.parse();
    }
    CSSSource.fromURI = function (uri, keyframes) {
        var appRelativeUri = CSSSource.pathRelativeToApp(uri);
        var sanitizedModuleName = module_name_sanitizer_1.sanitizeModuleName(appRelativeUri);
        var resolvedModuleName = module_name_resolver_1.resolveModuleName(sanitizedModuleName, "css");
        try {
            var cssOrAst = global.loadModule(resolvedModuleName, true);
            if (cssOrAst) {
                if (typeof cssOrAst === "string") {
                    return CSSSource.fromSource(cssOrAst, keyframes, resolvedModuleName);
                }
                else if (typeof cssOrAst === "object" && cssOrAst.type === "stylesheet" && cssOrAst.stylesheet && cssOrAst.stylesheet.rules) {
                    return CSSSource.fromAST(cssOrAst, keyframes, resolvedModuleName);
                }
                else {
                    return CSSSource.fromSource(cssOrAst.toString(), keyframes, resolvedModuleName);
                }
            }
        }
        catch (e) {
            trace_1.write("Could not load CSS from " + uri + ": " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
        return CSSSource.fromFile(appRelativeUri, keyframes);
    };
    CSSSource.pathRelativeToApp = function (uri) {
        if (!uri.startsWith("/")) {
            return uri;
        }
        var appPath = file_system_1.knownFolders.currentApp().path;
        if (!uri.startsWith(appPath)) {
            trace_1.write(uri + " does not start with " + appPath, trace_1.categories.Error, trace_1.messageType.error);
            return uri;
        }
        var relativeUri = "." + uri.substr(appPath.length);
        return relativeUri;
    };
    CSSSource.fromFile = function (url, keyframes) {
        var cssFileUrl = url.replace(/\..\w+$/, ".css");
        if (cssFileUrl !== url) {
            var cssFile = CSSSource.resolveCSSPathFromURL(cssFileUrl);
            if (cssFile) {
                return new CSSSource(undefined, url, cssFile, keyframes, undefined);
            }
        }
        var file = CSSSource.resolveCSSPathFromURL(url);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.fromFileImport = function (url, keyframes, importSource) {
        var file = CSSSource.resolveCSSPathFromURL(url, importSource);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.resolveCSSPathFromURL = function (url, importSource) {
        var app = file_system_1.knownFolders.currentApp().path;
        var file = resolveFileNameFromUrl(url, app, file_system_1.File.exists, importSource);
        return file;
    };
    CSSSource.fromSource = function (source, keyframes, url) {
        return new CSSSource(undefined, url, undefined, keyframes, source);
    };
    CSSSource.fromAST = function (ast, keyframes, url) {
        return new CSSSource(ast, url, undefined, keyframes, undefined);
    };
    Object.defineProperty(CSSSource.prototype, "selectors", {
        get: function () { return this._selectors; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CSSSource.prototype, "source", {
        get: function () { return this._source; },
        enumerable: true,
        configurable: true
    });
    CSSSource.prototype.load = function () {
        var file = file_system_1.File.fromPath(this._file);
        this._source = file.readTextSync();
    };
    CSSSource.prototype.parse = function () {
        try {
            if (!this._ast) {
                if (!this._source && this._file) {
                    this.load();
                }
                if (this._source && this.source !== "[object Object]") {
                    this.parseCSSAst();
                }
            }
            if (this._ast) {
                this.createSelectors();
            }
            else {
                this._selectors = [];
            }
        }
        catch (e) {
            trace_1.write("Css styling failed: " + e, trace_1.categories.Error, trace_1.messageType.error);
            this._selectors = [];
        }
    };
    CSSSource.prototype.parseCSSAst = function () {
        if (this._source) {
            switch (parser) {
                case "nativescript":
                    var cssparser = new parser_1.CSS3Parser(this._source);
                    var stylesheet = cssparser.parseAStylesheet();
                    var cssNS = new parser_1.CSSNativeScript();
                    this._ast = cssNS.parseStylesheet(stylesheet);
                    return;
                case "rework":
                    this._ast = css_1.parse(this._source, { source: this._file });
                    return;
            }
        }
    };
    CSSSource.prototype.createSelectors = function () {
        if (this._ast) {
            this._selectors = __spreadArrays(this.createSelectorsFromImports(), this.createSelectorsFromSyntaxTree());
        }
    };
    CSSSource.prototype.createSelectorsFromImports = function () {
        var _this = this;
        var imports = this._ast["stylesheet"]["rules"].filter(function (r) { return r.type === "import"; });
        var urlFromImportObject = function (importObject) {
            var importItem = importObject["import"];
            var urlMatch = importItem && importItem.match(pattern);
            return urlMatch && urlMatch[2];
        };
        var sourceFromImportObject = function (importObject) {
            return importObject["position"] && importObject["position"]["source"];
        };
        var toUrlSourcePair = function (importObject) { return ({
            url: urlFromImportObject(importObject),
            source: sourceFromImportObject(importObject),
        }); };
        var getCssFile = function (_a) {
            var url = _a.url, source = _a.source;
            return source ?
                CSSSource.fromFileImport(url, _this._keyframes, source) :
                CSSSource.fromURI(url, _this._keyframes);
        };
        var cssFiles = imports
            .map(toUrlSourcePair)
            .filter(function (_a) {
            var url = _a.url;
            return !!url;
        })
            .map(getCssFile);
        var selectors = cssFiles.map(function (file) { return (file && file.selectors) || []; });
        return selectors.reduce(function (acc, val) { return acc.concat(val); }, []);
    };
    CSSSource.prototype.createSelectorsFromSyntaxTree = function () {
        var _this = this;
        var nodes = this._ast.stylesheet.rules;
        nodes.filter(isKeyframe).forEach(function (node) { return _this._keyframes[node.name] = node; });
        var rulesets = css_selector_1.fromAstNodes(nodes);
        if (rulesets && rulesets.length) {
            ensureCssAnimationParserModule();
            rulesets.forEach(function (rule) {
                rule[animationsSymbol] = cssAnimationParserModule.CssAnimationParser
                    .keyframeAnimationsFromCSSDeclarations(rule.declarations);
            });
        }
        return rulesets;
    };
    CSSSource.prototype.toString = function () {
        return this._file || this._url || "(in-memory)";
    };
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "load", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parse", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parseCSSAst", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "createSelectors", null);
    __decorate([
        profiling_1.profile
    ], CSSSource, "resolveCSSPathFromURL", null);
    return CSSSource;
}());
function removeTaggedAdditionalCSS(tag) {
    var changed = false;
    for (var i = 0; i < applicationAdditionalSelectors.length; i++) {
        if (applicationAdditionalSelectors[i].tag === tag) {
            applicationAdditionalSelectors.splice(i, 1);
            i--;
            changed = true;
        }
    }
    if (changed) {
        mergeCssSelectors();
    }
    return changed;
}
exports.removeTaggedAdditionalCSS = removeTaggedAdditionalCSS;
function addTaggedAdditionalCSS(cssText, tag) {
    var parsed = CSSSource.fromSource(cssText, applicationKeyframes, undefined).selectors;
    var changed = false;
    if (parsed && parsed.length) {
        changed = true;
        if (tag != null) {
            for (var i = 0; i < parsed.length; i++) {
                parsed[i].tag = tag;
            }
        }
        applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
        mergeCssSelectors();
    }
    return changed;
}
exports.addTaggedAdditionalCSS = addTaggedAdditionalCSS;
var onCssChanged = profiling_1.profile("\"style-scope\".onCssChanged", function (args) {
    if (args.cssText) {
        var parsed = CSSSource.fromSource(args.cssText, applicationKeyframes, args.cssFile).selectors;
        if (parsed) {
            applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
            mergeCssSelectors();
        }
    }
    else if (args.cssFile) {
        loadCss(args.cssFile);
    }
});
function onLiveSync(args) {
    loadCss(applicationCommon.getCssFileName());
}
var loadCss = profiling_1.profile("\"style-scope\".loadCss", function (cssModule) {
    if (!cssModule) {
        return undefined;
    }
    if (cssModule.startsWith("./")) {
        cssModule = cssModule.substr(2);
    }
    var result = CSSSource.fromURI(cssModule, applicationKeyframes).selectors;
    if (result.length > 0) {
        applicationSelectors = result;
        mergeCssSelectors();
    }
});
applicationCommon.on("cssChanged", onCssChanged);
applicationCommon.on("livesync", onLiveSync);
exports.loadAppCSS = profiling_1.profile("\"style-scope\".loadAppCSS", function (args) {
    loadCss(args.cssFile);
    applicationCommon.off("loadAppCss", exports.loadAppCSS);
});
if (applicationCommon.hasLaunched()) {
    exports.loadAppCSS({ eventName: "loadAppCss", object: applicationCommon, cssFile: applicationCommon.getCssFileName() });
}
else {
    applicationCommon.on("loadAppCss", exports.loadAppCSS);
}
var CssState = (function () {
    function CssState(viewRef) {
        var _this = this;
        this.viewRef = viewRef;
        this._onDynamicStateChangeHandler = function () { return _this.updateDynamicState(); };
    }
    CssState.prototype.onChange = function () {
        var view = this.viewRef.get();
        if (view && view.isLoaded) {
            this.unsubscribeFromDynamicUpdates();
            this.updateMatch();
            this.subscribeForDynamicUpdates();
            this.updateDynamicState();
        }
        else {
            this._matchInvalid = true;
        }
    };
    CssState.prototype.isSelectorsLatestVersionApplied = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("isSelectorsLatestVersionApplied returns default value \"false\" because \"this.viewRef\" cleared.", trace_1.categories.Style, trace_1.messageType.warn);
            return false;
        }
        return this.viewRef.get()._styleScope._getSelectorsVersion() === this._appliedSelectorsVersion;
    };
    CssState.prototype.onLoaded = function () {
        if (this._matchInvalid) {
            this.updateMatch();
        }
        this.subscribeForDynamicUpdates();
        this.updateDynamicState();
    };
    CssState.prototype.onUnloaded = function () {
        this.unsubscribeFromDynamicUpdates();
    };
    CssState.prototype.updateMatch = function () {
        var view = this.viewRef.get();
        if (view && view._styleScope) {
            this._match = view._styleScope.matchSelectors(view);
            this._appliedSelectorsVersion = view._styleScope._getSelectorsVersion();
        }
        else {
            this._match = CssState.emptyMatch;
        }
        this._matchInvalid = false;
    };
    CssState.prototype.updateDynamicState = function () {
        var _this = this;
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("updateDynamicState not executed to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var matchingSelectors = this._match.selectors.filter(function (sel) { return sel.dynamic ? sel.match(view) : true; });
        view._batchUpdate(function () {
            _this.stopKeyframeAnimations();
            _this.setPropertyValues(matchingSelectors);
            _this.playKeyframeAnimations(matchingSelectors);
        });
    };
    CssState.prototype.playKeyframeAnimations = function (matchingSelectors) {
        var animations = [];
        matchingSelectors.forEach(function (selector) {
            var ruleAnimations = selector.ruleset[animationsSymbol];
            if (ruleAnimations) {
                ensureKeyframeAnimationModule();
                for (var _i = 0, ruleAnimations_1 = ruleAnimations; _i < ruleAnimations_1.length; _i++) {
                    var animationInfo = ruleAnimations_1[_i];
                    var animation = keyframeAnimationModule.KeyframeAnimation.keyframeAnimationFromInfo(animationInfo);
                    if (animation) {
                        animations.push(animation);
                    }
                }
            }
        });
        if (this._playsKeyframeAnimations = animations.length > 0) {
            var view_1 = this.viewRef.get();
            if (!view_1) {
                trace_1.write("KeyframeAnimations cannot play because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            animations.map(function (animation) { return animation.play(view_1); });
            Object.freeze(animations);
            this._appliedAnimations = animations;
        }
    };
    CssState.prototype.stopKeyframeAnimations = function () {
        if (!this._playsKeyframeAnimations) {
            return;
        }
        this._appliedAnimations
            .filter(function (animation) { return animation.isPlaying; })
            .forEach(function (animation) { return animation.cancel(); });
        this._appliedAnimations = CssState.emptyAnimationArray;
        var view = this.viewRef.get();
        if (view) {
            view.style["keyframe:rotate"] = properties_1.unsetValue;
            view.style["keyframe:scaleX"] = properties_1.unsetValue;
            view.style["keyframe:scaleY"] = properties_1.unsetValue;
            view.style["keyframe:translateX"] = properties_1.unsetValue;
            view.style["keyframe:translateY"] = properties_1.unsetValue;
            view.style["keyframe:backgroundColor"] = properties_1.unsetValue;
            view.style["keyframe:opacity"] = properties_1.unsetValue;
        }
        else {
            trace_1.write("KeyframeAnimations cannot be stopped because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
        }
        this._playsKeyframeAnimations = false;
    };
    CssState.prototype.setPropertyValues = function (matchingSelectors) {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write(matchingSelectors + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var newPropertyValues = new view.style.PropertyBag();
        matchingSelectors.forEach(function (selector) {
            return selector.ruleset.declarations.forEach(function (declaration) {
                return newPropertyValues[declaration.property] = declaration.value;
            });
        });
        var oldProperties = this._appliedPropertyValues;
        var isCssExpressionInUse = false;
        view.style.resetScopedCssVariables();
        for (var property in newPropertyValues) {
            var value = newPropertyValues[property];
            if (properties_1.isCssVariable(property)) {
                view.style.setScopedCssVariable(property, value);
                delete newPropertyValues[property];
                continue;
            }
            isCssExpressionInUse = isCssExpressionInUse || properties_1.isCssVariableExpression(value) || properties_1.isCssCalcExpression(value);
        }
        if (isCssExpressionInUse) {
            for (var property in newPropertyValues) {
                var value = evaluateCssExpressions(view, property, newPropertyValues[property]);
                if (value === properties_1.unsetValue) {
                    delete newPropertyValues[property];
                    continue;
                }
                newPropertyValues[property] = value;
            }
        }
        Object.freeze(newPropertyValues);
        for (var property in oldProperties) {
            if (!(property in newPropertyValues)) {
                if (property in view.style) {
                    view.style["css:" + property] = properties_1.unsetValue;
                }
                else {
                }
            }
        }
        for (var property in newPropertyValues) {
            if (oldProperties && property in oldProperties && oldProperties[property] === newPropertyValues[property]) {
                continue;
            }
            var value = newPropertyValues[property];
            try {
                if (property in view.style) {
                    view.style["css:" + property] = value;
                }
                else {
                    var camelCasedProperty = property.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase(); });
                    view[camelCasedProperty] = value;
                }
            }
            catch (e) {
                trace_1.write("Failed to apply property [" + property + "] with value [" + value + "] to " + view + ". " + e.stack, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        this._appliedPropertyValues = newPropertyValues;
    };
    CssState.prototype.subscribeForDynamicUpdates = function () {
        var _this = this;
        var changeMap = this._match.changeMap;
        changeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.addEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.addEventListener(":" + pseudoClass, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](+1);
                    }
                });
            }
        });
        this._appliedChangeMap = changeMap;
    };
    CssState.prototype.unsubscribeFromDynamicUpdates = function () {
        var _this = this;
        this._appliedChangeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.removeEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.removeEventListener(eventName, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](-1);
                    }
                });
            }
        });
        this._appliedChangeMap = CssState.emptyChangeMap;
    };
    CssState.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of CssState cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + "._cssState";
    };
    CssState.emptyChangeMap = Object.freeze(new Map());
    CssState.emptyPropertyBag = Object.freeze({});
    CssState.emptyAnimationArray = Object.freeze([]);
    CssState.emptyMatch = { selectors: [], changeMap: new Map() };
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateMatch", null);
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateDynamicState", null);
    return CssState;
}());
exports.CssState = CssState;
CssState.prototype._appliedChangeMap = CssState.emptyChangeMap;
CssState.prototype._appliedPropertyValues = CssState.emptyPropertyBag;
CssState.prototype._appliedAnimations = CssState.emptyAnimationArray;
CssState.prototype._matchInvalid = true;
var StyleScope = (function () {
    function StyleScope() {
        this._css = "";
        this._localCssSelectors = [];
        this._localCssSelectorVersion = 0;
        this._localCssSelectorsAppliedVersion = 0;
        this._applicationCssSelectorsAppliedVersion = 0;
        this._keyframes = new Map();
    }
    Object.defineProperty(StyleScope.prototype, "css", {
        get: function () {
            return this._css;
        },
        set: function (value) {
            this.setCss(value);
        },
        enumerable: true,
        configurable: true
    });
    StyleScope.prototype.addCss = function (cssString, cssFileName) {
        this.appendCss(cssString, cssFileName);
    };
    StyleScope.prototype.addCssFile = function (cssFileName) {
        this.appendCss(null, cssFileName);
    };
    StyleScope.prototype.changeCssFile = function (cssFileName) {
        if (!cssFileName) {
            return;
        }
        var cssSelectors = CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = cssSelectors.source;
        this._localCssSelectors = cssSelectors.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.setCss = function (cssString, cssFileName) {
        this._css = cssString;
        var cssFile = CSSSource.fromSource(cssString, this._keyframes, cssFileName);
        this._localCssSelectors = cssFile.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.appendCss = function (cssString, cssFileName) {
        if (!cssString && !cssFileName) {
            return;
        }
        var parsedCssSelectors = cssString ? CSSSource.fromSource(cssString, this._keyframes, cssFileName) : CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = this._css + parsedCssSelectors.source;
        this._localCssSelectors.push.apply(this._localCssSelectors, parsedCssSelectors.selectors);
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.getKeyframeAnimationWithName = function (animationName) {
        var cssKeyframes = this._keyframes[animationName];
        if (!cssKeyframes) {
            return;
        }
        ensureKeyframeAnimationModule();
        var animation = new keyframeAnimationModule.KeyframeAnimationInfo();
        ensureCssAnimationParserModule();
        animation.keyframes = cssAnimationParserModule
            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframes.keyframes);
        return animation;
    };
    StyleScope.prototype.ensureSelectors = function () {
        if (!this.isApplicationCssSelectorsLatestVersionApplied() ||
            !this.isLocalCssSelectorsLatestVersionApplied() ||
            !this._mergedCssSelectors) {
            this._createSelectors();
        }
        return this._getSelectorsVersion();
    };
    StyleScope.prototype.isApplicationCssSelectorsLatestVersionApplied = function () {
        return this._applicationCssSelectorsAppliedVersion === applicationCssSelectorVersion;
    };
    StyleScope.prototype.isLocalCssSelectorsLatestVersionApplied = function () {
        return this._localCssSelectorsAppliedVersion === this._localCssSelectorVersion;
    };
    StyleScope.prototype._createSelectors = function () {
        var toMerge = [];
        toMerge.push(applicationCssSelectors);
        this._applicationCssSelectorsAppliedVersion = applicationCssSelectorVersion;
        toMerge.push(this._localCssSelectors);
        this._localCssSelectorsAppliedVersion = this._localCssSelectorVersion;
        for (var keyframe in applicationKeyframes) {
            this._keyframes[keyframe] = applicationKeyframes[keyframe];
        }
        if (toMerge.length > 0) {
            this._mergedCssSelectors = toMerge.filter(function (m) { return !!m; }).reduce(function (merged, next) { return merged.concat(next); }, []);
            this._applyKeyframesOnSelectors();
            this._selectors = new css_selector_1.SelectorsMap(this._mergedCssSelectors);
        }
    };
    StyleScope.prototype.matchSelectors = function (view) {
        this.ensureSelectors();
        return this._selectors.query(view);
    };
    StyleScope.prototype.query = function (node) {
        this.ensureSelectors();
        return this._selectors.query(node).selectors;
    };
    StyleScope.prototype._getSelectorsVersion = function () {
        return 100000 * this._applicationCssSelectorsAppliedVersion + this._localCssSelectorsAppliedVersion;
    };
    StyleScope.prototype._applyKeyframesOnSelectors = function () {
        for (var i = this._mergedCssSelectors.length - 1; i >= 0; i--) {
            var ruleset = this._mergedCssSelectors[i];
            var animations = ruleset[animationsSymbol];
            if (animations !== undefined && animations.length) {
                ensureCssAnimationParserModule();
                for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {
                    var animation = animations_1[_i];
                    var cssKeyframe = this._keyframes[animation.name];
                    if (cssKeyframe !== undefined) {
                        animation.keyframes = cssAnimationParserModule
                            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframe.keyframes);
                    }
                }
            }
        }
    };
    StyleScope.prototype.getAnimations = function (ruleset) {
        return ruleset[animationsSymbol];
    };
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "setCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "appendCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "_createSelectors", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "matchSelectors", null);
    return StyleScope;
}());
exports.StyleScope = StyleScope;
function resolveFileNameFromUrl(url, appDirectory, fileExists, importSource) {
    var fileName = typeof url === "string" ? url.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = fileName.replace("~/", "");
    }
    var isAbsolutePath = fileName.indexOf("/") === 0;
    var absolutePath = isAbsolutePath ? fileName : file_system_1.path.join(appDirectory, fileName);
    if (fileExists(absolutePath)) {
        return absolutePath;
    }
    if (!isAbsolutePath) {
        if (fileName[0] === "~" && fileName[1] !== "/" && fileName[1] !== "\"") {
            fileName = fileName.substr(1);
        }
        if (importSource) {
            var importFile = resolveFilePathFromImport(importSource, fileName);
            if (fileExists(importFile)) {
                return importFile;
            }
        }
        var external_1 = file_system_1.path.join(appDirectory, "tns_modules", fileName);
        if (fileExists(external_1)) {
            return external_1;
        }
    }
    return null;
}
exports.resolveFileNameFromUrl = resolveFileNameFromUrl;
function resolveFilePathFromImport(importSource, fileName) {
    var importSourceParts = importSource.split(file_system_1.path.separator);
    var fileNameParts = fileName.split(file_system_1.path.separator)
        .filter(function (p) { return !isCurrentDirectory(p); });
    importSourceParts.pop();
    fileNameParts.forEach(function (p) { return isParentDirectory(p) ? importSourceParts.pop() : importSourceParts.push(p); });
    return importSourceParts.join(file_system_1.path.separator);
}
exports.applyInlineStyle = profiling_1.profile(function applyInlineStyle(view, styleStr) {
    var localStyle = "local { " + styleStr + " }";
    var inlineRuleSet = CSSSource.fromSource(localStyle, new Map()).selectors;
    view.style.resetUnscopedCssVariables();
    inlineRuleSet[0].declarations.forEach(function (d) {
        var property = d.property;
        if (properties_1.isCssVariable(property)) {
            view.style.setUnscopedCssVariable(property, d.value);
        }
    });
    inlineRuleSet[0].declarations.forEach(function (d) {
        var property = d.property;
        try {
            if (properties_1.isCssVariable(property)) {
                return;
            }
            var value = evaluateCssExpressions(view, property, d.value);
            if (property in view.style) {
                view.style[property] = value;
            }
            else {
                view[property] = value;
            }
        }
        catch (e) {
            trace_1.write("Failed to apply property [" + d.property + "] with value [" + d.value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
    });
    view._onCssStateChange();
});
function isCurrentDirectory(uriPart) {
    return uriPart === ".";
}
function isParentDirectory(uriPart) {
    return uriPart === "..";
}
function isKeyframe(node) {
    return node.type === "keyframes";
}
//# sourceMappingURL=style-scope.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style/style.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var Style = (function (_super) {
    __extends(Style, _super);
    function Style(ownerView) {
        var _this = _super.call(this) || this;
        _this.unscopedCssVariables = new Map();
        _this.scopedCssVariables = new Map();
        if (ownerView.constructor.toString().indexOf("[native code]") !== -1) {
            _this.viewRef = ownerView;
        }
        else {
            _this.viewRef = new WeakRef(ownerView);
        }
        return _this;
    }
    Style.prototype.setScopedCssVariable = function (varName, value) {
        this.scopedCssVariables.set(varName, value);
    };
    Style.prototype.setUnscopedCssVariable = function (varName, value) {
        this.unscopedCssVariables.set(varName, value);
    };
    Style.prototype.getCssVariable = function (varName) {
        var view = this.view;
        if (!view) {
            return null;
        }
        if (this.unscopedCssVariables.has(varName)) {
            return this.unscopedCssVariables.get(varName);
        }
        if (this.scopedCssVariables.has(varName)) {
            return this.scopedCssVariables.get(varName);
        }
        if (!view.parent || !view.parent.style) {
            return null;
        }
        return view.parent.style.getCssVariable(varName);
    };
    Style.prototype.resetScopedCssVariables = function () {
        this.scopedCssVariables.clear();
    };
    Style.prototype.resetUnscopedCssVariables = function () {
        this.unscopedCssVariables.clear();
    };
    Style.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of Style cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + ".style";
    };
    Object.defineProperty(Style.prototype, "view", {
        get: function () {
            if (this.viewRef) {
                return this.viewRef.get();
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    return Style;
}(observable_1.Observable));
exports.Style = Style;
Style.prototype.PropertyBag = (function () {
    function class_1() {
    }
    return class_1;
}());
//# sourceMappingURL=style.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SwitchBase = (function (_super) {
    __extends(SwitchBase, _super);
    function SwitchBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SwitchBase.prototype._onCheckedPropertyChanged = function (newValue) {
    };
    SwitchBase.checkedChangeEvent = "checkedChange";
    SwitchBase = __decorate([
        view_1.CSSType("Switch")
    ], SwitchBase);
    return SwitchBase;
}(view_1.View));
exports.SwitchBase = SwitchBase;
SwitchBase.prototype.recycleNativeView = "auto";
function onCheckedPropertyChanged(switchBase, oldValue, newValue) {
    switchBase._onCheckedPropertyChanged(newValue);
}
exports.checkedProperty = new view_1.Property({ name: "checked", defaultValue: false, valueConverter: view_1.booleanConverter, valueChanged: onCheckedPropertyChanged });
exports.checkedProperty.register(SwitchBase);
exports.offBackgroundColorProperty = new view_1.Property({ name: "offBackgroundColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.offBackgroundColorProperty.register(SwitchBase);
//# sourceMappingURL=switch-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var switch_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js"));
var CheckedChangeListener;
function initializeCheckedChangeListener() {
    if (CheckedChangeListener) {
        return;
    }
    var CheckedChangeListenerImpl = (function (_super) {
        __extends(CheckedChangeListenerImpl, _super);
        function CheckedChangeListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        CheckedChangeListenerImpl.prototype.onCheckedChanged = function (buttonView, isChecked) {
            var owner = this.owner;
            switch_common_1.checkedProperty.nativeValueChange(owner, isChecked);
        };
        CheckedChangeListenerImpl = __decorate([
            Interfaces([android.widget.CompoundButton.OnCheckedChangeListener])
        ], CheckedChangeListenerImpl);
        return CheckedChangeListenerImpl;
    }(java.lang.Object));
    CheckedChangeListener = CheckedChangeListenerImpl;
}
var Switch = (function (_super) {
    __extends(Switch, _super);
    function Switch() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Switch.prototype.createNativeView = function () {
        return new android.widget.Switch(this._context);
    };
    Switch.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeCheckedChangeListener();
        var listener = new CheckedChangeListener(this);
        nativeView.setOnCheckedChangeListener(listener);
        nativeView.listener = listener;
    };
    Switch.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        nativeView.listener.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Switch.prototype.setNativeBackgroundColor = function (value) {
        if (value instanceof switch_common_1.Color) {
            this.nativeViewProtected.getTrackDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getTrackDrawable().clearColorFilter();
        }
    };
    Switch.prototype._onCheckedPropertyChanged = function (newValue) {
        if (this.offBackgroundColor) {
            if (!newValue) {
                this.setNativeBackgroundColor(this.offBackgroundColor);
            }
            else {
                this.setNativeBackgroundColor(this.backgroundColor);
            }
        }
    };
    Switch.prototype[switch_common_1.checkedProperty.getDefault] = function () {
        return false;
    };
    Switch.prototype[switch_common_1.checkedProperty.setNative] = function (value) {
        this.nativeViewProtected.setChecked(value);
    };
    Switch.prototype[switch_common_1.colorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof switch_common_1.Color) {
            this.nativeViewProtected.getThumbDrawable().setColorFilter(value.android, android.graphics.PorterDuff.Mode.SRC_IN);
        }
        else {
            this.nativeViewProtected.getThumbDrawable().clearColorFilter();
        }
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.setNative] = function (value) {
        if (!this.offBackgroundColor || this.checked) {
            this.setNativeBackgroundColor(value);
        }
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.getDefault] = function () {
        return -1;
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.setNative] = function (value) {
        if (!this.checked) {
            this.setNativeBackgroundColor(value);
        }
    };
    return Switch;
}(switch_common_1.SwitchBase));
exports.Switch = Switch;
//# sourceMappingURL=switch.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
exports.traceCategory = "TabView";
var TabContentItemBase = (function (_super) {
    __extends(TabContentItemBase, _super);
    function TabContentItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabContentItemBase.prototype.eachChild = function (callback) {
        if (this.content) {
            callback(this.content);
        }
    };
    TabContentItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabContentItemBase = __decorate([
        view_1.CSSType("TabContentItem")
    ], TabContentItemBase);
    return TabContentItemBase;
}(content_view_1.ContentView));
exports.TabContentItemBase = TabContentItemBase;
//# sourceMappingURL=tab-content-item-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var grid_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js");
var tab_content_item_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js"));
var TabContentItem = (function (_super) {
    __extends(TabContentItem, _super);
    function TabContentItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TabContentItem.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabContentItem.prototype.createNativeView = function () {
        var layout = new org.nativescript.widgets.GridLayout(this._context);
        layout.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
        return layout;
    };
    TabContentItem.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
    };
    TabContentItem.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (this.nativeViewProtected && child.nativeViewProtected) {
            grid_layout_1.GridLayout.setRow(child, 0);
        }
        return _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
    };
    TabContentItem.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        this.canBeLoaded = false;
    };
    TabContentItem.prototype._getChildFragmentManager = function () {
        var tabView = this.parent;
        var tabFragment = null;
        var fragmentManager = tabView._getFragmentManager();
        if (typeof this.index === "undefined") {
            view_1.traceWrite("Current TabContentItem index is not set", tab_content_item_common_1.traceCategory, view_1.traceMessageType.error);
        }
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            if (fragment.index === this.index) {
                tabFragment = fragment;
                break;
            }
        }
        if (!tabFragment) {
            return tabView._getRootFragmentManager();
        }
        return tabFragment.getChildFragmentManager();
    };
    return TabContentItem;
}(tab_content_item_common_1.TabContentItemBase));
exports.TabContentItem = TabContentItem;
//# sourceMappingURL=tab-content-item.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabNavigationBase = (function (_super) {
    __extends(TabNavigationBase, _super);
    function TabNavigationBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabNavigationBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabNavigationBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabContentItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
        else if (name === "TabStrip") {
            this.tabStrip = value;
        }
    };
    Object.defineProperty(TabNavigationBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].content : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabNavigationBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabNavigationBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
        var tabStrip = this.tabStrip;
        if (tabStrip) {
            callback(tabStrip);
        }
    };
    TabNavigationBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.content);
            });
        }
    };
    TabNavigationBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.content) {
                    throw new Error("TabContentItem must have a content (view).");
                }
                _this._addView(item);
            });
        }
    };
    TabNavigationBase.prototype.onTabStripChanged = function (oldTabStrip, newTabStrip) {
        if (oldTabStrip && oldTabStrip.parent) {
            this._removeView(oldTabStrip);
        }
        if (newTabStrip) {
            this._addView(newTabStrip);
        }
    };
    TabNavigationBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabNavigationBase.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    TabNavigationBase.prototype.getTabBarBackgroundColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarBackgroundColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarFontInternal = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarFontInternal = function (value) {
    };
    TabNavigationBase.prototype.getTabBarTextTransform = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarTextTransform = function (value) {
    };
    TabNavigationBase.prototype.getTabBarHighlightColor = function () {
    };
    TabNavigationBase.prototype.setTabBarHighlightColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarColor = function (value) {
    };
    TabNavigationBase.prototype.setTabBarItemTitle = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemBackgroundColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.setTabBarIconColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontSize = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontSize = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontInternal = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemTextTransform = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
    };
    TabNavigationBase.selectedIndexChangedEvent = "selectedIndexChanged";
    return TabNavigationBase;
}(view_1.View));
exports.TabNavigationBase = TabNavigationBase;
var MIN_ICON_SIZE = 24;
var MAX_ICON_WIDTH = 31;
var MAX_ICON_HEIGHT = 28;
function getIconSpecSize(size) {
    var inWidth = size.width;
    var inHeight = size.height;
    var outWidth = 0;
    var outHeight = 0;
    if (inWidth < inHeight) {
        outWidth = MIN_ICON_SIZE;
        outHeight = (inHeight * MIN_ICON_SIZE) / inWidth;
        if (outHeight > MAX_ICON_HEIGHT) {
            outHeight = MAX_ICON_HEIGHT;
            outWidth = (inWidth * MAX_ICON_HEIGHT) / inHeight;
        }
    }
    else {
        outHeight = MIN_ICON_SIZE;
        outWidth = (inWidth * MIN_ICON_SIZE) / inHeight;
        if (outWidth > MAX_ICON_WIDTH) {
            outWidth = MAX_ICON_WIDTH;
            outHeight = (inHeight * MAX_ICON_WIDTH) / inWidth;
        }
    }
    return { width: outWidth, height: outHeight };
}
exports.getIconSpecSize = getIconSpecSize;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabNavigationBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabNavigationBase);
exports.tabStripProperty = new view_1.Property({
    name: "tabStrip", valueChanged: function (target, oldValue, newValue) {
        target.onTabStripChanged(oldValue, newValue);
    }
});
exports.tabStripProperty.register(TabNavigationBase);
//# sourceMappingURL=tab-navigation-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_1 = __webpack_require__("../node_modules/tns-core-modules/ui/image/image.js");
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var tabs_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabStripItem = (function (_super) {
    __extends(TabStripItem, _super);
    function TabStripItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStripItem_1 = TabStripItem;
    Object.defineProperty(TabStripItem.prototype, "title", {
        get: function () {
            if (this.isLoaded) {
                return this.label.text;
            }
            return this._title;
        },
        set: function (value) {
            this._title = value;
            if (this.isLoaded) {
                this.label.text = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabStripItem.prototype, "iconSource", {
        get: function () {
            if (this.isLoaded) {
                return this.image.src;
            }
            return this._iconSource;
        },
        set: function (value) {
            this._iconSource = value;
            if (this.isLoaded) {
                this.image.src = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    TabStripItem.prototype.onLoaded = function () {
        var _this = this;
        if (!this.image) {
            var image = new image_1.Image();
            image.src = this.iconSource;
            this.image = image;
            this._addView(this.image);
        }
        if (!this.label) {
            var label = new label_1.Label();
            label.text = this.title;
            this.label = label;
            this._addView(this.label);
        }
        _super.prototype.onLoaded.call(this);
        this._labelColorHandler = this._labelColorHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemColor(_this, args.value);
        });
        this.label.style.on("colorChange", this._labelColorHandler);
        this._labelFontHandler = this._labelFontHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemFontInternal(_this, args.value);
        });
        this.label.style.on("fontInternalChange", this._labelFontHandler);
        this._labelTextTransformHandler = this._labelTextTransformHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemTextTransform(_this, args.value);
        });
        this.label.style.on("textTransformChange", this._labelTextTransformHandler);
        this._labelTextHandler = this._labelTextHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarItemTitle(_this, args.value);
        });
        this.label.on("textChange", this._labelTextHandler);
        this._imageColorHandler = this._imageColorHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.style.on("colorChange", this._imageColorHandler);
        this._imageFontHandler = this._imageFontHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.style.on("fontInternalChange", this._imageFontHandler);
        this._imageSrcHandler = this._imageSrcHandler || (function (args) {
            var parent = _this.parent;
            var tabStripParent = parent && parent.parent;
            return tabStripParent && tabStripParent.setTabBarIconColor(_this, args.value);
        });
        this.image.on("srcChange", this._imageSrcHandler);
    };
    TabStripItem.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.label.style.off("colorChange", this._labelColorHandler);
        this.label.style.off("fontInternalChange", this._labelFontHandler);
        this.label.style.off("textTransformChange", this._labelTextTransformHandler);
        this.label.style.off("textChange", this._labelTextHandler);
        this.image.style.off("colorChange", this._imageColorHandler);
        this.image.style.off("fontInternalChange", this._imageFontHandler);
        this.image.style.off("srcChange", this._imageSrcHandler);
    };
    TabStripItem.prototype.eachChild = function (callback) {
        if (this.label) {
            callback(this.label);
        }
        if (this.image) {
            callback(this.image);
        }
    };
    TabStripItem.prototype._addChildFromBuilder = function (name, value) {
        if (name === "Image") {
            this.image = value;
            this.iconSource = value.src;
            this._addView(value);
        }
        if (name === "Label") {
            this.label = value;
            this.title = value.text;
            this._addView(value);
        }
    };
    TabStripItem.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    TabStripItem.prototype._updateTabStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            this._highlightedHandler = this._highlightedHandler || (function () {
                _this._goToVisualState("highlighted");
            });
            this._normalHandler = this._normalHandler || (function () {
                _this._goToVisualState("normal");
            });
            this.on(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.on(TabStripItem_1.unselectEvent, this._normalHandler);
            var parent_1 = this.parent;
            var tabStripParent = parent_1 && parent_1.parent;
            if (this.index === tabStripParent.selectedIndex &&
                !(platform_1.isIOS && tabStripParent instanceof tabs_1.Tabs)) {
                this._goToVisualState("highlighted");
            }
        }
        else {
            this.off(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.off(TabStripItem_1.unselectEvent, this._normalHandler);
        }
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarBackgroundColor();
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemBackgroundColor(this, value);
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    var TabStripItem_1;
    TabStripItem.tapEvent = "tap";
    TabStripItem.selectEvent = "select";
    TabStripItem.unselectEvent = "unselect";
    __decorate([
        view_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], TabStripItem.prototype, "_updateTabStateChangeHandler", null);
    TabStripItem = TabStripItem_1 = __decorate([
        view_1.CSSType("TabStripItem")
    ], TabStripItem);
    return TabStripItem;
}(view_1.View));
exports.TabStripItem = TabStripItem;
//# sourceMappingURL=tab-strip-item.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
exports.traceCategory = "TabView";
exports.highlightColorProperty = new view_1.Property({ name: "highlightColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
var TabStrip = (function (_super) {
    __extends(TabStrip, _super);
    function TabStrip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStrip.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabStrip.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabStrip.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabStripItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
    };
    TabStrip.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                _this._addView(item);
            });
        }
    };
    TabStrip.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarBackgroundColor();
    };
    TabStrip.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarBackgroundColor(value);
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    TabStrip.prototype[view_1.colorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarColor();
    };
    TabStrip.prototype[view_1.colorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarColor(value);
    };
    TabStrip.prototype[view_1.fontInternalProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarFontInternal();
    };
    TabStrip.prototype[view_1.fontInternalProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarFontInternal(value);
    };
    TabStrip.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarTextTransform();
    };
    TabStrip.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarTextTransform(value);
    };
    TabStrip.prototype[exports.highlightColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarHighlightColor();
    };
    TabStrip.prototype[exports.highlightColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarHighlightColor(value);
    };
    TabStrip.itemTapEvent = "itemTap";
    TabStrip = __decorate([
        view_1.CSSType("TabStrip")
    ], TabStrip);
    return TabStrip;
}(view_1.View));
exports.TabStrip = TabStrip;
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabStrip);
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabStrip);
exports.isIconSizeFixedProperty = new view_1.Property({
    name: "isIconSizeFixed", defaultValue: true, valueConverter: view_1.booleanConverter
});
exports.isIconSizeFixedProperty.register(TabStrip);
exports.highlightColorProperty.register(TabStrip);
//# sourceMappingURL=tab-strip.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabViewItemBase = (function (_super) {
    __extends(TabViewItemBase, _super);
    function TabViewItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(TabViewItemBase.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.view = value;
        }
    };
    Object.defineProperty(TabViewItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            if (this._title !== value) {
                this._title = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "view", {
        get: function () {
            return this._view;
        },
        set: function (value) {
            if (this._view !== value) {
                if (this._view) {
                    throw new Error("Changing the view of an already loaded TabViewItem is not currently supported.");
                }
                this._view = value;
                this._addView(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "iconSource", {
        get: function () {
            return this._iconSource;
        },
        set: function (value) {
            if (this._iconSource !== value) {
                this._iconSource = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype.eachChild = function (callback) {
        var view = this._view;
        if (view) {
            callback(view);
        }
    };
    TabViewItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabViewItemBase = __decorate([
        view_1.CSSType("TabViewItem")
    ], TabViewItemBase);
    return TabViewItemBase;
}(view_1.ViewBase));
exports.TabViewItemBase = TabViewItemBase;
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabViewBase = (function (_super) {
    __extends(TabViewBase, _super);
    function TabViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabViewBase_1 = TabViewBase;
    Object.defineProperty(TabViewBase.prototype, "androidSelectedTabHighlightColor", {
        get: function () {
            return this.style.androidSelectedTabHighlightColor;
        },
        set: function (value) {
            this.style.androidSelectedTabHighlightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextFontSize", {
        get: function () {
            return this.style.tabTextFontSize;
        },
        set: function (value) {
            this.style.tabTextFontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextColor", {
        get: function () {
            return this.style.tabTextColor;
        },
        set: function (value) {
            this.style.tabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabBackgroundColor", {
        get: function () {
            return this.style.tabBackgroundColor;
        },
        set: function (value) {
            this.style.tabBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "selectedTabTextColor", {
        get: function () {
            return this.style.selectedTabTextColor;
        },
        set: function (value) {
            this.style.selectedTabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabViewBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabViewItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
            exports.selectedIndexProperty.coerce(this);
        }
    };
    Object.defineProperty(TabViewBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].view : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabViewBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.view);
            });
        }
    };
    TabViewBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.view) {
                    throw new Error("TabViewItem must have a view.");
                }
                _this._addView(item);
            });
        }
    };
    TabViewBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabViewBase_1.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    var TabViewBase_1;
    TabViewBase.selectedIndexChangedEvent = "selectedIndexChanged";
    TabViewBase = TabViewBase_1 = __decorate([
        view_1.CSSType("TabView")
    ], TabViewBase);
    return TabViewBase;
}(view_1.View));
exports.TabViewBase = TabViewBase;
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load tab bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabViewBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabViewBase);
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabViewBase);
exports.androidOffscreenTabLimitProperty = new view_1.Property({
    name: "androidOffscreenTabLimit", defaultValue: 1, affectsLayout: view_1.isIOS,
    valueConverter: function (v) { return parseInt(v); }
});
exports.androidOffscreenTabLimitProperty.register(TabViewBase);
exports.androidTabsPositionProperty = new view_1.Property({ name: "androidTabsPosition", defaultValue: "top" });
exports.androidTabsPositionProperty.register(TabViewBase);
exports.androidSwipeEnabledProperty = new view_1.Property({ name: "androidSwipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.androidSwipeEnabledProperty.register(TabViewBase);
exports.tabTextFontSizeProperty = new view_1.CssProperty({ name: "tabTextFontSize", cssName: "tab-text-font-size", valueConverter: function (v) { return parseFloat(v); } });
exports.tabTextFontSizeProperty.register(view_1.Style);
exports.tabTextColorProperty = new view_1.CssProperty({ name: "tabTextColor", cssName: "tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabTextColorProperty.register(view_1.Style);
exports.tabBackgroundColorProperty = new view_1.CssProperty({ name: "tabBackgroundColor", cssName: "tab-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabBackgroundColorProperty.register(view_1.Style);
exports.selectedTabTextColorProperty = new view_1.CssProperty({ name: "selectedTabTextColor", cssName: "selected-tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedTabTextColorProperty.register(view_1.Style);
exports.androidSelectedTabHighlightColorProperty = new view_1.CssProperty({ name: "androidSelectedTabHighlightColor", cssName: "android-selected-tab-highlight-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.androidSelectedTabHighlightColorProperty.register(view_1.Style);
//# sourceMappingURL=tab-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var tab_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js"));
var ACCENT_COLOR = "colorAccent";
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 4;
var TABID = "_tabId";
var INDEX = "_index";
var PagerAdapter;
function makeFragmentName(viewId, id) {
    return "android:viewpager:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (PagerAdapter) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find TabView");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.view.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var POSITION_UNCHANGED = -1;
    var POSITION_NONE = -2;
    var FragmentPagerAdapter = (function (_super) {
        __extends(FragmentPagerAdapter, _super);
        function FragmentPagerAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FragmentPagerAdapter.prototype.getCount = function () {
            var items = this.items;
            return items ? items.length : 0;
        };
        FragmentPagerAdapter.prototype.getPageTitle = function (index) {
            var items = this.items;
            if (index < 0 || index >= items.length) {
                return "";
            }
            return items[index].title;
        };
        FragmentPagerAdapter.prototype.startUpdate = function (container) {
            if (container.getId() === android.view.View.NO_ID) {
                throw new Error("ViewPager with adapter " + this + " requires a view containerId");
            }
        };
        FragmentPagerAdapter.prototype.instantiateItem = function (container, position) {
            var fragmentManager = this.owner._getFragmentManager();
            if (!this.mCurTransaction) {
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var itemId = this.getItemId(position);
            var name = makeFragmentName(container.getId(), itemId);
            var fragment = fragmentManager.findFragmentByTag(name);
            if (fragment != null) {
                this.mCurTransaction.attach(fragment);
            }
            else {
                fragment = TabFragmentImplementation.newInstance(this.owner._domId, position);
                this.mCurTransaction.add(container.getId(), fragment, name);
            }
            if (fragment !== this.mCurrentPrimaryItem) {
                fragment.setMenuVisibility(false);
                fragment.setUserVisibleHint(false);
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
            }
            return fragment;
        };
        FragmentPagerAdapter.prototype.getItemPosition = function (object) {
            return this.items ? POSITION_UNCHANGED : POSITION_NONE;
        };
        FragmentPagerAdapter.prototype.destroyItem = function (container, position, object) {
            if (!this.mCurTransaction) {
                var fragmentManager = this.owner._getFragmentManager();
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var fragment = object;
            this.mCurTransaction.detach(fragment);
            if (this.mCurrentPrimaryItem === fragment) {
                this.mCurrentPrimaryItem = null;
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = false;
            }
        };
        FragmentPagerAdapter.prototype.setPrimaryItem = function (container, position, object) {
            var fragment = object;
            if (fragment !== this.mCurrentPrimaryItem) {
                if (this.mCurrentPrimaryItem != null) {
                    this.mCurrentPrimaryItem.setMenuVisibility(false);
                    this.mCurrentPrimaryItem.setUserVisibleHint(false);
                }
                if (fragment != null) {
                    fragment.setMenuVisibility(true);
                    fragment.setUserVisibleHint(true);
                }
                this.mCurrentPrimaryItem = fragment;
                this.owner.selectedIndex = position;
                var tab = this.owner;
                var tabItems = tab.items;
                var newTabItem = tabItems ? tabItems[position] : null;
                if (newTabItem) {
                    tab._loadUnloadTabItems(tab.selectedIndex);
                }
            }
        };
        FragmentPagerAdapter.prototype.finishUpdate = function (container) {
            this._commitCurrentTransaction();
        };
        FragmentPagerAdapter.prototype.isViewFromObject = function (view, object) {
            return object.getView() === view;
        };
        FragmentPagerAdapter.prototype.saveState = function () {
            this._commitCurrentTransaction();
            return null;
        };
        FragmentPagerAdapter.prototype.restoreState = function (state, loader) {
        };
        FragmentPagerAdapter.prototype.getItemId = function (position) {
            return position;
        };
        FragmentPagerAdapter.prototype._commitCurrentTransaction = function () {
            if (this.mCurTransaction != null) {
                this.mCurTransaction.commitNowAllowingStateLoss();
                this.mCurTransaction = null;
            }
        };
        return FragmentPagerAdapter;
    }(androidx.viewpager.widget.PagerAdapter));
    PagerAdapter = FragmentPagerAdapter;
}
function createTabItemSpec(item) {
    var result = new org.nativescript.widgets.TabItemSpec();
    result.title = item.title;
    if (item.iconSource) {
        if (item.iconSource.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
            result.iconId = utils_1.ad.resources.getDrawableId(item.iconSource.substr(utils_1.RESOURCE_PREFIX.length));
            if (result.iconId === 0) {
                tab_view_common_1.traceMissingIcon(item.iconSource);
            }
        }
        else {
            var is = image_source_1.fromFileOrResource(item.iconSource);
            if (is) {
                result.iconDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), is.android);
            }
            else {
                tab_view_common_1.traceMissingIcon(item.iconSource);
            }
        }
    }
    return result;
}
var defaultAccentColor = undefined;
function getDefaultAccentColor(context) {
    if (defaultAccentColor === undefined) {
        defaultAccentColor = utils_1.ad.resources.getPaletteColor(ACCENT_COLOR, context) || 0xFF33B5E5;
    }
    return defaultAccentColor;
}
var TabViewItem = (function (_super) {
    __extends(TabViewItem, _super);
    function TabViewItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TabViewItem.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabViewItem.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this.nativeViewProtected) {
            this._defaultTransformationMethod = this.nativeViewProtected.getTransformationMethod();
        }
    };
    TabViewItem.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
    };
    TabViewItem.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        if (this.nativeViewProtected) {
            this.nativeViewProtected.setTransformationMethod(this._defaultTransformationMethod);
        }
    };
    TabViewItem.prototype.disposeNativeView = function () {
        _super.prototype.disposeNativeView.call(this);
        this.canBeLoaded = false;
    };
    TabViewItem.prototype.createNativeView = function () {
        return this.nativeViewProtected;
    };
    TabViewItem.prototype._update = function () {
        var tv = this.nativeViewProtected;
        var tabView = this.parent;
        if (tv && tabView) {
            this.tabItemSpec = createTabItemSpec(this);
            tabView.updateAndroidItemAt(this.index, this.tabItemSpec);
        }
    };
    TabViewItem.prototype._getChildFragmentManager = function () {
        var tabView = this.parent;
        var tabFragment = null;
        var fragmentManager = tabView._getFragmentManager();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            if (fragment.index === this.index) {
                tabFragment = fragment;
                break;
            }
        }
        if (!tabFragment) {
            if (tab_view_common_1.traceEnabled()) {
                tab_view_common_1.traceWrite("Could not get child fragment manager for tab item with index " + this.index, tab_view_common_1.traceCategory);
            }
            return tabView._getRootFragmentManager();
        }
        return tabFragment.getChildFragmentManager();
    };
    TabViewItem.prototype[tab_view_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeViewProtected.getTextSize() };
    };
    TabViewItem.prototype[tab_view_common_1.fontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this.nativeViewProtected.setTextSize(value);
        }
        else {
            this.nativeViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
        }
    };
    TabViewItem.prototype[tab_view_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.getTypeface();
    };
    TabViewItem.prototype[tab_view_common_1.fontInternalProperty.setNative] = function (value) {
        this.nativeViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
    };
    TabViewItem.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        return "default";
    };
    TabViewItem.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var tv = this.nativeViewProtected;
        if (value === "default") {
            tv.setTransformationMethod(this._defaultTransformationMethod);
            tv.setText(this.title);
        }
        else {
            var result = text_base_1.getTransformedText(this.title, value);
            tv.setText(result);
            tv.setTransformationMethod(null);
        }
    };
    return TabViewItem;
}(tab_view_common_1.TabViewItemBase));
exports.TabViewItem = TabViewItem;
function setElevation(grid, tabLayout) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * tab_view_common_1.layout.getDisplayDensity();
        compat.setElevation(grid, val);
        compat.setElevation(tabLayout, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var TabView = (function (_super) {
    __extends(TabView, _super);
    function TabView() {
        var _this = _super.call(this) || this;
        _this._androidViewId = -1;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(TabView.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    TabView.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    TabView.prototype.createNativeView = function () {
        initializeNativeClasses();
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView._createUI(" + this + ");", tab_view_common_1.traceCategory);
        }
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        var viewPager = new org.nativescript.widgets.TabViewPager(context);
        var tabLayout = new org.nativescript.widgets.TabLayout(context);
        var lp = new org.nativescript.widgets.CommonLayoutParams();
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        var accentColor = getDefaultAccentColor(context);
        lp.row = 1;
        if (this.androidTabsPosition === "top") {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            viewPager.setLayoutParams(lp);
            if (!this.androidSwipeEnabled) {
                viewPager.setSwipePageEnabled(false);
            }
        }
        else {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            tabLayout.setLayoutParams(lp);
            viewPager.setSwipePageEnabled(false);
            accentColor = 0x00FFFFFF;
        }
        nativeView.addView(viewPager);
        nativeView.viewPager = viewPager;
        var adapter = new PagerAdapter(this);
        viewPager.setAdapter(adapter);
        viewPager.adapter = adapter;
        nativeView.addView(tabLayout);
        nativeView.tabLayout = tabLayout;
        setElevation(nativeView, tabLayout);
        if (accentColor) {
            tabLayout.setSelectedIndicatorColors([accentColor]);
        }
        if (primaryColor) {
            tabLayout.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    TabView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        this._tabLayout = nativeView.tabLayout;
        var viewPager = nativeView.viewPager;
        viewPager.setId(this._androidViewId);
        this._viewPager = viewPager;
        this._pagerAdapter = viewPager.adapter;
        this._pagerAdapter.owner = this;
    };
    TabView.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = this.androidTabsPosition === "top" ? this.androidOffscreenTabLimit : 1;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.view);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.view);
            }
        });
    };
    TabView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.setAdapterItems(this.items);
    };
    TabView.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.setAdapterItems(null);
    };
    TabView.prototype.disposeNativeView = function () {
        this._tabLayout.setItems(null, null);
        this._pagerAdapter.owner = null;
        this._pagerAdapter = null;
        this._tabLayout = null;
        this._viewPager = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TabView.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragments();
    };
    TabView.prototype.disposeCurrentFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    TabView.prototype.shouldUpdateAdapter = function (items) {
        if (!this._pagerAdapter) {
            return false;
        }
        var currentPagerAdapterItems = this._pagerAdapter.items;
        if (!items && !currentPagerAdapterItems) {
            return false;
        }
        if (!items || !currentPagerAdapterItems) {
            return true;
        }
        if (items.length !== currentPagerAdapterItems.length) {
            return true;
        }
        var matchingItems = currentPagerAdapterItems.filter(function (currentItem) {
            return !!items.filter(function (item) {
                return item._domId === currentItem._domId;
            })[0];
        });
        if (matchingItems.length !== items.length) {
            return true;
        }
        return false;
    };
    TabView.prototype.setAdapterItems = function (items) {
        if (this.shouldUpdateAdapter(items)) {
            this._pagerAdapter.items = items;
            var length_1 = items ? items.length : 0;
            if (length_1 === 0) {
                this._tabLayout.setItems(null, null);
                this._pagerAdapter.notifyDataSetChanged();
                return;
            }
            var tabItems_1 = new Array();
            items.forEach(function (item, i, arr) {
                var tabItemSpec = createTabItemSpec(item);
                item.index = i;
                item.tabItemSpec = tabItemSpec;
                tabItems_1.push(tabItemSpec);
            });
            var tabLayout_1 = this._tabLayout;
            tabLayout_1.setItems(tabItems_1, this._viewPager);
            items.forEach(function (item, i, arr) {
                var tv = tabLayout_1.getTextViewForItemAt(i);
                item.setNativeView(tv);
            });
            this._pagerAdapter.notifyDataSetChanged();
        }
    };
    TabView.prototype.updateAndroidItemAt = function (index, spec) {
        this._tabLayout.updateItemAt(index, spec);
    };
    TabView.prototype[tab_view_common_1.androidOffscreenTabLimitProperty.getDefault] = function () {
        return this._viewPager.getOffscreenPageLimit();
    };
    TabView.prototype[tab_view_common_1.androidOffscreenTabLimitProperty.setNative] = function (value) {
        this._viewPager.setOffscreenPageLimit(value);
    };
    TabView.prototype[tab_view_common_1.selectedIndexProperty.setNative] = function (value) {
        var smoothScroll = this.androidTabsPosition === "top";
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView this._viewPager.setCurrentItem(" + value + ", " + smoothScroll + ");", tab_view_common_1.traceCategory);
        }
        this._viewPager.setCurrentItem(value, smoothScroll);
    };
    TabView.prototype[tab_view_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.itemsProperty.setNative] = function (value) {
        this.setAdapterItems(value);
        tab_view_common_1.selectedIndexProperty.coerce(this);
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.getDefault] = function () {
        return this._tabLayout.getBackground();
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.setNative] = function (value) {
        if (value instanceof tab_view_common_1.Color) {
            this._tabLayout.setBackgroundColor(value.android);
        }
        else {
            this._tabLayout.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.getDefault] = function () {
        return this._tabLayout.getTabTextFontSize();
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.setNative] = function (value) {
        if (typeof value === "number") {
            this._tabLayout.setTabTextFontSize(value);
        }
        else {
            this._tabLayout.setTabTextFontSize(value.nativeSize);
        }
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.getDefault] = function () {
        return this._tabLayout.getTabTextColor();
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.setNative] = function (value) {
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        this._tabLayout.setTabTextColor(color);
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.getDefault] = function () {
        return this._tabLayout.getSelectedTabTextColor();
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.setNative] = function (value) {
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        this._tabLayout.setSelectedTabTextColor(color);
    };
    TabView.prototype[tab_view_common_1.androidSelectedTabHighlightColorProperty.getDefault] = function () {
        return getDefaultAccentColor(this._context);
    };
    TabView.prototype[tab_view_common_1.androidSelectedTabHighlightColorProperty.setNative] = function (value) {
        var tabLayout = this._tabLayout;
        var color = value instanceof tab_view_common_1.Color ? value.android : value;
        tabLayout.setSelectedIndicatorColors([color]);
    };
    return TabView;
}(tab_view_common_1.TabViewBase));
exports.TabView = TabView;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=tab-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
exports.traceCategory = "TabView";
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabsBase = (function (_super) {
    __extends(TabsBase, _super);
    function TabsBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabsBase = __decorate([
        view_1.CSSType("Tabs")
    ], TabsBase);
    return TabsBase;
}(tab_navigation_base_1.TabNavigationBase));
exports.TabsBase = TabsBase;
exports.swipeEnabledProperty = new properties_1.Property({
    name: "swipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter
});
exports.swipeEnabledProperty.register(TabsBase);
exports.offscreenTabLimitProperty = new properties_1.Property({
    name: "offscreenTabLimit", defaultValue: 1, valueConverter: function (v) { return parseInt(v); }
});
exports.offscreenTabLimitProperty.register(TabsBase);
exports.tabsPositionProperty = new properties_1.Property({ name: "tabsPosition", defaultValue: "top" });
exports.tabsPositionProperty.register(TabsBase);
//# sourceMappingURL=tabs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_strip_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js");
var tab_strip_item_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js");
var application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var tabs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js"));
var ACCENT_COLOR = "colorAccent";
var PRIMARY_COLOR = "colorPrimary";
var DEFAULT_ELEVATION = 4;
var TABID = "_tabId";
var INDEX = "_index";
var PagerAdapter;
var TabsBar;
function makeFragmentName(viewId, id) {
    return "android:viewpager:" + viewId + ":" + id;
}
function getTabById(id) {
    var ref = exports.tabs.find(function (ref) {
        var tab = ref.get();
        return tab && tab._domId === id;
    });
    return ref && ref.get();
}
function initializeNativeClasses() {
    if (PagerAdapter) {
        return;
    }
    var TabFragmentImplementation = (function (_super) {
        __extends(TabFragmentImplementation, _super);
        function TabFragmentImplementation() {
            var _this = _super.call(this) || this;
            return global.__native(_this);
        }
        TabFragmentImplementation.newInstance = function (tabId, index) {
            var args = new android.os.Bundle();
            args.putInt(TABID, tabId);
            args.putInt(INDEX, index);
            var fragment = new TabFragmentImplementation();
            fragment.setArguments(args);
            return fragment;
        };
        TabFragmentImplementation.prototype.onCreate = function (savedInstanceState) {
            _super.prototype.onCreate.call(this, savedInstanceState);
            var args = this.getArguments();
            this.tab = getTabById(args.getInt(TABID));
            this.index = args.getInt(INDEX);
            if (!this.tab) {
                throw new Error("Cannot find TabView");
            }
        };
        TabFragmentImplementation.prototype.onCreateView = function (inflater, container, savedInstanceState) {
            var tabItem = this.tab.items[this.index];
            return tabItem.nativeViewProtected;
        };
        return TabFragmentImplementation;
    }(org.nativescript.widgets.FragmentBase));
    var POSITION_UNCHANGED = -1;
    var POSITION_NONE = -2;
    var FragmentPagerAdapter = (function (_super) {
        __extends(FragmentPagerAdapter, _super);
        function FragmentPagerAdapter(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        FragmentPagerAdapter.prototype.getCount = function () {
            var items = this.items;
            return items ? items.length : 0;
        };
        FragmentPagerAdapter.prototype.getPageTitle = function (index) {
            var items = this.items;
            if (index < 0 || index >= items.length) {
                return "";
            }
            return "";
        };
        FragmentPagerAdapter.prototype.startUpdate = function (container) {
            if (container.getId() === android.view.View.NO_ID) {
                throw new Error("ViewPager with adapter " + this + " requires a view containerId");
            }
        };
        FragmentPagerAdapter.prototype.instantiateItem = function (container, position) {
            var fragmentManager = this.owner._getFragmentManager();
            if (!this.mCurTransaction) {
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var itemId = this.getItemId(position);
            var name = makeFragmentName(container.getId(), itemId);
            var fragment = fragmentManager.findFragmentByTag(name);
            if (fragment != null) {
                this.mCurTransaction.attach(fragment);
            }
            else {
                fragment = TabFragmentImplementation.newInstance(this.owner._domId, position);
                this.mCurTransaction.add(container.getId(), fragment, name);
            }
            if (fragment !== this.mCurrentPrimaryItem) {
                fragment.setMenuVisibility(false);
                fragment.setUserVisibleHint(false);
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = true;
            }
            return fragment;
        };
        FragmentPagerAdapter.prototype.getItemPosition = function (object) {
            return this.items ? POSITION_UNCHANGED : POSITION_NONE;
        };
        FragmentPagerAdapter.prototype.destroyItem = function (container, position, object) {
            if (!this.mCurTransaction) {
                var fragmentManager = this.owner._getFragmentManager();
                this.mCurTransaction = fragmentManager.beginTransaction();
            }
            var fragment = object;
            this.mCurTransaction.detach(fragment);
            if (this.mCurrentPrimaryItem === fragment) {
                this.mCurrentPrimaryItem = null;
            }
            var tabItems = this.owner.items;
            var tabItem = tabItems ? tabItems[position] : null;
            if (tabItem) {
                tabItem.canBeLoaded = false;
            }
        };
        FragmentPagerAdapter.prototype.setPrimaryItem = function (container, position, object) {
            var fragment = object;
            if (fragment !== this.mCurrentPrimaryItem) {
                if (this.mCurrentPrimaryItem != null) {
                    this.mCurrentPrimaryItem.setMenuVisibility(false);
                    this.mCurrentPrimaryItem.setUserVisibleHint(false);
                }
                if (fragment != null) {
                    fragment.setMenuVisibility(true);
                    fragment.setUserVisibleHint(true);
                }
                this.mCurrentPrimaryItem = fragment;
                this.owner.selectedIndex = position;
                var tab = this.owner;
                var tabItems = tab.items;
                var newTabItem = tabItems ? tabItems[position] : null;
                if (newTabItem) {
                    tab._loadUnloadTabItems(tab.selectedIndex);
                }
            }
        };
        FragmentPagerAdapter.prototype.finishUpdate = function (container) {
            this._commitCurrentTransaction();
        };
        FragmentPagerAdapter.prototype.isViewFromObject = function (view, object) {
            return object.getView() === view;
        };
        FragmentPagerAdapter.prototype.saveState = function () {
            this._commitCurrentTransaction();
            return null;
        };
        FragmentPagerAdapter.prototype.restoreState = function (state, loader) {
        };
        FragmentPagerAdapter.prototype.getItemId = function (position) {
            return position;
        };
        FragmentPagerAdapter.prototype._commitCurrentTransaction = function () {
            if (this.mCurTransaction != null) {
                this.mCurTransaction.commitNowAllowingStateLoss();
                this.mCurTransaction = null;
            }
        };
        return FragmentPagerAdapter;
    }(androidx.viewpager.widget.PagerAdapter));
    var TabsBarImplementation = (function (_super) {
        __extends(TabsBarImplementation, _super);
        function TabsBarImplementation(context, owner) {
            var _this = _super.call(this, context) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TabsBarImplementation.prototype.onSelectedPositionChange = function (position, prevPosition) {
            var owner = this.owner;
            if (!owner) {
                return;
            }
            var tabStripItems = owner.tabStrip && owner.tabStrip.items;
            if (position >= 0 && tabStripItems && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.selectEvent);
            }
            if (prevPosition >= 0 && tabStripItems && tabStripItems[prevPosition]) {
                tabStripItems[prevPosition]._emit(tab_strip_item_1.TabStripItem.unselectEvent);
            }
        };
        TabsBarImplementation.prototype.onTap = function (position) {
            var owner = this.owner;
            if (!owner) {
                return false;
            }
            var tabStrip = owner.tabStrip;
            var tabStripItems = tabStrip && tabStrip.items;
            if (position >= 0 && tabStripItems[position]) {
                tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.tapEvent);
                tabStrip.notify({ eventName: tab_strip_1.TabStrip.itemTapEvent, object: tabStrip, index: position });
            }
            if (!owner.items[position]) {
                return false;
            }
            return true;
        };
        return TabsBarImplementation;
    }(org.nativescript.widgets.TabsBar));
    PagerAdapter = FragmentPagerAdapter;
    TabsBar = TabsBarImplementation;
}
var defaultAccentColor = undefined;
function getDefaultAccentColor(context) {
    if (defaultAccentColor === undefined) {
        defaultAccentColor = utils_1.ad.resources.getPaletteColor(ACCENT_COLOR, context) || 0xFF33B5E5;
    }
    return defaultAccentColor;
}
function setElevation(grid, tabsBar, tabsPosition) {
    var compat = androidx.core.view.ViewCompat;
    if (compat.setElevation) {
        var val = DEFAULT_ELEVATION * utils_1.layout.getDisplayDensity();
        if (tabsPosition === "top") {
            compat.setElevation(grid, val);
        }
        compat.setElevation(tabsBar, val);
    }
}
exports.tabs = new Array();
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var Tabs = (function (_super) {
    __extends(Tabs, _super);
    function Tabs() {
        var _this = _super.call(this) || this;
        _this._androidViewId = -1;
        exports.tabs.push(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(Tabs.prototype, "_hasFragments", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Tabs.prototype.onItemsChanged = function (oldItems, newItems) {
        _super.prototype.onItemsChanged.call(this, oldItems, newItems);
        if (oldItems) {
            oldItems.forEach(function (item, i, arr) {
                item.index = 0;
                item.tabItemSpec = null;
                item.setNativeView(null);
            });
        }
    };
    Tabs.prototype.createNativeView = function () {
        initializeNativeClasses();
        var context = this._context;
        var nativeView = new org.nativescript.widgets.GridLayout(context);
        var viewPager = new org.nativescript.widgets.TabViewPager(context);
        var tabsBar = new TabsBar(context, this);
        var lp = new org.nativescript.widgets.CommonLayoutParams();
        var primaryColor = utils_1.ad.resources.getPaletteColor(PRIMARY_COLOR, context);
        var accentColor = getDefaultAccentColor(context);
        lp.row = 1;
        if (this.tabsPosition === "top") {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            viewPager.setLayoutParams(lp);
        }
        else {
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.star));
            nativeView.addRow(new org.nativescript.widgets.ItemSpec(1, org.nativescript.widgets.GridUnitType.auto));
            tabsBar.setLayoutParams(lp);
        }
        nativeView.addView(viewPager);
        nativeView.viewPager = viewPager;
        var adapter = new PagerAdapter(this);
        viewPager.setAdapter(adapter);
        viewPager.adapter = adapter;
        nativeView.addView(tabsBar);
        nativeView.tabsBar = tabsBar;
        setElevation(nativeView, tabsBar, this.tabsPosition);
        if (accentColor) {
            tabsBar.setSelectedIndicatorColors([accentColor]);
        }
        if (primaryColor) {
            tabsBar.setBackgroundColor(primaryColor);
        }
        return nativeView;
    };
    Tabs.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        if (this._androidViewId < 0) {
            this._androidViewId = android.view.View.generateViewId();
        }
        var nativeView = this.nativeViewProtected;
        this._tabsBar = nativeView.tabsBar;
        var viewPager = nativeView.viewPager;
        viewPager.setId(this._androidViewId);
        this._viewPager = viewPager;
        this._pagerAdapter = viewPager.adapter;
        this._pagerAdapter.owner = this;
    };
    Tabs.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = this.offscreenTabLimit;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.content);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.content;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.loadView(item.content);
            }
        });
    };
    Tabs.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.setItems(this.items);
        if (this.tabStrip) {
            this.setTabStripItems(this.tabStrip.items);
        }
    };
    Tabs.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.setItems(null);
        this.setTabStripItems(null);
    };
    Tabs.prototype.disposeNativeView = function () {
        this._tabsBar.setItems(null, null);
        this._pagerAdapter.owner = null;
        this._pagerAdapter = null;
        this._tabsBar = null;
        this._viewPager = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Tabs.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this.disposeCurrentFragments();
    };
    Tabs.prototype.disposeCurrentFragments = function () {
        var fragmentManager = this._getFragmentManager();
        var transaction = fragmentManager.beginTransaction();
        for (var _i = 0, _a = fragmentManager.getFragments().toArray(); _i < _a.length; _i++) {
            var fragment = _a[_i];
            transaction.remove(fragment);
        }
        transaction.commitNowAllowingStateLoss();
    };
    Tabs.prototype.shouldUpdateAdapter = function (items) {
        if (!this._pagerAdapter) {
            return false;
        }
        var currentPagerAdapterItems = this._pagerAdapter.items;
        if (!items && !currentPagerAdapterItems) {
            return false;
        }
        if (!items || !currentPagerAdapterItems) {
            return true;
        }
        if (items.length !== currentPagerAdapterItems.length) {
            return true;
        }
        var matchingItems = currentPagerAdapterItems.filter(function (currentItem) {
            return !!items.filter(function (item) {
                return item._domId === currentItem._domId;
            })[0];
        });
        if (matchingItems.length !== items.length) {
            return true;
        }
        return false;
    };
    Tabs.prototype.setItems = function (items) {
        if (this.shouldUpdateAdapter(items)) {
            this._pagerAdapter.items = items;
            if (items && items.length) {
                items.forEach(function (item, i) {
                    item.index = i;
                });
            }
            this._pagerAdapter.notifyDataSetChanged();
        }
    };
    Tabs.prototype.setTabStripItems = function (items) {
        var _this = this;
        var length = items ? items.length : 0;
        if (length === 0) {
            this._tabsBar.setItems(null, null);
            return;
        }
        var tabItems = new Array();
        items.forEach(function (item, i, arr) {
            item.index = i;
            var tabItemSpec = _this.createTabItemSpec(item);
            item.tabItemSpec = tabItemSpec;
            tabItems.push(tabItemSpec);
        });
        var tabsBar = this._tabsBar;
        tabsBar.setItems(tabItems, this._viewPager);
        this.tabStrip.setNativeView(tabsBar);
        items.forEach(function (item, i, arr) {
            var tv = tabsBar.getTextViewForItemAt(i);
            item.setNativeView(tv);
        });
    };
    Tabs.prototype.createTabItemSpec = function (tabStripItem) {
        var tabItemSpec = new org.nativescript.widgets.TabItemSpec();
        if (tabStripItem.isLoaded) {
            var nestedLabel = tabStripItem.label;
            var title = nestedLabel.text;
            var textTransform = nestedLabel.style.textTransform;
            if (textTransform) {
                title = text_base_1.getTransformedText(title, textTransform);
            }
            tabItemSpec.title = title;
            var backgroundColor = tabStripItem.style.backgroundColor;
            if (backgroundColor) {
                tabItemSpec.backgroundColor = backgroundColor.android;
            }
            var color = nestedLabel.style.color;
            if (color) {
                tabItemSpec.color = color.android;
            }
            var fontInternal = nestedLabel.style.fontInternal;
            if (fontInternal) {
                tabItemSpec.fontSize = fontInternal.fontSize;
                tabItemSpec.typeFace = fontInternal.getAndroidTypeface();
            }
            var iconSource = tabStripItem.image && tabStripItem.image.src;
            if (iconSource) {
                var icon = this.getIcon(tabStripItem);
                if (icon) {
                    tabItemSpec.iconDrawable = icon;
                }
                else {
                }
            }
        }
        return tabItemSpec;
    };
    Tabs.prototype.getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image && tabStripItem.image.src;
        var is;
        if (utils_1.isFontIconURI(iconSource)) {
            var fontIconCode = iconSource.split("//")[1];
            var target = tabStripItem.image ? tabStripItem.image : tabStripItem;
            var font = target.style.fontInternal;
            var color = target.style.color;
            is = image_source_1.fromFontIconCode(fontIconCode, font, color);
        }
        else {
            is = image_source_1.fromFileOrResource(iconSource);
        }
        var imageDrawable;
        if (is && is.android) {
            var image = is.android;
            if (this.tabStrip && this.tabStrip.isIconSizeFixed) {
                image = this.getFixedSizeIcon(image);
            }
            imageDrawable = new android.graphics.drawable.BitmapDrawable(application.android.context.getResources(), image);
        }
        else {
        }
        return imageDrawable;
    };
    Tabs.prototype.getFixedSizeIcon = function (image) {
        var inWidth = image.getWidth();
        var inHeight = image.getHeight();
        var iconSpecSize = tab_navigation_base_1.getIconSpecSize({ width: inWidth, height: inHeight });
        var widthPixels = iconSpecSize.width * utils_1.layout.getDisplayDensity();
        var heightPixels = iconSpecSize.height * utils_1.layout.getDisplayDensity();
        var scaledImage = android.graphics.Bitmap.createScaledBitmap(image, widthPixels, heightPixels, true);
        return scaledImage;
    };
    Tabs.prototype.updateAndroidItemAt = function (index, spec) {
        this._tabsBar.updateItemAt(index, spec);
    };
    Tabs.prototype.getTabBarBackgroundColor = function () {
        return this._tabsBar.getBackground();
    };
    Tabs.prototype.setTabBarBackgroundColor = function (value) {
        if (value instanceof view_1.Color) {
            this._tabsBar.setBackgroundColor(value.android);
        }
        else {
            this._tabsBar.setBackground(tryCloneDrawable(value, this.nativeViewProtected.getResources));
        }
    };
    Tabs.prototype.getTabBarHighlightColor = function () {
        return getDefaultAccentColor(this._context);
    };
    Tabs.prototype.setTabBarHighlightColor = function (value) {
        var color = value instanceof view_1.Color ? value.android : value;
        this._tabsBar.setSelectedIndicatorColors([color]);
    };
    Tabs.prototype.setTabBarItemTitle = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    Tabs.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
        var tabStripItemIndex = this.tabStrip.items.indexOf(tabStripItem);
        var tabItemSpec = this.createTabItemSpec(tabStripItem);
        this.updateAndroidItemAt(tabStripItemIndex, tabItemSpec);
    };
    Tabs.prototype.setTabBarItemColor = function (tabStripItem, value) {
        if (typeof value === "number") {
            tabStripItem.nativeViewProtected.setTextColor(value);
        }
        else {
            tabStripItem.nativeViewProtected.setTextColor(value.android);
        }
    };
    Tabs.prototype.setTabBarIconColor = function (tabStripItem, value) {
        var index = tabStripItem.index;
        var tabBarItem = this._tabsBar.getViewForItemAt(index);
        var imgView = tabBarItem.getChildAt(0);
        var drawable = this.getIcon(tabStripItem);
        imgView.setImageDrawable(drawable);
    };
    Tabs.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
        tabStripItem.nativeViewProtected.setTextSize(value.fontSize);
        tabStripItem.nativeViewProtected.setTypeface(value.getAndroidTypeface());
    };
    Tabs.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
        var nestedLabel = tabStripItem.label;
        var title = text_base_1.getTransformedText(nestedLabel.text, value);
        tabStripItem.nativeViewProtected.setText(title);
    };
    Tabs.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        var smoothScroll = true;
        this._viewPager.setCurrentItem(value, smoothScroll);
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        this.setItems(value);
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.setNative] = function (value) {
        this.setTabStripItems(value.items);
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.getDefault] = function () {
        return true;
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.setNative] = function (value) {
        this._viewPager.setSwipePageEnabled(value);
    };
    Tabs.prototype[tabs_common_1.offscreenTabLimitProperty.getDefault] = function () {
        return this._viewPager.getOffscreenPageLimit();
    };
    Tabs.prototype[tabs_common_1.offscreenTabLimitProperty.setNative] = function (value) {
        this._viewPager.setOffscreenPageLimit(value);
    };
    return Tabs;
}(tabs_common_1.TabsBase));
exports.Tabs = Tabs;
function tryCloneDrawable(value, resources) {
    if (value) {
        var constantState = value.getConstantState();
        if (constantState) {
            return constantState.newDrawable(resources);
        }
    }
    return value;
}
//# sourceMappingURL=tabs.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var formatted_string_1 = __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js");
exports.FormattedString = formatted_string_1.FormattedString;
exports.Span = formatted_string_1.Span;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var CHILD_SPAN = "Span";
var CHILD_FORMATTED_TEXT = "formattedText";
var CHILD_FORMATTED_STRING = "FormattedString";
var TextBaseCommon = (function (_super) {
    __extends(TextBaseCommon, _super);
    function TextBaseCommon() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TextBaseCommon.prototype, "nativeTextViewProtected", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "letterSpacing", {
        get: function () {
            return this.style.letterSpacing;
        },
        set: function (value) {
            this.style.letterSpacing = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "lineHeight", {
        get: function () {
            return this.style.lineHeight;
        },
        set: function (value) {
            this.style.lineHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textAlignment", {
        get: function () {
            return this.style.textAlignment;
        },
        set: function (value) {
            this.style.textAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "whiteSpace", {
        get: function () {
            return this.style.whiteSpace;
        },
        set: function (value) {
            this.style.whiteSpace = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    TextBaseCommon.prototype._onFormattedTextContentsChanged = function (data) {
        if (this.nativeViewProtected) {
            this[exports.formattedTextProperty.setNative](data.value);
        }
    };
    TextBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (name === CHILD_SPAN) {
            if (!this.formattedText) {
                var formattedText = new formatted_string_1.FormattedString();
                formattedText.spans.push(value);
                this.formattedText = formattedText;
            }
            else {
                this.formattedText.spans.push(value);
            }
        }
        else if (name === CHILD_FORMATTED_TEXT || name === CHILD_FORMATTED_STRING) {
            this.formattedText = value;
        }
    };
    TextBaseCommon.prototype._requestLayoutOnTextChanged = function () {
        this.requestLayout();
    };
    TextBaseCommon.prototype.eachChild = function (callback) {
        var text = this.formattedText;
        if (text) {
            callback(text);
        }
    };
    TextBaseCommon.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
    };
    return TextBaseCommon;
}(view_1.View));
exports.TextBaseCommon = TextBaseCommon;
TextBaseCommon.prototype._isSingleLine = false;
function isBold(fontWeight) {
    return fontWeight === "bold" || fontWeight === "700" || fontWeight === "800" || fontWeight === "900";
}
exports.isBold = isBold;
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isAndroid });
exports.textProperty.register(TextBaseCommon);
exports.formattedTextProperty = new view_1.Property({ name: "formattedText", affectsLayout: true, valueChanged: onFormattedTextPropertyChanged });
exports.formattedTextProperty.register(TextBaseCommon);
function onFormattedTextPropertyChanged(textBase, oldValue, newValue) {
    if (oldValue) {
        oldValue.off(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
        textBase._removeView(oldValue);
    }
    if (newValue) {
        var oldParent = newValue.parent;
        if (oldParent) {
            oldParent._removeView(newValue);
        }
        textBase._addView(newValue);
        newValue.on(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
    }
}
var textAlignmentConverter = view_1.makeParser(view_1.makeValidator("initial", "left", "center", "right"));
exports.textAlignmentProperty = new view_1.InheritedCssProperty({ name: "textAlignment", cssName: "text-align", defaultValue: "initial", valueConverter: textAlignmentConverter });
exports.textAlignmentProperty.register(view_1.Style);
var textTransformConverter = view_1.makeParser(view_1.makeValidator("initial", "none", "capitalize", "uppercase", "lowercase"));
exports.textTransformProperty = new view_1.CssProperty({ name: "textTransform", cssName: "text-transform", defaultValue: "initial", valueConverter: textTransformConverter });
exports.textTransformProperty.register(view_1.Style);
var whiteSpaceConverter = view_1.makeParser(view_1.makeValidator("initial", "normal", "nowrap"));
exports.whiteSpaceProperty = new view_1.CssProperty({ name: "whiteSpace", cssName: "white-space", defaultValue: "initial", affectsLayout: view_1.isIOS, valueConverter: whiteSpaceConverter });
exports.whiteSpaceProperty.register(view_1.Style);
var textDecorationConverter = view_1.makeParser(view_1.makeValidator("none", "underline", "line-through", "underline line-through"));
exports.textDecorationProperty = new view_1.CssProperty({ name: "textDecoration", cssName: "text-decoration", defaultValue: "none", valueConverter: textDecorationConverter });
exports.textDecorationProperty.register(view_1.Style);
exports.letterSpacingProperty = new view_1.CssProperty({ name: "letterSpacing", cssName: "letter-spacing", defaultValue: 0, affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.letterSpacingProperty.register(view_1.Style);
exports.lineHeightProperty = new view_1.CssProperty({ name: "lineHeight", cssName: "line-height", affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.lineHeightProperty.register(view_1.Style);
exports.resetSymbol = Symbol("textPropertyDefault");
//# sourceMappingURL=text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js"));
var TextTransformation;
function initializeTextTransformation() {
    if (TextTransformation) {
        return;
    }
    var TextTransformationImpl = (function (_super) {
        __extends(TextTransformationImpl, _super);
        function TextTransformationImpl(textBase) {
            var _this = _super.call(this) || this;
            _this.textBase = textBase;
            return global.__native(_this);
        }
        TextTransformationImpl.prototype.getTransformation = function (charSeq, view) {
            var formattedText = this.textBase.formattedText;
            if (formattedText) {
                return createSpannableStringBuilder(formattedText);
            }
            else {
                var text = this.textBase.text;
                var stringValue = (text === null || text === undefined) ? "" : text.toString();
                return getTransformedText(stringValue, this.textBase.textTransform);
            }
        };
        TextTransformationImpl.prototype.onFocusChanged = function (view, sourceText, focused, direction, previouslyFocusedRect) {
        };
        TextTransformationImpl = __decorate([
            Interfaces([android.text.method.TransformationMethod])
        ], TextTransformationImpl);
        return TextTransformationImpl;
    }(java.lang.Object));
    TextTransformation = TextTransformationImpl;
}
var TextBase = (function (_super) {
    __extends(TextBase, _super);
    function TextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBase.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeTextTransformation();
        var nativeView = this.nativeTextViewProtected;
        this._defaultTransformationMethod = nativeView.getTransformationMethod();
        this._minHeight = nativeView.getMinHeight();
        this._maxHeight = nativeView.getMaxHeight();
        this._minLines = nativeView.getMinLines();
        this._maxLines = nativeView.getMaxLines();
    };
    TextBase.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        var nativeView = this.nativeTextViewProtected;
        nativeView.setSingleLine(this._isSingleLine);
        nativeView.setTransformationMethod(this._defaultTransformationMethod);
        this._defaultTransformationMethod = null;
        if (this._paintFlags !== undefined) {
            nativeView.setPaintFlags(this._paintFlags);
            this._paintFlags = undefined;
        }
        if (this._minLines !== -1) {
            nativeView.setMinLines(this._minLines);
        }
        else {
            nativeView.setMinHeight(this._minHeight);
        }
        this._minHeight = this._minLines = undefined;
        if (this._maxLines !== -1) {
            nativeView.setMaxLines(this._maxLines);
        }
        else {
            nativeView.setMaxHeight(this._maxHeight);
        }
        this._maxHeight = this._maxLines = undefined;
    };
    TextBase.prototype[text_base_common_1.textProperty.getDefault] = function () {
        return text_base_common_1.resetSymbol;
    };
    TextBase.prototype[text_base_common_1.textProperty.setNative] = function (value) {
        var reset = value === text_base_common_1.resetSymbol;
        if (!reset && this.formattedText) {
            return;
        }
        this._setNativeText(reset);
    };
    TextBase.prototype[text_base_common_1.formattedTextProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        if (!value) {
            if (nativeView instanceof android.widget.Button &&
                nativeView.getTransformationMethod() instanceof TextTransformation) {
                nativeView.setTransformationMethod(this._defaultTransformationMethod);
            }
        }
        if (this.secure) {
            return;
        }
        var spannableStringBuilder = createSpannableStringBuilder(value);
        nativeView.setText(spannableStringBuilder);
        text_base_common_1.textProperty.nativeValueChange(this, (value === null || value === undefined) ? "" : value.toString());
        if (spannableStringBuilder && nativeView instanceof android.widget.Button &&
            !(nativeView.getTransformationMethod() instanceof TextTransformation)) {
            nativeView.setTransformationMethod(new TextTransformation(this));
        }
    };
    TextBase.prototype[text_base_common_1.textTransformProperty.setNative] = function (value) {
        if (value === "initial") {
            this.nativeTextViewProtected.setTransformationMethod(this._defaultTransformationMethod);
            return;
        }
        if (this.secure) {
            return;
        }
        this.nativeTextViewProtected.setTransformationMethod(new TextTransformation(this));
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.getDefault] = function () {
        return "initial";
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.setNative] = function (value) {
        var verticalGravity = this.nativeTextViewProtected.getGravity() & android.view.Gravity.VERTICAL_GRAVITY_MASK;
        switch (value) {
            case "initial":
            case "left":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.START | verticalGravity);
                break;
            case "center":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.CENTER_HORIZONTAL | verticalGravity);
                break;
            case "right":
                this.nativeTextViewProtected.setGravity(android.view.Gravity.END | verticalGravity);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "initial":
            case "normal":
                nativeView.setSingleLine(false);
                nativeView.setEllipsize(null);
                break;
            case "nowrap":
                nativeView.setSingleLine(true);
                nativeView.setEllipsize(android.text.TextUtils.TruncateAt.END);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.colorProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getTextColors();
    };
    TextBase.prototype[text_base_common_1.colorProperty.setNative] = function (value) {
        if (!this.formattedText || !(value instanceof text_base_common_1.Color)) {
            if (value instanceof text_base_common_1.Color) {
                this.nativeTextViewProtected.setTextColor(value.android);
            }
            else {
                this.nativeTextViewProtected.setTextColor(value);
            }
        }
    };
    TextBase.prototype[text_base_common_1.fontSizeProperty.getDefault] = function () {
        return { nativeSize: this.nativeTextViewProtected.getTextSize() };
    };
    TextBase.prototype[text_base_common_1.fontSizeProperty.setNative] = function (value) {
        if (!this.formattedText || (typeof value !== "number")) {
            if (typeof value === "number") {
                this.nativeTextViewProtected.setTextSize(value);
            }
            else {
                this.nativeTextViewProtected.setTextSize(android.util.TypedValue.COMPLEX_UNIT_PX, value.nativeSize);
            }
        }
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getLineSpacingExtra() / text_base_common_1.layout.getDisplayDensity();
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.setNative] = function (value) {
        this.nativeTextViewProtected.setLineSpacing(value * text_base_common_1.layout.getDisplayDensity(), 1);
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.getDefault] = function () {
        return this.nativeTextViewProtected.getTypeface();
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.setNative] = function (value) {
        if (!this.formattedText || !(value instanceof font_1.Font)) {
            this.nativeTextViewProtected.setTypeface(value instanceof font_1.Font ? value.getAndroidTypeface() : value);
        }
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.getDefault] = function (value) {
        return this._paintFlags = this.nativeTextViewProtected.getPaintFlags();
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.setNative] = function (value) {
        switch (value) {
            case "none":
                this.nativeTextViewProtected.setPaintFlags(0);
                break;
            case "underline":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.UNDERLINE_TEXT_FLAG);
                break;
            case "line-through":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.STRIKE_THRU_TEXT_FLAG);
                break;
            case "underline line-through":
                this.nativeTextViewProtected.setPaintFlags(android.graphics.Paint.UNDERLINE_TEXT_FLAG | android.graphics.Paint.STRIKE_THRU_TEXT_FLAG);
                break;
            default:
                this.nativeTextViewProtected.setPaintFlags(value);
                break;
        }
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.getDefault] = function () {
        return org.nativescript.widgets.ViewHelper.getLetterspacing(this.nativeTextViewProtected);
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setLetterspacing(this.nativeTextViewProtected, value);
    };
    TextBase.prototype[text_base_common_1.paddingTopProperty.getDefault] = function () {
        return { value: this._defaultPaddingTop, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingTopProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingTop(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderTopWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingRightProperty.getDefault] = function () {
        return { value: this._defaultPaddingRight, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingRightProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingRight(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderRightWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingBottomProperty.getDefault] = function () {
        return { value: this._defaultPaddingBottom, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingBottomProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingBottom(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderBottomWidth, 0));
    };
    TextBase.prototype[text_base_common_1.paddingLeftProperty.getDefault] = function () {
        return { value: this._defaultPaddingLeft, unit: "px" };
    };
    TextBase.prototype[text_base_common_1.paddingLeftProperty.setNative] = function (value) {
        org.nativescript.widgets.ViewHelper.setPaddingLeft(this.nativeTextViewProtected, text_base_common_1.Length.toDevicePixels(value, 0) + text_base_common_1.Length.toDevicePixels(this.style.borderLeftWidth, 0));
    };
    TextBase.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
        if (reset) {
            this.nativeTextViewProtected.setText(null);
            return;
        }
        var transformedText;
        if (this.formattedText) {
            transformedText = createSpannableStringBuilder(this.formattedText);
        }
        else {
            var text = this.text;
            var stringValue = (text === null || text === undefined) ? "" : text.toString();
            transformedText = getTransformedText(stringValue, this.textTransform);
        }
        this.nativeTextViewProtected.setText(transformedText);
    };
    return TextBase;
}(text_base_common_1.TextBaseCommon));
exports.TextBase = TextBase;
function getCapitalizedString(str) {
    var words = str.split(" ");
    var newWords = [];
    for (var i = 0, length_1 = words.length; i < length_1; i++) {
        var word = words[i].toLowerCase();
        newWords.push(word.substr(0, 1).toUpperCase() + word.substring(1));
    }
    return newWords.join(" ");
}
function getTransformedText(text, textTransform) {
    if (!text || !types_1.isString(text)) {
        return "";
    }
    switch (textTransform) {
        case "uppercase":
            return text.toUpperCase();
        case "lowercase":
            return text.toLowerCase();
        case "capitalize":
            return getCapitalizedString(text);
        case "none":
        default:
            return text;
    }
}
exports.getTransformedText = getTransformedText;
function createSpannableStringBuilder(formattedString) {
    if (!formattedString || !formattedString.parent) {
        return null;
    }
    var ssb = new android.text.SpannableStringBuilder();
    for (var i = 0, spanStart = 0, spanLength = 0, length_2 = formattedString.spans.length; i < length_2; i++) {
        var span = formattedString.spans.getItem(i);
        var text = span.text;
        var textTransform = formattedString.parent.textTransform;
        var spanText = (text === null || text === undefined) ? "" : text.toString();
        if (textTransform && textTransform !== "none") {
            spanText = getTransformedText(spanText, textTransform);
        }
        spanLength = spanText.length;
        if (spanLength > 0) {
            ssb.insert(spanStart, spanText);
            setSpanModifiers(ssb, span, spanStart, spanStart + spanLength);
            spanStart += spanLength;
        }
    }
    return ssb;
}
function setSpanModifiers(ssb, span, start, end) {
    var spanStyle = span.style;
    var bold = text_base_common_1.isBold(spanStyle.fontWeight);
    var italic = spanStyle.fontStyle === "italic";
    if (bold && italic) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.BOLD_ITALIC), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    else if (bold) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.BOLD), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    else if (italic) {
        ssb.setSpan(new android.text.style.StyleSpan(android.graphics.Typeface.ITALIC), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var fontFamily = span.fontFamily;
    if (fontFamily) {
        var font = new font_1.Font(fontFamily, 0, (italic) ? "italic" : "normal", (bold) ? "bold" : "normal");
        var typeface = font.getAndroidTypeface() || android.graphics.Typeface.create(fontFamily, 0);
        var typefaceSpan = new org.nativescript.widgets.CustomTypefaceSpan(fontFamily, typeface);
        ssb.setSpan(typefaceSpan, start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var realFontSize = span.fontSize;
    if (realFontSize) {
        ssb.setSpan(new android.text.style.AbsoluteSizeSpan(realFontSize * text_base_common_1.layout.getDisplayDensity()), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var color = span.color;
    if (color) {
        ssb.setSpan(new android.text.style.ForegroundColorSpan(color.android), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var backgroundColor;
    if (style_properties_1.backgroundColorProperty.isSet(spanStyle)) {
        backgroundColor = spanStyle.backgroundColor;
    }
    else if (style_properties_1.backgroundColorProperty.isSet(span.parent.style)) {
        backgroundColor = span.parent.style.backgroundColor;
    }
    else if (style_properties_1.backgroundColorProperty.isSet(span.parent.parent.style)) {
        backgroundColor = span.parent.parent.style.backgroundColor;
    }
    if (backgroundColor) {
        ssb.setSpan(new android.text.style.BackgroundColorSpan(backgroundColor.android), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    }
    var valueSource;
    if (text_base_common_1.textDecorationProperty.isSet(spanStyle)) {
        valueSource = spanStyle;
    }
    else if (text_base_common_1.textDecorationProperty.isSet(span.parent.style)) {
        valueSource = span.parent.style;
    }
    else if (text_base_common_1.textDecorationProperty.isSet(span.parent.parent.style)) {
        valueSource = span.parent.parent.style;
    }
    if (valueSource) {
        var textDecorations = valueSource.textDecoration;
        var underline_1 = textDecorations.indexOf("underline") !== -1;
        if (underline_1) {
            ssb.setSpan(new android.text.style.UnderlineSpan(), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
        }
        var strikethrough = textDecorations.indexOf("line-through") !== -1;
        if (strikethrough) {
            ssb.setSpan(new android.text.style.StrikethroughSpan(), start, end, android.text.Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
        }
    }
}
//# sourceMappingURL=text-base.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js"));
var TextFieldBase = (function (_super) {
    __extends(TextFieldBase, _super);
    function TextFieldBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldBase.returnPressEvent = "returnPress";
    TextFieldBase = __decorate([
        editable_text_base_1.CSSType("TextField")
    ], TextFieldBase);
    return TextFieldBase;
}(editable_text_base_1.EditableTextBase));
exports.TextFieldBase = TextFieldBase;
TextFieldBase.prototype.recycleNativeView = "auto";
exports.secureProperty = new editable_text_base_1.Property({ name: "secure", defaultValue: false, valueConverter: editable_text_base_1.booleanConverter });
exports.secureProperty.register(TextFieldBase);
//# sourceMappingURL=text-field-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_field_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js"));
var TextField = (function (_super) {
    __extends(TextField, _super);
    function TextField() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextField.prototype._configureEditText = function (editText) {
        editText.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
        editText.setLines(1);
        editText.setMaxLines(1);
        editText.setHorizontallyScrolling(true);
    };
    TextField.prototype._onReturnPress = function () {
        this.notify({ eventName: TextField.returnPressEvent, object: this });
    };
    TextField.prototype[text_field_common_1.secureProperty.setNative] = function () {
        this.setSecureAndKeyboardType();
    };
    TextField.prototype[text_field_common_1.keyboardTypeProperty.setNative] = function () {
        this.setSecureAndKeyboardType();
    };
    TextField.prototype.setSecureAndKeyboardType = function () {
        var inputType;
        if (this.secure) {
            if (this.keyboardType === "number") {
                inputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_PASSWORD;
            }
            else {
                inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_PASSWORD;
            }
        }
        else {
            inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL;
            if (this.autocorrect) {
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_COMPLETE;
                inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_AUTO_CORRECT;
                inputType = inputType & ~android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS;
            }
            switch (this.autocapitalizationType) {
                case "words":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_WORDS;
                    break;
                case "sentences":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES;
                    break;
                case "allcharacters":
                    inputType = inputType | android.text.InputType.TYPE_TEXT_FLAG_CAP_CHARACTERS;
                    break;
                default:
                    break;
            }
            switch (this.keyboardType) {
                case "datetime":
                    inputType = android.text.InputType.TYPE_CLASS_DATETIME | android.text.InputType.TYPE_DATETIME_VARIATION_NORMAL;
                    break;
                case "phone":
                    inputType = android.text.InputType.TYPE_CLASS_PHONE;
                    break;
                case "number":
                    inputType = android.text.InputType.TYPE_CLASS_NUMBER | android.text.InputType.TYPE_NUMBER_VARIATION_NORMAL | android.text.InputType.TYPE_NUMBER_FLAG_SIGNED | android.text.InputType.TYPE_NUMBER_FLAG_DECIMAL;
                    break;
                case "url":
                    inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_URI;
                    break;
                case "email":
                    inputType = android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS;
                    break;
                default:
                    break;
            }
        }
        this._setInputType(inputType);
    };
    TextField.prototype[text_field_common_1.whiteSpaceProperty.getDefault] = function () {
        return "nowrap";
    };
    TextField.prototype[text_field_common_1.whiteSpaceProperty.setNative] = function (value) {
    };
    return TextField;
}(text_field_common_1.TextFieldBase));
exports.TextField = TextField;
TextField.prototype._isSingleLine = true;
//# sourceMappingURL=text-field.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-view/text-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var TextView = (function (_super) {
    __extends(TextView, _super);
    function TextView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextView.prototype._configureEditText = function (editText) {
        editText.setInputType(android.text.InputType.TYPE_CLASS_TEXT | android.text.InputType.TYPE_TEXT_VARIATION_NORMAL | android.text.InputType.TYPE_TEXT_FLAG_CAP_SENTENCES | android.text.InputType.TYPE_TEXT_FLAG_MULTI_LINE | android.text.InputType.TYPE_TEXT_FLAG_NO_SUGGESTIONS);
        editText.setGravity(android.view.Gravity.TOP | android.view.Gravity.START);
    };
    TextView.prototype.resetNativeView = function () {
        _super.prototype.resetNativeView.call(this);
        this.nativeTextViewProtected.setGravity(android.view.Gravity.TOP | android.view.Gravity.START);
    };
    TextView = __decorate([
        editable_text_base_1.CSSType("TextView")
    ], TextView);
    return TextView;
}(editable_text_base_1.EditableTextBase));
exports.TextView = TextView;
TextView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=text-view.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var dateComparer = function (x, y) { return (x <= y && x >= y); };
function getValidTime(picker, hour, minute) {
    if (picker.minuteInterval > 1) {
        var minuteFloor = minute - (minute % picker.minuteInterval);
        minute = minuteFloor + (minute === minuteFloor + 1 ? picker.minuteInterval : 0);
        if (minute === 60) {
            hour++;
            minute = 0;
        }
    }
    var time = { hour: hour, minute: minute };
    if (!isLessThanMaxTime(picker, hour, minute)) {
        time = { hour: picker.maxHour, minute: picker.maxMinute };
    }
    if (!isGreaterThanMinTime(picker, hour, minute)) {
        time = { hour: picker.minHour, minute: picker.minMinute };
    }
    return time;
}
exports.getValidTime = getValidTime;
function isValidTime(picker) {
    return isGreaterThanMinTime(picker) && isLessThanMaxTime(picker);
}
function isHourValid(value) {
    return typeof value === "number" && value >= 0 && value <= 23;
}
function isMinuteValid(value) {
    return typeof value === "number" && value >= 0 && value <= 59;
}
function isMinuteIntervalValid(value) {
    return typeof value === "number" && value >= 1 && value <= 30 && 60 % value === 0;
}
function getMinutes(hour) {
    return hour * 60;
}
function isDefined(value) {
    return value !== undefined;
}
exports.isDefined = isDefined;
function isGreaterThanMinTime(picker, hour, minute) {
    if (picker.minHour === undefined || picker.minMinute === undefined) {
        return true;
    }
    return getMinutes(hour !== undefined ? hour : picker.hour) + (minute !== undefined ? minute : picker.minute) >= getMinutes(picker.minHour) + picker.minMinute;
}
function isLessThanMaxTime(picker, hour, minute) {
    if (!isDefined(picker.maxHour) || !isDefined(picker.maxMinute)) {
        return true;
    }
    return getMinutes(isDefined(hour) ? hour : picker.hour) + (isDefined(minute) ? minute : picker.minute) <= getMinutes(picker.maxHour) + picker.maxMinute;
}
function toString(value) {
    if (value instanceof Date) {
        return value + "";
    }
    return value < 10 ? "0" + value : "" + value;
}
function getMinMaxTimeErrorMessage(picker) {
    return "Min time: (" + toString(picker.minHour) + ":" + toString(picker.minMinute) + "), max time: (" + toString(picker.maxHour) + ":" + toString(picker.maxMinute) + ")";
}
function getErrorMessage(picker, propertyName, newValue) {
    return propertyName + " property value (" + toString(newValue) + ":" + toString(picker.minute) + ") is not valid. " + getMinMaxTimeErrorMessage(picker) + ".";
}
var TimePickerBase = (function (_super) {
    __extends(TimePickerBase, _super);
    function TimePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimePickerBase = __decorate([
        view_1.CSSType("TimePicker")
    ], TimePickerBase);
    return TimePickerBase;
}(view_1.View));
exports.TimePickerBase = TimePickerBase;
TimePickerBase.prototype.recycleNativeView = "auto";
exports.minHourProperty = new view_1.Property({
    name: "minHour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minHourProperty.register(TimePickerBase);
exports.maxHourProperty = new view_1.Property({
    name: "maxHour", defaultValue: 23, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxHourProperty.register(TimePickerBase);
exports.minMinuteProperty = new view_1.Property({
    name: "minMinute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minMinuteProperty.register(TimePickerBase);
exports.maxMinuteProperty = new view_1.Property({
    name: "maxMinute", defaultValue: 59, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxMinuteProperty.register(TimePickerBase);
exports.minuteIntervalProperty = new view_1.Property({
    name: "minuteInterval", defaultValue: 1, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteIntervalValid(newValue)) {
            throw new Error(getErrorMessage(picker, "minuteInterval", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteIntervalProperty.register(TimePickerBase);
exports.minuteProperty = new view_1.Property({
    name: "minute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minute", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteProperty.register(TimePickerBase);
exports.hourProperty = new view_1.Property({
    name: "hour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "Hour", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.hourProperty.register(TimePickerBase);
exports.timeProperty = new view_1.Property({
    name: "time", defaultValue: new Date(), equalityComparer: dateComparer,
    valueChanged: function (picker, oldValue, newValue) {
        if (!isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "time", newValue));
        }
        picker.hour = newValue.getHours();
        picker.minute = newValue.getMinutes();
    }
});
exports.timeProperty.register(TimePickerBase);
//# sourceMappingURL=time-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var time_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js"));
var TimeChangedListener;
function initializeTimeChangedListener() {
    if (TimeChangedListener) {
        return;
    }
    apiLevel = android.os.Build.VERSION.SDK_INT;
    var TimeChangedListenerImpl = (function (_super) {
        __extends(TimeChangedListenerImpl, _super);
        function TimeChangedListenerImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        TimeChangedListenerImpl.prototype.onTimeChanged = function (picker, hour, minute) {
            var timePicker = this.owner;
            if (timePicker.updatingNativeValue) {
                return;
            }
            var validTime = time_picker_common_1.getValidTime(timePicker, hour, minute);
            time_picker_common_1.timeProperty.nativeValueChange(timePicker, new Date(0, 0, 0, validTime.hour, validTime.minute));
        };
        TimeChangedListenerImpl = __decorate([
            Interfaces([android.widget.TimePicker.OnTimeChangedListener])
        ], TimeChangedListenerImpl);
        return TimeChangedListenerImpl;
    }(java.lang.Object));
    TimeChangedListener = TimeChangedListenerImpl;
}
var apiLevel;
var TimePicker = (function (_super) {
    __extends(TimePicker, _super);
    function TimePicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimePicker.prototype.createNativeView = function () {
        return new android.widget.TimePicker(this._context);
    };
    TimePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        initializeTimeChangedListener();
        var listener = new TimeChangedListener(this);
        nativeView.setOnTimeChangedListener(listener);
        nativeView.listener = listener;
        var calendar = nativeView.calendar = java.util.Calendar.getInstance();
        var hour = time_picker_common_1.hourProperty.isSet(this) ? this.hour : calendar.get(java.util.Calendar.HOUR_OF_DAY);
        var minute = time_picker_common_1.minuteProperty.isSet(this) ? this.minute : calendar.get(java.util.Calendar.MINUTE);
        var validTime = time_picker_common_1.getValidTime(this, hour, minute);
        if (!time_picker_common_1.timeProperty.isSet(this)) {
            this.time = new Date(0, 0, 0, validTime.hour, validTime.minute);
        }
    };
    TimePicker.prototype[time_picker_common_1.minuteProperty.setNative] = function (value) {
        this.updatingNativeValue = true;
        try {
            if (apiLevel >= 23) {
                this.nativeViewProtected.setMinute(value);
            }
            else {
                this.nativeViewProtected.setCurrentMinute(new java.lang.Integer(value));
            }
        }
        finally {
            this.updatingNativeValue = false;
        }
    };
    TimePicker.prototype[time_picker_common_1.hourProperty.setNative] = function (value) {
        this.updatingNativeValue = true;
        try {
            if (apiLevel >= 23) {
                this.nativeViewProtected.setHour(value);
            }
            else {
                this.nativeViewProtected.setCurrentHour(new java.lang.Integer(value));
            }
        }
        finally {
            this.updatingNativeValue = false;
        }
    };
    return TimePicker;
}(time_picker_common_1.TimePickerBase));
exports.TimePicker = TimePicker;
//# sourceMappingURL=time-picker.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/fade-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FadeTransition = (function (_super) {
    __extends(FadeTransition, _super);
    function FadeTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    FadeTransition.prototype.createAndroidAnimator = function (transitionType) {
        var alphaValues = Array.create("float", 2);
        switch (transitionType) {
            case transition_1.AndroidTransitionType.enter:
            case transition_1.AndroidTransitionType.popEnter:
                alphaValues[0] = 0;
                alphaValues[1] = 1;
                break;
            case transition_1.AndroidTransitionType.exit:
            case transition_1.AndroidTransitionType.popExit:
                alphaValues[0] = 1;
                alphaValues[1] = 0;
                break;
        }
        var animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", alphaValues);
        var duration = this.getDuration();
        if (duration !== undefined) {
            animator.setDuration(duration);
        }
        animator.setInterpolator(this.getCurve());
        return animator;
    };
    return FadeTransition;
}(transition_1.Transition));
exports.FadeTransition = FadeTransition;
//# sourceMappingURL=fade-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/flip-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FlipTransition = (function (_super) {
    __extends(FlipTransition, _super);
    function FlipTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    FlipTransition.prototype.createAndroidAnimator = function (transitionType) {
        var objectAnimators;
        var values;
        var animator;
        var animatorSet = new android.animation.AnimatorSet();
        var fullDuration = this.getDuration() || 300;
        var interpolator = this.getCurve();
        var rotationY = this._direction === "right" ? 180 : -180;
        switch (transitionType) {
            case transition_1.AndroidTransitionType.enter:
                objectAnimators = Array.create(android.animation.Animator, 3);
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setDuration(0);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = rotationY;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[1] = animator;
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = 1.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[2] = animator;
                break;
            case transition_1.AndroidTransitionType.exit:
                objectAnimators = Array.create(android.animation.Animator, 2);
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = -rotationY;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[1] = animator;
                break;
            case transition_1.AndroidTransitionType.popEnter:
                objectAnimators = Array.create(android.animation.Animator, 3);
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setDuration(0);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = -rotationY;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[1] = animator;
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = 1.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[2] = animator;
                break;
            case transition_1.AndroidTransitionType.popExit:
                objectAnimators = Array.create(android.animation.Animator, 2);
                values = Array.create("float", 2);
                values[0] = 0.0;
                values[1] = rotationY;
                animator = android.animation.ObjectAnimator.ofFloat(null, "rotationY", values);
                animator.setInterpolator(interpolator);
                animator.setDuration(fullDuration);
                objectAnimators[0] = animator;
                values = Array.create("float", 2);
                values[0] = 1.0;
                values[1] = 0.0;
                animator = android.animation.ObjectAnimator.ofFloat(null, "alpha", values);
                animator.setStartDelay(fullDuration / 2);
                animator.setDuration(1);
                objectAnimators[1] = animator;
                break;
        }
        animatorSet.playTogether(objectAnimators);
        return animatorSet;
    };
    return FlipTransition;
}(transition_1.Transition));
exports.FlipTransition = FlipTransition;
//# sourceMappingURL=flip-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/slide-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var screenWidth = lazy_1.default(function () { return platform.screen.mainScreen.widthPixels; });
var screenHeight = lazy_1.default(function () { return platform.screen.mainScreen.heightPixels; });
var SlideTransition = (function (_super) {
    __extends(SlideTransition, _super);
    function SlideTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    SlideTransition.prototype.createAndroidAnimator = function (transitionType) {
        var translationValues = Array.create("float", 2);
        switch (this._direction) {
            case "left":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenWidth();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = -screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = screenWidth();
                        break;
                }
                break;
            case "right":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = -screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = screenWidth();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = screenWidth();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenWidth();
                        break;
                }
                break;
            case "top":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenHeight();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = -screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = screenHeight();
                        break;
                }
                break;
            case "bottom":
                switch (transitionType) {
                    case transition.AndroidTransitionType.enter:
                        translationValues[0] = -screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.exit:
                        translationValues[0] = 0;
                        translationValues[1] = screenHeight();
                        break;
                    case transition.AndroidTransitionType.popEnter:
                        translationValues[0] = screenHeight();
                        translationValues[1] = 0;
                        break;
                    case transition.AndroidTransitionType.popExit:
                        translationValues[0] = 0;
                        translationValues[1] = -screenHeight();
                        break;
                }
                break;
        }
        var prop;
        if (this._direction === "left" || this._direction === "right") {
            prop = "translationX";
        }
        else {
            prop = "translationY";
        }
        var animator = android.animation.ObjectAnimator.ofFloat(null, prop, translationValues);
        var duration = this.getDuration();
        if (duration !== undefined) {
            animator.setDuration(duration);
        }
        animator.setInterpolator(this.getCurve());
        return animator;
    };
    SlideTransition.prototype.toString = function () {
        return _super.prototype.toString.call(this) + " " + this._direction;
    };
    return SlideTransition;
}(transition.Transition));
exports.SlideTransition = SlideTransition;
//# sourceMappingURL=slide-transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var lazy_1 = __webpack_require__("../node_modules/tns-core-modules/utils/lazy.js");
var _defaultInterpolator = lazy_1.default(function () { return new android.view.animation.AccelerateDecelerateInterpolator(); });
var AndroidTransitionType;
(function (AndroidTransitionType) {
    AndroidTransitionType.enter = "enter";
    AndroidTransitionType.exit = "exit";
    AndroidTransitionType.popEnter = "popEnter";
    AndroidTransitionType.popExit = "popExit";
})(AndroidTransitionType = exports.AndroidTransitionType || (exports.AndroidTransitionType = {}));
var transitionId = 0;
var Transition = (function () {
    function Transition(duration, curve) {
        this._duration = duration;
        this._interpolator = curve ? animation_1._resolveAnimationCurve(curve) : _defaultInterpolator();
        this._id = transitionId++;
    }
    Transition.prototype.getDuration = function () {
        return this._duration;
    };
    Transition.prototype.getCurve = function () {
        return this._interpolator;
    };
    Transition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.createAndroidAnimator = function (transitionType) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.toString = function () {
        return "Transition@" + this._id;
    };
    return Transition;
}());
exports.Transition = Transition;
//# sourceMappingURL=transition.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
exports.File = file_system_1.File;
exports.knownFolders = file_system_1.knownFolders;
exports.path = file_system_1.path;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.srcProperty = new view_1.Property({ name: "src" });
var WebViewBase = (function (_super) {
    __extends(WebViewBase, _super);
    function WebViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebViewBase_1 = WebViewBase;
    WebViewBase.prototype._onLoadFinished = function (url, error) {
        var args = {
            eventName: WebViewBase_1.loadFinishedEvent,
            object: this,
            url: url,
            navigationType: undefined,
            error: error
        };
        this.notify(args);
    };
    WebViewBase.prototype._onLoadStarted = function (url, navigationType) {
        var args = {
            eventName: WebViewBase_1.loadStartedEvent,
            object: this,
            url: url,
            navigationType: navigationType,
            error: undefined
        };
        this.notify(args);
    };
    Object.defineProperty(WebViewBase.prototype, "canGoBack", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebViewBase.prototype, "canGoForward", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    WebViewBase.prototype[exports.srcProperty.getDefault] = function () {
        return "";
    };
    WebViewBase.prototype[exports.srcProperty.setNative] = function (src) {
        this.stopLoading();
        if (src.indexOf("~/") === 0) {
            src = "file:///" + file_system_1.knownFolders.currentApp().path + "/" + src.substr(2);
        }
        else if (src.indexOf("/") === 0) {
            src = "file://" + src;
        }
        if (src.toLowerCase().indexOf("file:///") === 0) {
            src = encodeURI(src);
        }
        if (src.toLowerCase().indexOf("http://") === 0 ||
            src.toLowerCase().indexOf("https://") === 0 ||
            src.toLowerCase().indexOf("file:///") === 0) {
            this._loadUrl(src);
        }
        else {
            this._loadData(src);
        }
    };
    var WebViewBase_1;
    WebViewBase.loadStartedEvent = "loadStarted";
    WebViewBase.loadFinishedEvent = "loadFinished";
    WebViewBase = WebViewBase_1 = __decorate([
        view_1.CSSType("WebView")
    ], WebViewBase);
    return WebViewBase;
}(view_1.ContainerView));
exports.WebViewBase = WebViewBase;
exports.srcProperty.register(WebViewBase);
//# sourceMappingURL=web-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var web_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js"));
var WebViewClient;
function initializeWebViewClient() {
    if (WebViewClient) {
        return;
    }
    var WebViewClientImpl = (function (_super) {
        __extends(WebViewClientImpl, _super);
        function WebViewClientImpl(owner) {
            var _this = _super.call(this) || this;
            _this.owner = owner;
            return global.__native(_this);
        }
        WebViewClientImpl.prototype.shouldOverrideUrlLoading = function (view, url) {
            if (web_view_common_1.traceEnabled()) {
                web_view_common_1.traceWrite("WebViewClientClass.shouldOverrideUrlLoading(" + url + ")", web_view_common_1.traceCategories.Debug);
            }
            return false;
        };
        WebViewClientImpl.prototype.onPageStarted = function (view, url, favicon) {
            _super.prototype.onPageStarted.call(this, view, url, favicon);
            var owner = this.owner;
            if (owner) {
                if (web_view_common_1.traceEnabled()) {
                    web_view_common_1.traceWrite("WebViewClientClass.onPageStarted(" + url + ", " + favicon + ")", web_view_common_1.traceCategories.Debug);
                }
                owner._onLoadStarted(url, undefined);
            }
        };
        WebViewClientImpl.prototype.onPageFinished = function (view, url) {
            _super.prototype.onPageFinished.call(this, view, url);
            var owner = this.owner;
            if (owner) {
                if (web_view_common_1.traceEnabled()) {
                    web_view_common_1.traceWrite("WebViewClientClass.onPageFinished(" + url + ")", web_view_common_1.traceCategories.Debug);
                }
                owner._onLoadFinished(url, undefined);
            }
        };
        WebViewClientImpl.prototype.onReceivedError = function () {
            var view = arguments[0];
            if (arguments.length === 4) {
                var errorCode = arguments[1];
                var description = arguments[2];
                var failingUrl = arguments[3];
                _super.prototype.onReceivedError.call(this, view, errorCode, description, failingUrl);
                var owner = this.owner;
                if (owner) {
                    if (web_view_common_1.traceEnabled()) {
                        web_view_common_1.traceWrite("WebViewClientClass.onReceivedError(" + errorCode + ", " + description + ", " + failingUrl + ")", web_view_common_1.traceCategories.Debug);
                    }
                    owner._onLoadFinished(failingUrl, description + "(" + errorCode + ")");
                }
            }
            else {
                var request = arguments[1];
                var error = arguments[2];
                _super.prototype.onReceivedError.call(this, view, request, error);
                var owner = this.owner;
                if (owner) {
                    if (web_view_common_1.traceEnabled()) {
                        web_view_common_1.traceWrite("WebViewClientClass.onReceivedError(" + error.getErrorCode() + ", " + error.getDescription() + ", " + (error.getUrl && error.getUrl()) + ")", web_view_common_1.traceCategories.Debug);
                    }
                    owner._onLoadFinished(error.getUrl && error.getUrl(), error.getDescription() + "(" + error.getErrorCode() + ")");
                }
            }
        };
        return WebViewClientImpl;
    }(android.webkit.WebViewClient));
    WebViewClient = WebViewClientImpl;
}
var WebView = (function (_super) {
    __extends(WebView, _super);
    function WebView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebView.prototype.createNativeView = function () {
        var nativeView = new android.webkit.WebView(this._context);
        nativeView.getSettings().setJavaScriptEnabled(true);
        nativeView.getSettings().setBuiltInZoomControls(true);
        return nativeView;
    };
    WebView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        initializeWebViewClient();
        var nativeView = this.nativeViewProtected;
        var client = new WebViewClient(this);
        nativeView.setWebViewClient(client);
        nativeView.client = client;
    };
    WebView.prototype.disposeNativeView = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.destroy();
        }
        nativeView.client.owner = null;
        _super.prototype.disposeNativeView.call(this);
    };
    WebView.prototype._loadUrl = function (src) {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        nativeView.loadUrl(src);
    };
    WebView.prototype._loadData = function (src) {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var baseUrl = "file:///" + web_view_common_1.knownFolders.currentApp().path + "/";
        nativeView.loadDataWithBaseURL(baseUrl, src, "text/html", "utf-8", null);
    };
    Object.defineProperty(WebView.prototype, "canGoBack", {
        get: function () {
            return this.nativeViewProtected.canGoBack();
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.stopLoading = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.stopLoading();
        }
    };
    Object.defineProperty(WebView.prototype, "canGoForward", {
        get: function () {
            var nativeView = this.nativeViewProtected;
            if (nativeView) {
                return nativeView.canGoForward();
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.goBack = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.goBack();
        }
    };
    WebView.prototype.goForward = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.goForward();
        }
    };
    WebView.prototype.reload = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            return nativeView.reload();
        }
    };
    return WebView;
}(web_view_common_1.WebViewBase));
exports.WebView = WebView;
//# sourceMappingURL=web-view.android.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/debug.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.debug = true;
var applicationRootPath;
function ensureAppRootPath() {
    if (!applicationRootPath) {
        applicationRootPath = file_system_1.knownFolders.currentApp().path;
        applicationRootPath = applicationRootPath.substr(0, applicationRootPath.length - "app/".length);
    }
}
var Source = (function () {
    function Source(uri, line, column) {
        ensureAppRootPath();
        if (uri.length > applicationRootPath.length && uri.substr(0, applicationRootPath.length) === applicationRootPath) {
            this._uri = "file://" + uri.substr(applicationRootPath.length);
        }
        else {
            this._uri = uri;
        }
        this._line = line;
        this._column = column;
    }
    Object.defineProperty(Source.prototype, "uri", {
        get: function () { return this._uri; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "line", {
        get: function () { return this._line; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "column", {
        get: function () { return this._column; },
        enumerable: true,
        configurable: true
    });
    Source.prototype.toString = function () {
        return this._uri + ":" + this._line + ":" + this._column;
    };
    Source.get = function (object) {
        return object[Source._source];
    };
    Source.set = function (object, src) {
        object[Source._source] = src;
    };
    Source._source = Symbol("source");
    return Source;
}());
exports.Source = Source;
var ScopeError = (function (_super) {
    __extends(ScopeError, _super);
    function ScopeError(inner, message) {
        var _this = this;
        var formattedMessage;
        if (message && inner.message) {
            formattedMessage = message + "\n > " + inner.message.replace("\n", "\n  ");
        }
        else {
            formattedMessage = message || inner.message || undefined;
        }
        _this = _super.call(this, formattedMessage) || this;
        _this.stack = platform_1.isAndroid ? "Error: " + _this.message + "\n" + inner.stack.substr(inner.stack.indexOf("\n") + 1) : inner.stack;
        _this.message = formattedMessage;
        return _this;
    }
    return ScopeError;
}(Error));
exports.ScopeError = ScopeError;
var SourceError = (function (_super) {
    __extends(SourceError, _super);
    function SourceError(child, source, message) {
        return _super.call(this, child, message ? message + " @" + source + "" : source + "") || this;
    }
    return SourceError;
}(ScopeError));
exports.SourceError = SourceError;
//# sourceMappingURL=debug.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/lazy.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
exports.default = lazy;
//# sourceMappingURL=lazy.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/mainthread-helper.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function dispatchToMainThread(func) {
    new android.os.Handler(android.os.Looper.getMainLooper())
        .post(new java.lang.Runnable({
        run: func
    }));
}
exports.dispatchToMainThread = dispatchToMainThread;
function isMainThread() {
    return android.os.Looper.myLooper() === android.os.Looper.getMainLooper();
}
exports.isMainThread = isMainThread;
//# sourceMappingURL=mainthread-helper.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/number-utils.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var epsilon = 1E-05;
function areClose(value1, value2) {
    return (Math.abs(value1 - value2) < epsilon);
}
exports.areClose = areClose;
function greaterThanOrClose(value1, value2) {
    return (value1 > value2) || areClose(value1, value2);
}
exports.greaterThanOrClose = greaterThanOrClose;
function greaterThan(value1, value2) {
    return (value1 > value2) && !areClose(value1, value2);
}
exports.greaterThan = greaterThan;
function lessThan(value1, value2) {
    return (value1 < value2) && !areClose(value1, value2);
}
exports.lessThan = lessThan;
function isZero(value) {
    return (Math.abs(value) < epsilon);
}
exports.isZero = isZero;
function greaterThanZero(value) {
    return value > 0;
}
exports.greaterThanZero = greaterThanZero;
function notNegative(value) {
    return value >= 0;
}
exports.notNegative = notNegative;
exports.radiansToDegrees = function (a) { return a * (180 / Math.PI); };
exports.degreesToRadians = function (a) { return a * (Math.PI / 180); };
//# sourceMappingURL=number-utils.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/types.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function isString(value) {
    return typeof value === "string" || value instanceof String;
}
exports.isString = isString;
function isNumber(value) {
    return typeof value === "number" || value instanceof Number;
}
exports.isNumber = isNumber;
function isBoolean(value) {
    return typeof value === "boolean" || value instanceof Boolean;
}
exports.isBoolean = isBoolean;
function isFunction(value) {
    if (!value) {
        return false;
    }
    return typeof value === "function";
}
exports.isFunction = isFunction;
function isObject(value) {
    if (!value) {
        return false;
    }
    return typeof value === "object";
}
exports.isObject = isObject;
function isUndefined(value) {
    return value === undefined;
}
exports.isUndefined = isUndefined;
function isDefined(value) {
    return typeof value !== "undefined";
}
exports.isDefined = isDefined;
function isNullOrUndefined(value) {
    return value === undefined || value === null;
}
exports.isNullOrUndefined = isNullOrUndefined;
function verifyCallback(value) {
    if (value && !isFunction(value)) {
        throw new TypeError("Callback must be a valid function.");
    }
}
exports.verifyCallback = verifyCallback;
var classInfosMap = new Map();
var funcNameRegex = /function ([_a-zA-Z0-9]{1,})\(/;
function getClass(object) {
    return getClassInfo(object).name;
}
exports.getClass = getClass;
function getClassInfo(object) {
    var constructor = object.constructor;
    var result = classInfosMap.get(constructor);
    if (!result) {
        result = new ClassInfo(constructor);
        classInfosMap.set(constructor, result);
    }
    return result;
}
exports.getClassInfo = getClassInfo;
function getBaseClasses(object) {
    var result = [];
    var info = getClassInfo(object);
    while (info) {
        result.push(info.name);
        info = info.baseClassInfo;
    }
    return result;
}
exports.getBaseClasses = getBaseClasses;
var ClassInfo = (function () {
    function ClassInfo(typeCosntructor) {
        this._typeCosntructor = typeCosntructor;
    }
    Object.defineProperty(ClassInfo.prototype, "name", {
        get: function () {
            if (!this._name) {
                var results = (funcNameRegex).exec(this._typeCosntructor.toString());
                this._name = (results && results.length > 1) ? results[1] : "";
            }
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClassInfo.prototype, "baseClassInfo", {
        get: function () {
            if (isUndefined(this._baseClassInfo)) {
                this._baseClassInfo = ClassInfo._getBase(this);
                if (this._baseClassInfo && this._baseClassInfo.name === this.name) {
                    this._baseClassInfo = ClassInfo._getBase(this._baseClassInfo);
                }
            }
            return this._baseClassInfo;
        },
        enumerable: true,
        configurable: true
    });
    ClassInfo._getBase = function (info) {
        var result = null;
        var constructorProto = info._typeCosntructor.prototype;
        if (constructorProto.__proto__) {
            result = getClassInfo(constructorProto.__proto__);
        }
        return result;
    };
    return ClassInfo;
}());
exports.ClassInfo = ClassInfo;
function toUIString(obj) {
    return isNullOrUndefined(obj) ? "" : obj + "";
}
exports.toUIString = toUIString;
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var mainthread_helper_1 = __webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js"));
exports.RESOURCE_PREFIX = "res://";
exports.FILE_PREFIX = "file:///";
function escapeRegexSymbols(source) {
    var escapeRegex = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;
    return source.replace(escapeRegex, "\\$&");
}
exports.escapeRegexSymbols = escapeRegexSymbols;
function convertString(value) {
    var result;
    if (!types.isString(value) || value.trim() === "") {
        result = value;
    }
    else {
        var valueAsNumber = +value;
        if (!isNaN(valueAsNumber)) {
            result = valueAsNumber;
        }
        else if (value && (value.toLowerCase() === "true" || value.toLowerCase() === "false")) {
            result = value.toLowerCase() === "true" ? true : false;
        }
        else {
            result = value;
        }
    }
    return result;
}
exports.convertString = convertString;
function getModuleName(path) {
    var moduleName = path.replace("./", "");
    return module_name_sanitizer_1.sanitizeModuleName(moduleName);
}
exports.getModuleName = getModuleName;
var layoutCommon;
(function (layoutCommon) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    layoutCommon.UNSPECIFIED = 0 << MODE_SHIFT;
    layoutCommon.EXACTLY = 1 << MODE_SHIFT;
    layoutCommon.AT_MOST = 2 << MODE_SHIFT;
    layoutCommon.MEASURED_HEIGHT_STATE_SHIFT = 0x00000010;
    layoutCommon.MEASURED_STATE_TOO_SMALL = 0x01000000;
    layoutCommon.MEASURED_STATE_MASK = 0xff000000;
    layoutCommon.MEASURED_SIZE_MASK = 0x00ffffff;
    function getMode(mode) {
        switch (mode) {
            case layoutCommon.EXACTLY:
                return "Exact";
            case layoutCommon.AT_MOST:
                return "AtMost";
            default:
                return "Unspecified";
        }
    }
    layoutCommon.getMode = getMode;
    function getMeasureSpecMode(spec) {
        return (spec & MODE_MASK);
    }
    layoutCommon.getMeasureSpecMode = getMeasureSpecMode;
    function getMeasureSpecSize(spec) {
        return (spec & ~MODE_MASK);
    }
    layoutCommon.getMeasureSpecSize = getMeasureSpecSize;
    function measureSpecToString(measureSpec) {
        var mode = getMeasureSpecMode(measureSpec);
        var size = getMeasureSpecSize(measureSpec);
        var text = "MeasureSpec: ";
        if (mode === layoutCommon.UNSPECIFIED) {
            text += "UNSPECIFIED ";
        }
        else if (mode === layoutCommon.EXACTLY) {
            text += "EXACTLY ";
        }
        else if (mode === layoutCommon.AT_MOST) {
            text += "AT_MOST ";
        }
        text += size;
        return text;
    }
    layoutCommon.measureSpecToString = measureSpecToString;
    function round(value) {
        var res = Math.floor(value + 0.5);
        if (res !== 0) {
            return res;
        }
        else if (value === 0) {
            return 0;
        }
        else if (value > 0) {
            return 1;
        }
        return -1;
    }
    layoutCommon.round = round;
})(layoutCommon = exports.layoutCommon || (exports.layoutCommon = {}));
function isFileOrResourcePath(path) {
    if (!types.isString(path)) {
        return false;
    }
    return path.indexOf("~/") === 0 ||
        path.indexOf("/") === 0 ||
        path.indexOf(exports.RESOURCE_PREFIX) === 0;
}
exports.isFileOrResourcePath = isFileOrResourcePath;
function isFontIconURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split("//")[0];
    return firstSegment && firstSegment.indexOf("font:") === 0;
}
exports.isFontIconURI = isFontIconURI;
function isDataURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split(",")[0];
    return firstSegment && firstSegment.indexOf("data:") === 0 && firstSegment.indexOf("base64") >= 0;
}
exports.isDataURI = isDataURI;
function mergeSort(arr, compareFunc) {
    if (arr.length < 2) {
        return arr;
    }
    var middle = arr.length / 2;
    var left = arr.slice(0, middle);
    var right = arr.slice(middle, arr.length);
    return merge(mergeSort(left, compareFunc), mergeSort(right, compareFunc), compareFunc);
}
exports.mergeSort = mergeSort;
function merge(left, right, compareFunc) {
    var result = [];
    while (left.length && right.length) {
        if (compareFunc(left[0], right[0]) <= 0) {
            result.push(left.shift());
        }
        else {
            result.push(right.shift());
        }
    }
    while (left.length) {
        result.push(left.shift());
    }
    while (right.length) {
        result.push(right.shift());
    }
    return result;
}
exports.merge = merge;
function hasDuplicates(arr) {
    return arr.length !== eliminateDuplicates(arr).length;
}
exports.hasDuplicates = hasDuplicates;
function eliminateDuplicates(arr) {
    return Array.from(new Set(arr));
}
exports.eliminateDuplicates = eliminateDuplicates;
function executeOnMainThread(func) {
    if (mainthread_helper_1.isMainThread()) {
        return func();
    }
    else {
        mainthread_helper_1.dispatchToMainThread(func);
    }
}
exports.executeOnMainThread = executeOnMainThread;
function mainThreadify(func) {
    return function () {
        var _this = this;
        var argsToPass = arguments;
        executeOnMainThread(function () { return func.apply(_this, argsToPass); });
    };
}
exports.mainThreadify = mainThreadify;
//# sourceMappingURL=utils-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js"));
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var MIN_URI_SHARE_RESTRICTED_APK_VERSION = 24;
var layout;
(function (layout) {
    var density;
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    var sdkVersion;
    var useOldMeasureSpec = false;
    function makeMeasureSpec(size, mode) {
        if (sdkVersion === undefined) {
            sdkVersion = ad.getApplicationContext().getApplicationInfo().targetSdkVersion;
            useOldMeasureSpec = sdkVersion <= android.os.Build.VERSION_CODES.JELLY_BEAN_MR1;
        }
        if (useOldMeasureSpec) {
            return size + mode;
        }
        return (size & ~MODE_MASK) | (mode & MODE_MASK);
    }
    layout.makeMeasureSpec = makeMeasureSpec;
    function getDisplayDensity() {
        if (density === undefined) {
            density = ad.getResources().getDisplayMetrics().density;
        }
        return density;
    }
    layout.getDisplayDensity = getDisplayDensity;
    function toDevicePixels(value) {
        return value * getDisplayDensity();
    }
    layout.toDevicePixels = toDevicePixels;
    function toDeviceIndependentPixels(value) {
        return value / getDisplayDensity();
    }
    layout.toDeviceIndependentPixels = toDeviceIndependentPixels;
    function measureNativeView(nativeView, width, widthMode, height, heightMode) {
        var view = nativeView;
        view.measure(makeMeasureSpec(width, widthMode), makeMeasureSpec(height, heightMode));
        return {
            width: view.getMeasuredWidth(),
            height: view.getMeasuredHeight()
        };
    }
    layout.measureNativeView = measureNativeView;
})(layout = exports.layout || (exports.layout = {}));
Object.assign(layout, utils_common_1.layoutCommon);
var ad;
(function (ad) {
    var application;
    var applicationContext;
    var contextResources;
    var packageName;
    function getApplicationContext() {
        if (!applicationContext) {
            applicationContext = getApplication().getApplicationContext();
        }
        return applicationContext;
    }
    ad.getApplicationContext = getApplicationContext;
    function getApplication() {
        if (!application) {
            application = application_1.getNativeApplication();
        }
        return application;
    }
    ad.getApplication = getApplication;
    function getResources() {
        if (!contextResources) {
            contextResources = getApplication().getResources();
        }
        return contextResources;
    }
    ad.getResources = getResources;
    function getPackageName() {
        if (!packageName) {
            packageName = getApplicationContext().getPackageName();
        }
        return packageName;
    }
    var inputMethodManager;
    function getInputMethodManager() {
        if (!inputMethodManager) {
            inputMethodManager = getApplicationContext().getSystemService(android.content.Context.INPUT_METHOD_SERVICE);
        }
        return inputMethodManager;
    }
    ad.getInputMethodManager = getInputMethodManager;
    function showSoftInput(nativeView) {
        var inputManager = getInputMethodManager();
        if (inputManager && nativeView instanceof android.view.View) {
            inputManager.showSoftInput(nativeView, android.view.inputmethod.InputMethodManager.SHOW_IMPLICIT);
        }
    }
    ad.showSoftInput = showSoftInput;
    function dismissSoftInput(nativeView) {
        var inputManager = getInputMethodManager();
        var windowToken;
        if (nativeView instanceof android.view.View) {
            windowToken = nativeView.getWindowToken();
        }
        else if (application_1.android.foregroundActivity instanceof androidx.appcompat.app.AppCompatActivity) {
            var decorView = application_1.android.foregroundActivity.getWindow().getDecorView();
            windowToken = decorView ? decorView.getWindowToken() : null;
        }
        if (inputManager && windowToken) {
            inputManager.hideSoftInputFromWindow(windowToken, 0);
        }
    }
    ad.dismissSoftInput = dismissSoftInput;
    var collections;
    (function (collections) {
        function stringArrayToStringSet(str) {
            var hashSet = new java.util.HashSet();
            if (str !== undefined) {
                for (var element in str) {
                    hashSet.add("" + str[element]);
                }
            }
            return hashSet;
        }
        collections.stringArrayToStringSet = stringArrayToStringSet;
        function stringSetToStringArray(stringSet) {
            var arr = [];
            if (stringSet !== undefined) {
                var it_1 = stringSet.iterator();
                while (it_1.hasNext()) {
                    var element = "" + it_1.next();
                    arr.push(element);
                }
            }
            return arr;
        }
        collections.stringSetToStringArray = stringSetToStringArray;
    })(collections = ad.collections || (ad.collections = {}));
    var resources;
    (function (resources_1) {
        var attr;
        var attrCache = new Map();
        function getDrawableId(name) {
            return getId(":drawable/" + name);
        }
        resources_1.getDrawableId = getDrawableId;
        function getStringId(name) {
            return getId(":string/" + name);
        }
        resources_1.getStringId = getStringId;
        function getId(name) {
            var resources = getResources();
            var packageName = getPackageName();
            var uri = packageName + name;
            return resources.getIdentifier(uri, null, null);
        }
        resources_1.getId = getId;
        function getPalleteColor(name, context) {
            return getPaletteColor(name, context);
        }
        resources_1.getPalleteColor = getPalleteColor;
        function getPaletteColor(name, context) {
            if (attrCache.has(name)) {
                return attrCache.get(name);
            }
            var result = 0;
            try {
                if (!attr) {
                    attr = java.lang.Class.forName("androidx.appcompat.R$attr");
                }
                var colorID = 0;
                var field = attr.getField(name);
                if (field) {
                    colorID = field.getInt(null);
                }
                if (colorID) {
                    var typedValue = new android.util.TypedValue();
                    context.getTheme().resolveAttribute(colorID, typedValue, true);
                    result = typedValue.data;
                }
            }
            catch (ex) {
                trace_1.write("Cannot get pallete color: " + name, trace_1.categories.Error, trace_1.messageType.error);
            }
            attrCache.set(name, result);
            return result;
        }
        resources_1.getPaletteColor = getPaletteColor;
    })(resources = ad.resources || (ad.resources = {}));
})(ad = exports.ad || (exports.ad = {}));
function GC() {
    gc();
}
exports.GC = GC;
function releaseNativeObject(object) {
    __releaseNativeCounterpart(object);
}
exports.releaseNativeObject = releaseNativeObject;
function openUrl(location) {
    var context = ad.getApplicationContext();
    try {
        var intent = new android.content.Intent(android.content.Intent.ACTION_VIEW, android.net.Uri.parse(location.trim()));
        intent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        context.startActivity(intent);
    }
    catch (e) {
        trace_1.write("Error in OpenURL", trace_1.categories.Error, trace_1.messageType.error);
        return false;
    }
    return true;
}
exports.openUrl = openUrl;
function isExternalStorageReadOnly() {
    var extStorageState = android.os.Environment.getExternalStorageState();
    if (android.os.Environment.MEDIA_MOUNTED_READ_ONLY === extStorageState) {
        return true;
    }
    return false;
}
function isExternalStorageAvailable() {
    var extStorageState = android.os.Environment.getExternalStorageState();
    if (android.os.Environment.MEDIA_MOUNTED === extStorageState) {
        return true;
    }
    return false;
}
function getMimeTypeNameFromExtension(filePath) {
    var mimeTypeMap = android.webkit.MimeTypeMap.getSingleton();
    var extension = new file_system_access_1.FileSystemAccess()
        .getFileExtension(filePath)
        .replace(".", "")
        .toLowerCase();
    return mimeTypeMap.getMimeTypeFromExtension(extension);
}
function openFile(filePath) {
    var context = ad.getApplicationContext();
    try {
        if (!isExternalStorageAvailable()) {
            trace_1.write("\nExternal storage is unavailable (please check app permissions).\nApplications cannot access internal storage of other application on Android (see: https://developer.android.com/guide/topics/data/data-storage).\n", trace_1.categories.Error, trace_1.messageType.error);
            return false;
        }
        if (isExternalStorageReadOnly()) {
            trace_1.write("External storage is read only", trace_1.categories.Error, trace_1.messageType.error);
            return false;
        }
        var mimeType = getMimeTypeNameFromExtension(filePath);
        var intent = new android.content.Intent(android.content.Intent.ACTION_VIEW);
        var chooserIntent = android.content.Intent.createChooser(intent, "Open File...");
        intent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        chooserIntent.addFlags(android.content.Intent.FLAG_ACTIVITY_NEW_TASK);
        var sdkVersion = parseInt(platform_1.device.sdkVersion, 10);
        if (sdkVersion && sdkVersion < MIN_URI_SHARE_RESTRICTED_APK_VERSION) {
            trace_1.write("detected sdk version " + sdkVersion + " (< " + MIN_URI_SHARE_RESTRICTED_APK_VERSION + "), using simple openFile", trace_1.categories.Debug);
            intent.setDataAndType(android.net.Uri.fromFile(new java.io.File(filePath)), mimeType);
            context.startActivity(chooserIntent);
            return true;
        }
        trace_1.write("detected sdk version " + sdkVersion + " (>= " + MIN_URI_SHARE_RESTRICTED_APK_VERSION + "), using URI openFile", trace_1.categories.Debug);
        var providerName = context.getPackageName() + ".provider";
        trace_1.write("fully-qualified provider name [" + providerName + "]", trace_1.categories.Debug);
        var apkURI = androidx.core.content.FileProvider.getUriForFile(context, providerName, new java.io.File(filePath));
        intent.addFlags(android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION);
        chooserIntent.addFlags(android.content.Intent.FLAG_GRANT_READ_URI_PERMISSION);
        intent.setDataAndType(apkURI, mimeType);
        context.startActivity(chooserIntent);
        return true;
    }
    catch (err) {
        var msg_1 = err.message ? ": " + err.message : "";
        trace_1.write("Error in openFile" + msg_1, trace_1.categories.Error, trace_1.messageType.error);
        if (msg_1 &&
            msg_1.includes("Attempt to invoke virtual method") &&
            msg_1.includes("android.content.pm.ProviderInfo.loadXmlMetaData") &&
            msg_1.includes("on a null object reference")) {
            trace_1.write("\nPlease ensure you have your manifest correctly configured with the FileProvider.\n(see: https://developer.android.com/reference/android/support/v4/content/FileProvider#ProviderDefinition)\n", trace_1.categories.Error);
        }
        return false;
    }
}
exports.openFile = openFile;
//# sourceMappingURL=utils.android.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xhr/xhr.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var XMLHttpRequestResponseType;
(function (XMLHttpRequestResponseType) {
    XMLHttpRequestResponseType.empty = "";
    XMLHttpRequestResponseType.text = "text";
    XMLHttpRequestResponseType.json = "json";
})(XMLHttpRequestResponseType || (XMLHttpRequestResponseType = {}));
var XMLHttpRequest = (function () {
    function XMLHttpRequest() {
        this.UNSENT = 0;
        this.OPENED = 1;
        this.HEADERS_RECEIVED = 2;
        this.LOADING = 3;
        this.DONE = 4;
        this._responseType = "";
        this.textTypes = [
            "text/plain",
            "application/xml",
            "application/rss+xml",
            "text/html",
            "text/xml"
        ];
        this._listeners = new Map();
        this._readyState = this.UNSENT;
    }
    XMLHttpRequest.prototype.open = function (method, url, async, user, password) {
        if (types.isString(method) && types.isString(url)) {
            this._options = { url: url, method: method };
            this._options.headers = {};
            if (types.isString(user)) {
                this._options.headers["user"] = user;
            }
            if (types.isString(password)) {
                this._options.headers["password"] = password;
            }
            this._setReadyState(this.OPENED);
        }
    };
    XMLHttpRequest.prototype.abort = function () {
        this._errorFlag = true;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._readyState === this.DONE) {
            this._readyState = this.UNSENT;
        }
        else {
            this._setReadyState(this.DONE);
        }
    };
    XMLHttpRequest.prototype.send = function (data) {
        var _this = this;
        this._errorFlag = false;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (types.isDefined(this._options)) {
            if (types.isString(data) && this._options.method !== "GET") {
                this._options.content = data;
            }
            else if (data instanceof FormData) {
                this._options.content = data.toString();
            }
            http.request(this._options).then(function (r) {
                if (!_this._errorFlag) {
                    _this._loadResponse(r);
                }
            }).catch(function (e) {
                _this._errorFlag = true;
                _this._setReadyState(_this.DONE, e);
            });
        }
    };
    XMLHttpRequest.prototype._loadResponse = function (r) {
        this._status = r.statusCode;
        this._response = r.content.raw + "";
        this._headers = r.headers;
        this._setReadyState(this.HEADERS_RECEIVED);
        this._setReadyState(this.LOADING);
        this._setResponseType();
        this._responseTextReader = function () { return r.content.toString(); };
        this._addToStringOnResponse();
        if (this.responseType === XMLHttpRequestResponseType.json) {
            this._response = JSON.parse(this.responseText);
        }
        else if (this.responseType === XMLHttpRequestResponseType.text) {
            this._response = this.responseText;
        }
        this._setReadyState(this.DONE);
    };
    XMLHttpRequest.prototype._addToStringOnResponse = function () {
        var _this = this;
        if (types.isObject(this.response)) {
            Object.defineProperty(this._response, "toString", {
                configurable: true,
                enumerable: false,
                writable: true,
                value: function () { return _this.responseText; }
            });
        }
    };
    XMLHttpRequest.prototype.isTextContentType = function (contentType) {
        var result = false;
        for (var i = 0; i < this.textTypes.length; i++) {
            if (contentType.toLowerCase().indexOf(this.textTypes[i]) >= 0) {
                result = true;
                break;
            }
        }
        return result;
    };
    XMLHttpRequest.prototype._setResponseType = function () {
        var header = this.getResponseHeader("Content-Type");
        var contentType = header && header.toLowerCase();
        if (contentType) {
            if (contentType.indexOf("application/json") >= 0 || contentType.indexOf("+json") >= 0) {
                this.responseType = XMLHttpRequestResponseType.json;
            }
            else if (this.isTextContentType(contentType)) {
                this.responseType = XMLHttpRequestResponseType.text;
            }
        }
        else {
            this.responseType = XMLHttpRequestResponseType.text;
        }
    };
    XMLHttpRequest.prototype.addEventListener = function (eventName, handler) {
        if (eventName !== "load" && eventName !== "error" && eventName !== "progress") {
            throw new Error("Event not supported: " + eventName);
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.push(handler);
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.removeEventListener = function (eventName, toDetach) {
        var handlers = this._listeners.get(eventName) || [];
        handlers = handlers.filter(function (handler) { return handler !== toDetach; });
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.emitEvent = function (eventName) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.forEach(function (handler) {
            handler.apply(void 0, args);
        });
    };
    XMLHttpRequest.prototype.setRequestHeader = function (header, value) {
        if (types.isDefined(this._options) && types.isString(header) && types.isString(value)) {
            this._options.headers[header] = value;
        }
    };
    XMLHttpRequest.prototype.getAllResponseHeaders = function () {
        if (this._readyState < 2 || this._errorFlag) {
            return "";
        }
        var result = "";
        for (var i in this._headers) {
            result += i + ": " + this._headers[i] + "\r\n";
        }
        return result.substr(0, result.length - 2);
    };
    XMLHttpRequest.prototype.getResponseHeader = function (header) {
        if (types.isString(header) && this._readyState > 1
            && this._headers
            && !this._errorFlag) {
            header = header.toLowerCase();
            for (var i in this._headers) {
                if (i.toLowerCase() === header) {
                    return this._headers[i];
                }
            }
        }
        return null;
    };
    XMLHttpRequest.prototype.overrideMimeType = function (mime) {
    };
    Object.defineProperty(XMLHttpRequest.prototype, "readyState", {
        get: function () {
            return this._readyState;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "responseType", {
        get: function () {
            return this._responseType;
        },
        set: function (value) {
            if (value === XMLHttpRequestResponseType.empty || value in XMLHttpRequestResponseType) {
                this._responseType = value;
            }
            else {
                throw new Error("Response type of '" + value + "' not supported.");
            }
        },
        enumerable: true,
        configurable: true
    });
    XMLHttpRequest.prototype._setReadyState = function (value, error) {
        if (this._readyState !== value) {
            this._readyState = value;
            if (types.isFunction(this.onreadystatechange)) {
                this.onreadystatechange();
            }
        }
        if (this._readyState === this.DONE) {
            if (this._errorFlag) {
                if (types.isFunction(this.onerror)) {
                    this.onerror(error);
                }
                this.emitEvent("error", error);
            }
            else {
                if (types.isFunction(this.onload)) {
                    this.onload();
                }
                this.emitEvent("load");
            }
        }
    };
    Object.defineProperty(XMLHttpRequest.prototype, "responseText", {
        get: function () {
            if (types.isFunction(this._responseTextReader)) {
                return this._responseTextReader();
            }
            return "";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "response", {
        get: function () {
            return this._response;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "statusText", {
        get: function () {
            if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._errorFlag) {
                return "";
            }
            return statuses[this._status];
        },
        enumerable: true,
        configurable: true
    });
    return XMLHttpRequest;
}());
exports.XMLHttpRequest = XMLHttpRequest;
var statuses = {
    100: "Continue",
    101: "Switching Protocols",
    200: "OK",
    201: "Created",
    202: "Accepted",
    203: "Non - Authoritative Information",
    204: "No Content",
    205: "Reset Content",
    206: "Partial Content",
    300: "Multiple Choices",
    301: "Moved Permanently",
    302: "Found",
    303: "See Other",
    304: "Not Modified",
    305: "Use Proxy",
    307: "Temporary Redirect",
    400: "Bad Request",
    401: "Unauthorized",
    402: "Payment Required",
    403: "Forbidden",
    404: "Not Found",
    405: "Method Not Allowed",
    406: "Not Acceptable",
    407: "Proxy Authentication Required",
    408: "Request Timeout",
    409: "Conflict",
    410: "Gone",
    411: "Length Required",
    412: "Precondition Failed",
    413: "Request Entity Too Large",
    414: "Request - URI Too Long",
    415: "Unsupported Media Type",
    416: "Requested Range Not Satisfiable",
    417: "Expectation Failed",
    500: "Internal Server Error",
    501: "Not Implemented",
    502: "Bad Gateway",
    503: "Service Unavailable",
    504: "Gateway Timeout",
    505: "HTTP Version Not Supported"
};
var FormData = (function () {
    function FormData() {
        this._data = new Map();
    }
    FormData.prototype.append = function (name, value) {
        this._data.set(name, value);
    };
    FormData.prototype.toString = function () {
        var arr = new Array();
        this._data.forEach(function (value, name, map) {
            arr.push(encodeURIComponent(name) + "=" + encodeURIComponent(value));
        });
        return arr.join("&");
    };
    return FormData;
}());
exports.FormData = FormData;
//# sourceMappingURL=xhr.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xml/xml.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var easysax = __webpack_require__("../node_modules/tns-core-modules/js-libs/easysax/easysax.js");
var ParserEventType = (function () {
    function ParserEventType() {
    }
    ParserEventType.StartElement = "StartElement";
    ParserEventType.EndElement = "EndElement";
    ParserEventType.Text = "Text";
    ParserEventType.CDATA = "CDATA";
    ParserEventType.Comment = "Comment";
    return ParserEventType;
}());
exports.ParserEventType = ParserEventType;
var ParserEvent = (function () {
    function ParserEvent(eventType, position, prefix, namespace, elementName, attributes, data) {
        this._eventType = eventType;
        this._position = position;
        this._prefix = prefix;
        this._namespace = namespace;
        this._elementName = elementName;
        this._attributes = attributes;
        this._data = data;
    }
    ParserEvent.prototype.toString = function () {
        return JSON.stringify({
            eventType: this.eventType,
            position: this.position,
            prefix: this.prefix,
            namespace: this.namespace,
            elementName: this.elementName,
            attributes: this.attributes,
            data: this.data
        });
    };
    Object.defineProperty(ParserEvent.prototype, "eventType", {
        get: function () {
            return this._eventType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "position", {
        get: function () {
            return this._position;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "prefix", {
        get: function () {
            return this._prefix;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "namespace", {
        get: function () {
            return this._namespace;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "elementName", {
        get: function () {
            return this._elementName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "attributes", {
        get: function () {
            return this._attributes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "data", {
        get: function () {
            return this._data;
        },
        enumerable: true,
        configurable: true
    });
    return ParserEvent;
}());
exports.ParserEvent = ParserEvent;
var _ampCodes;
var _entitySearchRegEx = /&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig;
function _generateAmpMap() {
    var objCodes = { Tab: 9, NewLine: 10, excl: 33, quot: 34, QUOT: 34, num: 35, dollar: 36, percent: 37, amp: 38, AMP: 38, apos: 39, lpar: 40, rpar: 41, ast: 42, midast: 42, plus: 43, comma: 44, period: 46, sol: 47, colon: 58, semi: 59, lt: 60, LT: 60, equals: 61, gt: 62, GT: 62, quest: 63, commat: 64, lsqb: 91, lbrack: 91, bsol: 92, rsqb: 92, rbrack: 92, Hat: 94, lowbar: 95, grave: 96, DiacriticalGrave: 96, lcub: 123, lbrace: 123, verbar: 124, vert: 124, VerticalLine: 124, rcub: 125, rbrace: 125, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, brkbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, hibar: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Dstrok: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, fnof: 402, imped: 437, gacute: 501, jmath: 567, circ: 710, caron: 711, Hacek: 711, breve: 728, Breve: 728, dot: 729, DiacriticalDot: 729, ring: 730, ogon: 731, tilde: 732, DiacriticalTilde: 732, dblac: 733, DiacriticalDoubleAcute: 733, DownBreve: 785, UnderBar: 818, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, epsiv: 949, varepsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigmav: 962, varsigma: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetav: 977, vartheta: 977, thetasym: 977, Upsi: 978, upsih: 978, straightphi: 981, piv: 982, varpi: 982, Gammad: 988, gammad: 989, digamma: 989, kappav: 1008, varkappa: 1008, rhov: 1009, varrho: 1009, epsi: 1013, straightepsilon: 1013, bepsi: 1014, backepsilon: 1014, euro: 8364, trade: 8482, TRADE: 8482, forall: 8704, part: 8706, larr: 8592, rarr: 8593, hyphen: 8208, dash: 8208, ndash: 8211, mdash: 8212, horbar: 8213, Vert: 8214, Verbar: 8214, lsquo: 8216, OpenCurlyQuote: 8216, rsquo: 8217, rsquor: 8217, CloseCurlyQuote: 8217, lsquor: 8218, sbquo: 8218, ldquo: 8220, OpenCurlyDoubleQuote: 8220, rdquo: 8221, rdquor: 8221, CloseCurlyDoubleQuote: 8221, ldquor: 8222, bdquo: 8222, dagger: 8224, Dagger: 8225, ddagger: 8225, bull: 8226, bullet: 8226, nldr: 8229, hellip: 8230, mldr: 8230, hybull: 8259, tdot: 8411, TripleDot: 8411, DotDot: 8412, star: 9734, phone: 9742, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830, female: 9792, male: 9794, check: 10003, checkmark: 10003, cross: 10007, VerticalSeparator: 10072, EmptySmallSquare: 9723, FilledSmallSquare: 9724, starf: 9733, bigstar: 9733, square: 9633, squ: 9633, Square: 9633 };
    var ampCodes = new Map();
    for (var key in objCodes) {
        if (objCodes.hasOwnProperty(key)) {
            ampCodes.set(key, objCodes[key]);
        }
    }
    return ampCodes;
}
if (global.__snapshot) {
    _ampCodes = _generateAmpMap();
}
function _HandleAmpEntities(found, decimalValue, hexValue, wordValue) {
    if (wordValue) {
        if (!_ampCodes) {
            _ampCodes = _generateAmpMap();
        }
        var res = _ampCodes.get(wordValue);
        if (res) {
            return String.fromCodePoint(res);
        }
        return found;
    }
    if (decimalValue) {
        return String.fromCodePoint(parseInt(decimalValue, 10));
    }
    return String.fromCodePoint(parseInt(hexValue, 16));
}
var XmlParser = (function () {
    function XmlParser(onEvent, onError, processNamespaces) {
        this._processNamespaces = processNamespaces;
        this._parser = new easysax.EasySAXParser();
        var that = this;
        this._parser.on("startNode", function (elem, attr, uq, tagend, str, pos) {
            var attributes = attr();
            if (attributes === true) {
                attributes = undefined;
            }
            if (attributes) {
                for (var key in attributes) {
                    if (attributes.hasOwnProperty(key)) {
                        attributes[key] = XmlParser._dereferenceEntities(attributes[key]);
                    }
                }
            }
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var stackEntry = XmlParser._getNamespacesStackEntry(attributes);
                that._namespaceStack.push(stackEntry);
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.StartElement, pos(), prefix, namespace, name, attributes, undefined));
        });
        this._parser.on("textNode", function (text, uq, pos) {
            var data = uq(XmlParser._dereferenceEntities(text));
            onEvent(new ParserEvent(ParserEventType.Text, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("endNode", function (elem, uq, tagstart, str, pos) {
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.EndElement, pos(), prefix, namespace, name, undefined, undefined));
            if (that._processNamespaces) {
                that._namespaceStack.pop();
            }
        });
        this._parser.on("cdata", function (data, res, pos) {
            onEvent(new ParserEvent(ParserEventType.CDATA, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("comment", function (text, uq, pos) {
            onEvent(new ParserEvent(ParserEventType.Comment, pos(), undefined, undefined, undefined, undefined, text));
        });
        if (onError) {
            this._parser.on("error", function (msg, pos) {
                onError(new Error(msg), pos());
            });
        }
    }
    Object.defineProperty(XmlParser.prototype, "angularSyntax", {
        get: function () {
            return this._parser.angularSyntax;
        },
        set: function (value) {
            this._parser.angularSyntax = value;
        },
        enumerable: true,
        configurable: true
    });
    XmlParser.prototype.parse = function (xmlString) {
        if (this._processNamespaces) {
            this._namespaceStack = [];
        }
        this._parser.parse(xmlString);
    };
    XmlParser._getNamespacesStackEntry = function (attributes) {
        var stackEntry = {};
        if (!attributes) {
            return stackEntry;
        }
        var attributeName;
        var namespacePrefix;
        for (var key in attributes) {
            if (!attributes.hasOwnProperty(key)) {
                continue;
            }
            attributeName = key;
            if (attributeName.indexOf("xmlns") !== 0) {
                continue;
            }
            namespacePrefix = "";
            if (attributeName.indexOf(":") !== -1) {
                namespacePrefix = attributeName.split(":")[1];
            }
            stackEntry[namespacePrefix] = attributes[key];
        }
        return stackEntry;
    };
    XmlParser.prototype._resolveNamespace = function (fullName) {
        var result = { prefix: undefined, namespace: undefined, name: undefined };
        result.prefix = "";
        if (fullName.indexOf(":") !== -1) {
            var split = fullName.split(":");
            result.prefix = split[0];
            result.name = split[1];
        }
        else {
            result.name = fullName;
        }
        var stackEntry;
        for (var i = this._namespaceStack.length - 1; i >= 0; i--) {
            stackEntry = this._namespaceStack[i];
            for (var key in stackEntry) {
                if (!stackEntry.hasOwnProperty(key)) {
                    continue;
                }
                if (result.prefix === key) {
                    result.namespace = stackEntry[key];
                    return result;
                }
            }
        }
        return result;
    };
    XmlParser._dereferenceEntities = function (s) {
        s = String(s);
        if (s.length > 3 && s.indexOf("&") !== -1) {
            s = s.replace(_entitySearchRegEx, _HandleAmpEntities);
        }
        return s;
    };
    return XmlParser;
}());
exports.XmlParser = XmlParser;
//# sourceMappingURL=xml.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tslib/tslib.es6.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "../node_modules/webpack/buildin/global.js":
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC10aGVtZS1jb3JlL2Nzcy9jb3JlLmxpZ2h0LmNzcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy11bml0LWNvbnZlcnRlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9obXIvaG1yLXVwZGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9obXIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svaG90LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2xvYWQtYXBwbGljYXRpb24tY3NzLXJlZ3VsYXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svbG9hZC1hcHBsaWNhdGlvbi1jc3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLXZhbHVlLXBhcnNlci9saWIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLXZhbHVlLXBhcnNlci9saWIvcGFyc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLXZhbHVlLXBhcnNlci9saWIvc3RyaW5naWZ5LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvcG9zdGNzcy12YWx1ZS1wYXJzZXIvbGliL3VuaXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9wb3N0Y3NzLXZhbHVlLXBhcnNlci9saWIvd2Fsay5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3JlZHVjZS1jc3MtY2FsYy9kaXN0L2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvcmVkdWNlLWNzcy1jYWxjL2Rpc3QvbGliL2NvbnZlcnQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9yZWR1Y2UtY3NzLWNhbGMvZGlzdC9saWIvcmVkdWNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3JlZHVjZS1jc3MtY2FsYy9kaXN0L2xpYi9zdHJpbmdpZmllci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3JlZHVjZS1jc3MtY2FsYy9kaXN0L3BhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYnVuZGxlLWVudHJ5LXBvaW50cy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3IvY29sb3ItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jb2xvci9jb2xvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3Iva25vd24tY29sb3JzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jc3MtdmFsdWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL2xpYi9wYXJzZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL3BhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL3N5c3RlbS1jbGFzc2VzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kYXRhL29ic2VydmFibGUtYXJyYXkvb2JzZXJ2YWJsZS1hcnJheS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGF0YS9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RlYnVnZ2VyL2RlYnVnZ2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci9kZXZ0b29scy1lbGVtZW50cy5jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RlYnVnZ2VyL2RldnRvb2xzLWVsZW1lbnRzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci9kb20tbm9kZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZmV0Y2gvZmV0Y2guanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZpbGUtc3lzdGVtL2ZpbGUtc3lzdGVtLWFjY2Vzcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZmlsZS1zeXN0ZW0vZmlsZS1zeXN0ZW0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvY29yZS9nbG9iYWxzLWNvcmUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvZGVjb3JhdG9ycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZ2xvYmFscy9nbG9iYWxzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3BvbHlmaWxscy9kaWFsb2dzL2RpYWxvZ3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvcG9seWZpbGxzL2ZldGNoL2ZldGNoLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL3BvbHlmaWxscy9wb2x5ZmlsbC1oZWxwZXJzL3BvbHlmaWxsLWhlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvcG9seWZpbGxzL3RpbWVycy90aW1lcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvcG9seWZpbGxzL3hoci94aHIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvcmVnaXN0ZXItbW9kdWxlLWhlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvdHMtaGVscGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaHR0cC9odHRwLXJlcXVlc3QvaHR0cC1yZXF1ZXN0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaHR0cC9odHRwLXJlcXVlc3QvaHR0cC1yZXF1ZXN0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9odHRwL2h0dHAuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ltYWdlLWFzc2V0L2ltYWdlLWFzc2V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaW1hZ2UtYXNzZXQvaW1hZ2UtYXNzZXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ltYWdlLXNvdXJjZS9pbWFnZS1zb3VyY2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2pzLWxpYnMvZWFzeXNheC9lYXN5c2F4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL2VzcHJpbWEvZXNwcmltYS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvanMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zL3BhdGgtcGFyc2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL3BvbHltZXItZXhwcmVzc2lvbnMvcG9seW1lci1leHByZXNzaW9ucy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbWF0cml4L21hdHJpeC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbW9kdWxlLW5hbWUtcmVzb2x2ZXIvbW9kdWxlLW5hbWUtcmVzb2x2ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL21vZHVsZS1uYW1lLXJlc29sdmVyL25vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9tb2R1bGUtbmFtZS1yZXNvbHZlci9xdWFsaWZpZXItbWF0Y2hlci9xdWFsaWZpZXItbWF0Y2hlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvcGxhdGZvcm0vcGxhdGZvcm0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3Byb2ZpbGluZy9wcm9maWxpbmcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RleHQvZm9ybWF0dGVkLXN0cmluZy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdGV4dC9zcGFuLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90ZXh0L3RleHQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RpbWVyL3RpbWVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90cmFjZS90cmFjZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aW9uLWJhci9hY3Rpb24tYmFyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aW9uLWJhci9hY3Rpb24tYmFyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9hY3Rpdml0eS1pbmRpY2F0b3IvYWN0aXZpdHktaW5kaWNhdG9yLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aXZpdHktaW5kaWNhdG9yL2FjdGl2aXR5LWluZGljYXRvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYW5pbWF0aW9uL2FuaW1hdGlvbi1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2JvcmRlci9ib3JkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2JvdHRvbS1uYXZpZ2F0aW9uL2JvdHRvbS1uYXZpZ2F0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL2JpbmRpbmctYnVpbGRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnVpbGRlci9idWlsZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL2NvbXBvbmVudC1idWlsZGVyL2NvbXBvbmVudC1idWlsZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL21vZHVsZS1uYW1lLXNhbml0aXplci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnV0dG9uL2J1dHRvbi1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1dHRvbi9idXR0b24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvbnRlbnQtdmlldy9jb250ZW50LXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvYmluZGFibGUvYmluZGFibGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvcHJvcGVydGllcy9wcm9wZXJ0aWVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3ZpZXctYmFzZS92aWV3LWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvdmlldy92aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS92aWV3L3ZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvd2Vhay1ldmVudC1saXN0ZW5lci93ZWFrLWV2ZW50LWxpc3RlbmVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2RhdGUtcGlja2VyL2RhdGUtcGlja2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kaWFsb2dzL2RpYWxvZ3MtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kaWFsb2dzL2RpYWxvZ3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2VkaXRhYmxlLXRleHQtYmFzZS9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9lZGl0YWJsZS10ZXh0LWJhc2UvZWRpdGFibGUtdGV4dC1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9lbnVtcy9lbnVtcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvYWN0aXZpdHkuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2ZyYWdtZW50LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9mcmFtZS9mcmFnbWVudC50cmFuc2l0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9mcmFtZS9mcmFtZS1zdGFjay5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2dlc3R1cmVzL2dlc3R1cmVzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZ2VzdHVyZXMvZ2VzdHVyZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2h0bWwtdmlldy9odG1sLXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9odG1sLXZpZXcvaHRtbC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9pbWFnZS9pbWFnZS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ltYWdlL2ltYWdlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYWJlbC9sYWJlbC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9hYnNvbHV0ZS1sYXlvdXQvYWJzb2x1dGUtbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9hYnNvbHV0ZS1sYXlvdXQvYWJzb2x1dGUtbGF5b3V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2RvY2stbGF5b3V0L2RvY2stbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9kb2NrLWxheW91dC9kb2NrLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9mbGV4Ym94LWxheW91dC9mbGV4Ym94LWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZmxleGJveC1sYXlvdXQvZmxleGJveC1sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZ3JpZC1sYXlvdXQvZ3JpZC1sYXlvdXQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2dyaWQtbGF5b3V0L2dyaWQtbGF5b3V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2xheW91dC1iYXNlLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9sYXlvdXQtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9zdGFjay1sYXlvdXQvc3RhY2stbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9zdGFjay1sYXlvdXQvc3RhY2stbGF5b3V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL3dyYXAtbGF5b3V0L3dyYXAtbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy93cmFwLWxheW91dC93cmFwLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGlzdC1waWNrZXIvbGlzdC1waWNrZXItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9saXN0LXBpY2tlci9saXN0LXBpY2tlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGlzdC12aWV3L2xpc3Qtdmlldy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xpc3Qtdmlldy9saXN0LXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3BhZ2UvcGFnZS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3BhZ2UvcGFnZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvcGxhY2Vob2xkZXIvcGxhY2Vob2xkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Byb2dyZXNzL3Byb2dyZXNzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvcHJvZ3Jlc3MvcHJvZ3Jlc3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Byb3h5LXZpZXctY29udGFpbmVyL3Byb3h5LXZpZXctY29udGFpbmVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9yZXBlYXRlci9yZXBlYXRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2Nyb2xsLXZpZXcvc2Nyb2xsLXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zY3JvbGwtdmlldy9zY3JvbGwtdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VhcmNoLWJhci9zZWFyY2gtYmFyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VhcmNoLWJhci9zZWFyY2gtYmFyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zZWdtZW50ZWQtYmFyL3NlZ21lbnRlZC1iYXItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zZWdtZW50ZWQtYmFyL3NlZ21lbnRlZC1iYXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3NsaWRlci9zbGlkZXItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zbGlkZXIvc2xpZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2JhY2tncm91bmQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2JhY2tncm91bmQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY29udmVydGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9jc3MtYW5pbWF0aW9uLXBhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9jc3Mtc2VsZWN0b3IvY3NzLXNlbGVjdG9yLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2ZvbnQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2ZvbnQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvbGluZWFyLWdyYWRpZW50LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUtc2NvcGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUvc3R5bGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N3aXRjaC9zd2l0Y2gtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zd2l0Y2gvc3dpdGNoLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW0vdGFiLWNvbnRlbnQtaXRlbS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbS90YWItY29udGVudC1pdGVtLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbS90YWItc3RyaXAtaXRlbS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAvdGFiLXN0cmlwLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItdmlldy90YWItdmlldy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi12aWV3L3RhYi12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWJzL3RhYnMtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWJzL3RhYnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RleHQtYmFzZS90ZXh0LWJhc2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWJhc2UvdGV4dC1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWZpZWxkL3RleHQtZmllbGQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWZpZWxkL3RleHQtZmllbGQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RleHQtdmlldy90ZXh0LXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RpbWUtcGlja2VyL3RpbWUtcGlja2VyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGltZS1waWNrZXIvdGltZS1waWNrZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RyYW5zaXRpb24vZmFkZS10cmFuc2l0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL2ZsaXAtdHJhbnNpdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdHJhbnNpdGlvbi9zbGlkZS10cmFuc2l0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL3RyYW5zaXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3dlYi12aWV3L3dlYi12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvd2ViLXZpZXcvd2ViLXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL2RlYnVnLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy9sYXp5LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy9tYWludGhyZWFkLWhlbHBlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvbnVtYmVyLXV0aWxzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy90eXBlcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvdXRpbHMtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMveGhyL3hoci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMveG1sL3htbC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9nbG9iYWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSwyQkFBMkIsbUJBQU8sQ0FBQyxnREFBc0M7QUFDekU7QUFDQSxjQUFjLFFBQVMsb1BBQW9QLFdBQVcsWUFBWSxzQkFBc0IsU0FBUyxXQUFXLFlBQVksc0JBQXNCLFFBQVEsY0FBYyxXQUFXLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsWUFBWSxjQUFjLGVBQWUseUJBQXlCLFNBQVMsY0FBYyxZQUFZLHlCQUF5QixVQUFVLGNBQWMsYUFBYSx5QkFBeUIsUUFBUSxjQUFjLFdBQVcseUJBQXlCLGNBQWMsY0FBYyxpQkFBaUIseUJBQXlCLGFBQWEsY0FBYyxnQkFBZ0IseUJBQXlCLFVBQVUsY0FBYyxhQUFhLHlCQUF5QixTQUFTLGNBQWMsWUFBWSx5QkFBeUIsUUFBUSxjQUFjLFdBQVcseUJBQXlCLFVBQVUsY0FBYyxhQUFhLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsT0FBTyxjQUFjLFVBQVUseUJBQXlCLFFBQVEsV0FBVyxPQUFPLFVBQVUsUUFBUSxZQUFZLE9BQU8sV0FBVyxLQUFLLFNBQVMsT0FBTyxhQUFhLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixPQUFPLGNBQWMsT0FBTyxlQUFlLGNBQWMsT0FBTyxhQUFhLGdCQUFnQixLQUFLLFNBQVMsT0FBTyxhQUFhLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixPQUFPLGNBQWMsT0FBTyxlQUFlLGNBQWMsT0FBTyxhQUFhLGdCQUFnQixLQUFLLFNBQVMsT0FBTyxhQUFhLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixPQUFPLGNBQWMsT0FBTyxlQUFlLGNBQWMsT0FBTyxhQUFhLGdCQUFnQixLQUFLLFNBQVMsT0FBTyxhQUFhLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixPQUFPLGNBQWMsT0FBTyxlQUFlLGNBQWMsT0FBTyxhQUFhLGdCQUFnQixLQUFLLFNBQVMsT0FBTyxhQUFhLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixPQUFPLGNBQWMsT0FBTyxlQUFlLGNBQWMsT0FBTyxhQUFhLGdCQUFnQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsS0FBSyxVQUFVLE9BQU8sY0FBYyxPQUFPLGdCQUFnQixPQUFPLGlCQUFpQixPQUFPLGVBQWUsT0FBTyxnQkFBZ0IsZUFBZSxPQUFPLGNBQWMsaUJBQWlCLEtBQUssVUFBVSxPQUFPLGNBQWMsT0FBTyxnQkFBZ0IsT0FBTyxpQkFBaUIsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLGVBQWUsT0FBTyxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsS0FBSyxVQUFVLE9BQU8sY0FBYyxPQUFPLGdCQUFnQixPQUFPLGlCQUFpQixPQUFPLGVBQWUsT0FBTyxnQkFBZ0IsZUFBZSxPQUFPLGNBQWMsaUJBQWlCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFR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QUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG1CQUFtQixtQkFBTyxDQUFDLGtEQUFROztBQUVuQzs7QUFFQTs7QUFFQTs7Ozs7Ozs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnQkFBZ0I7QUFDaEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7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aUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwrQkFBK0IsRUFBRTtBQUNqQztBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLGNBQWM7QUFDZDs7QUFFQTtBQUNBOztBQUVBLDhCQUE4QixrQkFBa0I7QUFDaEQ7O0FBRUE7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLGdDQUFnQzs7QUFFaEMsZ0NBQWdDOztBQUVoQztBQUNBLGVBQWU7Ozs7OztBQU1mOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUEsbUNBQW1DO0FBQ25DO0FBQ0Esa0VBQWtFLE1BQU07QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGdFQUFnRTs7QUFFaEU7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsUUFBUTtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXVJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OztBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWU7QUFDZjtBQUNBLDZCQUE2Qjs7QUFFN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBOzs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsc0NBQXNDOztBQUV0QztBQUNBOzs7OztBQUtBOzs7OztBQUtBOztBQUVBO0FBQ0E7Ozs7QUFJQSxrRUFBa0U7QUFDbEU7Ozs7Ozs7Ozs7O0FBV0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FBVUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsU0FBUyxTQUFTO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsNERBQTREO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5QkFBeUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwrQkFBK0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsY0FBYztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsa0JBQWtCOztBQUVsQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQSx5SkFBeUo7QUFDeko7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCOztBQUUxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxRQUFRO0FBQzNEOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQ0FBMkMsU0FBUztBQUNwRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsaUNBQWlDO0FBQ2pGOztBQUVBLHlCQUF5QixTQUFTO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUztBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQ7QUFDMUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw2QkFBNkIscUI7QUFDN0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQiwwQkFBMEI7QUFDN0MsU0FBUztBQUNULG1CQUFtQiw4Q0FBOEM7QUFDakU7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7O0FBRVg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHNFQUFzRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHFCQUFxQjtBQUNyQixPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNKQUFzSjtBQUN0SjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EscUJBQXFCLFVBQVU7QUFDL0I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLHVCQUF1QjtBQUN2QixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7Ozs7QUNqS0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7QUNoSEEsZ0JBQWdCLG1CQUFPLENBQUMseURBQWE7Ozs7Ozs7O0FDQXJDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CO0FBQ3BCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxzRUFBc0U7O0FBRXRFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLGNBQWM7O0FBRWQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSx5Q0FBeUM7QUFDekM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwQ0FBMEM7QUFDMUM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG9EQUFvRDs7QUFFcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFEQUFxRDs7QUFFckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1DQUFtQzs7QUFFbkM7QUFDQTs7QUFFQSxtREFBbUQ7O0FBRW5EOztBQUVBLG9EQUFvRDs7QUFFcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFL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QUNuQjtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsK0VBQStFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLEtBQUs7QUFDbkI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyw4QkFBOEIsRUFBRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsMkNBQTJDLEVBQUU7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixvQ0FBb0M7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHVDQUF1Qyx3REFBd0Q7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHdEQUF3RDtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esa0M7Ozs7Ozs7QUM1dkNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDOzs7Ozs7O0FDNUJBLDhDQUE4QyxjQUFjO0FBQzVELGlCQUFpQixtQkFBTyxDQUFDLGdFQUFlO0FBQ3hDLFlBQVksbUJBQU8sQ0FBQyxpREFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsT0FBTztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELE9BQU87QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixRQUFRO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0Qzs7Ozs7OztBQ2hNQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbURBQW1EO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxPQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxxREFBcUQsRUFBRTtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsMkJBQTJCLEVBQUU7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxxQkFBcUIsRUFBRTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esb0M7Ozs7Ozs7QUM3TEE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCLG1CQUFPLENBQUMsNkNBQUs7QUFDL0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViLFNBQVM7QUFDVDtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEsQ0FBQyxJOzs7Ozs7OztBQy9VRCw4Q0FBOEMsY0FBYztBQUM1RCxpQkFBaUIsbUJBQU8sQ0FBQywrQ0FBUztBQUNsQyxvQkFBb0IsbUJBQU8sQ0FBQyw2REFBZ0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QiwyREFBMkQ7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixrQ0FBa0M7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw2REFBNkQ7QUFDMUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHFDQUFxQztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDZEQUE2RDtBQUMxRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixjQUFjO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGtCQUFrQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esc0Q7Ozs7Ozs7QUM3WEEsOENBQThDLGNBQWM7QUFDNUQsMkJBQTJCLG1CQUFPLENBQUMsb0VBQXNCO0FBQ3pELGtCQUFrQixtQkFBTyxDQUFDLHlEQUFjO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG1CQUFPLENBQUMsdURBQWE7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLHlDQUF5QztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQSx1QkFBdUIsY0FBYztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEOzs7Ozs7OztBQzdOQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFD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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUM3d0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0NBQXNDO0FBQ3RDOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7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Q0E7QUFDQSxTQUFTO0FBQ1QseUJBQXlCO0FBQ3pCLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsdUJBQXVCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnQ0FBZ0M7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsdUJBQXVCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDOzs7Ozs7O0FDMUhBLDhDQUE4QyxjQUFjO0FBQzVELGdCQUFnQixtQkFBTyxDQUFDLDZEQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzRUFBc0U7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxpREFBaUQ7QUFDbEQ7QUFDQTtBQUNBLDRDOzs7Ozs7O0FDakxBLDRGQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixVQUFVO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixVQUFVO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhDQUE4QztBQUMvQztBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1CQUFPLENBQUMsZ0JBQWdCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrQkFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsc0RBQXNEO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELCtEQUErRDtBQUMzSDtBQUNBLDRDQUE0Qyw4REFBOEQ7QUFDMUc7QUFDQSw0Q0FBNEMsNENBQTRDO0FBQ3hGO0FBQ0Esa0RBQWtELGlGQUFpRjtBQUNuSTtBQUNBLDRDQUE0Qyw2RUFBNkU7QUFDekg7QUFDQSw2Qzs7Ozs7OztBQ3ZUQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCwwQkFBMEIsbUJBQU8sQ0FBQyxxRUFBcUI7QUFDdkQsY0FBYyxtQkFBTyxDQUFDLGlEQUFtQjtBQUN6QyxxQkFBcUIsbUJBQU8sQ0FBQywrREFBb0I7QUFDakQsa0JBQWtCLG1CQUFPLENBQUMsNkRBQW1CO0FBQzdDLFNBQVMsbUJBQU8sQ0FBQyxxRUFBcUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrQkFBa0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsa0JBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDRCQUE0QjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLG9EQUFvRCxXQUFXO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDOzs7Ozs7OztBQ2hiQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCxhQUFhLG1CQUFPLENBQUMsdURBQWM7QUFDbkMsU0FBUyxtQkFBTyxDQUFDLHVEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsNENBQTRDLDZFQUE2RTtBQUN6SDtBQUNBLHFEOzs7Ozs7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGtDQUFrQyxtQkFBTyxDQUFDLHFGQUE2QjtBQUN2RSxTQUFTLG1CQUFPLENBQUMscUZBQTZCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esc0Q7Ozs7Ozs7QUN6REEsOENBQThDLGNBQWM7QUFDNUQsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DO0FBQ0EsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLG1CQUFPLENBQUMsaUVBQTZCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsY0FBYztBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDRDOzs7Ozs7O0FDcE9BO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELHlCQUF5QixtQkFBTyxDQUFDLG1FQUFvQjtBQUNyRCx5QkFBeUIsbUJBQU8sQ0FBQyxpRUFBNkI7QUFDOUQsY0FBYyxtQkFBTyxDQUFDLGlEQUFtQjtBQUN6QyxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBZ0I7QUFDekMsYUFBYSxtQkFBTyxDQUFDLGdEQUFrQjtBQUN2QyxTQUFTLG1CQUFPLENBQUMsbUVBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyw2REFBNkQsRUFBRTtBQUN4RywwQ0FBMEMsNkRBQTZELEVBQUU7QUFDekcsNENBQTRDLHNFQUFzRSxFQUFFO0FBQ3BILHlDQUF5Qyx3REFBd0QsRUFBRTtBQUNuRyx5Q0FBeUMsd0RBQXdELEVBQUU7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxjQUFjO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxjQUFjO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxZQUFZLEVBQUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELFlBQVksRUFBRTtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSw4Q0FBOEMsd0NBQXdDO0FBQ2hLO0FBQ0E7QUFDQSw0RUFBNEUsMENBQTBDLHdDQUF3QztBQUM5SjtBQUNBO0FBQ0EseUVBQXlFLDBDQUEwQyw4Q0FBOEM7QUFDaks7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pC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QUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSx1QkFBdUIsRUFBRTtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVFQUF1RSxnQkFBZ0I7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLG1DQUFtQztBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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O0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0JBQXdCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxzQkFBc0I7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qiw4Q0FBOEM7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxjQUFjO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHNCQUFzQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsaUJBQWlCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELDBCQUEwQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix5QkFBeUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxvQzs7Ozs7Ozs7QUNuZkEsOENBQThDLGNBQWM7QUFDNUQsb0JBQW9CLG1CQUFPLENBQUMsK0NBQWlCO0FBQzdDLG1CQUFtQixtQkFBTyxDQUFDLGdFQUEwQjtBQUNyRCxjQUFjLG1CQUFPLENBQUMsaURBQWdCO0FBQ3RDLGNBQWMsbUJBQU8sQ0FBQyw0REFBcUI7QUFDM0M7QUFDQSxrQkFBa0IsbUJBQU8sQ0FBQyx5REFBb0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx1QkFBdUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdDQUFnQyxFQUFFO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0dBQW9HO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDRCQUE0QixFQUFFLGdCQUFnQixxQkFBcUIsRUFBRTtBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG1HQUFtRztBQUN4STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsZ0JB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsc0JBQXNCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrQ0FBa0M7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtDQUFrQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSx5QkFBeUIsRUFBRTtBQUN0RztBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsMkJBQTJCLEVBQUU7QUFDMUc7QUFDQTtBQUNBLHFCQUFxQiw2Q0FBNkM7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwwQ0FBMEM7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLCtCQUErQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtB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QUNBO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLG1CQUFtQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDRCQUE0QjtBQUM3RixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHVCQUF1QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHNCQUFzQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsaUJBQWlCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1PQUFtTztBQUNuTztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Qsa0NBQWtDLEVBQUU7QUFDNUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsOEJBQThCO0FBQ3JFLHdDQUF3QyxrQkFBa0I7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwyREFBMkQseUJBQXlCO0FBQ3BGO0FBQ0Esb0RBQW9ELG1FQUFtRSxzQkFBc0IsRUFBRSxFQUFFO0FBQ2pKO0FBQ0Esb0RBQW9ELG1FQUFtRSxzQkFBc0IsRUFBRSxFQUFFO0FBQ2pKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxxRUFBcUUscUdBQXFHO0FBQzFLO0FBQ0EsZ0VBQWdFLGlHQUFpRztBQUNqSztBQUNBLGdGQUFnRix1R0FBdUc7QUFDdkw7QUFDQSx1Qzs7Ozs7OztBQ2xuQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsb0JBQW9CLG1CQUFPLENBQUMsOERBQWU7QUFDM0MseUJBQXlCLG1CQUFPLENBQUMsaUVBQWdDO0FBQ2pFLG1CQUFtQixtQkFBTyxDQUFDLDJEQUEwQjtBQUNyRCxrQkFBa0IsbUJBQU8sQ0FBQyx5REFBb0I7QUFDOUMsb0JBQW9CLG1CQUFPLENBQUMsMERBQXlCO0FBQ3JELG9CQUFvQixtQkFBTyxDQUFDLDZEQUFzQjtBQUNsRCxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBbUI7QUFDNUMsYUFBYSxtQkFBTyxDQUFDLGdEQUFxQjtBQUMxQyxTQUFTLG1CQUFPLENBQUMsOERBQWU7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QywrQ0FBK0MsRUFBRTtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLHdDQUF3QyxFQUFFO0FBQ2xGLDBDQUEwQywyQkFBMkI7QUFDckU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QStDLEVBQUU7QUFDOUYsK0NBQStDLDZDQUE2QyxFQUFFO0FBQzlGLHNEQUFzRCxzRUFBc0UsRUFBRTtBQUM5SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwRUFBMEUsRUFBRTtBQUNoSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsdUJBQXVCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QywrQkFBK0IsRUFBRTtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCx3RDs7Ozs7Ozs7QUNwbkJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELG9CQUFvQixtQkFBTyxDQUFDLDhEQUEwQjtBQUN0RCxhQUFhLG1CQUFPLENBQUMsdURBQWM7QUFDbkMsZ0JBQWdCLG1CQUFPLENBQUMsd0RBQVk7QUFDcEMsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDLG9CQUFvQixtQkFBTyxDQUFDLDBEQUFlO0FBQzNDLDhCQUE4QixtQkFBTyxDQUFDLHNFQUFrQztBQUN4RSxTQUFTLG1CQUFPLENBQUMsdURBQWM7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMseUVBQXlFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSw4QkFBOEIsRUFBRTtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCw4QkFBOEIsRUFBRTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsMENBQTBDLEVBQUU7QUFDdkc7QUFDQSxrRkFBa0YsZ0RBQWdELEVBQUU7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtGQUErRjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdHQUFnRztBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSwwQkFBMEI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCw0QkFBNEI7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELGdDQUFnQztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsMkRBQTJELG9DQUFvQyxFQUFFO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBLENBQUM7QUFDRDtBQUNBLDJEQUEyRCxpRkFBaUY7QUFDNUk7QUFDQSx3Qzs7Ozs7OztBQzNrQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDOzs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGtCQUFrQixtQkFBTyxDQUFDLDZEQUFtQjtBQUM3QyxxQkFBcUIsbUJBQU8sQ0FBQywyREFBZ0I7QUFDN0MsNkJBQTZCLG1CQUFPLENBQUMsbUVBQXdCO0FBQzdELGdCQUFnQixtQkFBTyxDQUFDLHdEQUFZO0FBQ3BDLHVCQUF1QixtQkFBTyxDQUFDLHdEQUEwQjtBQUN6RCxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBeUI7QUFDbEQsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDLFNBQVMsbUJBQU8sQ0FBQywyREFBZ0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtQkFBTyxDQUFDLGdFQUFrQztBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsUUFBUTtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHdCQUF3QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxtQkFBTyxDQUFDLHVEQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0U7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RkFBdUY7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCwwQ0FBMEMsRUFBRTtBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrQ0FBK0M7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsK0NBQStDO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxRQUFRO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCwyQkFBMkIsRUFBRTtB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QUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsY0FBYztBQUNwRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGlFQUFpRSwrQkFBK0I7QUFDaEcsQ0FBQztBQUNEO0FBQ0EseURBQXlELDBIQUEwSCw0QkFBNEIsRUFBRSxFQUFFO0FBQ25OO0FBQ0EsNEM7Ozs7Ozs7QUM5TEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQseUJBQXlCLG1CQUFPLENBQUMsbUVBQW9CO0FBQ3JELHFCQUFxQixtQkFBTyxDQUFDLDBFQUF5QjtBQUN0RCw2QkFBNkIsbUJBQU8sQ0FBQyxrRkFBeUI7QUFDOUQsb0JBQW9CLG1CQUFPLENBQUMsNERBQXdCO0FBQ3BELGtCQUFrQixtQkFBTyxDQUFDLHlEQUFpQjtBQUMzQyxTQUFTLG1CQUFPLENBQUMsbUVBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw4REFBOEQ7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQ0FBK0M7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQzs7Ozs7OztBQ2xNQSw4Q0FBOEMsY0FBYztBQUM1RCxjQUFjLG1CQUFPLENBQUMsaURBQWdCO0FBQ3RDLGFBQWEsbUJBQU8sQ0FBQyx1REFBaUI7QUFDdEMsa0JBQWtCLG1CQUFPLENBQUMsNERBQWlCO0FBQzNDO0FBQ0Esc0RBQXNELCtGQUErRiw2QkFBNkIsRUFBRSxFQUFFO0FBQ3RMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGdDQUFnQyxFQUFFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0REFBNEQsMERBQTBEO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EscUM7Ozs7Ozs7QUM3R0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsYUFBYSxtQkFBTyxDQUFDLHVEQUFjO0FBQ25DLFNBQVMsbUJBQU8sQ0FBQyx1REFBYztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVFQUF1RSxnQkFBZ0I7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLGVBQWU7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwRUFBMEU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHVCQUF1QixFQUFFO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUUsZ0JBQWdCO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGtGQUFrRjtBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsZUFBZTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRUFBMkUsdUJBQXVCLEVBQUU7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGdCQUFnQjtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxtQ0FBbUM7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0M7Ozs7Ozs7O0FDOWxCQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCxhQUFhLG1CQUFPLENBQUMsdURBQWM7QUFDbkMseUJBQXlCLG1CQUFPLENBQUMsMkRBQTZCO0FBQzlEO0FBQ0E7QUFDQSxTQUFTLG1CQUFPLENBQUMsdURBQWM7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNU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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLCtDOzs7Ozs7OztBQ3pGQSw4Q0FBOEMsY0FBYztBQUM1RCxtQkFBbUIsbUJBQU8sQ0FBQyw4REFBYztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG1EOzs7Ozs7O0FDaENBLDhDQUE4QyxjQUFjO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLDhEQUFjO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDdEMsMkJBQTJCLG1CQUFPLENBQUMsb0VBQW1DO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxpREFBaUQ7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLHNEQUFzRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxnREFBZ0Q7QUFDckQsQ0FBQyxxQ0FBcUM7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUM7Ozs7Ozs7QUM3UkEsOENBQThDLGNBQWM7QUFDNUQsV0FBVyxtQkFBTyxDQUFDLCtDQUFTO0FBQzVCLFlBQVksbUJBQU8sQ0FBQyxpREFBZ0I7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0VBQWdFO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCw2QkFBNkI7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsMkJBQTJCO0FBQy9ELGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwyQkFBMkI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCw2QkFBNkIsRUFBRTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLCtCOzs7Ozs7O0FDblVBLDRGQUE4QyxjQUFjO0FBQzVELGNBQWMsbUJBQU8sQ0FBQyw2REFBb0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0Esa0NBQWtDLDBCQUEwQixRQUFRO0FBQ3BFO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7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QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQSxpQkFBaUIsc0ZBQXNGLGFBQWEsRUFBRTtBQUN0SCxzQkFBc0IsZ0NBQWdDLHFDQUFxQywwQ0FBMEMsRUFBRSxFQUFFLEdBQUc7QUFDNUksMkJBQTJCLE1BQU0sZUFBZSxFQUFFLFlBQVksb0JBQW9CLEVBQUU7QUFDcEYsc0JBQXNCLG9HQUFvRztBQUMxSCw2QkFBNkIsdUJBQXVCO0FBQ3BELDRCQUE0Qix3QkFBd0I7QUFDcEQsMkJBQTJCLHlEQUF5RDtBQUNwRjs7QUFFTztBQUNQO0FBQ0EsaUJBQWlCLDRDQUE0QyxTQUFTLEVBQUUscURBQXFELGFBQWEsRUFBRTtBQUM1SSx5QkFBeUIsNkJBQTZCLG9CQUFvQixnREFBZ0QsZ0JBQWdCLEVBQUUsS0FBSztBQUNqSjs7QUFFTztBQUNQO0FBQ0E7QUFDQSwyR0FBMkcsc0ZBQXNGLGFBQWEsRUFBRTtBQUNoTixzQkFBc0IsOEJBQThCLGdEQUFnRCx1REFBdUQsRUFBRSxFQUFFLEdBQUc7QUFDbEssNENBQTRDLHNDQUFzQyxVQUFVLG9CQUFvQixFQUFFLEVBQUUsVUFBVTtBQUM5SDs7QUFFTztBQUNQLGdDQUFnQyx1Q0FBdUMsYUFBYSxFQUFFLEVBQUUsT0FBTyxrQkFBa0I7QUFDakg7QUFDQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFTztBQUNQLDRDQUE0QztBQUM1Qzs7Ozs7Ozs7QUNuTUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw0Q0FBNEM7O0FBRTVDIiwiZmlsZSI6InZlbmRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIikoZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKiFcXHJcXG4gKiBOYXRpdmVTY3JpcHQgVGhlbWUgdjEuMC42IChodHRwczovL25hdGl2ZXNjcmlwdC5vcmcpXFxyXFxuICogQ29weXJpZ2h0IDIwMTYtMjAxNiBUaGUgVGhlbWUgQXV0aG9yc1xcclxcbiAqIENvcHlyaWdodCAyMDE2LTIwMTYgVGVsZXJpa1xcclxcbiAqIExpY2Vuc2VkIHVuZGVyIE1JVCAoaHR0cHM6Ly9naXRodWIuY29tL05hdGl2ZVNjcmlwdC90aGVtZS9ibG9iL21hc3Rlci9MSUNFTlNFKVxcclxcbiAqLy5jLXdoaXRle2NvbG9yOiNmZmZ9LmMtYmctd2hpdGV7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5jLWJsYWNre2NvbG9yOiMwMDB9LmMtYmctYmxhY2t7YmFja2dyb3VuZC1jb2xvcjojMDAwfS5jLWFxdWF7Y29sb3I6IzAwY2FhYn0uYy1iZy1hcXVhe2JhY2tncm91bmQtY29sb3I6IzAwY2FhYn0uYy1ibHVle2NvbG9yOiMzZDVhZmV9LmMtYmctYmx1ZXtiYWNrZ3JvdW5kLWNvbG9yOiMzZDVhZmV9LmMtY2hhcmNvYWx7Y29sb3I6IzMwMzAzMH0uYy1iZy1jaGFyY29hbHtiYWNrZ3JvdW5kLWNvbG9yOiMzMDMwMzB9LmMtYnJvd257Y29sb3I6Izc5NTU0OH0uYy1iZy1icm93bntiYWNrZ3JvdW5kLWNvbG9yOiM3OTU1NDh9LmMtZm9yZXN0e2NvbG9yOiMwMDY5Njh9LmMtYmctZm9yZXN0e2JhY2tncm91bmQtY29sb3I6IzAwNjk2OH0uYy1ncmV5e2NvbG9yOiNlMGUwZTB9LmMtYmctZ3JleXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9LmMtZ3JleS1saWdodHtjb2xvcjojYmFiYWJhfS5jLWJnLWdyZXktbGlnaHR7YmFja2dyb3VuZC1jb2xvcjojYmFiYWJhfS5jLWdyZXktZGFya3tjb2xvcjojNWM2ODdjfS5jLWJnLWdyZXktZGFya3tiYWNrZ3JvdW5kLWNvbG9yOiM1YzY4N2N9LmMtcHVycGxle2NvbG9yOiM4MTMwZmZ9LmMtYmctcHVycGxle2JhY2tncm91bmQtY29sb3I6IzgxMzBmZn0uYy1sZW1vbntjb2xvcjojZmZlYTAwfS5jLWJnLWxlbW9ue2JhY2tncm91bmQtY29sb3I6I2ZmZWEwMH0uYy1saW1le2NvbG9yOiNhZWU0MDZ9LmMtYmctbGltZXtiYWNrZ3JvdW5kLWNvbG9yOiNhZWU0MDZ9LmMtb3Jhbmdle2NvbG9yOiNmNTdjMDB9LmMtYmctb3Jhbmdle2JhY2tncm91bmQtY29sb3I6I2Y1N2MwMH0uYy1ydWJ5e2NvbG9yOiNmZjE3NDR9LmMtYmctcnVieXtiYWNrZ3JvdW5kLWNvbG9yOiNmZjE3NDR9LmMtc2t5e2NvbG9yOiMzMGJjZmZ9LmMtYmctc2t5e2JhY2tncm91bmQtY29sb3I6IzMwYmNmZn0udy1mdWxse3dpZHRoOjEwMCV9LnctMTAwe3dpZHRoOjEwMH0uaC1mdWxse2hlaWdodDoxMDAlfS5oLTEwMHtoZWlnaHQ6MTAwfS5tLTB7bWFyZ2luOjB9Lm0tdC0we21hcmdpbi10b3A6MH0ubS1yLTB7bWFyZ2luLXJpZ2h0OjB9Lm0tYi0we21hcmdpbi1ib3R0b206MH0ubS1sLTB7bWFyZ2luLWxlZnQ6MH0ubS14LTB7bWFyZ2luLXJpZ2h0OjA7bWFyZ2luLWxlZnQ6MH0ubS15LTB7bWFyZ2luLXRvcDowO21hcmdpbi1ib3R0b206MH0ubS0ye21hcmdpbjoyfS5tLXQtMnttYXJnaW4tdG9wOjJ9Lm0tci0ye21hcmdpbi1yaWdodDoyfS5tLWItMnttYXJnaW4tYm90dG9tOjJ9Lm0tbC0ye21hcmdpbi1sZWZ0OjJ9Lm0teC0ye21hcmdpbi1yaWdodDoyO21hcmdpbi1sZWZ0OjJ9Lm0teS0ye21hcmdpbi10b3A6MjttYXJnaW4tYm90dG9tOjJ9Lm0tNHttYXJnaW46NH0ubS10LTR7bWFyZ2luLXRvcDo0fS5tLXItNHttYXJnaW4tcmlnaHQ6NH0ubS1iLTR7bWFyZ2luLWJvdHRvbTo0fS5tLWwtNHttYXJnaW4tbGVmdDo0fS5tLXgtNHttYXJnaW4tcmlnaHQ6NDttYXJnaW4tbGVmdDo0fS5tLXktNHttYXJnaW4tdG9wOjQ7bWFyZ2luLWJvdHRvbTo0fS5tLTV7bWFyZ2luOjV9Lm0tdC01e21hcmdpbi10b3A6NX0ubS1yLTV7bWFyZ2luLXJpZ2h0OjV9Lm0tYi01e21hcmdpbi1ib3R0b206NX0ubS1sLTV7bWFyZ2luLWxlZnQ6NX0ubS14LTV7bWFyZ2luLXJpZ2h0OjU7bWFyZ2luLWxlZnQ6NX0ubS15LTV7bWFyZ2luLXRvcDo1O21hcmdpbi1ib3R0b206NX0ubS04e21hcmdpbjo4fS5tLXQtOHttYXJnaW4tdG9wOjh9Lm0tci04e21hcmdpbi1yaWdodDo4fS5tLWItOHttYXJnaW4tYm90dG9tOjh9Lm0tbC04e21hcmdpbi1sZWZ0Ojh9Lm0teC04e21hcmdpbi1yaWdodDo4O21hcmdpbi1sZWZ0Ojh9Lm0teS04e21hcmdpbi10b3A6ODttYXJnaW4tYm90dG9tOjh9Lm0tMTB7bWFyZ2luOjEwfS5tLXQtMTB7bWFyZ2luLXRvcDoxMH0ubS1yLTEwe21hcmdpbi1yaWdodDoxMH0ubS1iLTEwe21hcmdpbi1ib3R0b206MTB9Lm0tbC0xMHttYXJnaW4tbGVmdDoxMH0ubS14LTEwe21hcmdpbi1yaWdodDoxMDttYXJnaW4tbGVmdDoxMH0ubS15LTEwe21hcmdpbi10b3A6MTA7bWFyZ2luLWJvdHRvbToxMH0ubS0xMnttYXJnaW46MTJ9Lm0tdC0xMnttYXJnaW4tdG9wOjEyfS5tLXItMTJ7bWFyZ2luLXJpZ2h0OjEyfS5tLWItMTJ7bWFyZ2luLWJvdHRvbToxMn0ubS1sLTEye21hcmdpbi1sZWZ0OjEyfS5tLXgtMTJ7bWFyZ2luLXJpZ2h0OjEyO21hcmdpbi1sZWZ0OjEyfS5tLXktMTJ7bWFyZ2luLXRvcDoxMjttYXJnaW4tYm90dG9tOjEyfS5tLTE1e21hcmdpbjoxNX0ubS10LTE1e21hcmdpbi10b3A6MTV9Lm0tci0xNXttYXJnaW4tcmlnaHQ6MTV9Lm0tYi0xNXttYXJnaW4tYm90dG9tOjE1fS5tLWwtMTV7bWFyZ2luLWxlZnQ6MTV9Lm0teC0xNXttYXJnaW4tcmlnaHQ6MTU7bWFyZ2luLWxlZnQ6MTV9Lm0teS0xNXttYXJnaW4tdG9wOjE1O21hcmdpbi1ib3R0b206MTV9Lm0tMTZ7bWFyZ2luOjE2fS5tLXQtMTZ7bWFyZ2luLXRvcDoxNn0ubS1yLTE2e21hcmdpbi1yaWdodDoxNn0ubS1iLTE2e21hcmdpbi1ib3R0b206MTZ9Lm0tbC0xNnttYXJnaW4tbGVmdDoxNn0ubS14LTE2e21hcmdpbi1yaWdodDoxNjttYXJnaW4tbGVmdDoxNn0ubS15LTE2e21hcmdpbi10b3A6MTY7bWFyZ2luLWJvdHRvbToxNn0ubS0yMHttYXJnaW46MjB9Lm0tdC0yMHttYXJnaW4tdG9wOjIwfS5tLXItMjB7bWFyZ2luLXJpZ2h0OjIwfS5tLWItMjB7bWFyZ2luLWJvdHRvbToyMH0ubS1sLTIwe21hcmdpbi1sZWZ0OjIwfS5tLXgtMjB7bWFyZ2luLXJpZ2h0OjIwO21hcmdpbi1sZWZ0OjIwfS5tLXktMjB7bWFyZ2luLXRvcDoyMDttYXJnaW4tYm90dG9tOjIwfS5tLTI0e21hcmdpbjoyNH0ubS10LTI0e21hcmdpbi10b3A6MjR9Lm0tci0yNHttYXJnaW4tcmlnaHQ6MjR9Lm0tYi0yNHttYXJnaW4tYm90dG9tOjI0fS5tLWwtMjR7bWFyZ2luLWxlZnQ6MjR9Lm0teC0yNHttYXJnaW4tcmlnaHQ6MjQ7bWFyZ2luLWxlZnQ6MjR9Lm0teS0yNHttYXJnaW4tdG9wOjI0O21hcmdpbi1ib3R0b206MjR9Lm0tMjV7bWFyZ2luOjI1fS5tLXQtMjV7bWFyZ2luLXRvcDoyNX0ubS1yLTI1e21hcmdpbi1yaWdodDoyNX0ubS1iLTI1e21hcmdpbi1ib3R0b206MjV9Lm0tbC0yNXttYXJnaW4tbGVmdDoyNX0ubS14LTI1e21hcmdpbi1yaWdodDoyNTttYXJnaW4tbGVmdDoyNX0ubS15LTI1e21hcmdpbi10b3A6MjU7bWFyZ2luLWJvdHRvbToyNX0ubS0yOHttYXJnaW46Mjh9Lm0tdC0yOHttYXJnaW4tdG9wOjI4fS5tLXItMjh7bWFyZ2luLXJpZ2h0OjI4fS5tLWItMjh7bWFyZ2luLWJvdHRvbToyOH0ubS1sLTI4e21hcmdpbi1sZWZ0OjI4fS5tLXgtMjh7bWFyZ2luLXJpZ2h0OjI4O21hcmdpbi1sZWZ0OjI4fS5tLXktMjh7bWFyZ2luLXRvcDoyODttYXJnaW4tYm90dG9tOjI4fS5tLTMwe21hcmdpbjozMH0ubS10LTMwe21hcmdpbi10b3A6MzB9Lm0tci0zMHttYXJnaW4tcmlnaHQ6MzB9Lm0tYi0zMHttYXJnaW4tYm90dG9tOjMwfS5tLWwtMzB7bWFyZ2luLWxlZnQ6MzB9Lm0teC0zMHttYXJnaW4tcmlnaHQ6MzA7bWFyZ2luLWxlZnQ6MzB9Lm0teS0zMHttYXJnaW4tdG9wOjMwO21hcmdpbi1ib3R0b206MzB9LnAtMHtwYWRkaW5nOjB9LnAtdC0we3BhZGRpbmctdG9wOjB9LnAtci0we3BhZGRpbmctcmlnaHQ6MH0ucC1iLTB7cGFkZGluZy1ib3R0b206MH0ucC1sLTB7cGFkZGluZy1sZWZ0OjB9LnAteC0we3BhZGRpbmctcmlnaHQ6MDtwYWRkaW5nLWxlZnQ6MH0ucC15LTB7cGFkZGluZy10b3A6MDtwYWRkaW5nLWJvdHRvbTowfS5wLTJ7cGFkZGluZzoyfS5wLXQtMntwYWRkaW5nLXRvcDoyfS5wLXItMntwYWRkaW5nLXJpZ2h0OjJ9LnAtYi0ye3BhZGRpbmctYm90dG9tOjJ9LnAtbC0ye3BhZGRpbmctbGVmdDoyfS5wLXgtMntwYWRkaW5nLXJpZ2h0OjI7cGFkZGluZy1sZWZ0OjJ9LnAteS0ye3BhZGRpbmctdG9wOjI7cGFkZGluZy1ib3R0b206Mn0ucC00e3BhZGRpbmc6NH0ucC10LTR7cGFkZGluZy10b3A6NH0ucC1yLTR7cGFkZGluZy1yaWdodDo0fS5wLWItNHtwYWRkaW5nLWJvdHRvbTo0fS5wLWwtNHtwYWRkaW5nLWxlZnQ6NH0ucC14LTR7cGFkZGluZy1yaWdodDo0O3BhZGRpbmctbGVmdDo0fS5wLXktNHtwYWRkaW5nLXRvcDo0O3BhZGRpbmctYm90dG9tOjR9LnAtNXtwYWRkaW5nOjV9LnAtdC01e3BhZGRpbmctdG9wOjV9LnAtci01e3BhZGRpbmctcmlnaHQ6NX0ucC1iLTV7cGFkZGluZy1ib3R0b206NX0ucC1sLTV7cGFkZGluZy1sZWZ0OjV9LnAteC01e3BhZGRpbmctcmlnaHQ6NTtwYWRkaW5nLWxlZnQ6NX0ucC15LTV7cGFkZGluZy10b3A6NTtwYWRkaW5nLWJvdHRvbTo1fS5wLTh7cGFkZGluZzo4fS5wLXQtOHtwYWRkaW5nLXRvcDo4fS5wLXItOHtwYWRkaW5nLXJpZ2h0Ojh9LnAtYi04e3BhZGRpbmctYm90dG9tOjh9LnAtbC04e3BhZGRpbmctbGVmdDo4fS5wLXgtOHtwYWRkaW5nLXJpZ2h0Ojg7cGFkZGluZy1sZWZ0Ojh9LnAteS04e3BhZGRpbmctdG9wOjg7cGFkZGluZy1ib3R0b206OH0ucC0xMHtwYWRkaW5nOjEwfS5wLXQtMTB7cGFkZGluZy10b3A6MTB9LnAtci0xMHtwYWRkaW5nLXJpZ2h0OjEwfS5wLWItMTB7cGFkZGluZy1ib3R0b206MTB9LnAtbC0xMHtwYWRkaW5nLWxlZnQ6MTB9LnAteC0xMHtwYWRkaW5nLXJpZ2h0OjEwO3BhZGRpbmctbGVmdDoxMH0ucC15LTEwe3BhZGRpbmctdG9wOjEwO3BhZGRpbmctYm90dG9tOjEwfS5wLTEye3BhZGRpbmc6MTJ9LnAtdC0xMntwYWRkaW5nLXRvcDoxMn0ucC1yLTEye3BhZGRpbmctcmlnaHQ6MTJ9LnAtYi0xMntwYWRkaW5nLWJvdHRvbToxMn0ucC1sLTEye3BhZGRpbmctbGVmdDoxMn0ucC14LTEye3BhZGRpbmctcmlnaHQ6MTI7cGFkZGluZy1sZWZ0OjEyfS5wLXktMTJ7cGFkZGluZy10b3A6MTI7cGFkZGluZy1ib3R0b206MTJ9LnAtMTV7cGFkZGluZzoxNX0ucC10LTE1e3BhZGRpbmctdG9wOjE1fS5wLXItMTV7cGFkZGluZy1yaWdodDoxNX0ucC1iLTE1e3BhZGRpbmctYm90dG9tOjE1fS5wLWwtMTV7cGFkZGluZy1sZWZ0OjE1fS5wLXgtMTV7cGFkZGluZy1yaWdodDoxNTtwYWRkaW5nLWxlZnQ6MTV9LnAteS0xNXtwYWRkaW5nLXRvcDoxNTtwYWRkaW5nLWJvdHRvbToxNX0ucC0xNntwYWRkaW5nOjE2fS5wLXQtMTZ7cGFkZGluZy10b3A6MTZ9LnAtci0xNntwYWRkaW5nLXJpZ2h0OjE2fS5wLWItMTZ7cGFkZGluZy1ib3R0b206MTZ9LnAtbC0xNntwYWRkaW5nLWxlZnQ6MTZ9LnAteC0xNntwYWRkaW5nLXJpZ2h0OjE2O3BhZGRpbmctbGVmdDoxNn0ucC15LTE2e3BhZGRpbmctdG9wOjE2O3BhZGRpbmctYm90dG9tOjE2fS5wLTIwe3BhZGRpbmc6MjB9LnAtdC0yMHtwYWRkaW5nLXRvcDoyMH0ucC1yLTIwe3BhZGRpbmctcmlnaHQ6MjB9LnAtYi0yMHtwYWRkaW5nLWJvdHRvbToyMH0ucC1sLTIwe3BhZGRpbmctbGVmdDoyMH0ucC14LTIwe3BhZGRpbmctcmlnaHQ6MjA7cGFkZGluZy1sZWZ0OjIwfS5wLXktMjB7cGFkZGluZy10b3A6MjA7cGFkZGluZy1ib3R0b206MjB9LnAtMjR7cGFkZGluZzoyNH0ucC10LTI0e3BhZGRpbmctdG9wOjI0fS5wLXItMjR7cGFkZGluZy1yaWdodDoyNH0ucC1iLTI0e3BhZGRpbmctYm90dG9tOjI0fS5wLWwtMjR7cGFkZGluZy1sZWZ0OjI0fS5wLXgtMjR7cGFkZGluZy1yaWdodDoyNDtwYWRkaW5nLWxlZnQ6MjR9LnAteS0yNHtwYWRkaW5nLXRvcDoyNDtwYWRkaW5nLWJvdHRvbToyNH0ucC0yNXtwYWRkaW5nOjI1fS5wLXQtMjV7cGFkZGluZy10b3A6MjV9LnAtci0yNXtwYWRkaW5nLXJpZ2h0OjI1fS5wLWItMjV7cGFkZGluZy1ib3R0b206MjV9LnAtbC0yNXtwYWRkaW5nLWxlZnQ6MjV9LnAteC0yNXtwYWRkaW5nLXJpZ2h0OjI1O3BhZGRpbmctbGVmdDoyNX0ucC15LTI1e3BhZGRpbmctdG9wOjI1O3BhZGRpbmctYm90dG9tOjI1fS5wLTI4e3BhZGRpbmc6Mjh9LnAtdC0yOHtwYWRkaW5nLXRvcDoyOH0ucC1yLTI4e3BhZGRpbmctcmlnaHQ6Mjh9LnAtYi0yOHtwYWRkaW5nLWJvdHRvbToyOH0ucC1sLTI4e3BhZGRpbmctbGVmdDoyOH0ucC14LTI4e3BhZGRpbmctcmlnaHQ6Mjg7cGFkZGluZy1sZWZ0OjI4fS5wLXktMjh7cGFkZGluZy10b3A6Mjg7cGFkZGluZy1ib3R0b206Mjh9LnAtMzB7cGFkZGluZzozMH0ucC10LTMwe3BhZGRpbmctdG9wOjMwfS5wLXItMzB7cGFkZGluZy1yaWdodDozMH0ucC1iLTMwe3BhZGRpbmctYm90dG9tOjMwfS5wLWwtMzB7cGFkZGluZy1sZWZ0OjMwfS5wLXgtMzB7cGFkZGluZy1yaWdodDozMDtwYWRkaW5nLWxlZnQ6MzB9LnAteS0zMHtwYWRkaW5nLXRvcDozMDtwYWRkaW5nLWJvdHRvbTozMH0uaHItbGlnaHR7aGVpZ2h0OjE7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO3dpZHRoOjEwMCV9LmhyLWRhcmt7aGVpZ2h0OjE7YmFja2dyb3VuZC1jb2xvcjojMzAzMDMwO3dpZHRoOjEwMCV9LnRleHQtbGVmdHt0ZXh0LWFsaWduOmxlZnR9LnRleHQtcmlnaHR7dGV4dC1hbGlnbjpyaWdodH0udGV4dC1jZW50ZXJ7dGV4dC1hbGlnbjpjZW50ZXJ9LnRleHQtbG93ZXJjYXNle3RleHQtdHJhbnNmb3JtOmxvd2VyY2FzZX0udGV4dC11cHBlcmNhc2V7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlfS50ZXh0LWNhcGl0YWxpemV7dGV4dC10cmFuc2Zvcm06Y2FwaXRhbGl6ZX0uZm9udC13ZWlnaHQtbm9ybWFse2ZvbnQtd2VpZ2h0Om5vcm1hbH0uZm9udC13ZWlnaHQtYm9sZHtmb250LXdlaWdodDpib2xkfS5mb250LWl0YWxpY3tmb250LXN0eWxlOml0YWxpY30udC0xMHtmb250LXNpemU6MTB9LnQtMTJ7Zm9udC1zaXplOjEyfS50LTE0e2ZvbnQtc2l6ZToxNH0udC0xNXtmb250LXNpemU6MTV9LnQtMTZ7Zm9udC1zaXplOjE2fS50LTE3e2ZvbnQtc2l6ZToxN30udC0xOHtmb250LXNpemU6MTh9LnQtMTl7Zm9udC1zaXplOjE5fS50LTIwe2ZvbnQtc2l6ZToyMH0udC0yNXtmb250LXNpemU6MjV9LnQtMzB7Zm9udC1zaXplOjMwfS5pbWctcm91bmRlZHtib3JkZXItcmFkaXVzOjV9LmltZy1jaXJjbGV7Ym9yZGVyLXJhZGl1czoyMH0uaW1nLXRodW1ibmFpbHtib3JkZXItcmFkaXVzOjB9LmludmlzaWJsZXt2aXNpYmlsaXR5OmNvbGxhcHNlfS5wdWxsLWxlZnR7aG9yaXpvbnRhbC1hbGlnbjpsZWZ0fS5wdWxsLXJpZ2h0e2hvcml6b250YWwtYWxpZ246cmlnaHR9Lm0teC1hdXRve2hvcml6b250YWwtYWxpZ246Y2VudGVyfS5tLXktYXV0b3t2ZXJ0aWNhbC1hbGlnbjpjZW50ZXJ9LnRleHQtcHJpbWFyeXtjb2xvcjojMzBiY2ZmfS50ZXh0LWRhbmdlcntjb2xvcjojZDUwMDAwfS50ZXh0LW11dGVke2NvbG9yOiM5ZTllOWV9LmJnLXByaW1hcnl7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmO2NvbG9yOiNmZmZ9LmJnLWRhbmdlcntiYWNrZ3JvdW5kLWNvbG9yOiNkNTAwMDA7Y29sb3I6I2ZmZn0uYWN0aW9uLWJhcntiYWNrZ3JvdW5kLWNvbG9yOiNGOEY4Rjg7Y29sb3I6IzIxMjEyMX0uYWN0aW9uLWJhciAuYWN0aW9uLWJhci10aXRsZXtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToxNzt2ZXJ0aWNhbC1hbGlnbjpjZW50ZXJ9LmFjdGlvbi1iYXIgLmFjdGlvbi1pdGVte2ZvbnQtd2VpZ2h0Om5vcm1hbH0uYWN0aXZpdHktaW5kaWNhdG9ye2NvbG9yOiMzMGJjZmY7d2lkdGg6MzA7aGVpZ2h0OjMwfS5idG57Y29sb3I6IzMwYmNmZjtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O21pbi1oZWlnaHQ6MzY7bWluLXdpZHRoOjY0O3BhZGRpbmc6MTAgMTAgMTAgMTA7Zm9udC1zaXplOjE4O21hcmdpbjo4IDE2IDggMTZ9LmJ0bi5idG4tYWN0aXZlOmhpZ2hsaWdodGVke2NvbG9yOiNmZmY7YmFja2dyb3VuZC1jb2xvcjojYzBlYmZmfS5idG4tcHJpbWFyeXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmY7Ym9yZGVyLWNvbG9yOiMzMGJjZmY7Y29sb3I6I2ZmZn0uYnRuLXByaW1hcnkuYnRuLWFjdGl2ZTpoaWdobGlnaHRlZHtiYWNrZ3JvdW5kLWNvbG9yOiMwMWEwZWM7Ym9yZGVyLWNvbG9yOiMwMWEwZWN9LmJ0bi1wcmltYXJ5LmJ0bi1hcXVhe2JhY2tncm91bmQtY29sb3I6IzAwY2FhYn0uYnRuLXByaW1hcnkuYnRuLWJsdWV7YmFja2dyb3VuZC1jb2xvcjojM2Q1YWZlfS5idG4tcHJpbWFyeS5idG4tYnJvd257YmFja2dyb3VuZC1jb2xvcjojNzk1NTQ4fS5idG4tcHJpbWFyeS5idG4tZm9yZXN0e2JhY2tncm91bmQtY29sb3I6IzAwNjk2OH0uYnRuLXByaW1hcnkuYnRuLWdyZXl7YmFja2dyb3VuZC1jb2xvcjojNWM2ODdjfS5idG4tcHJpbWFyeS5idG4tbGVtb257YmFja2dyb3VuZC1jb2xvcjojZmZlYTAwO2NvbG9yOiMwMDB9LmJ0bi1wcmltYXJ5LmJ0bi1saW1le2JhY2tncm91bmQtY29sb3I6I2FlZTQwNjtjb2xvcjojMDAwfS5idG4tcHJpbWFyeS5idG4tb3Jhbmdle2JhY2tncm91bmQtY29sb3I6I2Y1N2MwMH0uYnRuLXByaW1hcnkuYnRuLXB1cnBsZXtiYWNrZ3JvdW5kLWNvbG9yOiM4MTMwZmZ9LmJ0bi1wcmltYXJ5LmJ0bi1ydWJ5e2JhY2tncm91bmQtY29sb3I6I2ZmMTc0NH0uYnRuLXByaW1hcnkuYnRuLXNreXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LmJ0bi1vdXRsaW5le2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLWNvbG9yOiMzMGJjZmY7Y29sb3I6IzMwYmNmZn0uYnRuLW91dGxpbmUuYnRuLWFjdGl2ZTpoaWdobGlnaHRlZHtiYWNrZ3JvdW5kLWNvbG9yOiNjMGViZmZ9LmJ0bltpc0VuYWJsZWQ9ZmFsc2Vde2NvbG9yOiNhNGE0YTQ7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO2JvcmRlci1jb2xvcjojZTBlMGUwfS5mYXtmb250LWZhbWlseTpGb250QXdlc29tZSwgZm9udGF3ZXNvbWUtd2ViZm9udH0uZm9ybSAuaW5wdXR7cGFkZGluZzoxNiA4IDE2IDg7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudH0uZm9ybSAuaW5wdXQuaW5wdXQtYm9yZGVye2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojZTBlMGUwO2JvcmRlci1yYWRpdXM6MjtwYWRkaW5nOjE2fS5mb3JtIC5pbnB1dC5pbnB1dC1yb3VuZGVke2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojZTBlMGUwO2JvcmRlci1yYWRpdXM6Mjg7cGFkZGluZzoxNn0uZm9ybSAuaW5wdXRbaXNFbmFibGVkPSdmYWxzZSdde2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYX0uZm9ybSAuaW5wdXQtZmllbGR7bWFyZ2luOjh9LmZvcm0gLmlucHV0LWZpZWxkIC5sYWJlbHtmb250LXNpemU6MTI7Y29sb3I6I2JhYmFiYX0uZm9ybSAuaW5wdXQtZmllbGQgLmlucHV0e3BhZGRpbmc6MDttYXJnaW46MCAwIDggMH0uZm9ybSAuaW5wdXQtZmllbGQgLmhyLWxpZ2h0LmFjdGl2ZSwuZm9ybSAuaW5wdXQtZmllbGQgLmhyLWRhcmsuYWN0aXZle2JhY2tncm91bmQtY29sb3I6IzMwYmNmZn0uZm9ybSAuaW5wdXQtZmllbGQuaW5wdXQtc2lkZXMgLmxhYmVse2ZvbnQtc2l6ZToxODttYXJnaW46MCAwIDggMH0uaDEsLmgyLC5oMywuaDQsLmg1LC5oNnttYXJnaW4tYm90dG9tOjQ7Zm9udC13ZWlnaHQ6bm9ybWFsO2NvbG9yOiMyMTIxMjF9LmJvZHksLmJvZHkyLC5mb290bm90ZXtmb250LXdlaWdodDpub3JtYWw7Y29sb3I6Izc1NzU3NX0uaDF7Zm9udC1zaXplOjMyfS5oMntmb250LXNpemU6MjJ9Lmgze2ZvbnQtc2l6ZToxNX0uaDR7Zm9udC1zaXplOjEyfS5oNXtmb250LXNpemU6MTF9Lmg2e2ZvbnQtc2l6ZToxMH0uYm9keXtmb250LXNpemU6MTR9LmJvZHkye2ZvbnQtc2l6ZToxN30uZm9vdG5vdGV7Zm9udC1zaXplOjEzfS5saXN0LWdyb3VwIC5saXN0LWdyb3VwLWl0ZW17Y29sb3I6IzIxMjEyMTtmb250LXNpemU6MTY7bWFyZ2luOjA7cGFkZGluZzoxNn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtIExhYmVse3ZlcnRpY2FsLWFsaWduOmNlbnRlcn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtIC50aHVtYntzdHJldGNoOmZpbGw7d2lkdGg6NDA7aGVpZ2h0OjQwO21hcmdpbi1yaWdodDoxNn0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtLmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbSAubGlzdC1ncm91cC1pdGVtLXRleHR7Y29sb3I6Izc1NzU3NTtmb250LXNpemU6MTR9LnBhZ2V7YmFja2dyb3VuZC1jb2xvcjojZmZmfS5wcm9ncmVzc3tjb2xvcjojMzBiY2ZmO2JhY2tncm91bmQtY29sb3I6I2JhYmFiYX0uc2VnbWVudGVkLWJhcntmb250LXNpemU6MTM7YmFja2dyb3VuZC1jb2xvcjojZmZmO2NvbG9yOiMyMTIxMjE7c2VsZWN0ZWQtYmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmfS5zaWRlZHJhd2VyLWxlZnQsLnNpZGVkcmF3ZXItY2VudGVye2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYX0uc2lkZWRyYXdlci1oZWFkZXJ7YmFja2dyb3VuZC1jb2xvcjojZmFmYWZhO2hlaWdodDoxNDg7d2lkdGg6MTAwJX0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWhlYWRlcntwYWRkaW5nOjE2IDE2IDAgMTZ9LnNpZGVkcmF3ZXItY2VudGVyIC5zaWRlZHJhd2VyLWhlYWRlcntwYWRkaW5nOjIwIDE1IDAgMTV9LnNpZGVkcmF3ZXItaGVhZGVyLWltYWdle2JhY2tncm91bmQtY29sb3I6I2UwZTBlMH0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWhlYWRlci1pbWFnZXtoZWlnaHQ6NjQ7d2lkdGg6NjQ7Ym9yZGVyLXJhZGl1czozMjtob3Jpem9udGFsLWFsaWduOmxlZnQ7bWFyZ2luLWJvdHRvbTozNn0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItaGVhZGVyLWltYWdle2hlaWdodDo3NDt3aWR0aDo3NDtib3JkZXItcmFkaXVzOjM3O2hvcml6b250YWwtYWxpZ246Y2VudGVyO21hcmdpbi1ib3R0b206MjR9LnNpZGVkcmF3ZXItaGVhZGVyLWJyYW5ke2NvbG9yOiM3MzczNzN9LnNpZGVkcmF3ZXItbGVmdCAuc2lkZWRyYXdlci1oZWFkZXItYnJhbmR7aG9yaXpvbnRhbC1hbGlnbjpsZWZ0O2ZvbnQtc2l6ZToxNH0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItaGVhZGVyLWJyYW5ke2hvcml6b250YWwtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToxNX0uc2lkZWRyYXdlci1saXN0LWl0ZW17aGVpZ2h0OjQ4O2hvcml6b250YWwtYWxpZ246bGVmdDt3aWR0aDoxMDAlO29yaWVudGF0aW9uOmhvcml6b250YWx9LnNpZGVkcmF3ZXItbGlzdC1pdGVtIC5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29ue3dpZHRoOjI0O3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToyMDtoZWlnaHQ6NDg7dmVydGljYWwtYWxpZ246Y2VudGVyfS5zaWRlZHJhd2VyLWxpc3QtaXRlbS5hY3RpdmV7Y29sb3I6I2ZmZjtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LnNpZGVkcmF3ZXItbGlzdC1pdGVtLmFjdGl2ZSAuc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbntjb2xvcjojZmZmfS5zaWRlZHJhd2VyLWxlZnQgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLWljb257bWFyZ2luOjAgMTYgMCAxNn0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLWljb257bWFyZ2luOjAgMCAwIDE1fS5zaWRlZHJhd2VyLWxpc3QtaXRlbS10ZXh0e2hvcml6b250YWwtYWxpZ246bGVmdDt0ZXh0LWFsaWduOmxlZnQ7Zm9udC1zaXplOjE1O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXdpZHRoOjAuMTt3aWR0aDo4MCU7dmVydGljYWwtYWxpZ246Y2VudGVyfS5zaWRlZHJhd2VyLWxlZnQgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLXRleHR7cGFkZGluZy1sZWZ0OjE2fS5zaWRlZHJhd2VyLWNlbnRlciAuc2lkZWRyYXdlci1saXN0LWl0ZW0tdGV4dHtwYWRkaW5nLWxlZnQ6MTV9LnNsaWRlcntiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LnNsaWRlcltpc0VuYWJsZWQ9ZmFsc2Vde2JhY2tncm91bmQtY29sb3I6I2UwZTBlMDtjb2xvcjojZTBlMGUwfS5zd2l0Y2hbY2hlY2tlZD10cnVlXXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmY7Y29sb3I6IzMwYmNmZn0uc3dpdGNoW2NoZWNrZWQ9dHJ1ZV1baXNFbmFibGVkPWZhbHNlXXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTA7Y29sb3I6I2ZmZn0uc3dpdGNoW2lzRW5hYmxlZD1mYWxzZV17YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO2NvbG9yOiNlMGUwZTB9LnRhYi12aWV3e3NlbGVjdGVkLWNvbG9yOiMzMGJjZmY7dGFicy1iYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9LnRhYi12aWV3IC50YWItdmlldy1pdGVte2JhY2tncm91bmQtY29sb3I6I2ZmZjt0YWJzLWJhY2tncm91bmQtY29sb3I6I2ZmZn0jbG9naW4tYmFja2dyb3VuZHttYXJnaW4tdG9wOi0yMDtiYWNrZ3JvdW5kLXNpemU6Y292ZXI7YmFja2dyb3VuZC1wb3NpdGlvbjpjZW50ZXJ9LmxvZ2luLXdyYXB7cGFkZGluZzowIDQwfS5sb2dvLXdyYXB7bWFyZ2luOjYwIDAgMTAgMDtwYWRkaW5nOjIwIDB9LmxvZ28td3JhcCAubG9naW4tbG9nb3t0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MzA7Zm9udC13ZWlnaHQ6Ym9sZDttYXJnaW4tYm90dG9tOjEwO29wYWNpdHk6MTtjb2xvcjojMjEyMTIxO29wYWNpdHk6Ljl9LmxvZ28td3JhcCAubG9naW4tbG9nby1zdWJ7Y29sb3I6IzIxMjEyMTtvcGFjaXR5Oi44O3RleHQtYWxpZ246Y2VudGVyfS5sb2dpbi13cmFwcGVye3BhZGRpbmc6MjA7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlci1yYWRpdXM6M30ubG9naW4td3JhcHBlciBUZXh0RmllbGR7cGFkZGluZzoxMCAxMDttYXJnaW46MTAgMCAwIDB9LmdvLWJhY2t7Zm9udC1zaXplOjE0O3RleHQtYWxpZ246Y2VudGVyO2NvbG9yOiMyMTIxMjE7bWFyZ2luLXRvcDoxMH0uYWN0aW9uLWJhciAuYWN0aW9uLWJhci10aXRsZXtmb250LXdlaWdodDo1MDA7Zm9udC1zaXplOjIwfS5hY3Rpb24tYmFyIC5hY3Rpb24taXRlbXthbmRyb2lkLWVsZXZhdGlvbjowO2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMCwwLDApO2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwwLDAsMCk7Ym9yZGVyLXdpZHRoOjF9LmJ0bntmb250LWZhbWlseTonUm9ib3RvIE1lZGl1bSc7Zm9udC1zaXplOjE0fS5idG4tcHJpbWFyeXtib3JkZXItY29sb3I6cmdiYSgyNTUsMCwwLDApfS5idG4tb3V0bGluZXthbmRyb2lkLWVsZXZhdGlvbjowO2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMCwwLDApO2JvcmRlci13aWR0aDoxO2JvcmRlci1jb2xvcjojMzBiY2ZmO2hlaWdodDozNjtwYWRkaW5nOjB9LmJ0bi1yb3VuZGVkLXNte2JvcmRlci1yYWRpdXM6MjtoZWlnaHQ6MzY7cGFkZGluZzowfS5idG4tcm91bmRlZC1sZ3tib3JkZXItcmFkaXVzOjQwO2hlaWdodDozNjtwYWRkaW5nOjB9LmZvcm17Zm9udC1mYW1pbHk6J1JvYm90byBSZWd1bGFyJ30uZm9ybSAuaW5wdXR7Zm9udC1zaXplOjE2fS5oMXtmb250LXNpemU6MzR9Lmgye2ZvbnQtc2l6ZToyNH0uaDN7Zm9udC1zaXplOjE2fS5oNXtmb250LXNpemU6MTE7Zm9udC13ZWlnaHQ6Ym9sZH0uYm9keTJ7Zm9udC1zaXplOjE0O2ZvbnQtd2VpZ2h0OjUwMH0uc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbnttYXJnaW46MCAxNiAwIDE2O3BhZGRpbmctdG9wOjE0fS5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29uLC5zaWRlZHJhd2VyLWxpc3QtaXRlbXtjb2xvcjojNzM3MzczfS5zaWRlZHJhd2VyLWxpc3QtaXRlbXtmb250LWZhbWlseTonUm9ib3RvIE1lZGl1bSc7Zm9udC1zaXplOjE0fS5zbGlkZXJ7Y29sb3I6IzMwYmNmZjttYXJnaW46MjAgMTZ9LnN3aXRjaHttYXJnaW46MTQgMTY7Y29sb3I6I2UwZTBlMDtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9LnN3aXRjaFtjaGVja2VkPXRydWVde2NvbG9yOiMzMGJjZmZ9XFxuXCIsIFwiXCJdKTtcblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qXG4gIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG4gIEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXNlU291cmNlTWFwKSB7XG4gIHZhciBsaXN0ID0gW107IC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcblxuICBsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblxuICAgICAgaWYgKGl0ZW1bMl0pIHtcbiAgICAgICAgcmV0dXJuICdAbWVkaWEgJyArIGl0ZW1bMl0gKyAneycgKyBjb250ZW50ICsgJ30nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICB9XG4gICAgfSkuam9pbignJyk7XG4gIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG5cblxuICBsaXN0LmkgPSBmdW5jdGlvbiAobW9kdWxlcywgbWVkaWFRdWVyeSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsICcnXV07XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGlkID0gdGhpc1tpXVswXTtcblxuICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IG1vZHVsZXNbaV07IC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcbiAgICAgIC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXG4gICAgICAvLyB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXG4gICAgICAvLyBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cbiAgICAgIGlmIChpdGVtWzBdID09IG51bGwgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcbiAgICAgICAgaWYgKG1lZGlhUXVlcnkgJiYgIWl0ZW1bMl0pIHtcbiAgICAgICAgICBpdGVtWzJdID0gbWVkaWFRdWVyeTtcbiAgICAgICAgfSBlbHNlIGlmIChtZWRpYVF1ZXJ5KSB7XG4gICAgICAgICAgaXRlbVsyXSA9ICcoJyArIGl0ZW1bMl0gKyAnKSBhbmQgKCcgKyBtZWRpYVF1ZXJ5ICsgJyknO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gbGlzdDtcbn07XG5cbmZ1bmN0aW9uIGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKSB7XG4gIHZhciBjb250ZW50ID0gaXRlbVsxXSB8fCAnJztcbiAgdmFyIGNzc01hcHBpbmcgPSBpdGVtWzNdO1xuXG4gIGlmICghY3NzTWFwcGluZykge1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgaWYgKHVzZVNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuICAgIHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICByZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nO1xuICAgIH0pO1xuICAgIHJldHVybiBbY29udGVudF0uY29uY2F0KHNvdXJjZVVSTHMpLmNvbmNhdChbc291cmNlTWFwcGluZ10pLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgcmV0dXJuIFtjb250ZW50XS5qb2luKCdcXG4nKTtcbn0gLy8gQWRhcHRlZCBmcm9tIGNvbnZlcnQtc291cmNlLW1hcCAoTUlUKVxuXG5cbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpO1xuICB2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuICByZXR1cm4gJy8qIyAnICsgZGF0YSArICcgKi8nO1xufSIsInZhciBjb252ZXJzaW9ucyA9IHtcclxuICAgIC8vIGxlbmd0aFxyXG4gICAgJ3B4Jzoge1xyXG4gICAgICAgICdweCc6IDEsXHJcbiAgICAgICAgJ2NtJzogOTYuMC8yLjU0LFxyXG4gICAgICAgICdtbSc6IDk2LjAvMjUuNCxcclxuICAgICAgICAnaW4nOiA5NixcclxuICAgICAgICAncHQnOiA5Ni4wLzcyLjAsXHJcbiAgICAgICAgJ3BjJzogMTZcclxuICAgIH0sXHJcbiAgICAnY20nOiB7XHJcbiAgICAgICAgJ3B4JzogMi41NC85Ni4wLFxyXG4gICAgICAgICdjbSc6IDEsXHJcbiAgICAgICAgJ21tJzogMC4xLFxyXG4gICAgICAgICdpbic6IDIuNTQsXHJcbiAgICAgICAgJ3B0JzogMi41NC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDIuNTQvNi4wXHJcbiAgICB9LFxyXG4gICAgJ21tJzoge1xyXG4gICAgICAgICdweCc6IDI1LjQvOTYuMCxcclxuICAgICAgICAnY20nOiAxMCxcclxuICAgICAgICAnbW0nOiAxLFxyXG4gICAgICAgICdpbic6IDI1LjQsXHJcbiAgICAgICAgJ3B0JzogMjUuNC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDI1LjQvNi4wXHJcbiAgICB9LFxyXG4gICAgJ2luJzoge1xyXG4gICAgICAgICdweCc6IDEuMC85Ni4wLFxyXG4gICAgICAgICdjbSc6IDEuMC8yLjU0LFxyXG4gICAgICAgICdtbSc6IDEuMC8yNS40LFxyXG4gICAgICAgICdpbic6IDEsXHJcbiAgICAgICAgJ3B0JzogMS4wLzcyLjAsXHJcbiAgICAgICAgJ3BjJzogMS4wLzYuMFxyXG4gICAgfSxcclxuICAgICdwdCc6IHtcclxuICAgICAgICAncHgnOiAwLjc1LFxyXG4gICAgICAgICdjbSc6IDcyLjAvMi41NCxcclxuICAgICAgICAnbW0nOiA3Mi4wLzI1LjQsXHJcbiAgICAgICAgJ2luJzogNzIsXHJcbiAgICAgICAgJ3B0JzogMSxcclxuICAgICAgICAncGMnOiAxMlxyXG4gICAgfSxcclxuICAgICdwYyc6IHtcclxuICAgICAgICAncHgnOiA2LjAvOTYuMCxcclxuICAgICAgICAnY20nOiA2LjAvMi41NCxcclxuICAgICAgICAnbW0nOiA2LjAvMjUuNCxcclxuICAgICAgICAnaW4nOiA2LFxyXG4gICAgICAgICdwdCc6IDYuMC83Mi4wLFxyXG4gICAgICAgICdwYyc6IDFcclxuICAgIH0sXHJcbiAgICAvLyBhbmdsZVxyXG4gICAgJ2RlZyc6IHtcclxuICAgICAgICAnZGVnJzogMSxcclxuICAgICAgICAnZ3JhZCc6IDAuOSxcclxuICAgICAgICAncmFkJzogMTgwL01hdGguUEksXHJcbiAgICAgICAgJ3R1cm4nOiAzNjBcclxuICAgIH0sXHJcbiAgICAnZ3JhZCc6IHtcclxuICAgICAgICAnZGVnJzogNDAwLzM2MCxcclxuICAgICAgICAnZ3JhZCc6IDEsXHJcbiAgICAgICAgJ3JhZCc6IDIwMC9NYXRoLlBJLFxyXG4gICAgICAgICd0dXJuJzogNDAwXHJcbiAgICB9LFxyXG4gICAgJ3JhZCc6IHtcclxuICAgICAgICAnZGVnJzogTWF0aC5QSS8xODAsXHJcbiAgICAgICAgJ2dyYWQnOiBNYXRoLlBJLzIwMCxcclxuICAgICAgICAncmFkJzogMSxcclxuICAgICAgICAndHVybic6IE1hdGguUEkqMlxyXG4gICAgfSxcclxuICAgICd0dXJuJzoge1xyXG4gICAgICAgICdkZWcnOiAxLzM2MCxcclxuICAgICAgICAnZ3JhZCc6IDEvNDAwLFxyXG4gICAgICAgICdyYWQnOiAwLjUvTWF0aC5QSSxcclxuICAgICAgICAndHVybic6IDFcclxuICAgIH0sXHJcbiAgICAvLyB0aW1lXHJcbiAgICAncyc6IHtcclxuICAgICAgICAncyc6IDEsXHJcbiAgICAgICAgJ21zJzogMS8xMDAwXHJcbiAgICB9LFxyXG4gICAgJ21zJzoge1xyXG4gICAgICAgICdzJzogMTAwMCxcclxuICAgICAgICAnbXMnOiAxXHJcbiAgICB9LFxyXG4gICAgLy8gZnJlcXVlbmN5XHJcbiAgICAnSHonOiB7XHJcbiAgICAgICAgJ0h6JzogMSxcclxuICAgICAgICAna0h6JzogMTAwMFxyXG4gICAgfSxcclxuICAgICdrSHonOiB7XHJcbiAgICAgICAgJ0h6JzogMS8xMDAwLFxyXG4gICAgICAgICdrSHonOiAxXHJcbiAgICB9LFxyXG4gICAgLy8gcmVzb2x1dGlvblxyXG4gICAgJ2RwaSc6IHtcclxuICAgICAgICAnZHBpJzogMSxcclxuICAgICAgICAnZHBjbSc6IDEuMC8yLjU0LFxyXG4gICAgICAgICdkcHB4JzogMS85NlxyXG4gICAgfSxcclxuICAgICdkcGNtJzoge1xyXG4gICAgICAgICdkcGknOiAyLjU0LFxyXG4gICAgICAgICdkcGNtJzogMSxcclxuICAgICAgICAnZHBweCc6IDIuNTQvOTYuMFxyXG4gICAgfSxcclxuICAgICdkcHB4Jzoge1xyXG4gICAgICAgICdkcGknOiA5NixcclxuICAgICAgICAnZHBjbSc6IDk2LjAvMi41NCxcclxuICAgICAgICAnZHBweCc6IDFcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKHZhbHVlLCBzb3VyY2VVbml0LCB0YXJnZXRVbml0LCBwcmVjaXNpb24pIHtcclxuICAgIGlmICghY29udmVyc2lvbnMuaGFzT3duUHJvcGVydHkodGFyZ2V0VW5pdCkpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdG8gXCIgKyB0YXJnZXRVbml0KTtcclxuXHJcbiAgICBpZiAoIWNvbnZlcnNpb25zW3RhcmdldFVuaXRdLmhhc093blByb3BlcnR5KHNvdXJjZVVuaXQpKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjb252ZXJ0IGZyb20gXCIgKyBzb3VyY2VVbml0ICsgXCIgdG8gXCIgKyB0YXJnZXRVbml0KTtcclxuXHJcbiAgICBwcmVjaXNpb24gPSBNYXRoLnBvdygxMCwgcGFyc2VJbnQocHJlY2lzaW9uKSB8fCA1KTtcclxuICAgIHJldHVybiBNYXRoLnJvdW5kKChjb252ZXJzaW9uc1t0YXJnZXRVbml0XVtzb3VyY2VVbml0XSAqIHZhbHVlKSAqIHByZWNpc2lvbikgLyBwcmVjaXNpb247XHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgaG90ID0gcmVxdWlyZShcIi4uL2hvdFwiKTtcbmNvbnN0IGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwidG5zLWNvcmUtbW9kdWxlcy9maWxlLXN5c3RlbVwiKTtcbmZ1bmN0aW9uIGhtclVwZGF0ZSgpIHtcbiAgICBjb25zdCBhcHBsaWNhdGlvbkZpbGVzID0gZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpO1xuICAgIGNvbnN0IGxhdGVzdEhhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fW1wiaFwiXSgpO1xuICAgIHJldHVybiBob3QobGF0ZXN0SGFzaCwgZmlsZW5hbWUgPT4gYXBwbGljYXRpb25GaWxlcy5nZXRGaWxlKGZpbGVuYW1lKSk7XG59XG5leHBvcnRzLmhtclVwZGF0ZSA9IGhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhtci11cGRhdGUuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaG1yX3VwZGF0ZV8xID0gcmVxdWlyZShcIi4vaG1yLXVwZGF0ZVwiKTtcbmV4cG9ydHMuaG1yVXBkYXRlID0gaG1yX3VwZGF0ZV8xLmhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImNvbnN0IGhtclByZWZpeCA9ICdITVI6JztcbmNvbnN0IGxvZyA9IHtcbiAgICBpbmZvOiAobWVzc2FnZSkgPT4gY29uc29sZS5pbmZvKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxuICAgIHdhcm46IChtZXNzYWdlKSA9PiBjb25zb2xlLndhcm4oYCR7aG1yUHJlZml4fSAke21lc3NhZ2V9YCksXG4gICAgZXJyb3I6IChtZXNzYWdlKSA9PiBjb25zb2xlLmVycm9yKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxufTtcbmNvbnN0IHJlZnJlc2ggPSAnQXBwbGljYXRpb24gbmVlZHMgdG8gYmUgcmVzdGFydGVkIGluIG9yZGVyIHRvIGFwcGx5IHRoZSBjaGFuZ2VzLic7XG5jb25zdCBob3RPcHRpb25zID0ge1xuICAgIGlnbm9yZVVuYWNjZXB0ZWQ6IGZhbHNlLFxuICAgIGlnbm9yZURlY2xpbmVkOiBmYWxzZSxcbiAgICBpZ25vcmVFcnJvcmVkOiBmYWxzZSxcbiAgICBvblVuYWNjZXB0ZWQoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbiA9IFtdLmNvbmNhdChkYXRhLmNoYWluKTtcbiAgICAgICAgY29uc3QgbGFzdCA9IGNoYWluW2NoYWluLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChsYXN0ID09PSAwKSB7XG4gICAgICAgICAgICBjaGFpbi5wb3AoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byB1bmFjY2VwdGVkIG1vZHVsZTogYCk7XG4gICAgICAgIGNoYWluLmZvckVhY2gobW9kID0+IGxvZy53YXJuKGAgICAgICAgICDinq0gJHttb2R9YCkpO1xuICAgIH0sXG4gICAgb25EZWNsaW5lZChkYXRhKSB7XG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byBkZWNsaW5lZCBtb2R1bGU6YCk7XG4gICAgICAgIGRhdGEuY2hhaW4uZm9yRWFjaChtb2QgPT4gbG9nLndhcm4oYCAgICAgICAgIOKerSAke21vZH1gKSk7XG4gICAgfSxcbiAgICBvbkVycm9yZWQoZGF0YSkge1xuICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgIGBJZ25vcmVkIGFuIGVycm9yIHdoaWxlIHVwZGF0aW5nIG1vZHVsZSAke2RhdGEubW9kdWxlSWR9IDwke2RhdGEudHlwZX0+YFxuICAgICAgICApO1xuICAgICAgICBsb2cud2FybihkYXRhLmVycm9yKTtcbiAgICB9LFxufTtcblxubGV0IG5leHRIYXNoO1xubGV0IGN1cnJlbnRIYXNoO1xuXG5mdW5jdGlvbiB1cFRvRGF0ZSgpIHtcbiAgICByZXR1cm4gbmV4dEhhc2guaW5kZXhPZihfX3dlYnBhY2tfaGFzaF9fKSA+PSAwO1xufVxuXG5mdW5jdGlvbiByZXN1bHQobW9kdWxlcywgYXBwbGllZE1vZHVsZXMpIHtcbiAgICBjb25zdCB1bmFjY2VwdGVkID0gbW9kdWxlcy5maWx0ZXIoXG4gICAgICAgIChtb2R1bGVJZCkgPT4gYXBwbGllZE1vZHVsZXMgJiYgYXBwbGllZE1vZHVsZXMuaW5kZXhPZihtb2R1bGVJZCkgPCAwXG4gICAgKTtcblxuICAgIGlmICh1bmFjY2VwdGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbG9nLndhcm4oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyBjb3VsZCBub3QgYmUgdXBkYXRlZDonKTtcblxuICAgICAgICBmb3IgKGNvbnN0IG1vZHVsZUlkIG9mIHVuYWNjZXB0ZWQpIHtcbiAgICAgICAgICAgIGxvZy53YXJuKGAgICAgICAgICAg4qa7ICR7bW9kdWxlSWR9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIShhcHBsaWVkTW9kdWxlcyB8fCBbXSkubGVuZ3RoKSB7XG4gICAgICAgIGxvZy5pbmZvKCdObyBNb2R1bGVzIFVwZGF0ZWQuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmluZm8oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyB3ZXJlIHVwZGF0ZWQ6Jyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiBhcHBsaWVkTW9kdWxlcykge1xuICAgICAgICAgICAgbG9nLmluZm8oYCAgICAgICAgIOKGuyAke21vZHVsZUlkfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbnVtYmVySWRzID0gYXBwbGllZE1vZHVsZXMuZXZlcnkoXG4gICAgICAgICAgICAobW9kdWxlSWQpID0+IHR5cGVvZiBtb2R1bGVJZCA9PT0gJ251bWJlcidcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKG51bWJlcklkcykge1xuICAgICAgICAgICAgbG9nLmluZm8oXG4gICAgICAgICAgICAgICAgJ1BsZWFzZSBjb25zaWRlciB1c2luZyB0aGUgTmFtZWRNb2R1bGVzUGx1Z2luIGZvciBtb2R1bGUgbmFtZXMuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2sob3B0aW9ucykge1xuICAgIHJldHVybiBtb2R1bGUuaG90XG4gICAgICAgIC5jaGVjaygpXG4gICAgICAgIC50aGVuKChtb2R1bGVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIW1vZHVsZXMpIHtcbiAgICAgICAgICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgICAgICAgICAgYENhbm5vdCBmaW5kIHVwZGF0ZS4gJHtyZWZyZXNofWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmhvdFxuICAgICAgICAgICAgICAgIC5hcHBseShob3RPcHRpb25zKVxuICAgICAgICAgICAgICAgIC50aGVuKChhcHBsaWVkTW9kdWxlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dENoZWNrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXVwVG9EYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaGVjayA9IGNoZWNrKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0KG1vZHVsZXMsIGFwcGxpZWRNb2R1bGVzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXBUb0RhdGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90IG1vZGlmeSBtZXNzYWdlIC0gQ0xJIGRlcGVuZHMgb24gdGhpcyBleGFjdCBjb250ZW50IHRvIGRldGVybWluZSBobXIgb3BlcmF0aW9uIHN0YXR1cy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgYXBwbGllZCB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS4gQXBwIGlzIHVwIHRvIGRhdGUuYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dENoZWNrIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoWydhYm9ydCcsICdmYWlsJ10uaW5kZXhPZihzdGF0dXMpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCBtb2RpZnkgbWVzc2FnZSAtIENMSSBkZXBlbmRzIG9uIHRoaXMgZXhhY3QgY29udGVudCB0byBkZXRlcm1pbmUgaG1yIG9wZXJhdGlvbiBzdGF0dXMuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoYENhbm5vdCBhcHBseSB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIuc3RhY2spO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gbW9kdWxlLmhvdC5zdGF0dXMoKTtcbiAgICAgICAgICAgIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGxvZy5lcnJvcihgQ2Fubm90IGNoZWNrIGZvciB1cGRhdGUuICR7cmVmcmVzaH1gKTtcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyLnN0YWNrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgY2hlY2sgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG59XG5cbmlmIChtb2R1bGUuaG90KSB7XG4gICAgbG9nLmluZm8oJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgRW5hYmxlZC4gV2FpdGluZyBmb3Igc2lnbmFsLicpO1xufSBlbHNlIHtcbiAgICBsb2cuZXJyb3IoJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgaXMgZGlzYWJsZWQuJyk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZShsYXRlc3RIYXNoLCBvcHRpb25zKSB7XG4gICAgbmV4dEhhc2ggPSBsYXRlc3RIYXNoO1xuICAgIGlmICghdXBUb0RhdGUoKSkge1xuICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdpZGxlJykge1xuICAgICAgICAgICAgLy9EbyBub3QgbW9kaWZ5IG1lc3NhZ2UgLSBDTEkgZGVwZW5kcyBvbiB0aGlzIGV4YWN0IGNvbnRlbnQgdG8gZGV0ZXJtaW5lIGhtciBvcGVyYXRpb24gc3RhdHVzLlxuICAgICAgICAgICAgbG9nLmluZm8oYENoZWNraW5nIGZvciB1cGRhdGVzIHRvIHRoZSBidW5kbGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgIHJldHVybiBjaGVjayhvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgbG9nLndhcm4oXG4gICAgICAgICAgICAgICAgYENhbm5vdCBhcHBseSB1cGRhdGUuIEEgcHJldmlvdXMgdXBkYXRlICR7c3RhdHVzfWVkLiAke3JlZnJlc2h9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmZ1bmN0aW9uIGdldE5leHRIYXNoKGhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY29uc3QgZmlsZSA9IGdldEZpbGVDb250ZW50KGAke2hhc2h9LmhvdC11cGRhdGUuanNvbmApO1xuICAgIHJldHVybiBmaWxlLnJlYWRUZXh0KCkudGhlbihob3RVcGRhdGVDb250ZW50ID0+IHtcbiAgICAgICAgaWYgKGhvdFVwZGF0ZUNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hbmlmZXN0ID0gSlNPTi5wYXJzZShob3RVcGRhdGVDb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0hhc2ggPSBtYW5pZmVzdC5oO1xuICAgICAgICAgICAgcmV0dXJuIGdldE5leHRIYXNoKG5ld0hhc2gsIGdldEZpbGVDb250ZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoaGFzaCk7XG4gICAgICAgIH1cbiAgICB9KS5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNoZWNrU3RhdGUoaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY3VycmVudEhhc2ggPSBpbml0aWFsSGFzaDtcbiAgICByZXR1cm4gZ2V0TmV4dEhhc2goaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KS50aGVuKG5leHRIYXNoID0+IHtcbiAgICAgICAgaWYgKG5leHRIYXNoICE9IGluaXRpYWxIYXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlKG5leHRIYXNoLCB7fSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuIiwiY29uc3QgbG9hZENzcyA9IHJlcXVpcmUoXCIuL2xvYWQtYXBwbGljYXRpb24tY3NzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgIGxvYWRDc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IGFwcENzc0NvbnRleHQgPSByZXF1aXJlLmNvbnRleHQoXCJ+L1wiLCBmYWxzZSwgL15cXC5cXC9hcHBcXC4oY3NzfHNjc3N8bGVzc3xzYXNzKSQvKTtcbiAgICAgICAgZ2xvYmFsLnJlZ2lzdGVyV2VicGFja01vZHVsZXMoYXBwQ3NzQ29udGV4dCk7XG4gICAgfSk7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChsb2FkTW9kdWxlRm4pIHtcbiAgICBjb25zdCBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCJ0bnMtY29yZS1tb2R1bGVzL2FwcGxpY2F0aW9uXCIpO1xuICAgIHJlcXVpcmUoXCJ0bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG5cbiAgICBsb2FkTW9kdWxlRm4oKTtcblxuICAgIGFwcGxpY2F0aW9uLmxvYWRBcHBDc3MoKTtcbn1cbiIsInZhciBwYXJzZSA9IHJlcXVpcmUoXCIuL3BhcnNlXCIpO1xudmFyIHdhbGsgPSByZXF1aXJlKFwiLi93YWxrXCIpO1xudmFyIHN0cmluZ2lmeSA9IHJlcXVpcmUoXCIuL3N0cmluZ2lmeVwiKTtcblxuZnVuY3Rpb24gVmFsdWVQYXJzZXIodmFsdWUpIHtcbiAgaWYgKHRoaXMgaW5zdGFuY2VvZiBWYWx1ZVBhcnNlcikge1xuICAgIHRoaXMubm9kZXMgPSBwYXJzZSh2YWx1ZSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgcmV0dXJuIG5ldyBWYWx1ZVBhcnNlcih2YWx1ZSk7XG59XG5cblZhbHVlUGFyc2VyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aGlzLm5vZGVzKSA/IHN0cmluZ2lmeSh0aGlzLm5vZGVzKSA6IFwiXCI7XG59O1xuXG5WYWx1ZVBhcnNlci5wcm90b3R5cGUud2FsayA9IGZ1bmN0aW9uKGNiLCBidWJibGUpIHtcbiAgd2Fsayh0aGlzLm5vZGVzLCBjYiwgYnViYmxlKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5WYWx1ZVBhcnNlci51bml0ID0gcmVxdWlyZShcIi4vdW5pdFwiKTtcblxuVmFsdWVQYXJzZXIud2FsayA9IHdhbGs7XG5cblZhbHVlUGFyc2VyLnN0cmluZ2lmeSA9IHN0cmluZ2lmeTtcblxubW9kdWxlLmV4cG9ydHMgPSBWYWx1ZVBhcnNlcjtcbiIsInZhciBvcGVuUGFyZW50aGVzZXMgPSBcIihcIi5jaGFyQ29kZUF0KDApO1xudmFyIGNsb3NlUGFyZW50aGVzZXMgPSBcIilcIi5jaGFyQ29kZUF0KDApO1xudmFyIHNpbmdsZVF1b3RlID0gXCInXCIuY2hhckNvZGVBdCgwKTtcbnZhciBkb3VibGVRdW90ZSA9ICdcIicuY2hhckNvZGVBdCgwKTtcbnZhciBiYWNrc2xhc2ggPSBcIlxcXFxcIi5jaGFyQ29kZUF0KDApO1xudmFyIHNsYXNoID0gXCIvXCIuY2hhckNvZGVBdCgwKTtcbnZhciBjb21tYSA9IFwiLFwiLmNoYXJDb2RlQXQoMCk7XG52YXIgY29sb24gPSBcIjpcIi5jaGFyQ29kZUF0KDApO1xudmFyIHN0YXIgPSBcIipcIi5jaGFyQ29kZUF0KDApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGlucHV0KSB7XG4gIHZhciB0b2tlbnMgPSBbXTtcbiAgdmFyIHZhbHVlID0gaW5wdXQ7XG5cbiAgdmFyIG5leHQsIHF1b3RlLCBwcmV2LCB0b2tlbiwgZXNjYXBlLCBlc2NhcGVQb3MsIHdoaXRlc3BhY2VQb3M7XG4gIHZhciBwb3MgPSAwO1xuICB2YXIgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcbiAgdmFyIG1heCA9IHZhbHVlLmxlbmd0aDtcbiAgdmFyIHN0YWNrID0gW3sgbm9kZXM6IHRva2VucyB9XTtcbiAgdmFyIGJhbGFuY2VkID0gMDtcbiAgdmFyIHBhcmVudDtcblxuICB2YXIgbmFtZSA9IFwiXCI7XG4gIHZhciBiZWZvcmUgPSBcIlwiO1xuICB2YXIgYWZ0ZXIgPSBcIlwiO1xuXG4gIHdoaWxlIChwb3MgPCBtYXgpIHtcbiAgICAvLyBXaGl0ZXNwYWNlc1xuICAgIGlmIChjb2RlIDw9IDMyKSB7XG4gICAgICBuZXh0ID0gcG9zO1xuICAgICAgZG8ge1xuICAgICAgICBuZXh0ICs9IDE7XG4gICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KG5leHQpO1xuICAgICAgfSB3aGlsZSAoY29kZSA8PSAzMik7XG4gICAgICB0b2tlbiA9IHZhbHVlLnNsaWNlKHBvcywgbmV4dCk7XG5cbiAgICAgIHByZXYgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKGNvZGUgPT09IGNsb3NlUGFyZW50aGVzZXMgJiYgYmFsYW5jZWQpIHtcbiAgICAgICAgYWZ0ZXIgPSB0b2tlbjtcbiAgICAgIH0gZWxzZSBpZiAocHJldiAmJiBwcmV2LnR5cGUgPT09IFwiZGl2XCIpIHtcbiAgICAgICAgcHJldi5hZnRlciA9IHRva2VuO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgY29kZSA9PT0gY29tbWEgfHxcbiAgICAgICAgY29kZSA9PT0gY29sb24gfHxcbiAgICAgICAgKGNvZGUgPT09IHNsYXNoICYmIHZhbHVlLmNoYXJDb2RlQXQobmV4dCArIDEpICE9PSBzdGFyKVxuICAgICAgKSB7XG4gICAgICAgIGJlZm9yZSA9IHRva2VuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwic3BhY2VcIixcbiAgICAgICAgICBzb3VyY2VJbmRleDogcG9zLFxuICAgICAgICAgIHZhbHVlOiB0b2tlblxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcG9zID0gbmV4dDtcblxuICAgICAgLy8gUXVvdGVzXG4gICAgfSBlbHNlIGlmIChjb2RlID09PSBzaW5nbGVRdW90ZSB8fCBjb2RlID09PSBkb3VibGVRdW90ZSkge1xuICAgICAgbmV4dCA9IHBvcztcbiAgICAgIHF1b3RlID0gY29kZSA9PT0gc2luZ2xlUXVvdGUgPyBcIidcIiA6ICdcIic7XG4gICAgICB0b2tlbiA9IHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgc291cmNlSW5kZXg6IHBvcyxcbiAgICAgICAgcXVvdGU6IHF1b3RlXG4gICAgICB9O1xuICAgICAgZG8ge1xuICAgICAgICBlc2NhcGUgPSBmYWxzZTtcbiAgICAgICAgbmV4dCA9IHZhbHVlLmluZGV4T2YocXVvdGUsIG5leHQgKyAxKTtcbiAgICAgICAgaWYgKH5uZXh0KSB7XG4gICAgICAgICAgZXNjYXBlUG9zID0gbmV4dDtcbiAgICAgICAgICB3aGlsZSAodmFsdWUuY2hhckNvZGVBdChlc2NhcGVQb3MgLSAxKSA9PT0gYmFja3NsYXNoKSB7XG4gICAgICAgICAgICBlc2NhcGVQb3MgLT0gMTtcbiAgICAgICAgICAgIGVzY2FwZSA9ICFlc2NhcGU7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbHVlICs9IHF1b3RlO1xuICAgICAgICAgIG5leHQgPSB2YWx1ZS5sZW5ndGggLSAxO1xuICAgICAgICAgIHRva2VuLnVuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAoZXNjYXBlKTtcbiAgICAgIHRva2VuLnZhbHVlID0gdmFsdWUuc2xpY2UocG9zICsgMSwgbmV4dCk7XG5cbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgIHBvcyA9IG5leHQgKyAxO1xuICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgICAgLy8gQ29tbWVudHNcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IHNsYXNoICYmIHZhbHVlLmNoYXJDb2RlQXQocG9zICsgMSkgPT09IHN0YXIpIHtcbiAgICAgIHRva2VuID0ge1xuICAgICAgICB0eXBlOiBcImNvbW1lbnRcIixcbiAgICAgICAgc291cmNlSW5kZXg6IHBvc1xuICAgICAgfTtcblxuICAgICAgbmV4dCA9IHZhbHVlLmluZGV4T2YoXCIqL1wiLCBwb3MpO1xuICAgICAgaWYgKG5leHQgPT09IC0xKSB7XG4gICAgICAgIHRva2VuLnVuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgbmV4dCA9IHZhbHVlLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgdG9rZW4udmFsdWUgPSB2YWx1ZS5zbGljZShwb3MgKyAyLCBuZXh0KTtcbiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcblxuICAgICAgcG9zID0gbmV4dCArIDI7XG4gICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChwb3MpO1xuXG4gICAgICAvLyBEaXZpZGVyc1xuICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gc2xhc2ggfHwgY29kZSA9PT0gY29tbWEgfHwgY29kZSA9PT0gY29sb24pIHtcbiAgICAgIHRva2VuID0gdmFsdWVbcG9zXTtcblxuICAgICAgdG9rZW5zLnB1c2goe1xuICAgICAgICB0eXBlOiBcImRpdlwiLFxuICAgICAgICBzb3VyY2VJbmRleDogcG9zIC0gYmVmb3JlLmxlbmd0aCxcbiAgICAgICAgdmFsdWU6IHRva2VuLFxuICAgICAgICBiZWZvcmU6IGJlZm9yZSxcbiAgICAgICAgYWZ0ZXI6IFwiXCJcbiAgICAgIH0pO1xuICAgICAgYmVmb3JlID0gXCJcIjtcblxuICAgICAgcG9zICs9IDE7XG4gICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChwb3MpO1xuXG4gICAgICAvLyBPcGVuIHBhcmVudGhlc2VzXG4gICAgfSBlbHNlIGlmIChvcGVuUGFyZW50aGVzZXMgPT09IGNvZGUpIHtcbiAgICAgIC8vIFdoaXRlc3BhY2VzIGFmdGVyIG9wZW4gcGFyZW50aGVzZXNcbiAgICAgIG5leHQgPSBwb3M7XG4gICAgICBkbyB7XG4gICAgICAgIG5leHQgKz0gMTtcbiAgICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQobmV4dCk7XG4gICAgICB9IHdoaWxlIChjb2RlIDw9IDMyKTtcbiAgICAgIHRva2VuID0ge1xuICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCIsXG4gICAgICAgIHNvdXJjZUluZGV4OiBwb3MgLSBuYW1lLmxlbmd0aCxcbiAgICAgICAgdmFsdWU6IG5hbWUsXG4gICAgICAgIGJlZm9yZTogdmFsdWUuc2xpY2UocG9zICsgMSwgbmV4dClcbiAgICAgIH07XG4gICAgICBwb3MgPSBuZXh0O1xuXG4gICAgICBpZiAobmFtZSA9PT0gXCJ1cmxcIiAmJiBjb2RlICE9PSBzaW5nbGVRdW90ZSAmJiBjb2RlICE9PSBkb3VibGVRdW90ZSkge1xuICAgICAgICBuZXh0IC09IDE7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICBlc2NhcGUgPSBmYWxzZTtcbiAgICAgICAgICBuZXh0ID0gdmFsdWUuaW5kZXhPZihcIilcIiwgbmV4dCArIDEpO1xuICAgICAgICAgIGlmICh+bmV4dCkge1xuICAgICAgICAgICAgZXNjYXBlUG9zID0gbmV4dDtcbiAgICAgICAgICAgIHdoaWxlICh2YWx1ZS5jaGFyQ29kZUF0KGVzY2FwZVBvcyAtIDEpID09PSBiYWNrc2xhc2gpIHtcbiAgICAgICAgICAgICAgZXNjYXBlUG9zIC09IDE7XG4gICAgICAgICAgICAgIGVzY2FwZSA9ICFlc2NhcGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlICs9IFwiKVwiO1xuICAgICAgICAgICAgbmV4dCA9IHZhbHVlLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB0b2tlbi51bmNsb3NlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlIChlc2NhcGUpO1xuICAgICAgICAvLyBXaGl0ZXNwYWNlcyBiZWZvcmUgY2xvc2VkXG4gICAgICAgIHdoaXRlc3BhY2VQb3MgPSBuZXh0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgd2hpdGVzcGFjZVBvcyAtPSAxO1xuICAgICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KHdoaXRlc3BhY2VQb3MpO1xuICAgICAgICB9IHdoaWxlIChjb2RlIDw9IDMyKTtcbiAgICAgICAgaWYgKHBvcyAhPT0gd2hpdGVzcGFjZVBvcyArIDEpIHtcbiAgICAgICAgICB0b2tlbi5ub2RlcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHlwZTogXCJ3b3JkXCIsXG4gICAgICAgICAgICAgIHNvdXJjZUluZGV4OiBwb3MsXG4gICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5zbGljZShwb3MsIHdoaXRlc3BhY2VQb3MgKyAxKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9rZW4ubm9kZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodG9rZW4udW5jbG9zZWQgJiYgd2hpdGVzcGFjZVBvcyArIDEgIT09IG5leHQpIHtcbiAgICAgICAgICB0b2tlbi5hZnRlciA9IFwiXCI7XG4gICAgICAgICAgdG9rZW4ubm9kZXMucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiBcInNwYWNlXCIsXG4gICAgICAgICAgICBzb3VyY2VJbmRleDogd2hpdGVzcGFjZVBvcyArIDEsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUuc2xpY2Uod2hpdGVzcGFjZVBvcyArIDEsIG5leHQpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG9rZW4uYWZ0ZXIgPSB2YWx1ZS5zbGljZSh3aGl0ZXNwYWNlUG9zICsgMSwgbmV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcG9zID0gbmV4dCArIDE7XG4gICAgICAgIGNvZGUgPSB2YWx1ZS5jaGFyQ29kZUF0KHBvcyk7XG4gICAgICAgIHRva2Vucy5wdXNoKHRva2VuKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhbGFuY2VkICs9IDE7XG4gICAgICAgIHRva2VuLmFmdGVyID0gXCJcIjtcbiAgICAgICAgdG9rZW5zLnB1c2godG9rZW4pO1xuICAgICAgICBzdGFjay5wdXNoKHRva2VuKTtcbiAgICAgICAgdG9rZW5zID0gdG9rZW4ubm9kZXMgPSBbXTtcbiAgICAgICAgcGFyZW50ID0gdG9rZW47XG4gICAgICB9XG4gICAgICBuYW1lID0gXCJcIjtcblxuICAgICAgLy8gQ2xvc2UgcGFyZW50aGVzZXNcbiAgICB9IGVsc2UgaWYgKGNsb3NlUGFyZW50aGVzZXMgPT09IGNvZGUgJiYgYmFsYW5jZWQpIHtcbiAgICAgIHBvcyArPSAxO1xuICAgICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgICAgcGFyZW50LmFmdGVyID0gYWZ0ZXI7XG4gICAgICBhZnRlciA9IFwiXCI7XG4gICAgICBiYWxhbmNlZCAtPSAxO1xuICAgICAgc3RhY2sucG9wKCk7XG4gICAgICBwYXJlbnQgPSBzdGFja1tiYWxhbmNlZF07XG4gICAgICB0b2tlbnMgPSBwYXJlbnQubm9kZXM7XG5cbiAgICAgIC8vIFdvcmRzXG4gICAgfSBlbHNlIHtcbiAgICAgIG5leHQgPSBwb3M7XG4gICAgICBkbyB7XG4gICAgICAgIGlmIChjb2RlID09PSBiYWNrc2xhc2gpIHtcbiAgICAgICAgICBuZXh0ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dCArPSAxO1xuICAgICAgICBjb2RlID0gdmFsdWUuY2hhckNvZGVBdChuZXh0KTtcbiAgICAgIH0gd2hpbGUgKFxuICAgICAgICBuZXh0IDwgbWF4ICYmXG4gICAgICAgICEoXG4gICAgICAgICAgY29kZSA8PSAzMiB8fFxuICAgICAgICAgIGNvZGUgPT09IHNpbmdsZVF1b3RlIHx8XG4gICAgICAgICAgY29kZSA9PT0gZG91YmxlUXVvdGUgfHxcbiAgICAgICAgICBjb2RlID09PSBjb21tYSB8fFxuICAgICAgICAgIGNvZGUgPT09IGNvbG9uIHx8XG4gICAgICAgICAgY29kZSA9PT0gc2xhc2ggfHxcbiAgICAgICAgICBjb2RlID09PSBvcGVuUGFyZW50aGVzZXMgfHxcbiAgICAgICAgICAoY29kZSA9PT0gY2xvc2VQYXJlbnRoZXNlcyAmJiBiYWxhbmNlZClcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIHRva2VuID0gdmFsdWUuc2xpY2UocG9zLCBuZXh0KTtcblxuICAgICAgaWYgKG9wZW5QYXJlbnRoZXNlcyA9PT0gY29kZSkge1xuICAgICAgICBuYW1lID0gdG9rZW47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2tlbnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogXCJ3b3JkXCIsXG4gICAgICAgICAgc291cmNlSW5kZXg6IHBvcyxcbiAgICAgICAgICB2YWx1ZTogdG9rZW5cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHBvcyA9IG5leHQ7XG4gICAgfVxuICB9XG5cbiAgZm9yIChwb3MgPSBzdGFjay5sZW5ndGggLSAxOyBwb3M7IHBvcyAtPSAxKSB7XG4gICAgc3RhY2tbcG9zXS51bmNsb3NlZCA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gc3RhY2tbMF0ubm9kZXM7XG59O1xuIiwiZnVuY3Rpb24gc3RyaW5naWZ5Tm9kZShub2RlLCBjdXN0b20pIHtcbiAgdmFyIHR5cGUgPSBub2RlLnR5cGU7XG4gIHZhciB2YWx1ZSA9IG5vZGUudmFsdWU7XG4gIHZhciBidWY7XG4gIHZhciBjdXN0b21SZXN1bHQ7XG5cbiAgaWYgKGN1c3RvbSAmJiAoY3VzdG9tUmVzdWx0ID0gY3VzdG9tKG5vZGUpKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIGN1c3RvbVJlc3VsdDtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcIndvcmRcIiB8fCB0eXBlID09PSBcInNwYWNlXCIpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGJ1ZiA9IG5vZGUucXVvdGUgfHwgXCJcIjtcbiAgICByZXR1cm4gYnVmICsgdmFsdWUgKyAobm9kZS51bmNsb3NlZCA/IFwiXCIgOiBidWYpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY29tbWVudFwiKSB7XG4gICAgcmV0dXJuIFwiLypcIiArIHZhbHVlICsgKG5vZGUudW5jbG9zZWQgPyBcIlwiIDogXCIqL1wiKTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBcImRpdlwiKSB7XG4gICAgcmV0dXJuIChub2RlLmJlZm9yZSB8fCBcIlwiKSArIHZhbHVlICsgKG5vZGUuYWZ0ZXIgfHwgXCJcIik7XG4gIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShub2RlLm5vZGVzKSkge1xuICAgIGJ1ZiA9IHN0cmluZ2lmeShub2RlLm5vZGVzKTtcbiAgICBpZiAodHlwZSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgdmFsdWUgK1xuICAgICAgXCIoXCIgK1xuICAgICAgKG5vZGUuYmVmb3JlIHx8IFwiXCIpICtcbiAgICAgIGJ1ZiArXG4gICAgICAobm9kZS5hZnRlciB8fCBcIlwiKSArXG4gICAgICAobm9kZS51bmNsb3NlZCA/IFwiXCIgOiBcIilcIilcbiAgICApO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KG5vZGVzLCBjdXN0b20pIHtcbiAgdmFyIHJlc3VsdCwgaTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShub2RlcykpIHtcbiAgICByZXN1bHQgPSBcIlwiO1xuICAgIGZvciAoaSA9IG5vZGVzLmxlbmd0aCAtIDE7IH5pOyBpIC09IDEpIHtcbiAgICAgIHJlc3VsdCA9IHN0cmluZ2lmeU5vZGUobm9kZXNbaV0sIGN1c3RvbSkgKyByZXN1bHQ7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ2lmeU5vZGUobm9kZXMsIGN1c3RvbSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RyaW5naWZ5O1xuIiwidmFyIG1pbnVzID0gXCItXCIuY2hhckNvZGVBdCgwKTtcbnZhciBwbHVzID0gXCIrXCIuY2hhckNvZGVBdCgwKTtcbnZhciBkb3QgPSBcIi5cIi5jaGFyQ29kZUF0KDApO1xudmFyIGV4cCA9IFwiZVwiLmNoYXJDb2RlQXQoMCk7XG52YXIgRVhQID0gXCJFXCIuY2hhckNvZGVBdCgwKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB2YXIgcG9zID0gMDtcbiAgdmFyIGxlbmd0aCA9IHZhbHVlLmxlbmd0aDtcbiAgdmFyIGRvdHRlZCA9IGZhbHNlO1xuICB2YXIgc2NpUG9zID0gLTE7XG4gIHZhciBjb250YWluc051bWJlciA9IGZhbHNlO1xuICB2YXIgY29kZTtcblxuICB3aGlsZSAocG9zIDwgbGVuZ3RoKSB7XG4gICAgY29kZSA9IHZhbHVlLmNoYXJDb2RlQXQocG9zKTtcblxuICAgIGlmIChjb2RlID49IDQ4ICYmIGNvZGUgPD0gNTcpIHtcbiAgICAgIGNvbnRhaW5zTnVtYmVyID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IGV4cCB8fCBjb2RlID09PSBFWFApIHtcbiAgICAgIGlmIChzY2lQb3MgPiAtMSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHNjaVBvcyA9IHBvcztcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IGRvdCkge1xuICAgICAgaWYgKGRvdHRlZCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRvdHRlZCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChjb2RlID09PSBwbHVzIHx8IGNvZGUgPT09IG1pbnVzKSB7XG4gICAgICBpZiAocG9zICE9PSAwKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBwb3MgKz0gMTtcbiAgfVxuXG4gIGlmIChzY2lQb3MgKyAxID09PSBwb3MpIHBvcy0tO1xuXG4gIHJldHVybiBjb250YWluc051bWJlclxuICAgID8ge1xuICAgICAgICBudW1iZXI6IHZhbHVlLnNsaWNlKDAsIHBvcyksXG4gICAgICAgIHVuaXQ6IHZhbHVlLnNsaWNlKHBvcylcbiAgICAgIH1cbiAgICA6IGZhbHNlO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gd2Fsayhub2RlcywgY2IsIGJ1YmJsZSkge1xuICB2YXIgaSwgbWF4LCBub2RlLCByZXN1bHQ7XG5cbiAgZm9yIChpID0gMCwgbWF4ID0gbm9kZXMubGVuZ3RoOyBpIDwgbWF4OyBpICs9IDEpIHtcbiAgICBub2RlID0gbm9kZXNbaV07XG4gICAgaWYgKCFidWJibGUpIHtcbiAgICAgIHJlc3VsdCA9IGNiKG5vZGUsIGksIG5vZGVzKTtcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICByZXN1bHQgIT09IGZhbHNlICYmXG4gICAgICBub2RlLnR5cGUgPT09IFwiZnVuY3Rpb25cIiAmJlxuICAgICAgQXJyYXkuaXNBcnJheShub2RlLm5vZGVzKVxuICAgICkge1xuICAgICAgd2Fsayhub2RlLm5vZGVzLCBjYiwgYnViYmxlKTtcbiAgICB9XG5cbiAgICBpZiAoYnViYmxlKSB7XG4gICAgICBjYihub2RlLCBpLCBub2Rlcyk7XG4gICAgfVxuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3Bvc3Rjc3NWYWx1ZVBhcnNlciA9IHJlcXVpcmUoJ3Bvc3Rjc3MtdmFsdWUtcGFyc2VyJyk7XG5cbnZhciBfcG9zdGNzc1ZhbHVlUGFyc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Bvc3Rjc3NWYWx1ZVBhcnNlcik7XG5cbnZhciBfcGFyc2VyID0gcmVxdWlyZSgnLi9wYXJzZXInKTtcblxudmFyIF9yZWR1Y2VyID0gcmVxdWlyZSgnLi9saWIvcmVkdWNlcicpO1xuXG52YXIgX3JlZHVjZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVkdWNlcik7XG5cbnZhciBfc3RyaW5naWZpZXIgPSByZXF1aXJlKCcuL2xpYi9zdHJpbmdpZmllcicpO1xuXG52YXIgX3N0cmluZ2lmaWVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmluZ2lmaWVyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLy8gZXNsaW50LWRpc2FibGUtbGluZVxudmFyIE1BVENIX0NBTEMgPSAvKCg/OlxcLVthLXpdK1xcLSk/Y2FsYykvO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgdmFyIHByZWNpc2lvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogNTtcblxuICByZXR1cm4gKDAsIF9wb3N0Y3NzVmFsdWVQYXJzZXIyLmRlZmF1bHQpKHZhbHVlKS53YWxrKGZ1bmN0aW9uIChub2RlKSB7XG4gICAgLy8gc2tpcCBhbnl0aGluZyB3aGljaCBpc24ndCBhIGNhbGMoKSBmdW5jdGlvblxuICAgIGlmIChub2RlLnR5cGUgIT09ICdmdW5jdGlvbicgfHwgIU1BVENIX0NBTEMudGVzdChub2RlLnZhbHVlKSkgcmV0dXJuO1xuXG4gICAgLy8gc3RyaW5naWZ5IGNhbGMgZXhwcmVzc2lvbiBhbmQgcHJvZHVjZSBhbiBBU1RcbiAgICB2YXIgY29udGVudHMgPSBfcG9zdGNzc1ZhbHVlUGFyc2VyMi5kZWZhdWx0LnN0cmluZ2lmeShub2RlLm5vZGVzKTtcblxuICAgIC8vIHNraXAgY29uc3RhbnQoKSBhbmQgZW52KClcbiAgICBpZiAoY29udGVudHMuaW5kZXhPZignY29uc3RhbnQnKSA+PSAwIHx8IGNvbnRlbnRzLmluZGV4T2YoJ2VudicpID49IDApIHJldHVybjtcblxuICAgIHZhciBhc3QgPSBfcGFyc2VyLnBhcnNlci5wYXJzZShjb250ZW50cyk7XG5cbiAgICAvLyByZWR1Y2UgQVNUIHRvIGl0cyBzaW1wbGVzdCBmb3JtLCB0aGF0IGlzLCBlaXRoZXIgdG8gYSBzaW5nbGUgdmFsdWVcbiAgICAvLyBvciBhIHNpbXBsaWZpZWQgY2FsYyBleHByZXNzaW9uXG4gICAgdmFyIHJlZHVjZWRBc3QgPSAoMCwgX3JlZHVjZXIyLmRlZmF1bHQpKGFzdCwgcHJlY2lzaW9uKTtcblxuICAgIC8vIHN0cmluZ2lmeSBBU1QgYW5kIHdyaXRlIGl0IGJhY2tcbiAgICBub2RlLnR5cGUgPSAnd29yZCc7XG4gICAgbm9kZS52YWx1ZSA9ICgwLCBfc3RyaW5naWZpZXIyLmRlZmF1bHQpKG5vZGUudmFsdWUsIHJlZHVjZWRBc3QsIHByZWNpc2lvbik7XG4gIH0sIHRydWUpLnRvU3RyaW5nKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTsiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3NzVW5pdENvbnZlcnRlciA9IHJlcXVpcmUoJ2Nzcy11bml0LWNvbnZlcnRlcicpO1xuXG52YXIgX2Nzc1VuaXRDb252ZXJ0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY3NzVW5pdENvbnZlcnRlcik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIGNvbnZlcnROb2RlcyhsZWZ0LCByaWdodCwgcHJlY2lzaW9uKSB7XG4gIHN3aXRjaCAobGVmdC50eXBlKSB7XG4gICAgY2FzZSAnTGVuZ3RoVmFsdWUnOlxuICAgIGNhc2UgJ0FuZ2xlVmFsdWUnOlxuICAgIGNhc2UgJ1RpbWVWYWx1ZSc6XG4gICAgY2FzZSAnRnJlcXVlbmN5VmFsdWUnOlxuICAgIGNhc2UgJ1Jlc29sdXRpb25WYWx1ZSc6XG4gICAgICByZXR1cm4gY29udmVydEFic29sdXRlTGVuZ3RoKGxlZnQsIHJpZ2h0LCBwcmVjaXNpb24pO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4geyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjb252ZXJ0QWJzb2x1dGVMZW5ndGgobGVmdCwgcmlnaHQsIHByZWNpc2lvbikge1xuICBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC50eXBlKSB7XG4gICAgcmlnaHQgPSB7XG4gICAgICB0eXBlOiBsZWZ0LnR5cGUsXG4gICAgICB2YWx1ZTogKDAsIF9jc3NVbml0Q29udmVydGVyMi5kZWZhdWx0KShyaWdodC52YWx1ZSwgcmlnaHQudW5pdCwgbGVmdC51bml0LCBwcmVjaXNpb24pLFxuICAgICAgdW5pdDogbGVmdC51bml0XG4gICAgfTtcbiAgfVxuICByZXR1cm4geyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQgfTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gY29udmVydE5vZGVzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107IiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5mbGlwID0gZmxpcDtcblxudmFyIF9jb252ZXJ0ID0gcmVxdWlyZSgnLi9jb252ZXJ0Jyk7XG5cbnZhciBfY29udmVydDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb252ZXJ0KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gcmVkdWNlKG5vZGUsIHByZWNpc2lvbikge1xuICBpZiAobm9kZS50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHJldHVybiByZWR1Y2VNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pO1xuXG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiBpc0VxdWFsKGxlZnQsIHJpZ2h0KSB7XG4gIHJldHVybiBsZWZ0LnR5cGUgPT09IHJpZ2h0LnR5cGUgJiYgbGVmdC52YWx1ZSA9PT0gcmlnaHQudmFsdWU7XG59XG5cbmZ1bmN0aW9uIGlzVmFsdWVUeXBlKHR5cGUpIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnTGVuZ3RoVmFsdWUnOlxuICAgIGNhc2UgJ0FuZ2xlVmFsdWUnOlxuICAgIGNhc2UgJ1RpbWVWYWx1ZSc6XG4gICAgY2FzZSAnRnJlcXVlbmN5VmFsdWUnOlxuICAgIGNhc2UgJ1Jlc29sdXRpb25WYWx1ZSc6XG4gICAgY2FzZSAnRW1WYWx1ZSc6XG4gICAgY2FzZSAnRXhWYWx1ZSc6XG4gICAgY2FzZSAnQ2hWYWx1ZSc6XG4gICAgY2FzZSAnUmVtVmFsdWUnOlxuICAgIGNhc2UgJ1ZoVmFsdWUnOlxuICAgIGNhc2UgJ1Z3VmFsdWUnOlxuICAgIGNhc2UgJ1ZtaW5WYWx1ZSc6XG4gICAgY2FzZSAnVm1heFZhbHVlJzpcbiAgICBjYXNlICdQZXJjZW50YWdlVmFsdWUnOlxuICAgIGNhc2UgJ1ZhbHVlJzpcbiAgICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY29udmVydE1hdGhFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICB2YXIgbm9kZXMgPSAoMCwgX2NvbnZlcnQyLmRlZmF1bHQpKG5vZGUubGVmdCwgbm9kZS5yaWdodCwgcHJlY2lzaW9uKTtcbiAgdmFyIGxlZnQgPSByZWR1Y2Uobm9kZXMubGVmdCwgcHJlY2lzaW9uKTtcbiAgdmFyIHJpZ2h0ID0gcmVkdWNlKG5vZGVzLnJpZ2h0LCBwcmVjaXNpb24pO1xuXG4gIGlmIChsZWZ0LnR5cGUgPT09IFwiTWF0aEV4cHJlc3Npb25cIiAmJiByaWdodC50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHtcblxuICAgIGlmIChsZWZ0Lm9wZXJhdG9yID09PSAnLycgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcqJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnLScgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcrJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnKicgJiYgcmlnaHQub3BlcmF0b3IgPT09ICcvJyB8fCBsZWZ0Lm9wZXJhdG9yID09PSAnKycgJiYgcmlnaHQub3BlcmF0b3IgPT09ICctJykge1xuXG4gICAgICBpZiAoaXNFcXVhbChsZWZ0LnJpZ2h0LCByaWdodC5yaWdodCkpIG5vZGVzID0gKDAsIF9jb252ZXJ0Mi5kZWZhdWx0KShsZWZ0LmxlZnQsIHJpZ2h0LmxlZnQsIHByZWNpc2lvbik7ZWxzZSBpZiAoaXNFcXVhbChsZWZ0LnJpZ2h0LCByaWdodC5sZWZ0KSkgbm9kZXMgPSAoMCwgX2NvbnZlcnQyLmRlZmF1bHQpKGxlZnQubGVmdCwgcmlnaHQucmlnaHQsIHByZWNpc2lvbik7XG5cbiAgICAgIGxlZnQgPSByZWR1Y2Uobm9kZXMubGVmdCwgcHJlY2lzaW9uKTtcbiAgICAgIHJpZ2h0ID0gcmVkdWNlKG5vZGVzLnJpZ2h0LCBwcmVjaXNpb24pO1xuICAgIH1cbiAgfVxuXG4gIG5vZGUubGVmdCA9IGxlZnQ7XG4gIG5vZGUucmlnaHQgPSByaWdodDtcbiAgcmV0dXJuIG5vZGU7XG59XG5cbmZ1bmN0aW9uIGZsaXAob3BlcmF0b3IpIHtcbiAgcmV0dXJuIG9wZXJhdG9yID09PSAnKycgPyAnLScgOiAnKyc7XG59XG5cbmZ1bmN0aW9uIGZsaXBWYWx1ZShub2RlKSB7XG4gIGlmIChpc1ZhbHVlVHlwZShub2RlLnR5cGUpKSBub2RlLnZhbHVlID0gLW5vZGUudmFsdWU7ZWxzZSBpZiAobm9kZS50eXBlID09ICdNYXRoRXhwcmVzc2lvbicpIHtcbiAgICBub2RlLmxlZnQgPSBmbGlwVmFsdWUobm9kZS5sZWZ0KTtcbiAgICBub2RlLnJpZ2h0ID0gZmxpcFZhbHVlKG5vZGUucmlnaHQpO1xuICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VBZGRTdWJFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICB2YXIgX25vZGUgPSBub2RlLFxuICAgICAgbGVmdCA9IF9ub2RlLmxlZnQsXG4gICAgICByaWdodCA9IF9ub2RlLnJpZ2h0LFxuICAgICAgb3AgPSBfbm9kZS5vcGVyYXRvcjtcblxuXG4gIGlmIChsZWZ0LnR5cGUgPT09ICdDc3NWYXJpYWJsZScgfHwgcmlnaHQudHlwZSA9PT0gJ0Nzc1ZhcmlhYmxlJykgcmV0dXJuIG5vZGU7XG5cbiAgLy8gc29tZXRoaW5nICsgMCA9PiBzb21ldGhpbmdcbiAgLy8gc29tZXRoaW5nIC0gMCA9PiBzb21ldGhpbmdcbiAgaWYgKHJpZ2h0LnZhbHVlID09PSAwKSByZXR1cm4gbGVmdDtcblxuICAvLyAwICsgc29tZXRoaW5nID0+IHNvbWV0aGluZ1xuICBpZiAobGVmdC52YWx1ZSA9PT0gMCAmJiBvcCA9PT0gXCIrXCIpIHJldHVybiByaWdodDtcblxuICAvLyAwIC0gc29tZXRoaW5nID0+IC1zb21ldGhpbmdcbiAgaWYgKGxlZnQudmFsdWUgPT09IDAgJiYgb3AgPT09IFwiLVwiKSByZXR1cm4gZmxpcFZhbHVlKHJpZ2h0KTtcblxuICAvLyB2YWx1ZSArIHZhbHVlXG4gIC8vIHZhbHVlIC0gdmFsdWVcbiAgaWYgKGxlZnQudHlwZSA9PT0gcmlnaHQudHlwZSAmJiBpc1ZhbHVlVHlwZShsZWZ0LnR5cGUpKSB7XG4gICAgbm9kZSA9IE9iamVjdC5hc3NpZ24oe30sIGxlZnQpO1xuICAgIGlmIChvcCA9PT0gXCIrXCIpIG5vZGUudmFsdWUgPSBsZWZ0LnZhbHVlICsgcmlnaHQudmFsdWU7ZWxzZSBub2RlLnZhbHVlID0gbGVmdC52YWx1ZSAtIHJpZ2h0LnZhbHVlO1xuICB9XG5cbiAgLy8gdmFsdWUgPG9wPiAoZXhwcilcbiAgaWYgKGlzVmFsdWVUeXBlKGxlZnQudHlwZSkgJiYgKHJpZ2h0Lm9wZXJhdG9yID09PSAnKycgfHwgcmlnaHQub3BlcmF0b3IgPT09ICctJykgJiYgcmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgIC8vIHZhbHVlICsgKHZhbHVlICsgc29tZXRoaW5nKSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyB2YWx1ZSArICh2YWx1ZSAtIHNvbWV0aGluZykgPT4gKHZhbHVlICsgdmFsdWUpIC0gc29tZXRoaW5nXG4gICAgLy8gdmFsdWUgLSAodmFsdWUgKyBzb21ldGhpbmcpID0+ICh2YWx1ZSAtIHZhbHVlKSAtIHNvbWV0aGluZ1xuICAgIC8vIHZhbHVlIC0gKHZhbHVlIC0gc29tZXRoaW5nKSA9PiAodmFsdWUgLSB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICBpZiAobGVmdC50eXBlID09PSByaWdodC5sZWZ0LnR5cGUpIHtcbiAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBub2RlKTtcbiAgICAgIG5vZGUubGVmdCA9IHJlZHVjZSh7XG4gICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgIG9wZXJhdG9yOiBvcCxcbiAgICAgICAgbGVmdDogbGVmdCxcbiAgICAgICAgcmlnaHQ6IHJpZ2h0LmxlZnRcbiAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICBub2RlLnJpZ2h0ID0gcmlnaHQucmlnaHQ7XG4gICAgICBub2RlLm9wZXJhdG9yID0gb3AgPT09ICctJyA/IGZsaXAocmlnaHQub3BlcmF0b3IpIDogcmlnaHQub3BlcmF0b3I7XG4gICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgfVxuICAgIC8vIHZhbHVlICsgKHNvbWV0aGluZyArIHZhbHVlKSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyB2YWx1ZSArIChzb21ldGhpbmcgLSB2YWx1ZSkgPT4gKHZhbHVlIC0gdmFsdWUpICsgc29tZXRoaW5nXG4gICAgLy8gdmFsdWUgLSAoc29tZXRoaW5nICsgdmFsdWUpID0+ICh2YWx1ZSAtIHZhbHVlKSAtIHNvbWV0aGluZ1xuICAgIC8vIHZhbHVlIC0gKHNvbWV0aGluZyAtIHZhbHVlKSA9PiAodmFsdWUgKyB2YWx1ZSkgLSBzb21ldGhpbmdcbiAgICBlbHNlIGlmIChsZWZ0LnR5cGUgPT09IHJpZ2h0LnJpZ2h0LnR5cGUpIHtcbiAgICAgICAgbm9kZSA9IE9iamVjdC5hc3NpZ24oe30sIG5vZGUpO1xuICAgICAgICBub2RlLmxlZnQgPSByZWR1Y2Uoe1xuICAgICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgICAgb3BlcmF0b3I6IG9wID09PSAnLScgPyBmbGlwKHJpZ2h0Lm9wZXJhdG9yKSA6IHJpZ2h0Lm9wZXJhdG9yLFxuICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgcmlnaHQ6IHJpZ2h0LnJpZ2h0XG4gICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgIG5vZGUucmlnaHQgPSByaWdodC5sZWZ0O1xuICAgICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgICB9XG4gIH1cblxuICAvLyAoZXhwcikgPG9wPiB2YWx1ZVxuICBpZiAobGVmdC50eXBlID09PSAnTWF0aEV4cHJlc3Npb24nICYmIChsZWZ0Lm9wZXJhdG9yID09PSAnKycgfHwgbGVmdC5vcGVyYXRvciA9PT0gJy0nKSAmJiBpc1ZhbHVlVHlwZShyaWdodC50eXBlKSkge1xuICAgIC8vICh2YWx1ZSArIHNvbWV0aGluZykgKyB2YWx1ZSA9PiAodmFsdWUgKyB2YWx1ZSkgKyBzb21ldGhpbmdcbiAgICAvLyAodmFsdWUgLSBzb21ldGhpbmcpICsgdmFsdWUgPT4gKHZhbHVlICsgdmFsdWUpIC0gc29tZXRoaW5nXG4gICAgLy8gKHZhbHVlICsgc29tZXRoaW5nKSAtIHZhbHVlID0+ICh2YWx1ZSAtIHZhbHVlKSArIHNvbWV0aGluZ1xuICAgIC8vICh2YWx1ZSAtIHNvbWV0aGluZykgLSB2YWx1ZSA9PiAodmFsdWUgLSB2YWx1ZSkgLSBzb21ldGhpbmdcbiAgICBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC5sZWZ0LnR5cGUpIHtcbiAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBsZWZ0KTtcbiAgICAgIG5vZGUubGVmdCA9IHJlZHVjZSh7XG4gICAgICAgIHR5cGU6ICdNYXRoRXhwcmVzc2lvbicsXG4gICAgICAgIG9wZXJhdG9yOiBvcCxcbiAgICAgICAgbGVmdDogbGVmdC5sZWZ0LFxuICAgICAgICByaWdodDogcmlnaHRcbiAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICByZXR1cm4gcmVkdWNlKG5vZGUsIHByZWNpc2lvbik7XG4gICAgfVxuICAgIC8vIChzb21ldGhpbmcgKyB2YWx1ZSkgKyB2YWx1ZSA9PiBzb21ldGhpbmcgKyAodmFsdWUgKyB2YWx1ZSlcbiAgICAvLyAoc29tZXRoaW5nIC0gdmFsdWUxKSArIHZhbHVlMiA9PiBzb21ldGhpbmcgLSAodmFsdWUyIC0gdmFsdWUxKVxuICAgIC8vIChzb21ldGhpbmcgKyB2YWx1ZSkgLSB2YWx1ZSA9PiBzb21ldGhpbmcgKyAodmFsdWUgLSB2YWx1ZSlcbiAgICAvLyAoc29tZXRoaW5nIC0gdmFsdWUpIC0gdmFsdWUgPT4gc29tZXRoaW5nIC0gKHZhbHVlICsgdmFsdWUpXG4gICAgZWxzZSBpZiAocmlnaHQudHlwZSA9PT0gbGVmdC5yaWdodC50eXBlKSB7XG4gICAgICAgIG5vZGUgPSBPYmplY3QuYXNzaWduKHt9LCBsZWZ0KTtcbiAgICAgICAgaWYgKGxlZnQub3BlcmF0b3IgPT09ICctJykge1xuICAgICAgICAgIG5vZGUucmlnaHQgPSByZWR1Y2Uoe1xuICAgICAgICAgICAgdHlwZTogJ01hdGhFeHByZXNzaW9uJyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBvcCA9PT0gJy0nID8gJysnIDogJy0nLFxuICAgICAgICAgICAgbGVmdDogcmlnaHQsXG4gICAgICAgICAgICByaWdodDogbGVmdC5yaWdodFxuICAgICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgICAgbm9kZS5vcGVyYXRvciA9IG9wID09PSAnLScgPyAnLScgOiAnKyc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbm9kZS5yaWdodCA9IHJlZHVjZSh7XG4gICAgICAgICAgICB0eXBlOiAnTWF0aEV4cHJlc3Npb24nLFxuICAgICAgICAgICAgb3BlcmF0b3I6IG9wLFxuICAgICAgICAgICAgbGVmdDogbGVmdC5yaWdodCxcbiAgICAgICAgICAgIHJpZ2h0OiByaWdodFxuICAgICAgICAgIH0sIHByZWNpc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUucmlnaHQudmFsdWUgPCAwKSB7XG4gICAgICAgICAgbm9kZS5yaWdodC52YWx1ZSAqPSAtMTtcbiAgICAgICAgICBub2RlLm9wZXJhdG9yID0gbm9kZS5vcGVyYXRvciA9PT0gJy0nID8gJysnIDogJy0nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWR1Y2Uobm9kZSwgcHJlY2lzaW9uKTtcbiAgICAgIH1cbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cblxuZnVuY3Rpb24gcmVkdWNlRGl2aXNpb25FeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbikge1xuICBpZiAoIWlzVmFsdWVUeXBlKG5vZGUucmlnaHQudHlwZSkpIHJldHVybiBub2RlO1xuXG4gIGlmIChub2RlLnJpZ2h0LnR5cGUgIT09ICdWYWx1ZScpIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGRpdmlkZSBieSBcIicgKyBub2RlLnJpZ2h0LnVuaXQgKyAnXCIsIG51bWJlciBleHBlY3RlZCcpO1xuXG4gIGlmIChub2RlLnJpZ2h0LnZhbHVlID09PSAwKSB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBkaXZpZGUgYnkgemVybycpO1xuXG4gIC8vIChleHByKSAvIHZhbHVlXG4gIGlmIChub2RlLmxlZnQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgIGlmIChpc1ZhbHVlVHlwZShub2RlLmxlZnQubGVmdC50eXBlKSAmJiBpc1ZhbHVlVHlwZShub2RlLmxlZnQucmlnaHQudHlwZSkpIHtcbiAgICAgIG5vZGUubGVmdC5sZWZ0LnZhbHVlIC89IG5vZGUucmlnaHQudmFsdWU7XG4gICAgICBub2RlLmxlZnQucmlnaHQudmFsdWUgLz0gbm9kZS5yaWdodC52YWx1ZTtcbiAgICAgIHJldHVybiByZWR1Y2Uobm9kZS5sZWZ0LCBwcmVjaXNpb24pO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuICAvLyBzb21ldGhpbmcgLyB2YWx1ZVxuICBlbHNlIGlmIChpc1ZhbHVlVHlwZShub2RlLmxlZnQudHlwZSkpIHtcbiAgICAgIG5vZGUubGVmdC52YWx1ZSAvPSBub2RlLnJpZ2h0LnZhbHVlO1xuICAgICAgcmV0dXJuIG5vZGUubGVmdDtcbiAgICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VNdWx0aXBsaWNhdGlvbkV4cHJlc3Npb24obm9kZSkge1xuICAvLyAoZXhwcikgKiB2YWx1ZVxuICBpZiAobm9kZS5sZWZ0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgbm9kZS5yaWdodC50eXBlID09PSAnVmFsdWUnKSB7XG4gICAgaWYgKGlzVmFsdWVUeXBlKG5vZGUubGVmdC5sZWZ0LnR5cGUpICYmIGlzVmFsdWVUeXBlKG5vZGUubGVmdC5yaWdodC50eXBlKSkge1xuICAgICAgbm9kZS5sZWZ0LmxlZnQudmFsdWUgKj0gbm9kZS5yaWdodC52YWx1ZTtcbiAgICAgIG5vZGUubGVmdC5yaWdodC52YWx1ZSAqPSBub2RlLnJpZ2h0LnZhbHVlO1xuICAgICAgcmV0dXJuIG5vZGUubGVmdDtcbiAgICB9XG4gIH1cbiAgLy8gc29tZXRoaW5nICogdmFsdWVcbiAgZWxzZSBpZiAoaXNWYWx1ZVR5cGUobm9kZS5sZWZ0LnR5cGUpICYmIG5vZGUucmlnaHQudHlwZSA9PT0gJ1ZhbHVlJykge1xuICAgICAgbm9kZS5sZWZ0LnZhbHVlICo9IG5vZGUucmlnaHQudmFsdWU7XG4gICAgICByZXR1cm4gbm9kZS5sZWZ0O1xuICAgIH1cbiAgICAvLyB2YWx1ZSAqIChleHByKVxuICAgIGVsc2UgaWYgKG5vZGUubGVmdC50eXBlID09PSAnVmFsdWUnICYmIG5vZGUucmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJykge1xuICAgICAgICBpZiAoaXNWYWx1ZVR5cGUobm9kZS5yaWdodC5sZWZ0LnR5cGUpICYmIGlzVmFsdWVUeXBlKG5vZGUucmlnaHQucmlnaHQudHlwZSkpIHtcbiAgICAgICAgICBub2RlLnJpZ2h0LmxlZnQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIG5vZGUucmlnaHQucmlnaHQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIHJldHVybiBub2RlLnJpZ2h0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyB2YWx1ZSAqIHNvbWV0aGluZ1xuICAgICAgZWxzZSBpZiAobm9kZS5sZWZ0LnR5cGUgPT09ICdWYWx1ZScgJiYgaXNWYWx1ZVR5cGUobm9kZS5yaWdodC50eXBlKSkge1xuICAgICAgICAgIG5vZGUucmlnaHQudmFsdWUgKj0gbm9kZS5sZWZ0LnZhbHVlO1xuICAgICAgICAgIHJldHVybiBub2RlLnJpZ2h0O1xuICAgICAgICB9XG4gIHJldHVybiBub2RlO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pIHtcbiAgbm9kZSA9IGNvbnZlcnRNYXRoRXhwcmVzc2lvbihub2RlLCBwcmVjaXNpb24pO1xuXG4gIHN3aXRjaCAobm9kZS5vcGVyYXRvcikge1xuICAgIGNhc2UgXCIrXCI6XG4gICAgY2FzZSBcIi1cIjpcbiAgICAgIHJldHVybiByZWR1Y2VBZGRTdWJFeHByZXNzaW9uKG5vZGUsIHByZWNpc2lvbik7XG4gICAgY2FzZSBcIi9cIjpcbiAgICAgIHJldHVybiByZWR1Y2VEaXZpc2lvbkV4cHJlc3Npb24obm9kZSwgcHJlY2lzaW9uKTtcbiAgICBjYXNlIFwiKlwiOlxuICAgICAgcmV0dXJuIHJlZHVjZU11bHRpcGxpY2F0aW9uRXhwcmVzc2lvbihub2RlKTtcbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gcmVkdWNlOyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmdW5jdGlvbiAoY2FsYywgbm9kZSwgcHJlY2lzaW9uKSB7XG4gIHZhciBzdHIgPSBzdHJpbmdpZnkobm9kZSwgcHJlY2lzaW9uKTtcblxuICBpZiAobm9kZS50eXBlID09PSBcIk1hdGhFeHByZXNzaW9uXCIpIHtcbiAgICAvLyBpZiBjYWxjIGV4cHJlc3Npb24gY291bGRuJ3QgYmUgcmVzb2x2ZWQgdG8gYSBzaW5nbGUgdmFsdWUsIHJlLXdyYXAgaXQgYXNcbiAgICAvLyBhIGNhbGMoKVxuICAgIHN0ciA9IGNhbGMgKyBcIihcIiArIHN0ciArIFwiKVwiO1xuICB9XG4gIHJldHVybiBzdHI7XG59O1xuXG52YXIgX3JlZHVjZXIgPSByZXF1aXJlKFwiLi9yZWR1Y2VyXCIpO1xuXG52YXIgb3JkZXIgPSB7XG4gIFwiKlwiOiAwLFxuICBcIi9cIjogMCxcbiAgXCIrXCI6IDEsXG4gIFwiLVwiOiAxXG59O1xuXG5mdW5jdGlvbiByb3VuZCh2YWx1ZSwgcHJlYykge1xuICBpZiAocHJlYyAhPT0gZmFsc2UpIHtcbiAgICB2YXIgcHJlY2lzaW9uID0gTWF0aC5wb3coMTAsIHByZWMpO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbHVlICogcHJlY2lzaW9uKSAvIHByZWNpc2lvbjtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShub2RlLCBwcmVjKSB7XG4gIHN3aXRjaCAobm9kZS50eXBlKSB7XG4gICAgY2FzZSBcIk1hdGhFeHByZXNzaW9uXCI6XG4gICAgICB7XG4gICAgICAgIHZhciBsZWZ0ID0gbm9kZS5sZWZ0LFxuICAgICAgICAgICAgcmlnaHQgPSBub2RlLnJpZ2h0LFxuICAgICAgICAgICAgb3AgPSBub2RlLm9wZXJhdG9yO1xuXG4gICAgICAgIHZhciBzdHIgPSBcIlwiO1xuXG4gICAgICAgIGlmIChsZWZ0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgb3JkZXJbb3BdIDwgb3JkZXJbbGVmdC5vcGVyYXRvcl0pIHN0ciArPSBcIihcIiArIHN0cmluZ2lmeShsZWZ0LCBwcmVjKSArIFwiKVwiO2Vsc2Ugc3RyICs9IHN0cmluZ2lmeShsZWZ0LCBwcmVjKTtcblxuICAgICAgICBzdHIgKz0gXCIgXCIgKyBub2RlLm9wZXJhdG9yICsgXCIgXCI7XG5cbiAgICAgICAgaWYgKHJpZ2h0LnR5cGUgPT09ICdNYXRoRXhwcmVzc2lvbicgJiYgb3JkZXJbb3BdIDwgb3JkZXJbcmlnaHQub3BlcmF0b3JdKSBzdHIgKz0gXCIoXCIgKyBzdHJpbmdpZnkocmlnaHQsIHByZWMpICsgXCIpXCI7ZWxzZSBpZiAocmlnaHQudHlwZSA9PT0gJ01hdGhFeHByZXNzaW9uJyAmJiBvcCA9PT0gXCItXCIgJiYgW1wiK1wiLCBcIi1cIl0uaW5jbHVkZXMocmlnaHQub3BlcmF0b3IpKSB7XG4gICAgICAgICAgLy8gZml4ICM1MiA6IGEtKGIrYykgPSBhLWItY1xuICAgICAgICAgIHJpZ2h0Lm9wZXJhdG9yID0gKDAsIF9yZWR1Y2VyLmZsaXApKHJpZ2h0Lm9wZXJhdG9yKTtcbiAgICAgICAgICBzdHIgKz0gc3RyaW5naWZ5KHJpZ2h0LCBwcmVjKTtcbiAgICAgICAgfSBlbHNlIHN0ciArPSBzdHJpbmdpZnkocmlnaHQsIHByZWMpO1xuXG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgICB9XG4gICAgY2FzZSBcIlZhbHVlXCI6XG4gICAgICByZXR1cm4gcm91bmQobm9kZS52YWx1ZSwgcHJlYyk7XG4gICAgY2FzZSAnQ3NzVmFyaWFibGUnOlxuICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiByb3VuZChub2RlLnZhbHVlLCBwcmVjKSArIG5vZGUudW5pdDtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdOyIsIlxuLyogcGFyc2VyIGdlbmVyYXRlZCBieSBqaXNvbiAwLjYuMS0yMTUgKi9cblxuLypcbiAqIFJldHVybnMgYSBQYXJzZXIgb2JqZWN0IG9mIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuICpcbiAqICBQYXJzZXI6IHtcbiAqICAgIHl5OiB7fSAgICAgVGhlIHNvLWNhbGxlZCBcInNoYXJlZCBzdGF0ZVwiIG9yIHJhdGhlciB0aGUgKnNvdXJjZSogb2YgaXQ7XG4gKiAgICAgICAgICAgICAgIHRoZSByZWFsIFwic2hhcmVkIHN0YXRlXCIgYHl5YCBwYXNzZWQgYXJvdW5kIHRvXG4gKiAgICAgICAgICAgICAgIHRoZSBydWxlIGFjdGlvbnMsIGV0Yy4gaXMgYSBkZXJpdmF0aXZlL2NvcHkgb2YgdGhpcyBvbmUsXG4gKiAgICAgICAgICAgICAgIG5vdCBhIGRpcmVjdCByZWZlcmVuY2UhXG4gKiAgfVxuICpcbiAqICBQYXJzZXIucHJvdG90eXBlOiB7XG4gKiAgICB5eToge30sXG4gKiAgICBFT0Y6IDEsXG4gKiAgICBURVJST1I6IDIsXG4gKlxuICogICAgdHJhY2U6IGZ1bmN0aW9uKGVycm9yTWVzc2FnZSwgLi4uKSxcbiAqXG4gKiAgICBKaXNvblBhcnNlckVycm9yOiBmdW5jdGlvbihtc2csIGhhc2gpLFxuICpcbiAqICAgIHF1b3RlTmFtZTogZnVuY3Rpb24obmFtZSksXG4gKiAgICAgICAgICAgICAgIEhlbHBlciBmdW5jdGlvbiB3aGljaCBjYW4gYmUgb3ZlcnJpZGRlbiBieSB1c2VyIGNvZGUgbGF0ZXIgb246IHB1dCBzdWl0YWJsZVxuICogICAgICAgICAgICAgICBxdW90ZXMgYXJvdW5kIGxpdGVyYWwgSURzIGluIGEgZGVzY3JpcHRpb24gc3RyaW5nLlxuICpcbiAqICAgIG9yaWdpbmFsUXVvdGVOYW1lOiBmdW5jdGlvbihuYW1lKSxcbiAqICAgICAgICAgICAgICAgVGhlIGJhc2ljIHF1b3RlTmFtZSBoYW5kbGVyIHByb3ZpZGVkIGJ5IEpJU09OLlxuICogICAgICAgICAgICAgICBgY2xlYW51cEFmdGVyUGFyc2UoKWAgd2lsbCBjbGVhbiB1cCBhbmQgcmVzZXQgYHF1b3RlTmFtZSgpYCB0byByZWZlcmVuY2UgdGhpcyBmdW5jdGlvblxuICogICAgICAgICAgICAgICBhdCB0aGUgZW5kIG9mIHRoZSBgcGFyc2UoKWAuXG4gKlxuICogICAgZGVzY3JpYmVTeW1ib2w6IGZ1bmN0aW9uKHN5bWJvbCksXG4gKiAgICAgICAgICAgICAgIFJldHVybiBhIG1vcmUtb3ItbGVzcyBodW1hbi1yZWFkYWJsZSBkZXNjcmlwdGlvbiBvZiB0aGUgZ2l2ZW4gc3ltYm9sLCB3aGVuXG4gKiAgICAgICAgICAgICAgIGF2YWlsYWJsZSwgb3IgdGhlIHN5bWJvbCBpdHNlbGYsIHNlcnZpbmcgYXMgaXRzIG93biAnZGVzY3JpcHRpb24nIGZvciBsYWNrXG4gKiAgICAgICAgICAgICAgIG9mIHNvbWV0aGluZyBiZXR0ZXIgdG8gc2VydmUgdXAuXG4gKlxuICogICAgICAgICAgICAgICBSZXR1cm4gTlVMTCB3aGVuIHRoZSBzeW1ib2wgaXMgdW5rbm93biB0byB0aGUgcGFyc2VyLlxuICpcbiAqICAgIHN5bWJvbHNfOiB7YXNzb2NpYXRpdmUgbGlzdDogbmFtZSA9PT4gbnVtYmVyfSxcbiAqICAgIHRlcm1pbmFsc186IHthc3NvY2lhdGl2ZSBsaXN0OiBudW1iZXIgPT0+IG5hbWV9LFxuICogICAgbm9udGVybWluYWxzOiB7YXNzb2NpYXRpdmUgbGlzdDogcnVsZS1uYW1lID09PiB7YXNzb2NpYXRpdmUgbGlzdDogbnVtYmVyID09PiBydWxlLWFsdH19LFxuICogICAgdGVybWluYWxfZGVzY3JpcHRpb25zXzogKGlmIHRoZXJlIGFyZSBhbnkpIHthc3NvY2lhdGl2ZSBsaXN0OiBudW1iZXIgPT0+IGRlc2NyaXB0aW9ufSxcbiAqICAgIHByb2R1Y3Rpb25zXzogWy4uLl0sXG4gKlxuICogICAgcGVyZm9ybUFjdGlvbjogZnVuY3Rpb24gcGFyc2VyX19wZXJmb3JtQWN0aW9uKHl5dGV4dCwgeXlsZW5nLCB5eWxpbmVubywgeXlsb2MsIHl5c3RhdGUsIHl5c3AsIHl5dnN0YWNrLCB5eWxzdGFjaywgeXlzdGFjaywgeXlzc3RhY2spLFxuICpcbiAqICAgICAgICAgICAgICAgVGhlIGZ1bmN0aW9uIHBhcmFtZXRlcnMgYW5kIGB0aGlzYCBoYXZlIHRoZSBmb2xsb3dpbmcgdmFsdWUvbWVhbmluZzpcbiAqICAgICAgICAgICAgICAgLSBgdGhpc2AgICAgOiByZWZlcmVuY2UgdG8gdGhlIGB5eXZhbGAgaW50ZXJuYWwgb2JqZWN0LCB3aGljaCBoYXMgbWVtYmVycyAoYCRgIGFuZCBgXyRgKVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHN0b3JlL3JlZmVyZW5jZSB0aGUgcnVsZSB2YWx1ZSBgJCRgIGFuZCBsb2NhdGlvbiBpbmZvIGBAJGAuXG4gKlxuICogICAgICAgICAgICAgICAgIE9uZSBpbXBvcnRhbnQgdGhpbmcgdG8gbm90ZSBhYm91dCBgdGhpc2AgYS5rLmEuIGB5eXZhbGA6IGV2ZXJ5ICpyZWR1Y2UqIGFjdGlvbiBnZXRzXG4gKiAgICAgICAgICAgICAgICAgdG8gc2VlIHRoZSBzYW1lIG9iamVjdCB2aWEgdGhlIGB0aGlzYCByZWZlcmVuY2UsIGkuZS4gaWYgeW91IHdpc2ggdG8gY2FycnkgY3VzdG9tXG4gKiAgICAgICAgICAgICAgICAgZGF0YSBmcm9tIG9uZSByZWR1Y2UgYWN0aW9uIHRocm91Z2ggdG8gdGhlIG5leHQgd2l0aGluIGEgc2luZ2xlIHBhcnNlIHJ1biwgdGhlbiB5b3VcbiAqICAgICAgICAgICAgICAgICBtYXkgZ2V0IG5hc3R5IGFuZCB1c2UgYHl5dmFsYCBhLmsuYS4gYHRoaXNgIGZvciBzdG9yaW5nIHlvdSBvd24gc2VtaS1wZXJtYW5lbnQgZGF0YS5cbiAqXG4gKiAgICAgICAgICAgICAgICAgYHRoaXMueXlgIGlzIGEgZGlyZWN0IHJlZmVyZW5jZSB0byB0aGUgYHl5YCBzaGFyZWQgc3RhdGUgb2JqZWN0LlxuICpcbiAqICAgICAgICAgICAgICAgICBgJXBhcnNlLXBhcmFtYC1zcGVjaWZpZWQgYWRkaXRpb25hbCBgcGFyc2UoKWAgYXJndW1lbnRzIGhhdmUgYmVlbiBhZGRlZCB0byB0aGlzIGB5eWBcbiAqICAgICAgICAgICAgICAgICBvYmplY3QgYXQgYHBhcnNlKClgIHN0YXJ0IGFuZCBhcmUgdGhlcmVmb3JlIGF2YWlsYWJsZSB0byB0aGUgYWN0aW9uIGNvZGUgdmlhIHRoZVxuICogICAgICAgICAgICAgICAgIHNhbWUgbmFtZWQgYHl5Lnh4eHhgIGF0dHJpYnV0ZXMgKHdoZXJlIGB4eHh4YCByZXByZXNlbnRzIGEgaWRlbnRpZmllciBuYW1lIGZyb21cbiAqICAgICAgICAgICAgICAgICB0aGUgJXBhcnNlLXBhcmFtYCBsaXN0LlxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXl0ZXh0YCAgOiByZWZlcmVuY2UgdG8gdGhlIGxleGVyIHZhbHVlIHdoaWNoIGJlbG9uZ3MgdG8gdGhlIGxhc3QgbGV4ZXIgdG9rZW4gdXNlZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIG1hdGNoIHRoaXMgcnVsZS4gVGhpcyBpcyAqbm90KiB0aGUgbG9vay1haGVhZCB0b2tlbiwgYnV0IHRoZSBsYXN0IHRva2VuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdCdzIGFjdHVhbGx5IHBhcnQgb2YgdGhpcyBydWxlLlxuICpcbiAqICAgICAgICAgICAgICAgICBGb3JtdWxhdGVkIGFub3RoZXIgd2F5LCBgeXl0ZXh0YCBpcyB0aGUgdmFsdWUgb2YgdGhlIHRva2VuIGltbWVkaWF0ZWx5IHByZWNlZWRpbmdcbiAqICAgICAgICAgICAgICAgICB0aGUgY3VycmVudCBsb29rLWFoZWFkIHRva2VuLlxuICogICAgICAgICAgICAgICAgIENhdmVhdHMgYXBwbHkgZm9yIHJ1bGVzIHdoaWNoIGRvbid0IHJlcXVpcmUgbG9vay1haGVhZCwgc3VjaCBhcyBlcHNpbG9uIHJ1bGVzLlxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXlsZW5nYCAgOiBkaXR0byBhcyBgeXl0ZXh0YCwgb25seSBub3cgZm9yIHRoZSBsZXhlci55eWxlbmcgdmFsdWUuXG4gKlxuICogICAgICAgICAgICAgICAtIGB5eWxpbmVub2A6IGRpdHRvIGFzIGB5eXRleHRgLCBvbmx5IG5vdyBmb3IgdGhlIGxleGVyLnl5bGluZW5vIHZhbHVlLlxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXlsb2NgICAgOiBkaXR0byBhcyBgeXl0ZXh0YCwgb25seSBub3cgZm9yIHRoZSBsZXhlci55eWxsb2MgbGV4ZXIgdG9rZW4gbG9jYXRpb24gaW5mby5cbiAqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXQVJOSU5HOiBzaW5jZSBqaXNvbiAwLjQuMTgtMTg2IHRoaXMgZW50cnkgbWF5IGJlIE5VTEwvVU5ERUZJTkVEIGluc3RlYWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mIGFuIGVtcHR5IG9iamVjdCB3aGVuIG5vIHN1aXRhYmxlIGxvY2F0aW9uIGluZm8gY2FuIGJlIHByb3ZpZGVkLlxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXlzdGF0ZWAgOiB0aGUgY3VycmVudCBwYXJzZXIgc3RhdGUgbnVtYmVyLCB1c2VkIGludGVybmFsbHkgZm9yIGRpc3BhdGNoaW5nIGFuZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0aW5nIHRoZSBhY3Rpb24gY29kZSBjaHVuayBtYXRjaGluZyB0aGUgcnVsZSBjdXJyZW50bHkgYmVpbmcgcmVkdWNlZC5cbiAqXG4gKiAgICAgICAgICAgICAgIC0gYHl5c3BgICAgIDogdGhlIGN1cnJlbnQgc3RhdGUgc3RhY2sgcG9zaXRpb24gKGEuay5hLiAnc3RhY2sgcG9pbnRlcicpXG4gKlxuICogICAgICAgICAgICAgICAgIFRoaXMgb25lIGNvbWVzIGluIGhhbmR5IHdoZW4geW91IGFyZSBnb2luZyB0byBkbyBhZHZhbmNlZCB0aGluZ3MgdG8gdGhlIHBhcnNlclxuICogICAgICAgICAgICAgICAgIHN0YWNrcywgYWxsIG9mIHdoaWNoIGFyZSBhY2Nlc3NpYmxlIGZyb20geW91ciBhY3Rpb24gY29kZSAoc2VlIHRoZSBuZXh0IGVudHJpZXMgYmVsb3cpLlxuICpcbiAqICAgICAgICAgICAgICAgICBBbHNvIG5vdGUgdGhhdCB5b3UgY2FuIGFjY2VzcyB0aGlzIGFuZCBvdGhlciBzdGFjayBpbmRleCB2YWx1ZXMgdXNpbmcgdGhlIG5ldyBkb3VibGUtaGFzaFxuICogICAgICAgICAgICAgICAgIHN5bnRheCwgaS5lLiBgIyMkID09PSAjIzAgPT09IHl5c3BgLCB3aGlsZSBgIyMxYCBpcyB0aGUgc3RhY2sgaW5kZXggZm9yIGFsbCB0aGluZ3NcbiAqICAgICAgICAgICAgICAgICByZWxhdGVkIHRvIHRoZSBmaXJzdCBydWxlIHRlcm0sIGp1c3QgbGlrZSB5b3UgaGF2ZSBgJDFgLCBgQDFgIGFuZCBgIzFgLlxuICogICAgICAgICAgICAgICAgIFRoaXMgaXMgbWFkZSBhdmFpbGFibGUgdG8gd3JpdGUgdmVyeSBhZHZhbmNlZCBncmFtbWFyIGFjdGlvbiBydWxlcywgZS5nLiB3aGVuIHlvdSB3YW50XG4gKiAgICAgICAgICAgICAgICAgdG8gaW52ZXN0aWdhdGUgdGhlIHBhcnNlIHN0YXRlIHN0YWNrIGluIHlvdXIgYWN0aW9uIGNvZGUsIHdoaWNoIHdvdWxkLCBmb3IgZXhhbXBsZSxcbiAqICAgICAgICAgICAgICAgICBiZSByZWxldmFudCB3aGVuIHlvdSB3aXNoIHRvIGltcGxlbWVudCBlcnJvciBkaWFnbm9zdGljcyBhbmQgcmVwb3J0aW5nIHNjaGVtZXMgc2ltaWxhclxuICogICAgICAgICAgICAgICAgIHRvIHRoZSB3b3JrIGRlc2NyaWJlZCBoZXJlOlxuICpcbiAqICAgICAgICAgICAgICAgICArIFBvdHRpZXIsIEYuLCAyMDE2LiBSZWFjaGFiaWxpdHkgYW5kIGVycm9yIGRpYWdub3NpcyBpbiBMUigxKSBhdXRvbWF0YS5cbiAqICAgICAgICAgICAgICAgICAgIEluIEpvdXJuw6llcyBGcmFuY29waG9uZXMgZGVzIExhbmd1YWdlcyBBcHBsaWNhdGlmcy5cbiAqXG4gKiAgICAgICAgICAgICAgICAgKyBKZWZmZXJ5LCBDLkwuLCAyMDAzLiBHZW5lcmF0aW5nIExSIHN5bnRheCBlcnJvciBtZXNzYWdlcyBmcm9tIGV4YW1wbGVzLlxuICogICAgICAgICAgICAgICAgICAgQUNNIFRyYW5zYWN0aW9ucyBvbiBQcm9ncmFtbWluZyBMYW5ndWFnZXMgYW5kIFN5c3RlbXMgKFRPUExBUyksIDI1KDUpLCBwcC42MzHigJM2NDAuXG4gKlxuICogICAgICAgICAgICAgICAtIGB5eXJ1bGVsZW5ndGhgOiB0aGUgY3VycmVudCBydWxlJ3MgdGVybSBjb3VudCwgaS5lLiB0aGUgbnVtYmVyIG9mIGVudHJpZXMgb2NjdXBpZWQgb24gdGhlIHN0YWNrLlxuICpcbiAqICAgICAgICAgICAgICAgICBUaGlzIG9uZSBjb21lcyBpbiBoYW5keSB3aGVuIHlvdSBhcmUgZ29pbmcgdG8gZG8gYWR2YW5jZWQgdGhpbmdzIHRvIHRoZSBwYXJzZXJcbiAqICAgICAgICAgICAgICAgICBzdGFja3MsIGFsbCBvZiB3aGljaCBhcmUgYWNjZXNzaWJsZSBmcm9tIHlvdXIgYWN0aW9uIGNvZGUgKHNlZSB0aGUgbmV4dCBlbnRyaWVzIGJlbG93KS5cbiAqXG4gKiAgICAgICAgICAgICAgIC0gYHl5dnN0YWNrYDogcmVmZXJlbmNlIHRvIHRoZSBwYXJzZXIgdmFsdWUgc3RhY2suIEFsc28gYWNjZXNzZWQgdmlhIHRoZSBgJDFgIGV0Yy5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdHJ1Y3RzLlxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXlsc3RhY2tgOiByZWZlcmVuY2UgdG8gdGhlIHBhcnNlciB0b2tlbiBsb2NhdGlvbiBzdGFjay4gQWxzbyBhY2Nlc3NlZCB2aWFcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgYEAxYCBldGMuIGNvbnN0cnVjdHMuXG4gKlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdBUk5JTkc6IHNpbmNlIGppc29uIDAuNC4xOC0xODYgdGhpcyBhcnJheSBNQVkgY29udGFpbiBzbG90cyB3aGljaCBhcmVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVTkRFRklORUQgcmF0aGVyIHRoYW4gYW4gZW1wdHkgKGxvY2F0aW9uKSBvYmplY3QsIHdoZW4gdGhlIGxleGVyL3BhcnNlclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiBjb2RlIGRpZCBub3QgcHJvdmlkZSBhIHN1aXRhYmxlIGxvY2F0aW9uIGluZm8gb2JqZWN0IHdoZW4gc3VjaCBhXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xvdCB3YXMgZmlsbGVkIVxuICpcbiAqICAgICAgICAgICAgICAgLSBgeXlzdGFja2AgOiByZWZlcmVuY2UgdG8gdGhlIHBhcnNlciB0b2tlbiBpZCBzdGFjay4gQWxzbyBhY2Nlc3NlZCB2aWEgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCMxYCBldGMuIGNvbnN0cnVjdHMuXG4gKlxuICogICAgICAgICAgICAgICAgIE5vdGU6IHRoaXMgaXMgYSBiaXQgb2YgYSAqKndoaXRlIGxpZSoqIGFzIHdlIGNhbiBzdGF0aWNhbGx5IGRlY29kZSBhbnkgYCNuYCByZWZlcmVuY2UgdG9cbiAqICAgICAgICAgICAgICAgICBpdHMgbnVtZXJpYyB0b2tlbiBpZCB2YWx1ZSwgaGVuY2UgdGhhdCBjb2RlIHdvdWxkbid0IG5lZWQgdGhlIGB5eXN0YWNrYCBidXQgKnlvdSogbWlnaHRcbiAqICAgICAgICAgICAgICAgICB3YW50IGFjY2VzcyB0aGlzIGFycmF5IGZvciB5b3VyIG93biBwdXJwb3Nlcywgc3VjaCBhcyBlcnJvciBhbmFseXNpcyBhcyBtZW50aW9uZWQgYWJvdmUhXG4gKlxuICogICAgICAgICAgICAgICAgIE5vdGUgdGhhdCB0aGlzIHN0YWNrIHN0b3JlcyB0aGUgY3VycmVudCBzdGFjayBvZiAqdG9rZW5zKiwgdGhhdCBpcyB0aGUgc2VxdWVuY2Ugb2ZcbiAqICAgICAgICAgICAgICAgICBhbHJlYWR5IHBhcnNlZD1yZWR1Y2VkICpub250ZXJtaW5hbHMqICh0b2tlbnMgcmVwcmVzZW50aW5nIHJ1bGVzKSBhbmQgKnRlcm1pbmFscypcbiAqICAgICAgICAgICAgICAgICAobGV4ZXIgdG9rZW5zICpzaGlmdGVkKiBvbnRvIHRoZSBzdGFjayB1bnRpbCB0aGUgcnVsZSB0aGV5IGJlbG9uZyB0byBpcyBmb3VuZCBhbmRcbiAqICAgICAgICAgICAgICAgICAqcmVkdWNlZCouXG4gKlxuICogICAgICAgICAgICAgICAtIGB5eXNzdGFja2A6IHJlZmVyZW5jZSB0byB0aGUgcGFyc2VyIHN0YXRlIHN0YWNrLiBUaGlzIG9uZSBjYXJyaWVzIHRoZSBpbnRlcm5hbCBwYXJzZXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqc3RhdGVzKiBzdWNoIGFzIHRoZSBvbmUgaW4gYHl5c3RhdGVgLCB3aGljaCBhcmUgdXNlZCB0byByZXByZXNlbnRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgcGFyc2VyIHN0YXRlIG1hY2hpbmUgaW4gdGhlICpwYXJzZSB0YWJsZSouICpWZXJ5KiAqaW50ZXJuYWwqIHN0dWZmLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoYXQgY2FuIEkgc2F5PyBJZiB5b3UgYWNjZXNzIHRoaXMgb25lLCB5b3UncmUgY2xlYXJseSBkb2luZyB3aWNrZWQgdGhpbmdzXG4gKlxuICogICAgICAgICAgICAgICAtIGAuLi5gICAgICA6IHRoZSBleHRyYSBhcmd1bWVudHMgeW91IHNwZWNpZmllZCBpbiB0aGUgYCVwYXJzZS1wYXJhbWAgc3RhdGVtZW50IGluIHlvdXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmFtbWFyIGRlZmluaXRpb24gZmlsZS5cbiAqXG4gKiAgICB0YWJsZTogWy4uLl0sXG4gKiAgICAgICAgICAgICAgIFN0YXRlIHRyYW5zaXRpb24gdGFibGVcbiAqICAgICAgICAgICAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICpcbiAqICAgICAgICAgICAgICAgaW5kZXggbGV2ZWxzIGFyZTpcbiAqICAgICAgICAgICAgICAgLSBgc3RhdGVgICAtLT4gaGFzaCB0YWJsZVxuICogICAgICAgICAgICAgICAtIGBzeW1ib2xgIC0tPiBhY3Rpb24gKG51bWJlciBvciBhcnJheSlcbiAqXG4gKiAgICAgICAgICAgICAgICAgSWYgdGhlIGBhY3Rpb25gIGlzIGFuIGFycmF5LCB0aGVzZSBhcmUgdGhlIGVsZW1lbnRzJyBtZWFuaW5nOlxuICogICAgICAgICAgICAgICAgIC0gaW5kZXggWzBdOiAxID0gc2hpZnQsIDIgPSByZWR1Y2UsIDMgPSBhY2NlcHRcbiAqICAgICAgICAgICAgICAgICAtIGluZGV4IFsxXTogR09UTyBgc3RhdGVgXG4gKlxuICogICAgICAgICAgICAgICAgIElmIHRoZSBgYWN0aW9uYCBpcyBhIG51bWJlciwgaXQgaXMgdGhlIEdPVE8gYHN0YXRlYFxuICpcbiAqICAgIGRlZmF1bHRBY3Rpb25zOiB7Li4ufSxcbiAqXG4gKiAgICBwYXJzZUVycm9yOiBmdW5jdGlvbihzdHIsIGhhc2gsIEV4Y2VwdGlvbkNsYXNzKSxcbiAqICAgIHl5RXJyb3I6IGZ1bmN0aW9uKHN0ciwgLi4uKSxcbiAqICAgIHl5UmVjb3ZlcmluZzogZnVuY3Rpb24oKSxcbiAqICAgIHl5RXJyT2s6IGZ1bmN0aW9uKCksXG4gKiAgICB5eUNsZWFySW46IGZ1bmN0aW9uKCksXG4gKlxuICogICAgY29uc3RydWN0UGFyc2VFcnJvckluZm86IGZ1bmN0aW9uKGVycm9yX21lc3NhZ2UsIGV4Y2VwdGlvbl9vYmplY3QsIGV4cGVjdGVkX3Rva2VuX3NldCwgaXNfcmVjb3ZlcmFibGUpLFxuICogICAgICAgICAgICAgICBIZWxwZXIgZnVuY3Rpb24gKip3aGljaCB3aWxsIGJlIHNldCB1cCBkdXJpbmcgdGhlIGZpcnN0IGludm9jYXRpb24gb2YgdGhlIGBwYXJzZSgpYCBtZXRob2QqKi5cbiAqICAgICAgICAgICAgICAgUHJvZHVjZXMgYSBuZXcgZXJyb3JJbmZvICdoYXNoIG9iamVjdCcgd2hpY2ggY2FuIGJlIHBhc3NlZCBpbnRvIGBwYXJzZUVycm9yKClgLlxuICogICAgICAgICAgICAgICBTZWUgaXQncyB1c2UgaW4gdGhpcyBwYXJzZXIga2VybmVsIGluIG1hbnkgcGxhY2VzOyBleGFtcGxlIHVzYWdlOlxuICpcbiAqICAgICAgICAgICAgICAgICAgIHZhciBpbmZvT2JqID0gcGFyc2VyLmNvbnN0cnVjdFBhcnNlRXJyb3JJbmZvKCdmYWlsIScsIG51bGwsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZXIuY29sbGVjdF9leHBlY3RlZF90b2tlbl9zZXQoc3RhdGUpLCB0cnVlKTtcbiAqICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWwgPSBwYXJzZXIucGFyc2VFcnJvcihpbmZvT2JqLmVyclN0ciwgaW5mb09iaiwgcGFyc2VyLkppc29uUGFyc2VyRXJyb3IpO1xuICpcbiAqICAgIG9yaWdpbmFsUGFyc2VFcnJvcjogZnVuY3Rpb24oc3RyLCBoYXNoLCBFeGNlcHRpb25DbGFzcyksXG4gKiAgICAgICAgICAgICAgIFRoZSBiYXNpYyBgcGFyc2VFcnJvcmAgaGFuZGxlciBwcm92aWRlZCBieSBKSVNPTi5cbiAqICAgICAgICAgICAgICAgYGNsZWFudXBBZnRlclBhcnNlKClgIHdpbGwgY2xlYW4gdXAgYW5kIHJlc2V0IGBwYXJzZUVycm9yKClgIHRvIHJlZmVyZW5jZSB0aGlzIGZ1bmN0aW9uXG4gKiAgICAgICAgICAgICAgIGF0IHRoZSBlbmQgb2YgdGhlIGBwYXJzZSgpYC5cbiAqXG4gKiAgICBvcHRpb25zOiB7IC4uLiBwYXJzZXIgJW9wdGlvbnMgLi4uIH0sXG4gKlxuICogICAgcGFyc2U6IGZ1bmN0aW9uKGlucHV0WywgYXJncy4uLl0pLFxuICogICAgICAgICAgICAgICBQYXJzZSB0aGUgZ2l2ZW4gYGlucHV0YCBhbmQgcmV0dXJuIHRoZSBwYXJzZWQgdmFsdWUgKG9yIGB0cnVlYCB3aGVuIG5vbmUgd2FzIHByb3ZpZGVkIGJ5XG4gKiAgICAgICAgICAgICAgIHRoZSByb290IGFjdGlvbiwgaW4gd2hpY2ggY2FzZSB0aGUgcGFyc2VyIGlzIGFjdGluZyBhcyBhICptYXRjaGVyKikuXG4gKiAgICAgICAgICAgICAgIFlvdSBNQVkgdXNlIHRoZSBhZGRpdGlvbmFsIGBhcmdzLi4uYCBwYXJhbWV0ZXJzIGFzIHBlciBgJXBhcnNlLXBhcmFtYCBzcGVjIG9mIHRoaXMgZ3JhbW1hcjpcbiAqICAgICAgICAgICAgICAgdGhlc2UgZXh0cmEgYGFyZ3MuLi5gIGFyZSBhZGRlZCB2ZXJiYXRpbSB0byB0aGUgYHl5YCBvYmplY3QgcmVmZXJlbmNlIGFzIG1lbWJlciB2YXJpYWJsZXMuXG4gKlxuICogICAgICAgICAgICAgICBXQVJOSU5HOlxuICogICAgICAgICAgICAgICBQYXJzZXIncyBhZGRpdGlvbmFsIGBhcmdzLi4uYCBwYXJhbWV0ZXJzICh2aWEgYCVwYXJzZS1wYXJhbWApIE1BWSBjb25mbGljdCB3aXRoXG4gKiAgICAgICAgICAgICAgIGFueSBhdHRyaWJ1dGVzIGFscmVhZHkgYWRkZWQgdG8gYHl5YCBieSB0aGUgamlzb24gcnVuLXRpbWU7XG4gKiAgICAgICAgICAgICAgIHdoZW4gc3VjaCBhIGNvbGxpc2lvbiBpcyBkZXRlY3RlZCBhbiBleGNlcHRpb24gaXMgdGhyb3duIHRvIHByZXZlbnQgdGhlIGdlbmVyYXRlZCBydW4tdGltZVxuICogICAgICAgICAgICAgICBmcm9tIHNpbGVudGx5IGFjY2VwdGluZyB0aGlzIGNvbmZ1c2luZyBhbmQgcG90ZW50aWFsbHkgaGF6YXJkb3VzIHNpdHVhdGlvbiFcbiAqXG4gKiAgICAgICAgICAgICAgIFRoZSBsZXhlciBNQVkgYWRkIGl0cyBvd24gc2V0IG9mIGFkZGl0aW9uYWwgcGFyYW1ldGVycyAodmlhIHRoZSBgJXBhcnNlLXBhcmFtYCBsaW5lIGluXG4gKiAgICAgICAgICAgICAgIHRoZSBsZXhlciBzZWN0aW9uIG9mIHRoZSBncmFtbWFyIHNwZWMpOiB0aGVzZSB3aWxsIGJlIGluc2VydGVkIGluIHRoZSBgeXlgIHNoYXJlZCBzdGF0ZVxuICogICAgICAgICAgICAgICBvYmplY3QgYW5kIGFueSBjb2xsaXNpb24gd2l0aCB0aG9zZSB3aWxsIGJlIHJlcG9ydGVkIGJ5IHRoZSBsZXhlciB2aWEgYSB0aHJvd24gZXhjZXB0aW9uLlxuICpcbiAqICAgIGNsZWFudXBBZnRlclBhcnNlOiBmdW5jdGlvbihyZXN1bHRWYWx1ZSwgaW52b2tlX3Bvc3RfbWV0aG9kcywgZG9fbm90X251a2VfZXJyb3JpbmZvcyksXG4gKiAgICAgICAgICAgICAgIEhlbHBlciBmdW5jdGlvbiAqKndoaWNoIHdpbGwgYmUgc2V0IHVwIGR1cmluZyB0aGUgZmlyc3QgaW52b2NhdGlvbiBvZiB0aGUgYHBhcnNlKClgIG1ldGhvZCoqLlxuICogICAgICAgICAgICAgICBUaGlzIGhlbHBlciBBUEkgaXMgaW52b2tlZCBhdCB0aGUgZW5kIG9mIHRoZSBgcGFyc2UoKWAgY2FsbCwgdW5sZXNzIGFuIGV4Y2VwdGlvbiB3YXMgdGhyb3duXG4gKiAgICAgICAgICAgICAgIGFuZCBgJW9wdGlvbnMgbm8tdHJ5LWNhdGNoYCBoYXMgYmVlbiBkZWZpbmVkIGZvciB0aGlzIGdyYW1tYXI6IGluIHRoYXQgY2FzZSB0aGlzIGhlbHBlciBNQVlcbiAqICAgICAgICAgICAgICAgYmUgaW52b2tlZCBieSBjYWxsaW5nIHVzZXIgY29kZSB0byBlbnN1cmUgdGhlIGBwb3N0X3BhcnNlYCBjYWxsYmFja3MgYXJlIGludm9rZWQgYW5kXG4gKiAgICAgICAgICAgICAgIHRoZSBpbnRlcm5hbCBwYXJzZXIgZ2V0cyBwcm9wZXJseSBnYXJiYWdlIGNvbGxlY3RlZCB1bmRlciB0aGVzZSBwYXJ0aWN1bGFyIGNpcmN1bXN0YW5jZXMuXG4gKlxuICogICAgeXlNZXJnZUxvY2F0aW9uSW5mbzogZnVuY3Rpb24oZmlyc3RfaW5kZXgsIGxhc3RfaW5kZXgsIGZpcnN0X3l5bGxvYywgbGFzdF95eWxsb2MsIGRvbnRfbG9va19iYWNrKSxcbiAqICAgICAgICAgICAgICAgSGVscGVyIGZ1bmN0aW9uICoqd2hpY2ggd2lsbCBiZSBzZXQgdXAgZHVyaW5nIHRoZSBmaXJzdCBpbnZvY2F0aW9uIG9mIHRoZSBgcGFyc2UoKWAgbWV0aG9kKiouXG4gKiAgICAgICAgICAgICAgIFRoaXMgaGVscGVyIEFQSSBjYW4gYmUgaW52b2tlZCB0byBjYWxjdWxhdGUgYSBzcGFubmluZyBgeXlsbG9jYCBsb2NhdGlvbiBpbmZvIG9iamVjdC5cbiAqXG4gKiAgICAgICAgICAgICAgIE5vdGU6ICVlcHNpbG9uIHJ1bGVzIE1BWSBzcGVjaWZ5IG5vIGBmaXJzdF9pbmRleGAgYW5kIGBmaXJzdF95eWxsb2NgLCBpbiB3aGljaCBjYXNlXG4gKiAgICAgICAgICAgICAgIHRoaXMgZnVuY3Rpb24gd2lsbCBhdHRlbXB0IHRvIG9idGFpbiBhIHN1aXRhYmxlIGxvY2F0aW9uIG1hcmtlciBieSBpbnNwZWN0aW5nIHRoZSBsb2NhdGlvbiBzdGFja1xuICogICAgICAgICAgICAgICBiYWNrd2FyZHMuXG4gKlxuICogICAgICAgICAgICAgICBGb3IgbW9yZSBpbmZvIHNlZSB0aGUgZG9jdW1lbnRhdGlvbiBjb21tZW50IGZ1cnRoZXIgYmVsb3csIGltbWVkaWF0ZWx5IGFib3ZlIHRoaXMgZnVuY3Rpb24nc1xuICogICAgICAgICAgICAgICBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiAgICBsZXhlcjoge1xuICogICAgICAgIHl5OiB7Li4ufSwgICAgICAgICAgIEEgcmVmZXJlbmNlIHRvIHRoZSBzby1jYWxsZWQgXCJzaGFyZWQgc3RhdGVcIiBgeXlgIG9uY2VcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNlaXZlZCB2aWEgYSBjYWxsIHRvIHRoZSBgLnNldElucHV0KGlucHV0LCB5eSlgIGxleGVyIEFQSS5cbiAqICAgICAgICBFT0Y6IDEsXG4gKiAgICAgICAgRVJST1I6IDIsXG4gKiAgICAgICAgSmlzb25MZXhlckVycm9yOiBmdW5jdGlvbihtc2csIGhhc2gpLFxuICogICAgICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uKHN0ciwgaGFzaCwgRXhjZXB0aW9uQ2xhc3MpLFxuICogICAgICAgIHNldElucHV0OiBmdW5jdGlvbihpbnB1dCwgW3l5XSksXG4gKiAgICAgICAgaW5wdXQ6IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgdW5wdXQ6IGZ1bmN0aW9uKHN0ciksXG4gKiAgICAgICAgbW9yZTogZnVuY3Rpb24oKSxcbiAqICAgICAgICByZWplY3Q6IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgbGVzczogZnVuY3Rpb24obiksXG4gKiAgICAgICAgcGFzdElucHV0OiBmdW5jdGlvbihuKSxcbiAqICAgICAgICB1cGNvbWluZ0lucHV0OiBmdW5jdGlvbihuKSxcbiAqICAgICAgICBzaG93UG9zaXRpb246IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgdGVzdF9tYXRjaDogZnVuY3Rpb24ocmVnZXhfbWF0Y2hfYXJyYXksIHJ1bGVfaW5kZXgsIC4uLiksXG4gKiAgICAgICAgbmV4dDogZnVuY3Rpb24oLi4uKSxcbiAqICAgICAgICBsZXg6IGZ1bmN0aW9uKC4uLiksXG4gKiAgICAgICAgYmVnaW46IGZ1bmN0aW9uKGNvbmRpdGlvbiksXG4gKiAgICAgICAgcHVzaFN0YXRlOiBmdW5jdGlvbihjb25kaXRpb24pLFxuICogICAgICAgIHBvcFN0YXRlOiBmdW5jdGlvbigpLFxuICogICAgICAgIHRvcFN0YXRlOiBmdW5jdGlvbigpLFxuICogICAgICAgIF9jdXJyZW50UnVsZXM6IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgc3RhdGVTdGFja1NpemU6IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgY2xlYW51cEFmdGVyTGV4OiBmdW5jdGlvbigpXG4gKlxuICogICAgICAgIG9wdGlvbnM6IHsgLi4uIGxleGVyICVvcHRpb25zIC4uLiB9LFxuICpcbiAqICAgICAgICBwZXJmb3JtQWN0aW9uOiBmdW5jdGlvbih5eSwgeXlfLCAkYXZvaWRpbmdfbmFtZV9jb2xsaXNpb25zLCBZWV9TVEFSVCwgLi4uKSxcbiAqICAgICAgICBydWxlczogWy4uLl0sXG4gKiAgICAgICAgY29uZGl0aW9uczoge2Fzc29jaWF0aXZlIGxpc3Q6IG5hbWUgPT0+IHNldH0sXG4gKiAgICB9XG4gKiAgfVxuICpcbiAqXG4gKiAgdG9rZW4gbG9jYXRpb24gaW5mbyAoQCQsIF8kLCBldGMuKToge1xuICogICAgZmlyc3RfbGluZTogbixcbiAqICAgIGxhc3RfbGluZTogbixcbiAqICAgIGZpcnN0X2NvbHVtbjogbixcbiAqICAgIGxhc3RfY29sdW1uOiBuLFxuICogICAgcmFuZ2U6IFtzdGFydF9udW1iZXIsIGVuZF9udW1iZXJdXG4gKiAgICAgICAgICAgICAgICh3aGVyZSB0aGUgbnVtYmVycyBhcmUgaW5kZXhlcyBpbnRvIHRoZSBpbnB1dCBzdHJpbmcsIHplcm8tYmFzZWQpXG4gKiAgfVxuICpcbiAqIC0tLVxuICpcbiAqIFRoZSBgcGFyc2VFcnJvcmAgZnVuY3Rpb24gcmVjZWl2ZXMgYSAnaGFzaCcgb2JqZWN0IHdpdGggdGhlc2UgbWVtYmVycyBmb3IgbGV4ZXIgYW5kXG4gKiBwYXJzZXIgZXJyb3JzOlxuICpcbiAqICB7XG4gKiAgICB0ZXh0OiAgICAgICAgKG1hdGNoZWQgdGV4dClcbiAqICAgIHRva2VuOiAgICAgICAodGhlIHByb2R1Y2VkIHRlcm1pbmFsIHRva2VuLCBpZiBhbnkpXG4gKiAgICB0b2tlbl9pZDogICAgKHRoZSBwcm9kdWNlZCB0ZXJtaW5hbCB0b2tlbiBudW1lcmljIElELCBpZiBhbnkpXG4gKiAgICBsaW5lOiAgICAgICAgKHl5bGluZW5vKVxuICogICAgbG9jOiAgICAgICAgICh5eWxsb2MpXG4gKiAgfVxuICpcbiAqIHBhcnNlciAoZ3JhbW1hcikgZXJyb3JzIHdpbGwgYWxzbyBwcm92aWRlIHRoZXNlIGFkZGl0aW9uYWwgbWVtYmVyczpcbiAqXG4gKiAge1xuICogICAgZXhwZWN0ZWQ6ICAgIChhcnJheSBkZXNjcmliaW5nIHRoZSBzZXQgb2YgZXhwZWN0ZWQgdG9rZW5zO1xuICogICAgICAgICAgICAgICAgICBtYXkgYmUgVU5ERUZJTkVEIHdoZW4gd2UgY2Fubm90IGVhc2lseSBwcm9kdWNlIHN1Y2ggYSBzZXQpXG4gKiAgICBzdGF0ZTogICAgICAgKGludGVnZXIgKG9yIGFycmF5IHdoZW4gdGhlIHRhYmxlIGluY2x1ZGVzIGdyYW1tYXIgY29sbGlzaW9ucyk7XG4gKiAgICAgICAgICAgICAgICAgIHJlcHJlc2VudHMgdGhlIGN1cnJlbnQgaW50ZXJuYWwgc3RhdGUgb2YgdGhlIHBhcnNlciBrZXJuZWwuXG4gKiAgICAgICAgICAgICAgICAgIGNhbiwgZm9yIGV4YW1wbGUsIGJlIHVzZWQgdG8gcGFzcyB0byB0aGUgYGNvbGxlY3RfZXhwZWN0ZWRfdG9rZW5fc2V0KClgXG4gKiAgICAgICAgICAgICAgICAgIEFQSSB0byBvYnRhaW4gdGhlIGV4cGVjdGVkIHRva2VuIHNldClcbiAqICAgIGFjdGlvbjogICAgICAoaW50ZWdlcjsgcmVwcmVzZW50cyB0aGUgY3VycmVudCBpbnRlcm5hbCBhY3Rpb24gd2hpY2ggd2lsbCBiZSBleGVjdXRlZClcbiAqICAgIG5ld19zdGF0ZTogICAoaW50ZWdlcjsgcmVwcmVzZW50cyB0aGUgbmV4dC9wbGFubmVkIGludGVybmFsIHN0YXRlLCBvbmNlIHRoZSBjdXJyZW50XG4gKiAgICAgICAgICAgICAgICAgIGFjdGlvbiBoYXMgZXhlY3V0ZWQpXG4gKiAgICByZWNvdmVyYWJsZTogKGJvb2xlYW46IFRSVUUgd2hlbiB0aGUgcGFyc2VyIE1BWSBoYXZlIGFuIGVycm9yIHJlY292ZXJ5IHJ1bGVcbiAqICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlIGZvciB0aGlzIHBhcnRpY3VsYXIgZXJyb3IpXG4gKiAgICBzdGF0ZV9zdGFjazogKGFycmF5OiB0aGUgY3VycmVudCBwYXJzZXIgTEFMUi9MUiBpbnRlcm5hbCBzdGF0ZSBzdGFjazsgdGhpcyBjYW4gYmUgdXNlZCxcbiAqICAgICAgICAgICAgICAgICAgZm9yIGluc3RhbmNlLCBmb3IgYWR2YW5jZWQgZXJyb3IgYW5hbHlzaXMgYW5kIHJlcG9ydGluZylcbiAqICAgIHZhbHVlX3N0YWNrOiAoYXJyYXk6IHRoZSBjdXJyZW50IHBhcnNlciBMQUxSL0xSIGludGVybmFsIGAkJGAgdmFsdWUgc3RhY2s7IHRoaXMgY2FuIGJlIHVzZWQsXG4gKiAgICAgICAgICAgICAgICAgIGZvciBpbnN0YW5jZSwgZm9yIGFkdmFuY2VkIGVycm9yIGFuYWx5c2lzIGFuZCByZXBvcnRpbmcpXG4gKiAgICBsb2NhdGlvbl9zdGFjazogKGFycmF5OiB0aGUgY3VycmVudCBwYXJzZXIgTEFMUi9MUiBpbnRlcm5hbCBsb2NhdGlvbiBzdGFjazsgdGhpcyBjYW4gYmUgdXNlZCxcbiAqICAgICAgICAgICAgICAgICAgZm9yIGluc3RhbmNlLCBmb3IgYWR2YW5jZWQgZXJyb3IgYW5hbHlzaXMgYW5kIHJlcG9ydGluZylcbiAqICAgIHl5OiAgICAgICAgICAob2JqZWN0OiB0aGUgY3VycmVudCBwYXJzZXIgaW50ZXJuYWwgXCJzaGFyZWQgc3RhdGVcIiBgeXlgXG4gKiAgICAgICAgICAgICAgICAgIGFzIGlzIGFsc28gYXZhaWxhYmxlIGluIHRoZSBydWxlIGFjdGlvbnM7IHRoaXMgY2FuIGJlIHVzZWQsXG4gKiAgICAgICAgICAgICAgICAgIGZvciBpbnN0YW5jZSwgZm9yIGFkdmFuY2VkIGVycm9yIGFuYWx5c2lzIGFuZCByZXBvcnRpbmcpXG4gKiAgICBsZXhlcjogICAgICAgKHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBsZXhlciBpbnN0YW5jZSB1c2VkIGJ5IHRoZSBwYXJzZXIpXG4gKiAgICBwYXJzZXI6ICAgICAgKHJlZmVyZW5jZSB0byB0aGUgY3VycmVudCBwYXJzZXIgaW5zdGFuY2UpXG4gKiAgfVxuICpcbiAqIHdoaWxlIGB0aGlzYCB3aWxsIHJlZmVyZW5jZSB0aGUgY3VycmVudCBwYXJzZXIgaW5zdGFuY2UuXG4gKlxuICogV2hlbiBgcGFyc2VFcnJvcmAgaXMgaW52b2tlZCBieSB0aGUgbGV4ZXIsIGB0aGlzYCB3aWxsIHN0aWxsIHJlZmVyZW5jZSB0aGUgcmVsYXRlZCAqcGFyc2VyKlxuICogaW5zdGFuY2UsIHdoaWxlIHRoZXNlIGFkZGl0aW9uYWwgYGhhc2hgIGZpZWxkcyB3aWxsIGFsc28gYmUgcHJvdmlkZWQ6XG4gKlxuICogIHtcbiAqICAgIGxleGVyOiAgICAgICAocmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IGxleGVyIGluc3RhbmNlIHdoaWNoIHJlcG9ydGVkIHRoZSBlcnJvcilcbiAqICB9XG4gKlxuICogV2hlbiBgcGFyc2VFcnJvcmAgaXMgaW52b2tlZCBieSB0aGUgcGFyc2VyIGR1ZSB0byBhICoqSmF2YVNjcmlwdCBleGNlcHRpb24qKiBiZWluZyBmaXJlZFxuICogZnJvbSBlaXRoZXIgdGhlIHBhcnNlciBvciBsZXhlciwgYHRoaXNgIHdpbGwgc3RpbGwgcmVmZXJlbmNlIHRoZSByZWxhdGVkICpwYXJzZXIqXG4gKiBpbnN0YW5jZSwgd2hpbGUgdGhlc2UgYWRkaXRpb25hbCBgaGFzaGAgZmllbGRzIHdpbGwgYWxzbyBiZSBwcm92aWRlZDpcbiAqXG4gKiAge1xuICogICAgZXhjZXB0aW9uOiAgIChyZWZlcmVuY2UgdG8gdGhlIGV4Y2VwdGlvbiB0aHJvd24pXG4gKiAgfVxuICpcbiAqIFBsZWFzZSBkbyBub3RlIHRoYXQgaW4gdGhlIGxhdHRlciBzaXR1YXRpb24sIHRoZSBgZXhwZWN0ZWRgIGZpZWxkIHdpbGwgYmUgb21pdHRlZCBhc1xuICogdGhpcyB0eXBlIG9mIGZhaWx1cmUgaXMgYXNzdW1lZCBub3QgdG8gYmUgZHVlIHRvICpwYXJzZSBlcnJvcnMqIGJ1dCByYXRoZXIgZHVlIHRvIHVzZXJcbiAqIGFjdGlvbiBjb2RlIGluIGVpdGhlciBwYXJzZXIgb3IgbGV4ZXIgZmFpbGluZyB1bmV4cGVjdGVkbHkuXG4gKlxuICogLS0tXG4gKlxuICogWW91IGNhbiBzcGVjaWZ5IHBhcnNlciBvcHRpb25zIGJ5IHNldHRpbmcgLyBtb2RpZnlpbmcgdGhlIGAueXlgIG9iamVjdCBvZiB5b3VyIFBhcnNlciBpbnN0YW5jZS5cbiAqIFRoZXNlIG9wdGlvbnMgYXJlIGF2YWlsYWJsZTpcbiAqXG4gKiAjIyMgb3B0aW9ucyB3aGljaCBhcmUgZ2xvYmFsIGZvciBhbGwgcGFyc2VyIGluc3RhbmNlc1xuICpcbiAqICBQYXJzZXIucHJlX3BhcnNlOiBmdW5jdGlvbih5eSlcbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogeW91IGNhbiBzcGVjaWZ5IGEgcHJlX3BhcnNlKCkgZnVuY3Rpb24gaW4gdGhlIGNodW5rIGZvbGxvd2luZ1xuICogICAgICAgICAgICAgICAgIHRoZSBncmFtbWFyLCBpLmUuIGFmdGVyIHRoZSBsYXN0IGAlJWAuXG4gKiAgUGFyc2VyLnBvc3RfcGFyc2U6IGZ1bmN0aW9uKHl5LCByZXR2YWwsIHBhcnNlSW5mbykgeyByZXR1cm4gcmV0dmFsOyB9XG4gKiAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IHlvdSBjYW4gc3BlY2lmeSBhIHBvc3RfcGFyc2UoKSBmdW5jdGlvbiBpbiB0aGUgY2h1bmsgZm9sbG93aW5nXG4gKiAgICAgICAgICAgICAgICAgdGhlIGdyYW1tYXIsIGkuZS4gYWZ0ZXIgdGhlIGxhc3QgYCUlYC4gV2hlbiBpdCBkb2VzIG5vdCByZXR1cm4gYW55IHZhbHVlLFxuICogICAgICAgICAgICAgICAgIHRoZSBwYXJzZXIgd2lsbCByZXR1cm4gdGhlIG9yaWdpbmFsIGByZXR2YWxgLlxuICpcbiAqICMjIyBvcHRpb25zIHdoaWNoIGNhbiBiZSBzZXQgdXAgcGVyIHBhcnNlciBpbnN0YW5jZVxuICpcbiAqICB5eToge1xuICogICAgICBwcmVfcGFyc2U6ICBmdW5jdGlvbih5eSlcbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogaXMgaW52b2tlZCBiZWZvcmUgdGhlIHBhcnNlIGN5Y2xlIHN0YXJ0cyAoYW5kIGJlZm9yZSB0aGUgZmlyc3RcbiAqICAgICAgICAgICAgICAgICBpbnZvY2F0aW9uIG9mIGBsZXgoKWApIGJ1dCBpbW1lZGlhdGVseSBhZnRlciB0aGUgaW52b2NhdGlvbiBvZlxuICogICAgICAgICAgICAgICAgIGBwYXJzZXIucHJlX3BhcnNlKClgKS5cbiAqICAgICAgcG9zdF9wYXJzZTogZnVuY3Rpb24oeXksIHJldHZhbCwgcGFyc2VJbmZvKSB7IHJldHVybiByZXR2YWw7IH1cbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogaXMgaW52b2tlZCB3aGVuIHRoZSBwYXJzZSB0ZXJtaW5hdGVzIGR1ZSB0byBzdWNjZXNzICgnYWNjZXB0JylcbiAqICAgICAgICAgICAgICAgICBvciBmYWlsdXJlIChldmVuIHdoZW4gZXhjZXB0aW9ucyBhcmUgdGhyb3duKS5cbiAqICAgICAgICAgICAgICAgICBgcmV0dmFsYCBjb250YWlucyB0aGUgcmV0dXJuIHZhbHVlIHRvIGJlIHByb2R1Y2VkIGJ5IGBQYXJzZXIucGFyc2UoKWA7XG4gKiAgICAgICAgICAgICAgICAgdGhpcyBmdW5jdGlvbiBjYW4gb3ZlcnJpZGUgdGhlIHJldHVybiB2YWx1ZSBieSByZXR1cm5pbmcgYW5vdGhlci5cbiAqICAgICAgICAgICAgICAgICBXaGVuIGl0IGRvZXMgbm90IHJldHVybiBhbnkgdmFsdWUsIHRoZSBwYXJzZXIgd2lsbCByZXR1cm4gdGhlIG9yaWdpbmFsXG4gKiAgICAgICAgICAgICAgICAgYHJldHZhbGAuXG4gKiAgICAgICAgICAgICAgICAgVGhpcyBmdW5jdGlvbiBpcyBpbnZva2VkIGltbWVkaWF0ZWx5IGJlZm9yZSBgcGFyc2VyLnBvc3RfcGFyc2UoKWAuXG4gKlxuICogICAgICBwYXJzZUVycm9yOiBmdW5jdGlvbihzdHIsIGhhc2gsIEV4Y2VwdGlvbkNsYXNzKVxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBvdmVycmlkZXMgdGhlIGRlZmF1bHQgYHBhcnNlRXJyb3JgIGZ1bmN0aW9uLlxuICogICAgICBxdW90ZU5hbWU6IGZ1bmN0aW9uKG5hbWUpLFxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBvdmVycmlkZXMgdGhlIGRlZmF1bHQgYHF1b3RlTmFtZWAgZnVuY3Rpb24uXG4gKiAgfVxuICpcbiAqICBwYXJzZXIubGV4ZXIub3B0aW9uczoge1xuICogICAgICBwcmVfbGV4OiAgZnVuY3Rpb24oKVxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBpcyBpbnZva2VkIGJlZm9yZSB0aGUgbGV4ZXIgaXMgaW52b2tlZCB0byBwcm9kdWNlIGFub3RoZXIgdG9rZW4uXG4gKiAgICAgICAgICAgICAgICAgYHRoaXNgIHJlZmVycyB0byB0aGUgTGV4ZXIgb2JqZWN0LlxuICogICAgICBwb3N0X2xleDogZnVuY3Rpb24odG9rZW4pIHsgcmV0dXJuIHRva2VuOyB9XG4gKiAgICAgICAgICAgICAgICAgb3B0aW9uYWw6IGlzIGludm9rZWQgd2hlbiB0aGUgbGV4ZXIgaGFzIHByb2R1Y2VkIGEgdG9rZW4gYHRva2VuYDtcbiAqICAgICAgICAgICAgICAgICB0aGlzIGZ1bmN0aW9uIGNhbiBvdmVycmlkZSB0aGUgcmV0dXJuZWQgdG9rZW4gdmFsdWUgYnkgcmV0dXJuaW5nIGFub3RoZXIuXG4gKiAgICAgICAgICAgICAgICAgV2hlbiBpdCBkb2VzIG5vdCByZXR1cm4gYW55ICh0cnV0aHkpIHZhbHVlLCB0aGUgbGV4ZXIgd2lsbCByZXR1cm5cbiAqICAgICAgICAgICAgICAgICB0aGUgb3JpZ2luYWwgYHRva2VuYC5cbiAqICAgICAgICAgICAgICAgICBgdGhpc2AgcmVmZXJzIHRvIHRoZSBMZXhlciBvYmplY3QuXG4gKlxuICogICAgICByYW5nZXM6IGJvb2xlYW5cbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogYHRydWVgID09PiB0b2tlbiBsb2NhdGlvbiBpbmZvIHdpbGwgaW5jbHVkZSBhIC5yYW5nZVtdIG1lbWJlci5cbiAqICAgICAgZmxleDogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGZsZXgtbGlrZSBsZXhpbmcgYmVoYXZpb3VyIHdoZXJlIHRoZSBydWxlcyBhcmUgdGVzdGVkXG4gKiAgICAgICAgICAgICAgICAgZXhoYXVzdGl2ZWx5IHRvIGZpbmQgdGhlIGxvbmdlc3QgbWF0Y2guXG4gKiAgICAgIGJhY2t0cmFja19sZXhlcjogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGxleGVyIHJlZ2V4ZXMgYXJlIHRlc3RlZCBpbiBvcmRlciBhbmQgZm9yIGludm9rZWQ7XG4gKiAgICAgICAgICAgICAgICAgdGhlIGxleGVyIHRlcm1pbmF0ZXMgdGhlIHNjYW4gd2hlbiBhIHRva2VuIGlzIHJldHVybmVkIGJ5IHRoZSBhY3Rpb24gY29kZS5cbiAqICAgICAgeHJlZ2V4cDogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGxleGVyIHJ1bGUgcmVnZXhlcyBhcmUgXCJleHRlbmRlZCByZWdleCBmb3JtYXRcIiByZXF1aXJpbmcgdGhlXG4gKiAgICAgICAgICAgICAgICAgYFhSZWdFeHBgIGxpYnJhcnkuIFdoZW4gdGhpcyBgJW9wdGlvbmAgaGFzIG5vdCBiZWVuIHNwZWNpZmllZCBhdCBjb21waWxlIHRpbWUsIGFsbCBsZXhlclxuICogICAgICAgICAgICAgICAgIHJ1bGUgcmVnZXhlcyBoYXZlIGJlZW4gd3JpdHRlbiBhcyBzdGFuZGFyZCBKYXZhU2NyaXB0IFJlZ0V4cCBleHByZXNzaW9ucy5cbiAqICB9XG4gKi9cblxuICAgICAgICBcbiAgICBcbiAgICAgICAgICAgIHZhciBwYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuXG5cbi8vIFNlZSBhbHNvOlxuLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMzgyMTA3L3doYXRzLWEtZ29vZC13YXktdG8tZXh0ZW5kLWVycm9yLWluLWphdmFzY3JpcHQvIzM1ODgxNTA4XG4vLyBidXQgd2Uga2VlcCB0aGUgcHJvdG90eXBlLmNvbnN0cnVjdG9yIGFuZCBwcm90b3R5cGUubmFtZSBhc3NpZ25tZW50IGxpbmVzIHRvbyBmb3IgY29tcGF0aWJpbGl0eVxuLy8gd2l0aCB1c2VybGFuZCBjb2RlIHdoaWNoIG1pZ2h0IGFjY2VzcyB0aGUgZGVyaXZlZCBjbGFzcyBpbiBhICdjbGFzc2ljJyB3YXkuXG5mdW5jdGlvbiBKaXNvblBhcnNlckVycm9yKG1zZywgaGFzaCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6ICdKaXNvblBhcnNlckVycm9yJ1xuICAgIH0pO1xuXG4gICAgaWYgKG1zZyA9PSBudWxsKSBtc2cgPSAnPz8/JztcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbWVzc2FnZScsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogbXNnXG4gICAgfSk7XG5cbiAgICB0aGlzLmhhc2ggPSBoYXNoO1xuXG4gICAgdmFyIHN0YWNrdHJhY2U7XG4gICAgaWYgKGhhc2ggJiYgaGFzaC5leGNlcHRpb24gaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB2YXIgZXgyID0gaGFzaC5leGNlcHRpb247XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IGV4Mi5tZXNzYWdlIHx8IG1zZztcbiAgICAgICAgc3RhY2t0cmFjZSA9IGV4Mi5zdGFjaztcbiAgICB9XG4gICAgaWYgKCFzdGFja3RyYWNlKSB7XG4gICAgICAgIGlmIChFcnJvci5oYXNPd25Qcm9wZXJ0eSgnY2FwdHVyZVN0YWNrVHJhY2UnKSkgeyAgICAgICAgLy8gVjgvQ2hyb21lIGVuZ2luZVxuICAgICAgICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdGFja3RyYWNlID0gKG5ldyBFcnJvcihtc2cpKS5zdGFjaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoc3RhY2t0cmFjZSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3N0YWNrJywge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICB2YWx1ZTogc3RhY2t0cmFjZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmlmICh0eXBlb2YgT2JqZWN0LnNldFByb3RvdHlwZU9mID09PSAnZnVuY3Rpb24nKSB7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKEppc29uUGFyc2VyRXJyb3IucHJvdG90eXBlLCBFcnJvci5wcm90b3R5cGUpO1xufSBlbHNlIHtcbiAgICBKaXNvblBhcnNlckVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbn1cbkppc29uUGFyc2VyRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSmlzb25QYXJzZXJFcnJvcjtcbkppc29uUGFyc2VyRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnSmlzb25QYXJzZXJFcnJvcic7XG5cblxuXG5cbiAgICAgICAgLy8gaGVscGVyOiByZWNvbnN0cnVjdCB0aGUgcHJvZHVjdGlvbnNbXSB0YWJsZVxuICAgICAgICBmdW5jdGlvbiBicChzKSB7XG4gICAgICAgICAgICB2YXIgcnYgPSBbXTtcbiAgICAgICAgICAgIHZhciBwID0gcy5wb3A7XG4gICAgICAgICAgICB2YXIgciA9IHMucnVsZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gcC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBydi5wdXNoKFtcbiAgICAgICAgICAgICAgICAgICAgcFtpXSxcbiAgICAgICAgICAgICAgICAgICAgcltpXVxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9XG4gICAgXG5cblxuICAgICAgICAvLyBoZWxwZXI6IHJlY29uc3RydWN0IHRoZSBkZWZhdWx0QWN0aW9uc1tdIHRhYmxlXG4gICAgICAgIGZ1bmN0aW9uIGJkYShzKSB7XG4gICAgICAgICAgICB2YXIgcnYgPSB7fTtcbiAgICAgICAgICAgIHZhciBkID0gcy5pZHg7XG4gICAgICAgICAgICB2YXIgZyA9IHMuZ290bztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaiA9IGRbaV07XG4gICAgICAgICAgICAgICAgcnZbal0gPSBnW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9XG4gICAgXG5cblxuICAgICAgICAvLyBoZWxwZXI6IHJlY29uc3RydWN0IHRoZSAnZ290bycgdGFibGVcbiAgICAgICAgZnVuY3Rpb24gYnQocykge1xuICAgICAgICAgICAgdmFyIHJ2ID0gW107XG4gICAgICAgICAgICB2YXIgZCA9IHMubGVuO1xuICAgICAgICAgICAgdmFyIHkgPSBzLnN5bWJvbDtcbiAgICAgICAgICAgIHZhciB0ID0gcy50eXBlO1xuICAgICAgICAgICAgdmFyIGEgPSBzLnN0YXRlO1xuICAgICAgICAgICAgdmFyIG0gPSBzLm1vZGU7XG4gICAgICAgICAgICB2YXIgZyA9IHMuZ290bztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZC5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IGRbaV07XG4gICAgICAgICAgICAgICAgdmFyIHEgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG47IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeiA9IHkuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0LnNoaWZ0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcVt6XSA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnNoaWZ0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5zaGlmdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcVt6XSA9IGEuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0eXBlID09PSAxOiBhY2NlcHRcbiAgICAgICAgICAgICAgICAgICAgICAgIHFbel0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgM1xuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBydi5wdXNoKHEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9XG4gICAgXG5cblxuICAgICAgICAvLyBoZWxwZXI6IHJ1bmxlbmd0aCBlbmNvZGluZyB3aXRoIGluY3JlbWVudCBzdGVwOiBjb2RlLCBsZW5ndGg6IHN0ZXAgKGRlZmF1bHQgc3RlcCA9IDApXG4gICAgICAgIC8vIGB0aGlzYCByZWZlcmVuY2VzIGFuIGFycmF5XG4gICAgICAgIGZ1bmN0aW9uIHMoYywgbCwgYSkge1xuICAgICAgICAgICAgYSA9IGEgfHwgMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXNoKGMpO1xuICAgICAgICAgICAgICAgIGMgKz0gYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGhlbHBlcjogZHVwbGljYXRlIHNlcXVlbmNlIGZyb20gKnJlbGF0aXZlKiBvZmZzZXQgYW5kIGxlbmd0aC5cbiAgICAgICAgLy8gYHRoaXNgIHJlZmVyZW5jZXMgYW4gYXJyYXlcbiAgICAgICAgZnVuY3Rpb24gYyhpLCBsKSB7XG4gICAgICAgICAgICBpID0gdGhpcy5sZW5ndGggLSBpO1xuICAgICAgICAgICAgZm9yIChsICs9IGk7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLnB1c2godGhpc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBoZWxwZXI6IHVucGFjayBhbiBhcnJheSB1c2luZyBoZWxwZXJzIGFuZCBkYXRhLCBhbGwgcGFzc2VkIGluIGFuIGFycmF5IGFyZ3VtZW50ICdhJy5cbiAgICAgICAgZnVuY3Rpb24gdShhKSB7XG4gICAgICAgICAgICB2YXIgcnYgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGFbaV07XG4gICAgICAgICAgICAgICAgLy8gSXMgdGhpcyBlbnRyeSBhIGhlbHBlciBmdW5jdGlvbj9cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgICAgICAgICBlLmFwcGx5KHJ2LCBhW2ldKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBydi5wdXNoKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydjtcbiAgICAgICAgfVxuICAgIFxuXG52YXIgcGFyc2VyID0ge1xuICAgIC8vIENvZGUgR2VuZXJhdG9yIEluZm9ybWF0aW9uIFJlcG9ydFxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vXG4gICAgLy8gT3B0aW9uczpcbiAgICAvL1xuICAgIC8vICAgZGVmYXVsdCBhY3Rpb24gbW9kZTogLi4uLi4uLi4uLi4uLiBbXCJjbGFzc2ljXCIsXCJtZXJnZVwiXVxuICAgIC8vICAgdGVzdC1jb21waWxlIGFjdGlvbiBtb2RlOiAuLi4uLi4uLiBcInBhcnNlcjoqLGxleGVyOipcIlxuICAgIC8vICAgdHJ5Li5jYXRjaDogLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiB0cnVlXG4gICAgLy8gICBkZWZhdWx0IHJlc29sdmUgb24gY29uZmxpY3Q6IC4uLi4uIHRydWVcbiAgICAvLyAgIG9uLWRlbWFuZCBsb29rLWFoZWFkOiAuLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIGVycm9yIHJlY292ZXJ5IHRva2VuIHNraXAgbWF4aW11bTogM1xuICAgIC8vICAgeXllcnJvciBpbiBwYXJzZSBhY3Rpb25zIGlzOiAuLi4uLiBOT1QgcmVjb3ZlcmFibGUsXG4gICAgLy8gICB5eWVycm9yIGluIGxleGVyIGFjdGlvbnMgYW5kIG90aGVyIG5vbi1mYXRhbCBsZXhlciBhcmU6XG4gICAgLy8gICAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIE5PVCByZWNvdmVyYWJsZSxcbiAgICAvLyAgIGRlYnVnIGdyYW1tYXIvb3V0cHV0OiAuLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIGhhcyBwYXJ0aWFsIExSIGNvbmZsaWN0IHVwZ3JhZGU6ICAgdHJ1ZVxuICAgIC8vICAgcnVkaW1lbnRhcnkgdG9rZW4tc3RhY2sgc3VwcG9ydDogICBmYWxzZVxuICAgIC8vICAgcGFyc2VyIHRhYmxlIGNvbXByZXNzaW9uIG1vZGU6IC4uLiAyXG4gICAgLy8gICBleHBvcnQgZGVidWcgdGFibGVzOiAuLi4uLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICBleHBvcnQgKmFsbCogdGFibGVzOiAuLi4uLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICBtb2R1bGUgdHlwZTogLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGNvbW1vbmpzXG4gICAgLy8gICBwYXJzZXIgZW5naW5lIHR5cGU6IC4uLi4uLi4uLi4uLi4uIGxhbHJcbiAgICAvLyAgIG91dHB1dCBtYWluKCkgaW4gdGhlIG1vZHVsZTogLi4uLi4gdHJ1ZVxuICAgIC8vICAgaGFzIHVzZXItc3BlY2lmaWVkIG1haW4oKTogLi4uLi4uLiBmYWxzZVxuICAgIC8vICAgaGFzIHVzZXItc3BlY2lmaWVkIHJlcXVpcmUoKS9pbXBvcnQgbW9kdWxlcyBmb3IgbWFpbigpOlxuICAgIC8vICAgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiBmYWxzZVxuICAgIC8vICAgbnVtYmVyIG9mIGV4cGVjdGVkIGNvbmZsaWN0czogLi4uLiAwXG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFBhcnNlciBBbmFseXNpcyBmbGFnczpcbiAgICAvL1xuICAgIC8vICAgbm8gc2lnbmlmaWNhbnQgYWN0aW9ucyAocGFyc2VyIGlzIGEgbGFuZ3VhZ2UgbWF0Y2hlciBvbmx5KTpcbiAgICAvLyAgIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgeXlsZW5nOiAuLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgeXlsaW5lbm86IC4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgeXl0ZXh0OiAuLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgeXlsbG9jOiAuLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgUGFyc2VFcnJvciBBUEk6IC4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgWVlFUlJPUjogLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgWVlSRUNPVkVSSU5HOiAuLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgWVlFUlJPSzogLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgWVlDTEVBUklOOiAuLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHRyYWNrcyBydWxlIHZhbHVlczogLi4uLi4uLi4uLi4uLi4gdHJ1ZVxuICAgIC8vICAgYXNzaWducyBydWxlIHZhbHVlczogLi4uLi4uLi4uLi4uLiB0cnVlXG4gICAgLy8gICB1c2VzIGxvY2F0aW9uIHRyYWNraW5nOiAuLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICBhc3NpZ25zIGxvY2F0aW9uOiAuLi4uLi4uLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICB1c2VzIHl5c3RhY2s6IC4uLi4uLi4uLi4uLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICB1c2VzIHl5c3N0YWNrOiAuLi4uLi4uLi4uLi4uLi4uLi4uIGZhbHNlXG4gICAgLy8gICB1c2VzIHl5c3A6IC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uIHRydWVcbiAgICAvLyAgIHVzZXMgeXlydWxlbGVuZ3RoOiAuLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIHVzZXMgeXlNZXJnZUxvY2F0aW9uSW5mbyBBUEk6IC4uLi4gZmFsc2VcbiAgICAvLyAgIGhhcyBlcnJvciByZWNvdmVyeTogLi4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvLyAgIGhhcyBlcnJvciByZXBvcnRpbmc6IC4uLi4uLi4uLi4uLi4gZmFsc2VcbiAgICAvL1xuICAgIC8vIC0tLS0tLS0tLSBFTkQgT0YgUkVQT1JUIC0tLS0tLS0tLS0tXG5cbnRyYWNlOiBmdW5jdGlvbiBub19vcF90cmFjZSgpIHsgfSxcbkppc29uUGFyc2VyRXJyb3I6IEppc29uUGFyc2VyRXJyb3IsXG55eToge30sXG5vcHRpb25zOiB7XG4gIHR5cGU6IFwibGFsclwiLFxuICBoYXNQYXJ0aWFsTHJVcGdyYWRlT25Db25mbGljdDogdHJ1ZSxcbiAgZXJyb3JSZWNvdmVyeVRva2VuRGlzY2FyZENvdW50OiAzXG59LFxuc3ltYm9sc186IHtcbiAgXCIkYWNjZXB0XCI6IDAsXG4gIFwiJGVuZFwiOiAxLFxuICBcIkFERFwiOiAzLFxuICBcIkFOR0xFXCI6IDE0LFxuICBcIkNIU1wiOiAyMCxcbiAgXCJDU1NfVkFSXCI6IDEyLFxuICBcIkRJVlwiOiA2LFxuICBcIkVNU1wiOiAxOCxcbiAgXCJFT0ZcIjogMSxcbiAgXCJFWFNcIjogMTksXG4gIFwiRlJFUVwiOiAxNixcbiAgXCJMRU5HVEhcIjogMTMsXG4gIFwiTFBBUkVOXCI6IDcsXG4gIFwiTVVMXCI6IDUsXG4gIFwiTkVTVEVEX0NBTENcIjogOSxcbiAgXCJOVU1CRVJcIjogMTEsXG4gIFwiUEVSQ0VOVEFHRVwiOiAyNixcbiAgXCJQUkVGSVhcIjogMTAsXG4gIFwiUkVNU1wiOiAyMSxcbiAgXCJSRVNcIjogMTcsXG4gIFwiUlBBUkVOXCI6IDgsXG4gIFwiU1VCXCI6IDQsXG4gIFwiVElNRVwiOiAxNSxcbiAgXCJWSFNcIjogMjIsXG4gIFwiVk1BWFNcIjogMjUsXG4gIFwiVk1JTlNcIjogMjQsXG4gIFwiVldTXCI6IDIzLFxuICBcImNzc192YWx1ZVwiOiAzMSxcbiAgXCJjc3NfdmFyaWFibGVcIjogMzAsXG4gIFwiZXJyb3JcIjogMixcbiAgXCJleHByZXNzaW9uXCI6IDI3LFxuICBcIm1hdGhfZXhwcmVzc2lvblwiOiAyOCxcbiAgXCJ2YWx1ZVwiOiAyOVxufSxcbnRlcm1pbmFsc186IHtcbiAgMTogXCJFT0ZcIixcbiAgMjogXCJlcnJvclwiLFxuICAzOiBcIkFERFwiLFxuICA0OiBcIlNVQlwiLFxuICA1OiBcIk1VTFwiLFxuICA2OiBcIkRJVlwiLFxuICA3OiBcIkxQQVJFTlwiLFxuICA4OiBcIlJQQVJFTlwiLFxuICA5OiBcIk5FU1RFRF9DQUxDXCIsXG4gIDEwOiBcIlBSRUZJWFwiLFxuICAxMTogXCJOVU1CRVJcIixcbiAgMTI6IFwiQ1NTX1ZBUlwiLFxuICAxMzogXCJMRU5HVEhcIixcbiAgMTQ6IFwiQU5HTEVcIixcbiAgMTU6IFwiVElNRVwiLFxuICAxNjogXCJGUkVRXCIsXG4gIDE3OiBcIlJFU1wiLFxuICAxODogXCJFTVNcIixcbiAgMTk6IFwiRVhTXCIsXG4gIDIwOiBcIkNIU1wiLFxuICAyMTogXCJSRU1TXCIsXG4gIDIyOiBcIlZIU1wiLFxuICAyMzogXCJWV1NcIixcbiAgMjQ6IFwiVk1JTlNcIixcbiAgMjU6IFwiVk1BWFNcIixcbiAgMjY6IFwiUEVSQ0VOVEFHRVwiXG59LFxuVEVSUk9SOiAyLFxuICAgIEVPRjogMSxcblxuICAgIC8vIGludGVybmFsczogZGVmaW5lZCBoZXJlIHNvIHRoZSBvYmplY3QgKnN0cnVjdHVyZSogZG9lc24ndCBnZXQgbW9kaWZpZWQgYnkgcGFyc2UoKSBldCBhbCxcbiAgICAvLyB0aHVzIGhlbHBpbmcgSklUIGNvbXBpbGVycyBsaWtlIENocm9tZSBWOC5cbiAgICBvcmlnaW5hbFF1b3RlTmFtZTogbnVsbCxcbiAgICBvcmlnaW5hbFBhcnNlRXJyb3I6IG51bGwsXG4gICAgY2xlYW51cEFmdGVyUGFyc2U6IG51bGwsXG4gICAgY29uc3RydWN0UGFyc2VFcnJvckluZm86IG51bGwsXG4gICAgeXlNZXJnZUxvY2F0aW9uSW5mbzogbnVsbCxcblxuICAgIF9fcmVlbnRyYW50X2NhbGxfZGVwdGg6IDAsICAgICAgLy8gSU5URVJOQUwgVVNFIE9OTFlcbiAgICBfX2Vycm9yX2luZm9zOiBbXSwgICAgICAgICAgICAgIC8vIElOVEVSTkFMIFVTRSBPTkxZOiB0aGUgc2V0IG9mIHBhcnNlRXJyb3JJbmZvIG9iamVjdHMgY3JlYXRlZCBzaW5jZSB0aGUgbGFzdCBjbGVhbnVwXG4gICAgX19lcnJvcl9yZWNvdmVyeV9pbmZvczogW10sICAgICAvLyBJTlRFUk5BTCBVU0UgT05MWTogdGhlIHNldCBvZiBwYXJzZUVycm9ySW5mbyBvYmplY3RzIGNyZWF0ZWQgc2luY2UgdGhlIGxhc3QgY2xlYW51cFxuXG4gICAgLy8gQVBJcyB3aGljaCB3aWxsIGJlIHNldCB1cCBkZXBlbmRpbmcgb24gdXNlciBhY3Rpb24gY29kZSBhbmFseXNpczpcbiAgICAvL3l5UmVjb3ZlcmluZzogMCxcbiAgICAvL3l5RXJyT2s6IDAsXG4gICAgLy95eUNsZWFySW46IDAsXG5cbiAgICAvLyBIZWxwZXIgQVBJc1xuICAgIC8vIC0tLS0tLS0tLS0tXG5cbiAgICAvLyBIZWxwZXIgZnVuY3Rpb24gd2hpY2ggY2FuIGJlIG92ZXJyaWRkZW4gYnkgdXNlciBjb2RlIGxhdGVyIG9uOiBwdXQgc3VpdGFibGUgcXVvdGVzIGFyb3VuZFxuICAgIC8vIGxpdGVyYWwgSURzIGluIGEgZGVzY3JpcHRpb24gc3RyaW5nLlxuICAgIHF1b3RlTmFtZTogZnVuY3Rpb24gcGFyc2VyX3F1b3RlTmFtZShpZF9zdHIpIHtcbiAgICAgICAgcmV0dXJuICdcIicgKyBpZF9zdHIgKyAnXCInO1xuICAgIH0sXG5cbiAgICAvLyBSZXR1cm4gdGhlIG5hbWUgb2YgdGhlIGdpdmVuIHN5bWJvbCAodGVybWluYWwgb3Igbm9uLXRlcm1pbmFsKSBhcyBhIHN0cmluZywgd2hlbiBhdmFpbGFibGUuXG4gICAgLy9cbiAgICAvLyBSZXR1cm4gTlVMTCB3aGVuIHRoZSBzeW1ib2wgaXMgdW5rbm93biB0byB0aGUgcGFyc2VyLlxuICAgIGdldFN5bWJvbE5hbWU6IGZ1bmN0aW9uIHBhcnNlcl9nZXRTeW1ib2xOYW1lKHN5bWJvbCkge1xuICAgICAgICBpZiAodGhpcy50ZXJtaW5hbHNfW3N5bWJvbF0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRlcm1pbmFsc19bc3ltYm9sXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE90aGVyd2lzZS4uLiB0aGlzIG1pZ2h0IHJlZmVyIHRvIGEgUlVMRSB0b2tlbiBpLmUuIGEgbm9uLXRlcm1pbmFsOiBzZWUgaWYgd2UgY2FuIGRpZyB0aGF0IG9uZSB1cC5cbiAgICAgICAgLy9cbiAgICAgICAgLy8gQW4gZXhhbXBsZSBvZiB0aGlzIG1heSBiZSB3aGVyZSBhIHJ1bGUncyBhY3Rpb24gY29kZSBjb250YWlucyBhIGNhbGwgbGlrZSB0aGlzOlxuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgIHBhcnNlci5nZXRTeW1ib2xOYW1lKCMkKVxuICAgICAgICAvL1xuICAgICAgICAvLyB0byBvYnRhaW4gYSBodW1hbi1yZWFkYWJsZSBuYW1lIG9mIHRoZSBjdXJyZW50IGdyYW1tYXIgcnVsZS5cbiAgICAgICAgdmFyIHMgPSB0aGlzLnN5bWJvbHNfO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcykge1xuICAgICAgICAgICAgaWYgKHNba2V5XSA9PT0gc3ltYm9sKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8gUmV0dXJuIGEgbW9yZS1vci1sZXNzIGh1bWFuLXJlYWRhYmxlIGRlc2NyaXB0aW9uIG9mIHRoZSBnaXZlbiBzeW1ib2wsIHdoZW4gYXZhaWxhYmxlLFxuICAgIC8vIG9yIHRoZSBzeW1ib2wgaXRzZWxmLCBzZXJ2aW5nIGFzIGl0cyBvd24gJ2Rlc2NyaXB0aW9uJyBmb3IgbGFjayBvZiBzb21ldGhpbmcgYmV0dGVyIHRvIHNlcnZlIHVwLlxuICAgIC8vXG4gICAgLy8gUmV0dXJuIE5VTEwgd2hlbiB0aGUgc3ltYm9sIGlzIHVua25vd24gdG8gdGhlIHBhcnNlci5cbiAgICBkZXNjcmliZVN5bWJvbDogZnVuY3Rpb24gcGFyc2VyX2Rlc2NyaWJlU3ltYm9sKHN5bWJvbCkge1xuICAgICAgICBpZiAoc3ltYm9sICE9PSB0aGlzLkVPRiAmJiB0aGlzLnRlcm1pbmFsX2Rlc2NyaXB0aW9uc18gJiYgdGhpcy50ZXJtaW5hbF9kZXNjcmlwdGlvbnNfW3N5bWJvbF0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRlcm1pbmFsX2Rlc2NyaXB0aW9uc19bc3ltYm9sXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzeW1ib2wgPT09IHRoaXMuRU9GKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2VuZCBvZiBpbnB1dCc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlkID0gdGhpcy5nZXRTeW1ib2xOYW1lKHN5bWJvbCk7XG4gICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVvdGVOYW1lKGlkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgLy8gUHJvZHVjZSBhIChtb3JlIG9yIGxlc3MpIGh1bWFuLXJlYWRhYmxlIGxpc3Qgb2YgZXhwZWN0ZWQgdG9rZW5zIGF0IHRoZSBwb2ludCBvZiBmYWlsdXJlLlxuICAgIC8vXG4gICAgLy8gVGhlIHByb2R1Y2VkIGxpc3QgbWF5IGNvbnRhaW4gdG9rZW4gb3IgdG9rZW4gc2V0IGRlc2NyaXB0aW9ucyBpbnN0ZWFkIG9mIHRoZSB0b2tlbnNcbiAgICAvLyB0aGVtc2VsdmVzIHRvIGhlbHAgdHVybmluZyB0aGlzIG91dHB1dCBpbnRvIHNvbWV0aGluZyB0aGF0IGVhc2llciB0byByZWFkIGJ5IGh1bWFuc1xuICAgIC8vIHVubGVzcyBgZG9fbm90X2Rlc2NyaWJlYCBwYXJhbWV0ZXIgaXMgc2V0LCBpbiB3aGljaCBjYXNlIGEgbGlzdCBvZiB0aGUgcmF3LCAqbnVtZXJpYyosXG4gICAgLy8gZXhwZWN0ZWQgdGVybWluYWxzIGFuZCBub250ZXJtaW5hbHMgaXMgcHJvZHVjZWQuXG4gICAgLy9cbiAgICAvLyBUaGUgcmV0dXJuZWQgbGlzdCAoYXJyYXkpIHdpbGwgbm90IGNvbnRhaW4gYW55IGR1cGxpY2F0ZSBlbnRyaWVzLlxuICAgIGNvbGxlY3RfZXhwZWN0ZWRfdG9rZW5fc2V0OiBmdW5jdGlvbiBwYXJzZXJfY29sbGVjdF9leHBlY3RlZF90b2tlbl9zZXQoc3RhdGUsIGRvX25vdF9kZXNjcmliZSkge1xuICAgICAgICB2YXIgVEVSUk9SID0gdGhpcy5URVJST1I7XG4gICAgICAgIHZhciB0b2tlbnNldCA9IFtdO1xuICAgICAgICB2YXIgY2hlY2sgPSB7fTtcbiAgICAgICAgLy8gSGFzIHRoaXMgKGVycm9yPykgc3RhdGUgYmVlbiBvdXRmaXR0ZWQgd2l0aCBhIGN1c3RvbSBleHBlY3RhdGlvbnMgZGVzY3JpcHRpb24gdGV4dCBmb3IgaHVtYW4gY29uc3VtcHRpb24/XG4gICAgICAgIC8vIElmIHNvLCB1c2UgdGhhdCBvbmUgaW5zdGVhZCBvZiB0aGUgbGVzcyBwYWxhdGFibGUgdG9rZW4gc2V0LlxuICAgICAgICBpZiAoIWRvX25vdF9kZXNjcmliZSAmJiB0aGlzLnN0YXRlX2Rlc2NyaXB0aW9uc18gJiYgdGhpcy5zdGF0ZV9kZXNjcmlwdGlvbnNfW3N0YXRlXSkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlX2Rlc2NyaXB0aW9uc19bc3RhdGVdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHAgaW4gdGhpcy50YWJsZVtzdGF0ZV0pIHtcbiAgICAgICAgICAgIHAgPSArcDtcbiAgICAgICAgICAgIGlmIChwICE9PSBURVJST1IpIHtcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGRvX25vdF9kZXNjcmliZSA/IHAgOiB0aGlzLmRlc2NyaWJlU3ltYm9sKHApO1xuICAgICAgICAgICAgICAgIGlmIChkICYmICFjaGVja1tkXSkge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbnNldC5wdXNoKGQpO1xuICAgICAgICAgICAgICAgICAgICBjaGVja1tkXSA9IHRydWU7ICAgICAgICAvLyBNYXJrIHRoaXMgdG9rZW4gZGVzY3JpcHRpb24gYXMgYWxyZWFkeSBtZW50aW9uZWQgdG8gcHJldmVudCBvdXRwdXR0aW5nIGR1cGxpY2F0ZSBlbnRyaWVzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9rZW5zZXQ7XG4gICAgfSxcbnByb2R1Y3Rpb25zXzogYnAoe1xuICBwb3A6IHUoW1xuICAyNyxcbiAgcyxcbiAgWzI4LCAxMF0sXG4gIDI5LFxuICAyOSxcbiAgMzAsXG4gIHMsXG4gIFszMSwgMTVdXG5dKSxcbiAgcnVsZTogdShbXG4gIDIsXG4gIHMsXG4gIFszLCA1XSxcbiAgNCxcbiAgNyxcbiAgcyxcbiAgWzEsIDRdLFxuICAyLFxuICBzLFxuICBbMSwgMTVdLFxuICAyXG5dKVxufSksXG5wZXJmb3JtQWN0aW9uOiBmdW5jdGlvbiBwYXJzZXJfX1BlcmZvcm1BY3Rpb24oeXlzdGF0ZSAvKiBhY3Rpb25bMV0gKi8sIHl5c3AsIHl5dnN0YWNrKSB7XG5cbiAgICAgICAgICAvKiB0aGlzID09IHl5dmFsICovXG5cbiAgICAgICAgICAvLyB0aGUgSlMgZW5naW5lIGl0c2VsZiBjYW4gZ28gYW5kIHJlbW92ZSB0aGVzZSBzdGF0ZW1lbnRzIHdoZW4gYHl5YCB0dXJucyBvdXQgdG8gYmUgdW51c2VkIGluIGFueSBhY3Rpb24gY29kZSFcbiAgICAgICAgICB2YXIgeXkgPSB0aGlzLnl5O1xuICAgICAgICAgIHZhciB5eXBhcnNlciA9IHl5LnBhcnNlcjtcbiAgICAgICAgICB2YXIgeXlsZXhlciA9IHl5LmxleGVyO1xuXG4gICAgICAgICAgXG5cbiAgICAgICAgICBzd2l0Y2ggKHl5c3RhdGUpIHtcbmNhc2UgMDpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgICRhY2NlcHQgOiBleHByZXNzaW9uICRlbmQgKi9cblxuICAgIC8vIGRlZmF1bHQgYWN0aW9uIChnZW5lcmF0ZWQgYnkgSklTT04gbW9kZSBjbGFzc2ljL21lcmdlIDo6IDEsVlQsVkEsLSwtLC0sLSwtLC0pOlxuICAgIHRoaXMuJCA9IHl5dnN0YWNrW3l5c3AgLSAxXTtcbiAgICAvLyBFTkQgb2YgZGVmYXVsdCBhY3Rpb24gKGdlbmVyYXRlZCBieSBKSVNPTiBtb2RlIGNsYXNzaWMvbWVyZ2UgOjogMSxWVCxWQSwtLC0sLSwtLC0sLSlcbiAgICBicmVhaztcblxuY2FzZSAxOlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgZXhwcmVzc2lvbiA6IG1hdGhfZXhwcmVzc2lvbiBFT0YgKi9cblxuICAgIC8vIGRlZmF1bHQgYWN0aW9uIChnZW5lcmF0ZWQgYnkgSklTT04gbW9kZSBjbGFzc2ljL21lcmdlIDo6IDIsVlQsVkEsLSwtLC0sLSwtLC0pOlxuICAgIHRoaXMuJCA9IHl5dnN0YWNrW3l5c3AgLSAxXTtcbiAgICAvLyBFTkQgb2YgZGVmYXVsdCBhY3Rpb24gKGdlbmVyYXRlZCBieSBKSVNPTiBtb2RlIGNsYXNzaWMvbWVyZ2UgOjogMixWVCxWQSwtLC0sLSwtLC0sLSlcbiAgICBcbiAgICBcbiAgICByZXR1cm4geXl2c3RhY2tbeXlzcCAtIDFdO1xuICAgIGJyZWFrO1xuXG5jYXNlIDI6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBtYXRoX2V4cHJlc3Npb24gOiBtYXRoX2V4cHJlc3Npb24gQUREIG1hdGhfZXhwcmVzc2lvbiAqL1xuY2FzZSAzOlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgbWF0aF9leHByZXNzaW9uIDogbWF0aF9leHByZXNzaW9uIFNVQiBtYXRoX2V4cHJlc3Npb24gKi9cbmNhc2UgNDpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIG1hdGhfZXhwcmVzc2lvbiA6IG1hdGhfZXhwcmVzc2lvbiBNVUwgbWF0aF9leHByZXNzaW9uICovXG5jYXNlIDU6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBtYXRoX2V4cHJlc3Npb24gOiBtYXRoX2V4cHJlc3Npb24gRElWIG1hdGhfZXhwcmVzc2lvbiAqL1xuXG4gICAgdGhpcy4kID0geyB0eXBlOiAnTWF0aEV4cHJlc3Npb24nLCBvcGVyYXRvcjogeXl2c3RhY2tbeXlzcCAtIDFdLCBsZWZ0OiB5eXZzdGFja1t5eXNwIC0gMl0sIHJpZ2h0OiB5eXZzdGFja1t5eXNwXSB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDY6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBtYXRoX2V4cHJlc3Npb24gOiBMUEFSRU4gbWF0aF9leHByZXNzaW9uIFJQQVJFTiAqL1xuY2FzZSA3OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgbWF0aF9leHByZXNzaW9uIDogTkVTVEVEX0NBTEMgTFBBUkVOIG1hdGhfZXhwcmVzc2lvbiBSUEFSRU4gKi9cbmNhc2UgODpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIG1hdGhfZXhwcmVzc2lvbiA6IFNVQiBQUkVGSVggU1VCIE5FU1RFRF9DQUxDIExQQVJFTiBtYXRoX2V4cHJlc3Npb24gUlBBUkVOICovXG5cbiAgICB0aGlzLiQgPSB5eXZzdGFja1t5eXNwIC0gMV07XG4gICAgYnJlYWs7XG5cbmNhc2UgOTpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIG1hdGhfZXhwcmVzc2lvbiA6IGNzc192YXJpYWJsZSAqL1xuY2FzZSAxMDpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIG1hdGhfZXhwcmVzc2lvbiA6IGNzc192YWx1ZSAqL1xuY2FzZSAxMTpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIG1hdGhfZXhwcmVzc2lvbiA6IHZhbHVlICovXG5cbiAgICB0aGlzLiQgPSB5eXZzdGFja1t5eXNwXTtcbiAgICBicmVhaztcblxuY2FzZSAxMjpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIHZhbHVlIDogTlVNQkVSICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdWYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDEzOlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgdmFsdWUgOiBTVUIgTlVNQkVSICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdWYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSAqIC0xIH07XG4gICAgYnJlYWs7XG5cbmNhc2UgMTQ6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBjc3NfdmFyaWFibGUgOiBDU1NfVkFSICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdDc3NWYXJpYWJsZScsIHZhbHVlOiB5eXZzdGFja1t5eXNwXSB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDE1OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogTEVOR1RIICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdMZW5ndGhWYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSwgdW5pdDogL1thLXpdKy8uZXhlYyh5eXZzdGFja1t5eXNwXSlbMF0gfTtcbiAgICBicmVhaztcblxuY2FzZSAxNjpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIGNzc192YWx1ZSA6IEFOR0xFICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdBbmdsZVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoeXl2c3RhY2tbeXlzcF0pLCB1bml0OiAvW2Etel0rLy5leGVjKHl5dnN0YWNrW3l5c3BdKVswXSB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDE3OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogVElNRSAqL1xuXG4gICAgdGhpcy4kID0geyB0eXBlOiAnVGltZVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoeXl2c3RhY2tbeXlzcF0pLCB1bml0OiAvW2Etel0rLy5leGVjKHl5dnN0YWNrW3l5c3BdKVswXSB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDE4OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogRlJFUSAqL1xuXG4gICAgdGhpcy4kID0geyB0eXBlOiAnRnJlcXVlbmN5VmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCh5eXZzdGFja1t5eXNwXSksIHVuaXQ6IC9bYS16XSsvLmV4ZWMoeXl2c3RhY2tbeXlzcF0pWzBdIH07XG4gICAgYnJlYWs7XG5cbmNhc2UgMTk6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBjc3NfdmFsdWUgOiBSRVMgKi9cblxuICAgIHRoaXMuJCA9IHsgdHlwZTogJ1Jlc29sdXRpb25WYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSwgdW5pdDogL1thLXpdKy8uZXhlYyh5eXZzdGFja1t5eXNwXSlbMF0gfTtcbiAgICBicmVhaztcblxuY2FzZSAyMDpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIGNzc192YWx1ZSA6IEVNUyAqL1xuXG4gICAgdGhpcy4kID0geyB0eXBlOiAnRW1WYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSwgdW5pdDogJ2VtJyB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDIxOlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogRVhTICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdFeFZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoeXl2c3RhY2tbeXlzcF0pLCB1bml0OiAnZXgnIH07XG4gICAgYnJlYWs7XG5cbmNhc2UgMjI6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBjc3NfdmFsdWUgOiBDSFMgKi9cblxuICAgIHRoaXMuJCA9IHsgdHlwZTogJ0NoVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCh5eXZzdGFja1t5eXNwXSksIHVuaXQ6ICdjaCcgfTtcbiAgICBicmVhaztcblxuY2FzZSAyMzpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIGNzc192YWx1ZSA6IFJFTVMgKi9cblxuICAgIHRoaXMuJCA9IHsgdHlwZTogJ1JlbVZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoeXl2c3RhY2tbeXlzcF0pLCB1bml0OiAncmVtJyB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDI0OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogVkhTICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdWaFZhbHVlJywgdmFsdWU6IHBhcnNlRmxvYXQoeXl2c3RhY2tbeXlzcF0pLCB1bml0OiAndmgnIH07XG4gICAgYnJlYWs7XG5cbmNhc2UgMjU6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBjc3NfdmFsdWUgOiBWV1MgKi9cblxuICAgIHRoaXMuJCA9IHsgdHlwZTogJ1Z3VmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCh5eXZzdGFja1t5eXNwXSksIHVuaXQ6ICd2dycgfTtcbiAgICBicmVhaztcblxuY2FzZSAyNjpcbiAgICAvKiEgUHJvZHVjdGlvbjo6ICAgIGNzc192YWx1ZSA6IFZNSU5TICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdWbWluVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCh5eXZzdGFja1t5eXNwXSksIHVuaXQ6ICd2bWluJyB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDI3OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogVk1BWFMgKi9cblxuICAgIHRoaXMuJCA9IHsgdHlwZTogJ1ZtYXhWYWx1ZScsIHZhbHVlOiBwYXJzZUZsb2F0KHl5dnN0YWNrW3l5c3BdKSwgdW5pdDogJ3ZtYXgnIH07XG4gICAgYnJlYWs7XG5cbmNhc2UgMjg6XG4gICAgLyohIFByb2R1Y3Rpb246OiAgICBjc3NfdmFsdWUgOiBQRVJDRU5UQUdFICovXG5cbiAgICB0aGlzLiQgPSB7IHR5cGU6ICdQZXJjZW50YWdlVmFsdWUnLCB2YWx1ZTogcGFyc2VGbG9hdCh5eXZzdGFja1t5eXNwXSksIHVuaXQ6ICclJyB9O1xuICAgIGJyZWFrO1xuXG5jYXNlIDI5OlxuICAgIC8qISBQcm9kdWN0aW9uOjogICAgY3NzX3ZhbHVlIDogU1VCIGNzc192YWx1ZSAqL1xuXG4gICAgdmFyIHByZXYgPSB5eXZzdGFja1t5eXNwXTsgcHJldi52YWx1ZSAqPSAtMTsgdGhpcy4kID0gcHJldjtcbiAgICBicmVhaztcblxufVxufSxcbnRhYmxlOiBidCh7XG4gIGxlbjogdShbXG4gIDI0LFxuICAxLFxuICA1LFxuICAyMyxcbiAgMSxcbiAgMTgsXG4gIHMsXG4gIFswLCAyMF0sXG4gIHMsXG4gIFsyMywgNF0sXG4gIGMsXG4gIFsyOCwgM10sXG4gIDAsXG4gIDAsXG4gIDE2LFxuICA2LFxuICA2LFxuICBzLFxuICBbMCwgM10sXG4gIDUsXG4gIDEsXG4gIDAsXG4gIDEsXG4gIDIzLFxuICA1LFxuICAwXG5dKSxcbiAgc3ltYm9sOiB1KFtcbiAgNCxcbiAgNyxcbiAgOSxcbiAgcyxcbiAgWzExLCAyMSwgMV0sXG4gIDEsXG4gIDEsXG4gIHMsXG4gIFszLCA0LCAxXSxcbiAgYyxcbiAgWzMwLCAxOV0sXG4gIGMsXG4gIFsyOSwgNF0sXG4gIDcsXG4gIDQsXG4gIDEwLFxuICAxMSxcbiAgYyxcbiAgWzIyLCAxNF0sXG4gIDMxLFxuICBjLFxuICBbNDIsIDIzXSxcbiAgYyxcbiAgWzIzLCA2OV0sXG4gIGMsXG4gIFsxMzgsIDRdLFxuICA4LFxuICBjLFxuICBbNTEsIDI0XSxcbiAgNCxcbiAgYyxcbiAgWzEzNywgMTVdLFxuICBjLFxuICBbMTg0LCA1XSxcbiAgOCxcbiAgYyxcbiAgWzYsIDZdLFxuICBjLFxuICBbNSwgNV0sXG4gIDksXG4gIDcsXG4gIGMsXG4gIFs4NywgMjhdXG5dKSxcbiAgdHlwZTogdShbXG4gIHMsXG4gIFsyLCAxOV0sXG4gIHMsXG4gIFswLCA1XSxcbiAgMSxcbiAgcyxcbiAgWzIsIDI0XSxcbiAgcyxcbiAgWzAsIDRdLFxuICBjLFxuICBbMjIsIDE5XSxcbiAgYyxcbiAgWzQyLCA0MV0sXG4gIGMsXG4gIFsyMywgNzBdLFxuICBjLFxuICBbMjgsIDI1XSxcbiAgYyxcbiAgWzQ1LCAyNV0sXG4gIGMsXG4gIFs1OSwgMjNdXG5dKSxcbiAgc3RhdGU6IHUoW1xuICAxLFxuICAyLFxuICA4LFxuICA2LFxuICA3LFxuICAzMCxcbiAgYyxcbiAgWzQsIDNdLFxuICAzMyxcbiAgMzYsXG4gIGMsXG4gIFs1LCAzXSxcbiAgMzcsXG4gIGMsXG4gIFs0LCAzXSxcbiAgMzgsXG4gIGMsXG4gIFs0LCAzXSxcbiAgMzksXG4gIGMsXG4gIFs0LCAzXSxcbiAgNDEsXG4gIGMsXG4gIFsyMSwgNF0sXG4gIDQ2LFxuICBjLFxuICBbNSwgM11cbl0pLFxuICBtb2RlOiB1KFtcbiAgcyxcbiAgWzEsIDE3N10sXG4gIHMsXG4gIFsyLCAzXSxcbiAgYyxcbiAgWzUsIDVdLFxuICBjLFxuICBbNiwgNF0sXG4gIHMsXG4gIFsxLCAzMV1cbl0pLFxuICBnb3RvOiB1KFtcbiAgNSxcbiAgMyxcbiAgNCxcbiAgMjQsXG4gIHMsXG4gIFs5LCAxNSwgMV0sXG4gIHMsXG4gIFsyNSwgNSwgMV0sXG4gIGMsXG4gIFsyNCwgMTldLFxuICAzMSxcbiAgMzUsXG4gIDMyLFxuICAzNCxcbiAgYyxcbiAgWzE4LCAxNF0sXG4gIGMsXG4gIFszNywgMTldLFxuICBjLFxuICBbMTksIDU3XSxcbiAgYyxcbiAgWzExNywgNF0sXG4gIDQwLFxuICBjLFxuICBbMjQsIDE5XSxcbiAgNDIsXG4gIDM1LFxuICBjLFxuICBbMTYsIDE0XSxcbiAgcyxcbiAgWzIsIDNdLFxuICAyOCxcbiAgMjksXG4gIDIsXG4gIHMsXG4gIFszLCAzXSxcbiAgMjgsXG4gIDI5LFxuICAzLFxuICBjLFxuICBbNTIsIDRdLFxuICA0MyxcbiAgNDQsXG4gIDQ1LFxuICBjLFxuICBbNzgsIDIzXSxcbiAgNDdcbl0pXG59KSxcbmRlZmF1bHRBY3Rpb25zOiBiZGEoe1xuICBpZHg6IHUoW1xuICBzLFxuICBbNiwgMjAsIDFdLFxuICAzMyxcbiAgMzQsXG4gIDM4LFxuICAzOSxcbiAgNDAsXG4gIDQzLFxuICA0N1xuXSksXG4gIGdvdG86IHUoW1xuICA5LFxuICAxMCxcbiAgMTEsXG4gIHMsXG4gIFsxNCwgMTUsIDFdLFxuICAxMixcbiAgMSxcbiAgMjksXG4gIDEzLFxuICBzLFxuICBbNCwgNSwgMV1cbl0pXG59KSxcbnBhcnNlRXJyb3I6IGZ1bmN0aW9uIHBhcnNlRXJyb3Ioc3RyLCBoYXNoLCBFeGNlcHRpb25DbGFzcykge1xuICAgIGlmIChoYXNoLnJlY292ZXJhYmxlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy50cmFjZShzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGhhc2guZGVzdHJveSgpOyAgICAgICAgICAgICAvLyBkZXN0cm95Li4uIHdlbGwsICphbG1vc3QqIVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy50cmFjZShzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghRXhjZXB0aW9uQ2xhc3MpIHtcbiAgICAgICAgICAgIEV4Y2VwdGlvbkNsYXNzID0gdGhpcy5KaXNvblBhcnNlckVycm9yO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFeGNlcHRpb25DbGFzcyhzdHIsIGhhc2gpO1xuICAgIH1cbn0sXG5wYXJzZTogZnVuY3Rpb24gcGFyc2UoaW5wdXQpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHN0YWNrID0gbmV3IEFycmF5KDEyOCk7ICAgICAgICAgLy8gdG9rZW4gc3RhY2s6IHN0b3JlcyB0b2tlbiB3aGljaCBsZWFkcyB0byBzdGF0ZSBhdCB0aGUgc2FtZSBpbmRleCAoY29sdW1uIHN0b3JhZ2UpXG4gICAgdmFyIHNzdGFjayA9IG5ldyBBcnJheSgxMjgpOyAgICAgICAgLy8gc3RhdGUgc3RhY2s6IHN0b3JlcyBzdGF0ZXMgKGNvbHVtbiBzdG9yYWdlKVxuXG4gICAgdmFyIHZzdGFjayA9IG5ldyBBcnJheSgxMjgpOyAgICAgICAgLy8gc2VtYW50aWMgdmFsdWUgc3RhY2tcblxuICAgIHZhciB0YWJsZSA9IHRoaXMudGFibGU7XG4gICAgdmFyIHNwID0gMDsgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ3N0YWNrIHBvaW50ZXInOiBpbmRleCBpbnRvIHRoZSBzdGFja3NcblxuXG4gICAgXG5cblxuICAgIHZhciBzeW1ib2wgPSAwO1xuXG5cblxuICAgIHZhciBURVJST1IgPSB0aGlzLlRFUlJPUjtcbiAgICB2YXIgRU9GID0gdGhpcy5FT0Y7XG4gICAgdmFyIEVSUk9SX1JFQ09WRVJZX1RPS0VOX0RJU0NBUkRfQ09VTlQgPSAodGhpcy5vcHRpb25zLmVycm9yUmVjb3ZlcnlUb2tlbkRpc2NhcmRDb3VudCB8IDApIHx8IDM7XG4gICAgdmFyIE5PX0FDVElPTiA9IFswLCA0OCAvKiA9PT0gdGFibGUubGVuZ3RoIDo6IGVuc3VyZXMgdGhhdCBhbnlvbmUgdXNpbmcgdGhpcyBuZXcgc3RhdGUgd2lsbCBmYWlsIGRyYW1hdGljYWxseSEgKi9dO1xuXG4gICAgdmFyIGxleGVyO1xuICAgIGlmICh0aGlzLl9fbGV4ZXJfXykge1xuICAgICAgICBsZXhlciA9IHRoaXMuX19sZXhlcl9fO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxleGVyID0gdGhpcy5fX2xleGVyX18gPSBPYmplY3QuY3JlYXRlKHRoaXMubGV4ZXIpO1xuICAgIH1cblxuICAgIHZhciBzaGFyZWRTdGF0ZV95eSA9IHtcbiAgICAgICAgcGFyc2VFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICBxdW90ZU5hbWU6IHVuZGVmaW5lZCxcbiAgICAgICAgbGV4ZXI6IHVuZGVmaW5lZCxcbiAgICAgICAgcGFyc2VyOiB1bmRlZmluZWQsXG4gICAgICAgIHByZV9wYXJzZTogdW5kZWZpbmVkLFxuICAgICAgICBwb3N0X3BhcnNlOiB1bmRlZmluZWQsXG4gICAgICAgIHByZV9sZXg6IHVuZGVmaW5lZCxcbiAgICAgICAgcG9zdF9sZXg6IHVuZGVmaW5lZCAgICAgIC8vIFdBUk5JTkc6IG11c3QgYmUgd3JpdHRlbiB0aGlzIHdheSBmb3IgdGhlIGNvZGUgZXhwYW5kZXJzIHRvIHdvcmsgY29ycmVjdGx5IGluIGJvdGggRVM1IGFuZCBFUzYgbW9kZXMhXG4gICAgfTtcblxuICAgIHZhciBBU1NFUlQ7XG4gICAgaWYgKHR5cGVvZiBhc3NlcnQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgQVNTRVJUID0gZnVuY3Rpb24gSmlzb25Bc3NlcnQoY29uZCwgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIWNvbmQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Fzc2VydGlvbiBmYWlsZWQ6ICcgKyAobXNnIHx8ICcqKionKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgQVNTRVJUID0gYXNzZXJ0O1xuICAgIH1cblxuICAgIHRoaXMueXlHZXRTaGFyZWRTdGF0ZSA9IGZ1bmN0aW9uIHl5R2V0U2hhcmVkU3RhdGUoKSB7XG4gICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZV95eTtcbiAgICB9O1xuXG5cblxuXG5cblxuXG5cbiAgICBmdW5jdGlvbiBzaGFsbG93X2NvcHlfbm9jbG9iYmVyKGRzdCwgc3JjKSB7XG4gICAgICAgIGZvciAodmFyIGsgaW4gc3JjKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRzdFtrXSA9PT0gJ3VuZGVmaW5lZCcgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNyYywgaykpIHtcbiAgICAgICAgICAgICAgICBkc3Rba10gPSBzcmNba107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjb3B5IHN0YXRlXG4gICAgc2hhbGxvd19jb3B5X25vY2xvYmJlcihzaGFyZWRTdGF0ZV95eSwgdGhpcy55eSk7XG5cbiAgICBzaGFyZWRTdGF0ZV95eS5sZXhlciA9IGxleGVyO1xuICAgIHNoYXJlZFN0YXRlX3l5LnBhcnNlciA9IHRoaXM7XG5cblxuXG5cblxuXG4gICAgLy8gRG9lcyB0aGUgc2hhcmVkIHN0YXRlIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGBwYXJzZUVycm9yYCB0aGF0IGFscmVhZHkgY29tZXMgd2l0aCB0aGlzIGluc3RhbmNlP1xuICAgIGlmICh0eXBlb2Ygc2hhcmVkU3RhdGVfeXkucGFyc2VFcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLnBhcnNlRXJyb3IgPSBmdW5jdGlvbiBwYXJzZUVycm9yQWx0KHN0ciwgaGFzaCwgRXhjZXB0aW9uQ2xhc3MpIHtcbiAgICAgICAgICAgIGlmICghRXhjZXB0aW9uQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICBFeGNlcHRpb25DbGFzcyA9IHRoaXMuSmlzb25QYXJzZXJFcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzaGFyZWRTdGF0ZV95eS5wYXJzZUVycm9yLmNhbGwodGhpcywgc3RyLCBoYXNoLCBFeGNlcHRpb25DbGFzcyk7XG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wYXJzZUVycm9yID0gdGhpcy5vcmlnaW5hbFBhcnNlRXJyb3I7XG4gICAgfVxuXG4gICAgLy8gRG9lcyB0aGUgc2hhcmVkIHN0YXRlIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGBxdW90ZU5hbWVgIHRoYXQgYWxyZWFkeSBjb21lcyB3aXRoIHRoaXMgaW5zdGFuY2U/XG4gICAgaWYgKHR5cGVvZiBzaGFyZWRTdGF0ZV95eS5xdW90ZU5hbWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5xdW90ZU5hbWUgPSBmdW5jdGlvbiBxdW90ZU5hbWVBbHQoaWRfc3RyKSB7XG4gICAgICAgICAgICByZXR1cm4gc2hhcmVkU3RhdGVfeXkucXVvdGVOYW1lLmNhbGwodGhpcywgaWRfc3RyKTtcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnF1b3RlTmFtZSA9IHRoaXMub3JpZ2luYWxRdW90ZU5hbWU7XG4gICAgfVxuXG4gICAgLy8gc2V0IHVwIHRoZSBjbGVhbnVwIGZ1bmN0aW9uOyBtYWtlIGl0IGFuIEFQSSBzbyB0aGF0IGV4dGVybmFsIGNvZGUgY2FuIHJlLXVzZSB0aGlzIG9uZSBpbiBjYXNlIG9mXG4gICAgLy8gY2FsYW1pdGllcyBvciB3aGVuIHRoZSBgJW9wdGlvbnMgbm8tdHJ5LWNhdGNoYCBvcHRpb24gaGFzIGJlZW4gc3BlY2lmaWVkIGZvciB0aGUgZ3JhbW1hciwgaW4gd2hpY2hcbiAgICAvLyBjYXNlIHRoaXMgcGFyc2UoKSBBUEkgbWV0aG9kIGRvZXNuJ3QgY29tZSB3aXRoIGEgYGZpbmFsbHkgeyAuLi4gfWAgYmxvY2sgYW55IG1vcmUhXG4gICAgLy9cbiAgICAvLyBOT1RFOiBhcyB0aGlzIEFQSSB1c2VzIHBhcnNlKCkgYXMgYSBjbG9zdXJlLCBpdCBNVVNUIGJlIHNldCBhZ2FpbiBvbiBldmVyeSBwYXJzZSgpIGludm9jYXRpb24sXG4gICAgLy8gICAgICAgb3IgZWxzZSB5b3VyIGBzaGFyZWRTdGF0ZWAsIGV0Yy4gcmVmZXJlbmNlcyB3aWxsIGJlICp3cm9uZyohXG4gICAgdGhpcy5jbGVhbnVwQWZ0ZXJQYXJzZSA9IGZ1bmN0aW9uIHBhcnNlcl9jbGVhbnVwQWZ0ZXJQYXJzZShyZXN1bHRWYWx1ZSwgaW52b2tlX3Bvc3RfbWV0aG9kcywgZG9fbm90X251a2VfZXJyb3JpbmZvcykge1xuICAgICAgICB2YXIgcnY7XG5cbiAgICAgICAgaWYgKGludm9rZV9wb3N0X21ldGhvZHMpIHtcbiAgICAgICAgICAgIHZhciBoYXNoO1xuXG4gICAgICAgICAgICBpZiAoc2hhcmVkU3RhdGVfeXkucG9zdF9wYXJzZSB8fCB0aGlzLnBvc3RfcGFyc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYW4gZXJyb3IgaGFzaCBpbmZvIGluc3RhbmNlOiB3ZSByZS11c2UgdGhpcyBBUEkgaW4gYSAqKm5vbi1lcnJvciBzaXR1YXRpb24qKlxuICAgICAgICAgICAgICAgIC8vIGFzIHRoaXMgb25lIGRlbGl2ZXJzIGFsbCBwYXJzZXIgaW50ZXJuYWxzIHJlYWR5IGZvciBhY2Nlc3MgYnkgdXNlcmxhbmQgY29kZS5cbiAgICAgICAgICAgICAgICBoYXNoID0gdGhpcy5jb25zdHJ1Y3RQYXJzZUVycm9ySW5mbyhudWxsIC8qIG5vIGVycm9yISAqLywgbnVsbCAvKiBubyBleGNlcHRpb24hICovLCBudWxsLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzaGFyZWRTdGF0ZV95eS5wb3N0X3BhcnNlKSB7XG4gICAgICAgICAgICAgICAgcnYgPSBzaGFyZWRTdGF0ZV95eS5wb3N0X3BhcnNlLmNhbGwodGhpcywgc2hhcmVkU3RhdGVfeXksIHJlc3VsdFZhbHVlLCBoYXNoKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJ2ICE9PSAndW5kZWZpbmVkJykgcmVzdWx0VmFsdWUgPSBydjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnBvc3RfcGFyc2UpIHtcbiAgICAgICAgICAgICAgICBydiA9IHRoaXMucG9zdF9wYXJzZS5jYWxsKHRoaXMsIHNoYXJlZFN0YXRlX3l5LCByZXN1bHRWYWx1ZSwgaGFzaCk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBydiAhPT0gJ3VuZGVmaW5lZCcpIHJlc3VsdFZhbHVlID0gcnY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNsZWFudXA6XG4gICAgICAgICAgICBpZiAoaGFzaCAmJiBoYXNoLmRlc3Ryb3kpIHtcbiAgICAgICAgICAgICAgICBoYXNoLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9fcmVlbnRyYW50X2NhbGxfZGVwdGggPiAxKSByZXR1cm4gcmVzdWx0VmFsdWU7ICAgICAgICAvLyBkbyBub3QgKHlldCkga2lsbCB0aGUgc2hhcmVkU3RhdGUgd2hlbiB0aGlzIGlzIGEgcmVlbnRyYW50IHJ1bi5cblxuICAgICAgICAvLyBjbGVhbiB1cCB0aGUgbGluZ2VyaW5nIGxleGVyIHN0cnVjdHVyZXMgYXMgd2VsbDpcbiAgICAgICAgaWYgKGxleGVyLmNsZWFudXBBZnRlckxleCkge1xuICAgICAgICAgICAgbGV4ZXIuY2xlYW51cEFmdGVyTGV4KGRvX25vdF9udWtlX2Vycm9yaW5mb3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJldmVudCBsaW5nZXJpbmcgY2lyY3VsYXIgcmVmZXJlbmNlcyBmcm9tIGNhdXNpbmcgbWVtb3J5IGxlYWtzOlxuICAgICAgICBpZiAoc2hhcmVkU3RhdGVfeXkpIHtcbiAgICAgICAgICAgIHNoYXJlZFN0YXRlX3l5LmxleGVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgc2hhcmVkU3RhdGVfeXkucGFyc2VyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYgKGxleGVyLnl5ID09PSBzaGFyZWRTdGF0ZV95eSkge1xuICAgICAgICAgICAgICAgIGxleGVyLnl5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNoYXJlZFN0YXRlX3l5ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnBhcnNlRXJyb3IgPSB0aGlzLm9yaWdpbmFsUGFyc2VFcnJvcjtcbiAgICAgICAgdGhpcy5xdW90ZU5hbWUgPSB0aGlzLm9yaWdpbmFsUXVvdGVOYW1lO1xuXG4gICAgICAgIC8vIG51a2UgdGhlIHZzdGFja1tdIGFycmF5IGF0IGxlYXN0IGFzIHRoYXQgb25lIHdpbGwgc3RpbGwgcmVmZXJlbmNlIG9ic29sZXRlZCB1c2VyIHZhbHVlcy5cbiAgICAgICAgLy8gVG8gYmUgc2FmZSwgd2UgbnVrZSB0aGUgb3RoZXIgaW50ZXJuYWwgc3RhY2sgY29sdW1ucyBhcyB3ZWxsLi4uXG4gICAgICAgIHN0YWNrLmxlbmd0aCA9IDA7ICAgICAgICAgICAgICAgLy8gZmFzdGVzdCB3YXkgdG8gbnVrZSBhbiBhcnJheSB3aXRob3V0IG92ZXJseSBib3RoZXJpbmcgdGhlIEdDXG4gICAgICAgIHNzdGFjay5sZW5ndGggPSAwO1xuXG4gICAgICAgIHZzdGFjay5sZW5ndGggPSAwO1xuICAgICAgICBzcCA9IDA7XG5cbiAgICAgICAgLy8gbnVrZSB0aGUgZXJyb3IgaGFzaCBpbmZvIGluc3RhbmNlcyBjcmVhdGVkIGR1cmluZyB0aGlzIHJ1bi5cbiAgICAgICAgLy8gVXNlcmxhbmQgY29kZSBtdXN0IENPUFkgYW55IGRhdGEvcmVmZXJlbmNlc1xuICAgICAgICAvLyBpbiB0aGUgZXJyb3IgaGFzaCBpbnN0YW5jZShzKSBpdCBpcyBtb3JlIHBlcm1hbmVudGx5IGludGVyZXN0ZWQgaW4uXG4gICAgICAgIGlmICghZG9fbm90X251a2VfZXJyb3JpbmZvcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX19lcnJvcl9pbmZvcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IHRoaXMuX19lcnJvcl9pbmZvc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgdHlwZW9mIGVsLmRlc3Ryb3kgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX19lcnJvcl9pbmZvcy5sZW5ndGggPSAwO1xuXG5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHRWYWx1ZTtcbiAgICB9O1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbiAgICAvLyBOT1RFOiBhcyB0aGlzIEFQSSB1c2VzIHBhcnNlKCkgYXMgYSBjbG9zdXJlLCBpdCBNVVNUIGJlIHNldCBhZ2FpbiBvbiBldmVyeSBwYXJzZSgpIGludm9jYXRpb24sXG4gICAgLy8gICAgICAgb3IgZWxzZSB5b3VyIGBsZXhlcmAsIGBzaGFyZWRTdGF0ZWAsIGV0Yy4gcmVmZXJlbmNlcyB3aWxsIGJlICp3cm9uZyohXG4gICAgdGhpcy5jb25zdHJ1Y3RQYXJzZUVycm9ySW5mbyA9IGZ1bmN0aW9uIHBhcnNlcl9jb25zdHJ1Y3RQYXJzZUVycm9ySW5mbyhtc2csIGV4LCBleHBlY3RlZCwgcmVjb3ZlcmFibGUpIHtcbiAgICAgICAgdmFyIHBlaSA9IHtcbiAgICAgICAgICAgIGVyclN0cjogbXNnLFxuICAgICAgICAgICAgZXhjZXB0aW9uOiBleCxcbiAgICAgICAgICAgIHRleHQ6IGxleGVyLm1hdGNoLFxuICAgICAgICAgICAgdmFsdWU6IGxleGVyLnl5dGV4dCxcbiAgICAgICAgICAgIHRva2VuOiB0aGlzLmRlc2NyaWJlU3ltYm9sKHN5bWJvbCkgfHwgc3ltYm9sLFxuICAgICAgICAgICAgdG9rZW5faWQ6IHN5bWJvbCxcbiAgICAgICAgICAgIGxpbmU6IGxleGVyLnl5bGluZW5vLFxuXG4gICAgICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG4gICAgICAgICAgICByZWNvdmVyYWJsZTogcmVjb3ZlcmFibGUsXG4gICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgIG5ld19zdGF0ZTogbmV3U3RhdGUsXG4gICAgICAgICAgICBzeW1ib2xfc3RhY2s6IHN0YWNrLFxuICAgICAgICAgICAgc3RhdGVfc3RhY2s6IHNzdGFjayxcbiAgICAgICAgICAgIHZhbHVlX3N0YWNrOiB2c3RhY2ssXG5cbiAgICAgICAgICAgIHN0YWNrX3BvaW50ZXI6IHNwLFxuICAgICAgICAgICAgeXk6IHNoYXJlZFN0YXRlX3l5LFxuICAgICAgICAgICAgbGV4ZXI6IGxleGVyLFxuICAgICAgICAgICAgcGFyc2VyOiB0aGlzLFxuXG4gICAgICAgICAgICAvLyBhbmQgbWFrZSBzdXJlIHRoZSBlcnJvciBpbmZvIGRvZXNuJ3Qgc3RheSBkdWUgdG8gcG90ZW50aWFsXG4gICAgICAgICAgICAvLyByZWYgY3ljbGUgdmlhIHVzZXJsYW5kIGNvZGUgbWFuaXB1bGF0aW9ucy5cbiAgICAgICAgICAgIC8vIFRoZXNlIHdvdWxkIG90aGVyd2lzZSBhbGwgYmUgbWVtb3J5IGxlYWsgb3Bwb3J0dW5pdGllcyFcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyBOb3RlIHRoYXQgb25seSBhcnJheSBhbmQgb2JqZWN0IHJlZmVyZW5jZXMgYXJlIG51a2VkIGFzIHRob3NlXG4gICAgICAgICAgICAvLyBjb25zdGl0dXRlIHRoZSBzZXQgb2YgZWxlbWVudHMgd2hpY2ggY2FuIHByb2R1Y2UgYSBjeWNsaWMgcmVmLlxuICAgICAgICAgICAgLy8gVGhlIHJlc3Qgb2YgdGhlIG1lbWJlcnMgaXMga2VwdCBpbnRhY3QgYXMgdGhleSBhcmUgaGFybWxlc3MuXG4gICAgICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cnVjdFBhcnNlRXJyb3JJbmZvKCkge1xuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBjeWNsaWMgcmVmZXJlbmNlcyBhZGRlZCB0byBlcnJvciBpbmZvOlxuICAgICAgICAgICAgICAgIC8vIGluZm8ueXkgPSBudWxsO1xuICAgICAgICAgICAgICAgIC8vIGluZm8ubGV4ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIC8vIGluZm8udmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIC8vIGluZm8udmFsdWVfc3RhY2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIC8vIC4uLlxuICAgICAgICAgICAgICAgIHZhciByZWMgPSAhIXRoaXMucmVjb3ZlcmFibGU7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiB0eXBlb2Yga2V5ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVjb3ZlcmFibGUgPSByZWM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIHRyYWNrIHRoaXMgaW5zdGFuY2Ugc28gd2UgY2FuIGBkZXN0cm95KClgIGl0IG9uY2Ugd2UgZGVlbSBpdCBzdXBlcmZsdW91cyBhbmQgcmVhZHkgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiFcbiAgICAgICAgdGhpcy5fX2Vycm9yX2luZm9zLnB1c2gocGVpKTtcbiAgICAgICAgcmV0dXJuIHBlaTtcbiAgICB9O1xuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4gICAgZnVuY3Rpb24gZ2V0Tm9uVGVybWluYWxGcm9tQ29kZShzeW1ib2wpIHtcbiAgICAgICAgdmFyIHRva2VuTmFtZSA9IHNlbGYuZ2V0U3ltYm9sTmFtZShzeW1ib2wpO1xuICAgICAgICBpZiAoIXRva2VuTmFtZSkge1xuICAgICAgICAgICAgdG9rZW5OYW1lID0gc3ltYm9sO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0b2tlbk5hbWU7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBzdGRMZXgoKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IGxleGVyLmxleCgpO1xuICAgICAgICAvLyBpZiB0b2tlbiBpc24ndCBpdHMgbnVtZXJpYyB2YWx1ZSwgY29udmVydFxuICAgICAgICBpZiAodHlwZW9mIHRva2VuICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdG9rZW4gPSBzZWxmLnN5bWJvbHNfW3Rva2VuXSB8fCB0b2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0b2tlbiB8fCBFT0Y7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmFzdExleCgpIHtcbiAgICAgICAgdmFyIHRva2VuID0gbGV4ZXIuZmFzdExleCgpO1xuICAgICAgICAvLyBpZiB0b2tlbiBpc24ndCBpdHMgbnVtZXJpYyB2YWx1ZSwgY29udmVydFxuICAgICAgICBpZiAodHlwZW9mIHRva2VuICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdG9rZW4gPSBzZWxmLnN5bWJvbHNfW3Rva2VuXSB8fCB0b2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0b2tlbiB8fCBFT0Y7XG4gICAgfVxuXG4gICAgdmFyIGxleCA9IHN0ZExleDtcblxuXG4gICAgdmFyIHN0YXRlLCBhY3Rpb24sIHIsIHQ7XG4gICAgdmFyIHl5dmFsID0ge1xuICAgICAgICAkOiB0cnVlLFxuICAgICAgICBfJDogdW5kZWZpbmVkLFxuICAgICAgICB5eTogc2hhcmVkU3RhdGVfeXlcbiAgICB9O1xuICAgIHZhciBwO1xuICAgIHZhciB5eXJ1bGVsZW47XG4gICAgdmFyIHRoaXNfcHJvZHVjdGlvbjtcbiAgICB2YXIgbmV3U3RhdGU7XG4gICAgdmFyIHJldHZhbCA9IGZhbHNlO1xuXG5cbiAgICB0cnkge1xuICAgICAgICB0aGlzLl9fcmVlbnRyYW50X2NhbGxfZGVwdGgrKztcblxuICAgICAgICBsZXhlci5zZXRJbnB1dChpbnB1dCwgc2hhcmVkU3RhdGVfeXkpO1xuXG4gICAgICAgIC8vIE5PVEU6IHdlICphc3N1bWUqIG5vIGxleGVyIHByZS9wb3N0IGhhbmRsZXJzIGFyZSBzZXQgdXAgKmFmdGVyKiBcbiAgICAgICAgLy8gdGhpcyBpbml0aWFsIGBzZXRJbnB1dCgpYCBjYWxsOiBoZW5jZSB3ZSBjYW4gbm93IGNoZWNrIGFuZCBkZWNpZGVcbiAgICAgICAgLy8gd2hldGhlciB3ZSdsbCBnbyB3aXRoIHRoZSBzdGFuZGFyZCwgc2xvd2VyLCBsZXgoKSBBUEkgb3IgdGhlXG4gICAgICAgIC8vIGBmYXN0X2xleCgpYCBvbmU6XG4gICAgICAgIGlmICh0eXBlb2YgbGV4ZXIuY2FuSVVzZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdmFyIGxleGVySW5mbyA9IGxleGVyLmNhbklVc2UoKTtcbiAgICAgICAgICAgIGlmIChsZXhlckluZm8uZmFzdExleCAmJiB0eXBlb2YgZmFzdExleCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGxleCA9IGZhc3RMZXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gXG5cblxuXG4gICAgICAgIHZzdGFja1tzcF0gPSBudWxsO1xuICAgICAgICBzc3RhY2tbc3BdID0gMDtcbiAgICAgICAgc3RhY2tbc3BdID0gMDtcbiAgICAgICAgKytzcDtcblxuXG5cblxuXG4gICAgICAgIGlmICh0aGlzLnByZV9wYXJzZSkge1xuICAgICAgICAgICAgdGhpcy5wcmVfcGFyc2UuY2FsbCh0aGlzLCBzaGFyZWRTdGF0ZV95eSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNoYXJlZFN0YXRlX3l5LnByZV9wYXJzZSkge1xuICAgICAgICAgICAgc2hhcmVkU3RhdGVfeXkucHJlX3BhcnNlLmNhbGwodGhpcywgc2hhcmVkU3RhdGVfeXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgbmV3U3RhdGUgPSBzc3RhY2tbc3AgLSAxXTtcbiAgICAgICAgZm9yICg7Oykge1xuICAgICAgICAgICAgLy8gcmV0cmlldmUgc3RhdGUgbnVtYmVyIGZyb20gdG9wIG9mIHN0YWNrXG4gICAgICAgICAgICBzdGF0ZSA9IG5ld1N0YXRlOyAgICAgICAgICAgICAgIC8vIHNzdGFja1tzcCAtIDFdO1xuXG4gICAgICAgICAgICAvLyB1c2UgZGVmYXVsdCBhY3Rpb25zIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgaWYgKHRoaXMuZGVmYXVsdEFjdGlvbnNbc3RhdGVdKSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uID0gMjtcbiAgICAgICAgICAgICAgICBuZXdTdGF0ZSA9IHRoaXMuZGVmYXVsdEFjdGlvbnNbc3RhdGVdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgc2luZ2xlIGA9PWAgY29uZGl0aW9uIGJlbG93IGNvdmVycyBib3RoIHRoZXNlIGA9PT1gIGNvbXBhcmlzb25zIGluIGEgc2luZ2xlXG4gICAgICAgICAgICAgICAgLy8gb3BlcmF0aW9uOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gICAgIGlmIChzeW1ib2wgPT09IG51bGwgfHwgdHlwZW9mIHN5bWJvbCA9PT0gJ3VuZGVmaW5lZCcpIC4uLlxuICAgICAgICAgICAgICAgIGlmICghc3ltYm9sKSB7XG4gICAgICAgICAgICAgICAgICAgIHN5bWJvbCA9IGxleCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyByZWFkIGFjdGlvbiBmb3IgY3VycmVudCBzdGF0ZSBhbmQgZmlyc3QgaW5wdXRcbiAgICAgICAgICAgICAgICB0ID0gKHRhYmxlW3N0YXRlXSAmJiB0YWJsZVtzdGF0ZV1bc3ltYm9sXSkgfHwgTk9fQUNUSU9OO1xuICAgICAgICAgICAgICAgIG5ld1N0YXRlID0gdFsxXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24gPSB0WzBdO1xuXG5cblxuXG5cblxuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgcGFyc2UgZXJyb3JcbiAgICAgICAgICAgICAgICBpZiAoIWFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyU3RyO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyU3ltYm9sRGVzY3IgPSAodGhpcy5kZXNjcmliZVN5bWJvbChzeW1ib2wpIHx8IHN5bWJvbCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleHBlY3RlZCA9IHRoaXMuY29sbGVjdF9leHBlY3RlZF90b2tlbl9zZXQoc3RhdGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcG9ydCBlcnJvclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxleGVyLnl5bGluZW5vID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyU3RyID0gJ1BhcnNlIGVycm9yIG9uIGxpbmUgJyArIChsZXhlci55eWxpbmVubyArIDEpICsgJzogJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciA9ICdQYXJzZSBlcnJvcjogJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGxleGVyLnNob3dQb3NpdGlvbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyU3RyICs9ICdcXG4nICsgbGV4ZXIuc2hvd1Bvc2l0aW9uKDc5IC0gMTAsIDEwKSArICdcXG4nO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHBlY3RlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVyclN0ciArPSAnRXhwZWN0aW5nICcgKyBleHBlY3RlZC5qb2luKCcsICcpICsgJywgZ290IHVuZXhwZWN0ZWQgJyArIGVyclN5bWJvbERlc2NyO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyU3RyICs9ICdVbmV4cGVjdGVkICcgKyBlcnJTeW1ib2xEZXNjcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBjYW5ub3QgcmVjb3ZlciBmcm9tIHRoZSBlcnJvciFcbiAgICAgICAgICAgICAgICAgICAgcCA9IHRoaXMuY29uc3RydWN0UGFyc2VFcnJvckluZm8oZXJyU3RyLCBudWxsLCBleHBlY3RlZCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICByID0gdGhpcy5wYXJzZUVycm9yKHAuZXJyU3RyLCBwLCB0aGlzLkppc29uUGFyc2VyRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR2YWwgPSByO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9XG5cblxuXG5cblxuXG5cblxuXG5cbiAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBjYXRjaCBtaXNjLiBwYXJzZSBmYWlsdXJlczpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLy8gdGhpcyBzaG91bGRuJ3QgaGFwcGVuLCB1bmxlc3MgcmVzb2x2ZSBkZWZhdWx0cyBhcmUgb2ZmXG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIHAgPSB0aGlzLmNvbnN0cnVjdFBhcnNlRXJyb3JJbmZvKCdQYXJzZSBFcnJvcjogbXVsdGlwbGUgYWN0aW9ucyBwb3NzaWJsZSBhdCBzdGF0ZTogJyArIHN0YXRlICsgJywgdG9rZW46ICcgKyBzeW1ib2wsIG51bGwsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgciA9IHRoaXMucGFyc2VFcnJvcihwLmVyclN0ciwgcCwgdGhpcy5KaXNvblBhcnNlckVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dmFsID0gcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gQW5vdGhlciBjYXNlIG9mIGJldHRlciBzYWZlIHRoYW4gc29ycnk6IGluIGNhc2Ugc3RhdGUgdHJhbnNpdGlvbnMgY29tZSBvdXQgb2YgYW5vdGhlciBlcnJvciByZWNvdmVyeSBwcm9jZXNzXG4gICAgICAgICAgICAgICAgLy8gb3IgYSBidWdneSBMVVQgKExvb2tVcCBUYWJsZSk6XG4gICAgICAgICAgICAgICAgcCA9IHRoaXMuY29uc3RydWN0UGFyc2VFcnJvckluZm8oJ1BhcnNpbmcgaGFsdGVkLiBObyB2aWFibGUgZXJyb3IgcmVjb3ZlcnkgYXBwcm9hY2ggYXZhaWxhYmxlIGR1ZSB0byBpbnRlcm5hbCBzeXN0ZW0gZmFpbHVyZS4nLCBudWxsLCBudWxsLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgciA9IHRoaXMucGFyc2VFcnJvcihwLmVyclN0ciwgcCwgdGhpcy5KaXNvblBhcnNlckVycm9yKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHZhbCA9IHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBzaGlmdDpcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBzdGFja1tzcF0gPSBzeW1ib2w7XG4gICAgICAgICAgICAgICAgdnN0YWNrW3NwXSA9IGxleGVyLnl5dGV4dDtcblxuICAgICAgICAgICAgICAgIHNzdGFja1tzcF0gPSBuZXdTdGF0ZTsgLy8gcHVzaCBzdGF0ZVxuXG4gICAgICAgICAgICAgICAgKytzcDtcbiAgICAgICAgICAgICAgICBzeW1ib2wgPSAwO1xuXG5cblxuXG4gICAgICAgICAgICAgICAgLy8gUGljayB1cCB0aGUgbGV4ZXIgZGV0YWlscyBmb3IgdGhlIGN1cnJlbnQgc3ltYm9sIGFzIHRoYXQgb25lIGlzIG5vdCAnbG9vay1haGVhZCcgYW55IG1vcmU6XG5cblxuXG5cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgLy8gcmVkdWNlOlxuICAgICAgICAgICAgY2FzZSAyOlxuXG5cblxuICAgICAgICAgICAgICAgIHRoaXNfcHJvZHVjdGlvbiA9IHRoaXMucHJvZHVjdGlvbnNfW25ld1N0YXRlIC0gMV07ICAvLyBgdGhpcy5wcm9kdWN0aW9uc19bXWAgaXMgemVyby1iYXNlZCBpbmRleGVkIHdoaWxlIHN0YXRlcyBzdGFydCBmcm9tIDEgdXB3YXJkcy4uLlxuICAgICAgICAgICAgICAgIHl5cnVsZWxlbiA9IHRoaXNfcHJvZHVjdGlvblsxXTtcblxuXG5cblxuXG5cblxuXG5cblxuICAgICAgICAgICAgICAgIHIgPSB0aGlzLnBlcmZvcm1BY3Rpb24uY2FsbCh5eXZhbCwgbmV3U3RhdGUsIHNwIC0gMSwgdnN0YWNrKTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dmFsID0gcjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcG9wIG9mZiBzdGFja1xuICAgICAgICAgICAgICAgIHNwIC09IHl5cnVsZWxlbjtcblxuICAgICAgICAgICAgICAgIC8vIGRvbid0IG92ZXJ3cml0ZSB0aGUgYHN5bWJvbGAgdmFyaWFibGU6IHVzZSBhIGxvY2FsIHZhciB0byBzcGVlZCB0aGluZ3MgdXA6XG4gICAgICAgICAgICAgICAgdmFyIG50c3ltYm9sID0gdGhpc19wcm9kdWN0aW9uWzBdOyAgICAvLyBwdXNoIG5vbnRlcm1pbmFsIChyZWR1Y2UpXG4gICAgICAgICAgICAgICAgc3RhY2tbc3BdID0gbnRzeW1ib2w7XG4gICAgICAgICAgICAgICAgdnN0YWNrW3NwXSA9IHl5dmFsLiQ7XG5cbiAgICAgICAgICAgICAgICAvLyBnb3RvIG5ldyBzdGF0ZSA9IHRhYmxlW1NUQVRFXVtOT05URVJNSU5BTF1cbiAgICAgICAgICAgICAgICBuZXdTdGF0ZSA9IHRhYmxlW3NzdGFja1tzcCAtIDFdXVtudHN5bWJvbF07XG4gICAgICAgICAgICAgICAgc3N0YWNrW3NwXSA9IG5ld1N0YXRlO1xuICAgICAgICAgICAgICAgICsrc3A7XG5cblxuXG5cblxuXG5cblxuXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIC8vIGFjY2VwdDpcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBpZiAoc3AgIT09IC0yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHZhbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJldHVybiB0aGUgYCRhY2NlcHRgIHJ1bGUncyBgJCRgIHJlc3VsdCwgaWYgYXZhaWxhYmxlLlxuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyBBbHNvIG5vdGUgdGhhdCBKSVNPTiBhbHdheXMgYWRkcyB0aGlzIHRvcC1tb3N0IGAkYWNjZXB0YCBydWxlICh3aXRoIGltcGxpY2l0LFxuICAgICAgICAgICAgICAgICAgICAvLyBkZWZhdWx0LCBhY3Rpb24pOlxuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgJGFjY2VwdDogPHN0YXJ0U3ltYm9sPiAkZW5kXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgJXsgJCQgPSAkMTsgQCQgPSBAMTsgJX1cbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gd2hpY2gsIGNvbWJpbmVkIHdpdGggdGhlIHBhcnNlIGtlcm5lbCdzIGAkYWNjZXB0YCBzdGF0ZSBiZWhhdmlvdXIgY29kZWQgYmVsb3csXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpbGwgcHJvZHVjZSB0aGUgYCQkYCB2YWx1ZSBvdXRwdXQgb2YgdGhlIDxzdGFydFN5bWJvbD4gcnVsZSBhcyB0aGUgcGFyc2UgcmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAvLyBJRkYgdGhhdCByZXN1bHQgaXMgKm5vdCogYHVuZGVmaW5lZGAuIChTZWUgYWxzbyB0aGUgcGFyc2VyIGtlcm5lbCBjb2RlLilcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gY29kZTpcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAle1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICBAJCA9IEAxOyAgICAgICAgICAgIC8vIGlmIGxvY2F0aW9uIHRyYWNraW5nIHN1cHBvcnQgaXMgaW5jbHVkZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAkMSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJDE7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOyAgICAgICAgICAgLy8gdGhlIGRlZmF1bHQgcGFyc2UgcmVzdWx0IGlmIHRoZSBydWxlIGFjdGlvbnMgZG9uJ3QgcHJvZHVjZSBhbnl0aGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgICV9XG4gICAgICAgICAgICAgICAgICAgIHNwLS07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdnN0YWNrW3NwXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHZhbCA9IHZzdGFja1tzcF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJyZWFrIG91dCBvZiBsb29wOiB3ZSBhY2NlcHQgb3IgZmFpbCB3aXRoIGVycm9yXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgIC8vIHJlcG9ydCBleGNlcHRpb25zIHRocm91Z2ggdGhlIHBhcnNlRXJyb3IgY2FsbGJhY2sgdG9vLCBidXQga2VlcCB0aGUgZXhjZXB0aW9uIGludGFjdFxuICAgICAgICAvLyBpZiBpdCBpcyBhIGtub3duIHBhcnNlciBvciBsZXhlciBlcnJvciB3aGljaCBoYXMgYmVlbiB0aHJvd24gYnkgcGFyc2VFcnJvcigpIGFscmVhZHk6XG4gICAgICAgIGlmIChleCBpbnN0YW5jZW9mIHRoaXMuSmlzb25QYXJzZXJFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGV4ZXIgJiYgdHlwZW9mIGxleGVyLkppc29uTGV4ZXJFcnJvciA9PT0gJ2Z1bmN0aW9uJyAmJiBleCBpbnN0YW5jZW9mIGxleGVyLkppc29uTGV4ZXJFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXg7XG4gICAgICAgIH1cblxuICAgICAgICBwID0gdGhpcy5jb25zdHJ1Y3RQYXJzZUVycm9ySW5mbygnUGFyc2luZyBhYm9ydGVkIGR1ZSB0byBleGNlcHRpb24uJywgZXgsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgcmV0dmFsID0gZmFsc2U7XG4gICAgICAgIHIgPSB0aGlzLnBhcnNlRXJyb3IocC5lcnJTdHIsIHAsIHRoaXMuSmlzb25QYXJzZXJFcnJvcik7XG4gICAgICAgIGlmICh0eXBlb2YgciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHZhbCA9IHI7XG4gICAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgICByZXR2YWwgPSB0aGlzLmNsZWFudXBBZnRlclBhcnNlKHJldHZhbCwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX19yZWVudHJhbnRfY2FsbF9kZXB0aC0tO1xuICAgIH0gICAvLyAvZmluYWxseVxuXG4gICAgcmV0dXJuIHJldHZhbDtcbn1cbn07XG5wYXJzZXIub3JpZ2luYWxQYXJzZUVycm9yID0gcGFyc2VyLnBhcnNlRXJyb3I7XG5wYXJzZXIub3JpZ2luYWxRdW90ZU5hbWUgPSBwYXJzZXIucXVvdGVOYW1lO1xuLyogbGV4ZXIgZ2VuZXJhdGVkIGJ5IGppc29uLWxleCAwLjYuMS0yMTUgKi9cblxuLypcbiAqIFJldHVybnMgYSBMZXhlciBvYmplY3Qgb2YgdGhlIGZvbGxvd2luZyBzdHJ1Y3R1cmU6XG4gKlxuICogIExleGVyOiB7XG4gKiAgICB5eToge30gICAgIFRoZSBzby1jYWxsZWQgXCJzaGFyZWQgc3RhdGVcIiBvciByYXRoZXIgdGhlICpzb3VyY2UqIG9mIGl0O1xuICogICAgICAgICAgICAgICB0aGUgcmVhbCBcInNoYXJlZCBzdGF0ZVwiIGB5eWAgcGFzc2VkIGFyb3VuZCB0b1xuICogICAgICAgICAgICAgICB0aGUgcnVsZSBhY3Rpb25zLCBldGMuIGlzIGEgZGlyZWN0IHJlZmVyZW5jZSFcbiAqXG4gKiAgICAgICAgICAgICAgIFRoaXMgXCJzaGFyZWQgY29udGV4dFwiIG9iamVjdCB3YXMgcGFzc2VkIHRvIHRoZSBsZXhlciBieSB3YXkgb2YgXG4gKiAgICAgICAgICAgICAgIHRoZSBgbGV4ZXIuc2V0SW5wdXQoc3RyLCB5eSlgIEFQSSBiZWZvcmUgeW91IG1heSB1c2UgaXQuXG4gKlxuICogICAgICAgICAgICAgICBUaGlzIFwic2hhcmVkIGNvbnRleHRcIiBvYmplY3QgaXMgcGFzc2VkIHRvIHRoZSBsZXhlciBhY3Rpb24gY29kZSBpbiBgcGVyZm9ybUFjdGlvbigpYFxuICogICAgICAgICAgICAgICBzbyB1c2VybGFuZCBjb2RlIGluIHRoZSBsZXhlciBhY3Rpb25zIG1heSBjb21tdW5pY2F0ZSB3aXRoIHRoZSBvdXRzaWRlIHdvcmxkIFxuICogICAgICAgICAgICAgICBhbmQvb3Igb3RoZXIgbGV4ZXIgcnVsZXMnIGFjdGlvbnMgaW4gbW9yZSBvciBsZXNzIGNvbXBsZXggd2F5cy5cbiAqXG4gKiAgfVxuICpcbiAqICBMZXhlci5wcm90b3R5cGU6IHtcbiAqICAgIEVPRjogMSxcbiAqICAgIEVSUk9SOiAyLFxuICpcbiAqICAgIHl5OiAgICAgICAgVGhlIG92ZXJhbGwgXCJzaGFyZWQgY29udGV4dFwiIG9iamVjdCByZWZlcmVuY2UuXG4gKlxuICogICAgSmlzb25MZXhlckVycm9yOiBmdW5jdGlvbihtc2csIGhhc2gpLFxuICpcbiAqICAgIHBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uIGxleGVyX19wZXJmb3JtQWN0aW9uKHl5LCB5eXJ1bGVudW1iZXIsIFlZX1NUQVJUKSxcbiAqXG4gKiAgICAgICAgICAgICAgIFRoZSBmdW5jdGlvbiBwYXJhbWV0ZXJzIGFuZCBgdGhpc2AgaGF2ZSB0aGUgZm9sbG93aW5nIHZhbHVlL21lYW5pbmc6XG4gKiAgICAgICAgICAgICAgIC0gYHRoaXNgICAgIDogcmVmZXJlbmNlIHRvIHRoZSBgbGV4ZXJgIGluc3RhbmNlLiBcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGB5eV9gIGlzIGFuIGFsaWFzIGZvciBgdGhpc2AgbGV4ZXIgaW5zdGFuY2UgcmVmZXJlbmNlIHVzZWQgaW50ZXJuYWxseS5cbiAqXG4gKiAgICAgICAgICAgICAgIC0gYHl5YCAgICAgIDogYSByZWZlcmVuY2UgdG8gdGhlIGB5eWAgXCJzaGFyZWQgc3RhdGVcIiBvYmplY3Qgd2hpY2ggd2FzIHBhc3NlZCB0byB0aGUgbGV4ZXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBieSB3YXkgb2YgdGhlIGBsZXhlci5zZXRJbnB1dChzdHIsIHl5KWAgQVBJIGJlZm9yZS5cbiAqXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTm90ZTpcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGUgZXh0cmEgYXJndW1lbnRzIHlvdSBzcGVjaWZpZWQgaW4gdGhlIGAlcGFyc2UtcGFyYW1gIHN0YXRlbWVudCBpbiB5b3VyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKipwYXJzZXIqKiBncmFtbWFyIGRlZmluaXRpb24gZmlsZSBhcmUgcGFzc2VkIHRvIHRoZSBsZXhlciB2aWEgdGhpcyBvYmplY3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2UgYXMgbWVtYmVyIHZhcmlhYmxlcy5cbiAqXG4gKiAgICAgICAgICAgICAgIC0gYHl5cnVsZW51bWJlcmAgICA6IGluZGV4IG9mIHRoZSBtYXRjaGVkIGxleGVyIHJ1bGUgKHJlZ2V4KSwgdXNlZCBpbnRlcm5hbGx5LlxuICpcbiAqICAgICAgICAgICAgICAgLSBgWVlfU1RBUlRgOiB0aGUgY3VycmVudCBsZXhlciBcInN0YXJ0IGNvbmRpdGlvblwiIHN0YXRlLlxuICpcbiAqICAgIHBhcnNlRXJyb3I6IGZ1bmN0aW9uKHN0ciwgaGFzaCwgRXhjZXB0aW9uQ2xhc3MpLFxuICpcbiAqICAgIGNvbnN0cnVjdExleEVycm9ySW5mbzogZnVuY3Rpb24oZXJyb3JfbWVzc2FnZSwgaXNfcmVjb3ZlcmFibGUpLFxuICogICAgICAgICAgICAgICBIZWxwZXIgZnVuY3Rpb24uXG4gKiAgICAgICAgICAgICAgIFByb2R1Y2VzIGEgbmV3IGVycm9ySW5mbyAnaGFzaCBvYmplY3QnIHdoaWNoIGNhbiBiZSBwYXNzZWQgaW50byBgcGFyc2VFcnJvcigpYC5cbiAqICAgICAgICAgICAgICAgU2VlIGl0J3MgdXNlIGluIHRoaXMgbGV4ZXIga2VybmVsIGluIG1hbnkgcGxhY2VzOyBleGFtcGxlIHVzYWdlOlxuICpcbiAqICAgICAgICAgICAgICAgICAgIHZhciBpbmZvT2JqID0gbGV4ZXIuY29uc3RydWN0UGFyc2VFcnJvckluZm8oJ2ZhaWwhJywgdHJ1ZSk7XG4gKiAgICAgICAgICAgICAgICAgICB2YXIgcmV0VmFsID0gbGV4ZXIucGFyc2VFcnJvcihpbmZvT2JqLmVyclN0ciwgaW5mb09iaiwgbGV4ZXIuSmlzb25MZXhlckVycm9yKTtcbiAqXG4gKiAgICBvcHRpb25zOiB7IC4uLiBsZXhlciAlb3B0aW9ucyAuLi4gfSxcbiAqXG4gKiAgICBsZXg6IGZ1bmN0aW9uKCksXG4gKiAgICAgICAgICAgICAgIFByb2R1Y2Ugb25lIHRva2VuIG9mIGxleGVkIGlucHV0LCB3aGljaCB3YXMgcGFzc2VkIGluIGVhcmxpZXIgdmlhIHRoZSBgbGV4ZXIuc2V0SW5wdXQoKWAgQVBJLlxuICogICAgICAgICAgICAgICBZb3UgTUFZIHVzZSB0aGUgYWRkaXRpb25hbCBgYXJncy4uLmAgcGFyYW1ldGVycyBhcyBwZXIgYCVwYXJzZS1wYXJhbWAgc3BlYyBvZiB0aGUgKipsZXhlcioqIGdyYW1tYXI6XG4gKiAgICAgICAgICAgICAgIHRoZXNlIGV4dHJhIGBhcmdzLi4uYCBhcmUgYWRkZWQgdmVyYmF0aW0gdG8gdGhlIGB5eWAgb2JqZWN0IHJlZmVyZW5jZSBhcyBtZW1iZXIgdmFyaWFibGVzLlxuICpcbiAqICAgICAgICAgICAgICAgV0FSTklORzpcbiAqICAgICAgICAgICAgICAgTGV4ZXIncyBhZGRpdGlvbmFsIGBhcmdzLi4uYCBwYXJhbWV0ZXJzICh2aWEgbGV4ZXIncyBgJXBhcnNlLXBhcmFtYCkgTUFZIGNvbmZsaWN0IHdpdGhcbiAqICAgICAgICAgICAgICAgYW55IGF0dHJpYnV0ZXMgYWxyZWFkeSBhZGRlZCB0byBgeXlgIGJ5IHRoZSAqKnBhcnNlcioqIG9yIHRoZSBqaXNvbiBydW4tdGltZTsgXG4gKiAgICAgICAgICAgICAgIHdoZW4gc3VjaCBhIGNvbGxpc2lvbiBpcyBkZXRlY3RlZCBhbiBleGNlcHRpb24gaXMgdGhyb3duIHRvIHByZXZlbnQgdGhlIGdlbmVyYXRlZCBydW4tdGltZSBcbiAqICAgICAgICAgICAgICAgZnJvbSBzaWxlbnRseSBhY2NlcHRpbmcgdGhpcyBjb25mdXNpbmcgYW5kIHBvdGVudGlhbGx5IGhhemFyZG91cyBzaXR1YXRpb24hIFxuICpcbiAqICAgIGNsZWFudXBBZnRlckxleDogZnVuY3Rpb24oZG9fbm90X251a2VfZXJyb3JpbmZvcyksXG4gKiAgICAgICAgICAgICAgIEhlbHBlciBmdW5jdGlvbi5cbiAqXG4gKiAgICAgICAgICAgICAgIFRoaXMgaGVscGVyIEFQSSBpcyBpbnZva2VkIHdoZW4gdGhlICoqcGFyc2UgcHJvY2VzcyoqIGhhcyBjb21wbGV0ZWQ6IGl0IGlzIHRoZSByZXNwb25zaWJpbGl0eVxuICogICAgICAgICAgICAgICBvZiB0aGUgKipwYXJzZXIqKiAob3IgdGhlIGNhbGxpbmcgdXNlcmxhbmQgY29kZSkgdG8gaW52b2tlIHRoaXMgbWV0aG9kIG9uY2UgY2xlYW51cCBpcyBkZXNpcmVkLiBcbiAqXG4gKiAgICAgICAgICAgICAgIFRoaXMgaGVscGVyIG1heSBiZSBpbnZva2VkIGJ5IHVzZXIgY29kZSB0byBlbnN1cmUgdGhlIGludGVybmFsIGxleGVyIGdldHMgcHJvcGVybHkgZ2FyYmFnZSBjb2xsZWN0ZWQuXG4gKlxuICogICAgc2V0SW5wdXQ6IGZ1bmN0aW9uKGlucHV0LCBbeXldKSxcbiAqXG4gKlxuICogICAgaW5wdXQ6IGZ1bmN0aW9uKCksXG4gKlxuICpcbiAqICAgIHVucHV0OiBmdW5jdGlvbihzdHIpLFxuICpcbiAqXG4gKiAgICBtb3JlOiBmdW5jdGlvbigpLFxuICpcbiAqXG4gKiAgICByZWplY3Q6IGZ1bmN0aW9uKCksXG4gKlxuICpcbiAqICAgIGxlc3M6IGZ1bmN0aW9uKG4pLFxuICpcbiAqXG4gKiAgICBwYXN0SW5wdXQ6IGZ1bmN0aW9uKG4pLFxuICpcbiAqXG4gKiAgICB1cGNvbWluZ0lucHV0OiBmdW5jdGlvbihuKSxcbiAqXG4gKlxuICogICAgc2hvd1Bvc2l0aW9uOiBmdW5jdGlvbigpLFxuICpcbiAqXG4gKiAgICB0ZXN0X21hdGNoOiBmdW5jdGlvbihyZWdleF9tYXRjaF9hcnJheSwgcnVsZV9pbmRleCksXG4gKlxuICpcbiAqICAgIG5leHQ6IGZ1bmN0aW9uKCksXG4gKlxuICpcbiAqICAgIGJlZ2luOiBmdW5jdGlvbihjb25kaXRpb24pLFxuICpcbiAqXG4gKiAgICBwdXNoU3RhdGU6IGZ1bmN0aW9uKGNvbmRpdGlvbiksXG4gKlxuICpcbiAqICAgIHBvcFN0YXRlOiBmdW5jdGlvbigpLFxuICpcbiAqXG4gKiAgICB0b3BTdGF0ZTogZnVuY3Rpb24oKSxcbiAqXG4gKlxuICogICAgX2N1cnJlbnRSdWxlczogZnVuY3Rpb24oKSxcbiAqXG4gKlxuICogICAgc3RhdGVTdGFja1NpemU6IGZ1bmN0aW9uKCksXG4gKlxuICpcbiAqICAgIHBlcmZvcm1BY3Rpb246IGZ1bmN0aW9uKHl5LCB5eV8sIHl5cnVsZW51bWJlciwgWVlfU1RBUlQpLFxuICpcbiAqXG4gKiAgICBydWxlczogWy4uLl0sXG4gKlxuICpcbiAqICAgIGNvbmRpdGlvbnM6IHthc3NvY2lhdGl2ZSBsaXN0OiBuYW1lID09PiBzZXR9LFxuICogIH1cbiAqXG4gKlxuICogIHRva2VuIGxvY2F0aW9uIGluZm8gKGB5eWxsb2NgKToge1xuICogICAgZmlyc3RfbGluZTogbixcbiAqICAgIGxhc3RfbGluZTogbixcbiAqICAgIGZpcnN0X2NvbHVtbjogbixcbiAqICAgIGxhc3RfY29sdW1uOiBuLFxuICogICAgcmFuZ2U6IFtzdGFydF9udW1iZXIsIGVuZF9udW1iZXJdXG4gKiAgICAgICAgICAgICAgICh3aGVyZSB0aGUgbnVtYmVycyBhcmUgaW5kZXhlcyBpbnRvIHRoZSBpbnB1dCBzdHJpbmcsIHplcm8tYmFzZWQpXG4gKiAgfVxuICpcbiAqIC0tLVxuICpcbiAqIFRoZSBgcGFyc2VFcnJvcmAgZnVuY3Rpb24gcmVjZWl2ZXMgYSAnaGFzaCcgb2JqZWN0IHdpdGggdGhlc2UgbWVtYmVycyBmb3IgbGV4ZXIgZXJyb3JzOlxuICpcbiAqICB7XG4gKiAgICB0ZXh0OiAgICAgICAgKG1hdGNoZWQgdGV4dClcbiAqICAgIHRva2VuOiAgICAgICAodGhlIHByb2R1Y2VkIHRlcm1pbmFsIHRva2VuLCBpZiBhbnkpXG4gKiAgICB0b2tlbl9pZDogICAgKHRoZSBwcm9kdWNlZCB0ZXJtaW5hbCB0b2tlbiBudW1lcmljIElELCBpZiBhbnkpXG4gKiAgICBsaW5lOiAgICAgICAgKHl5bGluZW5vKVxuICogICAgbG9jOiAgICAgICAgICh5eWxsb2MpXG4gKiAgICByZWNvdmVyYWJsZTogKGJvb2xlYW46IFRSVUUgd2hlbiB0aGUgcGFyc2VyIE1BWSBoYXZlIGFuIGVycm9yIHJlY292ZXJ5IHJ1bGVcbiAqICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlIGZvciB0aGlzIHBhcnRpY3VsYXIgZXJyb3IpXG4gKiAgICB5eTogICAgICAgICAgKG9iamVjdDogdGhlIGN1cnJlbnQgcGFyc2VyIGludGVybmFsIFwic2hhcmVkIHN0YXRlXCIgYHl5YFxuICogICAgICAgICAgICAgICAgICBhcyBpcyBhbHNvIGF2YWlsYWJsZSBpbiB0aGUgcnVsZSBhY3Rpb25zOyB0aGlzIGNhbiBiZSB1c2VkLFxuICogICAgICAgICAgICAgICAgICBmb3IgaW5zdGFuY2UsIGZvciBhZHZhbmNlZCBlcnJvciBhbmFseXNpcyBhbmQgcmVwb3J0aW5nKVxuICogICAgbGV4ZXI6ICAgICAgIChyZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgbGV4ZXIgaW5zdGFuY2UgdXNlZCBieSB0aGUgcGFyc2VyKVxuICogIH1cbiAqXG4gKiB3aGlsZSBgdGhpc2Agd2lsbCByZWZlcmVuY2UgdGhlIGN1cnJlbnQgbGV4ZXIgaW5zdGFuY2UuXG4gKlxuICogV2hlbiBgcGFyc2VFcnJvcmAgaXMgaW52b2tlZCBieSB0aGUgbGV4ZXIsIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIHdpbGxcbiAqIGF0dGVtcHQgdG8gaW52b2tlIGB5eS5wYXJzZXIucGFyc2VFcnJvcigpYDsgd2hlbiB0aGlzIGNhbGxiYWNrIGlzIG5vdCBwcm92aWRlZFxuICogaXQgd2lsbCB0cnkgdG8gaW52b2tlIGB5eS5wYXJzZUVycm9yKClgIGluc3RlYWQuIFdoZW4gdGhhdCBjYWxsYmFjayBpcyBhbHNvIG5vdFxuICogcHJvdmlkZWQsIGEgYEppc29uTGV4ZXJFcnJvcmAgZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duIGNvbnRhaW5pbmcgdGhlIGVycm9yXG4gKiBtZXNzYWdlIGFuZCBgaGFzaGAsIGFzIGNvbnN0cnVjdGVkIGJ5IHRoZSBgY29uc3RydWN0TGV4RXJyb3JJbmZvKClgIEFQSS5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIGxleGVyJ3MgYEppc29uTGV4ZXJFcnJvcmAgZXJyb3IgY2xhc3MgaXMgcGFzc2VkIHZpYSB0aGVcbiAqIGBFeGNlcHRpb25DbGFzc2AgYXJndW1lbnQsIHdoaWNoIGlzIGludm9rZWQgdG8gY29uc3RydWN0IHRoZSBleGNlcHRpb25cbiAqIGluc3RhbmNlIHRvIGJlIHRocm93biwgc28gdGVjaG5pY2FsbHkgYHBhcnNlRXJyb3JgIHdpbGwgdGhyb3cgdGhlIG9iamVjdFxuICogcHJvZHVjZWQgYnkgdGhlIGBuZXcgRXhjZXB0aW9uQ2xhc3Moc3RyLCBoYXNoKWAgSmF2YVNjcmlwdCBleHByZXNzaW9uLlxuICpcbiAqIC0tLVxuICpcbiAqIFlvdSBjYW4gc3BlY2lmeSBsZXhlciBvcHRpb25zIGJ5IHNldHRpbmcgLyBtb2RpZnlpbmcgdGhlIGAub3B0aW9uc2Agb2JqZWN0IG9mIHlvdXIgTGV4ZXIgaW5zdGFuY2UuXG4gKiBUaGVzZSBvcHRpb25zIGFyZSBhdmFpbGFibGU6XG4gKlxuICogKE9wdGlvbnMgYXJlIHBlcm1hbmVudC4pXG4gKiAgXG4gKiAgeXk6IHtcbiAqICAgICAgcGFyc2VFcnJvcjogZnVuY3Rpb24oc3RyLCBoYXNoLCBFeGNlcHRpb25DbGFzcylcbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogb3ZlcnJpZGVzIHRoZSBkZWZhdWx0IGBwYXJzZUVycm9yYCBmdW5jdGlvbi5cbiAqICB9XG4gKlxuICogIGxleGVyLm9wdGlvbnM6IHtcbiAqICAgICAgcHJlX2xleDogIGZ1bmN0aW9uKClcbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogaXMgaW52b2tlZCBiZWZvcmUgdGhlIGxleGVyIGlzIGludm9rZWQgdG8gcHJvZHVjZSBhbm90aGVyIHRva2VuLlxuICogICAgICAgICAgICAgICAgIGB0aGlzYCByZWZlcnMgdG8gdGhlIExleGVyIG9iamVjdC5cbiAqICAgICAgcG9zdF9sZXg6IGZ1bmN0aW9uKHRva2VuKSB7IHJldHVybiB0b2tlbjsgfVxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBpcyBpbnZva2VkIHdoZW4gdGhlIGxleGVyIGhhcyBwcm9kdWNlZCBhIHRva2VuIGB0b2tlbmA7XG4gKiAgICAgICAgICAgICAgICAgdGhpcyBmdW5jdGlvbiBjYW4gb3ZlcnJpZGUgdGhlIHJldHVybmVkIHRva2VuIHZhbHVlIGJ5IHJldHVybmluZyBhbm90aGVyLlxuICogICAgICAgICAgICAgICAgIFdoZW4gaXQgZG9lcyBub3QgcmV0dXJuIGFueSAodHJ1dGh5KSB2YWx1ZSwgdGhlIGxleGVyIHdpbGwgcmV0dXJuXG4gKiAgICAgICAgICAgICAgICAgdGhlIG9yaWdpbmFsIGB0b2tlbmAuXG4gKiAgICAgICAgICAgICAgICAgYHRoaXNgIHJlZmVycyB0byB0aGUgTGV4ZXIgb2JqZWN0LlxuICpcbiAqIFdBUk5JTkc6IHRoZSBuZXh0IHNldCBvZiBvcHRpb25zIGFyZSBub3QgbWVhbnQgdG8gYmUgY2hhbmdlZC4gVGhleSBlY2hvIHRoZSBhYmlsaXRpZXMgb2ZcbiAqIHRoZSBsZXhlciBhcyBwZXIgd2hlbiBpdCB3YXMgY29tcGlsZWQhXG4gKlxuICogICAgICByYW5nZXM6IGJvb2xlYW5cbiAqICAgICAgICAgICAgICAgICBvcHRpb25hbDogYHRydWVgID09PiB0b2tlbiBsb2NhdGlvbiBpbmZvIHdpbGwgaW5jbHVkZSBhIC5yYW5nZVtdIG1lbWJlci5cbiAqICAgICAgZmxleDogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGZsZXgtbGlrZSBsZXhpbmcgYmVoYXZpb3VyIHdoZXJlIHRoZSBydWxlcyBhcmUgdGVzdGVkXG4gKiAgICAgICAgICAgICAgICAgZXhoYXVzdGl2ZWx5IHRvIGZpbmQgdGhlIGxvbmdlc3QgbWF0Y2guXG4gKiAgICAgIGJhY2t0cmFja19sZXhlcjogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGxleGVyIHJlZ2V4ZXMgYXJlIHRlc3RlZCBpbiBvcmRlciBhbmQgZm9yIGludm9rZWQ7XG4gKiAgICAgICAgICAgICAgICAgdGhlIGxleGVyIHRlcm1pbmF0ZXMgdGhlIHNjYW4gd2hlbiBhIHRva2VuIGlzIHJldHVybmVkIGJ5IHRoZSBhY3Rpb24gY29kZS5cbiAqICAgICAgeHJlZ2V4cDogYm9vbGVhblxuICogICAgICAgICAgICAgICAgIG9wdGlvbmFsOiBgdHJ1ZWAgPT0+IGxleGVyIHJ1bGUgcmVnZXhlcyBhcmUgXCJleHRlbmRlZCByZWdleCBmb3JtYXRcIiByZXF1aXJpbmcgdGhlXG4gKiAgICAgICAgICAgICAgICAgYFhSZWdFeHBgIGxpYnJhcnkuIFdoZW4gdGhpcyAlb3B0aW9uIGhhcyBub3QgYmVlbiBzcGVjaWZpZWQgYXQgY29tcGlsZSB0aW1lLCBhbGwgbGV4ZXJcbiAqICAgICAgICAgICAgICAgICBydWxlIHJlZ2V4ZXMgaGF2ZSBiZWVuIHdyaXR0ZW4gYXMgc3RhbmRhcmQgSmF2YVNjcmlwdCBSZWdFeHAgZXhwcmVzc2lvbnMuXG4gKiAgfVxuICovXG5cblxudmFyIGxleGVyID0gZnVuY3Rpb24oKSB7XG4gIC8qKlxuICAgKiBTZWUgYWxzbzpcbiAgICogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMzgyMTA3L3doYXRzLWEtZ29vZC13YXktdG8tZXh0ZW5kLWVycm9yLWluLWphdmFzY3JpcHQvIzM1ODgxNTA4XG4gICAqIGJ1dCB3ZSBrZWVwIHRoZSBwcm90b3R5cGUuY29uc3RydWN0b3IgYW5kIHByb3RvdHlwZS5uYW1lIGFzc2lnbm1lbnQgbGluZXMgdG9vIGZvciBjb21wYXRpYmlsaXR5XG4gICAqIHdpdGggdXNlcmxhbmQgY29kZSB3aGljaCBtaWdodCBhY2Nlc3MgdGhlIGRlcml2ZWQgY2xhc3MgaW4gYSAnY2xhc3NpYycgd2F5LlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAbm9jb2xsYXBzZVxuICAgKi9cbiAgZnVuY3Rpb24gSmlzb25MZXhlckVycm9yKG1zZywgaGFzaCkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgdmFsdWU6ICdKaXNvbkxleGVyRXJyb3InXG4gICAgfSk7XG5cbiAgICBpZiAobXNnID09IG51bGwpXG4gICAgICBtc2cgPSAnPz8/JztcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbWVzc2FnZScsIHtcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogbXNnXG4gICAgfSk7XG5cbiAgICB0aGlzLmhhc2ggPSBoYXNoO1xuICAgIHZhciBzdGFja3RyYWNlO1xuXG4gICAgaWYgKGhhc2ggJiYgaGFzaC5leGNlcHRpb24gaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgdmFyIGV4MiA9IGhhc2guZXhjZXB0aW9uO1xuICAgICAgdGhpcy5tZXNzYWdlID0gZXgyLm1lc3NhZ2UgfHwgbXNnO1xuICAgICAgc3RhY2t0cmFjZSA9IGV4Mi5zdGFjaztcbiAgICB9XG5cbiAgICBpZiAoIXN0YWNrdHJhY2UpIHtcbiAgICAgIGlmIChFcnJvci5oYXNPd25Qcm9wZXJ0eSgnY2FwdHVyZVN0YWNrVHJhY2UnKSkge1xuICAgICAgICAvLyBWOFxuICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YWNrdHJhY2UgPSBuZXcgRXJyb3IobXNnKS5zdGFjaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3RhY2t0cmFjZSkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGFjaycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IHN0YWNrdHJhY2VcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGlmICh0eXBlb2YgT2JqZWN0LnNldFByb3RvdHlwZU9mID09PSAnZnVuY3Rpb24nKSB7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKEppc29uTGV4ZXJFcnJvci5wcm90b3R5cGUsIEVycm9yLnByb3RvdHlwZSk7XG4gIH0gZWxzZSB7XG4gICAgSmlzb25MZXhlckVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgfVxuXG4gIEppc29uTGV4ZXJFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBKaXNvbkxleGVyRXJyb3I7XG4gIEppc29uTGV4ZXJFcnJvci5wcm90b3R5cGUubmFtZSA9ICdKaXNvbkxleGVyRXJyb3InO1xuXG4gIHZhciBsZXhlciA9IHtcbiAgICBcbi8vIENvZGUgR2VuZXJhdG9yIEluZm9ybWF0aW9uIFJlcG9ydFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gT3B0aW9uczpcbi8vXG4vLyAgIGJhY2t0cmFja2luZzogLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2Vcbi8vICAgbG9jYXRpb24ucmFuZ2VzOiAuLi4uLi4uLi4uLi4uLi4uLiBmYWxzZVxuLy8gICBsb2NhdGlvbiBsaW5lK2NvbHVtbiB0cmFja2luZzogLi4uIHRydWVcbi8vXG4vL1xuLy8gRm9yd2FyZGVkIFBhcnNlciBBbmFseXNpcyBmbGFnczpcbi8vXG4vLyAgIHVzZXMgeXlsZW5nOiAuLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2Vcbi8vICAgdXNlcyB5eWxpbmVubzogLi4uLi4uLi4uLi4uLi4uLi4uLiBmYWxzZVxuLy8gICB1c2VzIHl5dGV4dDogLi4uLi4uLi4uLi4uLi4uLi4uLi4uIGZhbHNlXG4vLyAgIHVzZXMgeXlsbG9jOiAuLi4uLi4uLi4uLi4uLi4uLi4uLi4gZmFsc2Vcbi8vICAgdXNlcyBsZXhlciB2YWx1ZXM6IC4uLi4uLi4uLi4uLi4uLiB0cnVlIC8gdHJ1ZVxuLy8gICBsb2NhdGlvbiB0cmFja2luZzogLi4uLi4uLi4uLi4uLi4uIGZhbHNlXG4vLyAgIGxvY2F0aW9uIGFzc2lnbm1lbnQ6IC4uLi4uLi4uLi4uLi4gZmFsc2Vcbi8vXG4vL1xuLy8gTGV4ZXIgQW5hbHlzaXMgZmxhZ3M6XG4vL1xuLy8gICB1c2VzIHl5bGVuZzogLi4uLi4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHl5bGluZW5vOiAuLi4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHl5dGV4dDogLi4uLi4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHl5bGxvYzogLi4uLi4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIFBhcnNlRXJyb3IgQVBJOiAuLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHl5ZXJyb3I6IC4uLi4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIGxvY2F0aW9uIHRyYWNraW5nICYgZWRpdGluZzogID8/P1xuLy8gICB1c2VzIG1vcmUoKSBBUEk6IC4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHVucHV0KCkgQVBJOiAuLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIHJlamVjdCgpIEFQSTogLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIGxlc3MoKSBBUEk6IC4uLi4uLi4uLi4uLi4uLi4uID8/P1xuLy8gICB1c2VzIGRpc3BsYXkgQVBJcyBwYXN0SW5wdXQoKSwgdXBjb21pbmdJbnB1dCgpLCBzaG93UG9zaXRpb24oKTpcbi8vICAgICAgICAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLiA/Pz9cbi8vICAgdXNlcyBkZXNjcmliZVlZTExPQygpIEFQSTogLi4uLi4uLiA/Pz9cbi8vXG4vLyAtLS0tLS0tLS0gRU5EIE9GIFJFUE9SVCAtLS0tLS0tLS0tLVxuXG5FT0Y6IDEsXG4gICAgRVJST1I6IDIsXG5cbiAgICAvLyBKaXNvbkxleGVyRXJyb3I6IEppc29uTGV4ZXJFcnJvciwgICAgICAgIC8vLyA8LS0gaW5qZWN0ZWQgYnkgdGhlIGNvZGUgZ2VuZXJhdG9yXG5cbiAgICAvLyBvcHRpb25zOiB7fSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyA8LS0gaW5qZWN0ZWQgYnkgdGhlIGNvZGUgZ2VuZXJhdG9yXG5cbiAgICAvLyB5eTogLi4uLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyA8LS0gaW5qZWN0ZWQgYnkgc2V0SW5wdXQoKVxuXG4gICAgX19jdXJyZW50UnVsZVNldF9fOiBudWxsLCAgICAgICAgICAgICAgICAgICAvLy8gSU5URVJOQUwgVVNFIE9OTFk6IGludGVybmFsIHJ1bGUgc2V0IGNhY2hlIGZvciB0aGUgY3VycmVudCBsZXhlciBzdGF0ZSAgXG5cbiAgICBfX2Vycm9yX2luZm9zOiBbXSwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyBJTlRFUk5BTCBVU0UgT05MWTogdGhlIHNldCBvZiBsZXhFcnJvckluZm8gb2JqZWN0cyBjcmVhdGVkIHNpbmNlIHRoZSBsYXN0IGNsZWFudXAgIFxuICAgIF9fZGVjb21wcmVzc2VkOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgLy8vIElOVEVSTkFMIFVTRSBPTkxZOiBtYXJrIHdoZXRoZXIgdGhlIGxleGVyIGluc3RhbmNlIGhhcyBiZWVuICd1bmZvbGRlZCcgY29tcGxldGVseSBhbmQgaXMgbm93IHJlYWR5IGZvciB1c2UgIFxuICAgIGRvbmU6IGZhbHNlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vIElOVEVSTkFMIFVTRSBPTkxZICBcbiAgICBfYmFja3RyYWNrOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyBJTlRFUk5BTCBVU0UgT05MWSAgXG4gICAgX2lucHV0OiAnJywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gSU5URVJOQUwgVVNFIE9OTFkgIFxuICAgIF9tb3JlOiBmYWxzZSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vIElOVEVSTkFMIFVTRSBPTkxZICBcbiAgICBfc2lnbmFsZWRfZXJyb3JfdG9rZW46IGZhbHNlLCAgICAgICAgICAgICAgIC8vLyBJTlRFUk5BTCBVU0UgT05MWSAgXG4gICAgY29uZGl0aW9uU3RhY2s6IFtdLCAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gSU5URVJOQUwgVVNFIE9OTFk7IG1hbmFnZWQgdmlhIGBwdXNoU3RhdGUoKWAsIGBwb3BTdGF0ZSgpYCwgYHRvcFN0YXRlKClgIGFuZCBgc3RhdGVTdGFja1NpemUoKWAgIFxuICAgIG1hdGNoOiAnJywgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vIFJFQUQtT05MWSBFWFRFUk5BTCBBQ0NFU1MgLSBBRFZBTkNFRCBVU0UgT05MWTogdHJhY2tzIGlucHV0IHdoaWNoIGhhcyBiZWVuIG1hdGNoZWQgc28gZmFyIGZvciB0aGUgbGV4ZXIgdG9rZW4gdW5kZXIgY29uc3RydWN0aW9uLiBgbWF0Y2hgIGlzIGlkZW50aWNhbCB0byBgeXl0ZXh0YCBleGNlcHQgdGhhdCB0aGlzIG9uZSBzdGlsbCBjb250YWlucyB0aGUgbWF0Y2hlZCBpbnB1dCBzdHJpbmcgYWZ0ZXIgYGxleGVyLnBlcmZvcm1BY3Rpb24oKWAgaGFzIGJlZW4gaW52b2tlZCwgd2hlcmUgdXNlcmxhbmQgY29kZSBNQVkgaGF2ZSBjaGFuZ2VkL3JlcGxhY2VkIHRoZSBgeXl0ZXh0YCB2YWx1ZSBlbnRpcmVseSEgIFxuICAgIG1hdGNoZWQ6ICcnLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vIFJFQUQtT05MWSBFWFRFUk5BTCBBQ0NFU1MgLSBBRFZBTkNFRCBVU0UgT05MWTogdHJhY2tzIGVudGlyZSBpbnB1dCB3aGljaCBoYXMgYmVlbiBtYXRjaGVkIHNvIGZhciAgXG4gICAgbWF0Y2hlczogZmFsc2UsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gUkVBRC1PTkxZIEVYVEVSTkFMIEFDQ0VTUyAtIEFEVkFOQ0VEIFVTRSBPTkxZOiB0cmFja3MgUkUgbWF0Y2ggcmVzdWx0IGZvciBsYXN0IChzdWNjZXNzZnVsKSBtYXRjaCBhdHRlbXB0ICBcbiAgICB5eXRleHQ6ICcnLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyBBRFZBTkNFRCBVU0UgT05MWTogdHJhY2tzIGlucHV0IHdoaWNoIGhhcyBiZWVuIG1hdGNoZWQgc28gZmFyIGZvciB0aGUgbGV4ZXIgdG9rZW4gdW5kZXIgY29uc3RydWN0aW9uOyB0aGlzIHZhbHVlIGlzIHRyYW5zZmVycmVkIHRvIHRoZSBwYXJzZXIgYXMgdGhlICd0b2tlbiB2YWx1ZScgd2hlbiB0aGUgcGFyc2VyIGNvbnN1bWVzIHRoZSBsZXhlciB0b2tlbiBwcm9kdWNlZCB0aHJvdWdoIGEgY2FsbCB0byB0aGUgYGxleCgpYCBBUEkuICBcbiAgICBvZmZzZXQ6IDAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vLyBSRUFELU9OTFkgRVhURVJOQUwgQUNDRVNTIC0gQURWQU5DRUQgVVNFIE9OTFk6IHRyYWNrcyB0aGUgJ2N1cnNvciBwb3NpdGlvbicgaW4gdGhlIGlucHV0IHN0cmluZywgaS5lLiB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgbWF0Y2hlZCBzbyBmYXIgIFxuICAgIHl5bGVuZzogMCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vIFJFQUQtT05MWSBFWFRFUk5BTCBBQ0NFU1MgLSBBRFZBTkNFRCBVU0UgT05MWTogbGVuZ3RoIG9mIG1hdGNoZWQgaW5wdXQgZm9yIHRoZSB0b2tlbiB1bmRlciBjb25zdHJ1Y3Rpb24gKGB5eXRleHRgKSAgXG4gICAgeXlsaW5lbm86IDAsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gUkVBRC1PTkxZIEVYVEVSTkFMIEFDQ0VTUyAtIEFEVkFOQ0VEIFVTRSBPTkxZOiAnbGluZSBudW1iZXInIGF0IHdoaWNoIHRoZSB0b2tlbiB1bmRlciBjb25zdHJ1Y3Rpb24gaXMgbG9jYXRlZCAgXG4gICAgeXlsbG9jOiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy8gUkVBRC1PTkxZIEVYVEVSTkFMIEFDQ0VTUyAtIEFEVkFOQ0VEIFVTRSBPTkxZOiB0cmFja3MgbG9jYXRpb24gaW5mbyAobGluZXMgKyBjb2x1bW5zKSBmb3IgdGhlIHRva2VuIHVuZGVyIGNvbnN0cnVjdGlvbiAgXG5cbiAgICAvKipcbiAgICAgKiBJTlRFUk5BTCBVU0U6IGNvbnN0cnVjdCBhIHN1aXRhYmxlIGVycm9yIGluZm8gaGFzaCBvYmplY3QgaW5zdGFuY2UgZm9yIGBwYXJzZUVycm9yYC5cbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGNvbnN0cnVjdExleEVycm9ySW5mbzogZnVuY3Rpb24gbGV4ZXJfY29uc3RydWN0TGV4RXJyb3JJbmZvKG1zZywgcmVjb3ZlcmFibGUsIHNob3dfaW5wdXRfcG9zaXRpb24pIHtcbiAgICAgIG1zZyA9ICcnICsgbXNnO1xuXG4gICAgICAvLyBoZXVyaXN0aWMgdG8gZGV0ZXJtaW5lIGlmIHRoZSBlcnJvciBtZXNzYWdlIGFscmVhZHkgY29udGFpbnMgYSAocGFydGlhbCkgc291cmNlIGNvZGUgZHVtcFxuICAgICAgLy8gYXMgcHJvZHVjZWQgYnkgZWl0aGVyIGBzaG93UG9zaXRpb24oKWAgb3IgYHByZXR0eVByaW50UmFuZ2UoKWA6XG4gICAgICBpZiAoc2hvd19pbnB1dF9wb3NpdGlvbiA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgc2hvd19pbnB1dF9wb3NpdGlvbiA9ICEobXNnLmluZGV4T2YoJ1xcbicpID4gMCAmJiBtc2cuaW5kZXhPZignXicpID4gMCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnl5bGxvYyAmJiBzaG93X2lucHV0X3Bvc2l0aW9uKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5wcmV0dHlQcmludFJhbmdlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdmFyIHByZXR0eV9zcmMgPSB0aGlzLnByZXR0eVByaW50UmFuZ2UodGhpcy55eWxsb2MpO1xuXG4gICAgICAgICAgaWYgKCEvXFxuXFxzKiQvLnRlc3QobXNnKSkge1xuICAgICAgICAgICAgbXNnICs9ICdcXG4nO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG1zZyArPSAnXFxuICBFcnJvbmVvdXMgYXJlYTpcXG4nICsgdGhpcy5wcmV0dHlQcmludFJhbmdlKHRoaXMueXlsbG9jKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5zaG93UG9zaXRpb24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB2YXIgcG9zX3N0ciA9IHRoaXMuc2hvd1Bvc2l0aW9uKCk7XG5cbiAgICAgICAgICBpZiAocG9zX3N0cikge1xuICAgICAgICAgICAgaWYgKG1zZy5sZW5ndGggJiYgbXNnW21zZy5sZW5ndGggLSAxXSAhPT0gJ1xcbicgJiYgcG9zX3N0clswXSAhPT0gJ1xcbicpIHtcbiAgICAgICAgICAgICAgbXNnICs9ICdcXG4nICsgcG9zX3N0cjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1zZyArPSBwb3Nfc3RyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvKiogQGNvbnN0cnVjdG9yICovXG4gICAgICB2YXIgcGVpID0ge1xuICAgICAgICBlcnJTdHI6IG1zZyxcbiAgICAgICAgcmVjb3ZlcmFibGU6ICEhcmVjb3ZlcmFibGUsXG4gICAgICAgIHRleHQ6IHRoaXMubWF0Y2gsICAgICAgICAgICAvLyBUaGlzIG9uZSBNQVkgYmUgZW1wdHk7IHVzZXJsYW5kIGNvZGUgc2hvdWxkIHVzZSB0aGUgYHVwY29taW5nSW5wdXRgIEFQSSB0byBvYnRhaW4gbW9yZSB0ZXh0IHdoaWNoIGZvbGxvd3MgdGhlICdsZXhlciBjdXJzb3IgcG9zaXRpb24nLi4uICBcbiAgICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgIGxpbmU6IHRoaXMueXlsaW5lbm8sXG4gICAgICAgIGxvYzogdGhpcy55eWxsb2MsXG4gICAgICAgIHl5OiB0aGlzLnl5LFxuICAgICAgICBsZXhlcjogdGhpcyxcblxuICAgICAgICAvKipcbiAgICAgICAgICogYW5kIG1ha2Ugc3VyZSB0aGUgZXJyb3IgaW5mbyBkb2Vzbid0IHN0YXkgZHVlIHRvIHBvdGVudGlhbFxuICAgICAgICAgKiByZWYgY3ljbGUgdmlhIHVzZXJsYW5kIGNvZGUgbWFuaXB1bGF0aW9ucy5cbiAgICAgICAgICogVGhlc2Ugd291bGQgb3RoZXJ3aXNlIGFsbCBiZSBtZW1vcnkgbGVhayBvcHBvcnR1bml0aWVzIVxuICAgICAgICAgKiBcbiAgICAgICAgICogTm90ZSB0aGF0IG9ubHkgYXJyYXkgYW5kIG9iamVjdCByZWZlcmVuY2VzIGFyZSBudWtlZCBhcyB0aG9zZVxuICAgICAgICAgKiBjb25zdGl0dXRlIHRoZSBzZXQgb2YgZWxlbWVudHMgd2hpY2ggY2FuIHByb2R1Y2UgYSBjeWNsaWMgcmVmLlxuICAgICAgICAgKiBUaGUgcmVzdCBvZiB0aGUgbWVtYmVycyBpcyBrZXB0IGludGFjdCBhcyB0aGV5IGFyZSBoYXJtbGVzcy5cbiAgICAgICAgICogXG4gICAgICAgICAqIEBwdWJsaWNcbiAgICAgICAgICogQHRoaXMge0xleEVycm9ySW5mb31cbiAgICAgICAgICovXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3RydWN0TGV4RXJyb3JJbmZvKCkge1xuICAgICAgICAgIC8vIHJlbW92ZSBjeWNsaWMgcmVmZXJlbmNlcyBhZGRlZCB0byBlcnJvciBpbmZvOlxuICAgICAgICAgIC8vIGluZm8ueXkgPSBudWxsO1xuICAgICAgICAgIC8vIGluZm8ubGV4ZXIgPSBudWxsO1xuICAgICAgICAgIC8vIC4uLlxuICAgICAgICAgIHZhciByZWMgPSAhIXRoaXMucmVjb3ZlcmFibGU7XG5cbiAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiB0eXBlb2Yga2V5ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICB0aGlzW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5yZWNvdmVyYWJsZSA9IHJlYztcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gdHJhY2sgdGhpcyBpbnN0YW5jZSBzbyB3ZSBjYW4gYGRlc3Ryb3koKWAgaXQgb25jZSB3ZSBkZWVtIGl0IHN1cGVyZmx1b3VzIGFuZCByZWFkeSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIVxuICAgICAgdGhpcy5fX2Vycm9yX2luZm9zLnB1c2gocGVpKTtcblxuICAgICAgcmV0dXJuIHBlaTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogaGFuZGxlciB3aGljaCBpcyBpbnZva2VkIHdoZW4gYSBsZXhlciBlcnJvciBvY2N1cnMuXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBwYXJzZUVycm9yOiBmdW5jdGlvbiBsZXhlcl9wYXJzZUVycm9yKHN0ciwgaGFzaCwgRXhjZXB0aW9uQ2xhc3MpIHtcbiAgICAgIGlmICghRXhjZXB0aW9uQ2xhc3MpIHtcbiAgICAgICAgRXhjZXB0aW9uQ2xhc3MgPSB0aGlzLkppc29uTGV4ZXJFcnJvcjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMueXkpIHtcbiAgICAgICAgaWYgKHRoaXMueXkucGFyc2VyICYmIHR5cGVvZiB0aGlzLnl5LnBhcnNlci5wYXJzZUVycm9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMueXkucGFyc2VyLnBhcnNlRXJyb3IuY2FsbCh0aGlzLCBzdHIsIGhhc2gsIEV4Y2VwdGlvbkNsYXNzKSB8fCB0aGlzLkVSUk9SO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0aGlzLnl5LnBhcnNlRXJyb3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy55eS5wYXJzZUVycm9yLmNhbGwodGhpcywgc3RyLCBoYXNoLCBFeGNlcHRpb25DbGFzcykgfHwgdGhpcy5FUlJPUjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uQ2xhc3Moc3RyLCBoYXNoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogbWV0aG9kIHdoaWNoIGltcGxlbWVudHMgYHl5ZXJyb3Ioc3RyLCAuLi5hcmdzKWAgZnVuY3Rpb25hbGl0eSBmb3IgdXNlIGluc2lkZSBsZXhlciBhY3Rpb25zLlxuICAgICAqIFxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAdGhpcyB7UmVnRXhwTGV4ZXJ9XG4gICAgICovXG4gICAgeXllcnJvcjogZnVuY3Rpb24geXlFcnJvcihzdHIgLyosIC4uLmFyZ3MgKi8pIHtcbiAgICAgIHZhciBsaW5lbm9fbXNnID0gJyc7XG5cbiAgICAgIGlmICh0aGlzLnl5bGxvYykge1xuICAgICAgICBsaW5lbm9fbXNnID0gJyBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcCA9IHRoaXMuY29uc3RydWN0TGV4RXJyb3JJbmZvKFxuICAgICAgICAnTGV4aWNhbCBlcnJvcicgKyBsaW5lbm9fbXNnICsgJzogJyArIHN0cixcbiAgICAgICAgdGhpcy5vcHRpb25zLmxleGVyRXJyb3JzQXJlUmVjb3ZlcmFibGVcbiAgICAgICk7XG5cbiAgICAgIC8vIEFkZCBhbnkgZXh0cmEgYXJncyB0byB0aGUgaGFzaCB1bmRlciB0aGUgbmFtZSBgZXh0cmFfZXJyb3JfYXR0cmlidXRlc2A6XG4gICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgICAgIGlmIChhcmdzLmxlbmd0aCkge1xuICAgICAgICBwLmV4dHJhX2Vycm9yX2F0dHJpYnV0ZXMgPSBhcmdzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUVycm9yKHAuZXJyU3RyLCBwLCB0aGlzLkppc29uTGV4ZXJFcnJvcikgfHwgdGhpcy5FUlJPUjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZmluYWwgY2xlYW51cCBmdW5jdGlvbiBmb3Igd2hlbiB3ZSBoYXZlIGNvbXBsZXRlZCBsZXhpbmcgdGhlIGlucHV0O1xuICAgICAqIG1ha2UgaXQgYW4gQVBJIHNvIHRoYXQgZXh0ZXJuYWwgY29kZSBjYW4gdXNlIHRoaXMgb25lIG9uY2UgdXNlcmxhbmRcbiAgICAgKiBjb2RlIGhhcyBkZWNpZGVkIGl0J3MgdGltZSB0byBkZXN0cm95IGFueSBsaW5nZXJpbmcgbGV4ZXIgZXJyb3JcbiAgICAgKiBoYXNoIG9iamVjdCBpbnN0YW5jZXMgYW5kIHRoZSBsaWtlOiB0aGlzIGZ1bmN0aW9uIGhlbHBzIHRvIGNsZWFuXG4gICAgICogdXAgdGhlc2UgY29uc3RydWN0cywgd2hpY2ggKm1heSogY2FycnkgY3ljbGljIHJlZmVyZW5jZXMgd2hpY2ggd291bGRcbiAgICAgKiBvdGhlcndpc2UgcHJldmVudCB0aGUgaW5zdGFuY2VzIGZyb20gYmVpbmcgcHJvcGVybHkgYW5kIHRpbWVseVxuICAgICAqIGdhcmJhZ2UtY29sbGVjdGVkLCBpLmUuIHRoaXMgZnVuY3Rpb24gaGVscHMgcHJldmVudCBtZW1vcnkgbGVha3MhXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBjbGVhbnVwQWZ0ZXJMZXg6IGZ1bmN0aW9uIGxleGVyX2NsZWFudXBBZnRlckxleChkb19ub3RfbnVrZV9lcnJvcmluZm9zKSB7XG4gICAgICAvLyBwcmV2ZW50IGxpbmdlcmluZyBjaXJjdWxhciByZWZlcmVuY2VzIGZyb20gY2F1c2luZyBtZW1vcnkgbGVha3M6XG4gICAgICB0aGlzLnNldElucHV0KCcnLCB7fSk7XG5cbiAgICAgIC8vIG51a2UgdGhlIGVycm9yIGhhc2ggaW5mbyBpbnN0YW5jZXMgY3JlYXRlZCBkdXJpbmcgdGhpcyBydW4uXG4gICAgICAvLyBVc2VybGFuZCBjb2RlIG11c3QgQ09QWSBhbnkgZGF0YS9yZWZlcmVuY2VzXG4gICAgICAvLyBpbiB0aGUgZXJyb3IgaGFzaCBpbnN0YW5jZShzKSBpdCBpcyBtb3JlIHBlcm1hbmVudGx5IGludGVyZXN0ZWQgaW4uXG4gICAgICBpZiAoIWRvX25vdF9udWtlX2Vycm9yaW5mb3MpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX19lcnJvcl9pbmZvcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgIHZhciBlbCA9IHRoaXMuX19lcnJvcl9pbmZvc1tpXTtcblxuICAgICAgICAgIGlmIChlbCAmJiB0eXBlb2YgZWwuZGVzdHJveSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgZWwuZGVzdHJveSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX19lcnJvcl9pbmZvcy5sZW5ndGggPSAwO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogY2xlYXIgdGhlIGxleGVyIHRva2VuIGNvbnRleHQ7IGludGVuZGVkIGZvciBpbnRlcm5hbCB1c2Ugb25seVxuICAgICAqIFxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAdGhpcyB7UmVnRXhwTGV4ZXJ9XG4gICAgICovXG4gICAgY2xlYXI6IGZ1bmN0aW9uIGxleGVyX2NsZWFyKCkge1xuICAgICAgdGhpcy55eXRleHQgPSAnJztcbiAgICAgIHRoaXMueXlsZW5nID0gMDtcbiAgICAgIHRoaXMubWF0Y2ggPSAnJztcblxuICAgICAgLy8gLSBETyBOT1QgcmVzZXQgYHRoaXMubWF0Y2hlZGBcbiAgICAgIHRoaXMubWF0Y2hlcyA9IGZhbHNlO1xuXG4gICAgICB0aGlzLl9tb3JlID0gZmFsc2U7XG4gICAgICB0aGlzLl9iYWNrdHJhY2sgPSBmYWxzZTtcbiAgICAgIHZhciBjb2wgPSAodGhpcy55eWxsb2MgPyB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiA6IDApO1xuXG4gICAgICB0aGlzLnl5bGxvYyA9IHtcbiAgICAgICAgZmlyc3RfbGluZTogdGhpcy55eWxpbmVubyArIDEsXG4gICAgICAgIGZpcnN0X2NvbHVtbjogY29sLFxuICAgICAgICBsYXN0X2xpbmU6IHRoaXMueXlsaW5lbm8gKyAxLFxuICAgICAgICBsYXN0X2NvbHVtbjogY29sLFxuICAgICAgICByYW5nZTogW3RoaXMub2Zmc2V0LCB0aGlzLm9mZnNldF1cbiAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJlc2V0cyB0aGUgbGV4ZXIsIHNldHMgbmV3IGlucHV0XG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBzZXRJbnB1dDogZnVuY3Rpb24gbGV4ZXJfc2V0SW5wdXQoaW5wdXQsIHl5KSB7XG4gICAgICB0aGlzLnl5ID0geXkgfHwgdGhpcy55eSB8fCB7fTtcblxuICAgICAgLy8gYWxzbyBjaGVjayBpZiB3ZSd2ZSBmdWxseSBpbml0aWFsaXplZCB0aGUgbGV4ZXIgaW5zdGFuY2UsXG4gICAgICAvLyBpbmNsdWRpbmcgZXhwYW5zaW9uIHdvcmsgdG8gYmUgZG9uZSB0byBnbyBmcm9tIGEgbG9hZGVkXG4gICAgICAvLyBsZXhlciB0byBhIHVzYWJsZSBsZXhlcjpcbiAgICAgIGlmICghdGhpcy5fX2RlY29tcHJlc3NlZCkge1xuICAgICAgICAvLyBzdGVwIDE6IGRlY29tcHJlc3MgdGhlIHJlZ2V4IGxpc3Q6XG4gICAgICAgIHZhciBydWxlcyA9IHRoaXMucnVsZXM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJ1bGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgdmFyIHJ1bGVfcmUgPSBydWxlc1tpXTtcblxuICAgICAgICAgIC8vIGNvbXByZXNzaW9uOiBpcyB0aGUgUkUgYW4geHJlZiB0byBhbm90aGVyIFJFIHNsb3QgaW4gdGhlIHJ1bGVzW10gdGFibGU/XG4gICAgICAgICAgaWYgKHR5cGVvZiBydWxlX3JlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgcnVsZXNbaV0gPSBydWxlc1tydWxlX3JlXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzdGVwIDI6IHVuZm9sZCB0aGUgY29uZGl0aW9uc1tdIHNldCB0byBtYWtlIHRoZXNlIHJlYWR5IGZvciB1c2U6XG4gICAgICAgIHZhciBjb25kaXRpb25zID0gdGhpcy5jb25kaXRpb25zO1xuXG4gICAgICAgIGZvciAodmFyIGsgaW4gY29uZGl0aW9ucykge1xuICAgICAgICAgIHZhciBzcGVjID0gY29uZGl0aW9uc1trXTtcbiAgICAgICAgICB2YXIgcnVsZV9pZHMgPSBzcGVjLnJ1bGVzO1xuICAgICAgICAgIHZhciBsZW4gPSBydWxlX2lkcy5sZW5ndGg7XG4gICAgICAgICAgdmFyIHJ1bGVfcmVnZXhlcyA9IG5ldyBBcnJheShsZW4gKyAxKTsgICAgICAgICAgICAgLy8gc2xvdCAwIGlzIHVudXNlZDsgd2UgdXNlIGEgMS1iYXNlZCBpbmRleCBhcHByb2FjaCBoZXJlIHRvIGtlZXAgdGhlIGhvdHRlc3QgY29kZSBpbiBgbGV4ZXJfbmV4dCgpYCBmYXN0IGFuZCBzaW1wbGUhIFxuICAgICAgICAgIHZhciBydWxlX25ld19pZHMgPSBuZXcgQXJyYXkobGVuICsgMSk7XG5cbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaWR4ID0gcnVsZV9pZHNbaV07XG4gICAgICAgICAgICB2YXIgcnVsZV9yZSA9IHJ1bGVzW2lkeF07XG4gICAgICAgICAgICBydWxlX3JlZ2V4ZXNbaSArIDFdID0gcnVsZV9yZTtcbiAgICAgICAgICAgIHJ1bGVfbmV3X2lkc1tpICsgMV0gPSBpZHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc3BlYy5ydWxlcyA9IHJ1bGVfbmV3X2lkcztcbiAgICAgICAgICBzcGVjLl9fcnVsZV9yZWdleGVzID0gcnVsZV9yZWdleGVzO1xuICAgICAgICAgIHNwZWMuX19ydWxlX2NvdW50ID0gbGVuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fX2RlY29tcHJlc3NlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2lucHV0ID0gaW5wdXQgfHwgJyc7XG4gICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICB0aGlzLl9zaWduYWxlZF9lcnJvcl90b2tlbiA9IGZhbHNlO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgICB0aGlzLnl5bGluZW5vID0gMDtcbiAgICAgIHRoaXMubWF0Y2hlZCA9ICcnO1xuICAgICAgdGhpcy5jb25kaXRpb25TdGFjayA9IFsnSU5JVElBTCddO1xuICAgICAgdGhpcy5fX2N1cnJlbnRSdWxlU2V0X18gPSBudWxsO1xuXG4gICAgICB0aGlzLnl5bGxvYyA9IHtcbiAgICAgICAgZmlyc3RfbGluZTogMSxcbiAgICAgICAgZmlyc3RfY29sdW1uOiAwLFxuICAgICAgICBsYXN0X2xpbmU6IDEsXG4gICAgICAgIGxhc3RfY29sdW1uOiAwLFxuICAgICAgICByYW5nZTogWzAsIDBdXG4gICAgICB9O1xuXG4gICAgICB0aGlzLm9mZnNldCA9IDA7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogZWRpdCB0aGUgcmVtYWluaW5nIGlucHV0IHZpYSB1c2VyLXNwZWNpZmllZCBjYWxsYmFjay5cbiAgICAgKiBUaGlzIGNhbiBiZSB1c2VkIHRvIGZvcndhcmQtYWRqdXN0IHRoZSBpbnB1dC10by1wYXJzZSwgXG4gICAgICogZS5nLiBpbnNlcnRpbmcgbWFjcm8gZXhwYW5zaW9ucyBhbmQgYWxpa2UgaW4gdGhlXG4gICAgICogaW5wdXQgd2hpY2ggaGFzIHlldCB0byBiZSBsZXhlZC5cbiAgICAgKiBUaGUgYmVoYXZpb3VyIG9mIHRoaXMgQVBJIGNvbnRyYXN0cyB0aGUgYHVucHV0KClgIGV0IGFsXG4gICAgICogQVBJcyBhcyB0aG9zZSBhY3Qgb24gdGhlICpjb25zdW1lZCogaW5wdXQsIHdoaWxlIHRoaXNcbiAgICAgKiBvbmUgYWxsb3dzIG9uZSB0byBtYW5pcHVsYXRlIHRoZSBmdXR1cmUsIHdpdGhvdXQgaW1wYWN0aW5nXG4gICAgICogdGhlIGN1cnJlbnQgYHl5bG9jYCBjdXJzb3IgbG9jYXRpb24gb3IgYW55IGhpc3RvcnkuIFxuICAgICAqIFxuICAgICAqIFVzZSB0aGlzIEFQSSB0byBoZWxwIGltcGxlbWVudCBDLXByZXByb2Nlc3Nvci1saWtlXG4gICAgICogYCNpbmNsdWRlYCBzdGF0ZW1lbnRzLCBldGMuXG4gICAgICogXG4gICAgICogVGhlIHByb3ZpZGVkIGNhbGxiYWNrIG11c3QgYmUgc3luY2hyb25vdXMgYW5kIGlzXG4gICAgICogZXhwZWN0ZWQgdG8gcmV0dXJuIHRoZSBlZGl0ZWQgaW5wdXQgKHN0cmluZykuXG4gICAgICpcbiAgICAgKiBUaGUgYGNwc0FyZ2AgYXJndW1lbnQgdmFsdWUgaXMgcGFzc2VkIHRvIHRoZSBjYWxsYmFja1xuICAgICAqIGFzLWlzLlxuICAgICAqXG4gICAgICogYGNhbGxiYWNrYCBpbnRlcmZhY2U6IFxuICAgICAqIGBmdW5jdGlvbiBjYWxsYmFjayhpbnB1dCwgY3BzQXJnKWBcbiAgICAgKiBcbiAgICAgKiAtIGBpbnB1dGAgd2lsbCBjYXJyeSB0aGUgcmVtYWluaW5nLWlucHV0LXRvLWxleCBzdHJpbmdcbiAgICAgKiAgIGZyb20gdGhlIGxleGVyLlxuICAgICAqIC0gYGNwc0FyZ2AgaXMgYGNwc0FyZ2AgcGFzc2VkIGludG8gdGhpcyBBUEkuXG4gICAgICogXG4gICAgICogVGhlIGB0aGlzYCByZWZlcmVuY2UgZm9yIHRoZSBjYWxsYmFjayB3aWxsIGJlIHNldCB0b1xuICAgICAqIHJlZmVyZW5jZSB0aGlzIGxleGVyIGluc3RhbmNlIHNvIHRoYXQgdXNlcmxhbmQgY29kZVxuICAgICAqIGluIHRoZSBjYWxsYmFjayBjYW4gZWFzaWx5IGFuZCBxdWlja2x5IGFjY2VzcyBhbnkgbGV4ZXJcbiAgICAgKiBBUEkuIFxuICAgICAqXG4gICAgICogV2hlbiB0aGUgY2FsbGJhY2sgcmV0dXJucyBhIG5vbi1zdHJpbmctdHlwZSBmYWxzZXkgdmFsdWUsXG4gICAgICogd2UgYXNzdW1lIHRoZSBjYWxsYmFjayBkaWQgbm90IGVkaXQgdGhlIGlucHV0IGFuZCB3ZVxuICAgICAqIHdpbGwgdXNpbmcgdGhlIGlucHV0IGFzLWlzLlxuICAgICAqXG4gICAgICogV2hlbiB0aGUgY2FsbGJhY2sgcmV0dXJucyBhIG5vbi1zdHJpbmctdHlwZSB2YWx1ZSwgaXRcbiAgICAgKiBpcyBjb252ZXJ0ZWQgdG8gYSBzdHJpbmcgZm9yIGxleGluZyB2aWEgdGhlIGBcIlwiICsgcmV0dmFsYFxuICAgICAqIG9wZXJhdGlvbi4gKFNlZSBhbHNvIHdoeTogaHR0cDovLzJhbGl0eS5jb20vMjAxMi8wMy9jb252ZXJ0aW5nLXRvLXN0cmluZy5odG1sIFxuICAgICAqIC0tIHRoYXQgd2F5IGFueSByZXR1cm5lZCBvYmplY3QncyBgdG9WYWx1ZSgpYCBhbmQgYHRvU3RyaW5nKClgXG4gICAgICogbWV0aG9kcyB3aWxsIGJlIGludm9rZWQgaW4gYSBwcm9wZXIvZGVzaXJhYmxlIG9yZGVyLilcbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGVkaXRSZW1haW5pbmdJbnB1dDogZnVuY3Rpb24gbGV4ZXJfZWRpdFJlbWFpbmluZ0lucHV0KGNhbGxiYWNrLCBjcHNBcmcpIHtcbiAgICAgIHZhciBydiA9IGNhbGxiYWNrLmNhbGwodGhpcywgdGhpcy5faW5wdXQsIGNwc0FyZyk7XG5cbiAgICAgIGlmICh0eXBlb2YgcnYgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGlmIChydikge1xuICAgICAgICAgIHRoaXMuX2lucHV0ID0gJycgKyBydjtcbiAgICAgICAgfSBcbiAgICAgICAgLy8gZWxzZToga2VlcCBgdGhpcy5faW5wdXRgIGFzIGlzLiAgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9pbnB1dCA9IHJ2O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogY29uc3VtZXMgYW5kIHJldHVybnMgb25lIGNoYXIgZnJvbSB0aGUgaW5wdXRcbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGlucHV0OiBmdW5jdGlvbiBsZXhlcl9pbnB1dCgpIHtcbiAgICAgIGlmICghdGhpcy5faW5wdXQpIHtcbiAgICAgICAgLy90aGlzLmRvbmUgPSB0cnVlOyAgICAtLSBkb24ndCBzZXQgYGRvbmVgIGFzIHdlIHdhbnQgdGhlIGxleCgpL25leHQoKSBBUEkgdG8gYmUgYWJsZSB0byBwcm9kdWNlIG9uZSBjdXN0b20gRU9GIHRva2VuIG1hdGNoIGFmdGVyIHRoaXMgYW55aG93LiAobGV4ZXIgY2FuIG1hdGNoIHNwZWNpYWwgPDxFT0Y+PiB0b2tlbnMgYW5kIHBlcmZvcm0gdXNlciBhY3Rpb24gY29kZSBmb3IgYSA8PEVPRj4+IG1hdGNoLCBidXQgb25seSBkb2VzIHNvICpvbmNlKilcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciBjaCA9IHRoaXMuX2lucHV0WzBdO1xuICAgICAgdGhpcy55eXRleHQgKz0gY2g7XG4gICAgICB0aGlzLnl5bGVuZysrO1xuICAgICAgdGhpcy5vZmZzZXQrKztcbiAgICAgIHRoaXMubWF0Y2ggKz0gY2g7XG4gICAgICB0aGlzLm1hdGNoZWQgKz0gY2g7XG5cbiAgICAgIC8vIENvdW50IHRoZSBsaW5lbnVtYmVyIHVwIHdoZW4gd2UgaGl0IHRoZSBMRiAob3IgYSBzdGFuZC1hbG9uZSBDUikuXG4gICAgICAvLyBPbiBDUkxGLCB0aGUgbGluZW51bWJlciBpcyBpbmNyZW1lbnRlZCB3aGVuIHlvdSBmZXRjaCB0aGUgQ1Igb3IgdGhlIENSTEYgY29tYm9cbiAgICAgIC8vIGFuZCB3ZSBhZHZhbmNlIGltbWVkaWF0ZWx5IHBhc3QgdGhlIExGIGFzIHdlbGwsIHJldHVybmluZyBib3RoIHRvZ2V0aGVyIGFzIGlmXG4gICAgICAvLyBpdCB3YXMgYWxsIGEgc2luZ2xlICdjaGFyYWN0ZXInIG9ubHkuXG4gICAgICB2YXIgc2xpY2VfbGVuID0gMTtcblxuICAgICAgdmFyIGxpbmVzID0gZmFsc2U7XG5cbiAgICAgIGlmIChjaCA9PT0gJ1xcbicpIHtcbiAgICAgICAgbGluZXMgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChjaCA9PT0gJ1xccicpIHtcbiAgICAgICAgbGluZXMgPSB0cnVlO1xuICAgICAgICB2YXIgY2gyID0gdGhpcy5faW5wdXRbMV07XG5cbiAgICAgICAgaWYgKGNoMiA9PT0gJ1xcbicpIHtcbiAgICAgICAgICBzbGljZV9sZW4rKztcbiAgICAgICAgICBjaCArPSBjaDI7XG4gICAgICAgICAgdGhpcy55eXRleHQgKz0gY2gyO1xuICAgICAgICAgIHRoaXMueXlsZW5nKys7XG4gICAgICAgICAgdGhpcy5vZmZzZXQrKztcbiAgICAgICAgICB0aGlzLm1hdGNoICs9IGNoMjtcbiAgICAgICAgICB0aGlzLm1hdGNoZWQgKz0gY2gyO1xuICAgICAgICAgIHRoaXMueXlsbG9jLnJhbmdlWzFdKys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGxpbmVzKSB7XG4gICAgICAgIHRoaXMueXlsaW5lbm8rKztcbiAgICAgICAgdGhpcy55eWxsb2MubGFzdF9saW5lKys7XG4gICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uKys7XG4gICAgICB9XG5cbiAgICAgIHRoaXMueXlsbG9jLnJhbmdlWzFdKys7XG4gICAgICB0aGlzLl9pbnB1dCA9IHRoaXMuX2lucHV0LnNsaWNlKHNsaWNlX2xlbik7XG4gICAgICByZXR1cm4gY2g7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHVuc2hpZnRzIG9uZSBjaGFyIChvciBhbiBlbnRpcmUgc3RyaW5nKSBpbnRvIHRoZSBpbnB1dFxuICAgICAqIFxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAdGhpcyB7UmVnRXhwTGV4ZXJ9XG4gICAgICovXG4gICAgdW5wdXQ6IGZ1bmN0aW9uIGxleGVyX3VucHV0KGNoKSB7XG4gICAgICB2YXIgbGVuID0gY2gubGVuZ3RoO1xuICAgICAgdmFyIGxpbmVzID0gY2guc3BsaXQoLyg/Olxcclxcbj98XFxuKS9nKTtcbiAgICAgIHRoaXMuX2lucHV0ID0gY2ggKyB0aGlzLl9pbnB1dDtcbiAgICAgIHRoaXMueXl0ZXh0ID0gdGhpcy55eXRleHQuc3Vic3RyKDAsIHRoaXMueXl0ZXh0Lmxlbmd0aCAtIGxlbik7XG4gICAgICB0aGlzLnl5bGVuZyA9IHRoaXMueXl0ZXh0Lmxlbmd0aDtcbiAgICAgIHRoaXMub2Zmc2V0IC09IGxlbjtcbiAgICAgIHRoaXMubWF0Y2ggPSB0aGlzLm1hdGNoLnN1YnN0cigwLCB0aGlzLm1hdGNoLmxlbmd0aCAtIGxlbik7XG4gICAgICB0aGlzLm1hdGNoZWQgPSB0aGlzLm1hdGNoZWQuc3Vic3RyKDAsIHRoaXMubWF0Y2hlZC5sZW5ndGggLSBsZW4pO1xuXG4gICAgICBpZiAobGluZXMubGVuZ3RoID4gMSkge1xuICAgICAgICB0aGlzLnl5bGluZW5vIC09IGxpbmVzLmxlbmd0aCAtIDE7XG4gICAgICAgIHRoaXMueXlsbG9jLmxhc3RfbGluZSA9IHRoaXMueXlsaW5lbm8gKyAxO1xuXG4gICAgICAgIC8vIEdldCBsYXN0IGVudGlyZWx5IG1hdGNoZWQgbGluZSBpbnRvIHRoZSBgcHJlX2xpbmVzW11gIGFycmF5J3NcbiAgICAgICAgLy8gbGFzdCBpbmRleCBzbG90OyB3ZSBkb24ndCBtaW5kIHdoZW4gb3RoZXIgcHJldmlvdXNseSBcbiAgICAgICAgLy8gbWF0Y2hlZCBsaW5lcyBlbmQgdXAgaW4gdGhlIGFycmF5IHRvby4gXG4gICAgICAgIHZhciBwcmUgPSB0aGlzLm1hdGNoO1xuXG4gICAgICAgIHZhciBwcmVfbGluZXMgPSBwcmUuc3BsaXQoLyg/Olxcclxcbj98XFxuKS9nKTtcblxuICAgICAgICBpZiAocHJlX2xpbmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHByZSA9IHRoaXMubWF0Y2hlZDtcbiAgICAgICAgICBwcmVfbGluZXMgPSBwcmUuc3BsaXQoLyg/Olxcclxcbj98XFxuKS9nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMueXlsbG9jLmxhc3RfY29sdW1uID0gcHJlX2xpbmVzW3ByZV9saW5lcy5sZW5ndGggLSAxXS5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiAtPSBsZW47XG4gICAgICB9XG5cbiAgICAgIHRoaXMueXlsbG9jLnJhbmdlWzFdID0gdGhpcy55eWxsb2MucmFuZ2VbMF0gKyB0aGlzLnl5bGVuZztcbiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGNhY2hlIG1hdGNoZWQgdGV4dCBhbmQgYXBwZW5kIGl0IG9uIG5leHQgYWN0aW9uXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBtb3JlOiBmdW5jdGlvbiBsZXhlcl9tb3JlKCkge1xuICAgICAgdGhpcy5fbW9yZSA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogc2lnbmFsIHRoZSBsZXhlciB0aGF0IHRoaXMgcnVsZSBmYWlscyB0byBtYXRjaCB0aGUgaW5wdXQsIHNvIHRoZVxuICAgICAqIG5leHQgbWF0Y2hpbmcgcnVsZSAocmVnZXgpIHNob3VsZCBiZSB0ZXN0ZWQgaW5zdGVhZC5cbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIHJlamVjdDogZnVuY3Rpb24gbGV4ZXJfcmVqZWN0KCkge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIpIHtcbiAgICAgICAgdGhpcy5fYmFja3RyYWNrID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHdoZW4gdGhlIGBwYXJzZUVycm9yKClgIGNhbGwgcmV0dXJucywgd2UgTVVTVCBlbnN1cmUgdGhhdCB0aGUgZXJyb3IgaXMgcmVnaXN0ZXJlZC5cbiAgICAgICAgLy8gV2UgYWNjb21wbGlzaCB0aGlzIGJ5IHNpZ25hbGluZyBhbiAnZXJyb3InIHRva2VuIHRvIGJlIHByb2R1Y2VkIGZvciB0aGUgY3VycmVudFxuICAgICAgICAvLyBgLmxleCgpYCBydW4uXG4gICAgICAgIHZhciBsaW5lbm9fbXNnID0gJyc7XG5cbiAgICAgICAgaWYgKHRoaXMueXlsbG9jKSB7XG4gICAgICAgICAgbGluZW5vX21zZyA9ICcgb24gbGluZSAnICsgKHRoaXMueXlsaW5lbm8gKyAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwID0gdGhpcy5jb25zdHJ1Y3RMZXhFcnJvckluZm8oXG4gICAgICAgICAgJ0xleGljYWwgZXJyb3InICsgbGluZW5vX21zZyArICc6IFlvdSBjYW4gb25seSBpbnZva2UgcmVqZWN0KCkgaW4gdGhlIGxleGVyIHdoZW4gdGhlIGxleGVyIGlzIG9mIHRoZSBiYWNrdHJhY2tpbmcgcGVyc3Vhc2lvbiAob3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIgPSB0cnVlKS4nLFxuICAgICAgICAgIGZhbHNlXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5fc2lnbmFsZWRfZXJyb3JfdG9rZW4gPSB0aGlzLnBhcnNlRXJyb3IocC5lcnJTdHIsIHAsIHRoaXMuSmlzb25MZXhlckVycm9yKSB8fCB0aGlzLkVSUk9SO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogcmV0YWluIGZpcnN0IG4gY2hhcmFjdGVycyBvZiB0aGUgbWF0Y2hcbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGxlc3M6IGZ1bmN0aW9uIGxleGVyX2xlc3Mobikge1xuICAgICAgcmV0dXJuIHRoaXMudW5wdXQodGhpcy5tYXRjaC5zbGljZShuKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiAocGFydCBvZiB0aGUpIGFscmVhZHkgbWF0Y2hlZCBpbnB1dCwgaS5lLiBmb3IgZXJyb3JcbiAgICAgKiBtZXNzYWdlcy5cbiAgICAgKiBcbiAgICAgKiBMaW1pdCB0aGUgcmV0dXJuZWQgc3RyaW5nIGxlbmd0aCB0byBgbWF4U2l6ZWAgKGRlZmF1bHQ6IDIwKS5cbiAgICAgKiBcbiAgICAgKiBMaW1pdCB0aGUgcmV0dXJuZWQgc3RyaW5nIHRvIHRoZSBgbWF4TGluZXNgIG51bWJlciBvZiBsaW5lcyBvZlxuICAgICAqIGlucHV0IChkZWZhdWx0OiAxKS5cbiAgICAgKiBcbiAgICAgKiBOZWdhdGl2ZSBsaW1pdCB2YWx1ZXMgZXF1YWwgKnVubGltaXRlZCouXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBwYXN0SW5wdXQ6IGZ1bmN0aW9uIGxleGVyX3Bhc3RJbnB1dChtYXhTaXplLCBtYXhMaW5lcykge1xuICAgICAgdmFyIHBhc3QgPSB0aGlzLm1hdGNoZWQuc3Vic3RyaW5nKDAsIHRoaXMubWF0Y2hlZC5sZW5ndGggLSB0aGlzLm1hdGNoLmxlbmd0aCk7XG5cbiAgICAgIGlmIChtYXhTaXplIDwgMClcbiAgICAgICAgbWF4U2l6ZSA9IHBhc3QubGVuZ3RoO1xuICAgICAgZWxzZSBpZiAoIW1heFNpemUpXG4gICAgICAgIG1heFNpemUgPSAyMDtcblxuICAgICAgaWYgKG1heExpbmVzIDwgMClcbiAgICAgICAgbWF4TGluZXMgPSBwYXN0Lmxlbmd0aDsgICAgICAgICAgLy8gY2FuJ3QgZXZlciBoYXZlIG1vcmUgaW5wdXQgbGluZXMgdGhhbiB0aGlzISBcbiAgICAgIGVsc2UgaWYgKCFtYXhMaW5lcylcbiAgICAgICAgbWF4TGluZXMgPSAxO1xuXG4gICAgICAvLyBgc3Vic3RyYCBhbnRpY2lwYXRpb246IHRyZWF0IFxcclxcbiBhcyBhIHNpbmdsZSBjaGFyYWN0ZXIgYW5kIHRha2UgYSBsaXR0bGVcbiAgICAgIC8vIG1vcmUgdGhhbiBuZWNlc3Nhcnkgc28gdGhhdCB3ZSBjYW4gc3RpbGwgcHJvcGVybHkgY2hlY2sgYWdhaW5zdCBtYXhTaXplXG4gICAgICAvLyBhZnRlciB3ZSd2ZSB0cmFuc2Zvcm1lZCBhbmQgbGltaXRlZCB0aGUgbmV3TGluZXMgaW4gaGVyZTpcbiAgICAgIHBhc3QgPSBwYXN0LnN1YnN0cigtbWF4U2l6ZSAqIDIgLSAyKTtcblxuICAgICAgLy8gbm93IHRoYXQgd2UgaGF2ZSBhIHNpZ25pZmljYW50bHkgcmVkdWNlZCBzdHJpbmcgdG8gcHJvY2VzcywgdHJhbnNmb3JtIHRoZSBuZXdsaW5lc1xuICAgICAgLy8gYW5kIGNob3AgdGhlbSwgdGhlbiBsaW1pdCB0aGVtOlxuICAgICAgdmFyIGEgPSBwYXN0LnJlcGxhY2UoL1xcclxcbnxcXHIvZywgJ1xcbicpLnNwbGl0KCdcXG4nKTtcblxuICAgICAgYSA9IGEuc2xpY2UoLW1heExpbmVzKTtcbiAgICAgIHBhc3QgPSBhLmpvaW4oJ1xcbicpO1xuXG4gICAgICAvLyBXaGVuLCBhZnRlciBsaW1pdGluZyB0byBtYXhMaW5lcywgd2Ugc3RpbGwgaGF2ZSB0b28gbXVjaCB0byByZXR1cm4sXG4gICAgICAvLyBkbyBhZGQgYW4gZWxsaXBzaXMgcHJlZml4Li4uXG4gICAgICBpZiAocGFzdC5sZW5ndGggPiBtYXhTaXplKSB7XG4gICAgICAgIHBhc3QgPSAnLi4uJyArIHBhc3Quc3Vic3RyKC1tYXhTaXplKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBhc3Q7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiAocGFydCBvZiB0aGUpIHVwY29taW5nIGlucHV0LCBpLmUuIGZvciBlcnJvciBtZXNzYWdlcy5cbiAgICAgKiBcbiAgICAgKiBMaW1pdCB0aGUgcmV0dXJuZWQgc3RyaW5nIGxlbmd0aCB0byBgbWF4U2l6ZWAgKGRlZmF1bHQ6IDIwKS5cbiAgICAgKiBcbiAgICAgKiBMaW1pdCB0aGUgcmV0dXJuZWQgc3RyaW5nIHRvIHRoZSBgbWF4TGluZXNgIG51bWJlciBvZiBsaW5lcyBvZiBpbnB1dCAoZGVmYXVsdDogMSkuXG4gICAgICogXG4gICAgICogTmVnYXRpdmUgbGltaXQgdmFsdWVzIGVxdWFsICp1bmxpbWl0ZWQqLlxuICAgICAqXG4gICAgICogPiAjIyMgTk9URSAjIyNcbiAgICAgKiA+XG4gICAgICogPiAqXCJ1cGNvbWluZyBpbnB1dFwiKiBpcyBkZWZpbmVkIGFzIHRoZSB3aG9sZSBvZiB0aGUgYm90aFxuICAgICAqID4gdGhlICpjdXJyZW50bHkgbGV4ZWQqIGlucHV0LCB0b2dldGhlciB3aXRoIGFueSByZW1haW5pbmcgaW5wdXRcbiAgICAgKiA+IGZvbGxvd2luZyB0aGF0LiAqXCJjdXJyZW50bHkgbGV4ZWRcIiogaW5wdXQgaXMgdGhlIGlucHV0IFxuICAgICAqID4gYWxyZWFkeSByZWNvZ25pemVkIGJ5IHRoZSBsZXhlciBidXQgbm90IHlldCByZXR1cm5lZCB3aXRoXG4gICAgICogPiB0aGUgbGV4ZXIgdG9rZW4uIFRoaXMgaGFwcGVucyB3aGVuIHlvdSBhcmUgaW52b2tpbmcgdGhpcyBBUElcbiAgICAgKiA+IGZyb20gaW5zaWRlIGFueSBsZXhlciBydWxlIGFjdGlvbiBjb2RlIGJsb2NrLiBcbiAgICAgKiA+XG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICB1cGNvbWluZ0lucHV0OiBmdW5jdGlvbiBsZXhlcl91cGNvbWluZ0lucHV0KG1heFNpemUsIG1heExpbmVzKSB7XG4gICAgICB2YXIgbmV4dCA9IHRoaXMubWF0Y2g7XG5cbiAgICAgIGlmIChtYXhTaXplIDwgMClcbiAgICAgICAgbWF4U2l6ZSA9IG5leHQubGVuZ3RoICsgdGhpcy5faW5wdXQubGVuZ3RoO1xuICAgICAgZWxzZSBpZiAoIW1heFNpemUpXG4gICAgICAgIG1heFNpemUgPSAyMDtcblxuICAgICAgaWYgKG1heExpbmVzIDwgMClcbiAgICAgICAgbWF4TGluZXMgPSBtYXhTaXplOyAgICAgICAgICAvLyBjYW4ndCBldmVyIGhhdmUgbW9yZSBpbnB1dCBsaW5lcyB0aGFuIHRoaXMhIFxuICAgICAgZWxzZSBpZiAoIW1heExpbmVzKVxuICAgICAgICBtYXhMaW5lcyA9IDE7XG5cbiAgICAgIC8vIGBzdWJzdHJpbmdgIGFudGljaXBhdGlvbjogdHJlYXQgXFxyXFxuIGFzIGEgc2luZ2xlIGNoYXJhY3RlciBhbmQgdGFrZSBhIGxpdHRsZVxuICAgICAgLy8gbW9yZSB0aGFuIG5lY2Vzc2FyeSBzbyB0aGF0IHdlIGNhbiBzdGlsbCBwcm9wZXJseSBjaGVjayBhZ2FpbnN0IG1heFNpemVcbiAgICAgIC8vIGFmdGVyIHdlJ3ZlIHRyYW5zZm9ybWVkIGFuZCBsaW1pdGVkIHRoZSBuZXdMaW5lcyBpbiBoZXJlOlxuICAgICAgaWYgKG5leHQubGVuZ3RoIDwgbWF4U2l6ZSAqIDIgKyAyKSB7XG4gICAgICAgIG5leHQgKz0gdGhpcy5faW5wdXQuc3Vic3RyaW5nKDAsIG1heFNpemUgKiAyICsgMik7ICAgLy8gc3Vic3RyaW5nIGlzIGZhc3RlciBvbiBDaHJvbWUvVjggXG4gICAgICB9XG5cbiAgICAgIC8vIG5vdyB0aGF0IHdlIGhhdmUgYSBzaWduaWZpY2FudGx5IHJlZHVjZWQgc3RyaW5nIHRvIHByb2Nlc3MsIHRyYW5zZm9ybSB0aGUgbmV3bGluZXNcbiAgICAgIC8vIGFuZCBjaG9wIHRoZW0sIHRoZW4gbGltaXQgdGhlbTpcbiAgICAgIHZhciBhID0gbmV4dC5yZXBsYWNlKC9cXHJcXG58XFxyL2csICdcXG4nKS5zcGxpdCgnXFxuJyk7XG5cbiAgICAgIGEgPSBhLnNsaWNlKDAsIG1heExpbmVzKTtcbiAgICAgIG5leHQgPSBhLmpvaW4oJ1xcbicpO1xuXG4gICAgICAvLyBXaGVuLCBhZnRlciBsaW1pdGluZyB0byBtYXhMaW5lcywgd2Ugc3RpbGwgaGF2ZSB0b28gbXVjaCB0byByZXR1cm4sXG4gICAgICAvLyBkbyBhZGQgYW4gZWxsaXBzaXMgcG9zdGZpeC4uLlxuICAgICAgaWYgKG5leHQubGVuZ3RoID4gbWF4U2l6ZSkge1xuICAgICAgICBuZXh0ID0gbmV4dC5zdWJzdHJpbmcoMCwgbWF4U2l6ZSkgKyAnLi4uJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5leHQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiBhIHN0cmluZyB3aGljaCBkaXNwbGF5cyB0aGUgY2hhcmFjdGVyIHBvc2l0aW9uIHdoZXJlIHRoZVxuICAgICAqIGxleGluZyBlcnJvciBvY2N1cnJlZCwgaS5lLiBmb3IgZXJyb3IgbWVzc2FnZXNcbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIHNob3dQb3NpdGlvbjogZnVuY3Rpb24gbGV4ZXJfc2hvd1Bvc2l0aW9uKG1heFByZWZpeCwgbWF4UG9zdGZpeCkge1xuICAgICAgdmFyIHByZSA9IHRoaXMucGFzdElucHV0KG1heFByZWZpeCkucmVwbGFjZSgvXFxzL2csICcgJyk7XG4gICAgICB2YXIgYyA9IG5ldyBBcnJheShwcmUubGVuZ3RoICsgMSkuam9pbignLScpO1xuICAgICAgcmV0dXJuIHByZSArIHRoaXMudXBjb21pbmdJbnB1dChtYXhQb3N0Zml4KS5yZXBsYWNlKC9cXHMvZywgJyAnKSArICdcXG4nICsgYyArICdeJztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogcmV0dXJuIGFuIFlZTExPQyBpbmZvIG9iamVjdCBkZXJpdmVkIG9mZiB0aGUgZ2l2ZW4gY29udGV4dCAoYWN0dWFsLCBwcmVjZWRpbmcsIGZvbGxvd2luZywgY3VycmVudCkuXG4gICAgICogVXNlIHRoaXMgbWV0aG9kIHdoZW4gdGhlIGdpdmVuIGBhY3R1YWxgIGxvY2F0aW9uIGlzIG5vdCBndWFyYW50ZWVkIHRvIGV4aXN0IChpLmUuIHdoZW5cbiAgICAgKiBpdCBNQVkgYmUgTlVMTCkgYW5kIHlvdSBNVVNUIGhhdmUgYSB2YWxpZCBsb2NhdGlvbiBpbmZvIG9iamVjdCBhbnl3YXk6XG4gICAgICogdGhlbiB3ZSB0YWtlIHRoZSBnaXZlbiBjb250ZXh0IG9mIHRoZSBgcHJlY2VkaW5nYCBhbmQgYGZvbGxvd2luZ2AgbG9jYXRpb25zLCBJRkYgdGhvc2UgYXJlIGF2YWlsYWJsZSxcbiAgICAgKiBhbmQgcmVjb25zdHJ1Y3QgdGhlIGBhY3R1YWxgIGxvY2F0aW9uIGluZm8gZnJvbSB0aG9zZS5cbiAgICAgKiBJZiB0aGlzIGZhaWxzLCB0aGUgaGV1cmlzdGljIGlzIHRvIHRha2UgdGhlIGBjdXJyZW50YCBsb2NhdGlvbiwgSUZGIGF2YWlsYWJsZS5cbiAgICAgKiBJZiB0aGlzIGZhaWxzIGFzIHdlbGwsIHdlIGFzc3VtZSB0aGUgc291Z2h0IGxvY2F0aW9uIGlzIGF0L2Fyb3VuZCB0aGUgY3VycmVudCBsZXhlciBwb3NpdGlvblxuICAgICAqIGFuZCB0aGVuIHByb2R1Y2UgdGhhdCBvbmUgYXMgYSByZXNwb25zZS4gRE8gTk9URSB0aGF0IHRoZXNlIGhldXJpc3RpYy9kZXJpdmVkIGxvY2F0aW9uIGluZm9cbiAgICAgKiB2YWx1ZXMgTUFZIGJlIGluYWNjdXJhdGUhXG4gICAgICpcbiAgICAgKiBOT1RFOiBgZGVyaXZlTG9jYXRpb25JbmZvKClgIEFMV0FZUyBwcm9kdWNlcyBhIGxvY2F0aW9uIGluZm8gb2JqZWN0ICpjb3B5KiBvZiBgYWN0dWFsYCwgbm90IGp1c3RcbiAgICAgKiBhICpyZWZlcmVuY2UqIGhlbmNlIGFsbCBpbnB1dCBsb2NhdGlvbiBvYmplY3RzIGNhbiBiZSBhc3N1bWVkIHRvIGJlICdjb25zdGFudCcgKGZ1bmN0aW9uIGhhcyBubyBzaWRlLWVmZmVjdHMpLlxuICAgICAqIFxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAdGhpcyB7UmVnRXhwTGV4ZXJ9XG4gICAgICovXG4gICAgZGVyaXZlTG9jYXRpb25JbmZvOiBmdW5jdGlvbiBsZXhlcl9kZXJpdmVZWUxMT0MoYWN0dWFsLCBwcmVjZWRpbmcsIGZvbGxvd2luZywgY3VycmVudCkge1xuICAgICAgdmFyIGxvYyA9IHtcbiAgICAgICAgZmlyc3RfbGluZTogMSxcbiAgICAgICAgZmlyc3RfY29sdW1uOiAwLFxuICAgICAgICBsYXN0X2xpbmU6IDEsXG4gICAgICAgIGxhc3RfY29sdW1uOiAwLFxuICAgICAgICByYW5nZTogWzAsIDBdXG4gICAgICB9O1xuXG4gICAgICBpZiAoYWN0dWFsKSB7XG4gICAgICAgIGxvYy5maXJzdF9saW5lID0gYWN0dWFsLmZpcnN0X2xpbmUgfCAwO1xuICAgICAgICBsb2MubGFzdF9saW5lID0gYWN0dWFsLmxhc3RfbGluZSB8IDA7XG4gICAgICAgIGxvYy5maXJzdF9jb2x1bW4gPSBhY3R1YWwuZmlyc3RfY29sdW1uIHwgMDtcbiAgICAgICAgbG9jLmxhc3RfY29sdW1uID0gYWN0dWFsLmxhc3RfY29sdW1uIHwgMDtcblxuICAgICAgICBpZiAoYWN0dWFsLnJhbmdlKSB7XG4gICAgICAgICAgbG9jLnJhbmdlWzBdID0gYWN0dWFsLnJhbmdlWzBdIHwgMDtcbiAgICAgICAgICBsb2MucmFuZ2VbMV0gPSBhY3R1YWwucmFuZ2VbMV0gfCAwO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChsb2MuZmlyc3RfbGluZSA8PSAwIHx8IGxvYy5sYXN0X2xpbmUgPCBsb2MuZmlyc3RfbGluZSkge1xuICAgICAgICAvLyBwbGFuIEI6IGhldXJpc3RpYyB1c2luZyBwcmVjZWRpbmcgYW5kIGZvbGxvd2luZzpcbiAgICAgICAgaWYgKGxvYy5maXJzdF9saW5lIDw9IDAgJiYgcHJlY2VkaW5nKSB7XG4gICAgICAgICAgbG9jLmZpcnN0X2xpbmUgPSBwcmVjZWRpbmcubGFzdF9saW5lIHwgMDtcbiAgICAgICAgICBsb2MuZmlyc3RfY29sdW1uID0gcHJlY2VkaW5nLmxhc3RfY29sdW1uIHwgMDtcblxuICAgICAgICAgIGlmIChwcmVjZWRpbmcucmFuZ2UpIHtcbiAgICAgICAgICAgIGxvYy5yYW5nZVswXSA9IGFjdHVhbC5yYW5nZVsxXSB8IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKChsb2MubGFzdF9saW5lIDw9IDAgfHwgbG9jLmxhc3RfbGluZSA8IGxvYy5maXJzdF9saW5lKSAmJiBmb2xsb3dpbmcpIHtcbiAgICAgICAgICBsb2MubGFzdF9saW5lID0gZm9sbG93aW5nLmZpcnN0X2xpbmUgfCAwO1xuICAgICAgICAgIGxvYy5sYXN0X2NvbHVtbiA9IGZvbGxvd2luZy5maXJzdF9jb2x1bW4gfCAwO1xuXG4gICAgICAgICAgaWYgKGZvbGxvd2luZy5yYW5nZSkge1xuICAgICAgICAgICAgbG9jLnJhbmdlWzFdID0gYWN0dWFsLnJhbmdlWzBdIHwgMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwbGFuIEM/OiBzZWUgaWYgdGhlICdjdXJyZW50JyBsb2NhdGlvbiBpcyB1c2VmdWwvc2FuZSB0b286XG4gICAgICAgIGlmIChsb2MuZmlyc3RfbGluZSA8PSAwICYmIGN1cnJlbnQgJiYgKGxvYy5sYXN0X2xpbmUgPD0gMCB8fCBjdXJyZW50Lmxhc3RfbGluZSA8PSBsb2MubGFzdF9saW5lKSkge1xuICAgICAgICAgIGxvYy5maXJzdF9saW5lID0gY3VycmVudC5maXJzdF9saW5lIHwgMDtcbiAgICAgICAgICBsb2MuZmlyc3RfY29sdW1uID0gY3VycmVudC5maXJzdF9jb2x1bW4gfCAwO1xuXG4gICAgICAgICAgaWYgKGN1cnJlbnQucmFuZ2UpIHtcbiAgICAgICAgICAgIGxvYy5yYW5nZVswXSA9IGN1cnJlbnQucmFuZ2VbMF0gfCAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb2MubGFzdF9saW5lIDw9IDAgJiYgY3VycmVudCAmJiAobG9jLmZpcnN0X2xpbmUgPD0gMCB8fCBjdXJyZW50LmZpcnN0X2xpbmUgPj0gbG9jLmZpcnN0X2xpbmUpKSB7XG4gICAgICAgICAgbG9jLmxhc3RfbGluZSA9IGN1cnJlbnQubGFzdF9saW5lIHwgMDtcbiAgICAgICAgICBsb2MubGFzdF9jb2x1bW4gPSBjdXJyZW50Lmxhc3RfY29sdW1uIHwgMDtcblxuICAgICAgICAgIGlmIChjdXJyZW50LnJhbmdlKSB7XG4gICAgICAgICAgICBsb2MucmFuZ2VbMV0gPSBjdXJyZW50LnJhbmdlWzFdIHwgMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gc2FuaXRpemU6IGZpeCBsYXN0X2xpbmUgQkVGT1JFIHdlIGZpeCBmaXJzdF9saW5lIGFzIHdlIHVzZSB0aGUgJ3JhdycgdmFsdWUgb2YgdGhlIGxhdHRlclxuICAgICAgLy8gb3IgcGxhbiBEIGhldXJpc3RpY3MgdG8gcHJvZHVjZSBhICdzZW5zaWJsZScgbGFzdF9saW5lIHZhbHVlOlxuICAgICAgaWYgKGxvYy5sYXN0X2xpbmUgPD0gMCkge1xuICAgICAgICBpZiAobG9jLmZpcnN0X2xpbmUgPD0gMCkge1xuICAgICAgICAgIGxvYy5maXJzdF9saW5lID0gdGhpcy55eWxsb2MuZmlyc3RfbGluZTtcbiAgICAgICAgICBsb2MubGFzdF9saW5lID0gdGhpcy55eWxsb2MubGFzdF9saW5lO1xuICAgICAgICAgIGxvYy5maXJzdF9jb2x1bW4gPSB0aGlzLnl5bGxvYy5maXJzdF9jb2x1bW47XG4gICAgICAgICAgbG9jLmxhc3RfY29sdW1uID0gdGhpcy55eWxsb2MubGFzdF9jb2x1bW47XG4gICAgICAgICAgbG9jLnJhbmdlWzBdID0gdGhpcy55eWxsb2MucmFuZ2VbMF07XG4gICAgICAgICAgbG9jLnJhbmdlWzFdID0gdGhpcy55eWxsb2MucmFuZ2VbMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9jLmxhc3RfbGluZSA9IHRoaXMueXlsbG9jLmxhc3RfbGluZTtcbiAgICAgICAgICBsb2MubGFzdF9jb2x1bW4gPSB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbjtcbiAgICAgICAgICBsb2MucmFuZ2VbMV0gPSB0aGlzLnl5bGxvYy5yYW5nZVsxXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobG9jLmZpcnN0X2xpbmUgPD0gMCkge1xuICAgICAgICBsb2MuZmlyc3RfbGluZSA9IGxvYy5sYXN0X2xpbmU7XG4gICAgICAgIGxvYy5maXJzdF9jb2x1bW4gPSAwOyAgLy8gbG9jLmxhc3RfY29sdW1uOyBcbiAgICAgICAgbG9jLnJhbmdlWzFdID0gbG9jLnJhbmdlWzBdO1xuICAgICAgfVxuXG4gICAgICBpZiAobG9jLmZpcnN0X2NvbHVtbiA8IDApIHtcbiAgICAgICAgbG9jLmZpcnN0X2NvbHVtbiA9IDA7XG4gICAgICB9XG5cbiAgICAgIGlmIChsb2MubGFzdF9jb2x1bW4gPCAwKSB7XG4gICAgICAgIGxvYy5sYXN0X2NvbHVtbiA9IChsb2MuZmlyc3RfY29sdW1uID4gMCA/IGxvYy5maXJzdF9jb2x1bW4gOiA4MCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBsb2M7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiBhIHN0cmluZyB3aGljaCBkaXNwbGF5cyB0aGUgbGluZXMgJiBjb2x1bW5zIG9mIGlucHV0IHdoaWNoIGFyZSByZWZlcmVuY2VkIFxuICAgICAqIGJ5IHRoZSBnaXZlbiBsb2NhdGlvbiBpbmZvIHJhbmdlLCBwbHVzIGEgZmV3IGxpbmVzIG9mIGNvbnRleHQuXG4gICAgICogXG4gICAgICogVGhpcyBmdW5jdGlvbiBwcmV0dHktcHJpbnRzIHRoZSBpbmRpY2F0ZWQgc2VjdGlvbiBvZiB0aGUgaW5wdXQsIHdpdGggbGluZSBudW1iZXJzIFxuICAgICAqIGFuZCBldmVyeXRoaW5nIVxuICAgICAqIFxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdmVyeSB1c2VmdWwgdG8gcHJvdmlkZSBoaWdobHkgcmVhZGFibGUgZXJyb3IgcmVwb3J0cywgd2hpbGVcbiAgICAgKiB0aGUgbG9jYXRpb24gcmFuZ2UgbWF5IGJlIHNwZWNpZmllZCBpbiB2YXJpb3VzIGZsZXhpYmxlIHdheXM6XG4gICAgICogXG4gICAgICogLSBgbG9jYCBpcyB0aGUgbG9jYXRpb24gaW5mbyBvYmplY3Qgd2hpY2ggcmVmZXJlbmNlcyB0aGUgYXJlYSB3aGljaCBzaG91bGQgYmVcbiAgICAgKiAgIGRpc3BsYXllZCBhbmQgJ21hcmtlZCB1cCc6IHRoZXNlIGxpbmVzICYgY29sdW1ucyBvZiB0ZXh0IGFyZSBtYXJrZWQgdXAgYnkgYF5gXG4gICAgICogICBjaGFyYWN0ZXJzIGJlbG93IGVhY2ggY2hhcmFjdGVyIGluIHRoZSBlbnRpcmUgaW5wdXQgcmFuZ2UuXG4gICAgICogXG4gICAgICogLSBgY29udGV4dF9sb2NgIGlzIHRoZSAqb3B0aW9uYWwqIGxvY2F0aW9uIGluZm8gb2JqZWN0IHdoaWNoIGluc3RydWN0cyB0aGlzXG4gICAgICogICBwcmV0dHktcHJpbnRlciBob3cgbXVjaCAqbGVhZGluZyogY29udGV4dCBzaG91bGQgYmUgZGlzcGxheWVkIGFsb25nc2lkZVxuICAgICAqICAgdGhlIGFyZWEgcmVmZXJlbmNlZCBieSBgbG9jYC4gVGhpcyBjYW4gaGVscCBwcm92aWRlIGNvbnRleHQgZm9yIHRoZSBkaXNwbGF5ZWRcbiAgICAgKiAgIGVycm9yLCBldGMuXG4gICAgICogXG4gICAgICogICBXaGVuIHRoaXMgbG9jYXRpb24gaW5mbyBpcyBub3QgcHJvdmlkZWQsIGEgZGVmYXVsdCBjb250ZXh0IG9mIDMgbGluZXMgaXNcbiAgICAgKiAgIHVzZWQuXG4gICAgICogXG4gICAgICogLSBgY29udGV4dF9sb2MyYCBpcyBhbm90aGVyICpvcHRpb25hbCogbG9jYXRpb24gaW5mbyBvYmplY3QsIHdoaWNoIHNlcnZlc1xuICAgICAqICAgYSBzaW1pbGFyIHB1cnBvc2UgdG8gYGNvbnRleHRfbG9jYDogaXQgc3BlY2lmaWVzIHRoZSBhbW91bnQgb2YgKnRyYWlsaW5nKlxuICAgICAqICAgY29udGV4dCBsaW5lcyB0byBkaXNwbGF5IGluIHRoZSBwcmV0dHktcHJpbnQgb3V0cHV0LlxuICAgICAqIFxuICAgICAqICAgV2hlbiB0aGlzIGxvY2F0aW9uIGluZm8gaXMgbm90IHByb3ZpZGVkLCBhIGRlZmF1bHQgY29udGV4dCBvZiAxIGxpbmUgb25seSBpc1xuICAgICAqICAgdXNlZC5cbiAgICAgKiBcbiAgICAgKiBTcGVjaWFsIE5vdGVzOlxuICAgICAqIFxuICAgICAqIC0gd2hlbiB0aGUgYGxvY2AtaW5kaWNhdGVkIHJhbmdlIGlzIHZlcnkgbGFyZ2UgKGFib3V0IDUgbGluZXMgb3IgbW9yZSksIHRoZW5cbiAgICAgKiAgIG9ubHkgdGhlIGZpcnN0IGFuZCBsYXN0IGZldyBsaW5lcyBvZiB0aGlzIGJsb2NrIGFyZSBwcmludGVkIHdoaWxlIGFcbiAgICAgKiAgIGAuLi5jb250aW51ZWQuLi5gIG1lc3NhZ2Ugd2lsbCBiZSBwcmludGVkIGJldHdlZW4gdGhlbS5cbiAgICAgKiBcbiAgICAgKiAgIFRoaXMgc2VydmVzIHRoZSBwdXJwb3NlIG9mIG5vdCBwcmludGluZyBhIGh1Z2UgYW1vdW50IG9mIHRleHQgd2hlbiB0aGUgYGxvY2BcbiAgICAgKiAgIHJhbmdlIGhhcHBlbnMgdG8gYmUgaHVnZTogdGhpcyB3YXkgYSBtYW5hZ2VhYmxlICYgcmVhZGFibGUgb3V0cHV0IHJlc3VsdHNcbiAgICAgKiAgIGZvciBhcmJpdHJhcnkgbGFyZ2UgcmFuZ2VzLlxuICAgICAqIFxuICAgICAqIC0gdGhpcyBmdW5jdGlvbiBjYW4gZGlzcGxheSBsaW5lcyBvZiBpbnB1dCB3aGljaCB3aGF2ZSBub3QgeWV0IGJlZW4gbGV4ZWQuXG4gICAgICogICBgcHJldHR5UHJpbnRSYW5nZSgpYCBjYW4gYWNjZXNzIHRoZSBlbnRpcmUgaW5wdXQhXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBwcmV0dHlQcmludFJhbmdlOiBmdW5jdGlvbiBsZXhlcl9wcmV0dHlQcmludFJhbmdlKGxvYywgY29udGV4dF9sb2MsIGNvbnRleHRfbG9jMikge1xuICAgICAgbG9jID0gdGhpcy5kZXJpdmVMb2NhdGlvbkluZm8obG9jLCBjb250ZXh0X2xvYywgY29udGV4dF9sb2MyKTtcbiAgICAgIGNvbnN0IENPTlRFWFQgPSAzO1xuICAgICAgY29uc3QgQ09OVEVYVF9UQUlMID0gMTtcbiAgICAgIGNvbnN0IE1JTklNVU1fVklTSUJMRV9OT05FTVBUWV9MSU5FX0NPVU5UID0gMjtcbiAgICAgIHZhciBpbnB1dCA9IHRoaXMubWF0Y2hlZCArIHRoaXMuX2lucHV0O1xuICAgICAgdmFyIGxpbmVzID0gaW5wdXQuc3BsaXQoJ1xcbicpO1xuICAgICAgdmFyIGwwID0gTWF0aC5tYXgoMSwgKGNvbnRleHRfbG9jID8gY29udGV4dF9sb2MuZmlyc3RfbGluZSA6IGxvYy5maXJzdF9saW5lIC0gQ09OVEVYVCkpO1xuICAgICAgdmFyIGwxID0gTWF0aC5tYXgoMSwgKGNvbnRleHRfbG9jMiA/IGNvbnRleHRfbG9jMi5sYXN0X2xpbmUgOiBsb2MubGFzdF9saW5lICsgQ09OVEVYVF9UQUlMKSk7XG4gICAgICB2YXIgbGluZW5vX2Rpc3BsYXlfd2lkdGggPSAxICsgTWF0aC5sb2cxMChsMSB8IDEpIHwgMDtcbiAgICAgIHZhciB3c19wcmVmaXggPSBuZXcgQXJyYXkobGluZW5vX2Rpc3BsYXlfd2lkdGgpLmpvaW4oJyAnKTtcbiAgICAgIHZhciBub25lbXB0eV9saW5lX2luZGV4ZXMgPSBbXTtcblxuICAgICAgdmFyIHJ2ID0gbGluZXMuc2xpY2UobDAgLSAxLCBsMSArIDEpLm1hcChmdW5jdGlvbiBpbmplY3RMaW5lTnVtYmVyKGxpbmUsIGluZGV4KSB7XG4gICAgICAgIHZhciBsbm8gPSBpbmRleCArIGwwO1xuICAgICAgICB2YXIgbG5vX3BmeCA9ICh3c19wcmVmaXggKyBsbm8pLnN1YnN0cigtbGluZW5vX2Rpc3BsYXlfd2lkdGgpO1xuICAgICAgICB2YXIgcnYgPSBsbm9fcGZ4ICsgJzogJyArIGxpbmU7XG4gICAgICAgIHZhciBlcnJwZnggPSBuZXcgQXJyYXkobGluZW5vX2Rpc3BsYXlfd2lkdGggKyAxKS5qb2luKCdeJyk7XG4gICAgICAgIHZhciBvZmZzZXQgPSAyICsgMTtcbiAgICAgICAgdmFyIGxlbiA9IDA7XG5cbiAgICAgICAgaWYgKGxubyA9PT0gbG9jLmZpcnN0X2xpbmUpIHtcbiAgICAgICAgICBvZmZzZXQgKz0gbG9jLmZpcnN0X2NvbHVtbjtcblxuICAgICAgICAgIGxlbiA9IE1hdGgubWF4KFxuICAgICAgICAgICAgMixcbiAgICAgICAgICAgICgobG5vID09PSBsb2MubGFzdF9saW5lID8gbG9jLmxhc3RfY29sdW1uIDogbGluZS5sZW5ndGgpKSAtIGxvYy5maXJzdF9jb2x1bW4gKyAxXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChsbm8gPT09IGxvYy5sYXN0X2xpbmUpIHtcbiAgICAgICAgICBsZW4gPSBNYXRoLm1heCgyLCBsb2MubGFzdF9jb2x1bW4gKyAxKTtcbiAgICAgICAgfSBlbHNlIGlmIChsbm8gPiBsb2MuZmlyc3RfbGluZSAmJiBsbm8gPCBsb2MubGFzdF9saW5lKSB7XG4gICAgICAgICAgbGVuID0gTWF0aC5tYXgoMiwgbGluZS5sZW5ndGggKyAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsZW4pIHtcbiAgICAgICAgICB2YXIgbGVhZCA9IG5ldyBBcnJheShvZmZzZXQpLmpvaW4oJy4nKTtcbiAgICAgICAgICB2YXIgbWFyayA9IG5ldyBBcnJheShsZW4pLmpvaW4oJ14nKTtcbiAgICAgICAgICBydiArPSAnXFxuJyArIGVycnBmeCArIGxlYWQgKyBtYXJrO1xuXG4gICAgICAgICAgaWYgKGxpbmUudHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG5vbmVtcHR5X2xpbmVfaW5kZXhlcy5wdXNoKGluZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBydiA9IHJ2LnJlcGxhY2UoL1xcdC9nLCAnICcpO1xuICAgICAgICByZXR1cm4gcnY7XG4gICAgICB9KTtcblxuICAgICAgLy8gbm93IG1ha2Ugc3VyZSB3ZSBkb24ndCBwcmludCBhbiBvdmVybHkgbGFyZ2UgYW1vdW50IG9mIGVycm9yIGFyZWE6IGxpbWl0IGl0IFxuICAgICAgLy8gdG8gdGhlIHRvcCBhbmQgYm90dG9tIGxpbmUgY291bnQ6XG4gICAgICBpZiAobm9uZW1wdHlfbGluZV9pbmRleGVzLmxlbmd0aCA+IDIgKiBNSU5JTVVNX1ZJU0lCTEVfTk9ORU1QVFlfTElORV9DT1VOVCkge1xuICAgICAgICB2YXIgY2xpcF9zdGFydCA9IG5vbmVtcHR5X2xpbmVfaW5kZXhlc1tNSU5JTVVNX1ZJU0lCTEVfTk9ORU1QVFlfTElORV9DT1VOVCAtIDFdICsgMTtcbiAgICAgICAgdmFyIGNsaXBfZW5kID0gbm9uZW1wdHlfbGluZV9pbmRleGVzW25vbmVtcHR5X2xpbmVfaW5kZXhlcy5sZW5ndGggLSBNSU5JTVVNX1ZJU0lCTEVfTk9ORU1QVFlfTElORV9DT1VOVF0gLSAxO1xuICAgICAgICB2YXIgaW50ZXJtZWRpYXRlX2xpbmUgPSBuZXcgQXJyYXkobGluZW5vX2Rpc3BsYXlfd2lkdGggKyAxKS5qb2luKCcgJykgKyAnICAoLi4uY29udGludWVkLi4uKSc7XG4gICAgICAgIGludGVybWVkaWF0ZV9saW5lICs9ICdcXG4nICsgbmV3IEFycmF5KGxpbmVub19kaXNwbGF5X3dpZHRoICsgMSkuam9pbignLScpICsgJyAgKC0tLS0tLS0tLS0tLS0tLSknO1xuICAgICAgICBydi5zcGxpY2UoY2xpcF9zdGFydCwgY2xpcF9lbmQgLSBjbGlwX3N0YXJ0ICsgMSwgaW50ZXJtZWRpYXRlX2xpbmUpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcnYuam9pbignXFxuJyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGhlbHBlciBmdW5jdGlvbiwgdXNlZCB0byBwcm9kdWNlIGEgaHVtYW4gcmVhZGFibGUgZGVzY3JpcHRpb24gYXMgYSBzdHJpbmcsIGdpdmVuXG4gICAgICogdGhlIGlucHV0IGB5eWxsb2NgIGxvY2F0aW9uIG9iamVjdC5cbiAgICAgKiBcbiAgICAgKiBTZXQgYGRpc3BsYXlfcmFuZ2VfdG9vYCB0byBUUlVFIHRvIGluY2x1ZGUgdGhlIHN0cmluZyBjaGFyYWN0ZXIgaW5kZXggcG9zaXRpb24ocylcbiAgICAgKiBpbiB0aGUgZGVzY3JpcHRpb24gaWYgdGhlIGB5eWxsb2MucmFuZ2VgIGlzIGF2YWlsYWJsZS5cbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGRlc2NyaWJlWVlMTE9DOiBmdW5jdGlvbiBsZXhlcl9kZXNjcmliZV95eWxsb2MoeXlsbG9jLCBkaXNwbGF5X3JhbmdlX3Rvbykge1xuICAgICAgdmFyIGwxID0geXlsbG9jLmZpcnN0X2xpbmU7XG4gICAgICB2YXIgbDIgPSB5eWxsb2MubGFzdF9saW5lO1xuICAgICAgdmFyIGMxID0geXlsbG9jLmZpcnN0X2NvbHVtbjtcbiAgICAgIHZhciBjMiA9IHl5bGxvYy5sYXN0X2NvbHVtbjtcbiAgICAgIHZhciBkbCA9IGwyIC0gbDE7XG4gICAgICB2YXIgZGMgPSBjMiAtIGMxO1xuICAgICAgdmFyIHJ2O1xuXG4gICAgICBpZiAoZGwgPT09IDApIHtcbiAgICAgICAgcnYgPSAnbGluZSAnICsgbDEgKyAnLCAnO1xuXG4gICAgICAgIGlmIChkYyA8PSAxKSB7XG4gICAgICAgICAgcnYgKz0gJ2NvbHVtbiAnICsgYzE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcnYgKz0gJ2NvbHVtbnMgJyArIGMxICsgJyAuLiAnICsgYzI7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJ2ID0gJ2xpbmVzICcgKyBsMSArICcoY29sdW1uICcgKyBjMSArICcpIC4uICcgKyBsMiArICcoY29sdW1uICcgKyBjMiArICcpJztcbiAgICAgIH1cblxuICAgICAgaWYgKHl5bGxvYy5yYW5nZSAmJiBkaXNwbGF5X3JhbmdlX3Rvbykge1xuICAgICAgICB2YXIgcjEgPSB5eWxsb2MucmFuZ2VbMF07XG4gICAgICAgIHZhciByMiA9IHl5bGxvYy5yYW5nZVsxXSAtIDE7XG5cbiAgICAgICAgaWYgKHIyIDw9IHIxKSB7XG4gICAgICAgICAgcnYgKz0gJyB7U3RyaW5nIE9mZnNldDogJyArIHIxICsgJ30nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJ2ICs9ICcge1N0cmluZyBPZmZzZXQgcmFuZ2U6ICcgKyByMSArICcgLi4gJyArIHIyICsgJ30nO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBydjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogdGVzdCB0aGUgbGV4ZWQgdG9rZW46IHJldHVybiBGQUxTRSB3aGVuIG5vdCBhIG1hdGNoLCBvdGhlcndpc2UgcmV0dXJuIHRva2VuLlxuICAgICAqIFxuICAgICAqIGBtYXRjaGAgaXMgc3VwcG9zZWQgdG8gYmUgYW4gYXJyYXkgY29taW5nIG91dCBvZiBhIHJlZ2V4IG1hdGNoLCBpLmUuIGBtYXRjaFswXWBcbiAgICAgKiBjb250YWlucyB0aGUgYWN0dWFsbHkgbWF0Y2hlZCB0ZXh0IHN0cmluZy5cbiAgICAgKiBcbiAgICAgKiBBbHNvIG1vdmUgdGhlIGlucHV0IGN1cnNvciBmb3J3YXJkIGFuZCB1cGRhdGUgdGhlIG1hdGNoIGNvbGxlY3RvcnM6XG4gICAgICogXG4gICAgICogLSBgeXl0ZXh0YFxuICAgICAqIC0gYHl5bGVuZ2BcbiAgICAgKiAtIGBtYXRjaGBcbiAgICAgKiAtIGBtYXRjaGVzYFxuICAgICAqIC0gYHl5bGxvY2BcbiAgICAgKiAtIGBvZmZzZXRgXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICB0ZXN0X21hdGNoOiBmdW5jdGlvbiBsZXhlcl90ZXN0X21hdGNoKG1hdGNoLCBpbmRleGVkX3J1bGUpIHtcbiAgICAgIHZhciB0b2tlbiwgbGluZXMsIGJhY2t1cCwgbWF0Y2hfc3RyLCBtYXRjaF9zdHJfbGVuO1xuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmJhY2t0cmFja19sZXhlcikge1xuICAgICAgICAvLyBzYXZlIGNvbnRleHRcbiAgICAgICAgYmFja3VwID0ge1xuICAgICAgICAgIHl5bGluZW5vOiB0aGlzLnl5bGluZW5vLFxuXG4gICAgICAgICAgeXlsbG9jOiB7XG4gICAgICAgICAgICBmaXJzdF9saW5lOiB0aGlzLnl5bGxvYy5maXJzdF9saW5lLFxuICAgICAgICAgICAgbGFzdF9saW5lOiB0aGlzLnl5bGxvYy5sYXN0X2xpbmUsXG4gICAgICAgICAgICBmaXJzdF9jb2x1bW46IHRoaXMueXlsbG9jLmZpcnN0X2NvbHVtbixcbiAgICAgICAgICAgIGxhc3RfY29sdW1uOiB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbixcbiAgICAgICAgICAgIHJhbmdlOiB0aGlzLnl5bGxvYy5yYW5nZS5zbGljZSgwKVxuICAgICAgICAgIH0sXG5cbiAgICAgICAgICB5eXRleHQ6IHRoaXMueXl0ZXh0LFxuICAgICAgICAgIG1hdGNoOiB0aGlzLm1hdGNoLFxuICAgICAgICAgIG1hdGNoZXM6IHRoaXMubWF0Y2hlcyxcbiAgICAgICAgICBtYXRjaGVkOiB0aGlzLm1hdGNoZWQsXG4gICAgICAgICAgeXlsZW5nOiB0aGlzLnl5bGVuZyxcbiAgICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0LFxuICAgICAgICAgIF9tb3JlOiB0aGlzLl9tb3JlLFxuICAgICAgICAgIF9pbnB1dDogdGhpcy5faW5wdXQsXG5cbiAgICAgICAgICAvL19zaWduYWxlZF9lcnJvcl90b2tlbjogdGhpcy5fc2lnbmFsZWRfZXJyb3JfdG9rZW4sXG4gICAgICAgICAgeXk6IHRoaXMueXksXG5cbiAgICAgICAgICBjb25kaXRpb25TdGFjazogdGhpcy5jb25kaXRpb25TdGFjay5zbGljZSgwKSxcbiAgICAgICAgICBkb25lOiB0aGlzLmRvbmVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgbWF0Y2hfc3RyID0gbWF0Y2hbMF07XG4gICAgICBtYXRjaF9zdHJfbGVuID0gbWF0Y2hfc3RyLmxlbmd0aDtcblxuICAgICAgLy8gaWYgKG1hdGNoX3N0ci5pbmRleE9mKCdcXG4nKSAhPT0gLTEgfHwgbWF0Y2hfc3RyLmluZGV4T2YoJ1xccicpICE9PSAtMSkge1xuICAgICAgbGluZXMgPSBtYXRjaF9zdHIuc3BsaXQoLyg/Olxcclxcbj98XFxuKS9nKTtcblxuICAgICAgaWYgKGxpbmVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhpcy55eWxpbmVubyArPSBsaW5lcy5sZW5ndGggLSAxO1xuICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2xpbmUgPSB0aGlzLnl5bGluZW5vICsgMTtcbiAgICAgICAgdGhpcy55eWxsb2MubGFzdF9jb2x1bW4gPSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnl5bGxvYy5sYXN0X2NvbHVtbiArPSBtYXRjaF9zdHJfbGVuO1xuICAgICAgfVxuXG4gICAgICAvLyB9XG4gICAgICB0aGlzLnl5dGV4dCArPSBtYXRjaF9zdHI7XG5cbiAgICAgIHRoaXMubWF0Y2ggKz0gbWF0Y2hfc3RyO1xuICAgICAgdGhpcy5tYXRjaGVkICs9IG1hdGNoX3N0cjtcbiAgICAgIHRoaXMubWF0Y2hlcyA9IG1hdGNoO1xuICAgICAgdGhpcy55eWxlbmcgPSB0aGlzLnl5dGV4dC5sZW5ndGg7XG4gICAgICB0aGlzLnl5bGxvYy5yYW5nZVsxXSArPSBtYXRjaF9zdHJfbGVuO1xuXG4gICAgICAvLyBwcmV2aW91cyBsZXggcnVsZXMgTUFZIGhhdmUgaW52b2tlZCB0aGUgYG1vcmUoKWAgQVBJIHJhdGhlciB0aGFuIHByb2R1Y2luZyBhIHRva2VuOlxuICAgICAgLy8gdGhvc2UgcnVsZXMgd2lsbCBhbHJlYWR5IGhhdmUgbW92ZWQgdGhpcyBgb2Zmc2V0YCBmb3J3YXJkIG1hdGNoaW5nIHRoZWlyIG1hdGNoIGxlbmd0aHMsXG4gICAgICAvLyBoZW5jZSB3ZSBtdXN0IG9ubHkgYWRkIG91ciBvd24gbWF0Y2ggbGVuZ3RoIG5vdzpcbiAgICAgIHRoaXMub2Zmc2V0ICs9IG1hdGNoX3N0cl9sZW47XG5cbiAgICAgIHRoaXMuX21vcmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2JhY2t0cmFjayA9IGZhbHNlO1xuICAgICAgdGhpcy5faW5wdXQgPSB0aGlzLl9pbnB1dC5zbGljZShtYXRjaF9zdHJfbGVuKTtcblxuICAgICAgLy8gY2FsbGluZyB0aGlzIG1ldGhvZDpcbiAgICAgIC8vXG4gICAgICAvLyAgIGZ1bmN0aW9uIGxleGVyX19wZXJmb3JtQWN0aW9uKHl5LCB5eXJ1bGVudW1iZXIsIFlZX1NUQVJUKSB7Li4ufVxuICAgICAgdG9rZW4gPSB0aGlzLnBlcmZvcm1BY3Rpb24uY2FsbChcbiAgICAgICAgdGhpcyxcbiAgICAgICAgdGhpcy55eSxcbiAgICAgICAgaW5kZXhlZF9ydWxlLFxuICAgICAgICB0aGlzLmNvbmRpdGlvblN0YWNrW3RoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMV0gLyogPSBZWV9TVEFSVCAqL1xuICAgICAgKTtcblxuICAgICAgLy8gb3RoZXJ3aXNlLCB3aGVuIHRoZSBhY3Rpb24gY29kZXMgYXJlIGFsbCBzaW1wbGUgcmV0dXJuIHRva2VuIHN0YXRlbWVudHM6XG4gICAgICAvL3Rva2VuID0gdGhpcy5zaW1wbGVDYXNlQWN0aW9uQ2x1c3RlcnNbaW5kZXhlZF9ydWxlXTtcblxuICAgICAgaWYgKHRoaXMuZG9uZSAmJiB0aGlzLl9pbnB1dCkge1xuICAgICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fYmFja3RyYWNrKSB7XG4gICAgICAgIC8vIHJlY292ZXIgY29udGV4dFxuICAgICAgICBmb3IgKHZhciBrIGluIGJhY2t1cCkge1xuICAgICAgICAgIHRoaXNba10gPSBiYWNrdXBba107XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9fY3VycmVudFJ1bGVTZXRfXyA9IG51bGw7XG4gICAgICAgIHJldHVybiBmYWxzZTsgIC8vIHJ1bGUgYWN0aW9uIGNhbGxlZCByZWplY3QoKSBpbXBseWluZyB0aGUgbmV4dCBydWxlIHNob3VsZCBiZSB0ZXN0ZWQgaW5zdGVhZC4gXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX3NpZ25hbGVkX2Vycm9yX3Rva2VuKSB7XG4gICAgICAgIC8vIHByb2R1Y2Ugb25lICdlcnJvcicgdG9rZW4gYXMgYC5wYXJzZUVycm9yKClgIGluIGByZWplY3QoKWBcbiAgICAgICAgLy8gZGlkIG5vdCBndWFyYW50ZWUgYSBmYWlsdXJlIHNpZ25hbCBieSB0aHJvd2luZyBhbiBleGNlcHRpb24hXG4gICAgICAgIHRva2VuID0gdGhpcy5fc2lnbmFsZWRfZXJyb3JfdG9rZW47XG5cbiAgICAgICAgdGhpcy5fc2lnbmFsZWRfZXJyb3JfdG9rZW4gPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiBuZXh0IG1hdGNoIGluIGlucHV0XG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBuZXh0OiBmdW5jdGlvbiBsZXhlcl9uZXh0KCkge1xuICAgICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgIHJldHVybiB0aGlzLkVPRjtcbiAgICAgIH1cblxuICAgICAgaWYgKCF0aGlzLl9pbnB1dCkge1xuICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgdG9rZW4sIG1hdGNoLCB0ZW1wTWF0Y2gsIGluZGV4O1xuXG4gICAgICBpZiAoIXRoaXMuX21vcmUpIHtcbiAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgfVxuXG4gICAgICB2YXIgc3BlYyA9IHRoaXMuX19jdXJyZW50UnVsZVNldF9fO1xuXG4gICAgICBpZiAoIXNwZWMpIHtcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBydWxlc2V0IGNhY2hlIGFzIHdlIGFwcGFyZW50bHkgZW5jb3VudGVyZWQgYSBzdGF0ZSBjaGFuZ2Ugb3IganVzdCBzdGFydGVkIGxleGluZy5cbiAgICAgICAgLy8gVGhlIGNhY2hlIGlzIHNldCB1cCBmb3IgZmFzdCBsb29rdXAgLS0gd2UgYXNzdW1lIGEgbGV4ZXIgd2lsbCBzd2l0Y2ggc3RhdGVzIG11Y2ggbGVzcyBvZnRlbiB0aGFuIGl0IHdpbGxcbiAgICAgICAgLy8gaW52b2tlIHRoZSBgbGV4KClgIHRva2VuLXByb2R1Y2luZyBBUEkgYW5kIHJlbGF0ZWQgQVBJcywgaGVuY2UgY2FjaGluZyB0aGUgc2V0IGZvciBkaXJlY3QgYWNjZXNzIGhlbHBzXG4gICAgICAgIC8vIHNwZWVkIHVwIHRob3NlIGFjdGl2aXRpZXMgYSB0aW55IGJpdC5cbiAgICAgICAgc3BlYyA9IHRoaXMuX19jdXJyZW50UnVsZVNldF9fID0gdGhpcy5fY3VycmVudFJ1bGVzKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgd2hldGhlciBhICpzYW5lKiBjb25kaXRpb24gaGFzIGJlZW4gcHVzaGVkIGJlZm9yZTogdGhpcyBtYWtlcyB0aGUgbGV4ZXIgcm9idXN0IGFnYWluc3RcbiAgICAgICAgLy8gdXNlci1wcm9ncmFtbWVyIGJ1Z3Mgc3VjaCBhcyBodHRwczovL2dpdGh1Yi5jb20vemFhY2gvamlzb24tbGV4L2lzc3Vlcy8xOVxuICAgICAgICBpZiAoIXNwZWMgfHwgIXNwZWMucnVsZXMpIHtcbiAgICAgICAgICB2YXIgbGluZW5vX21zZyA9ICcnO1xuXG4gICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50cmFja1Bvc2l0aW9uKSB7XG4gICAgICAgICAgICBsaW5lbm9fbXNnID0gJyBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBwID0gdGhpcy5jb25zdHJ1Y3RMZXhFcnJvckluZm8oXG4gICAgICAgICAgICAnSW50ZXJuYWwgbGV4ZXIgZW5naW5lIGVycm9yJyArIGxpbmVub19tc2cgKyAnOiBUaGUgbGV4IGdyYW1tYXIgcHJvZ3JhbW1lciBwdXNoZWQgYSBub24tZXhpc3RpbmcgY29uZGl0aW9uIG5hbWUgXCInICsgdGhpcy50b3BTdGF0ZSgpICsgJ1wiOyB0aGlzIGlzIGEgZmF0YWwgZXJyb3IgYW5kIHNob3VsZCBiZSByZXBvcnRlZCB0byB0aGUgYXBwbGljYXRpb24gcHJvZ3JhbW1lciB0ZWFtIScsXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICAvLyBwcm9kdWNlIG9uZSAnZXJyb3InIHRva2VuIHVudGlsIHRoaXMgc2l0dWF0aW9uIGhhcyBiZWVuIHJlc29sdmVkLCBtb3N0IHByb2JhYmx5IGJ5IHBhcnNlIHRlcm1pbmF0aW9uIVxuICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlRXJyb3IocC5lcnJTdHIsIHAsIHRoaXMuSmlzb25MZXhlckVycm9yKSB8fCB0aGlzLkVSUk9SO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBydWxlX2lkcyA9IHNwZWMucnVsZXM7XG4gICAgICB2YXIgcmVnZXhlcyA9IHNwZWMuX19ydWxlX3JlZ2V4ZXM7XG4gICAgICB2YXIgbGVuID0gc3BlYy5fX3J1bGVfY291bnQ7XG5cbiAgICAgIC8vIE5vdGU6IHRoZSBhcnJheXMgYXJlIDEtYmFzZWQsIHdoaWxlIGBsZW5gIGl0c2VsZiBpcyBhIHZhbGlkIGluZGV4LFxuICAgICAgLy8gaGVuY2UgdGhlIG5vbi1zdGFuZGFyZCBsZXNzLW9yLWVxdWFsIGNoZWNrIGluIHRoZSBuZXh0IGxvb3AgY29uZGl0aW9uIVxuICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbGVuOyBpKyspIHtcbiAgICAgICAgdGVtcE1hdGNoID0gdGhpcy5faW5wdXQubWF0Y2gocmVnZXhlc1tpXSk7XG5cbiAgICAgICAgaWYgKHRlbXBNYXRjaCAmJiAoIW1hdGNoIHx8IHRlbXBNYXRjaFswXS5sZW5ndGggPiBtYXRjaFswXS5sZW5ndGgpKSB7XG4gICAgICAgICAgbWF0Y2ggPSB0ZW1wTWF0Y2g7XG4gICAgICAgICAgaW5kZXggPSBpO1xuXG4gICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iYWNrdHJhY2tfbGV4ZXIpIHtcbiAgICAgICAgICAgIHRva2VuID0gdGhpcy50ZXN0X21hdGNoKHRlbXBNYXRjaCwgcnVsZV9pZHNbaV0pO1xuXG4gICAgICAgICAgICBpZiAodG9rZW4gIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fYmFja3RyYWNrKSB7XG4gICAgICAgICAgICAgIG1hdGNoID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICBjb250aW51ZTsgIC8vIHJ1bGUgYWN0aW9uIGNhbGxlZCByZWplY3QoKSBpbXBseWluZyBhIHJ1bGUgTUlTbWF0Y2guIFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gZWxzZTogdGhpcyBpcyBhIGxleGVyIHJ1bGUgd2hpY2ggY29uc3VtZXMgaW5wdXQgd2l0aG91dCBwcm9kdWNpbmcgYSB0b2tlbiAoZS5nLiB3aGl0ZXNwYWNlKVxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5vcHRpb25zLmZsZXgpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgdG9rZW4gPSB0aGlzLnRlc3RfbWF0Y2gobWF0Y2gsIHJ1bGVfaWRzW2luZGV4XSk7XG5cbiAgICAgICAgaWYgKHRva2VuICE9PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVsc2U6IHRoaXMgaXMgYSBsZXhlciBydWxlIHdoaWNoIGNvbnN1bWVzIGlucHV0IHdpdGhvdXQgcHJvZHVjaW5nIGEgdG9rZW4gKGUuZy4gd2hpdGVzcGFjZSlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuX2lucHV0KSB7XG4gICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuRU9GO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGxpbmVub19tc2cgPSAnJztcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnRyYWNrUG9zaXRpb24pIHtcbiAgICAgICAgICBsaW5lbm9fbXNnID0gJyBvbiBsaW5lICcgKyAodGhpcy55eWxpbmVubyArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHAgPSB0aGlzLmNvbnN0cnVjdExleEVycm9ySW5mbyhcbiAgICAgICAgICAnTGV4aWNhbCBlcnJvcicgKyBsaW5lbm9fbXNnICsgJzogVW5yZWNvZ25pemVkIHRleHQuJyxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMubGV4ZXJFcnJvcnNBcmVSZWNvdmVyYWJsZVxuICAgICAgICApO1xuXG4gICAgICAgIHZhciBwZW5kaW5nSW5wdXQgPSB0aGlzLl9pbnB1dDtcbiAgICAgICAgdmFyIGFjdGl2ZUNvbmRpdGlvbiA9IHRoaXMudG9wU3RhdGUoKTtcbiAgICAgICAgdmFyIGNvbmRpdGlvblN0YWNrRGVwdGggPSB0aGlzLmNvbmRpdGlvblN0YWNrLmxlbmd0aDtcbiAgICAgICAgdG9rZW4gPSB0aGlzLnBhcnNlRXJyb3IocC5lcnJTdHIsIHAsIHRoaXMuSmlzb25MZXhlckVycm9yKSB8fCB0aGlzLkVSUk9SO1xuXG4gICAgICAgIGlmICh0b2tlbiA9PT0gdGhpcy5FUlJPUikge1xuICAgICAgICAgIC8vIHdlIGNhbiB0cnkgdG8gcmVjb3ZlciBmcm9tIGEgbGV4ZXIgZXJyb3IgdGhhdCBgcGFyc2VFcnJvcigpYCBkaWQgbm90ICdyZWNvdmVyJyBmb3IgdXNcbiAgICAgICAgICAvLyBieSBtb3ZpbmcgZm9yd2FyZCBhdCBsZWFzdCBvbmUgY2hhcmFjdGVyIGF0IGEgdGltZSBJRkYgdGhlICh1c2VyLXNwZWNpZmllZD8pIGBwYXJzZUVycm9yKClgXG4gICAgICAgICAgLy8gaGFzIG5vdCBjb25zdW1lZC9tb2RpZmllZCBhbnkgcGVuZGluZyBpbnB1dCBvciBjaGFuZ2VkIHN0YXRlIGluIHRoZSBlcnJvciBoYW5kbGVyOlxuICAgICAgICAgIGlmICghdGhpcy5tYXRjaGVzICYmIC8vIGFuZCBtYWtlIHN1cmUgdGhlIGlucHV0IGhhcyBiZWVuIG1vZGlmaWVkL2NvbnN1bWVkIC4uLlxuICAgICAgICAgIHBlbmRpbmdJbnB1dCA9PT0gdGhpcy5faW5wdXQgJiYgLy8gLi4ub3IgdGhlIGxleGVyIHN0YXRlIGhhcyBiZWVuIG1vZGlmaWVkIHNpZ25pZmljYW50bHkgZW5vdWdoXG4gICAgICAgICAgLy8gdG8gbWVyaXQgYSBub24tY29uc3VtaW5nIGVycm9yIGhhbmRsaW5nIGFjdGlvbiByaWdodCBub3cuXG4gICAgICAgICAgYWN0aXZlQ29uZGl0aW9uID09PSB0aGlzLnRvcFN0YXRlKCkgJiYgY29uZGl0aW9uU3RhY2tEZXB0aCA9PT0gdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuaW5wdXQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiBuZXh0IG1hdGNoIHRoYXQgaGFzIGEgdG9rZW5cbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIGxleDogZnVuY3Rpb24gbGV4ZXJfbGV4KCkge1xuICAgICAgdmFyIHI7XG5cbiAgICAgIC8vIGFsbG93IHRoZSBQUkUvUE9TVCBoYW5kbGVycyBzZXQvbW9kaWZ5IHRoZSByZXR1cm4gdG9rZW4gZm9yIG1heGltdW0gZmxleGliaWxpdHkgb2YgdGhlIGdlbmVyYXRlZCBsZXhlcjpcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5wcmVfbGV4ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHIgPSB0aGlzLnByZV9sZXguY2FsbCh0aGlzLCAwKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMucHJlX2xleCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyAoYWxzbyBhY2NvdW50IGZvciBhIHVzZXJkZWYgZnVuY3Rpb24gd2hpY2ggZG9lcyBub3QgcmV0dXJuIGFueSB2YWx1ZToga2VlcCB0aGUgdG9rZW4gYXMgaXMpXG4gICAgICAgIHIgPSB0aGlzLm9wdGlvbnMucHJlX2xleC5jYWxsKHRoaXMsIHIpIHx8IHI7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnl5ICYmIHR5cGVvZiB0aGlzLnl5LnByZV9sZXggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gKGFsc28gYWNjb3VudCBmb3IgYSB1c2VyZGVmIGZ1bmN0aW9uIHdoaWNoIGRvZXMgbm90IHJldHVybiBhbnkgdmFsdWU6IGtlZXAgdGhlIHRva2VuIGFzIGlzKVxuICAgICAgICByID0gdGhpcy55eS5wcmVfbGV4LmNhbGwodGhpcywgcikgfHwgcjtcbiAgICAgIH1cblxuICAgICAgd2hpbGUgKCFyKSB7XG4gICAgICAgIHIgPSB0aGlzLm5leHQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMueXkgJiYgdHlwZW9mIHRoaXMueXkucG9zdF9sZXggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gKGFsc28gYWNjb3VudCBmb3IgYSB1c2VyZGVmIGZ1bmN0aW9uIHdoaWNoIGRvZXMgbm90IHJldHVybiBhbnkgdmFsdWU6IGtlZXAgdGhlIHRva2VuIGFzIGlzKVxuICAgICAgICByID0gdGhpcy55eS5wb3N0X2xleC5jYWxsKHRoaXMsIHIpIHx8IHI7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnBvc3RfbGV4ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIChhbHNvIGFjY291bnQgZm9yIGEgdXNlcmRlZiBmdW5jdGlvbiB3aGljaCBkb2VzIG5vdCByZXR1cm4gYW55IHZhbHVlOiBrZWVwIHRoZSB0b2tlbiBhcyBpcylcbiAgICAgICAgciA9IHRoaXMub3B0aW9ucy5wb3N0X2xleC5jYWxsKHRoaXMsIHIpIHx8IHI7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5wb3N0X2xleCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyAoYWxzbyBhY2NvdW50IGZvciBhIHVzZXJkZWYgZnVuY3Rpb24gd2hpY2ggZG9lcyBub3QgcmV0dXJuIGFueSB2YWx1ZToga2VlcCB0aGUgdG9rZW4gYXMgaXMpXG4gICAgICAgIHIgPSB0aGlzLnBvc3RfbGV4LmNhbGwodGhpcywgcikgfHwgcjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiBuZXh0IG1hdGNoIHRoYXQgaGFzIGEgdG9rZW4uIElkZW50aWNhbCB0byB0aGUgYGxleCgpYCBBUEkgYnV0IGRvZXMgbm90IGludm9rZSBhbnkgb2YgdGhlIFxuICAgICAqIGBwcmVfbGV4KClgIG5vciBhbnkgb2YgdGhlIGBwb3N0X2xleCgpYCBjYWxsYmFja3MuXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBmYXN0TGV4OiBmdW5jdGlvbiBsZXhlcl9mYXN0TGV4KCkge1xuICAgICAgdmFyIHI7XG5cbiAgICAgIHdoaWxlICghcikge1xuICAgICAgICByID0gdGhpcy5uZXh0KCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiByZXR1cm4gaW5mbyBhYm91dCB0aGUgbGV4ZXIgc3RhdGUgdGhhdCBjYW4gaGVscCBhIHBhcnNlciBvciBvdGhlciBsZXhlciBBUEkgdXNlciB0byB1c2UgdGhlXG4gICAgICogbW9zdCBlZmZpY2llbnQgbWVhbnMgYXZhaWxhYmxlLiBUaGlzIEFQSSBpcyBwcm92aWRlZCB0byBhaWQgcnVuLXRpbWUgcGVyZm9ybWFuY2UgZm9yIGxhcmdlclxuICAgICAqIHN5c3RlbXMgd2hpY2ggZW1wbG95IHRoaXMgbGV4ZXIuXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBjYW5JVXNlOiBmdW5jdGlvbiBsZXhlcl9jYW5JVXNlKCkge1xuICAgICAgdmFyIHJ2ID0ge1xuICAgICAgICBmYXN0TGV4OiAhKHR5cGVvZiB0aGlzLnByZV9sZXggPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIHRoaXMub3B0aW9ucy5wcmVfbGV4ID09PSAnZnVuY3Rpb24nIHx8IHRoaXMueXkgJiYgdHlwZW9mIHRoaXMueXkucHJlX2xleCA9PT0gJ2Z1bmN0aW9uJyB8fCB0aGlzLnl5ICYmIHR5cGVvZiB0aGlzLnl5LnBvc3RfbGV4ID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiB0aGlzLm9wdGlvbnMucG9zdF9sZXggPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mIHRoaXMucG9zdF9sZXggPT09ICdmdW5jdGlvbicpICYmIHR5cGVvZiB0aGlzLmZhc3RMZXggPT09ICdmdW5jdGlvbidcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBydjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogYmFja3dhcmRzIGNvbXBhdGlibGUgYWxpYXMgZm9yIGBwdXNoU3RhdGUoKWA7XG4gICAgICogdGhlIGxhdHRlciBpcyBzeW1tZXRyaWNhbCB3aXRoIGBwb3BTdGF0ZSgpYCBhbmQgd2UgYWR2aXNlIHRvIHVzZVxuICAgICAqIHRob3NlIEFQSXMgaW4gYW55IG1vZGVybiBsZXhlciBjb2RlLCByYXRoZXIgdGhhbiBgYmVnaW4oKWAuXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBiZWdpbjogZnVuY3Rpb24gbGV4ZXJfYmVnaW4oY29uZGl0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5wdXNoU3RhdGUoY29uZGl0aW9uKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogYWN0aXZhdGVzIGEgbmV3IGxleGVyIGNvbmRpdGlvbiBzdGF0ZSAocHVzaGVzIHRoZSBuZXcgbGV4ZXJcbiAgICAgKiBjb25kaXRpb24gc3RhdGUgb250byB0aGUgY29uZGl0aW9uIHN0YWNrKVxuICAgICAqIFxuICAgICAqIEBwdWJsaWNcbiAgICAgKiBAdGhpcyB7UmVnRXhwTGV4ZXJ9XG4gICAgICovXG4gICAgcHVzaFN0YXRlOiBmdW5jdGlvbiBsZXhlcl9wdXNoU3RhdGUoY29uZGl0aW9uKSB7XG4gICAgICB0aGlzLmNvbmRpdGlvblN0YWNrLnB1c2goY29uZGl0aW9uKTtcbiAgICAgIHRoaXMuX19jdXJyZW50UnVsZVNldF9fID0gbnVsbDtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBwb3AgdGhlIHByZXZpb3VzbHkgYWN0aXZlIGxleGVyIGNvbmRpdGlvbiBzdGF0ZSBvZmYgdGhlIGNvbmRpdGlvblxuICAgICAqIHN0YWNrXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBwb3BTdGF0ZTogZnVuY3Rpb24gbGV4ZXJfcG9wU3RhdGUoKSB7XG4gICAgICB2YXIgbiA9IHRoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoIC0gMTtcblxuICAgICAgaWYgKG4gPiAwKSB7XG4gICAgICAgIHRoaXMuX19jdXJyZW50UnVsZVNldF9fID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZGl0aW9uU3RhY2sucG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFja1swXTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogcmV0dXJuIHRoZSBjdXJyZW50bHkgYWN0aXZlIGxleGVyIGNvbmRpdGlvbiBzdGF0ZTsgd2hlbiBhbiBpbmRleFxuICAgICAqIGFyZ3VtZW50IGlzIHByb3ZpZGVkIGl0IHByb2R1Y2VzIHRoZSBOLXRoIHByZXZpb3VzIGNvbmRpdGlvbiBzdGF0ZSxcbiAgICAgKiBpZiBhdmFpbGFibGVcbiAgICAgKiBcbiAgICAgKiBAcHVibGljXG4gICAgICogQHRoaXMge1JlZ0V4cExleGVyfVxuICAgICAqL1xuICAgIHRvcFN0YXRlOiBmdW5jdGlvbiBsZXhlcl90b3BTdGF0ZShuKSB7XG4gICAgICBuID0gdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxIC0gTWF0aC5hYnMobiB8fCAwKTtcblxuICAgICAgaWYgKG4gPj0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFja1tuXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAnSU5JVElBTCc7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIChpbnRlcm5hbCkgZGV0ZXJtaW5lIHRoZSBsZXhlciBydWxlIHNldCB3aGljaCBpcyBhY3RpdmUgZm9yIHRoZVxuICAgICAqIGN1cnJlbnRseSBhY3RpdmUgbGV4ZXIgY29uZGl0aW9uIHN0YXRlXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBfY3VycmVudFJ1bGVzOiBmdW5jdGlvbiBsZXhlcl9fY3VycmVudFJ1bGVzKCkge1xuICAgICAgaWYgKHRoaXMuY29uZGl0aW9uU3RhY2subGVuZ3RoICYmIHRoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxXSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25zW3RoaXMuY29uZGl0aW9uU3RhY2tbdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGggLSAxXV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25zWydJTklUSUFMJ107XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybiB0aGUgbnVtYmVyIG9mIHN0YXRlcyBjdXJyZW50bHkgb24gdGhlIHN0YWNrXG4gICAgICogXG4gICAgICogQHB1YmxpY1xuICAgICAqIEB0aGlzIHtSZWdFeHBMZXhlcn1cbiAgICAgKi9cbiAgICBzdGF0ZVN0YWNrU2l6ZTogZnVuY3Rpb24gbGV4ZXJfc3RhdGVTdGFja1NpemUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb25kaXRpb25TdGFjay5sZW5ndGg7XG4gICAgfSxcblxuICAgIG9wdGlvbnM6IHtcbiAgICAgIHRyYWNrUG9zaXRpb246IHRydWVcbiAgICB9LFxuXG4gICAgSmlzb25MZXhlckVycm9yOiBKaXNvbkxleGVyRXJyb3IsXG5cbiAgICBwZXJmb3JtQWN0aW9uOiBmdW5jdGlvbiBsZXhlcl9fcGVyZm9ybUFjdGlvbih5eSwgeXlydWxlbnVtYmVyLCBZWV9TVEFSVCkge1xuICAgICAgdmFyIHl5XyA9IHRoaXM7XG4gICAgICB2YXIgWVlTVEFURSA9IFlZX1NUQVJUO1xuXG4gICAgICBzd2l0Y2ggKHl5cnVsZW51bWJlcikge1xuICAgICAgY2FzZSAwOlxuICAgICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgICAgLyohIFJ1bGU6OiAgICAgICBcXHMrICovXG4gICAgICAgIC8qIHNraXAgd2hpdGVzcGFjZSAqL1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHRoaXMuc2ltcGxlQ2FzZUFjdGlvbkNsdXN0ZXJzW3l5cnVsZW51bWJlcl07XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNpbXBsZUNhc2VBY3Rpb25DbHVzdGVyczoge1xuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIFxcKiAqL1xuICAgICAgMTogNSxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIFxcLyAqL1xuICAgICAgMjogNixcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIFxcKyAqL1xuICAgICAgMzogMyxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIC0gKi9cbiAgICAgIDQ6IDQsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylweFxcYiAqL1xuICAgICAgNTogMTMsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyljbVxcYiAqL1xuICAgICAgNjogMTMsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyltbVxcYiAqL1xuICAgICAgNzogMTMsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylpblxcYiAqL1xuICAgICAgODogMTMsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylwdFxcYiAqL1xuICAgICAgOTogMTMsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylwY1xcYiAqL1xuICAgICAgMTA6IDEzLFxuXG4gICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgIC8qISBSdWxlOjogICAgICAgKFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspZGVnXFxiICovXG4gICAgICAxMTogMTQsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylncmFkXFxiICovXG4gICAgICAxMjogMTQsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylyYWRcXGIgKi9cbiAgICAgIDEzOiAxNCxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXR1cm5cXGIgKi9cbiAgICAgIDE0OiAxNCxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXNcXGIgKi9cbiAgICAgIDE1OiAxNSxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKW1zXFxiICovXG4gICAgICAxNjogMTUsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylIelxcYiAqL1xuICAgICAgMTc6IDE2LFxuXG4gICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgIC8qISBSdWxlOjogICAgICAgKFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspa0h6XFxiICovXG4gICAgICAxODogMTYsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylkcGlcXGIgKi9cbiAgICAgIDE5OiAxNyxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWRwY21cXGIgKi9cbiAgICAgIDIwOiAxNyxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWRwcHhcXGIgKi9cbiAgICAgIDIxOiAxNyxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKWVtXFxiICovXG4gICAgICAyMjogMTgsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylleFxcYiAqL1xuICAgICAgMjM6IDE5LFxuXG4gICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgIC8qISBSdWxlOjogICAgICAgKFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspY2hcXGIgKi9cbiAgICAgIDI0OiAyMCxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXJlbVxcYiAqL1xuICAgICAgMjU6IDIxLFxuXG4gICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgIC8qISBSdWxlOjogICAgICAgKFswLTldKyhcXC5bMC05XSopP3xcXC5bMC05XSspdndcXGIgKi9cbiAgICAgIDI2OiAyMyxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbMC05XSsoXFwuWzAtOV0qKT98XFwuWzAtOV0rKXZoXFxiICovXG4gICAgICAyNzogMjIsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyl2bWluXFxiICovXG4gICAgICAyODogMjQsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyl2bWF4XFxiICovXG4gICAgICAyOTogMjUsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKyklICovXG4gICAgICAzMDogMjYsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAoWzAtOV0rKFxcLlswLTldKik/fFxcLlswLTldKylcXGIgKi9cbiAgICAgIDMxOiAxMSxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChjYWxjKSAqL1xuICAgICAgMzI6IDksXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICAodmFyXFwoW15cXCldKlxcKSkgKi9cbiAgICAgIDMzOiAxMixcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgIChbYS16XSspICovXG4gICAgICAzNDogMTAsXG5cbiAgICAgIC8qISBDb25kaXRpb25zOjogSU5JVElBTCAqL1xuICAgICAgLyohIFJ1bGU6OiAgICAgICBcXCggKi9cbiAgICAgIDM1OiA3LFxuXG4gICAgICAvKiEgQ29uZGl0aW9uczo6IElOSVRJQUwgKi9cbiAgICAgIC8qISBSdWxlOjogICAgICAgXFwpICovXG4gICAgICAzNjogOCxcblxuICAgICAgLyohIENvbmRpdGlvbnM6OiBJTklUSUFMICovXG4gICAgICAvKiEgUnVsZTo6ICAgICAgICQgKi9cbiAgICAgIDM3OiAxXG4gICAgfSxcblxuICAgIHJ1bGVzOiBbXG4gICAgICAvKiAgMDogKi8gIC9eKD86XFxzKykvLFxuICAgICAgLyogIDE6ICovICAvXig/OlxcKikvLFxuICAgICAgLyogIDI6ICovICAvXig/OlxcLykvLFxuICAgICAgLyogIDM6ICovICAvXig/OlxcKykvLFxuICAgICAgLyogIDQ6ICovICAvXig/Oi0pLyxcbiAgICAgIC8qICA1OiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKylweFxcYikvLFxuICAgICAgLyogIDY6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKWNtXFxiKS8sXG4gICAgICAvKiAgNzogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspbW1cXGIpLyxcbiAgICAgIC8qICA4OiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKylpblxcYikvLFxuICAgICAgLyogIDk6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKXB0XFxiKS8sXG4gICAgICAvKiAxMDogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspcGNcXGIpLyxcbiAgICAgIC8qIDExOiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKylkZWdcXGIpLyxcbiAgICAgIC8qIDEyOiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKylncmFkXFxiKS8sXG4gICAgICAvKiAxMzogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspcmFkXFxiKS8sXG4gICAgICAvKiAxNDogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspdHVyblxcYikvLFxuICAgICAgLyogMTU6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKXNcXGIpLyxcbiAgICAgIC8qIDE2OiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKyltc1xcYikvLFxuICAgICAgLyogMTc6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKUh6XFxiKS8sXG4gICAgICAvKiAxODogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspa0h6XFxiKS8sXG4gICAgICAvKiAxOTogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspZHBpXFxiKS8sXG4gICAgICAvKiAyMDogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspZHBjbVxcYikvLFxuICAgICAgLyogMjE6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKWRwcHhcXGIpLyxcbiAgICAgIC8qIDIyOiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKyllbVxcYikvLFxuICAgICAgLyogMjM6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKWV4XFxiKS8sXG4gICAgICAvKiAyNDogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspY2hcXGIpLyxcbiAgICAgIC8qIDI1OiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKylyZW1cXGIpLyxcbiAgICAgIC8qIDI2OiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKyl2d1xcYikvLFxuICAgICAgLyogMjc6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKXZoXFxiKS8sXG4gICAgICAvKiAyODogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspdm1pblxcYikvLFxuICAgICAgLyogMjk6ICovICAvXig/OihcXGQrKFxcLlxcZCopP3xcXC5cXGQrKXZtYXhcXGIpLyxcbiAgICAgIC8qIDMwOiAqLyAgL14oPzooXFxkKyhcXC5cXGQqKT98XFwuXFxkKyklKS8sXG4gICAgICAvKiAzMTogKi8gIC9eKD86KFxcZCsoXFwuXFxkKik/fFxcLlxcZCspXFxiKS8sXG4gICAgICAvKiAzMjogKi8gIC9eKD86KGNhbGMpKS8sXG4gICAgICAvKiAzMzogKi8gIC9eKD86KHZhclxcKFteKV0qXFwpKSkvLFxuICAgICAgLyogMzQ6ICovICAvXig/OihbYS16XSspKS8sXG4gICAgICAvKiAzNTogKi8gIC9eKD86XFwoKS8sXG4gICAgICAvKiAzNjogKi8gIC9eKD86XFwpKS8sXG4gICAgICAvKiAzNzogKi8gIC9eKD86JCkvXG4gICAgXSxcblxuICAgIGNvbmRpdGlvbnM6IHtcbiAgICAgICdJTklUSUFMJzoge1xuICAgICAgICBydWxlczogW1xuICAgICAgICAgIDAsXG4gICAgICAgICAgMSxcbiAgICAgICAgICAyLFxuICAgICAgICAgIDMsXG4gICAgICAgICAgNCxcbiAgICAgICAgICA1LFxuICAgICAgICAgIDYsXG4gICAgICAgICAgNyxcbiAgICAgICAgICA4LFxuICAgICAgICAgIDksXG4gICAgICAgICAgMTAsXG4gICAgICAgICAgMTEsXG4gICAgICAgICAgMTIsXG4gICAgICAgICAgMTMsXG4gICAgICAgICAgMTQsXG4gICAgICAgICAgMTUsXG4gICAgICAgICAgMTYsXG4gICAgICAgICAgMTcsXG4gICAgICAgICAgMTgsXG4gICAgICAgICAgMTksXG4gICAgICAgICAgMjAsXG4gICAgICAgICAgMjEsXG4gICAgICAgICAgMjIsXG4gICAgICAgICAgMjMsXG4gICAgICAgICAgMjQsXG4gICAgICAgICAgMjUsXG4gICAgICAgICAgMjYsXG4gICAgICAgICAgMjcsXG4gICAgICAgICAgMjgsXG4gICAgICAgICAgMjksXG4gICAgICAgICAgMzAsXG4gICAgICAgICAgMzEsXG4gICAgICAgICAgMzIsXG4gICAgICAgICAgMzMsXG4gICAgICAgICAgMzQsXG4gICAgICAgICAgMzUsXG4gICAgICAgICAgMzYsXG4gICAgICAgICAgMzdcbiAgICAgICAgXSxcblxuICAgICAgICBpbmNsdXNpdmU6IHRydWVcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIGxleGVyO1xufSgpO1xucGFyc2VyLmxleGVyID0gbGV4ZXI7XG5cblxuXG5mdW5jdGlvbiBQYXJzZXIoKSB7XG4gIHRoaXMueXkgPSB7fTtcbn1cblBhcnNlci5wcm90b3R5cGUgPSBwYXJzZXI7XG5wYXJzZXIuUGFyc2VyID0gUGFyc2VyO1xuXG5yZXR1cm4gbmV3IFBhcnNlcigpO1xufSkoKTtcblxuICAgICAgICBcblxuXG5pZiAodHlwZW9mIHJlcXVpcmUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICBleHBvcnRzLnBhcnNlciA9IHBhcnNlcjtcbiAgZXhwb3J0cy5QYXJzZXIgPSBwYXJzZXIuUGFyc2VyO1xuICBleHBvcnRzLnBhcnNlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBwYXJzZXIucGFyc2UuYXBwbHkocGFyc2VyLCBhcmd1bWVudHMpO1xuICB9O1xuICBcbn1cbiIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi9nbG9iYWxzXCIpO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi9kYXRhL29ic2VydmFibGVcIik7XG5leHBvcnRzLk9ic2VydmFibGUgPSBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi9wcm9maWxpbmdcIik7XG52YXIgZXZlbnRzID0gbmV3IG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKCk7XG52YXIgbGF1bmNoZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIHNldExhdW5jaGVkKCkge1xuICAgIGxhdW5jaGVkID0gdHJ1ZTtcbiAgICBldmVudHMub2ZmKFwibGF1bmNoXCIsIHNldExhdW5jaGVkKTtcbn1cbmV2ZW50cy5vbihcImxhdW5jaFwiLCBzZXRMYXVuY2hlZCk7XG5pZiAocHJvZmlsaW5nXzEubGV2ZWwoKSA+IDApIHtcbiAgICBldmVudHMub24oXCJkaXNwbGF5ZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZHVyYXRpb24gPSBwcm9maWxpbmdfMS51cHRpbWUoKTtcbiAgICAgICAgdmFyIGVuZCA9IHByb2ZpbGluZ18xLnRpbWUoKTtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZW5kIC0gZHVyYXRpb247XG4gICAgICAgIHByb2ZpbGluZ18xLnRyYWNlKFwiRGlzcGxheWVkIGluIFwiICsgZHVyYXRpb24udG9GaXhlZCgyKSArIFwibXNcIiwgc3RhcnQsIGVuZCk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBoYXNMYXVuY2hlZCgpIHtcbiAgICByZXR1cm4gbGF1bmNoZWQ7XG59XG5leHBvcnRzLmhhc0xhdW5jaGVkID0gaGFzTGF1bmNoZWQ7XG52YXIgc3lzdGVtX2NsYXNzZXNfMSA9IHJlcXVpcmUoXCIuLi9jc3Mvc3lzdGVtLWNsYXNzZXNcIik7XG52YXIgZW51bXNfMSA9IHJlcXVpcmUoXCIuLi91aS9lbnVtcy9lbnVtc1wiKTtcbmV4cG9ydHMubGF1bmNoRXZlbnQgPSBcImxhdW5jaFwiO1xuZXhwb3J0cy5zdXNwZW5kRXZlbnQgPSBcInN1c3BlbmRcIjtcbmV4cG9ydHMuZGlzcGxheWVkRXZlbnQgPSBcImRpc3BsYXllZFwiO1xuZXhwb3J0cy5yZXN1bWVFdmVudCA9IFwicmVzdW1lXCI7XG5leHBvcnRzLmV4aXRFdmVudCA9IFwiZXhpdFwiO1xuZXhwb3J0cy5sb3dNZW1vcnlFdmVudCA9IFwibG93TWVtb3J5XCI7XG5leHBvcnRzLnVuY2F1Z2h0RXJyb3JFdmVudCA9IFwidW5jYXVnaHRFcnJvclwiO1xuZXhwb3J0cy5kaXNjYXJkZWRFcnJvckV2ZW50ID0gXCJkaXNjYXJkZWRFcnJvclwiO1xuZXhwb3J0cy5vcmllbnRhdGlvbkNoYW5nZWRFdmVudCA9IFwib3JpZW50YXRpb25DaGFuZ2VkXCI7XG52YXIgT1JJRU5UQVRJT05fQ1NTX0NMQVNTRVMgPSBbXG4gICAgXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgZW51bXNfMS5EZXZpY2VPcmllbnRhdGlvbi5wb3J0cmFpdCxcbiAgICBcIlwiICsgc3lzdGVtX2NsYXNzZXNfMS5DTEFTU19QUkVGSVggKyBlbnVtc18xLkRldmljZU9yaWVudGF0aW9uLmxhbmRzY2FwZSxcbiAgICBcIlwiICsgc3lzdGVtX2NsYXNzZXNfMS5DTEFTU19QUkVGSVggKyBlbnVtc18xLkRldmljZU9yaWVudGF0aW9uLnVua25vd25cbl07XG52YXIgY3NzRmlsZSA9IFwiLi9hcHAuY3NzXCI7XG52YXIgcmVzb3VyY2VzID0ge307XG5mdW5jdGlvbiBnZXRSZXNvdXJjZXMoKSB7XG4gICAgcmV0dXJuIHJlc291cmNlcztcbn1cbmV4cG9ydHMuZ2V0UmVzb3VyY2VzID0gZ2V0UmVzb3VyY2VzO1xuZnVuY3Rpb24gc2V0UmVzb3VyY2VzKHJlcykge1xuICAgIHJlc291cmNlcyA9IHJlcztcbn1cbmV4cG9ydHMuc2V0UmVzb3VyY2VzID0gc2V0UmVzb3VyY2VzO1xuZXhwb3J0cy5hbmRyb2lkID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5pb3MgPSB1bmRlZmluZWQ7XG5leHBvcnRzLm9uID0gZXZlbnRzLm9uLmJpbmQoZXZlbnRzKTtcbmV4cG9ydHMub2ZmID0gZXZlbnRzLm9mZi5iaW5kKGV2ZW50cyk7XG5leHBvcnRzLm5vdGlmeSA9IGV2ZW50cy5ub3RpZnkuYmluZChldmVudHMpO1xuZXhwb3J0cy5oYXNMaXN0ZW5lcnMgPSBldmVudHMuaGFzTGlzdGVuZXJzLmJpbmQoZXZlbnRzKTtcbnZhciBhcHA7XG5mdW5jdGlvbiBzZXRBcHBsaWNhdGlvbihpbnN0YW5jZSkge1xuICAgIGFwcCA9IGluc3RhbmNlO1xufVxuZXhwb3J0cy5zZXRBcHBsaWNhdGlvbiA9IHNldEFwcGxpY2F0aW9uO1xuZnVuY3Rpb24gbGl2ZXN5bmMocm9vdFZpZXcsIGNvbnRleHQpIHtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBcImxpdmVzeW5jXCIsIG9iamVjdDogYXBwIH0pO1xuICAgIHZhciBsaXZlU3luY0NvcmUgPSBnbG9iYWwuX19vbkxpdmVTeW5jQ29yZTtcbiAgICB2YXIgcmVhcHBseUFwcFN0eWxlcyA9IGZhbHNlO1xuICAgIGlmIChjb250ZXh0ICYmIGNvbnRleHQucGF0aCkge1xuICAgICAgICB2YXIgc3R5bGVFeHRlbnNpb25zID0gW1wiY3NzXCIsIFwic2Nzc1wiXTtcbiAgICAgICAgdmFyIGFwcFN0eWxlc0Z1bGxGaWxlTmFtZSA9IGdldENzc0ZpbGVOYW1lKCk7XG4gICAgICAgIHZhciBhcHBTdHlsZXNGaWxlTmFtZV8xID0gYXBwU3R5bGVzRnVsbEZpbGVOYW1lLnN1YnN0cmluZygwLCBhcHBTdHlsZXNGdWxsRmlsZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG4gICAgICAgIHJlYXBwbHlBcHBTdHlsZXMgPSBzdHlsZUV4dGVuc2lvbnMuc29tZShmdW5jdGlvbiAoZXh0KSB7IHJldHVybiBjb250ZXh0LnBhdGggPT09IGFwcFN0eWxlc0ZpbGVOYW1lXzEuY29uY2F0KGV4dCk7IH0pO1xuICAgIH1cbiAgICBpZiAocm9vdFZpZXcgJiYgcmVhcHBseUFwcFN0eWxlcykge1xuICAgICAgICByb290Vmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChsaXZlU3luY0NvcmUpIHtcbiAgICAgICAgbGl2ZVN5bmNDb3JlKGNvbnRleHQpO1xuICAgIH1cbn1cbmV4cG9ydHMubGl2ZXN5bmMgPSBsaXZlc3luYztcbmZ1bmN0aW9uIHNldENzc0ZpbGVOYW1lKGNzc0ZpbGVOYW1lKSB7XG4gICAgY3NzRmlsZSA9IGNzc0ZpbGVOYW1lO1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IFwiY3NzQ2hhbmdlZFwiLCBvYmplY3Q6IGFwcCwgY3NzRmlsZTogY3NzRmlsZU5hbWUgfSk7XG59XG5leHBvcnRzLnNldENzc0ZpbGVOYW1lID0gc2V0Q3NzRmlsZU5hbWU7XG5mdW5jdGlvbiBnZXRDc3NGaWxlTmFtZSgpIHtcbiAgICByZXR1cm4gY3NzRmlsZTtcbn1cbmV4cG9ydHMuZ2V0Q3NzRmlsZU5hbWUgPSBnZXRDc3NGaWxlTmFtZTtcbmZ1bmN0aW9uIGxvYWRBcHBDc3MoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJsb2FkQXBwQ3NzXCIsIG9iamVjdDogYXBwLCBjc3NGaWxlOiBnZXRDc3NGaWxlTmFtZSgpIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgZmlsZSBcIiArIGdldENzc0ZpbGVOYW1lKCkgKyBcIiBjb3VsZG4ndCBiZSBsb2FkZWQhIFwiICtcbiAgICAgICAgICAgIFwiWW91IG1heSBuZWVkIHRvIHJlZ2lzdGVyIGl0IGluc2lkZSAuL2FwcC92ZW5kb3IudHMuXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMubG9hZEFwcENzcyA9IGxvYWRBcHBDc3M7XG5mdW5jdGlvbiBvcmllbnRhdGlvbkNoYW5nZWQocm9vdFZpZXcsIG5ld09yaWVudGF0aW9uKSB7XG4gICAgdmFyIG5ld09yaWVudGF0aW9uQ3NzQ2xhc3MgPSBcIlwiICsgc3lzdGVtX2NsYXNzZXNfMS5DTEFTU19QUkVGSVggKyBuZXdPcmllbnRhdGlvbjtcbiAgICBpZiAoIXJvb3RWaWV3LmNzc0NsYXNzZXMuaGFzKG5ld09yaWVudGF0aW9uQ3NzQ2xhc3MpKSB7XG4gICAgICAgIHZhciByZW1vdmVDc3NDbGFzc18xID0gZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHN5c3RlbV9jbGFzc2VzXzEucmVtb3ZlRnJvbVJvb3RWaWV3Q3NzQ2xhc3NlcyhjKTtcbiAgICAgICAgICAgIHJvb3RWaWV3LmNzc0NsYXNzZXMuZGVsZXRlKGMpO1xuICAgICAgICB9O1xuICAgICAgICBPUklFTlRBVElPTl9DU1NfQ0xBU1NFUy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7IHJldHVybiByZW1vdmVDc3NDbGFzc18xKGMpOyB9KTtcbiAgICAgICAgc3lzdGVtX2NsYXNzZXNfMS5wdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXMobmV3T3JpZW50YXRpb25Dc3NDbGFzcyk7XG4gICAgICAgIHJvb3RWaWV3LmNzc0NsYXNzZXMuYWRkKG5ld09yaWVudGF0aW9uQ3NzQ2xhc3MpO1xuICAgICAgICByb290Vmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgIH1cbn1cbmV4cG9ydHMub3JpZW50YXRpb25DaGFuZ2VkID0gb3JpZW50YXRpb25DaGFuZ2VkO1xuZ2xvYmFsLl9fb25VbmNhdWdodEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogZXhwb3J0cy51bmNhdWdodEVycm9yRXZlbnQsIG9iamVjdDogYXBwLCBhbmRyb2lkOiBlcnJvciwgaW9zOiBlcnJvciwgZXJyb3I6IGVycm9yIH0pO1xufTtcbmdsb2JhbC5fX29uRGlzY2FyZGVkRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBleHBvcnRzLmRpc2NhcmRlZEVycm9yRXZlbnQsIG9iamVjdDogYXBwLCBlcnJvcjogZXJyb3IgfSk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXBwbGljYXRpb25fY29tbW9uXzEgPSByZXF1aXJlKFwiLi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYXBwbGljYXRpb24tY29tbW9uXCIpKTtcbnZhciBBY3Rpdml0eUNyZWF0ZWQgPSBcImFjdGl2aXR5Q3JlYXRlZFwiO1xudmFyIEFjdGl2aXR5RGVzdHJveWVkID0gXCJhY3Rpdml0eURlc3Ryb3llZFwiO1xudmFyIEFjdGl2aXR5U3RhcnRlZCA9IFwiYWN0aXZpdHlTdGFydGVkXCI7XG52YXIgQWN0aXZpdHlQYXVzZWQgPSBcImFjdGl2aXR5UGF1c2VkXCI7XG52YXIgQWN0aXZpdHlSZXN1bWVkID0gXCJhY3Rpdml0eVJlc3VtZWRcIjtcbnZhciBBY3Rpdml0eVN0b3BwZWQgPSBcImFjdGl2aXR5U3RvcHBlZFwiO1xudmFyIFNhdmVBY3Rpdml0eVN0YXRlID0gXCJzYXZlQWN0aXZpdHlTdGF0ZVwiO1xudmFyIEFjdGl2aXR5UmVzdWx0ID0gXCJhY3Rpdml0eVJlc3VsdFwiO1xudmFyIEFjdGl2aXR5QmFja1ByZXNzZWQgPSBcImFjdGl2aXR5QmFja1ByZXNzZWRcIjtcbnZhciBBY3Rpdml0eU5ld0ludGVudCA9IFwiYWN0aXZpdHlOZXdJbnRlbnRcIjtcbnZhciBBY3Rpdml0eVJlcXVlc3RQZXJtaXNzaW9ucyA9IFwiYWN0aXZpdHlSZXF1ZXN0UGVybWlzc2lvbnNcIjtcbnZhciBBbmRyb2lkQXBwbGljYXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBbmRyb2lkQXBwbGljYXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5kcm9pZEFwcGxpY2F0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY2FsbGJhY2tzID0ge307XG4gICAgICAgIF90aGlzLl9yZWdpc3RlcmVkUmVjZWl2ZXJzID0ge307XG4gICAgICAgIF90aGlzLl9wZW5kaW5nUmVjZWl2ZXJSZWdpc3RyYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKG5hdGl2ZUFwcCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVBcHAgPT09IG5hdGl2ZUFwcCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZUFwcCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYXBwbGljYXRpb24uYW5kcm9pZCBhbHJlYWR5IGluaXRpYWxpemVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZUFwcCA9IG5hdGl2ZUFwcDtcbiAgICAgICAgdGhpcy5wYWNrYWdlTmFtZSA9IG5hdGl2ZUFwcC5nZXRQYWNrYWdlTmFtZSgpO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBuYXRpdmVBcHAuZ2V0QXBwbGljYXRpb25Db250ZXh0KCk7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmxpZmVjeWNsZUNhbGxiYWNrcyA9IGluaXRMaWZlY3ljbGVDYWxsYmFja3MoKTtcbiAgICAgICAgdGhpcy5jYWxsYmFja3MuY29tcG9uZW50Q2FsbGJhY2tzID0gaW5pdENvbXBvbmVudENhbGxiYWNrcygpO1xuICAgICAgICB0aGlzLm5hdGl2ZUFwcC5yZWdpc3RlckFjdGl2aXR5TGlmZWN5Y2xlQ2FsbGJhY2tzKHRoaXMuY2FsbGJhY2tzLmxpZmVjeWNsZUNhbGxiYWNrcyk7XG4gICAgICAgIHRoaXMubmF0aXZlQXBwLnJlZ2lzdGVyQ29tcG9uZW50Q2FsbGJhY2tzKHRoaXMuY2FsbGJhY2tzLmNvbXBvbmVudENhbGxiYWNrcyk7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyUGVuZGluZ1JlY2VpdmVycygpO1xuICAgIH07XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLnByb3RvdHlwZS5fcmVnaXN0ZXJQZW5kaW5nUmVjZWl2ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9wZW5kaW5nUmVjZWl2ZXJSZWdpc3RyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGZ1bmMpIHsgcmV0dXJuIGZ1bmMoX3RoaXMuY29udGV4dCk7IH0pO1xuICAgICAgICB0aGlzLl9wZW5kaW5nUmVjZWl2ZXJSZWdpc3RyYXRpb25zLmxlbmd0aCA9IDA7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5kcm9pZEFwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJvcmllbnRhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vcmllbnRhdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZXMgPSB0aGlzLmNvbnRleHQuZ2V0UmVzb3VyY2VzKCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ3VyYXRpb24gPSByZXNvdXJjZXMuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgICAgICAgICAgICAgIHZhciBvcmllbnRhdGlvbl8xID0gY29uZmlndXJhdGlvbi5vcmllbnRhdGlvbjtcbiAgICAgICAgICAgICAgICB0aGlzLl9vcmllbnRhdGlvbiA9IGdldE9yaWVudGF0aW9uVmFsdWUob3JpZW50YXRpb25fMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3JpZW50YXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9vcmllbnRhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24ucHJvdG90eXBlLnJlZ2lzdGVyQnJvYWRjYXN0UmVjZWl2ZXIgPSBmdW5jdGlvbiAoaW50ZW50RmlsdGVyLCBvblJlY2VpdmVDYWxsYmFjaykge1xuICAgICAgICBlbnN1cmVCcm9hZENhc3RSZWNlaXZlckNsYXNzKCk7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIHJlZ2lzdGVyRnVuYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgcmVjZWl2ZXIgPSBuZXcgQnJvYWRjYXN0UmVjZWl2ZXJDbGFzcyhvblJlY2VpdmVDYWxsYmFjayk7XG4gICAgICAgICAgICBjb250ZXh0LnJlZ2lzdGVyUmVjZWl2ZXIocmVjZWl2ZXIsIG5ldyBhbmRyb2lkLmNvbnRlbnQuSW50ZW50RmlsdGVyKGludGVudEZpbHRlcikpO1xuICAgICAgICAgICAgdGhhdC5fcmVnaXN0ZXJlZFJlY2VpdmVyc1tpbnRlbnRGaWx0ZXJdID0gcmVjZWl2ZXI7XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0aGlzLmNvbnRleHQpIHtcbiAgICAgICAgICAgIHJlZ2lzdGVyRnVuYyh0aGlzLmNvbnRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1JlY2VpdmVyUmVnaXN0cmF0aW9ucy5wdXNoKHJlZ2lzdGVyRnVuYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5wcm90b3R5cGUudW5yZWdpc3RlckJyb2FkY2FzdFJlY2VpdmVyID0gZnVuY3Rpb24gKGludGVudEZpbHRlcikge1xuICAgICAgICB2YXIgcmVjZWl2ZXIgPSB0aGlzLl9yZWdpc3RlcmVkUmVjZWl2ZXJzW2ludGVudEZpbHRlcl07XG4gICAgICAgIGlmIChyZWNlaXZlcikge1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnVucmVnaXN0ZXJSZWNlaXZlcihyZWNlaXZlcik7XG4gICAgICAgICAgICB0aGlzLl9yZWdpc3RlcmVkUmVjZWl2ZXJzW2ludGVudEZpbHRlcl0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fcmVnaXN0ZXJlZFJlY2VpdmVyc1tpbnRlbnRGaWx0ZXJdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlDcmVhdGVkRXZlbnQgPSBBY3Rpdml0eUNyZWF0ZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5RGVzdHJveWVkRXZlbnQgPSBBY3Rpdml0eURlc3Ryb3llZDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlTdGFydGVkRXZlbnQgPSBBY3Rpdml0eVN0YXJ0ZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5UGF1c2VkRXZlbnQgPSBBY3Rpdml0eVBhdXNlZDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlSZXN1bWVkRXZlbnQgPSBBY3Rpdml0eVJlc3VtZWQ7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5U3RvcHBlZEV2ZW50ID0gQWN0aXZpdHlTdG9wcGVkO1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5zYXZlQWN0aXZpdHlTdGF0ZUV2ZW50ID0gU2F2ZUFjdGl2aXR5U3RhdGU7XG4gICAgQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5UmVzdWx0RXZlbnQgPSBBY3Rpdml0eVJlc3VsdDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlCYWNrUHJlc3NlZEV2ZW50ID0gQWN0aXZpdHlCYWNrUHJlc3NlZDtcbiAgICBBbmRyb2lkQXBwbGljYXRpb24uYWN0aXZpdHlOZXdJbnRlbnRFdmVudCA9IEFjdGl2aXR5TmV3SW50ZW50O1xuICAgIEFuZHJvaWRBcHBsaWNhdGlvbi5hY3Rpdml0eVJlcXVlc3RQZXJtaXNzaW9uc0V2ZW50ID0gQWN0aXZpdHlSZXF1ZXN0UGVybWlzc2lvbnM7XG4gICAgcmV0dXJuIEFuZHJvaWRBcHBsaWNhdGlvbjtcbn0oYXBwbGljYXRpb25fY29tbW9uXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5BbmRyb2lkQXBwbGljYXRpb24gPSBBbmRyb2lkQXBwbGljYXRpb247XG52YXIgYW5kcm9pZEFwcCA9IG5ldyBBbmRyb2lkQXBwbGljYXRpb24oKTtcbmV4cG9ydHMuYW5kcm9pZCA9IGFuZHJvaWRBcHA7XG5hcHBsaWNhdGlvbl9jb21tb25fMS5zZXRBcHBsaWNhdGlvbihhbmRyb2lkQXBwKTtcbnZhciBtYWluRW50cnk7XG52YXIgc3RhcnRlZCA9IGZhbHNlO1xudmFyIGNyZWF0ZVJvb3RGcmFtZSA9IHsgdmFsdWU6IHRydWUgfTtcbmZ1bmN0aW9uIF9zdGFydChlbnRyeSkge1xuICAgIGlmIChzdGFydGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFwcGxpY2F0aW9uIGlzIGFscmVhZHkgc3RhcnRlZC5cIik7XG4gICAgfVxuICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgIG1haW5FbnRyeSA9IHR5cGVvZiBlbnRyeSA9PT0gXCJzdHJpbmdcIiA/IHsgbW9kdWxlTmFtZTogZW50cnkgfSA6IGVudHJ5O1xuICAgIGlmICghYW5kcm9pZEFwcC5uYXRpdmVBcHApIHtcbiAgICAgICAgdmFyIG5hdGl2ZUFwcCA9IGdldE5hdGl2ZUFwcGxpY2F0aW9uKCk7XG4gICAgICAgIGFuZHJvaWRBcHAuaW5pdChuYXRpdmVBcHApO1xuICAgIH1cbn1cbmV4cG9ydHMuX3N0YXJ0ID0gX3N0YXJ0O1xuZnVuY3Rpb24gX3Nob3VsZENyZWF0ZVJvb3RGcmFtZSgpIHtcbiAgICByZXR1cm4gY3JlYXRlUm9vdEZyYW1lLnZhbHVlO1xufVxuZXhwb3J0cy5fc2hvdWxkQ3JlYXRlUm9vdEZyYW1lID0gX3Nob3VsZENyZWF0ZVJvb3RGcmFtZTtcbmZ1bmN0aW9uIHJ1bihlbnRyeSkge1xuICAgIGNyZWF0ZVJvb3RGcmFtZS52YWx1ZSA9IGZhbHNlO1xuICAgIF9zdGFydChlbnRyeSk7XG59XG5leHBvcnRzLnJ1biA9IHJ1bjtcbmZ1bmN0aW9uIGFkZENzcyhjc3NUZXh0LCBhdHRyaWJ1dGVTY29wZWQpIHtcbiAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IFwiY3NzQ2hhbmdlZFwiLCBvYmplY3Q6IGFuZHJvaWRBcHAsIGNzc1RleHQ6IGNzc1RleHQgfSk7XG4gICAgaWYgKCFhdHRyaWJ1dGVTY29wZWQpIHtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gZ2V0Um9vdFZpZXcoKTtcbiAgICAgICAgaWYgKHJvb3RWaWV3KSB7XG4gICAgICAgICAgICByb290Vmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5hZGRDc3MgPSBhZGRDc3M7XG52YXIgQ0FMTEJBQ0tTID0gXCJfY2FsbGJhY2tzXCI7XG5mdW5jdGlvbiBfcmVzZXRSb290VmlldyhlbnRyeSkge1xuICAgIHZhciBhY3Rpdml0eSA9IGFuZHJvaWRBcHAuZm9yZWdyb3VuZEFjdGl2aXR5O1xuICAgIGlmICghYWN0aXZpdHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgYW5kcm9pZCBhY3Rpdml0eS5cIik7XG4gICAgfVxuICAgIGNyZWF0ZVJvb3RGcmFtZS52YWx1ZSA9IGZhbHNlO1xuICAgIG1haW5FbnRyeSA9IHR5cGVvZiBlbnRyeSA9PT0gXCJzdHJpbmdcIiA/IHsgbW9kdWxlTmFtZTogZW50cnkgfSA6IGVudHJ5O1xuICAgIHZhciBjYWxsYmFja3MgPSBhY3Rpdml0eVtDQUxMQkFDS1NdO1xuICAgIGlmICghY2FsbGJhY2tzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGFuZHJvaWQgYWN0aXZpdHkgY2FsbGJhY2tzLlwiKTtcbiAgICB9XG4gICAgY2FsbGJhY2tzLnJlc2V0QWN0aXZpdHlDb250ZW50KGFjdGl2aXR5KTtcbn1cbmV4cG9ydHMuX3Jlc2V0Um9vdFZpZXcgPSBfcmVzZXRSb290VmlldztcbmZ1bmN0aW9uIGdldE1haW5FbnRyeSgpIHtcbiAgICByZXR1cm4gbWFpbkVudHJ5O1xufVxuZXhwb3J0cy5nZXRNYWluRW50cnkgPSBnZXRNYWluRW50cnk7XG5mdW5jdGlvbiBnZXRSb290VmlldygpIHtcbiAgICB2YXIgYWN0aXZpdHkgPSBhbmRyb2lkQXBwLmZvcmVncm91bmRBY3Rpdml0eSB8fCBhbmRyb2lkQXBwLnN0YXJ0QWN0aXZpdHk7XG4gICAgaWYgKCFhY3Rpdml0eSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB2YXIgY2FsbGJhY2tzID0gYWN0aXZpdHlbQ0FMTEJBQ0tTXTtcbiAgICByZXR1cm4gY2FsbGJhY2tzID8gY2FsbGJhY2tzLmdldFJvb3RWaWV3KCkgOiB1bmRlZmluZWQ7XG59XG5leHBvcnRzLmdldFJvb3RWaWV3ID0gZ2V0Um9vdFZpZXc7XG5mdW5jdGlvbiBnZXROYXRpdmVBcHBsaWNhdGlvbigpIHtcbiAgICB2YXIgbmF0aXZlQXBwID0gYW5kcm9pZEFwcC5uYXRpdmVBcHA7XG4gICAgaWYgKCFuYXRpdmVBcHApIHtcbiAgICAgICAgaWYgKCFuYXRpdmVBcHAgJiYgY29tLnRucy5OYXRpdmVTY3JpcHRBcHBsaWNhdGlvbikge1xuICAgICAgICAgICAgbmF0aXZlQXBwID0gY29tLnRucy5OYXRpdmVTY3JpcHRBcHBsaWNhdGlvbi5nZXRJbnN0YW5jZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbmF0aXZlQXBwKSB7XG4gICAgICAgICAgICB2YXIgY2xhenogPSBqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZShcImFuZHJvaWQuYXBwLkFjdGl2aXR5VGhyZWFkXCIpO1xuICAgICAgICAgICAgaWYgKGNsYXp6KSB7XG4gICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IGNsYXp6LmdldE1ldGhvZChcImN1cnJlbnRBcHBsaWNhdGlvblwiLCBudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAobWV0aG9kKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hdGl2ZUFwcCA9IG1ldGhvZC5pbnZva2UobnVsbCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghbmF0aXZlQXBwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgbmF0aXZlIEFuZHJvaWQgQXBwbGljYXRpb24gb2JqZWN0LiBJZiB5b3UgaGF2ZSBhIGN1c3RvbSBhbmRyb2lkLmFwcC5BcHBsaWNhdGlvbiB0eXBlIGltcGxlbWVudGVkIG1ha2Ugc3VyZSB0aGF0IHlvdSd2ZSBjYWxsZWQgdGhlICc8YXBwbGljYXRpb24tbW9kdWxlPi5hbmRyb2lkLmluaXQnIG1ldGhvZC5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5hdGl2ZUFwcDtcbn1cbmV4cG9ydHMuZ2V0TmF0aXZlQXBwbGljYXRpb24gPSBnZXROYXRpdmVBcHBsaWNhdGlvbjtcbmZ1bmN0aW9uIG9yaWVudGF0aW9uKCkge1xuICAgIHJldHVybiBhbmRyb2lkQXBwLm9yaWVudGF0aW9uO1xufVxuZXhwb3J0cy5vcmllbnRhdGlvbiA9IG9yaWVudGF0aW9uO1xuYXBwbGljYXRpb25fY29tbW9uXzEub24oYXBwbGljYXRpb25fY29tbW9uXzEub3JpZW50YXRpb25DaGFuZ2VkRXZlbnQsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgdmFyIHJvb3RWaWV3ID0gZ2V0Um9vdFZpZXcoKTtcbiAgICBpZiAocm9vdFZpZXcpIHtcbiAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEub3JpZW50YXRpb25DaGFuZ2VkKHJvb3RWaWV3LCBhcmdzLm5ld1ZhbHVlKTtcbiAgICB9XG59KTtcbmdsb2JhbC5fX29uTGl2ZVN5bmMgPSBmdW5jdGlvbiBfX29uTGl2ZVN5bmMoY29udGV4dCkge1xuICAgIGlmIChhbmRyb2lkQXBwICYmIGFuZHJvaWRBcHAucGF1c2VkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJvb3RWaWV3ID0gZ2V0Um9vdFZpZXcoKTtcbiAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5saXZlc3luYyhyb290VmlldywgY29udGV4dCk7XG59O1xuZnVuY3Rpb24gZ2V0T3JpZW50YXRpb25WYWx1ZShvcmllbnRhdGlvbikge1xuICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcbiAgICAgICAgY2FzZSBhbmRyb2lkLmNvbnRlbnQucmVzLkNvbmZpZ3VyYXRpb24uT1JJRU5UQVRJT05fTEFORFNDQVBFOlxuICAgICAgICAgICAgcmV0dXJuIFwibGFuZHNjYXBlXCI7XG4gICAgICAgIGNhc2UgYW5kcm9pZC5jb250ZW50LnJlcy5Db25maWd1cmF0aW9uLk9SSUVOVEFUSU9OX1BPUlRSQUlUOlxuICAgICAgICAgICAgcmV0dXJuIFwicG9ydHJhaXRcIjtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBcInVua25vd25cIjtcbiAgICB9XG59XG5mdW5jdGlvbiBpbml0TGlmZWN5Y2xlQ2FsbGJhY2tzKCkge1xuICAgIHZhciBzZXRUaGVtZU9uTGF1bmNoID0gcHJvZmlsaW5nXzEucHJvZmlsZShcInNldFRoZW1lT25MYXVuY2hcIiwgZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgIHZhciBhY3Rpdml0eUluZm8gPSBhY3Rpdml0eS5nZXRQYWNrYWdlTWFuYWdlcigpLmdldEFjdGl2aXR5SW5mbyhhY3Rpdml0eS5nZXRDb21wb25lbnROYW1lKCksIGFuZHJvaWQuY29udGVudC5wbS5QYWNrYWdlTWFuYWdlci5HRVRfTUVUQV9EQVRBKTtcbiAgICAgICAgaWYgKGFjdGl2aXR5SW5mby5tZXRhRGF0YSkge1xuICAgICAgICAgICAgdmFyIHNldFRoZW1lT25MYXVuY2hfMSA9IGFjdGl2aXR5SW5mby5tZXRhRGF0YS5nZXRJbnQoXCJTRVRfVEhFTUVfT05fTEFVTkNIXCIsIC0xKTtcbiAgICAgICAgICAgIGlmIChzZXRUaGVtZU9uTGF1bmNoXzEgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZpdHkuc2V0VGhlbWUoc2V0VGhlbWVPbkxhdW5jaF8xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHZhciBub3RpZnlBY3Rpdml0eUNyZWF0ZWQgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwibm90aWZ5QWN0aXZpdHlDcmVhdGVkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSwgc2F2ZWRJbnN0YW5jZVN0YXRlKSB7XG4gICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eUNyZWF0ZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5LCBidW5kbGU6IHNhdmVkSW5zdGFuY2VTdGF0ZSB9KTtcbiAgICB9KTtcbiAgICB2YXIgc3Vic2NyaWJlRm9yR2xvYmFsTGF5b3V0ID0gcHJvZmlsaW5nXzEucHJvZmlsZShcInN1YnNjcmliZUZvckdsb2JhbExheW91dFwiLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gYWN0aXZpdHkuZ2V0V2luZG93KCkuZ2V0RGVjb3JWaWV3KCkuZ2V0Um9vdFZpZXcoKTtcbiAgICAgICAgZ2xvYmFsLm9uR2xvYmFsTGF5b3V0TGlzdGVuZXIgPSBuZXcgYW5kcm9pZC52aWV3LlZpZXdUcmVlT2JzZXJ2ZXIuT25HbG9iYWxMYXlvdXRMaXN0ZW5lcih7XG4gICAgICAgICAgICBvbkdsb2JhbExheW91dDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEuZGlzcGxheWVkRXZlbnQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICAgICAgICAgIHZhciB2aWV3VHJlZU9ic2VydmVyID0gcm9vdFZpZXcuZ2V0Vmlld1RyZWVPYnNlcnZlcigpO1xuICAgICAgICAgICAgICAgIHZpZXdUcmVlT2JzZXJ2ZXIucmVtb3ZlT25HbG9iYWxMYXlvdXRMaXN0ZW5lcihnbG9iYWwub25HbG9iYWxMYXlvdXRMaXN0ZW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByb290Vmlldy5nZXRWaWV3VHJlZU9ic2VydmVyKCkuYWRkT25HbG9iYWxMYXlvdXRMaXN0ZW5lcihnbG9iYWwub25HbG9iYWxMYXlvdXRMaXN0ZW5lcik7XG4gICAgfSk7XG4gICAgdmFyIGxpZmVjeWNsZUNhbGxiYWNrcyA9IG5ldyBhbmRyb2lkLmFwcC5BcHBsaWNhdGlvbi5BY3Rpdml0eUxpZmVjeWNsZUNhbGxiYWNrcyh7XG4gICAgICAgIG9uQWN0aXZpdHlDcmVhdGVkOiBwcm9maWxpbmdfMS5wcm9maWxlKFwib25BY3Rpdml0eUNyZWF0ZWRcIiwgZnVuY3Rpb24gKGFjdGl2aXR5LCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHNldFRoZW1lT25MYXVuY2goYWN0aXZpdHkpO1xuICAgICAgICAgICAgaWYgKCFhbmRyb2lkQXBwLnN0YXJ0QWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICBhbmRyb2lkQXBwLnN0YXJ0QWN0aXZpdHkgPSBhY3Rpdml0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vdGlmeUFjdGl2aXR5Q3JlYXRlZChhY3Rpdml0eSwgc2F2ZWRJbnN0YW5jZVN0YXRlKTtcbiAgICAgICAgICAgIGlmIChhcHBsaWNhdGlvbl9jb21tb25fMS5oYXNMaXN0ZW5lcnMoYXBwbGljYXRpb25fY29tbW9uXzEuZGlzcGxheWVkRXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlRm9yR2xvYmFsTGF5b3V0KGFjdGl2aXR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICAgIG9uQWN0aXZpdHlEZXN0cm95ZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5RGVzdHJveWVkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgaWYgKGFjdGl2aXR5ID09PSBhbmRyb2lkQXBwLmZvcmVncm91bmRBY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIGFuZHJvaWRBcHAuZm9yZWdyb3VuZEFjdGl2aXR5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGl2aXR5ID09PSBhbmRyb2lkQXBwLnN0YXJ0QWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICBhbmRyb2lkQXBwLnN0YXJ0QWN0aXZpdHkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmRyb2lkQXBwLm5vdGlmeSh7IGV2ZW50TmFtZTogQWN0aXZpdHlEZXN0cm95ZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICAgICAgZ2MoKTtcbiAgICAgICAgfSksXG4gICAgICAgIG9uQWN0aXZpdHlQYXVzZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5UGF1c2VkXCIsIGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICAgICAgaWYgKGFjdGl2aXR5LmlzTmF0aXZlU2NyaXB0QWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICBhbmRyb2lkQXBwLnBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEubm90aWZ5KHsgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5zdXNwZW5kRXZlbnQsIG9iamVjdDogYW5kcm9pZEFwcCwgYW5kcm9pZDogYWN0aXZpdHkgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmRyb2lkQXBwLm5vdGlmeSh7IGV2ZW50TmFtZTogQWN0aXZpdHlQYXVzZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eVJlc3VtZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5UmVzdW1lZFwiLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgIGFuZHJvaWRBcHAuZm9yZWdyb3VuZEFjdGl2aXR5ID0gYWN0aXZpdHk7XG4gICAgICAgICAgICBhbmRyb2lkQXBwLm5vdGlmeSh7IGV2ZW50TmFtZTogQWN0aXZpdHlSZXN1bWVkLCBvYmplY3Q6IGFuZHJvaWRBcHAsIGFjdGl2aXR5OiBhY3Rpdml0eSB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIG9uQWN0aXZpdHlTYXZlSW5zdGFuY2VTdGF0ZTogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uQWN0aXZpdHlTYXZlSW5zdGFuY2VTdGF0ZVwiLCBmdW5jdGlvbiAoYWN0aXZpdHksIG91dFN0YXRlKSB7XG4gICAgICAgICAgICBhbmRyb2lkQXBwLm5vdGlmeSh7IGV2ZW50TmFtZTogU2F2ZUFjdGl2aXR5U3RhdGUsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5LCBidW5kbGU6IG91dFN0YXRlIH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eVN0YXJ0ZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5U3RhcnRlZFwiLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eVN0YXJ0ZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgb25BY3Rpdml0eVN0b3BwZWQ6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvbkFjdGl2aXR5U3RvcHBlZFwiLCBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgIGFuZHJvaWRBcHAubm90aWZ5KHsgZXZlbnROYW1lOiBBY3Rpdml0eVN0b3BwZWQsIG9iamVjdDogYW5kcm9pZEFwcCwgYWN0aXZpdHk6IGFjdGl2aXR5IH0pO1xuICAgICAgICB9KVxuICAgIH0pO1xuICAgIHJldHVybiBsaWZlY3ljbGVDYWxsYmFja3M7XG59XG5mdW5jdGlvbiBpbml0Q29tcG9uZW50Q2FsbGJhY2tzKCkge1xuICAgIHZhciBjb21wb25lbnRDYWxsYmFja3MgPSBuZXcgYW5kcm9pZC5jb250ZW50LkNvbXBvbmVudENhbGxiYWNrczIoe1xuICAgICAgICBvbkxvd01lbW9yeTogcHJvZmlsaW5nXzEucHJvZmlsZShcIm9uTG93TWVtb3J5XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGdjKCk7XG4gICAgICAgICAgICBqYXZhLmxhbmcuU3lzdGVtLmdjKCk7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLmxvd01lbW9yeUV2ZW50LCBvYmplY3Q6IHRoaXMsIGFuZHJvaWQ6IHRoaXMgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBvblRyaW1NZW1vcnk6IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJvblRyaW1NZW1vcnlcIiwgZnVuY3Rpb24gKGxldmVsKSB7XG4gICAgICAgIH0pLFxuICAgICAgICBvbkNvbmZpZ3VyYXRpb25DaGFuZ2VkOiBwcm9maWxpbmdfMS5wcm9maWxlKFwib25Db25maWd1cmF0aW9uQ2hhbmdlZFwiLCBmdW5jdGlvbiAobmV3Q29uZmlnKSB7XG4gICAgICAgICAgICB2YXIgbmV3Q29uZmlnT3JpZW50YXRpb24gPSBuZXdDb25maWcub3JpZW50YXRpb247XG4gICAgICAgICAgICB2YXIgbmV3T3JpZW50YXRpb24gPSBnZXRPcmllbnRhdGlvblZhbHVlKG5ld0NvbmZpZ09yaWVudGF0aW9uKTtcbiAgICAgICAgICAgIGlmIChhbmRyb2lkQXBwLm9yaWVudGF0aW9uICE9PSBuZXdPcmllbnRhdGlvbikge1xuICAgICAgICAgICAgICAgIGFuZHJvaWRBcHAub3JpZW50YXRpb24gPSBuZXdPcmllbnRhdGlvbjtcbiAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoe1xuICAgICAgICAgICAgICAgICAgICBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLm9yaWVudGF0aW9uQ2hhbmdlZEV2ZW50LFxuICAgICAgICAgICAgICAgICAgICBhbmRyb2lkOiBhbmRyb2lkQXBwLm5hdGl2ZUFwcCxcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWU6IGFuZHJvaWRBcHAub3JpZW50YXRpb24sXG4gICAgICAgICAgICAgICAgICAgIG9iamVjdDogYW5kcm9pZEFwcFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xuICAgIHJldHVybiBjb21wb25lbnRDYWxsYmFja3M7XG59XG52YXIgQnJvYWRjYXN0UmVjZWl2ZXJDbGFzcztcbmZ1bmN0aW9uIGVuc3VyZUJyb2FkQ2FzdFJlY2VpdmVyQ2xhc3MoKSB7XG4gICAgaWYgKEJyb2FkY2FzdFJlY2VpdmVyQ2xhc3MpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgQnJvYWRjYXN0UmVjZWl2ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQnJvYWRjYXN0UmVjZWl2ZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEJyb2FkY2FzdFJlY2VpdmVyKG9uUmVjZWl2ZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuX29uUmVjZWl2ZUNhbGxiYWNrID0gb25SZWNlaXZlQ2FsbGJhY2s7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBCcm9hZGNhc3RSZWNlaXZlci5wcm90b3R5cGUub25SZWNlaXZlID0gZnVuY3Rpb24gKGNvbnRleHQsIGludGVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX29uUmVjZWl2ZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25SZWNlaXZlQ2FsbGJhY2soY29udGV4dCwgaW50ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEJyb2FkY2FzdFJlY2VpdmVyO1xuICAgIH0oYW5kcm9pZC5jb250ZW50LkJyb2FkY2FzdFJlY2VpdmVyKSk7XG4gICAgQnJvYWRjYXN0UmVjZWl2ZXJDbGFzcyA9IEJyb2FkY2FzdFJlY2VpdmVyO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb24uYW5kcm9pZC5qcy5tYXAiLCJpZiAoZ2xvYmFsLlROU19XRUJQQUNLKSB7XG4gICAgcmVxdWlyZShcImdsb2JhbHNcIik7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3RleHQvZm9ybWF0dGVkLXN0cmluZ1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGV4dC9zcGFuXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3RleHQvc3BhblwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvYWN0aW9uLWJhclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9hY3Rpb24tYmFyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9hY3Rpdml0eS1pbmRpY2F0b3JcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvYWN0aXZpdHktaW5kaWNhdG9yXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9ib3JkZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvYm9yZGVyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9ib3R0b20tbmF2aWdhdGlvblwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9ib3R0b20tbmF2aWdhdGlvblwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvYnV0dG9uXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2J1dHRvblwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvY29udGVudC12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2NvbnRlbnQtdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvZGF0ZS1waWNrZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvZGF0ZS1waWNrZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2ZyYW1lXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2ZyYW1lXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9odG1sLXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvaHRtbC12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9pbWFnZVwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9pbWFnZVwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGFiZWxcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGFiZWxcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYXlvdXRzL2RvY2stbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2xheW91dHMvZG9jay1sYXlvdXRcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xheW91dHMvZ3JpZC1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGF5b3V0cy9ncmlkLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9zdGFjay1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGF5b3V0cy9zdGFjay1sYXlvdXRcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xheW91dHMvZmxleGJveC1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvbGF5b3V0cy9mbGV4Ym94LWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy93cmFwLWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9sYXlvdXRzL3dyYXAtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9saXN0LXBpY2tlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9saXN0LXBpY2tlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvcGFnZVwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9wYWdlXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9wbGFjZWhvbGRlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9wbGFjZWhvbGRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvcHJvZ3Jlc3NcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvcHJvZ3Jlc3NcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3Byb3h5LXZpZXctY29udGFpbmVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3Byb3h5LXZpZXctY29udGFpbmVyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9yZXBlYXRlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9yZXBlYXRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvc2Nyb2xsLXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvc2Nyb2xsLXZpZXdcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3NlYXJjaC1iYXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvc2VhcmNoLWJhclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvc2VnbWVudGVkLWJhclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS9zZWdtZW50ZWQtYmFyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zbGlkZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvc2xpZGVyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zd2l0Y2hcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvc3dpdGNoXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWItdmlld1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90YWItdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFic1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90YWJzXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS93ZWItdmlld1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS93ZWItdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGV4dC1maWVsZFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90ZXh0LWZpZWxkXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90ZXh0LXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4vdWkvdGV4dC12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90aW1lLXBpY2tlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi91aS90aW1lLXBpY2tlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGlzdC12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuL3VpL2xpc3Qtdmlld1wiKTsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1idW5kbGUtZW50cnktcG9pbnRzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi91dGlscy90eXBlc1wiKTtcbnZhciBrbm93bkNvbG9ycyA9IHJlcXVpcmUoXCIuL2tub3duLWNvbG9yc1wiKTtcbnZhciBTSEFSUCA9IFwiI1wiO1xudmFyIEhFWF9SRUdFWCA9IC8oXiNbMC05QS1GXXs2fSQpfCheI1swLTlBLUZdezN9JCl8KF4jWzAtOUEtRl17OH0kKS9pO1xudmFyIENvbG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb2xvcigpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcoYXJnKSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1JnYk9yUmdiYShhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSBhcmdiRnJvbVJnYk9yUmdiYShhcmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrbm93bkNvbG9ycy5pc0tub3duTmFtZShhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZXggPSBrbm93bkNvbG9ycy5nZXRLbm93bkNvbG9yKGFyZyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25hbWUgPSBhcmc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSB0aGlzLl9hcmdiRnJvbVN0cmluZyhoZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChIRVhfUkVHRVgudGVzdChhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZXggPSB0aGlzLl9ub3JtYWxpemVIZXgoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IHRoaXMuX2FyZ2JGcm9tU3RyaW5nKGhleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNvbG9yOiBcIiArIGFyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZXMuaXNOdW1iZXIoYXJnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSBhcmcgPj4+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxIG9yIDQgY29uc3RydWN0b3IgcGFyYW1ldGVycy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgdGhpcy5fYXJnYiA9IChhcmd1bWVudHNbMF0gJiAweEZGKSAqIDB4MDEwMDAwMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbMV0gJiAweEZGKSAqIDB4MDAwMTAwMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbMl0gJiAweEZGKSAqIDB4MDAwMDAxMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbM10gJiAweEZGKSAqIDB4MDAwMDAwMDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxIG9yIDQgY29uc3RydWN0b3IgcGFyYW1ldGVycy5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJhXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDEwMDAwMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMTAwMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJnXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMDAxMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJiXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMDAwMDEpICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJhcmdiXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXJnYjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJoZXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmEgPT09IDB4RkYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFwiI1wiICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5yKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuZykgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLmIpKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcIiNcIiArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYSkgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLnIpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5nKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYikpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENvbG9yLnByb3RvdHlwZS5fYXJnYkZyb21TdHJpbmcgPSBmdW5jdGlvbiAoaGV4KSB7XG4gICAgICAgIGlmIChoZXguY2hhckF0KDApID09PSBcIiNcIikge1xuICAgICAgICAgICAgaGV4ID0gaGV4LnN1YnN0cigxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgaGV4ID0gaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIGhleCA9IGhleFswXSArIGhleFswXSArIGhleFsxXSArIGhleFsxXSArIGhleFsyXSArIGhleFsyXSArIGhleFszXSArIGhleFszXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW50VmFsID0gcGFyc2VJbnQoaGV4LCAxNik7XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSA2KSB7XG4gICAgICAgICAgICBpbnRWYWwgPSAoaW50VmFsICYgMHgwMEZGRkZGRikgKyAweEZGMDAwMDAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnRWYWw7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAmJiB0aGlzLmFyZ2IgPT09IHZhbHVlLmFyZ2I7XG4gICAgfTtcbiAgICBDb2xvci5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKCF2YWx1ZTEgJiYgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZTEgfHwgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTEuZXF1YWxzKHZhbHVlMik7XG4gICAgfTtcbiAgICBDb2xvci5pc1ZhbGlkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlcy5pc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgfHwgdmFsdWUgaW5zdGFuY2VvZiBDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0eXBlcy5pc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa25vd25Db2xvcnMuaXNLbm93bk5hbWUodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSEVYX1JFR0VYLnRlc3QodmFsdWUpIHx8IGlzUmdiT3JSZ2JhKHZhbHVlKTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5fY29tcG9uZW50VG9IZXggPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XG4gICAgICAgIHZhciBoZXggPSBjb21wb25lbnQudG9TdHJpbmcoMTYpO1xuICAgICAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgaGV4ID0gXCIwXCIgKyBoZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhleDtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5fbm9ybWFsaXplSGV4ID0gZnVuY3Rpb24gKGhleFN0cikge1xuICAgICAgICBpZiAoaGV4U3RyLmNoYXJBdCgwKSA9PT0gU0hBUlAgJiYgaGV4U3RyLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgaGV4U3RyID0gaGV4U3RyLmNoYXJBdCgwKVxuICAgICAgICAgICAgICAgICsgaGV4U3RyLmNoYXJBdCgxKSArIGhleFN0ci5jaGFyQXQoMSlcbiAgICAgICAgICAgICAgICArIGhleFN0ci5jaGFyQXQoMikgKyBoZXhTdHIuY2hhckF0KDIpXG4gICAgICAgICAgICAgICAgKyBoZXhTdHIuY2hhckF0KDMpICsgaGV4U3RyLmNoYXJBdCgzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGV4U3RyO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oZXg7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sb3I7XG59KCkpO1xuZXhwb3J0cy5Db2xvciA9IENvbG9yO1xuZnVuY3Rpb24gaXNSZ2JPclJnYmEodmFsdWUpIHtcbiAgICB2YXIgdG9Mb3dlciA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuICh0b0xvd2VyLmluZGV4T2YoXCJyZ2IoXCIpID09PSAwIHx8IHRvTG93ZXIuaW5kZXhPZihcInJnYmEoXCIpID09PSAwKSAmJiB0b0xvd2VyLmluZGV4T2YoXCIpXCIpID09PSAodG9Mb3dlci5sZW5ndGggLSAxKTtcbn1cbmZ1bmN0aW9uIGFyZ2JGcm9tUmdiT3JSZ2JhKHZhbHVlKSB7XG4gICAgdmFyIHRvTG93ZXIgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBwYXJ0cyA9IHRvTG93ZXIucmVwbGFjZShcInJnYmEoXCIsIFwiXCIpLnJlcGxhY2UoXCJyZ2IoXCIsIFwiXCIpLnJlcGxhY2UoXCIpXCIsIFwiXCIpLnRyaW0oKS5zcGxpdChcIixcIik7XG4gICAgdmFyIHIgPSAyNTU7XG4gICAgdmFyIGcgPSAyNTU7XG4gICAgdmFyIGIgPSAyNTU7XG4gICAgdmFyIGEgPSAyNTU7XG4gICAgaWYgKHBhcnRzWzBdKSB7XG4gICAgICAgIHIgPSBwYXJzZUludChwYXJ0c1swXS50cmltKCkpO1xuICAgIH1cbiAgICBpZiAocGFydHNbMV0pIHtcbiAgICAgICAgZyA9IHBhcnNlSW50KHBhcnRzWzFdLnRyaW0oKSk7XG4gICAgfVxuICAgIGlmIChwYXJ0c1syXSkge1xuICAgICAgICBiID0gcGFyc2VJbnQocGFydHNbMl0udHJpbSgpKTtcbiAgICB9XG4gICAgaWYgKHBhcnRzWzNdKSB7XG4gICAgICAgIGEgPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQocGFydHNbM10udHJpbSgpKSAqIDI1NSk7XG4gICAgfVxuICAgIHJldHVybiAoYSAmIDB4RkYpICogMHgwMTAwMDAwMFxuICAgICAgICArIChyICYgMHhGRikgKiAweDAwMDEwMDAwXG4gICAgICAgICsgKGcgJiAweEZGKSAqIDB4MDAwMDAxMDBcbiAgICAgICAgKyAoYiAmIDB4RkYpICogMHgwMDAwMDAwMTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbG9yLWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29tbW9uID0gcmVxdWlyZShcIi4vY29sb3ItY29tbW9uXCIpO1xudmFyIENvbG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ29sb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29sb3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcmdiID4+IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBDb2xvcjtcbn0oY29tbW9uLkNvbG9yKSk7XG5leHBvcnRzLkNvbG9yID0gQ29sb3I7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xvci5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBfYWxsQ29sb3JzID0ge307XG5mdW5jdGlvbiByZWdpc3RlckNvbG9yKG5hbWUsIHZhbHVlKSB7XG4gICAgX2FsbENvbG9yc1tuYW1lLnRvTG93ZXJDYXNlKCldID0gdmFsdWU7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gaXNLbm93bk5hbWUobmFtZSkge1xuICAgIGlmICghbmFtZSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpIGluIF9hbGxDb2xvcnM7XG59XG5leHBvcnRzLmlzS25vd25OYW1lID0gaXNLbm93bk5hbWU7XG5mdW5jdGlvbiBnZXRLbm93bkNvbG9yKG5hbWUpIHtcbiAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIF9hbGxDb2xvcnNbbmFtZS50b0xvd2VyQ2FzZSgpXTtcbn1cbmV4cG9ydHMuZ2V0S25vd25Db2xvciA9IGdldEtub3duQ29sb3I7XG5leHBvcnRzLlRyYW5zcGFyZW50ID0gcmVnaXN0ZXJDb2xvcihcIlRyYW5zcGFyZW50XCIsIFwiIzAwMDAwMDAwXCIpO1xuZXhwb3J0cy5BbGljZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiQWxpY2VCbHVlXCIsIFwiI0YwRjhGRlwiKTtcbmV4cG9ydHMuQW50aXF1ZVdoaXRlID0gcmVnaXN0ZXJDb2xvcihcIkFudGlxdWVXaGl0ZVwiLCBcIiNGQUVCRDdcIik7XG5leHBvcnRzLkFxdWEgPSByZWdpc3RlckNvbG9yKFwiQXF1YVwiLCBcIiMwMEZGRkZcIik7XG5leHBvcnRzLkFxdWFtYXJpbmUgPSByZWdpc3RlckNvbG9yKFwiQXF1YW1hcmluZVwiLCBcIiM3RkZGRDRcIik7XG5leHBvcnRzLkF6dXJlID0gcmVnaXN0ZXJDb2xvcihcIkF6dXJlXCIsIFwiI0YwRkZGRlwiKTtcbmV4cG9ydHMuQmVpZ2UgPSByZWdpc3RlckNvbG9yKFwiQmVpZ2VcIiwgXCIjRjVGNURDXCIpO1xuZXhwb3J0cy5CaXNxdWUgPSByZWdpc3RlckNvbG9yKFwiQmlzcXVlXCIsIFwiI0ZGRTRDNFwiKTtcbmV4cG9ydHMuQmxhY2sgPSByZWdpc3RlckNvbG9yKFwiQmxhY2tcIiwgXCIjMDAwMDAwXCIpO1xuZXhwb3J0cy5CbGFuY2hlZEFsbW9uZCA9IHJlZ2lzdGVyQ29sb3IoXCJCbGFuY2hlZEFsbW9uZFwiLCBcIiNGRkVCQ0RcIik7XG5leHBvcnRzLkJsdWUgPSByZWdpc3RlckNvbG9yKFwiQmx1ZVwiLCBcIiMwMDAwRkZcIik7XG5leHBvcnRzLkJsdWVWaW9sZXQgPSByZWdpc3RlckNvbG9yKFwiQmx1ZVZpb2xldFwiLCBcIiM4QTJCRTJcIik7XG5leHBvcnRzLkJyb3duID0gcmVnaXN0ZXJDb2xvcihcIkJyb3duXCIsIFwiI0E1MkEyQVwiKTtcbmV4cG9ydHMuQnVybHlXb29kID0gcmVnaXN0ZXJDb2xvcihcIkJ1cmx5V29vZFwiLCBcIiNERUI4ODdcIik7XG5leHBvcnRzLkNhZGV0Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJDYWRldEJsdWVcIiwgXCIjNUY5RUEwXCIpO1xuZXhwb3J0cy5DaGFydHJldXNlID0gcmVnaXN0ZXJDb2xvcihcIkNoYXJ0cmV1c2VcIiwgXCIjN0ZGRjAwXCIpO1xuZXhwb3J0cy5DaG9jb2xhdGUgPSByZWdpc3RlckNvbG9yKFwiQ2hvY29sYXRlXCIsIFwiI0QyNjkxRVwiKTtcbmV4cG9ydHMuQ29yYWwgPSByZWdpc3RlckNvbG9yKFwiQ29yYWxcIiwgXCIjRkY3RjUwXCIpO1xuZXhwb3J0cy5Db3JuZmxvd2VyQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJDb3JuZmxvd2VyQmx1ZVwiLCBcIiM2NDk1RURcIik7XG5leHBvcnRzLkNvcm5zaWxrID0gcmVnaXN0ZXJDb2xvcihcIkNvcm5zaWxrXCIsIFwiI0ZGRjhEQ1wiKTtcbmV4cG9ydHMuQ3JpbXNvbiA9IHJlZ2lzdGVyQ29sb3IoXCJDcmltc29uXCIsIFwiI0RDMTQzQ1wiKTtcbmV4cG9ydHMuQ3lhbiA9IHJlZ2lzdGVyQ29sb3IoXCJDeWFuXCIsIFwiIzAwRkZGRlwiKTtcbmV4cG9ydHMuRGFya0JsdWUgPSByZWdpc3RlckNvbG9yKFwiRGFya0JsdWVcIiwgXCIjMDAwMDhCXCIpO1xuZXhwb3J0cy5EYXJrQ3lhbiA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrQ3lhblwiLCBcIiMwMDhCOEJcIik7XG5leHBvcnRzLkRhcmtHb2xkZW5Sb2QgPSByZWdpc3RlckNvbG9yKFwiRGFya0dvbGRlblJvZFwiLCBcIiNCODg2MEJcIik7XG5leHBvcnRzLkRhcmtHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtHcmF5XCIsIFwiI0E5QTlBOVwiKTtcbmV4cG9ydHMuRGFya0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtHcmVlblwiLCBcIiMwMDY0MDBcIik7XG5leHBvcnRzLkRhcmtLaGFraSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrS2hha2lcIiwgXCIjQkRCNzZCXCIpO1xuZXhwb3J0cy5EYXJrTWFnZW50YSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrTWFnZW50YVwiLCBcIiM4QjAwOEJcIik7XG5leHBvcnRzLkRhcmtPbGl2ZUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtPbGl2ZUdyZWVuXCIsIFwiIzU1NkIyRlwiKTtcbmV4cG9ydHMuRGFya09yYW5nZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrT3JhbmdlXCIsIFwiI0ZGOEMwMFwiKTtcbmV4cG9ydHMuRGFya09yY2hpZCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrT3JjaGlkXCIsIFwiIzk5MzJDQ1wiKTtcbmV4cG9ydHMuRGFya1JlZCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrUmVkXCIsIFwiIzhCMDAwMFwiKTtcbmV4cG9ydHMuRGFya1NhbG1vbiA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2FsbW9uXCIsIFwiI0U5OTY3QVwiKTtcbmV4cG9ydHMuRGFya1NlYUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtTZWFHcmVlblwiLCBcIiM4RkJDOEZcIik7XG5leHBvcnRzLkRhcmtTbGF0ZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiRGFya1NsYXRlQmx1ZVwiLCBcIiM0ODNEOEJcIik7XG5leHBvcnRzLkRhcmtTbGF0ZUdyYXkgPSByZWdpc3RlckNvbG9yKFwiRGFya1NsYXRlR3JheVwiLCBcIiMyRjRGNEZcIik7XG5leHBvcnRzLkRhcmtUdXJxdW9pc2UgPSByZWdpc3RlckNvbG9yKFwiRGFya1R1cnF1b2lzZVwiLCBcIiMwMENFRDFcIik7XG5leHBvcnRzLkRhcmtWaW9sZXQgPSByZWdpc3RlckNvbG9yKFwiRGFya1Zpb2xldFwiLCBcIiM5NDAwRDNcIik7XG5leHBvcnRzLkRlZXBQaW5rID0gcmVnaXN0ZXJDb2xvcihcIkRlZXBQaW5rXCIsIFwiI0ZGMTQ5M1wiKTtcbmV4cG9ydHMuRGVlcFNreUJsdWUgPSByZWdpc3RlckNvbG9yKFwiRGVlcFNreUJsdWVcIiwgXCIjMDBCRkZGXCIpO1xuZXhwb3J0cy5EaW1HcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkRpbUdyYXlcIiwgXCIjNjk2OTY5XCIpO1xuZXhwb3J0cy5Eb2RnZXJCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkRvZGdlckJsdWVcIiwgXCIjMUU5MEZGXCIpO1xuZXhwb3J0cy5GaXJlQnJpY2sgPSByZWdpc3RlckNvbG9yKFwiRmlyZUJyaWNrXCIsIFwiI0IyMjIyMlwiKTtcbmV4cG9ydHMuRmxvcmFsV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiRmxvcmFsV2hpdGVcIiwgXCIjRkZGQUYwXCIpO1xuZXhwb3J0cy5Gb3Jlc3RHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJGb3Jlc3RHcmVlblwiLCBcIiMyMjhCMjJcIik7XG5leHBvcnRzLkZ1Y2hzaWEgPSByZWdpc3RlckNvbG9yKFwiRnVjaHNpYVwiLCBcIiNGRjAwRkZcIik7XG5leHBvcnRzLkdhaW5zYm9ybyA9IHJlZ2lzdGVyQ29sb3IoXCJHYWluc2Jvcm9cIiwgXCIjRENEQ0RDXCIpO1xuZXhwb3J0cy5HaG9zdFdoaXRlID0gcmVnaXN0ZXJDb2xvcihcIkdob3N0V2hpdGVcIiwgXCIjRjhGOEZGXCIpO1xuZXhwb3J0cy5Hb2xkID0gcmVnaXN0ZXJDb2xvcihcIkdvbGRcIiwgXCIjRkZENzAwXCIpO1xuZXhwb3J0cy5Hb2xkZW5Sb2QgPSByZWdpc3RlckNvbG9yKFwiR29sZGVuUm9kXCIsIFwiI0RBQTUyMFwiKTtcbmV4cG9ydHMuR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJHcmF5XCIsIFwiIzgwODA4MFwiKTtcbmV4cG9ydHMuR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiR3JlZW5cIiwgXCIjMDA4MDAwXCIpO1xuZXhwb3J0cy5HcmVlblllbGxvdyA9IHJlZ2lzdGVyQ29sb3IoXCJHcmVlblllbGxvd1wiLCBcIiNBREZGMkZcIik7XG5leHBvcnRzLkhvbmV5RGV3ID0gcmVnaXN0ZXJDb2xvcihcIkhvbmV5RGV3XCIsIFwiI0YwRkZGMFwiKTtcbmV4cG9ydHMuSG90UGluayA9IHJlZ2lzdGVyQ29sb3IoXCJIb3RQaW5rXCIsIFwiI0ZGNjlCNFwiKTtcbmV4cG9ydHMuSW5kaWFuUmVkID0gcmVnaXN0ZXJDb2xvcihcIkluZGlhblJlZFwiLCBcIiNDRDVDNUNcIik7XG5leHBvcnRzLkluZGlnbyA9IHJlZ2lzdGVyQ29sb3IoXCJJbmRpZ29cIiwgXCIjNEIwMDgyXCIpO1xuZXhwb3J0cy5Jdm9yeSA9IHJlZ2lzdGVyQ29sb3IoXCJJdm9yeVwiLCBcIiNGRkZGRjBcIik7XG5leHBvcnRzLktoYWtpID0gcmVnaXN0ZXJDb2xvcihcIktoYWtpXCIsIFwiI0YwRTY4Q1wiKTtcbmV4cG9ydHMuTGF2ZW5kZXIgPSByZWdpc3RlckNvbG9yKFwiTGF2ZW5kZXJcIiwgXCIjRTZFNkZBXCIpO1xuZXhwb3J0cy5MYXZlbmRlckJsdXNoID0gcmVnaXN0ZXJDb2xvcihcIkxhdmVuZGVyQmx1c2hcIiwgXCIjRkZGMEY1XCIpO1xuZXhwb3J0cy5MYXduR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTGF3bkdyZWVuXCIsIFwiIzdDRkMwMFwiKTtcbmV4cG9ydHMuTGVtb25DaGlmZm9uID0gcmVnaXN0ZXJDb2xvcihcIkxlbW9uQ2hpZmZvblwiLCBcIiNGRkZBQ0RcIik7XG5leHBvcnRzLkxpZ2h0Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEJsdWVcIiwgXCIjQUREOEU2XCIpO1xuZXhwb3J0cy5MaWdodENvcmFsID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0Q29yYWxcIiwgXCIjRjA4MDgwXCIpO1xuZXhwb3J0cy5MaWdodEN5YW4gPSByZWdpc3RlckNvbG9yKFwiTGlnaHRDeWFuXCIsIFwiI0UwRkZGRlwiKTtcbmV4cG9ydHMuTGlnaHRHb2xkZW5Sb2RZZWxsb3cgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRHb2xkZW5Sb2RZZWxsb3dcIiwgXCIjRkFGQUQyXCIpO1xuZXhwb3J0cy5MaWdodEdyYXkgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRHcmF5XCIsIFwiI0QzRDNEM1wiKTtcbmV4cG9ydHMuTGlnaHRHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEdyZWVuXCIsIFwiIzkwRUU5MFwiKTtcbmV4cG9ydHMuTGlnaHRQaW5rID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0UGlua1wiLCBcIiNGRkI2QzFcIik7XG5leHBvcnRzLkxpZ2h0U2FsbW9uID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U2FsbW9uXCIsIFwiI0ZGQTA3QVwiKTtcbmV4cG9ydHMuTGlnaHRTZWFHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFNlYUdyZWVuXCIsIFwiIzIwQjJBQVwiKTtcbmV4cG9ydHMuTGlnaHRTa3lCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U2t5Qmx1ZVwiLCBcIiM4N0NFRkFcIik7XG5leHBvcnRzLkxpZ2h0U2xhdGVHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U2xhdGVHcmF5XCIsIFwiIzc3ODg5OVwiKTtcbmV4cG9ydHMuTGlnaHRTdGVlbEJsdWUgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTdGVlbEJsdWVcIiwgXCIjQjBDNERFXCIpO1xuZXhwb3J0cy5MaWdodFllbGxvdyA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFllbGxvd1wiLCBcIiNGRkZGRTBcIik7XG5leHBvcnRzLkxpbWUgPSByZWdpc3RlckNvbG9yKFwiTGltZVwiLCBcIiMwMEZGMDBcIik7XG5leHBvcnRzLkxpbWVHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaW1lR3JlZW5cIiwgXCIjMzJDRDMyXCIpO1xuZXhwb3J0cy5MaW5lbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaW5lblwiLCBcIiNGQUYwRTZcIik7XG5leHBvcnRzLk1hZ2VudGEgPSByZWdpc3RlckNvbG9yKFwiTWFnZW50YVwiLCBcIiNGRjAwRkZcIik7XG5leHBvcnRzLk1hcm9vbiA9IHJlZ2lzdGVyQ29sb3IoXCJNYXJvb25cIiwgXCIjODAwMDAwXCIpO1xuZXhwb3J0cy5NZWRpdW1BcXVhTWFyaW5lID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bUFxdWFNYXJpbmVcIiwgXCIjNjZDREFBXCIpO1xuZXhwb3J0cy5NZWRpdW1CbHVlID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bUJsdWVcIiwgXCIjMDAwMENEXCIpO1xuZXhwb3J0cy5NZWRpdW1PcmNoaWQgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtT3JjaGlkXCIsIFwiI0JBNTVEM1wiKTtcbmV4cG9ydHMuTWVkaXVtUHVycGxlID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVB1cnBsZVwiLCBcIiM5MzcwREJcIik7XG5leHBvcnRzLk1lZGl1bVNlYUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVNlYUdyZWVuXCIsIFwiIzNDQjM3MVwiKTtcbmV4cG9ydHMuTWVkaXVtU2xhdGVCbHVlID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVNsYXRlQmx1ZVwiLCBcIiM3QjY4RUVcIik7XG5leHBvcnRzLk1lZGl1bVNwcmluZ0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVNwcmluZ0dyZWVuXCIsIFwiIzAwRkE5QVwiKTtcbmV4cG9ydHMuTWVkaXVtVHVycXVvaXNlID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVR1cnF1b2lzZVwiLCBcIiM0OEQxQ0NcIik7XG5leHBvcnRzLk1lZGl1bVZpb2xldFJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1WaW9sZXRSZWRcIiwgXCIjQzcxNTg1XCIpO1xuZXhwb3J0cy5NaWRuaWdodEJsdWUgPSByZWdpc3RlckNvbG9yKFwiTWlkbmlnaHRCbHVlXCIsIFwiIzE5MTk3MFwiKTtcbmV4cG9ydHMuTWludENyZWFtID0gcmVnaXN0ZXJDb2xvcihcIk1pbnRDcmVhbVwiLCBcIiNGNUZGRkFcIik7XG5leHBvcnRzLk1pc3R5Um9zZSA9IHJlZ2lzdGVyQ29sb3IoXCJNaXN0eVJvc2VcIiwgXCIjRkZFNEUxXCIpO1xuZXhwb3J0cy5Nb2NjYXNpbiA9IHJlZ2lzdGVyQ29sb3IoXCJNb2NjYXNpblwiLCBcIiNGRkU0QjVcIik7XG5leHBvcnRzLk5hdmFqb1doaXRlID0gcmVnaXN0ZXJDb2xvcihcIk5hdmFqb1doaXRlXCIsIFwiI0ZGREVBRFwiKTtcbmV4cG9ydHMuTmF2eSA9IHJlZ2lzdGVyQ29sb3IoXCJOYXZ5XCIsIFwiIzAwMDA4MFwiKTtcbmV4cG9ydHMuT2xkTGFjZSA9IHJlZ2lzdGVyQ29sb3IoXCJPbGRMYWNlXCIsIFwiI0ZERjVFNlwiKTtcbmV4cG9ydHMuT2xpdmUgPSByZWdpc3RlckNvbG9yKFwiT2xpdmVcIiwgXCIjODA4MDAwXCIpO1xuZXhwb3J0cy5PbGl2ZURyYWIgPSByZWdpc3RlckNvbG9yKFwiT2xpdmVEcmFiXCIsIFwiIzZCOEUyM1wiKTtcbmV4cG9ydHMuT3JhbmdlID0gcmVnaXN0ZXJDb2xvcihcIk9yYW5nZVwiLCBcIiNGRkE1MDBcIik7XG5leHBvcnRzLk9yYW5nZVJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJPcmFuZ2VSZWRcIiwgXCIjRkY0NTAwXCIpO1xuZXhwb3J0cy5PcmNoaWQgPSByZWdpc3RlckNvbG9yKFwiT3JjaGlkXCIsIFwiI0RBNzBENlwiKTtcbmV4cG9ydHMuUGFsZUdvbGRlblJvZCA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlR29sZGVuUm9kXCIsIFwiI0VFRThBQVwiKTtcbmV4cG9ydHMuUGFsZUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlBhbGVHcmVlblwiLCBcIiM5OEZCOThcIik7XG5leHBvcnRzLlBhbGVUdXJxdW9pc2UgPSByZWdpc3RlckNvbG9yKFwiUGFsZVR1cnF1b2lzZVwiLCBcIiNBRkVFRUVcIik7XG5leHBvcnRzLlBhbGVWaW9sZXRSZWQgPSByZWdpc3RlckNvbG9yKFwiUGFsZVZpb2xldFJlZFwiLCBcIiNEQjcwOTNcIik7XG5leHBvcnRzLlBhcGF5YVdoaXAgPSByZWdpc3RlckNvbG9yKFwiUGFwYXlhV2hpcFwiLCBcIiNGRkVGRDVcIik7XG5leHBvcnRzLlBlYWNoUHVmZiA9IHJlZ2lzdGVyQ29sb3IoXCJQZWFjaFB1ZmZcIiwgXCIjRkZEQUI5XCIpO1xuZXhwb3J0cy5QZXJ1ID0gcmVnaXN0ZXJDb2xvcihcIlBlcnVcIiwgXCIjQ0Q4NTNGXCIpO1xuZXhwb3J0cy5QaW5rID0gcmVnaXN0ZXJDb2xvcihcIlBpbmtcIiwgXCIjRkZDMENCXCIpO1xuZXhwb3J0cy5QbHVtID0gcmVnaXN0ZXJDb2xvcihcIlBsdW1cIiwgXCIjRERBMEREXCIpO1xuZXhwb3J0cy5Qb3dkZXJCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlBvd2RlckJsdWVcIiwgXCIjQjBFMEU2XCIpO1xuZXhwb3J0cy5QdXJwbGUgPSByZWdpc3RlckNvbG9yKFwiUHVycGxlXCIsIFwiIzgwMDA4MFwiKTtcbmV4cG9ydHMuUmViZWNjYVB1cnBsZSA9IHJlZ2lzdGVyQ29sb3IoXCJSZWJlY2NhUHVycGxlXCIsIFwiIzY2MzM5OVwiKTtcbmV4cG9ydHMuUmVkID0gcmVnaXN0ZXJDb2xvcihcIlJlZFwiLCBcIiNGRjAwMDBcIik7XG5leHBvcnRzLlJvc3lCcm93biA9IHJlZ2lzdGVyQ29sb3IoXCJSb3N5QnJvd25cIiwgXCIjQkM4RjhGXCIpO1xuZXhwb3J0cy5Sb3lhbEJsdWUgPSByZWdpc3RlckNvbG9yKFwiUm95YWxCbHVlXCIsIFwiIzQxNjlFMVwiKTtcbmV4cG9ydHMuU2FkZGxlQnJvd24gPSByZWdpc3RlckNvbG9yKFwiU2FkZGxlQnJvd25cIiwgXCIjOEI0NTEzXCIpO1xuZXhwb3J0cy5TYWxtb24gPSByZWdpc3RlckNvbG9yKFwiU2FsbW9uXCIsIFwiI0ZBODA3MlwiKTtcbmV4cG9ydHMuU2FuZHlCcm93biA9IHJlZ2lzdGVyQ29sb3IoXCJTYW5keUJyb3duXCIsIFwiI0Y0QTQ2MFwiKTtcbmV4cG9ydHMuU2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiU2VhR3JlZW5cIiwgXCIjMkU4QjU3XCIpO1xuZXhwb3J0cy5TZWFTaGVsbCA9IHJlZ2lzdGVyQ29sb3IoXCJTZWFTaGVsbFwiLCBcIiNGRkY1RUVcIik7XG5leHBvcnRzLlNpZW5uYSA9IHJlZ2lzdGVyQ29sb3IoXCJTaWVubmFcIiwgXCIjQTA1MjJEXCIpO1xuZXhwb3J0cy5TaWx2ZXIgPSByZWdpc3RlckNvbG9yKFwiU2lsdmVyXCIsIFwiI0MwQzBDMFwiKTtcbmV4cG9ydHMuU2t5Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJTa3lCbHVlXCIsIFwiIzg3Q0VFQlwiKTtcbmV4cG9ydHMuU2xhdGVCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlNsYXRlQmx1ZVwiLCBcIiM2QTVBQ0RcIik7XG5leHBvcnRzLlNsYXRlR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJTbGF0ZUdyYXlcIiwgXCIjNzA4MDkwXCIpO1xuZXhwb3J0cy5Tbm93ID0gcmVnaXN0ZXJDb2xvcihcIlNub3dcIiwgXCIjRkZGQUZBXCIpO1xuZXhwb3J0cy5TcHJpbmdHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJTcHJpbmdHcmVlblwiLCBcIiMwMEZGN0ZcIik7XG5leHBvcnRzLlN0ZWVsQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJTdGVlbEJsdWVcIiwgXCIjNDY4MkI0XCIpO1xuZXhwb3J0cy5UYW4gPSByZWdpc3RlckNvbG9yKFwiVGFuXCIsIFwiI0QyQjQ4Q1wiKTtcbmV4cG9ydHMuVGVhbCA9IHJlZ2lzdGVyQ29sb3IoXCJUZWFsXCIsIFwiIzAwODA4MFwiKTtcbmV4cG9ydHMuVGhpc3RsZSA9IHJlZ2lzdGVyQ29sb3IoXCJUaGlzdGxlXCIsIFwiI0Q4QkZEOFwiKTtcbmV4cG9ydHMuVG9tYXRvID0gcmVnaXN0ZXJDb2xvcihcIlRvbWF0b1wiLCBcIiNGRjYzNDdcIik7XG5leHBvcnRzLlR1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJUdXJxdW9pc2VcIiwgXCIjNDBFMEQwXCIpO1xuZXhwb3J0cy5WaW9sZXQgPSByZWdpc3RlckNvbG9yKFwiVmlvbGV0XCIsIFwiI0VFODJFRVwiKTtcbmV4cG9ydHMuV2hlYXQgPSByZWdpc3RlckNvbG9yKFwiV2hlYXRcIiwgXCIjRjVERUIzXCIpO1xuZXhwb3J0cy5XaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJXaGl0ZVwiLCBcIiNGRkZGRkZcIik7XG5leHBvcnRzLldoaXRlU21va2UgPSByZWdpc3RlckNvbG9yKFwiV2hpdGVTbW9rZVwiLCBcIiNGNUY1RjVcIik7XG5leHBvcnRzLlllbGxvdyA9IHJlZ2lzdGVyQ29sb3IoXCJZZWxsb3dcIiwgXCIjRkZGRjAwXCIpO1xuZXhwb3J0cy5ZZWxsb3dHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJZZWxsb3dHcmVlblwiLCBcIiM5QUNEMzJcIik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1rbm93bi1jb2xvcnMuanMubWFwIiwiXG5leHBvcnRzLnBhcnNlID0gcGFyc2U7XG5cbmZ1bmN0aW9uIHBhcnNlKHN0cikge1xuICByZXR1cm4gbmV3IFBhcnNlcihzdHIpLnBhcnNlKCk7XG59XG5cbmZ1bmN0aW9uIFBhcnNlcihzdHIpIHtcbiAgdGhpcy5zdHIgPSBzdHI7XG59XG5cblBhcnNlci5wcm90b3R5cGUuc2tpcCA9IGZ1bmN0aW9uKG0pe1xuICB0aGlzLnN0ciA9IHRoaXMuc3RyLnNsaWNlKG1bMF0ubGVuZ3RoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuY29tbWEgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eLCAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHsgdHlwZTogJ2NvbW1hJywgc3RyaW5nOiAnLCcgfTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuaWRlbnQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKFtcXHctXSspICovLmV4ZWModGhpcy5zdHIpO1xuICBpZiAoIW0pIHJldHVybjtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdpZGVudCcsXG4gICAgc3RyaW5nOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuaW50ID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXigoWy1cXCtdP1xcZCspKFxcUyspPykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHZhciBuID0gfn5tWzJdO1xuICB2YXIgdSA9IG1bM107XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICBzdHJpbmc6IG1bMV0sXG4gICAgdW5pdDogdSB8fCAnJyxcbiAgICB2YWx1ZTogblxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLmZsb2F0ID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXigoKD86Wy1cXCtdP1xcZCspP1xcLlxcZCspKFxcUyspPykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHZhciBuID0gcGFyc2VGbG9hdChtWzJdKTtcbiAgdmFyIHUgPSBtWzNdO1xuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ251bWJlcicsXG4gICAgc3RyaW5nOiBtWzFdLFxuICAgIHVuaXQ6IHUgfHwgJycsXG4gICAgdmFsdWU6IG5cbiAgfVxufTtcblxuUGFyc2VyLnByb3RvdHlwZS5udW1iZXIgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gdGhpcy5mbG9hdCgpIHx8IHRoaXMuaW50KCk7XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLmRvdWJsZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL15cIihbXlwiXSopXCIgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuIG07XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBxdW90ZTogJ1wiJyxcbiAgICBzdHJpbmc6ICdcIicgKyBtWzFdICsgJ1wiJyxcbiAgICB2YWx1ZTogbVsxXVxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnNpbmdsZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14nKFteJ10qKScgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuIG07XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBxdW90ZTogXCInXCIsXG4gICAgc3RyaW5nOiBcIidcIiArIG1bMV0gKyBcIidcIixcbiAgICB2YWx1ZTogbVsxXVxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnN0cmluZyA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLnNpbmdsZSgpIHx8IHRoaXMuZG91YmxlKCk7XG59O1xuXG5cblBhcnNlci5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gdGhpcy5udW1iZXIoKVxuICAgIHx8IHRoaXMuaWRlbnQoKVxuICAgIHx8IHRoaXMuc3RyaW5nKClcbiAgICB8fCB0aGlzLmNvbW1hKCk7XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24oKXtcbiAgdmFyIHZhbHMgPSBbXTtcblxuICB3aGlsZSAodGhpcy5zdHIubGVuZ3RoKSB7XG4gICAgdmFyIG9iaiA9IHRoaXMudmFsdWUoKTtcbiAgICBpZiAoIW9iaikgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gcGFyc2UgbmVhciBgJyArIHRoaXMuc3RyLnNsaWNlKDAsIDEwKSArICcuLi5gJyk7XG4gICAgdmFscy5wdXNoKG9iaik7XG4gIH1cblxuICByZXR1cm4gdmFscztcbn07XG4iLCJleHBvcnRzLnBhcnNlID0gcmVxdWlyZSgnLi9saWIvcGFyc2UnKTtcbiIsIi8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL2dyYW1tYXIuaHRtbFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3Zpc2lvbm1lZGlhL2Nzcy1wYXJzZS9wdWxsLzQ5I2lzc3VlY29tbWVudC0zMDA4ODAyN1xudmFyIGNvbW1lbnRyZSA9IC9cXC9cXCpbXipdKlxcKisoW14vKl1bXipdKlxcKispKlxcLy9nXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY3NzLCBvcHRpb25zKXtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgLyoqXG4gICAqIFBvc2l0aW9uYWwuXG4gICAqL1xuXG4gIHZhciBsaW5lbm8gPSAxO1xuICB2YXIgY29sdW1uID0gMTtcblxuICAvKipcbiAgICogVXBkYXRlIGxpbmVubyBhbmQgY29sdW1uIGJhc2VkIG9uIGBzdHJgLlxuICAgKi9cblxuICBmdW5jdGlvbiB1cGRhdGVQb3NpdGlvbihzdHIpIHtcbiAgICB2YXIgbGluZXMgPSBzdHIubWF0Y2goL1xcbi9nKTtcbiAgICBpZiAobGluZXMpIGxpbmVubyArPSBsaW5lcy5sZW5ndGg7XG4gICAgdmFyIGkgPSBzdHIubGFzdEluZGV4T2YoJ1xcbicpO1xuICAgIGNvbHVtbiA9IH5pID8gc3RyLmxlbmd0aCAtIGkgOiBjb2x1bW4gKyBzdHIubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hcmsgcG9zaXRpb24gYW5kIHBhdGNoIGBub2RlLnBvc2l0aW9uYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gcG9zaXRpb24oKSB7XG4gICAgdmFyIHN0YXJ0ID0geyBsaW5lOiBsaW5lbm8sIGNvbHVtbjogY29sdW1uIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5vZGUpe1xuICAgICAgbm9kZS5wb3NpdGlvbiA9IG5ldyBQb3NpdGlvbihzdGFydCk7XG4gICAgICB3aGl0ZXNwYWNlKCk7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3JlIHBvc2l0aW9uIGluZm9ybWF0aW9uIGZvciBhIG5vZGVcbiAgICovXG5cbiAgZnVuY3Rpb24gUG9zaXRpb24oc3RhcnQpIHtcbiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gICAgdGhpcy5lbmQgPSB7IGxpbmU6IGxpbmVubywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICB0aGlzLnNvdXJjZSA9IG9wdGlvbnMuc291cmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIE5vbi1lbnVtZXJhYmxlIHNvdXJjZSBzdHJpbmdcbiAgICovXG5cbiAgUG9zaXRpb24ucHJvdG90eXBlLmNvbnRlbnQgPSBjc3M7XG5cbiAgLyoqXG4gICAqIEVycm9yIGBtc2dgLlxuICAgKi9cblxuICB2YXIgZXJyb3JzTGlzdCA9IFtdO1xuXG4gIGZ1bmN0aW9uIGVycm9yKG1zZykge1xuICAgIHZhciBlcnIgPSBuZXcgRXJyb3Iob3B0aW9ucy5zb3VyY2UgKyAnOicgKyBsaW5lbm8gKyAnOicgKyBjb2x1bW4gKyAnOiAnICsgbXNnKTtcbiAgICBlcnIucmVhc29uID0gbXNnO1xuICAgIGVyci5maWxlbmFtZSA9IG9wdGlvbnMuc291cmNlO1xuICAgIGVyci5saW5lID0gbGluZW5vO1xuICAgIGVyci5jb2x1bW4gPSBjb2x1bW47XG4gICAgZXJyLnNvdXJjZSA9IGNzcztcblxuICAgIGlmIChvcHRpb25zLnNpbGVudCkge1xuICAgICAgZXJyb3JzTGlzdC5wdXNoKGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Ugc3R5bGVzaGVldC5cbiAgICovXG5cbiAgZnVuY3Rpb24gc3R5bGVzaGVldCgpIHtcbiAgICB2YXIgcnVsZXNMaXN0ID0gcnVsZXMoKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnc3R5bGVzaGVldCcsXG4gICAgICBzdHlsZXNoZWV0OiB7XG4gICAgICAgIHJ1bGVzOiBydWxlc0xpc3QsXG4gICAgICAgIHBhcnNpbmdFcnJvcnM6IGVycm9yc0xpc3RcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW5pbmcgYnJhY2UuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgcmV0dXJuIG1hdGNoKC9ee1xccyovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zaW5nIGJyYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICByZXR1cm4gbWF0Y2goL159Lyk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcnVsZXNldC5cbiAgICovXG5cbiAgZnVuY3Rpb24gcnVsZXMoKSB7XG4gICAgdmFyIG5vZGU7XG4gICAgdmFyIHJ1bGVzID0gW107XG4gICAgd2hpdGVzcGFjZSgpO1xuICAgIGNvbW1lbnRzKHJ1bGVzKTtcbiAgICB3aGlsZSAoY3NzLmxlbmd0aCAmJiBjc3MuY2hhckF0KDApICE9ICd9JyAmJiAobm9kZSA9IGF0cnVsZSgpIHx8IHJ1bGUoKSkpIHtcbiAgICAgIGlmIChub2RlICE9PSBmYWxzZSkge1xuICAgICAgICBydWxlcy5wdXNoKG5vZGUpO1xuICAgICAgICBjb21tZW50cyhydWxlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBydWxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBNYXRjaCBgcmVgIGFuZCByZXR1cm4gY2FwdHVyZXMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIG1hdGNoKHJlKSB7XG4gICAgdmFyIG0gPSByZS5leGVjKGNzcyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG4gICAgdmFyIHN0ciA9IG1bMF07XG4gICAgdXBkYXRlUG9zaXRpb24oc3RyKTtcbiAgICBjc3MgPSBjc3Muc2xpY2Uoc3RyLmxlbmd0aCk7XG4gICAgcmV0dXJuIG07XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Ugd2hpdGVzcGFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gd2hpdGVzcGFjZSgpIHtcbiAgICBtYXRjaCgvXlxccyovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBjb21tZW50cztcbiAgICovXG5cbiAgZnVuY3Rpb24gY29tbWVudHMocnVsZXMpIHtcbiAgICB2YXIgYztcbiAgICBydWxlcyA9IHJ1bGVzIHx8IFtdO1xuICAgIHdoaWxlIChjID0gY29tbWVudCgpKSB7XG4gICAgICBpZiAoYyAhPT0gZmFsc2UpIHtcbiAgICAgICAgcnVsZXMucHVzaChjKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJ1bGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNvbW1lbnQuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNvbW1lbnQoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgaWYgKCcvJyAhPSBjc3MuY2hhckF0KDApIHx8ICcqJyAhPSBjc3MuY2hhckF0KDEpKSByZXR1cm47XG5cbiAgICB2YXIgaSA9IDI7XG4gICAgd2hpbGUgKFwiXCIgIT0gY3NzLmNoYXJBdChpKSAmJiAoJyonICE9IGNzcy5jaGFyQXQoaSkgfHwgJy8nICE9IGNzcy5jaGFyQXQoaSArIDEpKSkgKytpO1xuICAgIGkgKz0gMjtcblxuICAgIGlmIChcIlwiID09PSBjc3MuY2hhckF0KGktMSkpIHtcbiAgICAgIHJldHVybiBlcnJvcignRW5kIG9mIGNvbW1lbnQgbWlzc2luZycpO1xuICAgIH1cblxuICAgIHZhciBzdHIgPSBjc3Muc2xpY2UoMiwgaSAtIDIpO1xuICAgIGNvbHVtbiArPSAyO1xuICAgIHVwZGF0ZVBvc2l0aW9uKHN0cik7XG4gICAgY3NzID0gY3NzLnNsaWNlKGkpO1xuICAgIGNvbHVtbiArPSAyO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnY29tbWVudCcsXG4gICAgICBjb21tZW50OiBzdHJcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzZWxlY3Rvci5cbiAgICovXG5cbiAgZnVuY3Rpb24gc2VsZWN0b3IoKSB7XG4gICAgdmFyIG0gPSBtYXRjaCgvXihbXntdKykvKTtcbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICAvKiBAZml4IFJlbW92ZSBhbGwgY29tbWVudHMgZnJvbSBzZWxlY3RvcnNcbiAgICAgKiBodHRwOi8vb3N0ZXJtaWxsZXIub3JnL2ZpbmRjb21tZW50Lmh0bWwgKi9cbiAgICByZXR1cm4gdHJpbShtWzBdKVxuICAgICAgLnJlcGxhY2UoL1xcL1xcKihbXipdfFtcXHJcXG5dfChcXCorKFteKi9dfFtcXHJcXG5dKSkpKlxcKlxcLysvZywgJycpXG4gICAgICAucmVwbGFjZSgvXCIoPzpcXFxcXCJ8W15cIl0pKlwifCcoPzpcXFxcJ3xbXiddKSonL2csIGZ1bmN0aW9uKG0pIHtcbiAgICAgICAgcmV0dXJuIG0ucmVwbGFjZSgvLC9nLCAnXFx1MjAwQycpO1xuICAgICAgfSlcbiAgICAgIC5zcGxpdCgvXFxzKig/IVteKF0qXFwpKSxcXHMqLylcbiAgICAgIC5tYXAoZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy5yZXBsYWNlKC9cXHUyMDBDL2csICcsJyk7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkZWNsYXJhdGlvbi5cbiAgICovXG5cbiAgZnVuY3Rpb24gZGVjbGFyYXRpb24oKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG5cbiAgICAvLyBwcm9wXG4gICAgdmFyIHByb3AgPSBtYXRjaCgvXihcXCo/Wy0jXFwvXFwqXFxcXFxcd10rKFxcW1swLTlhLXpfLV0rXFxdKT8pXFxzKi8pO1xuICAgIGlmICghcHJvcCkgcmV0dXJuO1xuICAgIHByb3AgPSB0cmltKHByb3BbMF0pO1xuXG4gICAgLy8gOlxuICAgIGlmICghbWF0Y2goL146XFxzKi8pKSByZXR1cm4gZXJyb3IoXCJwcm9wZXJ0eSBtaXNzaW5nICc6J1wiKTtcblxuICAgIC8vIHZhbFxuICAgIHZhciB2YWwgPSBtYXRjaCgvXigoPzonKD86XFxcXCd8LikqPyd8XCIoPzpcXFxcXCJ8LikqP1wifFxcKFteXFwpXSo/XFwpfFtefTtdKSspLyk7XG5cbiAgICB2YXIgcmV0ID0gcG9zKHtcbiAgICAgIHR5cGU6ICdkZWNsYXJhdGlvbicsXG4gICAgICBwcm9wZXJ0eTogcHJvcC5yZXBsYWNlKGNvbW1lbnRyZSwgJycpLFxuICAgICAgdmFsdWU6IHZhbCA/IHRyaW0odmFsWzBdKS5yZXBsYWNlKGNvbW1lbnRyZSwgJycpIDogJydcbiAgICB9KTtcblxuICAgIC8vIDtcbiAgICBtYXRjaCgvXls7XFxzXSovKTtcblxuICAgIHJldHVybiByZXQ7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgZGVjbGFyYXRpb25zLlxuICAgKi9cblxuICBmdW5jdGlvbiBkZWNsYXJhdGlvbnMoKSB7XG4gICAgdmFyIGRlY2xzID0gW107XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwibWlzc2luZyAneydcIik7XG4gICAgY29tbWVudHMoZGVjbHMpO1xuXG4gICAgLy8gZGVjbGFyYXRpb25zXG4gICAgdmFyIGRlY2w7XG4gICAgd2hpbGUgKGRlY2wgPSBkZWNsYXJhdGlvbigpKSB7XG4gICAgICBpZiAoZGVjbCAhPT0gZmFsc2UpIHtcbiAgICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgICAgY29tbWVudHMoZGVjbHMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwibWlzc2luZyAnfSdcIik7XG4gICAgcmV0dXJuIGRlY2xzO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGtleWZyYW1lLlxuICAgKi9cblxuICBmdW5jdGlvbiBrZXlmcmFtZSgpIHtcbiAgICB2YXIgbTtcbiAgICB2YXIgdmFscyA9IFtdO1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuXG4gICAgd2hpbGUgKG0gPSBtYXRjaCgvXigoXFxkK1xcLlxcZCt8XFwuXFxkK3xcXGQrKSU/fFthLXpdKylcXHMqLykpIHtcbiAgICAgIHZhbHMucHVzaChtWzFdKTtcbiAgICAgIG1hdGNoKC9eLFxccyovKTtcbiAgICB9XG5cbiAgICBpZiAoIXZhbHMubGVuZ3RoKSByZXR1cm47XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdrZXlmcmFtZScsXG4gICAgICB2YWx1ZXM6IHZhbHMsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xhcmF0aW9ucygpXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Uga2V5ZnJhbWVzLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGtleWZyYW1lcygpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQChbLVxcd10rKT9rZXlmcmFtZXNcXHMqLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgdmVuZG9yID0gbVsxXTtcblxuICAgIC8vIGlkZW50aWZpZXJcbiAgICB2YXIgbSA9IG1hdGNoKC9eKFstXFx3XSspXFxzKi8pO1xuICAgIGlmICghbSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nIG5hbWVcIik7XG4gICAgdmFyIG5hbWUgPSBtWzFdO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBrZXlmcmFtZXMgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgZnJhbWU7XG4gICAgdmFyIGZyYW1lcyA9IGNvbW1lbnRzKCk7XG4gICAgd2hpbGUgKGZyYW1lID0ga2V5ZnJhbWUoKSkge1xuICAgICAgZnJhbWVzLnB1c2goZnJhbWUpO1xuICAgICAgZnJhbWVzID0gZnJhbWVzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBrZXlmcmFtZXMgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdrZXlmcmFtZXMnLFxuICAgICAgbmFtZTogbmFtZSxcbiAgICAgIHZlbmRvcjogdmVuZG9yLFxuICAgICAga2V5ZnJhbWVzOiBmcmFtZXNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzdXBwb3J0cy5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRzdXBwb3J0cygpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQHN1cHBvcnRzICooW157XSspLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgc3VwcG9ydHMgPSB0cmltKG1bMV0pO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBzdXBwb3J0cyBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBzdHlsZSA9IGNvbW1lbnRzKCkuY29uY2F0KHJ1bGVzKCkpO1xuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJAc3VwcG9ydHMgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdzdXBwb3J0cycsXG4gICAgICBzdXBwb3J0czogc3VwcG9ydHMsXG4gICAgICBydWxlczogc3R5bGVcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBob3N0LlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGhvc3QoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBob3N0XFxzKi8pO1xuXG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGhvc3QgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGhvc3QgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdob3N0JyxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIG1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdG1lZGlhKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AbWVkaWEgKihbXntdKykvKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciBtZWRpYSA9IHRyaW0obVsxXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQG1lZGlhIG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBtZWRpYSBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ21lZGlhJyxcbiAgICAgIG1lZGlhOiBtZWRpYSxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cblxuICAvKipcbiAgICogUGFyc2UgY3VzdG9tLW1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGN1c3RvbW1lZGlhKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AY3VzdG9tLW1lZGlhXFxzKygtLVteXFxzXSspXFxzKihbXns7XSspOy8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnY3VzdG9tLW1lZGlhJyxcbiAgICAgIG5hbWU6IHRyaW0obVsxXSksXG4gICAgICBtZWRpYTogdHJpbShtWzJdKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHBhZ2VkIG1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdHBhZ2UoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBwYWdlICovKTtcbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIHZhciBzZWwgPSBzZWxlY3RvcigpIHx8IFtdO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBwYWdlIG1pc3NpbmcgJ3snXCIpO1xuICAgIHZhciBkZWNscyA9IGNvbW1lbnRzKCk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGRlY2xzLnB1c2goZGVjbCk7XG4gICAgICBkZWNscyA9IGRlY2xzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBwYWdlIG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAncGFnZScsXG4gICAgICBzZWxlY3RvcnM6IHNlbCxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbHNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkb2N1bWVudC5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRkb2N1bWVudCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQChbLVxcd10rKT9kb2N1bWVudCAqKFtee10rKS8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgdmFyIHZlbmRvciA9IHRyaW0obVsxXSk7XG4gICAgdmFyIGRvYyA9IHRyaW0obVsyXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGRvY3VtZW50IG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBkb2N1bWVudCBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2RvY3VtZW50JyxcbiAgICAgIGRvY3VtZW50OiBkb2MsXG4gICAgICB2ZW5kb3I6IHZlbmRvcixcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGZvbnQtZmFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRmb250ZmFjZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQGZvbnQtZmFjZVxccyovKTtcbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAZm9udC1mYWNlIG1pc3NpbmcgJ3snXCIpO1xuICAgIHZhciBkZWNscyA9IGNvbW1lbnRzKCk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGRlY2xzLnB1c2goZGVjbCk7XG4gICAgICBkZWNscyA9IGRlY2xzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBmb250LWZhY2UgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdmb250LWZhY2UnLFxuICAgICAgZGVjbGFyYXRpb25zOiBkZWNsc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGltcG9ydFxuICAgKi9cblxuICB2YXIgYXRpbXBvcnQgPSBfY29tcGlsZUF0cnVsZSgnaW1wb3J0Jyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNoYXJzZXRcbiAgICovXG5cbiAgdmFyIGF0Y2hhcnNldCA9IF9jb21waWxlQXRydWxlKCdjaGFyc2V0Jyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIG5hbWVzcGFjZVxuICAgKi9cblxuICB2YXIgYXRuYW1lc3BhY2UgPSBfY29tcGlsZUF0cnVsZSgnbmFtZXNwYWNlJyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIG5vbi1ibG9jayBhdC1ydWxlc1xuICAgKi9cblxuXG4gIGZ1bmN0aW9uIF9jb21waWxlQXRydWxlKG5hbWUpIHtcbiAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKCdeQCcgKyBuYW1lICsgJ1xcXFxzKihbXjtdKyk7Jyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgICB2YXIgbSA9IG1hdGNoKHJlKTtcbiAgICAgIGlmICghbSkgcmV0dXJuO1xuICAgICAgdmFyIHJldCA9IHsgdHlwZTogbmFtZSB9O1xuICAgICAgcmV0W25hbWVdID0gbVsxXS50cmltKCk7XG4gICAgICByZXR1cm4gcG9zKHJldCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGF0IHJ1bGUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0cnVsZSgpIHtcbiAgICBpZiAoY3NzWzBdICE9ICdAJykgcmV0dXJuO1xuXG4gICAgcmV0dXJuIGF0a2V5ZnJhbWVzKClcbiAgICAgIHx8IGF0bWVkaWEoKVxuICAgICAgfHwgYXRjdXN0b21tZWRpYSgpXG4gICAgICB8fCBhdHN1cHBvcnRzKClcbiAgICAgIHx8IGF0aW1wb3J0KClcbiAgICAgIHx8IGF0Y2hhcnNldCgpXG4gICAgICB8fCBhdG5hbWVzcGFjZSgpXG4gICAgICB8fCBhdGRvY3VtZW50KClcbiAgICAgIHx8IGF0cGFnZSgpXG4gICAgICB8fCBhdGhvc3QoKVxuICAgICAgfHwgYXRmb250ZmFjZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHJ1bGUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHJ1bGUoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIHNlbCA9IHNlbGVjdG9yKCk7XG5cbiAgICBpZiAoIXNlbCkgcmV0dXJuIGVycm9yKCdzZWxlY3RvciBtaXNzaW5nJyk7XG4gICAgY29tbWVudHMoKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ3J1bGUnLFxuICAgICAgc2VsZWN0b3JzOiBzZWwsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xhcmF0aW9ucygpXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYWRkUGFyZW50KHN0eWxlc2hlZXQoKSk7XG59O1xuXG4vKipcbiAqIFRyaW0gYHN0cmAuXG4gKi9cblxuZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgcmV0dXJuIHN0ciA/IHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykgOiAnJztcbn1cblxuLyoqXG4gKiBBZGRzIG5vbi1lbnVtZXJhYmxlIHBhcmVudCBub2RlIHJlZmVyZW5jZSB0byBlYWNoIG5vZGUuXG4gKi9cblxuZnVuY3Rpb24gYWRkUGFyZW50KG9iaiwgcGFyZW50KSB7XG4gIHZhciBpc05vZGUgPSBvYmogJiYgdHlwZW9mIG9iai50eXBlID09PSAnc3RyaW5nJztcbiAgdmFyIGNoaWxkUGFyZW50ID0gaXNOb2RlID8gb2JqIDogcGFyZW50O1xuXG4gIGZvciAodmFyIGsgaW4gb2JqKSB7XG4gICAgdmFyIHZhbHVlID0gb2JqW2tdO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbih2KSB7IGFkZFBhcmVudCh2LCBjaGlsZFBhcmVudCk7IH0pO1xuICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgYWRkUGFyZW50KHZhbHVlLCBjaGlsZFBhcmVudCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGlzTm9kZSkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosICdwYXJlbnQnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgdmFsdWU6IHBhcmVudCB8fCBudWxsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHVybFJlZ0V4ID0gL1xccyp1cmxcXCgoPzooJ3xcIikoW15cXDFdKilcXDF8KFteXFwpXSopKVxcKVxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZVVSTCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVybFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSB1cmxSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gdXJsUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IHJlc3VsdFsyXSB8fCByZXN1bHRbM107XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlVVJMID0gcGFyc2VVUkw7XG52YXIgaGV4Q29sb3JSZWdFeCA9IC9cXHMqIygoPzpbMC05QS1GXXs4fSl8KD86WzAtOUEtRl17Nn0pfCg/OlswLTlBLUZdezN9KSlcXHMqL2dpeTtcbmZ1bmN0aW9uIHBhcnNlSGV4Q29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBoZXhDb2xvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBoZXhDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBoZXhDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgaGV4ID0gcmVzdWx0WzFdO1xuICAgIHZhciBhcmdiO1xuICAgIGlmIChoZXgubGVuZ3RoID09PSA4KSB7XG4gICAgICAgIGFyZ2IgPSBwYXJzZUludChcIjB4XCIgKyBoZXgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChoZXgubGVuZ3RoID09PSA2KSB7XG4gICAgICAgIGFyZ2IgPSBwYXJzZUludChcIjB4RkZcIiArIGhleCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhGRlwiICsgaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IGFyZ2IgfTtcbn1cbmV4cG9ydHMucGFyc2VIZXhDb2xvciA9IHBhcnNlSGV4Q29sb3I7XG5mdW5jdGlvbiByZ2JhVG9BcmdiTnVtYmVyKHIsIGcsIGIsIGEpIHtcbiAgICBpZiAoYSA9PT0gdm9pZCAwKSB7IGEgPSAxOyB9XG4gICAgaWYgKHIgPj0gMCAmJiByIDw9IDI1NSAmJiBnID49IDAgJiYgZyA8PSAyNTUgJiYgYiA+PSAwICYmIGIgPD0gMjU1ICYmIGEgPj0gMCAmJiBhIDw9IDEpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJvdW5kKGEgKiAweEZGKSAqIDB4MDEwMDAwMDApICsgKHIgKiAweDAxMDAwMCkgKyAoZyAqIDB4MDAwMTAwKSArIChiICogMHgwMDAwMDEpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxudmFyIHJnYkNvbG9yUmVnRXggPSAvXFxzKihyZ2JcXChcXHMqKFxcZCopXFxzKixcXHMqKFxcZCopXFxzKixcXHMqKFxcZCopXFxzKlxcKSkvZ3k7XG5mdW5jdGlvbiBwYXJzZVJHQkNvbG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgcmdiQ29sb3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gcmdiQ29sb3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gcmdiQ29sb3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzFdICYmIHJnYmFUb0FyZ2JOdW1iZXIocGFyc2VJbnQocmVzdWx0WzJdKSwgcGFyc2VJbnQocmVzdWx0WzNdKSwgcGFyc2VJbnQocmVzdWx0WzRdKSk7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlUkdCQ29sb3IgPSBwYXJzZVJHQkNvbG9yO1xudmFyIHJnYmFDb2xvclJlZ0V4ID0gL1xccyoocmdiYVxcKFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooWzAxXT9cXC4/XFxkKilcXHMqXFwpKS9neTtcbmZ1bmN0aW9uIHBhcnNlUkdCQUNvbG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgcmdiYUNvbG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHJnYmFDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSByZ2JhQ29sb3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmdiYVRvQXJnYk51bWJlcihwYXJzZUludChyZXN1bHRbMl0pLCBwYXJzZUludChyZXN1bHRbM10pLCBwYXJzZUludChyZXN1bHRbNF0pLCBwYXJzZUZsb2F0KHJlc3VsdFs1XSkpO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVJHQkFDb2xvciA9IHBhcnNlUkdCQUNvbG9yO1xudmFyIGNvbG9ycztcbihmdW5jdGlvbiAoY29sb3JzKSB7XG4gICAgY29sb3JzW2NvbG9yc1tcInRyYW5zcGFyZW50XCJdID0gMF0gPSBcInRyYW5zcGFyZW50XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImFsaWNlYmx1ZVwiXSA9IDQyOTM5ODI0NjNdID0gXCJhbGljZWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYW50aXF1ZXdoaXRlXCJdID0gNDI5NDYzNDQ1NV0gPSBcImFudGlxdWV3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhcXVhXCJdID0gNDI3ODI1NTYxNV0gPSBcImFxdWFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYXF1YW1hcmluZVwiXSA9IDQyODY1Nzg2NDRdID0gXCJhcXVhbWFyaW5lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImF6dXJlXCJdID0gNDI5Mzk4NDI1NV0gPSBcImF6dXJlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJlaWdlXCJdID0gNDI5NDMwOTM0MF0gPSBcImJlaWdlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJpc3F1ZVwiXSA9IDQyOTQ5NjAzMjRdID0gXCJiaXNxdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmxhY2tcIl0gPSA0Mjc4MTkwMDgwXSA9IFwiYmxhY2tcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmxhbmNoZWRhbG1vbmRcIl0gPSA0Mjk0OTYyMTI1XSA9IFwiYmxhbmNoZWRhbG1vbmRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmx1ZVwiXSA9IDQyNzgxOTAzMzVdID0gXCJibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJsdWV2aW9sZXRcIl0gPSA0Mjg3MjQ1MjgyXSA9IFwiYmx1ZXZpb2xldFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJicm93blwiXSA9IDQyODkwMTQzMTRdID0gXCJicm93blwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJidXJseXdvb2RcIl0gPSA0MjkyNzg2MzExXSA9IFwiYnVybHl3b29kXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImNhZGV0Ymx1ZVwiXSA9IDQyODQ0NTY2MDhdID0gXCJjYWRldGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2hhcnRyZXVzZVwiXSA9IDQyODY1Nzg0MzJdID0gXCJjaGFydHJldXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImNob2NvbGF0ZVwiXSA9IDQyOTE5Nzk1NTBdID0gXCJjaG9jb2xhdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29yYWxcIl0gPSA0Mjk0OTM0MzUyXSA9IFwiY29yYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29ybmZsb3dlcmJsdWVcIl0gPSA0Mjg0NzgyMDYxXSA9IFwiY29ybmZsb3dlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29ybnNpbGtcIl0gPSA0Mjk0OTY1NDY4XSA9IFwiY29ybnNpbGtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY3JpbXNvblwiXSA9IDQyOTI2MTMxODBdID0gXCJjcmltc29uXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImN5YW5cIl0gPSA0Mjc4MjU1NjE1XSA9IFwiY3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrYmx1ZVwiXSA9IDQyNzgxOTAyMTldID0gXCJkYXJrYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrY3lhblwiXSA9IDQyNzgyMjU4MDNdID0gXCJkYXJrY3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ29sZGVucm9kXCJdID0gNDI5MDI4MzAxOV0gPSBcImRhcmtnb2xkZW5yb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya2dyYXlcIl0gPSA0Mjg5MzA5MDk3XSA9IFwiZGFya2dyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya2dyZWVuXCJdID0gNDI3ODIxNTY4MF0gPSBcImRhcmtncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JleVwiXSA9IDQyODkzMDkwOTddID0gXCJkYXJrZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJra2hha2lcIl0gPSA0MjkwNjIzMzM5XSA9IFwiZGFya2toYWtpXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmttYWdlbnRhXCJdID0gNDI4NzI5OTcyM10gPSBcImRhcmttYWdlbnRhXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvbGl2ZWdyZWVuXCJdID0gNDI4Mzc4ODA3OV0gPSBcImRhcmtvbGl2ZWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvcmFuZ2VcIl0gPSA0Mjk0OTM3NjAwXSA9IFwiZGFya29yYW5nZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrb3JjaGlkXCJdID0gNDI4ODIzMDA5Ml0gPSBcImRhcmtvcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3JlZFwiXSA9IDQyODcyOTk1ODRdID0gXCJkYXJrcmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzYWxtb25cIl0gPSA0MjkzNDk4NDkwXSA9IFwiZGFya3NhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2VhZ3JlZW5cIl0gPSA0Mjg3NjA5OTk5XSA9IFwiZGFya3NlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzbGF0ZWJsdWVcIl0gPSA0MjgyOTI0NDI3XSA9IFwiZGFya3NsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2xhdGVncmF5XCJdID0gNDI4MTI5MDU3NV0gPSBcImRhcmtzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NsYXRlZ3JleVwiXSA9IDQyODEyOTA1NzVdID0gXCJkYXJrc2xhdGVncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmt0dXJxdW9pc2VcIl0gPSA0Mjc4MjQzMDI1XSA9IFwiZGFya3R1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrdmlvbGV0XCJdID0gNDI4Nzg4OTYxOV0gPSBcImRhcmt2aW9sZXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGVlcHBpbmtcIl0gPSA0Mjk0OTA3MDI3XSA9IFwiZGVlcHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGVlcHNreWJsdWVcIl0gPSA0Mjc4MjM5MjMxXSA9IFwiZGVlcHNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGltZ3JheVwiXSA9IDQyODUwOTgzNDVdID0gXCJkaW1ncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRpbWdyZXlcIl0gPSA0Mjg1MDk4MzQ1XSA9IFwiZGltZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkb2RnZXJibHVlXCJdID0gNDI4MDE5MzI3OV0gPSBcImRvZGdlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZmlyZWJyaWNrXCJdID0gNDI4OTg2NDIyNl0gPSBcImZpcmVicmlja1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmbG9yYWx3aGl0ZVwiXSA9IDQyOTQ5NjYwMDBdID0gXCJmbG9yYWx3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmb3Jlc3RncmVlblwiXSA9IDQyODA0NTM5MjJdID0gXCJmb3Jlc3RncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmdWNoc2lhXCJdID0gNDI5NDkwMjAxNV0gPSBcImZ1Y2hzaWFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ2FpbnNib3JvXCJdID0gNDI5MjY2NDU0MF0gPSBcImdhaW5zYm9yb1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnaG9zdHdoaXRlXCJdID0gNDI5NDUwNjc1MV0gPSBcImdob3N0d2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ29sZFwiXSA9IDQyOTQ5NTY4MDBdID0gXCJnb2xkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdvbGRlbnJvZFwiXSA9IDQyOTI1MTkyMDBdID0gXCJnb2xkZW5yb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JheVwiXSA9IDQyODY2MTE1ODRdID0gXCJncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZWVuXCJdID0gNDI3ODIyMjg0OF0gPSBcImdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZWVueWVsbG93XCJdID0gNDI4OTU5MzEzNV0gPSBcImdyZWVueWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZXlcIl0gPSA0Mjg2NjExNTg0XSA9IFwiZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJob25leWRld1wiXSA9IDQyOTM5ODQyNDBdID0gXCJob25leWRld1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJob3RwaW5rXCJdID0gNDI5NDkyODgyMF0gPSBcImhvdHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiaW5kaWFucmVkXCJdID0gNDI5MTY0ODYwNF0gPSBcImluZGlhbnJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJpbmRpZ29cIl0gPSA0MjgzMTA1NDEwXSA9IFwiaW5kaWdvXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIml2b3J5XCJdID0gNDI5NDk2NzI4MF0gPSBcIml2b3J5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImtoYWtpXCJdID0gNDI5Mzk3Nzc0MF0gPSBcImtoYWtpXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhdmVuZGVyXCJdID0gNDI5MzMyMjQ5MF0gPSBcImxhdmVuZGVyXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhdmVuZGVyYmx1c2hcIl0gPSA0Mjk0OTYzNDQ1XSA9IFwibGF2ZW5kZXJibHVzaFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsYXduZ3JlZW5cIl0gPSA0Mjg2MzgxMDU2XSA9IFwibGF3bmdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxlbW9uY2hpZmZvblwiXSA9IDQyOTQ5NjU5NjVdID0gXCJsZW1vbmNoaWZmb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRibHVlXCJdID0gNDI4OTU4MzMzNF0gPSBcImxpZ2h0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGNvcmFsXCJdID0gNDI5Mzk1MTYxNl0gPSBcImxpZ2h0Y29yYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRjeWFuXCJdID0gNDI5MjkzNTY3OV0gPSBcImxpZ2h0Y3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdvbGRlbnJvZHllbGxvd1wiXSA9IDQyOTQ2MzgyOTBdID0gXCJsaWdodGdvbGRlbnJvZHllbGxvd1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdyYXlcIl0gPSA0MjkyMDcyNDAzXSA9IFwibGlnaHRncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JlZW5cIl0gPSA0Mjg3Njg4MzM2XSA9IFwibGlnaHRncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdyZXlcIl0gPSA0MjkyMDcyNDAzXSA9IFwibGlnaHRncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0cGlua1wiXSA9IDQyOTQ5NDg1NDVdID0gXCJsaWdodHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzYWxtb25cIl0gPSA0Mjk0OTQyODQyXSA9IFwibGlnaHRzYWxtb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzZWFncmVlblwiXSA9IDQyODAzMzI5NzBdID0gXCJsaWdodHNlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0c2t5Ymx1ZVwiXSA9IDQyODcwOTA0MjZdID0gXCJsaWdodHNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzbGF0ZWdyYXlcIl0gPSA0Mjg2MDIzODMzXSA9IFwibGlnaHRzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzbGF0ZWdyZXlcIl0gPSA0Mjg2MDIzODMzXSA9IFwibGlnaHRzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzdGVlbGJsdWVcIl0gPSA0Mjg5Nzc0ODE0XSA9IFwibGlnaHRzdGVlbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHR5ZWxsb3dcIl0gPSA0Mjk0OTY3MjY0XSA9IFwibGlnaHR5ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGltZVwiXSA9IDQyNzgyNTUzNjBdID0gXCJsaW1lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpbWVncmVlblwiXSA9IDQyODE1MTk0MTBdID0gXCJsaW1lZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGluZW5cIl0gPSA0Mjk0NjM1NzUwXSA9IFwibGluZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWFnZW50YVwiXSA9IDQyOTQ5MDIwMTVdID0gXCJtYWdlbnRhXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1hcm9vblwiXSA9IDQyODY1Nzg2ODhdID0gXCJtYXJvb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtYXF1YW1hcmluZVwiXSA9IDQyODQ5Mjc0MDJdID0gXCJtZWRpdW1hcXVhbWFyaW5lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bWJsdWVcIl0gPSA0Mjc4MTkwMjg1XSA9IFwibWVkaXVtYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1vcmNoaWRcIl0gPSA0MjkwNDAxNzQ3XSA9IFwibWVkaXVtb3JjaGlkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXB1cnBsZVwiXSA9IDQyODc4NTI3NjNdID0gXCJtZWRpdW1wdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtc2VhZ3JlZW5cIl0gPSA0MjgyMTY4MTc3XSA9IFwibWVkaXVtc2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtc2xhdGVibHVlXCJdID0gNDI4NjI3Nzg3MF0gPSBcIm1lZGl1bXNsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zcHJpbmdncmVlblwiXSA9IDQyNzgyNTQyMzRdID0gXCJtZWRpdW1zcHJpbmdncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW10dXJxdW9pc2VcIl0gPSA0MjgyOTYyMzgwXSA9IFwibWVkaXVtdHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXZpb2xldHJlZFwiXSA9IDQyOTEyMzcyNTNdID0gXCJtZWRpdW12aW9sZXRyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWlkbmlnaHRibHVlXCJdID0gNDI3OTgzNDk5Ml0gPSBcIm1pZG5pZ2h0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtaW50Y3JlYW1cIl0gPSA0Mjk0MzExOTMwXSA9IFwibWludGNyZWFtXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1pc3R5cm9zZVwiXSA9IDQyOTQ5NjAzNTNdID0gXCJtaXN0eXJvc2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibW9jY2FzaW5cIl0gPSA0Mjk0OTYwMzA5XSA9IFwibW9jY2FzaW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibmF2YWpvd2hpdGVcIl0gPSA0Mjk0OTU4NzY1XSA9IFwibmF2YWpvd2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibmF2eVwiXSA9IDQyNzgxOTAyMDhdID0gXCJuYXZ5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9sZGxhY2VcIl0gPSA0Mjk0ODMzNjM4XSA9IFwib2xkbGFjZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvbGl2ZVwiXSA9IDQyODY2MTE0NTZdID0gXCJvbGl2ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvbGl2ZWRyYWJcIl0gPSA0Mjg1MjM4ODE5XSA9IFwib2xpdmVkcmFiXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9yYW5nZVwiXSA9IDQyOTQ5NDQwMDBdID0gXCJvcmFuZ2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib3JhbmdlcmVkXCJdID0gNDI5NDkxOTQyNF0gPSBcIm9yYW5nZXJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvcmNoaWRcIl0gPSA0MjkyNTA1ODE0XSA9IFwib3JjaGlkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGVnb2xkZW5yb2RcIl0gPSA0MjkzODQ3MjEwXSA9IFwicGFsZWdvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYWxlZ3JlZW5cIl0gPSA0Mjg4MjE1OTYwXSA9IFwicGFsZWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGV0dXJxdW9pc2VcIl0gPSA0Mjg5NzIwMDQ2XSA9IFwicGFsZXR1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYWxldmlvbGV0cmVkXCJdID0gNDI5MjU3MTI4M10gPSBcInBhbGV2aW9sZXRyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFwYXlhd2hpcFwiXSA9IDQyOTQ5NjMxNTddID0gXCJwYXBheWF3aGlwXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBlYWNocHVmZlwiXSA9IDQyOTQ5NTc3NTNdID0gXCJwZWFjaHB1ZmZcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGVydVwiXSA9IDQyOTE2NTkwNzFdID0gXCJwZXJ1XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBpbmtcIl0gPSA0Mjk0OTUxMTE1XSA9IFwicGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwbHVtXCJdID0gNDI5MjcxNDcxN10gPSBcInBsdW1cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicG93ZGVyYmx1ZVwiXSA9IDQyODk3ODE5OTBdID0gXCJwb3dkZXJibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInB1cnBsZVwiXSA9IDQyODY1Nzg4MTZdID0gXCJwdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicmViZWNjYXB1cnBsZVwiXSA9IDQyODQ4ODc5NjFdID0gXCJyZWJlY2NhcHVycGxlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInJlZFwiXSA9IDQyOTQ5MDE3NjBdID0gXCJyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicm9zeWJyb3duXCJdID0gNDI5MDU0NzU5OV0gPSBcInJvc3licm93blwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyb3lhbGJsdWVcIl0gPSA0MjgyNDc3MDI1XSA9IFwicm95YWxibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNhZGRsZWJyb3duXCJdID0gNDI4NzMxNzI2N10gPSBcInNhZGRsZWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNhbG1vblwiXSA9IDQyOTQ2MDY5NjJdID0gXCJzYWxtb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FuZHlicm93blwiXSA9IDQyOTQyMjI5NDRdID0gXCJzYW5keWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNlYWdyZWVuXCJdID0gNDI4MTI0MDQwN10gPSBcInNlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNlYXNoZWxsXCJdID0gNDI5NDk2NDcxOF0gPSBcInNlYXNoZWxsXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNpZW5uYVwiXSA9IDQyODg2OTY4NzddID0gXCJzaWVubmFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2lsdmVyXCJdID0gNDI5MDgyMjMzNl0gPSBcInNpbHZlclwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJza3libHVlXCJdID0gNDI4NzA5MDQxMV0gPSBcInNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2xhdGVibHVlXCJdID0gNDI4NTE2MDE0MV0gPSBcInNsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbGF0ZWdyYXlcIl0gPSA0Mjg1NTYzMDI0XSA9IFwic2xhdGVncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNsYXRlZ3JleVwiXSA9IDQyODU1NjMwMjRdID0gXCJzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic25vd1wiXSA9IDQyOTQ5NjYwMTBdID0gXCJzbm93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNwcmluZ2dyZWVuXCJdID0gNDI3ODI1NTQ4N10gPSBcInNwcmluZ2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInN0ZWVsYmx1ZVwiXSA9IDQyODI4MTEwNjBdID0gXCJzdGVlbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widGFuXCJdID0gNDI5MTk5ODg2MF0gPSBcInRhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0ZWFsXCJdID0gNDI3ODIyMjk3Nl0gPSBcInRlYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widGhpc3RsZVwiXSA9IDQyOTIzOTQ5NjhdID0gXCJ0aGlzdGxlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInRvbWF0b1wiXSA9IDQyOTQ5MjcxNzVdID0gXCJ0b21hdG9cIjtcbiAgICBjb2xvcnNbY29sb3JzW1widHVycXVvaXNlXCJdID0gNDI4MjQ0MTkzNl0gPSBcInR1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ2aW9sZXRcIl0gPSA0MjkzODIxMTY2XSA9IFwidmlvbGV0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoZWF0XCJdID0gNDI5NDMwMzQxMV0gPSBcIndoZWF0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoaXRlXCJdID0gNDI5NDk2NzI5NV0gPSBcIndoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoaXRlc21va2VcIl0gPSA0Mjk0MzA5MzY1XSA9IFwid2hpdGVzbW9rZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ5ZWxsb3dcIl0gPSA0Mjk0OTY3MDQwXSA9IFwieWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInllbGxvd2dyZWVuXCJdID0gNDI4ODMzNTE1NF0gPSBcInllbGxvd2dyZWVuXCI7XG59KShjb2xvcnMgPSBleHBvcnRzLmNvbG9ycyB8fCAoZXhwb3J0cy5jb2xvcnMgPSB7fSkpO1xuZnVuY3Rpb24gcGFyc2VDb2xvcktleXdvcmQodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHZhbHVlLCBzdGFydCk7IH1cbiAgICBpZiAoa2V5d29yZCAmJiBrZXl3b3JkLnZhbHVlIGluIGNvbG9ycykge1xuICAgICAgICB2YXIgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZV8xID0gY29sb3JzW2tleXdvcmQudmFsdWVdO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWVfMSB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VDb2xvcktleXdvcmQgPSBwYXJzZUNvbG9yS2V5d29yZDtcbmZ1bmN0aW9uIHBhcnNlQ29sb3IodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHZhbHVlLCBzdGFydCk7IH1cbiAgICByZXR1cm4gcGFyc2VIZXhDb2xvcih2YWx1ZSwgc3RhcnQpIHx8IHBhcnNlQ29sb3JLZXl3b3JkKHZhbHVlLCBzdGFydCwga2V5d29yZCkgfHwgcGFyc2VSR0JDb2xvcih2YWx1ZSwgc3RhcnQpIHx8IHBhcnNlUkdCQUNvbG9yKHZhbHVlLCBzdGFydCk7XG59XG5leHBvcnRzLnBhcnNlQ29sb3IgPSBwYXJzZUNvbG9yO1xudmFyIGtleXdvcmRSZWdFeCA9IC9cXHMqKFthLXpdW1xcd1xcLV0qKVxccyovZ2l5O1xuZnVuY3Rpb24gcGFyc2VLZXl3b3JkKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAga2V5d29yZFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBrZXl3b3JkUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGtleXdvcmRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzFdO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxudmFyIGJhY2tncm91bmRSZXBlYXRLZXl3b3JkcyA9IG5ldyBTZXQoW1wicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBcIm5vLXJlcGVhdFwiXSk7XG5mdW5jdGlvbiBwYXJzZVJlcGVhdCh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRSZXBlYXRLZXl3b3Jkcy5oYXMoa2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgdmFyIGVuZCA9IGtleXdvcmQuZW5kO1xuICAgICAgICB2YXIgdmFsdWVfMiA9IGtleXdvcmQudmFsdWU7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV8yIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5wYXJzZVJlcGVhdCA9IHBhcnNlUmVwZWF0O1xudmFyIHVuaXRSZWdFeCA9IC9cXHMqKFtcXCtcXC1dPyg/OlxcZCtcXC5cXGQrfFxcZCt8XFwuXFxkKykoPzpbZUVdW1xcK1xcLV0/XFxkKyk/KShbYS16QS1aXSt8JSk/XFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlVW5pdCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVuaXRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gdW5pdFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSB1bml0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQocmVzdWx0WzFdKTtcbiAgICB2YXIgdW5pdCA9IHJlc3VsdFsyXSB8fCBcImRpcFwiO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHZhbHVlOiB2YWx1ZSwgdW5pdDogdW5pdCB9IH07XG59XG5leHBvcnRzLnBhcnNlVW5pdCA9IHBhcnNlVW5pdDtcbmZ1bmN0aW9uIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdmFyIHVuaXRSZXN1bHQgPSBwYXJzZVVuaXQodGV4dCwgc3RhcnQpO1xuICAgIGlmICh1bml0UmVzdWx0KSB7XG4gICAgICAgIHZhciBzdGFydF8xID0gdW5pdFJlc3VsdC5zdGFydCwgZW5kID0gdW5pdFJlc3VsdC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZSA9IHVuaXRSZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZS51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgdmFsdWUudmFsdWUgLz0gMTAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF2YWx1ZS51bml0KSB7XG4gICAgICAgICAgICB2YWx1ZS51bml0ID0gXCJkaXBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZS51bml0ID09PSBcInB4XCIgfHwgdmFsdWUudW5pdCA9PT0gXCJkaXBcIikge1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0XzEsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGg7XG52YXIgYW5nbGVVbml0c1RvUmFkTWFwID0ge1xuICAgIFwiZGVnXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCBkZWcpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiBkZWcgLyAxODAgKiBNYXRoLlBJIH0pOyB9LFxuICAgIFwicmFkXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCByYWQpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiByYWQgfSk7IH0sXG4gICAgXCJncmFkXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCBncmFkKSB7IHJldHVybiAoeyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogZ3JhZCAvIDIwMCAqIE1hdGguUEkgfSk7IH0sXG4gICAgXCJ0dXJuXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCB0dXJuKSB7IHJldHVybiAoeyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdHVybiAqIE1hdGguUEkgKiAyIH0pOyB9XG59O1xuZnVuY3Rpb24gcGFyc2VBbmdsZSh2YWx1ZSwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgYW5nbGVSZXN1bHQgPSBwYXJzZVVuaXQodmFsdWUsIHN0YXJ0KTtcbiAgICBpZiAoYW5nbGVSZXN1bHQpIHtcbiAgICAgICAgdmFyIHN0YXJ0XzIgPSBhbmdsZVJlc3VsdC5zdGFydCwgZW5kID0gYW5nbGVSZXN1bHQuZW5kLCB2YWx1ZV8zID0gYW5nbGVSZXN1bHQudmFsdWU7XG4gICAgICAgIHJldHVybiAoYW5nbGVVbml0c1RvUmFkTWFwW3ZhbHVlXzMudW5pdF0gfHwgKGZ1bmN0aW9uIChfLCBfXywgX19fKSB7IHJldHVybiBudWxsOyB9KSkoc3RhcnRfMiwgZW5kLCB2YWx1ZV8zLnZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlQW5nbGUgPSBwYXJzZUFuZ2xlO1xudmFyIGJhY2tncm91bmRTaXplS2V5d29yZHMgPSBuZXcgU2V0KFtcImF1dG9cIiwgXCJjb250YWluXCIsIFwiY292ZXJcIl0pO1xuZnVuY3Rpb24gcGFyc2VCYWNrZ3JvdW5kU2l6ZSh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICBpZiAoa2V5d29yZCAmJiBiYWNrZ3JvdW5kU2l6ZUtleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIHZhbHVlXzQgPSBrZXl3b3JkLnZhbHVlO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWVfNCB9O1xuICAgIH1cbiAgICB2YXIgZmlyc3RMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh2YWx1ZSwgZW5kKTtcbiAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgZW5kID0gZmlyc3RMZW5ndGguZW5kO1xuICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodmFsdWUsIGZpcnN0TGVuZ3RoLmVuZCk7XG4gICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IHNlY29uZExlbmd0aC5lbmQ7XG4gICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiBmaXJzdExlbmd0aC52YWx1ZSwgeTogc2Vjb25kTGVuZ3RoLnZhbHVlIH0gfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZpcnN0TGVuZ3RoLnZhbHVlLCB5OiBcImF1dG9cIiB9IH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlQmFja2dyb3VuZFNpemUgPSBwYXJzZUJhY2tncm91bmRTaXplO1xudmFyIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzID0gT2JqZWN0LmZyZWV6ZShuZXcgU2V0KFtcImxlZnRcIiwgXCJyaWdodFwiLCBcInRvcFwiLCBcImJvdHRvbVwiLCBcImNlbnRlclwiXSkpO1xudmFyIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uID0ge1xuICAgIFwibGVmdFwiOiBcInhcIixcbiAgICBcInJpZ2h0XCI6IFwieFwiLFxuICAgIFwiY2VudGVyXCI6IFwiY2VudGVyXCIsXG4gICAgXCJ0b3BcIjogXCJ5XCIsXG4gICAgXCJib3R0b21cIjogXCJ5XCJcbn07XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmRQb3NpdGlvbih0ZXh0LCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh0ZXh0LCBzdGFydCk7IH1cbiAgICBmdW5jdGlvbiBmb3JtYXRIKGFsaWduLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKGFsaWduLnZhbHVlID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjZW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC52YWx1ZS52YWx1ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgYWxpZ246IGFsaWduLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlnbi52YWx1ZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9ybWF0VihhbGlnbiwgb2Zmc2V0KSB7XG4gICAgICAgIGlmIChhbGlnbi52YWx1ZSA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgcmV0dXJuIFwiY2VudGVyXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9mZnNldCAmJiBvZmZzZXQudmFsdWUudmFsdWUgIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7IGFsaWduOiBhbGlnbi52YWx1ZSwgb2Zmc2V0OiBvZmZzZXQudmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxpZ24udmFsdWU7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICBpZiAoa2V5d29yZCAmJiBiYWNrZ3JvdW5kUG9zaXRpb25LZXl3b3Jkcy5oYXMoa2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciBmaXJzdERpcmVjdGlvbiA9IGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uW2tleXdvcmQudmFsdWVdO1xuICAgICAgICB2YXIgZmlyc3RMZW5ndGggPSBmaXJzdERpcmVjdGlvbiAhPT0gXCJjZW50ZXJcIiAmJiBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IGZpcnN0TGVuZ3RoLmVuZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Vjb25kS2V5d29yZCA9IHBhcnNlS2V5d29yZCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoc2Vjb25kS2V5d29yZCAmJiBiYWNrZ3JvdW5kUG9zaXRpb25LZXl3b3Jkcy5oYXMoc2Vjb25kS2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgICAgIGVuZCA9IHNlY29uZEtleXdvcmQuZW5kO1xuICAgICAgICAgICAgdmFyIHNlY29uZERpcmVjdGlvbiA9IGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uW3NlY29uZEtleXdvcmQuZW5kXTtcbiAgICAgICAgICAgIGlmIChmaXJzdERpcmVjdGlvbiA9PT0gc2Vjb25kRGlyZWN0aW9uICYmIGZpcnN0RGlyZWN0aW9uICE9PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gc2Vjb25kRGlyZWN0aW9uICE9PSBcImNlbnRlclwiICYmIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgICAgICAgICBpZiAoc2Vjb25kTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZW5kID0gc2Vjb25kTGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoZmlyc3REaXJlY3Rpb24gPT09IHNlY29uZERpcmVjdGlvbiAmJiBzZWNvbmREaXJlY3Rpb24gPT09IFwiY2VudGVyXCIpIHx8IChmaXJzdERpcmVjdGlvbiA9PT0gXCJ4XCIgfHwgc2Vjb25kRGlyZWN0aW9uID09PSBcInlcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogZm9ybWF0SChrZXl3b3JkLCBmaXJzdExlbmd0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBmb3JtYXRWKHNlY29uZEtleXdvcmQsIHNlY29uZExlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IGZvcm1hdEgoc2Vjb25kS2V5d29yZCwgc2Vjb25kTGVuZ3RoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvcm1hdFYoa2V5d29yZCwgZmlyc3RMZW5ndGgpLFxuICAgICAgICAgICAgICAgICAgICB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZmlyc3REaXJlY3Rpb24gPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiBcImNlbnRlclwiLCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZpcnN0RGlyZWN0aW9uID09PSBcInhcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZvcm1hdEgoa2V5d29yZCwgZmlyc3RMZW5ndGgpLCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IFwiY2VudGVyXCIsIHk6IGZvcm1hdFYoa2V5d29yZCwgZmlyc3RMZW5ndGgpIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGZpcnN0TGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKGZpcnN0TGVuZ3RoKSB7XG4gICAgICAgICAgICBlbmQgPSBmaXJzdExlbmd0aC5lbmQ7XG4gICAgICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzZWNvbmRMZW5ndGguZW5kO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IHsgYWxpZ246IFwibGVmdFwiLCBvZmZzZXQ6IGZpcnN0TGVuZ3RoLnZhbHVlIH0sIHk6IHsgYWxpZ246IFwidG9wXCIsIG9mZnNldDogc2Vjb25kTGVuZ3RoLnZhbHVlIH0gfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogeyBhbGlnbjogXCJsZWZ0XCIsIG9mZnNldDogZmlyc3RMZW5ndGgudmFsdWUgfSwgeTogXCJjZW50ZXJcIiB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kUG9zaXRpb24gPSBwYXJzZUJhY2tncm91bmRQb3NpdGlvbjtcbnZhciBkaXJlY3Rpb25SZWdFeCA9IC9cXHMqdG9cXHMqKGxlZnR8cmlnaHR8dG9wfGJvdHRvbSlcXHMqKGxlZnR8cmlnaHR8dG9wfGJvdHRvbSk/XFxzKi9neTtcbnZhciBzaWRlRGlyZWN0aW9ucyA9IHtcbiAgICB0b3A6IE1hdGguUEkgKiAwIC8gMixcbiAgICByaWdodDogTWF0aC5QSSAqIDEgLyAyLFxuICAgIGJvdHRvbTogTWF0aC5QSSAqIDIgLyAyLFxuICAgIGxlZnQ6IE1hdGguUEkgKiAzIC8gMlxufTtcbnZhciBjb3JuZXJEaXJlY3Rpb25zID0ge1xuICAgIHRvcDoge1xuICAgICAgICByaWdodDogTWF0aC5QSSAqIDEgLyA0LFxuICAgICAgICBsZWZ0OiBNYXRoLlBJICogNyAvIDRcbiAgICB9LFxuICAgIHJpZ2h0OiB7XG4gICAgICAgIHRvcDogTWF0aC5QSSAqIDEgLyA0LFxuICAgICAgICBib3R0b206IE1hdGguUEkgKiAzIC8gNFxuICAgIH0sXG4gICAgYm90dG9tOiB7XG4gICAgICAgIHJpZ2h0OiBNYXRoLlBJICogMyAvIDQsXG4gICAgICAgIGxlZnQ6IE1hdGguUEkgKiA1IC8gNFxuICAgIH0sXG4gICAgbGVmdDoge1xuICAgICAgICB0b3A6IE1hdGguUEkgKiA3IC8gNCxcbiAgICAgICAgYm90dG9tOiBNYXRoLlBJICogNSAvIDRcbiAgICB9XG59O1xuZnVuY3Rpb24gcGFyc2VEaXJlY3Rpb24odGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBkaXJlY3Rpb25SZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gZGlyZWN0aW9uUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGRpcmVjdGlvblJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgZmlyc3REaXJlY3Rpb24gPSByZXN1bHRbMV07XG4gICAgaWYgKHJlc3VsdFsyXSkge1xuICAgICAgICB2YXIgc2Vjb25kRGlyZWN0aW9uID0gcmVzdWx0WzJdO1xuICAgICAgICB2YXIgdmFsdWUgPSBjb3JuZXJEaXJlY3Rpb25zW2ZpcnN0RGlyZWN0aW9uXVtzZWNvbmREaXJlY3Rpb25dO1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHNpZGVEaXJlY3Rpb25zW2ZpcnN0RGlyZWN0aW9uXSB9O1xuICAgIH1cbn1cbnZhciBvcGVuaW5nQnJhY2tldFJlZ0V4ID0gL1xccypcXChcXHMqL2d5O1xudmFyIGNsb3NpbmdCcmFja2V0UmVnRXggPSAvXFxzKlxcKVxccyovZ3k7XG52YXIgY2xvc2luZ0JyYWNrZXRPckNvbW1hUmVnRXggPSAvXFxzKihcXCl8LClcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VBcmd1bWVudHNMaXN0KHRleHQsIHN0YXJ0LCBhcmd1bWVudCkge1xuICAgIG9wZW5pbmdCcmFja2V0UmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIG9wZW5pbmdCcmFja2V0ID0gb3BlbmluZ0JyYWNrZXRSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghb3BlbmluZ0JyYWNrZXQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBvcGVuaW5nQnJhY2tldFJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSBbXTtcbiAgICBjbG9zaW5nQnJhY2tldFJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICB2YXIgY2xvc2luZ0JyYWNrZXQgPSBjbG9zaW5nQnJhY2tldFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKGNsb3NpbmdCcmFja2V0KSB7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBmb3IgKHZhciBpbmRleF8xID0gMDsgdHJ1ZTsgaW5kZXhfMSsrKSB7XG4gICAgICAgIHZhciBhcmcgPSBhcmd1bWVudCh0ZXh0LCBlbmQsIGluZGV4XzEpO1xuICAgICAgICBpZiAoIWFyZykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZW5kID0gYXJnLmVuZDtcbiAgICAgICAgdmFsdWUucHVzaChhcmcpO1xuICAgICAgICBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5sYXN0SW5kZXggPSBlbmQ7XG4gICAgICAgIHZhciBjbG9zaW5nQnJhY2tldE9yQ29tbWEgPSBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5leGVjKHRleHQpO1xuICAgICAgICBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hKSB7XG4gICAgICAgICAgICBlbmQgPSBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgICAgICBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hWzFdID09PSBcIixcIikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hWzFdID09PSBcIilcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUNvbG9yU3RvcCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3IodGV4dCwgc3RhcnQpO1xuICAgIGlmICghY29sb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBjb2xvci5lbmQ7XG4gICAgdmFyIG9mZnNldCA9IHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgaWYgKG9mZnNldCkge1xuICAgICAgICBlbmQgPSBvZmZzZXQuZW5kO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhcmdiOiBjb2xvci52YWx1ZSwgb2Zmc2V0OiBvZmZzZXQudmFsdWUgfSB9O1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhcmdiOiBjb2xvci52YWx1ZSB9IH07XG59XG5leHBvcnRzLnBhcnNlQ29sb3JTdG9wID0gcGFyc2VDb2xvclN0b3A7XG52YXIgbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4ID0gL1xccypsaW5lYXItZ3JhZGllbnRcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VMaW5lYXJHcmFkaWVudCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGxpbmVhckdyYWRpZW50U3RhcnRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgbGdzID0gbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFsZ3MpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBhbmdsZSA9IE1hdGguUEk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuICAgIHZhciBwYXJzZWRBcmdzID0gcGFyc2VBcmd1bWVudHNMaXN0KHRleHQsIGVuZCwgZnVuY3Rpb24gKHRleHQsIHN0YXJ0LCBpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBhbmdsZUFyZyA9IHBhcnNlQW5nbGUodGV4dCwgc3RhcnQpIHx8IHBhcnNlRGlyZWN0aW9uKHRleHQsIHN0YXJ0KTtcbiAgICAgICAgICAgIGlmIChhbmdsZUFyZykge1xuICAgICAgICAgICAgICAgIGFuZ2xlID0gYW5nbGVBcmcudmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ2xlQXJnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xvclN0b3AgPSBwYXJzZUNvbG9yU3RvcCh0ZXh0LCBzdGFydCk7XG4gICAgICAgIGlmIChjb2xvclN0b3ApIHtcbiAgICAgICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yU3RvcC52YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gY29sb3JTdG9wO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0pO1xuICAgIGlmICghcGFyc2VkQXJncykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZW5kID0gcGFyc2VkQXJncy5lbmQ7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgYW5nbGU6IGFuZ2xlLCBjb2xvcnM6IGNvbG9ycyB9IH07XG59XG5leHBvcnRzLnBhcnNlTGluZWFyR3JhZGllbnQgPSBwYXJzZUxpbmVhckdyYWRpZW50O1xudmFyIHNsYXNoUmVnRXggPSAvXFxzKihcXC8pXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlU2xhc2godGV4dCwgc3RhcnQpIHtcbiAgICBzbGFzaFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciBzbGFzaCA9IHNsYXNoUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXNsYXNoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gc2xhc2hSZWdFeC5sYXN0SW5kZXg7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IFwiL1wiIH07XG59XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmQodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgdmFsdWUgPSB7fTtcbiAgICB2YXIgZW5kID0gc3RhcnQ7XG4gICAgd2hpbGUgKGVuZCA8IHRleHQubGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIGVuZCk7XG4gICAgICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3IodGV4dCwgZW5kLCBrZXl3b3JkKTtcbiAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICB2YWx1ZS5jb2xvciA9IGNvbG9yLnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gY29sb3IuZW5kO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlcGVhdCA9IHBhcnNlUmVwZWF0KHRleHQsIGVuZCwga2V5d29yZCk7XG4gICAgICAgIGlmIChyZXBlYXQpIHtcbiAgICAgICAgICAgIHZhbHVlLnJlcGVhdCA9IHJlcGVhdC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHJlcGVhdC5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcG9zaXRpb24gPSBwYXJzZUJhY2tncm91bmRQb3NpdGlvbih0ZXh0LCBlbmQsIGtleXdvcmQpO1xuICAgICAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHBvc2l0aW9uLnZhbHVlLnRleHQgPSB0ZXh0LnN1YnN0cmluZyhwb3NpdGlvbi5zdGFydCwgcG9zaXRpb24uZW5kKTtcbiAgICAgICAgICAgIHZhbHVlLnBvc2l0aW9uID0gcG9zaXRpb24udmFsdWU7XG4gICAgICAgICAgICBlbmQgPSBwb3NpdGlvbi5lbmQ7XG4gICAgICAgICAgICB2YXIgc2xhc2ggPSBwYXJzZVNsYXNoKHRleHQsIGVuZCk7XG4gICAgICAgICAgICBpZiAoc2xhc2gpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzbGFzaC5lbmQ7XG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBwYXJzZUJhY2tncm91bmRTaXplKHRleHQsIGVuZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YWx1ZS5zaXplID0gc2l6ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICBlbmQgPSBzaXplLmVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1cmwgPSBwYXJzZVVSTCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAodXJsKSB7XG4gICAgICAgICAgICB2YWx1ZS5pbWFnZSA9IHVybC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHVybC5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ3JhZGllbnQgPSBwYXJzZUxpbmVhckdyYWRpZW50KHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChncmFkaWVudCkge1xuICAgICAgICAgICAgdmFsdWUuaW1hZ2UgPSBncmFkaWVudC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IGdyYWRpZW50LmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kID0gcGFyc2VCYWNrZ3JvdW5kO1xudmFyIHVuaXZlcnNhbFNlbGVjdG9yUmVnRXggPSAvXFwqL2d5O1xuZnVuY3Rpb24gcGFyc2VVbml2ZXJzYWxTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVuaXZlcnNhbFNlbGVjdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHVuaXZlcnNhbFNlbGVjdG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHVuaXZlcnNhbFNlbGVjdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHR5cGU6IFwiKlwiIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VVbml2ZXJzYWxTZWxlY3RvciA9IHBhcnNlVW5pdmVyc2FsU2VsZWN0b3I7XG52YXIgc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXggPSAvKCN8XFwufDp8XFxiKShbXy1cXHddW18tXFx3XFxkXFxcXC9dKikvZ3k7XG5mdW5jdGlvbiBwYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHNpbXBsZUlkZW50aWZpZXJTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB0eXBlID0gcmVzdWx0WzFdO1xuICAgIHZhciBpZGVudGlmaWVyID0gcmVzdWx0WzJdLnJlcGxhY2UoL1xcXFwvZywgXCJcIik7XG4gICAgdmFyIHZhbHVlID0geyB0eXBlOiB0eXBlLCBpZGVudGlmaWVyOiBpZGVudGlmaWVyIH07XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlU2ltcGxlSWRlbnRpZmllclNlbGVjdG9yID0gcGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3I7XG52YXIgYXR0cmlidXRlU2VsZWN0b3JSZWdFeCA9IC9cXFtcXHMqKFtfLVxcd11bXy1cXHdcXGRdKilcXHMqKD86KD18XFxePXxcXCQ9fFxcKj18XFx+PXxcXHw9KVxccyooPzooW18tXFx3XVtfLVxcd1xcZF0qKXxcIigoPzpbXlxcXFxcIl18XFxcXCg/OlwifG58cnxmfFxcXFx8MC05YS1mKSkqKVwifCcoKD86W15cXFxcJ118XFxcXCg/Oid8bnxyfGZ8XFxcXHwwLTlhLWYpKSopJylcXHMqKT9cXF0vZ3k7XG5mdW5jdGlvbiBwYXJzZUF0dHJpYnV0ZVNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgYXR0cmlidXRlU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gYXR0cmlidXRlU2VsZWN0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gYXR0cmlidXRlU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHByb3BlcnR5ID0gcmVzdWx0WzFdO1xuICAgIGlmIChyZXN1bHRbMl0pIHtcbiAgICAgICAgdmFyIHRlc3RfMSA9IHJlc3VsdFsyXTtcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0WzNdIHx8IHJlc3VsdFs0XSB8fCByZXN1bHRbNV07XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHR5cGU6IFwiW11cIiwgcHJvcGVydHk6IHByb3BlcnR5LCB0ZXN0OiB0ZXN0XzEsIHZhbHVlOiB2YWx1ZSB9IH07XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHR5cGU6IFwiW11cIiwgcHJvcGVydHk6IHByb3BlcnR5IH0gfTtcbn1cbmV4cG9ydHMucGFyc2VBdHRyaWJ1dGVTZWxlY3RvciA9IHBhcnNlQXR0cmlidXRlU2VsZWN0b3I7XG5mdW5jdGlvbiBwYXJzZVNpbXBsZVNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgcmV0dXJuIHBhcnNlVW5pdmVyc2FsU2VsZWN0b3IodGV4dCwgc3RhcnQpIHx8XG4gICAgICAgIHBhcnNlU2ltcGxlSWRlbnRpZmllclNlbGVjdG9yKHRleHQsIHN0YXJ0KSB8fFxuICAgICAgICBwYXJzZUF0dHJpYnV0ZVNlbGVjdG9yKHRleHQsIHN0YXJ0KTtcbn1cbmV4cG9ydHMucGFyc2VTaW1wbGVTZWxlY3RvciA9IHBhcnNlU2ltcGxlU2VsZWN0b3I7XG5mdW5jdGlvbiBwYXJzZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2UodGV4dCwgc3RhcnQpIHtcbiAgICB2YXIgc2ltcGxlU2VsZWN0b3IgPSBwYXJzZVNpbXBsZVNlbGVjdG9yKHRleHQsIHN0YXJ0KTtcbiAgICBpZiAoIXNpbXBsZVNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gc2ltcGxlU2VsZWN0b3IuZW5kO1xuICAgIHZhciB2YWx1ZSA9IFtdO1xuICAgIHdoaWxlIChzaW1wbGVTZWxlY3Rvcikge1xuICAgICAgICB2YWx1ZS5wdXNoKHNpbXBsZVNlbGVjdG9yLnZhbHVlKTtcbiAgICAgICAgZW5kID0gc2ltcGxlU2VsZWN0b3IuZW5kO1xuICAgICAgICBzaW1wbGVTZWxlY3RvciA9IHBhcnNlU2ltcGxlU2VsZWN0b3IodGV4dCwgZW5kKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IHBhcnNlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZTtcbnZhciBjb21iaW5hdG9yUmVnRXggPSAvXFxzKihcXCt8fnw+KT9cXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VDb21iaW5hdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgY29tYmluYXRvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBjb21iaW5hdG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGNvbWJpbmF0b3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzFdIHx8IFwiIFwiO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZUNvbWJpbmF0b3IgPSBwYXJzZUNvbWJpbmF0b3I7XG52YXIgd2hpdGVTcGFjZVJlZ0V4ID0gL1xccyovZ3k7XG5mdW5jdGlvbiBwYXJzZVNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgIHdoaXRlU3BhY2VSZWdFeC5sYXN0SW5kZXggPSBlbmQ7XG4gICAgdmFyIGxlYWRpbmdXaGl0ZVNwYWNlID0gd2hpdGVTcGFjZVJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKGxlYWRpbmdXaGl0ZVNwYWNlKSB7XG4gICAgICAgIGVuZCA9IHdoaXRlU3BhY2VSZWdFeC5sYXN0SW5kZXg7XG4gICAgfVxuICAgIHZhciB2YWx1ZSA9IFtdO1xuICAgIHZhciBjb21iaW5hdG9yO1xuICAgIHZhciBleHBlY3RTaW1wbGVTZWxlY3RvciA9IHRydWU7XG4gICAgdmFyIHBhaXI7XG4gICAgZG8ge1xuICAgICAgICB2YXIgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IHBhcnNlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoIXNpbXBsZVNlbGVjdG9yU2VxdWVuY2UpIHtcbiAgICAgICAgICAgIGlmIChleHBlY3RTaW1wbGVTZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZW5kID0gc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5lbmQ7XG4gICAgICAgIGlmIChjb21iaW5hdG9yKSB7XG4gICAgICAgICAgICBwYWlyWzFdID0gY29tYmluYXRvci52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBwYWlyID0gW3NpbXBsZVNlbGVjdG9yU2VxdWVuY2UudmFsdWUsIHVuZGVmaW5lZF07XG4gICAgICAgIHZhbHVlLnB1c2gocGFpcik7XG4gICAgICAgIGNvbWJpbmF0b3IgPSBwYXJzZUNvbWJpbmF0b3IodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKGNvbWJpbmF0b3IpIHtcbiAgICAgICAgICAgIGVuZCA9IGNvbWJpbmF0b3IuZW5kO1xuICAgICAgICB9XG4gICAgICAgIGV4cGVjdFNpbXBsZVNlbGVjdG9yID0gY29tYmluYXRvciAmJiBjb21iaW5hdG9yLnZhbHVlICE9PSBcIiBcIjtcbiAgICB9IHdoaWxlIChjb21iaW5hdG9yKTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VTZWxlY3RvciA9IHBhcnNlU2VsZWN0b3I7XG52YXIgd2hpdGVzcGFjZVJlZ0V4ID0gL1tcXHNcXHRcXG5cXHJcXGZdKi9neW07XG52YXIgc2luZ2xlUXVvdGVTdHJpbmdSZWdFeCA9IC8nKCg/OlteXFxuXFxyXFxmXFwnXXxcXFxcKD86XFwkfFxcbnxbMC05YS1mQS1GXXsxLDZ9XFxzPykpKikoOj8nfCQpL2d5bTtcbnZhciBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4ID0gL1wiKCg/OlteXFxuXFxyXFxmXFxcIl18XFxcXCg/OlxcJHxcXG58WzAtOWEtZkEtRl17MSw2fVxccz8pKSopKDo/XCJ8JCkvZ3ltO1xudmFyIGNvbW1lbnRSZWdFeCA9IC8oXFwvXFwqKD86W15cXCpdfFxcKlteXFwvXSkqXFwqXFwvKS9neW07XG52YXIgbnVtYmVyUmVnRXggPSAvW1xcK1xcLV0/KD86XFxkK1xcLlxcZCt8XFxkK3xcXC5cXGQrKSg/OltlRV1bXFwrXFwtXT9cXGQrKT8vZ3ltO1xudmFyIG5hbWVSZWdFeCA9IC8tPyg/Oig/OlthLXpBLVpfXXxbXlxceDAwLVxceDdGXXxcXFxcKD86XFwkfFxcbnxbMC05YS1mQS1GXXsxLDZ9XFxzPykpKD86W2EtekEtWl8wLTlcXC1dKnxcXFxcKD86XFwkfFxcbnxbMC05YS1mQS1GXXsxLDZ9XFxzPykpKikvZ3ltO1xudmFyIENTUzNQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENTUzNQYXJzZXIodGV4dCkge1xuICAgICAgICB0aGlzLnRleHQgPSB0ZXh0O1xuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gMDtcbiAgICB9XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUudG9rZW5pemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0b2tlbnMgPSBbXTtcbiAgICAgICAgdmFyIGlucHV0VG9rZW47XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKTtcbiAgICAgICAgICAgIHRva2Vucy5wdXNoKGlucHV0VG9rZW4pO1xuICAgICAgICB9IHdoaWxlIChpbnB1dFRva2VuKTtcbiAgICAgICAgcmV0dXJuIHRva2VucztcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlY29uc3VtZWRJbnB1dFRva2VuKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbjtcbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lZElucHV0VG9rZW4gPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhciA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XTtcbiAgICAgICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICAgICAgICBjYXNlIFwiXFxcIlwiOiByZXR1cm4gdGhpcy5jb25zdW1lQVN0cmluZ1Rva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiJ1wiOiByZXR1cm4gdGhpcy5jb25zdW1lQVN0cmluZ1Rva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiKFwiOlxuICAgICAgICAgICAgY2FzZSBcIilcIjpcbiAgICAgICAgICAgIGNhc2UgXCIsXCI6XG4gICAgICAgICAgICBjYXNlIFwiOlwiOlxuICAgICAgICAgICAgY2FzZSBcIjtcIjpcbiAgICAgICAgICAgIGNhc2UgXCJbXCI6XG4gICAgICAgICAgICBjYXNlIFwiXVwiOlxuICAgICAgICAgICAgY2FzZSBcIntcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ9XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGFyO1xuICAgICAgICAgICAgY2FzZSBcIiNcIjogcmV0dXJuIHRoaXMuY29uc3VtZUFIYXNoVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIiBcIjpcbiAgICAgICAgICAgIGNhc2UgXCJcXHRcIjpcbiAgICAgICAgICAgIGNhc2UgXCJcXG5cIjpcbiAgICAgICAgICAgIGNhc2UgXCJcXHJcIjpcbiAgICAgICAgICAgIGNhc2UgXCJcXGZcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQVdoaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIGNhc2UgXCJAXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBdEtleXdvcmQoKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIlxcXFxcIjogcmV0dXJuIHRoaXMuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIjBcIjpcbiAgICAgICAgICAgIGNhc2UgXCIxXCI6XG4gICAgICAgICAgICBjYXNlIFwiMlwiOlxuICAgICAgICAgICAgY2FzZSBcIjNcIjpcbiAgICAgICAgICAgIGNhc2UgXCI0XCI6XG4gICAgICAgICAgICBjYXNlIFwiNVwiOlxuICAgICAgICAgICAgY2FzZSBcIjZcIjpcbiAgICAgICAgICAgIGNhc2UgXCI3XCI6XG4gICAgICAgICAgICBjYXNlIFwiOFwiOlxuICAgICAgICAgICAgY2FzZSBcIjlcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQU51bWVyaWNUb2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcInVcIjpcbiAgICAgICAgICAgIGNhc2UgXCJVXCI6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMV0gPT09IFwiK1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aGlyZENoYXIgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArIDJdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcmRDaGFyID49IFwiMFwiICYmIHRoaXJkQ2hhciA8PSBcIjlcIiB8fCB0aGlyZENoYXIgPT09IFwiP1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmljb2RlIHRva2VucyBub3Qgc3VwcG9ydGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiJFwiOlxuICAgICAgICAgICAgY2FzZSBcIipcIjpcbiAgICAgICAgICAgIGNhc2UgXCJeXCI6XG4gICAgICAgICAgICBjYXNlIFwifFwiOlxuICAgICAgICAgICAgY2FzZSBcIn5cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQU1hdGNoVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIi1cIjogcmV0dXJuIHRoaXMuY29uc3VtZUFOdW1lcmljVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBbklkZW50TGlrZVRva2VuKCkgfHwgdGhpcy5jb25zdW1lQ0RDKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIrXCI6XG4gICAgICAgICAgICBjYXNlIFwiLlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBTnVtZXJpY1Rva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIvXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBQ29tbWVudCgpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiPFwiOiByZXR1cm4gdGhpcy5jb25zdW1lQ0RPKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOiByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIHRoaXMuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQURlbGltVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDIsIHRleHQ6IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4KytdIH07XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVdoaXRlc3BhY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHdoaXRlc3BhY2VSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICB3aGl0ZXNwYWNlUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gd2hpdGVzcGFjZVJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgcmV0dXJuIFwiIFwiO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFIYXNoVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgdmFyIGhhc2hOYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKGhhc2hOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAxMiwgdGV4dDogXCIjXCIgKyBoYXNoTmFtZS50ZXh0IH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleC0tO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVDRE8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHQuc3Vic3RyKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgsIDQpID09PSBcIjwhLS1cIikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArPSA0O1xuICAgICAgICAgICAgcmV0dXJuIFwiPCEtLVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUNEQyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dC5zdWJzdHIodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCwgMykgPT09IFwiLS0+XCIpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKz0gMztcbiAgICAgICAgICAgIHJldHVybiBcIi0tPlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFNYXRjaFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKyAxXSA9PT0gXCI9XCIpIHtcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IHRoaXMudGV4dC5zdWJzdHIodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCwgMik7XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICs9IDI7XG4gICAgICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQU51bWVyaWNUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbnVtYmVyUmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bWJlclJlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBudW1iZXJSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiJVwiKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiA0LCB0ZXh0OiByZXN1bHRbMF0gfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmFtZSA9IHRoaXMuY29uc3VtZUFOYW1lKCk7XG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiA1LCB0ZXh0OiByZXN1bHRbMF0gKyBuYW1lLnRleHQgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB0eXBlOiAzLCB0ZXh0OiByZXN1bHRbMF0gfTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBbklkZW50TGlrZVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmFtZSA9IHRoaXMuY29uc3VtZUFOYW1lKCk7XG4gICAgICAgIGlmICghbmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSA9PT0gXCIoXCIpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgIGlmIChuYW1lLnRleHQudG9Mb3dlckNhc2UoKSA9PT0gXCJ1cmxcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBVVJMVG9rZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDgsIG5hbWU6IG5hbWUudGV4dCwgdGV4dDogbmFtZS50ZXh0ICsgXCIoXCIgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBU3RyaW5nVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoY2hhciA9PT0gXCInXCIpIHtcbiAgICAgICAgICAgIHNpbmdsZVF1b3RlU3RyaW5nUmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgIHJlc3VsdCA9IHNpbmdsZVF1b3RlU3RyaW5nUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBzaW5nbGVRdW90ZVN0cmluZ1JlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjaGFyID09PSBcIlxcXCJcIikge1xuICAgICAgICAgICAgZG91YmxlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgcmVzdWx0ID0gZG91YmxlUXVvdGVTdHJpbmdSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IGRvdWJsZVF1b3RlU3RyaW5nUmVnRXgubGFzdEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDEsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFVUkxUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCAtIDMgLSAxO1xuICAgICAgICB2YXIgdXJsVG9rZW4gPSB7IHR5cGU6IDcsIHRleHQ6IHVuZGVmaW5lZCB9O1xuICAgICAgICB0aGlzLmNvbnN1bWVBV2hpdGVzcGFjZSgpO1xuICAgICAgICBpZiAodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA+PSB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5leHRJbnB1dENvZGVQb2ludCA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XTtcbiAgICAgICAgaWYgKG5leHRJbnB1dENvZGVQb2ludCA9PT0gXCJcXFwiXCIgfHwgbmV4dElucHV0Q29kZVBvaW50ID09PSBcIidcIikge1xuICAgICAgICAgICAgdmFyIHN0cmluZ1Rva2VuID0gdGhpcy5jb25zdW1lQVN0cmluZ1Rva2VuKCk7XG4gICAgICAgICAgICB1cmxUb2tlbi50ZXh0ID0gc3RyaW5nVG9rZW4udGV4dDtcbiAgICAgICAgICAgIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdID09PSBcIilcIiB8fCB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID49IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICAgICAgdXJsVG9rZW4udGV4dCA9IHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVybFRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPCB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIgY2hhciA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4KytdO1xuICAgICAgICAgICAgc3dpdGNoIChjaGFyKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIilcIjogcmV0dXJuIHVybFRva2VuO1xuICAgICAgICAgICAgICAgIGNhc2UgXCIgXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcdFwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXG5cIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxyXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcZlwiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnN1bWVBV2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdID09PSBcIilcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVybFRva2VuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxcIlwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXCdcIjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcXFxcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXNjYXBpbmcgbm90IHlldCBzdXBwb3J0ZWQhXCIpO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHVybFRva2VuLnRleHQgKz0gY2hhcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG5hbWVSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmFtZVJlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBuYW1lUmVnRXgubGFzdEluZGV4O1xuICAgICAgICByZXR1cm4geyB0eXBlOiA2LCB0ZXh0OiByZXN1bHRbMF0gfTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBdEtleXdvcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLmNvbnN1bWVBTmFtZSgpO1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogMTEsIHRleHQ6IG5hbWUudGV4dCB9O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgtLTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUNvbW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArIDFdID09PSBcIipcIikge1xuICAgICAgICAgICAgY29tbWVudFJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gY29tbWVudFJlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gY29tbWVudFJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBVG9rZW4oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuID0gZnVuY3Rpb24gKGN1cnJlbnRJbnB1dFRva2VuKSB7XG4gICAgICAgIHRoaXMucmVjb25zdW1lZElucHV0VG9rZW4gPSBjdXJyZW50SW5wdXRUb2tlbjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLnBhcnNlQVN0eWxlc2hlZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudG9wTGV2ZWxGbGFnID0gdHJ1ZTtcbiAgICAgICAgdmFyIHN0eWxlc2hlZXQgPSB7XG4gICAgICAgICAgICBydWxlczogdGhpcy5jb25zdW1lQUxpc3RPZlJ1bGVzKClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHN0eWxlc2hlZXQ7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUxpc3RPZlJ1bGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcnVsZXMgPSBbXTtcbiAgICAgICAgdmFyIGlucHV0VG9rZW47XG4gICAgICAgIHdoaWxlIChpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoaW5wdXRUb2tlbikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIgXCI6IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgXCI8IS0tXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIi0tPlwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b3BMZXZlbEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdFJ1bGUgPSB0aGlzLmNvbnN1bWVBbkF0UnVsZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXRSdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBydWxlcy5wdXNoKGF0UnVsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRUb2tlbi50eXBlID09PSAxMSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICAgICAgdmFyIGF0UnVsZSA9IHRoaXMuY29uc3VtZUFuQXRSdWxlKCk7XG4gICAgICAgICAgICAgICAgaWYgKGF0UnVsZSkge1xuICAgICAgICAgICAgICAgICAgICBydWxlcy5wdXNoKGF0UnVsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgIHZhciBxdWFsaWZpZWRSdWxlID0gdGhpcy5jb25zdW1lQVF1YWxpZmllZFJ1bGUoKTtcbiAgICAgICAgICAgIGlmIChxdWFsaWZpZWRSdWxlKSB7XG4gICAgICAgICAgICAgICAgcnVsZXMucHVzaChxdWFsaWZpZWRSdWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcnVsZXM7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQW5BdFJ1bGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCk7XG4gICAgICAgIHZhciBhdFJ1bGUgPSB7XG4gICAgICAgICAgICB0eXBlOiBcImF0LXJ1bGVcIixcbiAgICAgICAgICAgIG5hbWU6IGlucHV0VG9rZW4udGV4dCxcbiAgICAgICAgICAgIHByZWx1ZGU6IFtdLFxuICAgICAgICAgICAgYmxvY2s6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB3aGlsZSAoaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCI7XCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5wdXRUb2tlbiA9PT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICBhdFJ1bGUuYmxvY2sgPSB0aGlzLmNvbnN1bWVBU2ltcGxlQmxvY2soaW5wdXRUb2tlbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0UnVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlucHV0VG9rZW4udHlwZSA9PT0gOSAmJiBpbnB1dFRva2VuLmFzc29jaWF0ZWRUb2tlbiA9PT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICBhdFJ1bGUuYmxvY2sgPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRoaXMuY29uc3VtZUFDb21wb25lbnRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKGNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgIGF0UnVsZS5wcmVsdWRlLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXRSdWxlO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFRdWFsaWZpZWRSdWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcXVhbGlmaWVkUnVsZSA9IHtcbiAgICAgICAgICAgIHR5cGU6IFwicXVhbGlmaWVkLXJ1bGVcIixcbiAgICAgICAgICAgIHByZWx1ZGU6IFtdLFxuICAgICAgICAgICAgYmxvY2s6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgaW5wdXRUb2tlbjtcbiAgICAgICAgd2hpbGUgKGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKSkge1xuICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwie1wiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJsb2NrID0gdGhpcy5jb25zdW1lQVNpbXBsZUJsb2NrKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgICAgIHF1YWxpZmllZFJ1bGUuYmxvY2sgPSBibG9jaztcbiAgICAgICAgICAgICAgICByZXR1cm4gcXVhbGlmaWVkUnVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlucHV0VG9rZW4udHlwZSA9PT0gOSkge1xuICAgICAgICAgICAgICAgIHZhciBzaW1wbGVCbG9jayA9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgaWYgKHNpbXBsZUJsb2NrLmFzc29jaWF0ZWRUb2tlbiA9PT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVhbGlmaWVkUnVsZS5ibG9jayA9IHNpbXBsZUJsb2NrO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcXVhbGlmaWVkUnVsZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudFZhbHVlID0gdGhpcy5jb25zdW1lQUNvbXBvbmVudFZhbHVlKCk7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBxdWFsaWZpZWRSdWxlLnByZWx1ZGUucHVzaChjb21wb25lbnRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUNvbXBvbmVudFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICBzd2l0Y2ggKGlucHV0VG9rZW4pIHtcbiAgICAgICAgICAgIGNhc2UgXCJ7XCI6XG4gICAgICAgICAgICBjYXNlIFwiW1wiOlxuICAgICAgICAgICAgY2FzZSBcIihcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFTaW1wbGVCbG9jayhpbnB1dFRva2VuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGlucHV0VG9rZW4gPT09IFwib2JqZWN0XCIgJiYgaW5wdXRUb2tlbi50eXBlID09PSA4KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQUZ1bmN0aW9uKGlucHV0VG9rZW4ubmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlucHV0VG9rZW47XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVNpbXBsZUJsb2NrID0gZnVuY3Rpb24gKGFzc29jaWF0ZWRUb2tlbikge1xuICAgICAgICB2YXIgZW5kaWFuVG9rZW4gPSB7XG4gICAgICAgICAgICBcIltcIjogXCJdXCIsXG4gICAgICAgICAgICBcIntcIjogXCJ9XCIsXG4gICAgICAgICAgICBcIihcIjogXCIpXCJcbiAgICAgICAgfVthc3NvY2lhdGVkVG9rZW5dO1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4IC0gMTtcbiAgICAgICAgdmFyIGJsb2NrID0ge1xuICAgICAgICAgICAgdHlwZTogOSxcbiAgICAgICAgICAgIHRleHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGFzc29jaWF0ZWRUb2tlbjogYXNzb2NpYXRlZFRva2VuLFxuICAgICAgICAgICAgdmFsdWVzOiBbXVxuICAgICAgICB9O1xuICAgICAgICB2YXIgbmV4dElucHV0VG9rZW47XG4gICAgICAgIHdoaWxlIChuZXh0SW5wdXRUb2tlbiA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSkge1xuICAgICAgICAgICAgaWYgKG5leHRJbnB1dFRva2VuID09PSBlbmRpYW5Ub2tlbikge1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgICAgICBibG9jay50ZXh0ID0gdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmxvY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGJsb2NrLnZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBibG9jay50ZXh0ID0gdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCk7XG4gICAgICAgIHJldHVybiBibG9jaztcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBRnVuY3Rpb24gPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICB2YXIgZnVuY1Rva2VuID0geyB0eXBlOiAxNCwgbmFtZTogbmFtZSwgdGV4dDogdW5kZWZpbmVkLCBjb21wb25lbnRzOiBbXSB9O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpZiAodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA+PSB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZnVuY1Rva2VuLnRleHQgPSBuYW1lICsgXCIoXCIgKyB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY1Rva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5leHRJbnB1dFRva2VuID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICAgICAgc3dpdGNoIChuZXh0SW5wdXRUb2tlbikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIpXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmNUb2tlbi50ZXh0ID0gbmFtZSArIFwiKFwiICsgdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmNUb2tlbjtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5jb25zdW1lQUNvbXBvbmVudFZhbHVlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmNUb2tlbi5jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlICh0cnVlKTtcbiAgICB9O1xuICAgIHJldHVybiBDU1MzUGFyc2VyO1xufSgpKTtcbmV4cG9ydHMuQ1NTM1BhcnNlciA9IENTUzNQYXJzZXI7XG52YXIgQ1NTTmF0aXZlU2NyaXB0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDU1NOYXRpdmVTY3JpcHQoKSB7XG4gICAgfVxuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucGFyc2VTdHlsZXNoZWV0ID0gZnVuY3Rpb24gKHN0eWxlc2hlZXQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwic3R5bGVzaGVldFwiLFxuICAgICAgICAgICAgc3R5bGVzaGVldDoge1xuICAgICAgICAgICAgICAgIHJ1bGVzOiB0aGlzLnBhcnNlUnVsZXMoc3R5bGVzaGVldC5ydWxlcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucGFyc2VSdWxlcyA9IGZ1bmN0aW9uIChydWxlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gcnVsZXMubWFwKGZ1bmN0aW9uIChydWxlKSB7IHJldHVybiBfdGhpcy5wYXJzZVJ1bGUocnVsZSk7IH0pO1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVJ1bGUgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICBpZiAocnVsZS50eXBlID09PSBcImF0LXJ1bGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VBdFJ1bGUocnVsZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocnVsZS50eXBlID09PSBcInF1YWxpZmllZC1ydWxlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlUXVhbGlmaWVkUnVsZShydWxlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZUF0UnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIGlmIChydWxlLm5hbWUgPT09IFwiaW1wb3J0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW1wb3J0OiBydWxlLnByZWx1ZGUubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiB0eXBlb2YgbSA9PT0gXCJzdHJpbmdcIiA/IG0gOiBtLnRleHQ7IH0pLmpvaW4oXCJcIikudHJpbSgpLFxuICAgICAgICAgICAgICAgIHR5cGU6IFwiaW1wb3J0XCJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVF1YWxpZmllZFJ1bGUgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJydWxlXCIsXG4gICAgICAgICAgICBzZWxlY3RvcnM6IHRoaXMucHJlbHVkZVRvU2VsZWN0b3JzU3RyaW5nQXJyYXkocnVsZS5wcmVsdWRlKSxcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uczogdGhpcy5ydWxlQmxvY2tUb0RlY2xhcmF0aW9ucyhydWxlLmJsb2NrLnZhbHVlcylcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucnVsZUJsb2NrVG9EZWNsYXJhdGlvbnMgPSBmdW5jdGlvbiAoZGVjbGFyYXRpb25zSW5wdXRUb2tlbnMpIHtcbiAgICAgICAgdmFyIGRlY2xhcmF0aW9ucyA9IFtdO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBcIlwiO1xuICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICB2YXIgcmVhZGluZyA9IFwicHJvcGVydHlcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZWNsYXJhdGlvbnNJbnB1dFRva2Vucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGlucHV0VG9rZW4gPSBkZWNsYXJhdGlvbnNJbnB1dFRva2Vuc1tpXTtcbiAgICAgICAgICAgIGlmIChyZWFkaW5nID09PSBcInByb3BlcnR5XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCI6XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGluZyA9IFwidmFsdWVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlucHV0VG9rZW4gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgKz0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ICs9IGlucHV0VG9rZW4udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCI7XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgPSBwcm9wZXJ0eS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnMucHVzaCh7IHR5cGU6IFwiZGVjbGFyYXRpb25cIiwgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICByZWFkaW5nID0gXCJwcm9wZXJ0eVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRUb2tlbi50ZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBwcm9wZXJ0eSA9IHByb3BlcnR5LnRyaW0oKTtcbiAgICAgICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgIGlmIChwcm9wZXJ0eSB8fCB2YWx1ZSkge1xuICAgICAgICAgICAgZGVjbGFyYXRpb25zLnB1c2goeyB0eXBlOiBcImRlY2xhcmF0aW9uXCIsIHByb3BlcnR5OiBwcm9wZXJ0eSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWNsYXJhdGlvbnM7XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnByZWx1ZGVUb1NlbGVjdG9yc1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKHByZWx1ZGUpIHtcbiAgICAgICAgdmFyIHNlbGVjdG9ycyA9IFtdO1xuICAgICAgICB2YXIgc2VsZWN0b3IgPSBcIlwiO1xuICAgICAgICBwcmVsdWRlLmZvckVhY2goZnVuY3Rpb24gKGlucHV0VG9rZW4pIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIixcIikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3IgKz0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yICs9IGlucHV0VG9rZW4udGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgc2VsZWN0b3JzLnB1c2goc2VsZWN0b3IudHJpbSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VsZWN0b3JzO1xuICAgIH07XG4gICAgcmV0dXJuIENTU05hdGl2ZVNjcmlwdDtcbn0oKSk7XG5leHBvcnRzLkNTU05hdGl2ZVNjcmlwdCA9IENTU05hdGl2ZVNjcmlwdDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnNlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgTU9EQUwgPSBcIm1vZGFsXCI7XG52YXIgUk9PVCA9IFwicm9vdFwiO1xuZXhwb3J0cy5DTEFTU19QUkVGSVggPSBcIm5zLVwiO1xudmFyIG1vZGFsUm9vdFZpZXdDc3NDbGFzcyA9IFwiXCIgKyBleHBvcnRzLkNMQVNTX1BSRUZJWCArIE1PREFMO1xudmFyIHJvb3RWaWV3Q3NzQ2xhc3NlcyA9IFtcIlwiICsgZXhwb3J0cy5DTEFTU19QUkVGSVggKyBST09UXTtcbmZ1bmN0aW9uIGdldE1vZGFsUm9vdFZpZXdDc3NDbGFzcygpIHtcbiAgICByZXR1cm4gbW9kYWxSb290Vmlld0Nzc0NsYXNzO1xufVxuZXhwb3J0cy5nZXRNb2RhbFJvb3RWaWV3Q3NzQ2xhc3MgPSBnZXRNb2RhbFJvb3RWaWV3Q3NzQ2xhc3M7XG5mdW5jdGlvbiBnZXRSb290Vmlld0Nzc0NsYXNzZXMoKSB7XG4gICAgcmV0dXJuIHJvb3RWaWV3Q3NzQ2xhc3Nlcztcbn1cbmV4cG9ydHMuZ2V0Um9vdFZpZXdDc3NDbGFzc2VzID0gZ2V0Um9vdFZpZXdDc3NDbGFzc2VzO1xuZnVuY3Rpb24gcHVzaFRvUm9vdFZpZXdDc3NDbGFzc2VzKHZhbHVlKSB7XG4gICAgcm9vdFZpZXdDc3NDbGFzc2VzLnB1c2godmFsdWUpO1xuICAgIHJldHVybiByb290Vmlld0Nzc0NsYXNzZXMubGVuZ3RoO1xufVxuZXhwb3J0cy5wdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXMgPSBwdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXM7XG5mdW5jdGlvbiByZW1vdmVGcm9tUm9vdFZpZXdDc3NDbGFzc2VzKHZhbHVlKSB7XG4gICAgdmFyIGluZGV4ID0gcm9vdFZpZXdDc3NDbGFzc2VzLmluZGV4T2YodmFsdWUpO1xuICAgIHZhciByZW1vdmVkRWxlbWVudDtcbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICByZW1vdmVkRWxlbWVudCA9IHJvb3RWaWV3Q3NzQ2xhc3Nlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgICByZXR1cm4gcmVtb3ZlZEVsZW1lbnQ7XG59XG5leHBvcnRzLnJlbW92ZUZyb21Sb290Vmlld0Nzc0NsYXNzZXMgPSByZW1vdmVGcm9tUm9vdFZpZXdDc3NDbGFzc2VzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3lzdGVtLWNsYXNzZXMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ic2VydmFibGUgPSByZXF1aXJlKFwiLi4vb2JzZXJ2YWJsZVwiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBDaGFuZ2VUeXBlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDaGFuZ2VUeXBlKCkge1xuICAgIH1cbiAgICBDaGFuZ2VUeXBlLkFkZCA9IFwiYWRkXCI7XG4gICAgQ2hhbmdlVHlwZS5EZWxldGUgPSBcImRlbGV0ZVwiO1xuICAgIENoYW5nZVR5cGUuVXBkYXRlID0gXCJ1cGRhdGVcIjtcbiAgICBDaGFuZ2VUeXBlLlNwbGljZSA9IFwic3BsaWNlXCI7XG4gICAgcmV0dXJuIENoYW5nZVR5cGU7XG59KCkpO1xuZXhwb3J0cy5DaGFuZ2VUeXBlID0gQ2hhbmdlVHlwZTtcbnZhciBDSEFOR0UgPSBcImNoYW5nZVwiO1xudmFyIE9ic2VydmFibGVBcnJheSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE9ic2VydmFibGVBcnJheSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlQXJyYXkoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAgICAgX3RoaXMuX2FycmF5ID0gYXJndW1lbnRzWzBdLnNsaWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5fYXJyYXkgPSBBcnJheS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLl9hZGRBcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBDSEFOR0UsIG9iamVjdDogX3RoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuQWRkLFxuICAgICAgICAgICAgaW5kZXg6IG51bGwsXG4gICAgICAgICAgICByZW1vdmVkOiBuZXcgQXJyYXkoKSxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IDFcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuX2RlbGV0ZUFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IENIQU5HRSwgb2JqZWN0OiBfdGhpcyxcbiAgICAgICAgICAgIGFjdGlvbjogQ2hhbmdlVHlwZS5EZWxldGUsXG4gICAgICAgICAgICBpbmRleDogbnVsbCxcbiAgICAgICAgICAgIHJlbW92ZWQ6IG51bGwsXG4gICAgICAgICAgICBhZGRlZENvdW50OiAwXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5nZXRJdGVtID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheVtpbmRleF07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNldEl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMuX2FycmF5W2luZGV4XTtcbiAgICAgICAgdGhpcy5fYXJyYXlbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgIHRoaXMubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuVXBkYXRlLFxuICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgcmVtb3ZlZDogW29sZFZhbHVlXSxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IDFcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNOdW1iZXIodmFsdWUpICYmIHRoaXMuX2FycmF5ICYmIHRoaXMuX2FycmF5Lmxlbmd0aCAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGljZSh2YWx1ZSwgdGhpcy5fYXJyYXkubGVuZ3RoIC0gdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkudG9TdHJpbmcoKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS50b0xvY2FsZVN0cmluZygpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuaW5kZXggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5jb25jYXQuYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmpvaW4gPSBmdW5jdGlvbiAoc2VwYXJhdG9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5qb2luKHNlcGFyYXRvcik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5pbmRleCA9IHRoaXMuX2FycmF5Lmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5wb3AoKTtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5yZW1vdmVkID0gW3Jlc3VsdF07XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2RlbGV0ZUFyZ3MpO1xuICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5pbmRleCA9IHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzb3VyY2UubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJyYXkucHVzaChzb3VyY2VbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYXJyYXkucHVzaC5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hZGRBcmdzLmFkZGVkQ291bnQgPSB0aGlzLl9hcnJheS5sZW5ndGggLSB0aGlzLl9hZGRBcmdzLmluZGV4O1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9hZGRBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLl9ub3RpZnlMZW5ndGhDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZW5ndGhDaGFuZ2VkRGF0YSA9IHRoaXMuX2NyZWF0ZVByb3BlcnR5Q2hhbmdlRGF0YShcImxlbmd0aFwiLCB0aGlzLl9hcnJheS5sZW5ndGgpO1xuICAgICAgICB0aGlzLm5vdGlmeShsZW5ndGhDaGFuZ2VkRGF0YSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJldmVyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5yZXZlcnNlKCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkuc2hpZnQoKTtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUFyZ3MucmVtb3ZlZCA9IFtyZXN1bHRdO1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9kZWxldGVBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zb3J0ID0gZnVuY3Rpb24gKGNvbXBhcmVGbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuc29ydChjb21wYXJlRm4pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zcGxpY2UgPSBmdW5jdGlvbiAoc3RhcnQsIGRlbGV0ZUNvdW50KSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5zcGxpY2UuYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuU3BsaWNlLFxuICAgICAgICAgICAgaW5kZXg6IHN0YXJ0LFxuICAgICAgICAgICAgcmVtb3ZlZDogcmVzdWx0LFxuICAgICAgICAgICAgYWRkZWRDb3VudDogdGhpcy5fYXJyYXkubGVuZ3RoICsgcmVzdWx0Lmxlbmd0aCAtIGxlbmd0aFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX2FycmF5Lmxlbmd0aCAhPT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS51bnNoaWZ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkudW5zaGlmdC5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuYWRkZWRDb3VudCA9IHJlc3VsdCAtIGxlbmd0aDtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fYWRkQXJncyk7XG4gICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuICAgICAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggPyBmcm9tSW5kZXggOiAwO1xuICAgICAgICBmb3IgKHZhciBpID0gaW5kZXgsIGwgPSB0aGlzLl9hcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hcnJheVtpXSA9PT0gc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG4gICAgICAgIHZhciBpbmRleCA9IGZyb21JbmRleCA/IGZyb21JbmRleCA6IHRoaXMuX2FycmF5Lmxlbmd0aCAtIDE7XG4gICAgICAgIGZvciAodmFyIGkgPSBpbmRleDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hcnJheVtpXSA9PT0gc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZXZlcnkgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuZXZlcnkoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNvbWUgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuc29tZShjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHRoaXMuX2FycmF5LmZvckVhY2goY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5tYXAoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5maWx0ZXIoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJlZHVjZSA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxWYWx1ZSAhPT0gdW5kZWZpbmVkID8gdGhpcy5fYXJyYXkucmVkdWNlKGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkgOiB0aGlzLl9hcnJheS5yZWR1Y2UoY2FsbGJhY2tmbik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5pdGlhbFZhbHVlICE9PSB1bmRlZmluZWQgPyB0aGlzLl9hcnJheS5yZWR1Y2VSaWdodChjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIDogdGhpcy5fYXJyYXkucmVkdWNlUmlnaHQoY2FsbGJhY2tmbik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQgPSBDSEFOR0U7XG4gICAgcmV0dXJuIE9ic2VydmFibGVBcnJheTtcbn0ob2JzZXJ2YWJsZS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLk9ic2VydmFibGVBcnJheSA9IE9ic2VydmFibGVBcnJheTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUtYXJyYXkuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIF93cmFwcGVkSW5kZXggPSAwO1xudmFyIFdyYXBwZWRWYWx1ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV3JhcHBlZFZhbHVlKHdyYXBwZWQpIHtcbiAgICAgICAgdGhpcy53cmFwcGVkID0gd3JhcHBlZDtcbiAgICB9XG4gICAgV3JhcHBlZFZhbHVlLnVud3JhcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKHZhbHVlIGluc3RhbmNlb2YgV3JhcHBlZFZhbHVlKSA/IHZhbHVlLndyYXBwZWQgOiB2YWx1ZTtcbiAgICB9O1xuICAgIFdyYXBwZWRWYWx1ZS53cmFwID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB3ID0gX3dyYXBwZWRWYWx1ZXNbX3dyYXBwZWRJbmRleCsrICUgNV07XG4gICAgICAgIHcud3JhcHBlZCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdztcbiAgICB9O1xuICAgIHJldHVybiBXcmFwcGVkVmFsdWU7XG59KCkpO1xuZXhwb3J0cy5XcmFwcGVkVmFsdWUgPSBXcmFwcGVkVmFsdWU7XG52YXIgX3dyYXBwZWRWYWx1ZXMgPSBbXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpLFxuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbCksXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpXG5dO1xudmFyIE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoKSB7XG4gICAgICAgIHRoaXMuX29ic2VydmVycyA9IHt9O1xuICAgIH1cbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpc1tuYW1lXTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzW25hbWVdO1xuICAgICAgICBpZiAodGhpc1tuYW1lXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3VmFsdWUgPSBXcmFwcGVkVmFsdWUudW53cmFwKHZhbHVlKTtcbiAgICAgICAgdGhpc1tuYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKG5hbWUsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIChldmVudCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXRFdmVudExpc3QoZXZlbnQsIHRydWUpO1xuICAgICAgICBsaXN0LnB1c2goeyBjYWxsYmFjazogY2FsbGJhY2ssIHRoaXNBcmc6IHRoaXNBcmcsIG9uY2U6IHRydWUgfSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudE5hbWVzICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXZlbnRzIG5hbWUocykgbXVzdCBiZSBzdHJpbmcuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbGxiYWNrIG11c3QgYmUgZnVuY3Rpb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBldmVudHMgPSBldmVudE5hbWVzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMSA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2dldEV2ZW50TGlzdChldmVudF8xLCB0cnVlKTtcbiAgICAgICAgICAgIGxpc3QucHVzaCh7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgICAgICAgICAgIHRoaXNBcmc6IHRoaXNBcmdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnROYW1lcyAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV2ZW50cyBuYW1lKHMpIG11c3QgYmUgc3RyaW5nLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYWxsYmFjayBtdXN0IGJlIGZ1bmN0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXZlbnRzID0gZXZlbnROYW1lcy5zcGxpdChcIixcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGV2ZW50XzIgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXRFdmVudExpc3QoZXZlbnRfMiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleF8xID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3QsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4XzEgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5zcGxpY2UoaW5kZXhfMSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50XzJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50XzJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9vYnNlcnZlcnNbZXZlbnRfMl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm5vdGlmeSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLl9vYnNlcnZlcnNbZGF0YS5ldmVudE5hbWVdO1xuICAgICAgICBpZiAoIW9ic2VydmVycykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSBvYnNlcnZlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IG9ic2VydmVyc1tpXTtcbiAgICAgICAgICAgIGlmIChlbnRyeS5vbmNlKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbnRyeS50aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgZW50cnkuY2FsbGJhY2suYXBwbHkoZW50cnkudGhpc0FyZywgW2RhdGFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVudHJ5LmNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5ub3RpZnlQcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fY3JlYXRlUHJvcGVydHlDaGFuZ2VEYXRhKG5hbWUsIHZhbHVlLCBvbGRWYWx1ZSkpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgICByZXR1cm4gZXZlbnROYW1lIGluIHRoaXMuX29ic2VydmVycztcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9jcmVhdGVQcm9wZXJ0eUNoYW5nZURhdGEgPSBmdW5jdGlvbiAocHJvcGVydHlOYW1lLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHsgZXZlbnROYW1lOiBPYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIG9iamVjdDogdGhpcywgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5fZW1pdCA9IGZ1bmN0aW9uIChldmVudE5hbWVzKSB7XG4gICAgICAgIHZhciBldmVudHMgPSBldmVudE5hbWVzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMyA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogZXZlbnRfMywgb2JqZWN0OiB0aGlzIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5fZ2V0RXZlbnRMaXN0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY3JlYXRlSWZOZWVkZWQpIHtcbiAgICAgICAgaWYgKCFldmVudE5hbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFdmVudE5hbWUgbXVzdCBiZSB2YWxpZCBzdHJpbmcuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ID0gdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50TmFtZV07XG4gICAgICAgIGlmICghbGlzdCAmJiBjcmVhdGVJZk5lZWRlZCkge1xuICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50TmFtZV0gPSBsaXN0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2luZGV4T2ZMaXN0ZW5lciA9IGZ1bmN0aW9uIChsaXN0LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IGxpc3RbaV07XG4gICAgICAgICAgICBpZiAodGhpc0FyZykge1xuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5jYWxsYmFjayA9PT0gY2FsbGJhY2sgJiYgZW50cnkudGhpc0FyZyA9PT0gdGhpc0FyZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuY2FsbGJhY2sgPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQgPSBcInByb3BlcnR5Q2hhbmdlXCI7XG4gICAgcmV0dXJuIE9ic2VydmFibGU7XG59KCkpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gT2JzZXJ2YWJsZTtcbnZhciBPYnNlcnZhYmxlRnJvbU9iamVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE9ic2VydmFibGVGcm9tT2JqZWN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGVGcm9tT2JqZWN0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX21hcCA9IHt9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9ic2VydmFibGVGcm9tT2JqZWN0LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWFwW25hbWVdO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUZyb21PYmplY3QucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gdGhpcy5fbWFwW25hbWVdO1xuICAgICAgICBpZiAoY3VycmVudFZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IFdyYXBwZWRWYWx1ZS51bndyYXAodmFsdWUpO1xuICAgICAgICB0aGlzLl9tYXBbbmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShuYW1lLCBuZXdWYWx1ZSwgY3VycmVudFZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZhYmxlRnJvbU9iamVjdDtcbn0oT2JzZXJ2YWJsZSkpO1xuZnVuY3Rpb24gZGVmaW5lTmV3UHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eU5hbWUsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0Ll9tYXBbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRhcmdldC5zZXQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gYWRkUHJvcGVydGllc0Zyb21PYmplY3Qob2JzZXJ2YWJsZSwgc291cmNlLCByZWN1cnNpdmUpIHtcbiAgICBpZiAocmVjdXJzaXZlID09PSB2b2lkIDApIHsgcmVjdXJzaXZlID0gZmFsc2U7IH1cbiAgICBPYmplY3Qua2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgdmFyIHZhbHVlID0gc291cmNlW3Byb3BdO1xuICAgICAgICBpZiAocmVjdXJzaXZlXG4gICAgICAgICAgICAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSlcbiAgICAgICAgICAgICYmIHZhbHVlXG4gICAgICAgICAgICAmJiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCJcbiAgICAgICAgICAgICYmICEodmFsdWUgaW5zdGFuY2VvZiBPYnNlcnZhYmxlKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBmcm9tT2JqZWN0UmVjdXJzaXZlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBkZWZpbmVOZXdQcm9wZXJ0eShvYnNlcnZhYmxlLCBwcm9wKTtcbiAgICAgICAgb2JzZXJ2YWJsZS5zZXQocHJvcCwgdmFsdWUpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZnJvbU9iamVjdChzb3VyY2UpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlRnJvbU9iamVjdCgpO1xuICAgIGFkZFByb3BlcnRpZXNGcm9tT2JqZWN0KG9ic2VydmFibGUsIHNvdXJjZSwgZmFsc2UpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlO1xufVxuZXhwb3J0cy5mcm9tT2JqZWN0ID0gZnJvbU9iamVjdDtcbmZ1bmN0aW9uIGZyb21PYmplY3RSZWN1cnNpdmUoc291cmNlKSB7XG4gICAgdmFyIG9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZUZyb21PYmplY3QoKTtcbiAgICBhZGRQcm9wZXJ0aWVzRnJvbU9iamVjdChvYnNlcnZhYmxlLCBzb3VyY2UsIHRydWUpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlO1xufVxuZXhwb3J0cy5mcm9tT2JqZWN0UmVjdXJzaXZlID0gZnJvbU9iamVjdFJlY3Vyc2l2ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG5ldHdvcms7XG5mdW5jdGlvbiBnZXROZXR3b3JrKCkge1xuICAgIHJldHVybiBuZXR3b3JrO1xufVxuZXhwb3J0cy5nZXROZXR3b3JrID0gZ2V0TmV0d29yaztcbmZ1bmN0aW9uIHNldE5ldHdvcmsobmV3TmV0d29yaykge1xuICAgIG5ldHdvcmsgPSBuZXdOZXR3b3JrO1xufVxuZXhwb3J0cy5zZXROZXR3b3JrID0gc2V0TmV0d29yaztcbnZhciBkb207XG5mdW5jdGlvbiBnZXRET00oKSB7XG4gICAgcmV0dXJuIGRvbTtcbn1cbmV4cG9ydHMuZ2V0RE9NID0gZ2V0RE9NO1xuZnVuY3Rpb24gc2V0RE9NKG5ld0RPTSkge1xuICAgIGRvbSA9IG5ld0RPTTtcbn1cbmV4cG9ydHMuc2V0RE9NID0gc2V0RE9NO1xudmFyIGNzcztcbmZ1bmN0aW9uIGdldENTUygpIHtcbiAgICByZXR1cm4gY3NzO1xufVxuZXhwb3J0cy5nZXRDU1MgPSBnZXRDU1M7XG5mdW5jdGlvbiBzZXRDU1MobmV3Q1NTKSB7XG4gICAgY3NzID0gbmV3Q1NTO1xufVxuZXhwb3J0cy5zZXRDU1MgPSBzZXRDU1M7XG52YXIgTmV0d29ya0FnZW50O1xuKGZ1bmN0aW9uIChOZXR3b3JrQWdlbnQpIHtcbiAgICBmdW5jdGlvbiByZXNwb25zZVJlY2VpdmVkKHJlcXVlc3RJZCwgcmVzdWx0LCBoZWFkZXJzKSB7XG4gICAgICAgIHZhciByZXF1ZXN0SWRTdHIgPSByZXF1ZXN0SWQudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIG1pbWVUeXBlID0gaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSB8fCBoZWFkZXJzW1wiY29udGVudC10eXBlXCJdIHx8IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCI7XG4gICAgICAgIHZhciBjb250ZW50TGVuZ3RoSGVhZGVyID0gaGVhZGVyc1tcIkNvbnRlbnQtTGVuZ3RoXCJdIHx8IGhlYWRlcnNbXCJjb250ZW50LWxlbmd0aFwiXTtcbiAgICAgICAgdmFyIGNvbnRlbnRMZW5ndGggPSBwYXJzZUludChjb250ZW50TGVuZ3RoSGVhZGVyLCAxMCk7XG4gICAgICAgIGlmIChpc05hTihjb250ZW50TGVuZ3RoKSkge1xuICAgICAgICAgICAgY29udGVudExlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgdXJsOiByZXN1bHQudXJsIHx8IFwiXCIsXG4gICAgICAgICAgICBzdGF0dXM6IHJlc3VsdC5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzdWx0LnN0YXR1c1RleHQgfHwgXCJcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICBtaW1lVHlwZTogbWltZVR5cGUsXG4gICAgICAgICAgICBmcm9tRGlza0NhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbm5lY3Rpb25SZXVzZWQ6IHRydWUsXG4gICAgICAgICAgICBjb25uZWN0aW9uSWQ6IDAsXG4gICAgICAgICAgICBlbmNvZGVkRGF0YUxlbmd0aDogY29udGVudExlbmd0aCxcbiAgICAgICAgICAgIHNlY3VyaXR5U3RhdGU6IFwiaW5mb1wiXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXNwb25zZURhdGEgPSB7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZFN0cixcbiAgICAgICAgICAgIHR5cGU6IG1pbWVUeXBlVG9UeXBlKHJlc3BvbnNlLm1pbWVUeXBlKSxcbiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKClcbiAgICAgICAgfTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLnJlc3BvbnNlUmVjZWl2ZWQocmVzcG9uc2VEYXRhKTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLmxvYWRpbmdGaW5pc2hlZCh7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZFN0cixcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKCksXG4gICAgICAgICAgICBlbmNvZGVkRGF0YUxlbmd0aDogY29udGVudExlbmd0aFxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGhhc1RleHRDb250ZW50ID0gcmVzcG9uc2VEYXRhLnR5cGUgPT09IFwiRG9jdW1lbnRcIiB8fCByZXNwb25zZURhdGEudHlwZSA9PT0gXCJTY3JpcHRcIjtcbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIGlmICghaGFzVGV4dENvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZURhdGEudHlwZSA9PT0gXCJJbWFnZVwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJpdG1hcCA9IHJlc3VsdC5yZXNwb25zZUFzSW1hZ2U7XG4gICAgICAgICAgICAgICAgaWYgKGJpdG1hcCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0cHV0U3RyZWFtID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgICAgIGJpdG1hcC5jb21wcmVzcyhhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcC5Db21wcmVzc0Zvcm1hdC5QTkcsIDEwMCwgb3V0cHV0U3RyZWFtKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2U2NEltYWdlID0gYW5kcm9pZC51dGlsLkJhc2U2NC5lbmNvZGVUb1N0cmluZyhvdXRwdXRTdHJlYW0udG9CeXRlQXJyYXkoKSwgYW5kcm9pZC51dGlsLkJhc2U2NC5ERUZBVUxUKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGJhc2U2NEltYWdlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRhdGEgPSByZXN1bHQucmVzcG9uc2VBc1N0cmluZztcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3VjY2Vzc2Z1bFJlcXVlc3REYXRhID0ge1xuICAgICAgICAgICAgcmVxdWVzdElkOiByZXF1ZXN0SWRTdHIsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgaGFzVGV4dENvbnRlbnQ6IGhhc1RleHRDb250ZW50XG4gICAgICAgIH07XG4gICAgICAgIGdsb2JhbC5fX2luc3BlY3Rvci5kYXRhRm9yUmVxdWVzdElkKHN1Y2Nlc3NmdWxSZXF1ZXN0RGF0YSk7XG4gICAgfVxuICAgIE5ldHdvcmtBZ2VudC5yZXNwb25zZVJlY2VpdmVkID0gcmVzcG9uc2VSZWNlaXZlZDtcbiAgICBmdW5jdGlvbiByZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0SWQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7XG4gICAgICAgICAgICB1cmw6IG9wdGlvbnMudXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBvcHRpb25zLm1ldGhvZCxcbiAgICAgICAgICAgIGhlYWRlcnM6IG9wdGlvbnMuaGVhZGVycyB8fCB7fSxcbiAgICAgICAgICAgIHBvc3REYXRhOiBvcHRpb25zLmNvbnRlbnQgPyBvcHRpb25zLmNvbnRlbnQudG9TdHJpbmcoKSA6IFwiXCIsXG4gICAgICAgICAgICBpbml0aWFsUHJpb3JpdHk6IFwiTWVkaXVtXCIsXG4gICAgICAgICAgICByZWZlcnJlclBvbGljeTogXCJuby1yZWZlcnJlci13aGVuLWRvd25ncmFkZVwiXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXF1ZXN0RGF0YSA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB1cmw6IHJlcXVlc3QudXJsLFxuICAgICAgICAgICAgcmVxdWVzdDogcmVxdWVzdCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKCksXG4gICAgICAgICAgICB0eXBlOiBcIkRvY3VtZW50XCIsXG4gICAgICAgICAgICB3YWxsVGltZTogMFxuICAgICAgICB9O1xuICAgICAgICBnbG9iYWwuX19pbnNwZWN0b3IucmVxdWVzdFdpbGxCZVNlbnQocmVxdWVzdERhdGEpO1xuICAgIH1cbiAgICBOZXR3b3JrQWdlbnQucmVxdWVzdFdpbGxCZVNlbnQgPSByZXF1ZXN0V2lsbEJlU2VudDtcbiAgICBmdW5jdGlvbiBnZXRUaW1lU3RhbXAoKSB7XG4gICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoZC5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gbWltZVR5cGVUb1R5cGUobWltZVR5cGUpIHtcbiAgICAgICAgdmFyIHR5cGUgPSBcIkRvY3VtZW50XCI7XG4gICAgICAgIGlmIChtaW1lVHlwZSkge1xuICAgICAgICAgICAgaWYgKG1pbWVUeXBlLmluZGV4T2YoXCJpbWFnZVwiKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBcIkltYWdlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChtaW1lVHlwZS5pbmRleE9mKFwiamF2YXNjcmlwdFwiKSAhPT0gLTEgfHwgbWltZVR5cGUuaW5kZXhPZihcImpzb25cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IFwiU2NyaXB0XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgfVxufSkoTmV0d29ya0FnZW50ID0gZXhwb3J0cy5OZXR3b3JrQWdlbnQgfHwgKGV4cG9ydHMuTmV0d29ya0FnZW50ID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYnVnZ2VyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkb21fbm9kZV8xID0gcmVxdWlyZShcIi4vZG9tLW5vZGVcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbnZhciBmcmFtZVRvcG1vc3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vdWkvZnJhbWVcIikudG9wbW9zdCgpOyB9O1xudmFyIHVuc2V0VmFsdWU7XG5mdW5jdGlvbiB1bnNldFZpZXdWYWx1ZSh2aWV3LCBuYW1lKSB7XG4gICAgaWYgKCF1bnNldFZhbHVlKSB7XG4gICAgICAgIHVuc2V0VmFsdWUgPSByZXF1aXJlKFwiLi4vdWkvY29yZS9wcm9wZXJ0aWVzXCIpLnVuc2V0VmFsdWU7XG4gICAgfVxuICAgIHZpZXdbbmFtZV0gPSB1bnNldFZhbHVlO1xufVxuZnVuY3Rpb24gZ2V0Vmlld0J5SWQobm9kZUlkKSB7XG4gICAgdmFyIG5vZGUgPSBkb21fbm9kZV8xLmdldE5vZGVCeUlkKG5vZGVJZCk7XG4gICAgdmFyIHZpZXc7XG4gICAgaWYgKG5vZGUpIHtcbiAgICAgICAgdmlldyA9IG5vZGUudmlld1JlZi5nZXQoKTtcbiAgICB9XG4gICAgcmV0dXJuIHZpZXc7XG59XG5mdW5jdGlvbiBnZXREb2N1bWVudCgpIHtcbiAgICB2YXIgdG9wTW9zdEZyYW1lID0gZnJhbWVUb3Btb3N0KCk7XG4gICAgaWYgKCF0b3BNb3N0RnJhbWUpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgdG9wTW9zdEZyYW1lLmVuc3VyZURvbU5vZGUoKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJFUlJPUiBpbiBnZXREb2N1bWVudCgpOiBcIiArIGUpO1xuICAgIH1cbiAgICByZXR1cm4gdG9wTW9zdEZyYW1lLmRvbU5vZGUudG9PYmplY3QoKTtcbn1cbmV4cG9ydHMuZ2V0RG9jdW1lbnQgPSBnZXREb2N1bWVudDtcbmZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGVzRm9yTm9kZShub2RlSWQpIHtcbiAgICB2YXIgdmlldyA9IGdldFZpZXdCeUlkKG5vZGVJZCk7XG4gICAgaWYgKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZpZXcuZG9tTm9kZS5nZXRDb21wdXRlZFByb3BlcnRpZXMoKTtcbiAgICB9XG4gICAgcmV0dXJuIFtdO1xufVxuZXhwb3J0cy5nZXRDb21wdXRlZFN0eWxlc0Zvck5vZGUgPSBnZXRDb21wdXRlZFN0eWxlc0Zvck5vZGU7XG5leHBvcnRzLnJlbW92ZU5vZGUgPSB1dGlsc18xLm1haW5UaHJlYWRpZnkoZnVuY3Rpb24gcmVtb3ZlTm9kZShub2RlSWQpIHtcbiAgICB2YXIgdmlldyA9IGdldFZpZXdCeUlkKG5vZGVJZCk7XG4gICAgaWYgKHZpZXcpIHtcbiAgICAgICAgdmFyIHBhcmVudF8xID0gdmlldy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnRfMS5yZW1vdmVDaGlsZCkge1xuICAgICAgICAgICAgcGFyZW50XzEucmVtb3ZlQ2hpbGQodmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGFyZW50XzEuY29udGVudCA9PT0gdmlldykge1xuICAgICAgICAgICAgcGFyZW50XzEuY29udGVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhbid0IHJlbW92ZSBjaGlsZCBmcm9tIFwiICsgcGFyZW50XzEpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLnNldEF0dHJpYnV0ZUFzVGV4dCA9IHV0aWxzXzEubWFpblRocmVhZGlmeShmdW5jdGlvbiBzZXRBdHRyaWJ1dGVBc1RleHQobm9kZUlkLCB0ZXh0LCBuYW1lKSB7XG4gICAgdmFyIHZpZXcgPSBnZXRWaWV3QnlJZChub2RlSWQpO1xuICAgIGlmICh2aWV3KSB7XG4gICAgICAgIHZhciBoYXNPcmlnaW5hbEF0dHJpYnV0ZSA9ICEhbmFtZS50cmltKCk7XG4gICAgICAgIGlmICh0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgdGV4dFBhcnRzID0gdGV4dC5zcGxpdChcIj1cIik7XG4gICAgICAgICAgICBpZiAodGV4dFBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIHZhciBhdHRyTmFtZSA9IHRleHRQYXJ0c1swXTtcbiAgICAgICAgICAgICAgICB2YXIgYXR0clZhbHVlID0gdGV4dFBhcnRzWzFdLnJlcGxhY2UoL1snXCJdKy9nLCBcIlwiKTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZSAhPT0gYXR0ck5hbWUgJiYgaGFzT3JpZ2luYWxBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdW5zZXRWaWV3VmFsdWUodmlldywgbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXdbYXR0ck5hbWVdID0gYXR0clZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmlld1toYXNPcmlnaW5hbEF0dHJpYnV0ZSA/IG5hbWUgOiBhdHRyTmFtZV0gPSBhdHRyVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdW5zZXRWaWV3VmFsdWUodmlldywgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmlldy5kb21Ob2RlLmxvYWRBdHRyaWJ1dGVzKCk7XG4gICAgfVxufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZXZ0b29scy1lbGVtZW50cy5jb21tb24uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRldnRvb2xzX2VsZW1lbnRzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZGV2dG9vbHMtZWxlbWVudHMuY29tbW9uXCIpO1xudmFyIGRvbV9ub2RlXzEgPSByZXF1aXJlKFwiLi9kb20tbm9kZVwiKTtcbmZ1bmN0aW9uIGF0dGFjaERPTUluc3BlY3RvckV2ZW50Q2FsbGJhY2tzKERPTURvbWFpbkZyb250ZW5kKSB7XG4gICAgZG9tX25vZGVfMS5yZWdpc3Rlckluc3BlY3RvckV2ZW50cyhET01Eb21haW5Gcm9udGVuZCk7XG4gICAgdmFyIG9yaWdpbmFsQ2hpbGROb2RlSW5zZXJ0ZWQgPSBET01Eb21haW5Gcm9udGVuZC5jaGlsZE5vZGVJbnNlcnRlZDtcbiAgICBET01Eb21haW5Gcm9udGVuZC5jaGlsZE5vZGVJbnNlcnRlZCA9IGZ1bmN0aW9uIChwYXJlbnRJZCwgbGFzdElkLCBub2RlKSB7XG4gICAgICAgIG9yaWdpbmFsQ2hpbGROb2RlSW5zZXJ0ZWQocGFyZW50SWQsIGxhc3RJZCwgSlNPTi5zdHJpbmdpZnkobm9kZS50b09iamVjdCgpKSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuYXR0YWNoRE9NSW5zcGVjdG9yRXZlbnRDYWxsYmFja3MgPSBhdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcztcbmZ1bmN0aW9uIGF0dGFjaERPTUluc3BlY3RvckNvbW1hbmRDYWxsYmFja3MoRE9NRG9tYWluQmFja2VuZCkge1xuICAgIERPTURvbWFpbkJhY2tlbmQuZ2V0RG9jdW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkZXZ0b29sc19lbGVtZW50c19jb21tb25fMS5nZXREb2N1bWVudCgpKTtcbiAgICB9O1xuICAgIERPTURvbWFpbkJhY2tlbmQuZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlID0gZnVuY3Rpb24gKG5vZGVJZCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEuZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlKG5vZGVJZCkpO1xuICAgIH07XG4gICAgRE9NRG9tYWluQmFja2VuZC5yZW1vdmVOb2RlID0gZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEucmVtb3ZlTm9kZTtcbiAgICBET01Eb21haW5CYWNrZW5kLnNldEF0dHJpYnV0ZUFzVGV4dCA9IGRldnRvb2xzX2VsZW1lbnRzX2NvbW1vbl8xLnNldEF0dHJpYnV0ZUFzVGV4dDtcbn1cbmV4cG9ydHMuYXR0YWNoRE9NSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcyA9IGF0dGFjaERPTUluc3BlY3RvckNvbW1hbmRDYWxsYmFja3M7XG5mdW5jdGlvbiBhdHRhY2hDU1NJbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzKENTU0RvbWFpbkZyb250ZW5kKSB7XG59XG5leHBvcnRzLmF0dGFjaENTU0luc3BlY3RvckNvbW1hbmRDYWxsYmFja3MgPSBhdHRhY2hDU1NJbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGV2dG9vbHMtZWxlbWVudHMuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcmVnaXN0ZXJlZERvbU5vZGVzID0ge307XG52YXIgRUxFTUVOVF9OT0RFX1RZUEUgPSAxO1xudmFyIFJPT1RfTk9ERV9UWVBFID0gOTtcbnZhciBwcm9wZXJ0eUJsYWNrbGlzdCA9IFtcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdMZWZ0XCIsXG4gICAgXCJlZmZlY3RpdmVQYWRkaW5nQm90dG9tXCIsXG4gICAgXCJlZmZlY3RpdmVQYWRkaW5nUmlnaHRcIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdUb3BcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVNaW5XaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlTWluSGVpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVXaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlSGVpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5MZWZ0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5Ub3BcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpblJpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5Cb3R0b21cIixcbiAgICBcIm5vZGVOYW1lXCIsXG4gICAgXCJub2RlVHlwZVwiLFxuICAgIFwiZGVjb2RlV2lkdGhcIixcbiAgICBcImRlY29kZUhlaWdodFwiLFxuICAgIFwibmctcmVmbGVjdC1pdGVtc1wiLFxuICAgIFwiZG9tTm9kZVwiLFxuICAgIFwidG91Y2hMaXN0ZW5lcklzU2V0XCIsXG4gICAgXCJiaW5kaW5nQ29udGV4dFwiLFxuICAgIFwibmF0aXZlVmlld1wiXG5dO1xuZnVuY3Rpb24gbGF6eShhY3Rpb24pIHtcbiAgICB2YXIgX3ZhbHVlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdmFsdWUgfHwgKF92YWx1ZSA9IGFjdGlvbigpKTsgfTtcbn1cbnZhciBwZXJjZW50TGVuZ3RoVG9TdHJpbmdMYXp5ID0gbGF6eShmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vdWkvc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpLlBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nOyB9KTtcbnZhciBnZXRTZXRQcm9wZXJ0aWVzTGF6eSA9IGxhenkoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uL3VpL2NvcmUvcHJvcGVydGllc1wiKS5nZXRTZXRQcm9wZXJ0aWVzOyB9KTtcbnZhciBnZXRDb21wdXRlZENzc1ZhbHVlc0xhenkgPSBsYXp5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi91aS9jb3JlL3Byb3BlcnRpZXNcIikuZ2V0Q29tcHV0ZWRDc3NWYWx1ZXM7IH0pO1xuZnVuY3Rpb24gcmVnaXN0ZXJJbnNwZWN0b3JFdmVudHMoaW5zcGVjdG9yKSB7XG4gICAgaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSA9IGluc3BlY3Rvcjtcbn1cbmV4cG9ydHMucmVnaXN0ZXJJbnNwZWN0b3JFdmVudHMgPSByZWdpc3Rlckluc3BlY3RvckV2ZW50cztcbnZhciBpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlO1xuZnVuY3Rpb24gbm90aWZ5SW5zcGVjdG9yKGNhbGxiYWNrKSB7XG4gICAgaWYgKGluc3BlY3RvckZyb250ZW5kSW5zdGFuY2UpIHtcbiAgICAgICAgY2FsbGJhY2soaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsdWVUb1N0cmluZyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZS51bml0KSB7XG4gICAgICAgIHJldHVybiBwZXJjZW50TGVuZ3RoVG9TdHJpbmdMYXp5KCkodmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICsgXCJcIjtcbiAgICB9XG59XG5mdW5jdGlvbiBwcm9wZXJ0eUZpbHRlcihfYSkge1xuICAgIHZhciBuYW1lID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XG4gICAgaWYgKG5hbWVbMF0gPT09IFwiX1wiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwcm9wZXJ0eUJsYWNrbGlzdC5pbmRleE9mKG5hbWUpID49IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyTm9kZShkb21Ob2RlKSB7XG4gICAgcmVnaXN0ZXJlZERvbU5vZGVzW2RvbU5vZGUubm9kZUlkXSA9IGRvbU5vZGU7XG59XG5mdW5jdGlvbiB1bnJlZ2lzdGVyTm9kZShkb21Ob2RlKSB7XG4gICAgZGVsZXRlIHJlZ2lzdGVyZWREb21Ob2Rlc1tkb21Ob2RlLm5vZGVJZF07XG59XG5mdW5jdGlvbiBnZXROb2RlQnlJZChpZCkge1xuICAgIHJldHVybiByZWdpc3RlcmVkRG9tTm9kZXNbaWRdO1xufVxuZXhwb3J0cy5nZXROb2RlQnlJZCA9IGdldE5vZGVCeUlkO1xudmFyIERPTU5vZGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERPTU5vZGUodmlldykge1xuICAgICAgICB0aGlzLm5vZGVWYWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgICAgICB0aGlzLnZpZXdSZWYgPSBuZXcgV2Vha1JlZih2aWV3KTtcbiAgICAgICAgdGhpcy5ub2RlVHlwZSA9IHZpZXcudHlwZU5hbWUgPT09IFwiRnJhbWVcIiA/IFJPT1RfTk9ERV9UWVBFIDogRUxFTUVOVF9OT0RFX1RZUEU7XG4gICAgICAgIHRoaXMubm9kZUlkID0gdmlldy5fZG9tSWQ7XG4gICAgICAgIHRoaXMubm9kZU5hbWUgPSB2aWV3LnR5cGVOYW1lO1xuICAgICAgICB0aGlzLmxvY2FsTmFtZSA9IHRoaXMubm9kZU5hbWU7XG4gICAgICAgIHRoaXMubG9hZEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgcmVnaXN0ZXJOb2RlKHRoaXMpO1xuICAgIH1cbiAgICBET01Ob2RlLnByb3RvdHlwZS5sb2FkQXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIGdldFNldFByb3BlcnRpZXNMYXp5KCkodGhpcy52aWV3UmVmLmdldCgpKVxuICAgICAgICAgICAgLmZpbHRlcihwcm9wZXJ0eUZpbHRlcilcbiAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChwYWlyKSB7IHJldHVybiBfdGhpcy5hdHRyaWJ1dGVzLnB1c2gocGFpclswXSwgcGFpclsxXSArIFwiXCIpOyB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01Ob2RlLnByb3RvdHlwZSwgXCJjaGlsZHJlblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5lbnN1cmVEb21Ob2RlKCk7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goY2hpbGQuZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIERPTU5vZGUucHJvdG90eXBlLm9uQ2hpbGRBZGRlZCA9IGZ1bmN0aW9uIChjaGlsZFZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gX3RoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIHZhciBwcmV2aW91c0NoaWxkO1xuICAgICAgICAgICAgdmlldy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkID09PSBjaGlsZFZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2aW91c0NoaWxkID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9ICEhcHJldmlvdXNDaGlsZCA/IHByZXZpb3VzQ2hpbGQuX2RvbUlkIDogMDtcbiAgICAgICAgICAgIGNoaWxkVmlldy5lbnN1cmVEb21Ob2RlKCk7XG4gICAgICAgICAgICBpbnMuY2hpbGROb2RlSW5zZXJ0ZWQoX3RoaXMubm9kZUlkLCBpbmRleCwgY2hpbGRWaWV3LmRvbU5vZGUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLm9uQ2hpbGRSZW1vdmVkID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlucy5jaGlsZE5vZGVSZW1vdmVkKF90aGlzLm5vZGVJZCwgdmlldy5fZG9tSWQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLmF0dHJpYnV0ZU1vZGlmaWVkID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIG5vdGlmeUluc3BlY3RvcihmdW5jdGlvbiAoaW5zKSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydHlCbGFja2xpc3QuaW5kZXhPZihuYW1lKSA8IDApIHtcbiAgICAgICAgICAgICAgICBpbnMuYXR0cmlidXRlTW9kaWZpZWQoX3RoaXMubm9kZUlkLCBuYW1lLCB2YWx1ZVRvU3RyaW5nKHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuYXR0cmlidXRlUmVtb3ZlZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIG5vdGlmeUluc3BlY3RvcihmdW5jdGlvbiAoaW5zKSB7XG4gICAgICAgICAgICBpbnMuYXR0cmlidXRlUmVtb3ZlZChfdGhpcy5ub2RlSWQsIG5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLmdldENvbXB1dGVkUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBnZXRDb21wdXRlZENzc1ZhbHVlc0xhenkoKSh2aWV3KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocGFpcikgeyByZXR1cm4gcGFpclswXVswXSAhPT0gXCJfXCI7IH0pXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChwYWlyKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhaXJbMF0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlVG9TdHJpbmcocGFpclsxXSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdW5yZWdpc3Rlck5vZGUodGhpcyk7XG4gICAgICAgIHRoaXMudmlld1JlZi5jbGVhcigpO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUudG9PYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBub2RlSWQ6IHRoaXMubm9kZUlkLFxuICAgICAgICAgICAgbm9kZVR5cGU6IHRoaXMubm9kZVR5cGUsXG4gICAgICAgICAgICBub2RlTmFtZTogdGhpcy5ub2RlTmFtZSxcbiAgICAgICAgICAgIGxvY2FsTmFtZTogdGhpcy5sb2NhbE5hbWUsXG4gICAgICAgICAgICBub2RlVmFsdWU6IHRoaXMubm9kZVZhbHVlLFxuICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjLnRvT2JqZWN0KCk7IH0pLFxuICAgICAgICAgICAgYXR0cmlidXRlczogdGhpcy5hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgYmFja2VuZE5vZGVJZDogMFxuICAgICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIERPTU5vZGU7XG59KCkpO1xuZXhwb3J0cy5ET01Ob2RlID0gRE9NTm9kZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvbS1ub2RlLmpzLm1hcCIsIu+7vyhmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZXhwb3J0cy5YTUxIdHRwUmVxdWVzdCA9IGdsb2JhbC5YTUxIdHRwUmVxdWVzdDtcbiAgICBleHBvcnRzLkZvcm1EYXRhID0gZ2xvYmFsLkZvcm1EYXRhO1xuXG4gICAgaWYgKCFleHBvcnRzLlhNTEh0dHBSZXF1ZXN0KSB7XG4gICAgICAgIHZhciB4aHIgPSByZXF1aXJlKFwieGhyXCIpO1xuICAgICAgICBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0ID0geGhyLlhNTEh0dHBSZXF1ZXN0O1xuICAgICAgICBleHBvcnRzLkZvcm1EYXRhID0geGhyLkZvcm1EYXRhO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZU5hbWUobmFtZSkge1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvW15hLXowLTlcXC0jJCUmJyorLlxcXl9gfH5dL2kudGVzdChuYW1lKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3JtYWxpemVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIEhlYWRlcnMoaGVhZGVycykge1xuICAgICAgICB0aGlzLm1hcCA9IHt9XG5cbiAgICAgICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICAgICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBuYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICAgICAgICB9LCB0aGlzKVxuXG4gICAgICAgIH0gZWxzZSBpZiAoaGVhZGVycykge1xuICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoaGVhZGVycykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kKG5hbWUsIGhlYWRlcnNbbmFtZV0pXG4gICAgICAgICAgICB9LCB0aGlzKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIG5hbWUgPSBub3JtYWxpemVOYW1lKG5hbWUpXG4gICAgICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgICAgIHZhciBsaXN0ID0gdGhpcy5tYXBbbmFtZV1cbiAgICAgICAgaWYgKCFsaXN0KSB7XG4gICAgICAgICAgICBsaXN0ID0gW11cbiAgICAgICAgICAgIHRoaXMubWFwW25hbWVdID0gbGlzdFxuICAgICAgICB9XG4gICAgICAgIGxpc3QucHVzaCh2YWx1ZSlcbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZVsnZGVsZXRlJ10gPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbiAgICAgICAgcmV0dXJuIHZhbHVlcyA/IHZhbHVlc1swXSA6IG51bGxcbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV0gfHwgW11cbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXAuaGFzT3duUHJvcGVydHkobm9ybWFsaXplTmFtZShuYW1lKSlcbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV0gPSBbbm9ybWFsaXplVmFsdWUodmFsdWUpXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcy5tYXApLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubWFwW25hbWVdLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB2YWx1ZSwgbmFtZSwgdGhpcylcbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH0sIHRoaXMpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29uc3VtZWQoYm9keSkge1xuICAgICAgICBpZiAoYm9keS5ib2R5VXNlZCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpKVxuICAgICAgICB9XG4gICAgICAgIGJvZHkuYm9keVVzZWQgPSB0cnVlXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlYWRlci5yZXN1bHQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZWplY3QocmVhZGVyLmVycm9yKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWRCbG9iQXNBcnJheUJ1ZmZlcihibG9iKSB7XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgICAgICByZXR1cm4gZmlsZVJlYWRlclJlYWR5KHJlYWRlcilcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dChibG9iKSB7XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGJsb2IpXG4gICAgICAgIHJldHVybiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIH1cblxuICAgIHZhciBzdXBwb3J0ID0ge1xuICAgICAgICBibG9iOiAnRmlsZVJlYWRlcicgaW4gZXhwb3J0cyAmJiAnQmxvYicgaW4gZXhwb3J0cyAmJiAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBuZXcgQmxvYigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKCksXG4gICAgICAgIGZvcm1EYXRhOiAnRm9ybURhdGEnIGluIGV4cG9ydHNcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBCb2R5KCkge1xuICAgICAgICB0aGlzLmJvZHlVc2VkID0gZmFsc2VcblxuXG4gICAgICAgIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24gKGJvZHkpIHtcbiAgICAgICAgICAgIHRoaXMuX2JvZHlJbml0ID0gYm9keVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlCbG9iID0gYm9keVxuICAgICAgICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmZvcm1EYXRhICYmIGV4cG9ydHMuRm9ybURhdGEucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFib2R5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keVRleHQgPSAnJ1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vuc3VwcG9ydGVkIEJvZHlJbml0IHR5cGUnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1cHBvcnQuYmxvYikge1xuICAgICAgICAgICAgdGhpcy5ibG9iID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyBibG9iJylcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5hcnJheUJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ibG9iKCkudGhlbihyZWFkQmxvYkFzQXJyYXlCdWZmZXIpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgICAgICAgICAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0ZWRcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYm9keUJsb2IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlYWRCbG9iQXNUZXh0KHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0JylcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3RlZCA/IHJlamVjdGVkIDogUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1cHBvcnQuZm9ybURhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oZGVjb2RlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5qc29uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oSlNPTi5wYXJzZSlcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgLy8gSFRUUCBtZXRob2RzIHdob3NlIGNhcGl0YWxpemF0aW9uIHNob3VsZCBiZSBub3JtYWxpemVkXG4gICAgdmFyIG1ldGhvZHMgPSBbJ0RFTEVURScsICdHRVQnLCAnSEVBRCcsICdPUFRJT05TJywgJ1BPU1QnLCAnUFVUJ11cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZU1ldGhvZChtZXRob2QpIHtcbiAgICAgICAgdmFyIHVwY2FzZWQgPSBtZXRob2QudG9VcHBlckNhc2UoKVxuICAgICAgICByZXR1cm4gKG1ldGhvZHMuaW5kZXhPZih1cGNhc2VkKSA+IC0xKSA/IHVwY2FzZWQgOiBtZXRob2RcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBSZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICAgICAgICB0aGlzLnVybCA9IHVybFxuXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzIHx8ICdvbWl0J1xuICAgICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gICAgICAgIHRoaXMubWV0aG9kID0gbm9ybWFsaXplTWV0aG9kKG9wdGlvbnMubWV0aG9kIHx8ICdHRVQnKVxuICAgICAgICB0aGlzLm1vZGUgPSBvcHRpb25zLm1vZGUgfHwgbnVsbFxuICAgICAgICB0aGlzLnJlZmVycmVyID0gbnVsbFxuXG4gICAgICAgIGlmICgodGhpcy5tZXRob2QgPT09ICdHRVQnIHx8IHRoaXMubWV0aG9kID09PSAnSEVBRCcpICYmIG9wdGlvbnMuYm9keSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2luaXRCb2R5KG9wdGlvbnMuYm9keSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWNvZGUoYm9keSkge1xuICAgICAgICB2YXIgZm9ybSA9IG5ldyBleHBvcnRzLkZvcm1EYXRhKClcbiAgICAgICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uIChieXRlcykge1xuICAgICAgICAgICAgaWYgKGJ5dGVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gc3BsaXQuc2hpZnQoKS5yZXBsYWNlKC9cXCsvZywgJyAnKVxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNwbGl0LmpvaW4oJz0nKS5yZXBsYWNlKC9cXCsvZywgJyAnKVxuICAgICAgICAgICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZvcm1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoZWFkZXJzKHhocikge1xuICAgICAgICB2YXIgaGVhZCA9IG5ldyBIZWFkZXJzKClcbiAgICAgICAgdmFyIHBhaXJzID0geGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLnRyaW0oKS5zcGxpdCgnXFxuJylcbiAgICAgICAgcGFpcnMuZm9yRWFjaChmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgICAgICB2YXIgc3BsaXQgPSBoZWFkZXIudHJpbSgpLnNwbGl0KCc6JylcbiAgICAgICAgICAgIHZhciBrZXkgPSBzcGxpdC5zaGlmdCgpLnRyaW0oKVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignOicpLnRyaW0oKVxuICAgICAgICAgICAgaGVhZC5hcHBlbmQoa2V5LCB2YWx1ZSlcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGhlYWRcbiAgICB9XG5cbiAgICBCb2R5LmNhbGwoUmVxdWVzdC5wcm90b3R5cGUpXG5cbiAgICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSB7fVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG4gICAgICAgIHRoaXMudHlwZSA9ICdkZWZhdWx0J1xuICAgICAgICB0aGlzLnVybCA9IG51bGxcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1c1xuICAgICAgICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gICAgICAgIHRoaXMuc3RhdHVzVGV4dCA9IG9wdGlvbnMuc3RhdHVzVGV4dFxuICAgICAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzID8gb3B0aW9ucy5oZWFkZXJzIDogbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgICAgICB0aGlzLnVybCA9IG9wdGlvbnMudXJsIHx8ICcnXG4gICAgfVxuXG4gICAgQm9keS5jYWxsKFJlc3BvbnNlLnByb3RvdHlwZSlcblxuICAgIGV4cG9ydHMuSGVhZGVycyA9IEhlYWRlcnM7XG4gICAgZXhwb3J0cy5SZXF1ZXN0ID0gUmVxdWVzdDtcbiAgICBleHBvcnRzLlJlc3BvbnNlID0gUmVzcG9uc2U7XG5cbiAgICBleHBvcnRzLmZldGNoID0gZnVuY3Rpb24gKGlucHV0LCBpbml0KSB7XG4gICAgICAgIC8vIFRPRE86IFJlcXVlc3QgY29uc3RydWN0b3Igc2hvdWxkIGFjY2VwdCBpbnB1dCwgaW5pdFxuICAgICAgICB2YXIgcmVxdWVzdFxuICAgICAgICBpZiAoUmVxdWVzdC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihpbnB1dCkgJiYgIWluaXQpIHtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBpbnB1dFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgZXhwb3J0cy5YTUxIdHRwUmVxdWVzdCgpXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc3BvbnNlVVJMKCkge1xuICAgICAgICAgICAgICAgIGlmICgncmVzcG9uc2VVUkwnIGluIHhocikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlVVJMXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQXZvaWQgc2VjdXJpdHkgd2FybmluZ3Mgb24gZ2V0UmVzcG9uc2VIZWFkZXIgd2hlbiBub3QgYWxsb3dlZCBieSBDT1JTXG4gICAgICAgICAgICAgICAgaWYgKC9eWC1SZXF1ZXN0LVVSTDovbS50ZXN0KHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1SZXF1ZXN0LVVSTCcpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSAoeGhyLnN0YXR1cyA9PT0gMTIyMykgPyAyMDQgOiB4aHIuc3RhdHVzXG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA8IDEwMCB8fCBzdGF0dXMgPiA1OTkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHQsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMoeGhyKSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiByZXNwb25zZVVSTCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vdmFyIGJvZHkgPSAncmVzcG9uc2UnIGluIHhociA/IHhoci5yZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShuZXcgUmVzcG9uc2UoeGhyLnJlc3BvbnNlVGV4dCwgb3B0aW9ucykpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoWydOZXR3b3JrIHJlcXVlc3QgZmFpbGVkOicsIGVycm9yLm1lc3NhZ2VdLmpvaW4oJyAnKSkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vcGVuKHJlcXVlc3QubWV0aG9kLCByZXF1ZXN0LnVybCwgdHJ1ZSlcblxuICAgICAgICAgICAgaWYgKHJlcXVlc3QuY3JlZGVudGlhbHMgPT09ICdpbmNsdWRlJykge1xuICAgICAgICAgICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICgncmVzcG9uc2VUeXBlJyBpbiB4aHIgJiYgc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGV4cG9ydHMuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG5cbn0pKCk7IiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRNb2R1bGUgPSByZXF1aXJlKFwiLi4vdGV4dFwiKTtcbnZhciBhcHBsaWNhdGlvbl8xID0gcmVxdWlyZShcIi4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIGFwcGxpY2F0aW9uQ29udGV4dDtcbmZ1bmN0aW9uIGdldEFwcGxpY2F0aW9uQ29udGV4dCgpIHtcbiAgICBpZiAoIWFwcGxpY2F0aW9uQ29udGV4dCkge1xuICAgICAgICBhcHBsaWNhdGlvbkNvbnRleHQgPSBhcHBsaWNhdGlvbl8xLmdldE5hdGl2ZUFwcGxpY2F0aW9uKCkuZ2V0QXBwbGljYXRpb25Db250ZXh0KCk7XG4gICAgfVxuICAgIHJldHVybiBhcHBsaWNhdGlvbkNvbnRleHQ7XG59XG52YXIgRmlsZVN5c3RlbUFjY2VzcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmlsZVN5c3RlbUFjY2VzcygpIHtcbiAgICAgICAgdGhpcy5fcGF0aFNlcGFyYXRvciA9IFwiL1wiO1xuICAgIH1cbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRMYXN0TW9kaWZpZWQgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoamF2YUZpbGUubGFzdE1vZGlmaWVkKCkpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZVNpemUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICByZXR1cm4gamF2YUZpbGUubGVuZ3RoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRQYXJlbnQgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IGphdmFGaWxlLmdldFBhcmVudEZpbGUoKTtcbiAgICAgICAgICAgIHJldHVybiB7IHBhdGg6IHBhcmVudF8xLmdldEFic29sdXRlUGF0aCgpLCBuYW1lOiBwYXJlbnRfMS5nZXROYW1lKCkgfTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEZpbGUgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5lbnN1cmVGaWxlKG5ldyBqYXZhLmlvLkZpbGUocGF0aCksIGZhbHNlLCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEZvbGRlciA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgIHZhciBkaXJJbmZvID0gdGhpcy5lbnN1cmVGaWxlKGphdmFGaWxlLCB0cnVlLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFkaXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHBhdGg6IGRpckluZm8ucGF0aCwgbmFtZTogZGlySW5mby5uYW1lIH07XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5lYWNoRW50aXR5ID0gZnVuY3Rpb24gKHBhdGgsIG9uRW50aXR5LCBvbkVycm9yKSB7XG4gICAgICAgIGlmICghb25FbnRpdHkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVudW1FbnRpdGllcyhwYXRoLCBvbkVudGl0eSwgb25FcnJvcik7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRFbnRpdGllcyA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHZhciBmaWxlSW5mb3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdmFyIG9uRW50aXR5ID0gZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgICAgICAgZmlsZUluZm9zLnB1c2goZW50aXR5KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZXJyb3JPY2N1cnJlZDtcbiAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlcnJvck9jY3VycmVkID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbnVtRW50aXRpZXMocGF0aCwgb25FbnRpdHksIGxvY2FsRXJyb3IpO1xuICAgICAgICBpZiAoIWVycm9yT2NjdXJyZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWxlSW5mb3M7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5maWxlRXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICByZXR1cm4gZmlsZS5leGlzdHMoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmZvbGRlckV4aXN0cyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBmaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgcmV0dXJuIGZpbGUuZXhpc3RzKCkgJiYgZmlsZS5pc0RpcmVjdG9yeSgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZGVsZXRlRmlsZSA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICAgICAgaWYgKCFqYXZhRmlsZS5pc0ZpbGUoKSkge1xuICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoeyBtZXNzYWdlOiBcIlRoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCBhIEZpbGUgZW50aXR5LlwiIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmRlbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiRmlsZSBkZWxldGlvbiBmYWlsZWRcIiB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmRlbGV0ZUZvbGRlciA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKHBhdGgpO1xuICAgICAgICAgICAgaWYgKCFqYXZhRmlsZS5nZXRDYW5vbmljYWxGaWxlKCkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoeyBtZXNzYWdlOiBcIlRoZSBzcGVjaWZpZWQgcGFyYW1ldGVyIGlzIG5vdCBhIEZvbGRlciBlbnRpdHkuXCIgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZGVsZXRlRm9sZGVyQ29udGVudChqYXZhRmlsZSk7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmRlbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiRm9sZGVyIGRlbGV0aW9uIGZhaWxlZC5cIiB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVtcHR5Rm9sZGVyID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmdldENhbm9uaWNhbEZpbGUoKS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiVGhlIHNwZWNpZmllZCBwYXJhbWV0ZXIgaXMgbm90IGEgRm9sZGVyIGVudGl0eS5cIiB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kZWxldGVGb2xkZXJDb250ZW50KGphdmFGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUucmVuYW1lID0gZnVuY3Rpb24gKHBhdGgsIG5ld1BhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgaWYgKCFqYXZhRmlsZS5leGlzdHMoKSkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIlRoZSBmaWxlIHRvIHJlbmFtZSBkb2VzIG5vdCBleGlzdFwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld0ZpbGUgPSBuZXcgamF2YS5pby5GaWxlKG5ld1BhdGgpO1xuICAgICAgICBpZiAobmV3RmlsZS5leGlzdHMoKSkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkEgZmlsZSB3aXRoIHRoZSBzYW1lIG5hbWUgYWxyZWFkeSBleGlzdHMuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWphdmFGaWxlLnJlbmFtZVRvKG5ld0ZpbGUpKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIHJlbmFtZSBmaWxlICdcIiArIHBhdGggKyBcIicgdG8gJ1wiICsgbmV3UGF0aCArIFwiJ1wiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldERvY3VtZW50c0ZvbGRlclBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkaXIgPSBnZXRBcHBsaWNhdGlvbkNvbnRleHQoKS5nZXRGaWxlc0RpcigpO1xuICAgICAgICByZXR1cm4gZGlyLmdldEFic29sdXRlUGF0aCgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0TG9naWNhbFJvb3RQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGlyID0gZ2V0QXBwbGljYXRpb25Db250ZXh0KCkuZ2V0RmlsZXNEaXIoKTtcbiAgICAgICAgcmV0dXJuIGRpci5nZXRDYW5vbmljYWxQYXRoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRUZW1wRm9sZGVyUGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRpciA9IGdldEFwcGxpY2F0aW9uQ29udGV4dCgpLmdldENhY2hlRGlyKCk7XG4gICAgICAgIHJldHVybiBkaXIuZ2V0QWJzb2x1dGVQYXRoKCk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRDdXJyZW50QXBwUGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9naWNhbFJvb3RQYXRoKCkgKyBcIi9hcHBcIjtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgamF2YS5pby5GaWxlSW5wdXRTdHJlYW0oamF2YUZpbGUpO1xuICAgICAgICAgICAgdmFyIGJ5dGVzID0gQXJyYXkuY3JlYXRlKFwiYnl0ZVwiLCBqYXZhRmlsZS5sZW5ndGgoKSk7XG4gICAgICAgICAgICB2YXIgZGF0YUlucHV0U3RyZWFtID0gbmV3IGphdmEuaW8uRGF0YUlucHV0U3RyZWFtKHN0cmVhbSk7XG4gICAgICAgICAgICBkYXRhSW5wdXRTdHJlYW0ucmVhZEZ1bGx5KGJ5dGVzKTtcbiAgICAgICAgICAgIHJldHVybiBieXRlcztcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAocGF0aCwgYnl0ZXMsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICB2YXIgc3RyZWFtID0gbmV3IGphdmEuaW8uRmlsZU91dHB1dFN0cmVhbShqYXZhRmlsZSk7XG4gICAgICAgICAgICBzdHJlYW0ud3JpdGUoYnl0ZXMsIDAsIGJ5dGVzLmxlbmd0aCk7XG4gICAgICAgICAgICBzdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICB2YXIgc3RyZWFtID0gbmV3IGphdmEuaW8uRmlsZUlucHV0U3RyZWFtKGphdmFGaWxlKTtcbiAgICAgICAgICAgIHZhciBhY3R1YWxFbmNvZGluZyA9IGVuY29kaW5nO1xuICAgICAgICAgICAgaWYgKCFhY3R1YWxFbmNvZGluZykge1xuICAgICAgICAgICAgICAgIGFjdHVhbEVuY29kaW5nID0gdGV4dE1vZHVsZS5lbmNvZGluZy5VVEZfODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgamF2YS5pby5JbnB1dFN0cmVhbVJlYWRlcihzdHJlYW0sIGFjdHVhbEVuY29kaW5nKTtcbiAgICAgICAgICAgIHZhciBidWZmZXJlZFJlYWRlciA9IG5ldyBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyKHJlYWRlcik7XG4gICAgICAgICAgICB2YXIgbGluZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICBsaW5lID0gYnVmZmVyZWRSZWFkZXIucmVhZExpbmUoKTtcbiAgICAgICAgICAgICAgICBpZiAobGluZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBcIlxcblwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gbGluZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhY3R1YWxFbmNvZGluZyA9PT0gdGV4dE1vZHVsZS5lbmNvZGluZy5VVEZfOCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IEZpbGVTeXN0ZW1BY2Nlc3MuX3JlbW92ZVV0ZjhCb20ocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJ1ZmZlcmVkUmVhZGVyLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLl9yZW1vdmVVdGY4Qm9tID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgaWYgKHMuY2hhckNvZGVBdCgwKSA9PT0gMHhGRUZGKSB7XG4gICAgICAgICAgICBzID0gcy5zbGljZSgxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcztcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLndyaXRlVGV4dCA9IGZ1bmN0aW9uIChwYXRoLCBjb250ZW50LCBvbkVycm9yLCBlbmNvZGluZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFGaWxlID0gbmV3IGphdmEuaW8uRmlsZShwYXRoKTtcbiAgICAgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgamF2YS5pby5GaWxlT3V0cHV0U3RyZWFtKGphdmFGaWxlKTtcbiAgICAgICAgICAgIHZhciBhY3R1YWxFbmNvZGluZyA9IGVuY29kaW5nO1xuICAgICAgICAgICAgaWYgKCFhY3R1YWxFbmNvZGluZykge1xuICAgICAgICAgICAgICAgIGFjdHVhbEVuY29kaW5nID0gdGV4dE1vZHVsZS5lbmNvZGluZy5VVEZfODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB3cml0ZXIgPSBuZXcgamF2YS5pby5PdXRwdXRTdHJlYW1Xcml0ZXIoc3RyZWFtLCBhY3R1YWxFbmNvZGluZyk7XG4gICAgICAgICAgICB3cml0ZXIud3JpdGUoY29udGVudCk7XG4gICAgICAgICAgICB3cml0ZXIuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXhjZXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZGVsZXRlRm9sZGVyQ29udGVudCA9IGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgIHZhciBmaWxlc0xpc3QgPSBmaWxlLmxpc3RGaWxlcygpO1xuICAgICAgICBpZiAoZmlsZXNMaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkRmlsZTtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWxlc0xpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNoaWxkRmlsZSA9IGZpbGVzTGlzdFtpXTtcbiAgICAgICAgICAgIGlmIChjaGlsZEZpbGUuZ2V0Q2Fub25pY2FsRmlsZSgpLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzID0gdGhpcy5kZWxldGVGb2xkZXJDb250ZW50KGNoaWxkRmlsZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN1Y2Nlc3MgPSBjaGlsZEZpbGUuZGVsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5lbnN1cmVGaWxlID0gZnVuY3Rpb24gKGphdmFGaWxlLCBpc0ZvbGRlciwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCFqYXZhRmlsZS5leGlzdHMoKSkge1xuICAgICAgICAgICAgICAgIHZhciBjcmVhdGVkID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChpc0ZvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkID0gamF2YUZpbGUubWtkaXJzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBqYXZhRmlsZS5nZXRQYXJlbnRGaWxlKCkubWtkaXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgPSBqYXZhRmlsZS5jcmVhdGVOZXdGaWxlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghY3JlYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb25FcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgbmV3IGphdmEgRmlsZSBmb3IgcGF0aCBcIiArIGphdmFGaWxlLmdldEFic29sdXRlUGF0aCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgamF2YUZpbGUuc2V0UmVhZGFibGUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGphdmFGaWxlLnNldFdyaXRhYmxlKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwYXRoID0gamF2YUZpbGUuZ2V0QWJzb2x1dGVQYXRoKCk7XG4gICAgICAgICAgICByZXR1cm4geyBwYXRoOiBwYXRoLCBuYW1lOiBqYXZhRmlsZS5nZXROYW1lKCksIGV4dGVuc2lvbjogdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKHBhdGgpIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGaWxlRXh0ZW5zaW9uID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIGRvdEluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgIGlmIChkb3RJbmRleCAmJiBkb3RJbmRleCA+PSAwICYmIGRvdEluZGV4IDwgcGF0aC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXRoLnN1YnN0cmluZyhkb3RJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5lbnVtRW50aXRpZXMgPSBmdW5jdGlvbiAocGF0aCwgY2FsbGJhY2ssIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBqYXZhRmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgICAgICBpZiAoIWphdmFGaWxlLmdldENhbm9uaWNhbEZpbGUoKS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihcIlRoZXJlIGlzIG5vIGZvbGRlciBleGlzdGluZyBhdCBwYXRoIFwiICsgcGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmaWxlc0xpc3QgPSBqYXZhRmlsZS5saXN0RmlsZXMoKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGhfMSA9IGZpbGVzTGlzdC5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHZhciByZXRWYWwgPSB2b2lkIDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgICAgICBqYXZhRmlsZSA9IGZpbGVzTGlzdFtpXTtcbiAgICAgICAgICAgICAgICBpbmZvID0ge1xuICAgICAgICAgICAgICAgICAgICBwYXRoOiBqYXZhRmlsZS5nZXRBYnNvbHV0ZVBhdGgoKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogamF2YUZpbGUuZ2V0TmFtZSgpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoamF2YUZpbGUuaXNGaWxlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5mby5leHRlbnNpb24gPSB0aGlzLmdldEZpbGVFeHRlbnNpb24oaW5mby5wYXRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0VmFsID0gY2FsbGJhY2soaW5mbyk7XG4gICAgICAgICAgICAgICAgaWYgKHJldFZhbCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRQYXRoU2VwYXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGF0aFNlcGFyYXRvcjtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLm5vcm1hbGl6ZVBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZSA9IG5ldyBqYXZhLmlvLkZpbGUocGF0aCk7XG4gICAgICAgIHJldHVybiBmaWxlLmdldEFic29sdXRlUGF0aCgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuam9pblBhdGggPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgICAgICAgdmFyIGZpbGUxID0gbmV3IGphdmEuaW8uRmlsZShsZWZ0KTtcbiAgICAgICAgdmFyIGZpbGUyID0gbmV3IGphdmEuaW8uRmlsZShmaWxlMSwgcmlnaHQpO1xuICAgICAgICByZXR1cm4gZmlsZTIuZ2V0UGF0aCgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuam9pblBhdGhzID0gZnVuY3Rpb24gKHBhdGhzKSB7XG4gICAgICAgIGlmICghcGF0aHMgfHwgcGF0aHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGF0aHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gcGF0aHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IHBhdGhzWzBdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLmpvaW5QYXRoKHJlc3VsdCwgcGF0aHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICByZXR1cm4gRmlsZVN5c3RlbUFjY2Vzcztcbn0oKSk7XG5leHBvcnRzLkZpbGVTeXN0ZW1BY2Nlc3MgPSBGaWxlU3lzdGVtQWNjZXNzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmlsZS1zeXN0ZW0tYWNjZXNzLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZpbGVfc3lzdGVtX2FjY2Vzc18xID0gcmVxdWlyZShcIi4vZmlsZS1zeXN0ZW0tYWNjZXNzXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uL3Byb2ZpbGluZ1wiKTtcbnZhciBmaWxlQWNjZXNzO1xuZnVuY3Rpb24gZ2V0RmlsZUFjY2VzcygpIHtcbiAgICBpZiAoIWZpbGVBY2Nlc3MpIHtcbiAgICAgICAgZmlsZUFjY2VzcyA9IG5ldyBmaWxlX3N5c3RlbV9hY2Nlc3NfMS5GaWxlU3lzdGVtQWNjZXNzKCk7XG4gICAgfVxuICAgIHJldHVybiBmaWxlQWNjZXNzO1xufVxudmFyIHBsYXRmb3JtO1xuZnVuY3Rpb24gZW5zdXJlUGxhdGZvcm0oKSB7XG4gICAgaWYgKCFwbGF0Zm9ybSkge1xuICAgICAgICBwbGF0Zm9ybSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybVwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVGaWxlKGluZm8pIHtcbiAgICB2YXIgZmlsZSA9IG5ldyBGaWxlKCk7XG4gICAgZmlsZS5fcGF0aCA9IGluZm8ucGF0aDtcbiAgICBmaWxlLl9uYW1lID0gaW5mby5uYW1lO1xuICAgIGZpbGUuX2V4dGVuc2lvbiA9IGluZm8uZXh0ZW5zaW9uO1xuICAgIHJldHVybiBmaWxlO1xufVxuZnVuY3Rpb24gY3JlYXRlRm9sZGVyKGluZm8pIHtcbiAgICB2YXIgZG9jdW1lbnRzID0ga25vd25Gb2xkZXJzLmRvY3VtZW50cygpO1xuICAgIGlmIChpbmZvLnBhdGggPT09IGRvY3VtZW50cy5wYXRoKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudHM7XG4gICAgfVxuICAgIHZhciB0ZW1wID0ga25vd25Gb2xkZXJzLnRlbXAoKTtcbiAgICBpZiAoaW5mby5wYXRoID09PSB0ZW1wLnBhdGgpIHtcbiAgICAgICAgcmV0dXJuIHRlbXA7XG4gICAgfVxuICAgIHZhciBmb2xkZXIgPSBuZXcgRm9sZGVyKCk7XG4gICAgZm9sZGVyLl9wYXRoID0gaW5mby5wYXRoO1xuICAgIGZvbGRlci5fbmFtZSA9IGluZm8ubmFtZTtcbiAgICByZXR1cm4gZm9sZGVyO1xufVxudmFyIEZpbGVTeXN0ZW1FbnRpdHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZpbGVTeXN0ZW1FbnRpdHkoKSB7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZSwgXCJwYXJlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGZvbGRlckluZm8gPSBnZXRGaWxlQWNjZXNzKCkuZ2V0UGFyZW50KHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgICAgICAgICBpZiAoIWZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZVN5bmMobG9jYWxFcnJvcik7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLnJlbW92ZVN5bmMgPSBmdW5jdGlvbiAob25FcnJvcikge1xuICAgICAgICBpZiAodGhpcy5faXNLbm93bikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKHsgbWVzc2FnZTogXCJDYW5ub3QgZGVsZXRlIGtub3duIGZvbGRlci5cIiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBGaWxlKSB7XG4gICAgICAgICAgICBmaWxlQWNjZXNzLmRlbGV0ZUZpbGUodGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzIGluc3RhbmNlb2YgRm9sZGVyKSB7XG4gICAgICAgICAgICBmaWxlQWNjZXNzLmRlbGV0ZUZvbGRlcih0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW5hbWUgPSBmdW5jdGlvbiAobmV3TmFtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF90aGlzLnJlbmFtZVN5bmMobmV3TmFtZSwgbG9jYWxFcnJvcik7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLnJlbmFtZVN5bmMgPSBmdW5jdGlvbiAobmV3TmFtZSwgb25FcnJvcikge1xuICAgICAgICBpZiAodGhpcy5faXNLbm93bikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkNhbm5vdCByZW5hbWUga25vd24gZm9sZGVyLlwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudEZvbGRlciA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAoIXBhcmVudEZvbGRlcikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIk5vIHBhcmVudCBmb2xkZXIuXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBwYXJlbnRGb2xkZXIucGF0aDtcbiAgICAgICAgdmFyIG5ld1BhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHBhdGgsIG5ld05hbWUpO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBmaWxlQWNjZXNzLnJlbmFtZSh0aGlzLnBhdGgsIG5ld1BhdGgsIGxvY2FsRXJyb3IpO1xuICAgICAgICB0aGlzLl9wYXRoID0gbmV3UGF0aDtcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5ld05hbWU7XG4gICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgICAgdGhpcy5fZXh0ZW5zaW9uID0gZmlsZUFjY2Vzcy5nZXRGaWxlRXh0ZW5zaW9uKG5ld1BhdGgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZSwgXCJwYXRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGF0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLCBcImxhc3RNb2RpZmllZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fbGFzdE1vZGlmaWVkO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9sYXN0TW9kaWZpZWQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMuX2xhc3RNb2RpZmllZCA9IGdldEZpbGVBY2Nlc3MoKS5nZXRMYXN0TW9kaWZpZWQodGhpcy5wYXRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEZpbGVTeXN0ZW1FbnRpdHk7XG59KCkpO1xuZXhwb3J0cy5GaWxlU3lzdGVtRW50aXR5ID0gRmlsZVN5c3RlbUVudGl0eTtcbnZhciBGaWxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRmlsZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGaWxlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZpbGUuZnJvbVBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmaWxlSW5mbyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRGaWxlKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZpbGVJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVGaWxlKGZpbGVJbmZvKTtcbiAgICB9O1xuICAgIEZpbGUuZXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGdldEZpbGVBY2Nlc3MoKS5maWxlRXhpc3RzKHBhdGgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGUucHJvdG90eXBlLCBcImV4dGVuc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2V4dGVuc2lvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGUucHJvdG90eXBlLCBcImlzTG9ja2VkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gISF0aGlzLl9sb2NrZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlLnByb3RvdHlwZSwgXCJzaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0RmlsZUFjY2VzcygpLmdldEZpbGVTaXplKHRoaXMucGF0aCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZpbGUucHJvdG90eXBlLnJlYWRTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IpIHtcbiAgICAgICAgdGhpcy5jaGVja0FjY2VzcygpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aGF0Ll9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjb250ZW50ID0gZ2V0RmlsZUFjY2VzcygpLnJlYWQodGhpcy5wYXRoLCBsb2NhbEVycm9yKTtcbiAgICAgICAgdGhpcy5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUud3JpdGVTeW5jID0gZnVuY3Rpb24gKGNvbnRlbnQsIG9uRXJyb3IpIHtcbiAgICAgICAgdGhpcy5jaGVja0FjY2VzcygpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciB0aGF0XzEgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGF0XzEuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBnZXRGaWxlQWNjZXNzKCkud3JpdGUodGhpcy5wYXRoLCBjb250ZW50LCBsb2NhbEVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS5yZWFkVGV4dCA9IGZ1bmN0aW9uIChlbmNvZGluZykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gX3RoaXMucmVhZFRleHRTeW5jKGxvY2FsRXJyb3IsIGVuY29kaW5nKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLnJlYWRUZXh0U3luYyA9IGZ1bmN0aW9uIChvbkVycm9yLCBlbmNvZGluZykge1xuICAgICAgICB0aGlzLmNoZWNrQWNjZXNzKCk7XG4gICAgICAgIHRoaXMuX2xvY2tlZCA9IHRydWU7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoYXQuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBnZXRGaWxlQWNjZXNzKCkucmVhZFRleHQodGhpcy5wYXRoLCBsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgIHRoaXMuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLndyaXRlVGV4dCA9IGZ1bmN0aW9uIChjb250ZW50LCBlbmNvZGluZykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF90aGlzLndyaXRlVGV4dFN5bmMoY29udGVudCwgbG9jYWxFcnJvciwgZW5jb2RpbmcpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS53cml0ZVRleHRTeW5jID0gZnVuY3Rpb24gKGNvbnRlbnQsIG9uRXJyb3IsIGVuY29kaW5nKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGhhdF8yID0gdGhpcztcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhhdF8yLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZ2V0RmlsZUFjY2VzcygpLndyaXRlVGV4dCh0aGlzLnBhdGgsIGNvbnRlbnQsIGxvY2FsRXJyb3IsIGVuY29kaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS5jaGVja0FjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NrZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBhY2Nlc3MgYSBsb2NrZWQgZmlsZS5cIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRmlsZS5wcm90b3R5cGUsIFwicmVhZFRleHRTeW5jXCIsIG51bGwpO1xuICAgIHJldHVybiBGaWxlO1xufShGaWxlU3lzdGVtRW50aXR5KSk7XG5leHBvcnRzLkZpbGUgPSBGaWxlO1xudmFyIEZvbGRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZvbGRlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGb2xkZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRm9sZGVyLmZyb21QYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZm9sZGVySW5mbyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRGb2xkZXIocGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZm9sZGVySW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRm9sZGVyKGZvbGRlckluZm8pO1xuICAgIH07XG4gICAgRm9sZGVyLmV4aXN0cyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkuZm9sZGVyRXhpc3RzKHBhdGgpO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICB2YXIgcGF0aCA9IGZpbGVBY2Nlc3Muam9pblBhdGgodGhpcy5wYXRoLCBuYW1lKTtcbiAgICAgICAgaWYgKGZpbGVBY2Nlc3MuZmlsZUV4aXN0cyhwYXRoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGVBY2Nlc3MuZm9sZGVyRXhpc3RzKHBhdGgpO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5jbGVhclN5bmMob25FcnJvcik7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuY2xlYXJTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IpIHtcbiAgICAgICAgZ2V0RmlsZUFjY2VzcygpLmVtcHR5Rm9sZGVyKHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9sZGVyLnByb3RvdHlwZSwgXCJpc0tub3duXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNLbm93bjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRm9sZGVyLnByb3RvdHlwZS5nZXRGaWxlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHZhciBwYXRoID0gZmlsZUFjY2Vzcy5qb2luUGF0aCh0aGlzLnBhdGgsIG5hbWUpO1xuICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBmaWxlSW5mbyA9IGZpbGVBY2Nlc3MuZ2V0RmlsZShwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmaWxlSW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRmlsZShmaWxlSW5mbyk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEZvbGRlciA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICB2YXIgcGF0aCA9IGZpbGVBY2Nlc3Muam9pblBhdGgodGhpcy5wYXRoLCBuYW1lKTtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZm9sZGVySW5mbyA9IGZpbGVBY2Nlc3MuZ2V0Rm9sZGVyKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZvbGRlckluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuZ2V0RW50aXRpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGVudGl0aWVzID0gX3RoaXMuZ2V0RW50aXRpZXNTeW5jKGxvY2FsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZW50aXRpZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuZ2V0RW50aXRpZXNTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVJbmZvcyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRFbnRpdGllcyh0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZpbGVJbmZvcykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVudGl0aWVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZUluZm9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoZmlsZUluZm9zW2ldLmV4dGVuc2lvbikge1xuICAgICAgICAgICAgICAgIGVudGl0aWVzLnB1c2goY3JlYXRlRmlsZShmaWxlSW5mb3NbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVudGl0aWVzLnB1c2goY3JlYXRlRm9sZGVyKGZpbGVJbmZvc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRpdGllcztcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuZWFjaEVudGl0eSA9IGZ1bmN0aW9uIChvbkVudGl0eSkge1xuICAgICAgICBpZiAoIW9uRW50aXR5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9uU3VjY2VzcyA9IGZ1bmN0aW9uIChmaWxlSW5mbykge1xuICAgICAgICAgICAgdmFyIGVudGl0eTtcbiAgICAgICAgICAgIGlmIChmaWxlSW5mby5leHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkgPSBjcmVhdGVGaWxlKGZpbGVJbmZvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVudGl0eSA9IGNyZWF0ZUZvbGRlcihmaWxlSW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb25FbnRpdHkoZW50aXR5KTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICBnZXRGaWxlQWNjZXNzKCkuZWFjaEVudGl0eSh0aGlzLnBhdGgsIG9uU3VjY2Vzcywgb25FcnJvcik7XG4gICAgfTtcbiAgICByZXR1cm4gRm9sZGVyO1xufShGaWxlU3lzdGVtRW50aXR5KSk7XG5leHBvcnRzLkZvbGRlciA9IEZvbGRlcjtcbnZhciBrbm93bkZvbGRlcnM7XG4oZnVuY3Rpb24gKGtub3duRm9sZGVycykge1xuICAgIHZhciBfZG9jdW1lbnRzO1xuICAgIHZhciBfdGVtcDtcbiAgICB2YXIgX2FwcDtcbiAgICBmdW5jdGlvbiBkb2N1bWVudHMoKSB7XG4gICAgICAgIGlmICghX2RvY3VtZW50cykge1xuICAgICAgICAgICAgdmFyIHBhdGhfMSA9IGdldEZpbGVBY2Nlc3MoKS5nZXREb2N1bWVudHNGb2xkZXJQYXRoKCk7XG4gICAgICAgICAgICBfZG9jdW1lbnRzID0gbmV3IEZvbGRlcigpO1xuICAgICAgICAgICAgX2RvY3VtZW50cy5fcGF0aCA9IHBhdGhfMTtcbiAgICAgICAgICAgIF9kb2N1bWVudHMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfZG9jdW1lbnRzO1xuICAgIH1cbiAgICBrbm93bkZvbGRlcnMuZG9jdW1lbnRzID0gZG9jdW1lbnRzO1xuICAgIGZ1bmN0aW9uIHRlbXAoKSB7XG4gICAgICAgIGlmICghX3RlbXApIHtcbiAgICAgICAgICAgIHZhciBwYXRoXzIgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0VGVtcEZvbGRlclBhdGgoKTtcbiAgICAgICAgICAgIF90ZW1wID0gbmV3IEZvbGRlcigpO1xuICAgICAgICAgICAgX3RlbXAuX3BhdGggPSBwYXRoXzI7XG4gICAgICAgICAgICBfdGVtcC5faXNLbm93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90ZW1wO1xuICAgIH1cbiAgICBrbm93bkZvbGRlcnMudGVtcCA9IHRlbXA7XG4gICAgZnVuY3Rpb24gY3VycmVudEFwcCgpIHtcbiAgICAgICAgaWYgKCFfYXBwKSB7XG4gICAgICAgICAgICB2YXIgcGF0aF8zID0gZ2V0RmlsZUFjY2VzcygpLmdldEN1cnJlbnRBcHBQYXRoKCk7XG4gICAgICAgICAgICBfYXBwID0gbmV3IEZvbGRlcigpO1xuICAgICAgICAgICAgX2FwcC5fcGF0aCA9IHBhdGhfMztcbiAgICAgICAgICAgIF9hcHAuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfYXBwO1xuICAgIH1cbiAgICBrbm93bkZvbGRlcnMuY3VycmVudEFwcCA9IGN1cnJlbnRBcHA7XG4gICAgdmFyIGlvcztcbiAgICAoZnVuY3Rpb24gKGlvcykge1xuICAgICAgICBmdW5jdGlvbiBfY2hlY2tQbGF0Zm9ybShrbm93bkZvbGRlck5hbWUpIHtcbiAgICAgICAgICAgIGVuc3VyZVBsYXRmb3JtKCk7XG4gICAgICAgICAgICBpZiAoIXBsYXRmb3JtLmlzSU9TKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFxcXCJcIiArIGtub3duRm9sZGVyTmFtZSArIFwiXFxcIiBrbm93biBmb2xkZXIgaXMgYXZhaWxhYmxlIG9uIGlPUyBvbmx5IVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgX2xpYnJhcnk7XG4gICAgICAgIGZ1bmN0aW9uIGxpYnJhcnkoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcImxpYnJhcnlcIik7XG4gICAgICAgICAgICBpZiAoIV9saWJyYXJ5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbyg1KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9saWJyYXJ5ID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX2xpYnJhcnkuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX2xpYnJhcnkuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfbGlicmFyeTtcbiAgICAgICAgfVxuICAgICAgICBpb3MubGlicmFyeSA9IGxpYnJhcnk7XG4gICAgICAgIHZhciBfZGV2ZWxvcGVyO1xuICAgICAgICBmdW5jdGlvbiBkZXZlbG9wZXIoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcImRldmVsb3BlclwiKTtcbiAgICAgICAgICAgIGlmICghX2RldmVsb3Blcikge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oNik7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfZGV2ZWxvcGVyID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX2RldmVsb3Blci5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfZGV2ZWxvcGVyLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2RldmVsb3BlcjtcbiAgICAgICAgfVxuICAgICAgICBpb3MuZGV2ZWxvcGVyID0gZGV2ZWxvcGVyO1xuICAgICAgICB2YXIgX2Rlc2t0b3A7XG4gICAgICAgIGZ1bmN0aW9uIGRlc2t0b3AoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcImRlc2t0b3BcIik7XG4gICAgICAgICAgICBpZiAoIV9kZXNrdG9wKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxMik7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfZGVza3RvcCA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9kZXNrdG9wLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9kZXNrdG9wLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2Rlc2t0b3A7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmRlc2t0b3AgPSBkZXNrdG9wO1xuICAgICAgICB2YXIgX2Rvd25sb2FkcztcbiAgICAgICAgZnVuY3Rpb24gZG93bmxvYWRzKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJkb3dubG9hZHNcIik7XG4gICAgICAgICAgICBpZiAoIV9kb3dubG9hZHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDE1KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9kb3dubG9hZHMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfZG93bmxvYWRzLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9kb3dubG9hZHMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfZG93bmxvYWRzO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5kb3dubG9hZHMgPSBkb3dubG9hZHM7XG4gICAgICAgIHZhciBfbW92aWVzO1xuICAgICAgICBmdW5jdGlvbiBtb3ZpZXMoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcIm1vdmllc1wiKTtcbiAgICAgICAgICAgIGlmICghX21vdmllcykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTcpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX21vdmllcyA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9tb3ZpZXMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX21vdmllcy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9tb3ZpZXM7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLm1vdmllcyA9IG1vdmllcztcbiAgICAgICAgdmFyIF9tdXNpYztcbiAgICAgICAgZnVuY3Rpb24gbXVzaWMoKSB7XG4gICAgICAgICAgICBfY2hlY2tQbGF0Zm9ybShcIm11c2ljXCIpO1xuICAgICAgICAgICAgaWYgKCFfbXVzaWMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDE4KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9tdXNpYyA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9tdXNpYy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfbXVzaWMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfbXVzaWM7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLm11c2ljID0gbXVzaWM7XG4gICAgICAgIHZhciBfcGljdHVyZXM7XG4gICAgICAgIGZ1bmN0aW9uIHBpY3R1cmVzKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJwaWN0dXJlc1wiKTtcbiAgICAgICAgICAgIGlmICghX3BpY3R1cmVzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxOSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfcGljdHVyZXMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfcGljdHVyZXMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX3BpY3R1cmVzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX3BpY3R1cmVzO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5waWN0dXJlcyA9IHBpY3R1cmVzO1xuICAgICAgICB2YXIgX3NoYXJlZFB1YmxpYztcbiAgICAgICAgZnVuY3Rpb24gc2hhcmVkUHVibGljKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJzaGFyZWRQdWJsaWNcIik7XG4gICAgICAgICAgICBpZiAoIV9zaGFyZWRQdWJsaWMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDIxKTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9zaGFyZWRQdWJsaWMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfc2hhcmVkUHVibGljLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9zaGFyZWRQdWJsaWMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfc2hhcmVkUHVibGljO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5zaGFyZWRQdWJsaWMgPSBzaGFyZWRQdWJsaWM7XG4gICAgICAgIGZ1bmN0aW9uIGdldEV4aXN0aW5nRm9sZGVySW5mbyhwYXRoRGlyZWN0b3J5KSB7XG4gICAgICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgICAgIHZhciBmb2xkZXJQYXRoID0gZmlsZUFjY2Vzcy5nZXRLbm93blBhdGgocGF0aERpcmVjdG9yeSk7XG4gICAgICAgICAgICB2YXIgZm9sZGVySW5mbyA9IGZpbGVBY2Nlc3MuZ2V0RXhpc3RpbmdGb2xkZXIoZm9sZGVyUGF0aCk7XG4gICAgICAgICAgICBpZiAoZm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGZvbGRlcjogY3JlYXRlRm9sZGVyKGZvbGRlckluZm8pLFxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBmb2xkZXJQYXRoXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9KShpb3MgPSBrbm93bkZvbGRlcnMuaW9zIHx8IChrbm93bkZvbGRlcnMuaW9zID0ge30pKTtcbn0pKGtub3duRm9sZGVycyA9IGV4cG9ydHMua25vd25Gb2xkZXJzIHx8IChleHBvcnRzLmtub3duRm9sZGVycyA9IHt9KSk7XG52YXIgcGF0aDtcbihmdW5jdGlvbiAocGF0aF80KSB7XG4gICAgZnVuY3Rpb24gbm9ybWFsaXplKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGdldEZpbGVBY2Nlc3MoKS5ub3JtYWxpemVQYXRoKHBhdGgpO1xuICAgIH1cbiAgICBwYXRoXzQubm9ybWFsaXplID0gbm9ybWFsaXplO1xuICAgIGZ1bmN0aW9uIGpvaW4oKSB7XG4gICAgICAgIHZhciBwYXRocyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgcGF0aHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgcmV0dXJuIGZpbGVBY2Nlc3Muam9pblBhdGhzKHBhdGhzKTtcbiAgICB9XG4gICAgcGF0aF80LmpvaW4gPSBqb2luO1xuICAgIHBhdGhfNC5zZXBhcmF0b3IgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0UGF0aFNlcGFyYXRvcigpO1xufSkocGF0aCA9IGV4cG9ydHMucGF0aCB8fCAoZXhwb3J0cy5wYXRoID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpbGUtc3lzdGVtLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi90cy1oZWxwZXJzXCIpO1xucmVxdWlyZShcIi4uL3JlZ2lzdGVyLW1vZHVsZS1oZWxwZXJzXCIpO1xuZ2xvYmFsLm1vZHVsZU1lcmdlID0gZnVuY3Rpb24gKHNvdXJjZUV4cG9ydHMsIGRlc3RFeHBvcnRzKSB7XG4gICAgZm9yICh2YXIga2V5IGluIHNvdXJjZUV4cG9ydHMpIHtcbiAgICAgICAgZGVzdEV4cG9ydHNba2V5XSA9IHNvdXJjZUV4cG9ydHNba2V5XTtcbiAgICB9XG59O1xuZ2xvYmFsLnpvbmVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICBpZiAoZ2xvYmFsLnpvbmUpIHtcbiAgICAgICAgcmV0dXJuIGdsb2JhbC56b25lLmJpbmQoY2FsbGJhY2spO1xuICAgIH1cbiAgICBpZiAoZ2xvYmFsLlpvbmUpIHtcbiAgICAgICAgcmV0dXJuIGdsb2JhbC5ab25lLmN1cnJlbnQud3JhcChjYWxsYmFjayk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2s7XG4gICAgfVxufTtcbmdsb2JhbC5TeXN0ZW0gPSB7XG4gICAgaW1wb3J0OiBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGdsb2JhbC5yZXF1aXJlKHBhdGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2xvYmFscy1jb3JlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIERlcHJlY2F0ZWQodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBpZiAoZGVzY3JpcHRvcikge1xuICAgICAgICB2YXIgb3JpZ2luYWxNZXRob2RfMSA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICAgIGRlc2NyaXB0b3IudmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhrZXkudG9TdHJpbmcoKSArIFwiIGlzIGRlcHJlY2F0ZWRcIik7XG4gICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxNZXRob2RfMS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygodGFyZ2V0ICYmIHRhcmdldC5uYW1lIHx8IHRhcmdldCkgKyBcIiBpcyBkZXByZWNhdGVkXCIpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbn1cbmV4cG9ydHMuRGVwcmVjYXRlZCA9IERlcHJlY2F0ZWQ7XG5nbG9iYWwuRGVwcmVjYXRlZCA9IERlcHJlY2F0ZWQ7XG5mdW5jdGlvbiBFeHBlcmltZW50YWwodGFyZ2V0LCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBpZiAoZGVzY3JpcHRvcikge1xuICAgICAgICB2YXIgb3JpZ2luYWxNZXRob2RfMiA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICAgIGRlc2NyaXB0b3IudmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhrZXkudG9TdHJpbmcoKSArIFwiIGlzIGV4cGVyaW1lbnRhbFwiKTtcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZF8yLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCh0YXJnZXQgJiYgdGFyZ2V0Lm5hbWUgfHwgdGFyZ2V0KSArIFwiIGlzIGV4cGVyaW1lbnRhbFwiKTtcbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG59XG5leHBvcnRzLkV4cGVyaW1lbnRhbCA9IEV4cGVyaW1lbnRhbDtcbmdsb2JhbC5FeHBlcmltZW50YWwgPSBFeHBlcmltZW50YWw7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWNvcmF0b3JzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuL2NvcmVcIik7XG5yZXF1aXJlKFwiLi9wb2x5ZmlsbHMvdGltZXJzXCIpO1xucmVxdWlyZShcIi4vcG9seWZpbGxzL2RpYWxvZ3NcIik7XG5yZXF1aXJlKFwiLi9wb2x5ZmlsbHMveGhyXCIpO1xucmVxdWlyZShcIi4vcG9seWZpbGxzL2ZldGNoXCIpO1xucmVxdWlyZShcIi4vZGVjb3JhdG9yc1wiKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdsb2JhbHMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcIi4uLy4uL2NvcmVcIik7XG52YXIgcG9seWZpbGxfaGVscGVyc18xID0gcmVxdWlyZShcIi4uL3BvbHlmaWxsLWhlbHBlcnNcIik7XG5nbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ0bnMtY29yZS1tb2R1bGVzL3VpL2RpYWxvZ3NcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uLy4uLy4uL3VpL2RpYWxvZ3NcIik7IH0pO1xucG9seWZpbGxfaGVscGVyc18xLmluc3RhbGxQb2x5ZmlsbHMoXCJ0bnMtY29yZS1tb2R1bGVzL3VpL2RpYWxvZ3NcIiwgW1wiYWxlcnRcIiwgXCJjb25maXJtXCIsIFwicHJvbXB0XCIsIFwibG9naW5cIiwgXCJhY3Rpb25cIl0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGlhbG9ncy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi4vLi4vY29yZVwiKTtcbnJlcXVpcmUoXCIuLi8uLi9wb2x5ZmlsbHMveGhyXCIpO1xudmFyIHBvbHlmaWxsX2hlbHBlcnNfMSA9IHJlcXVpcmUoXCIuLi9wb2x5ZmlsbC1oZWxwZXJzXCIpO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwiZmV0Y2hcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uLy4uLy4uL2ZldGNoXCIpOyB9KTtcbnBvbHlmaWxsX2hlbHBlcnNfMS5pbnN0YWxsUG9seWZpbGxzKFwiZmV0Y2hcIiwgW1wiZmV0Y2hcIiwgXCJIZWFkZXJzXCIsIFwiUmVxdWVzdFwiLCBcIlJlc3BvbnNlXCJdKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZldGNoLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi8uLi9jb3JlXCIpO1xuZnVuY3Rpb24gcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQobW9kdWxlTmFtZSwgZXhwb3J0TmFtZSkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsIGV4cG9ydE5hbWUsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbSA9IGdsb2JhbC5sb2FkTW9kdWxlKG1vZHVsZU5hbWUpO1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkVmFsdWUgPSBtW2V4cG9ydE5hbWVdO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgZXhwb3J0TmFtZSwgeyB2YWx1ZTogcmVzb2x2ZWRWYWx1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXNvbHZlZFZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGluc3RhbGxQb2x5ZmlsbHMobW9kdWxlTmFtZSwgZXhwb3J0TmFtZXMpIHtcbiAgICBpZiAoZ2xvYmFsLl9fc25hcHNob3QpIHtcbiAgICAgICAgdmFyIGxvYWRlZE1vZHVsZV8xID0gZ2xvYmFsLmxvYWRNb2R1bGUobW9kdWxlTmFtZSk7XG4gICAgICAgIGV4cG9ydE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKGV4cG9ydE5hbWUpIHsgcmV0dXJuIGdsb2JhbFtleHBvcnROYW1lXSA9IGxvYWRlZE1vZHVsZV8xW2V4cG9ydE5hbWVdOyB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV4cG9ydE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKGV4cG9ydE5hbWUpIHsgcmV0dXJuIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KG1vZHVsZU5hbWUsIGV4cG9ydE5hbWUpOyB9KTtcbiAgICB9XG59XG5leHBvcnRzLmluc3RhbGxQb2x5ZmlsbHMgPSBpbnN0YWxsUG9seWZpbGxzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cG9seWZpbGwtaGVscGVycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi4vLi4vY29yZVwiKTtcbnZhciBwb2x5ZmlsbF9oZWxwZXJzXzEgPSByZXF1aXJlKFwiLi4vcG9seWZpbGwtaGVscGVyc1wiKTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInRpbWVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi8uLi8uLi90aW1lclwiKTsgfSk7XG5wb2x5ZmlsbF9oZWxwZXJzXzEuaW5zdGFsbFBvbHlmaWxscyhcInRpbWVyXCIsIFtcInNldFRpbWVvdXRcIiwgXCJjbGVhclRpbWVvdXRcIiwgXCJzZXRJbnRlcnZhbFwiLCBcImNsZWFySW50ZXJ2YWxcIl0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGltZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnJlcXVpcmUoXCIuLi8uLi9jb3JlXCIpO1xudmFyIHBvbHlmaWxsX2hlbHBlcnNfMSA9IHJlcXVpcmUoXCIuLi9wb2x5ZmlsbC1oZWxwZXJzXCIpO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwieGhyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi8uLi8uLi94aHJcIik7IH0pO1xucG9seWZpbGxfaGVscGVyc18xLmluc3RhbGxQb2x5ZmlsbHMoXCJ4aHJcIiwgW1wiWE1MSHR0cFJlcXVlc3RcIiwgXCJGb3JtRGF0YVwiXSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD14aHIuanMubWFwIiwidmFyIG1vZHVsZXMgPSBuZXcgTWFwKCk7XG52YXIgbW9kdWxlc0xvYWRlZEZvclVJID0gbmV3IFNldCgpO1xudmFyIGRlZmF1bHRFeHRlbnNpb25NYXAgPSB7XG4gICAgXCIuanNcIjogXCIuanNcIixcbiAgICBcIi50c1wiOiBcIi5qc1wiLFxuICAgIFwiLmNzc1wiOiBcIi5jc3NcIixcbiAgICBcIi5zY3NzXCI6IFwiLmNzc1wiLFxuICAgIFwiLmxlc3NcIjogXCIuY3NzXCIsXG4gICAgXCIuc2Fzc1wiOiBcIi5jc3NcIixcbiAgICBcIi54bWxcIjogXCIueG1sXCJcbn07XG5nbG9iYWwubW9kdWxlUmVzb2x2ZXJzID0gW2dsb2JhbC5yZXF1aXJlXTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uIChuYW1lLCBsb2FkZXIpIHtcbiAgICBtb2R1bGVzLnNldChuYW1lLCB7IGxvYWRlcjogbG9hZGVyLCBtb2R1bGVJZDogbmFtZSB9KTtcbn07XG5nbG9iYWwuX3VucmVnaXN0ZXJNb2R1bGUgPSBmdW5jdGlvbiBfdW5yZWdpc3Rlck1vZHVsZShuYW1lKSB7XG4gICAgbW9kdWxlcy5kZWxldGUobmFtZSk7XG59O1xuZ2xvYmFsLl9pc01vZHVsZUxvYWRlZEZvclVJID0gZnVuY3Rpb24gX2lzTW9kdWxlTG9hZGVkRm9yVUkobW9kdWxlTmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzTG9hZGVkRm9yVUkuaGFzKG1vZHVsZU5hbWUpO1xufTtcbmdsb2JhbC5yZWdpc3RlcldlYnBhY2tNb2R1bGVzID0gZnVuY3Rpb24gcmVnaXN0ZXJXZWJwYWNrTW9kdWxlcyhjb250ZXh0LCBleHRlbnNpb25NYXApIHtcbiAgICBpZiAoZXh0ZW5zaW9uTWFwID09PSB2b2lkIDApIHsgZXh0ZW5zaW9uTWFwID0ge307IH1cbiAgICBjb250ZXh0LmtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGVJZCkge1xuICAgICAgICB2YXIgZXh0RG90SW5kZXggPSBtb2R1bGVJZC5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgIHZhciBiYXNlID0gbW9kdWxlSWQuc3Vic3RyKDAsIGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIG9yaWdpbmFsRXh0ID0gbW9kdWxlSWQuc3Vic3RyKGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIHJlZ2lzdGVyRXh0ID0gZXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBkZWZhdWx0RXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBvcmlnaW5hbEV4dDtcbiAgICAgICAgdmFyIGlzU291cmNlRmlsZSA9IG9yaWdpbmFsRXh0ICE9PSByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyTmFtZSA9IGJhc2UgKyByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyV2l0aE5hbWUgPSBmdW5jdGlvbiAobmlja05hbWUpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5pY2tOYW1lLCB7XG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dChtb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpICYmIHJlZ2lzdGVyTmFtZS5lbmRzV2l0aChcIi5qc1wiKSkge1xuICAgICAgICAgICAgdmFyIGpzTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDUpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMCwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDMpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAganNOaWNrTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoanNOaWNrTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1NvdXJjZUZpbGUgfHwgIWdsb2JhbC5tb2R1bGVFeGlzdHMoanNOaWNrTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJXaXRoTmFtZShqc05pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpKSB7XG4gICAgICAgICAgICB2YXIgbW9kdWxlTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgbW9kdWxlTmlja05hbWVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZU5pY2tOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFnbG9iYWwubW9kdWxlRXhpc3RzKG1vZHVsZU5pY2tOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZWdpc3RlcldpdGhOYW1lKG1vZHVsZU5pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNTb3VyY2VGaWxlIHx8ICFnbG9iYWwubW9kdWxlRXhpc3RzKHJlZ2lzdGVyTmFtZSkpIHtcbiAgICAgICAgICAgIHJlZ2lzdGVyV2l0aE5hbWUocmVnaXN0ZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmdsb2JhbC5tb2R1bGVFeGlzdHMgPSBmdW5jdGlvbiBtb2R1bGVFeGlzdHMobmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzLmhhcyhuYW1lKTtcbn07XG5nbG9iYWwubG9hZE1vZHVsZSA9IGZ1bmN0aW9uIGxvYWRNb2R1bGUobmFtZSwgaXNVSU1vZHVsZSkge1xuICAgIGlmIChpc1VJTW9kdWxlID09PSB2b2lkIDApIHsgaXNVSU1vZHVsZSA9IGZhbHNlOyB9XG4gICAgdmFyIG1vZHVsZUluZm8gPSBtb2R1bGVzLmdldChuYW1lKTtcbiAgICBpZiAobW9kdWxlSW5mbykge1xuICAgICAgICBpZiAoaXNVSU1vZHVsZSkge1xuICAgICAgICAgICAgbW9kdWxlc0xvYWRlZEZvclVJLmFkZChtb2R1bGVJbmZvLm1vZHVsZUlkKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gbW9kdWxlSW5mby5sb2FkZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQuZW5hYmxlQXV0b0FjY2VwdCkge1xuICAgICAgICAgICAgcmVzdWx0LmVuYWJsZUF1dG9BY2NlcHQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChyZXNvbHZlcikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVzb2x2ZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5hbWUsIHsgbW9kdWxlSWQ6IG5hbWUsIGxvYWRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZ2xvYmFsLm1vZHVsZVJlc29sdmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHJlc29sdmVyID0gX2FbX2ldO1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocmVzb2x2ZXIpO1xuICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcbiAgICB9XG59O1xuZ2xvYmFsLmdldFJlZ2lzdGVyZWRNb2R1bGVzID0gZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZE1vZHVsZXMoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20obW9kdWxlcy5rZXlzKCkpO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlZ2lzdGVyLW1vZHVsZS1oZWxwZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmlmICghZ2xvYmFsLl9fZXh0ZW5kcykge1xuICAgIGdsb2JhbC5fX2V4dGVuZHMgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBmb3IgKHZhciBwIGluIGIpIHtcbiAgICAgICAgICAgIGlmIChiLmhhc093blByb3BlcnR5KHApKSB7XG4gICAgICAgICAgICAgICAgZFtwXSA9IGJbcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufVxudmFyIHRzbGliID0gcmVxdWlyZShcInRzbGliXCIpO1xuZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKHRzbGliKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICB2YXIgZm5OYW1lID0gX2FbX2ldO1xuICAgIGlmICh0eXBlb2YgdHNsaWJbZm5OYW1lXSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZm5OYW1lIGluIGdsb2JhbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZ2xvYmFsW2ZuTmFtZV0gPSB0c2xpYltmbk5hbWVdO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHMtaGVscGVycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBnZXRGaWxlbmFtZUZyb21VcmwodXJsKSB7XG4gICAgdmFyIGZzID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuICAgIHZhciBzbGFzaFBvcyA9IHVybC5sYXN0SW5kZXhPZihcIi9cIikgKyAxO1xuICAgIHZhciBxdWVzdGlvbk1hcmtQb3MgPSB1cmwubGFzdEluZGV4T2YoXCI/XCIpO1xuICAgIHZhciBhY3R1YWxGaWxlTmFtZTtcbiAgICBpZiAocXVlc3Rpb25NYXJrUG9zICE9PSAtMSkge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MsIHF1ZXN0aW9uTWFya1Bvcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5kb2N1bWVudHMoKS5wYXRoLCBhY3R1YWxGaWxlTmFtZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0RmlsZW5hbWVGcm9tVXJsID0gZ2V0RmlsZW5hbWVGcm9tVXJsO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0LWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaHR0cF9yZXF1ZXN0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0LWNvbW1vblwiKTtcbnZhciBkZWJ1Z2dlcl8xID0gcmVxdWlyZShcIi4uLy4uL2RlYnVnZ2VyL2RlYnVnZ2VyXCIpO1xudmFyIEh0dHBSZXNwb25zZUVuY29kaW5nO1xuKGZ1bmN0aW9uIChIdHRwUmVzcG9uc2VFbmNvZGluZykge1xuICAgIEh0dHBSZXNwb25zZUVuY29kaW5nW0h0dHBSZXNwb25zZUVuY29kaW5nW1wiVVRGOFwiXSA9IDBdID0gXCJVVEY4XCI7XG4gICAgSHR0cFJlc3BvbnNlRW5jb2RpbmdbSHR0cFJlc3BvbnNlRW5jb2RpbmdbXCJHQktcIl0gPSAxXSA9IFwiR0JLXCI7XG59KShIdHRwUmVzcG9uc2VFbmNvZGluZyA9IGV4cG9ydHMuSHR0cFJlc3BvbnNlRW5jb2RpbmcgfHwgKGV4cG9ydHMuSHR0cFJlc3BvbnNlRW5jb2RpbmcgPSB7fSkpO1xuZnVuY3Rpb24gcGFyc2VKU09OKHNvdXJjZSkge1xuICAgIHZhciBzcmMgPSBzb3VyY2UudHJpbSgpO1xuICAgIGlmIChzcmMubGFzdEluZGV4T2YoXCIpXCIpID09PSBzcmMubGVuZ3RoIC0gMSkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShzcmMuc3Vic3RyaW5nKHNyYy5pbmRleE9mKFwiKFwiKSArIDEsIHNyYy5sYXN0SW5kZXhPZihcIilcIikpKTtcbiAgICB9XG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3JjKTtcbn1cbnZhciByZXF1ZXN0SWRDb3VudGVyID0gMDtcbnZhciBwZW5kaW5nUmVxdWVzdHMgPSB7fTtcbnZhciBpbWFnZVNvdXJjZTtcbmZ1bmN0aW9uIGVuc3VyZUltYWdlU291cmNlKCkge1xuICAgIGlmICghaW1hZ2VTb3VyY2UpIHtcbiAgICAgICAgaW1hZ2VTb3VyY2UgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2Utc291cmNlXCIpO1xuICAgIH1cbn1cbnZhciBwbGF0Zm9ybTtcbmZ1bmN0aW9uIGVuc3VyZVBsYXRmb3JtKCkge1xuICAgIGlmICghcGxhdGZvcm0pIHtcbiAgICAgICAgcGxhdGZvcm0gPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG4gICAgfVxufVxudmFyIGZzO1xuZnVuY3Rpb24gZW5zdXJlRmlsZVN5c3RlbSgpIHtcbiAgICBpZiAoIWZzKSB7XG4gICAgICAgIGZzID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuICAgIH1cbn1cbnZhciBjb21wbGV0ZUNhbGxiYWNrO1xuZnVuY3Rpb24gZW5zdXJlQ29tcGxldGVDYWxsYmFjaygpIHtcbiAgICBpZiAoY29tcGxldGVDYWxsYmFjaykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbXBsZXRlQ2FsbGJhY2sgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkFzeW5jLkNvbXBsZXRlQ2FsbGJhY2soe1xuICAgICAgICBvbkNvbXBsZXRlOiBmdW5jdGlvbiAocmVzdWx0LCBjb250ZXh0KSB7XG4gICAgICAgICAgICBvblJlcXVlc3RDb21wbGV0ZShjb250ZXh0LCByZXN1bHQpO1xuICAgICAgICB9LFxuICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIG9uUmVxdWVzdEVycm9yKGVycm9yLCBjb250ZXh0KTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIG9uUmVxdWVzdENvbXBsZXRlKHJlcXVlc3RJZCwgcmVzdWx0KSB7XG4gICAgdmFyIGNhbGxiYWNrcyA9IHBlbmRpbmdSZXF1ZXN0c1tyZXF1ZXN0SWRdO1xuICAgIGRlbGV0ZSBwZW5kaW5nUmVxdWVzdHNbcmVxdWVzdElkXTtcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAgIGNhbGxiYWNrcy5yZWplY3RDYWxsYmFjayhuZXcgRXJyb3IocmVzdWx0LmVycm9yLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaGVhZGVycyA9IHt9O1xuICAgIGlmIChyZXN1bHQuaGVhZGVycykge1xuICAgICAgICB2YXIgakhlYWRlcnMgPSByZXN1bHQuaGVhZGVycztcbiAgICAgICAgdmFyIGxlbmd0aF8xID0gakhlYWRlcnMuc2l6ZSgpO1xuICAgICAgICB2YXIgcGFpciA9IHZvaWQgMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICBwYWlyID0gakhlYWRlcnMuZ2V0KGkpO1xuICAgICAgICAgICAgYWRkSGVhZGVyKGhlYWRlcnMsIHBhaXIua2V5LCBwYWlyLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZ2xvYmFsLl9faW5zcGVjdG9yICYmIGdsb2JhbC5fX2luc3BlY3Rvci5pc0Nvbm5lY3RlZCkge1xuICAgICAgICBkZWJ1Z2dlcl8xLk5ldHdvcmtBZ2VudC5yZXNwb25zZVJlY2VpdmVkKHJlcXVlc3RJZCwgcmVzdWx0LCBoZWFkZXJzKTtcbiAgICB9XG4gICAgY2FsbGJhY2tzLnJlc29sdmVDYWxsYmFjayh7XG4gICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIHJhdzogcmVzdWx0LnJhdyxcbiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoZW5jb2RpbmcpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RyO1xuICAgICAgICAgICAgICAgIGlmIChlbmNvZGluZykge1xuICAgICAgICAgICAgICAgICAgICBzdHIgPSBkZWNvZGVSZXNwb25zZShyZXN1bHQucmF3LCBlbmNvZGluZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdHIgPSByZXN1bHQucmVzcG9uc2VBc1N0cmluZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzdHIgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlc3BvbnNlIGNvbnRlbnQgbWF5IG5vdCBiZSBjb252ZXJ0ZWQgdG8gc3RyaW5nXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b0pTT046IGZ1bmN0aW9uIChlbmNvZGluZykge1xuICAgICAgICAgICAgICAgIHZhciBzdHI7XG4gICAgICAgICAgICAgICAgaWYgKGVuY29kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IGRlY29kZVJlc3BvbnNlKHJlc3VsdC5yYXcsIGVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciA9IHJlc3VsdC5yZXNwb25zZUFzU3RyaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VKU09OKHN0cik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9JbWFnZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGVuc3VyZUltYWdlU291cmNlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlSW1hZ2UsIHJlamVjdEltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucmVzcG9uc2VBc0ltYWdlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVJbWFnZShpbWFnZVNvdXJjZS5mcm9tTmF0aXZlU291cmNlKHJlc3VsdC5yZXNwb25zZUFzSW1hZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdEltYWdlKG5ldyBFcnJvcihcIlJlc3BvbnNlIGNvbnRlbnQgbWF5IG5vdCBiZSBjb252ZXJ0ZWQgdG8gYW4gSW1hZ2VcIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9GaWxlOiBmdW5jdGlvbiAoZGVzdGluYXRpb25GaWxlUGF0aCkge1xuICAgICAgICAgICAgICAgIGVuc3VyZUZpbGVTeXN0ZW0oKTtcbiAgICAgICAgICAgICAgICBpZiAoIWRlc3RpbmF0aW9uRmlsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25GaWxlUGF0aCA9IGh0dHBfcmVxdWVzdF9jb21tb25fMS5nZXRGaWxlbmFtZUZyb21VcmwoY2FsbGJhY2tzLnVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzdHJlYW07XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBmcy5GaWxlLmZyb21QYXRoKGRlc3RpbmF0aW9uRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgamF2YUZpbGUgPSBuZXcgamF2YS5pby5GaWxlKGRlc3RpbmF0aW9uRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBzdHJlYW0gPSBuZXcgamF2YS5pby5GaWxlT3V0cHV0U3RyZWFtKGphdmFGaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtLndyaXRlKHJlc3VsdC5yYXcudG9CeXRlQXJyYXkoKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXhjZXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBzYXZlIGZpbGUgd2l0aCBwYXRoOiBcIiArIGRlc3RpbmF0aW9uRmlsZVBhdGggKyBcIi5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyZWFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzdWx0LnN0YXR1c0NvZGUsXG4gICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIG9uUmVxdWVzdEVycm9yKGVycm9yLCByZXF1ZXN0SWQpIHtcbiAgICB2YXIgY2FsbGJhY2tzID0gcGVuZGluZ1JlcXVlc3RzW3JlcXVlc3RJZF07XG4gICAgZGVsZXRlIHBlbmRpbmdSZXF1ZXN0c1tyZXF1ZXN0SWRdO1xuICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgY2FsbGJhY2tzLnJlamVjdENhbGxiYWNrKG5ldyBFcnJvcihlcnJvcikpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGJ1aWxkSmF2YU9wdGlvbnMob3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy51cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSHR0cCByZXF1ZXN0IG11c3QgcHJvdmlkZSBhIHZhbGlkIHVybC5cIik7XG4gICAgfVxuICAgIHZhciBqYXZhT3B0aW9ucyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQXN5bmMuSHR0cC5SZXF1ZXN0T3B0aW9ucygpO1xuICAgIGphdmFPcHRpb25zLnVybCA9IG9wdGlvbnMudXJsO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5tZXRob2QgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgamF2YU9wdGlvbnMubWV0aG9kID0gb3B0aW9ucy5tZXRob2Q7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5jb250ZW50ID09PSBcInN0cmluZ1wiIHx8IG9wdGlvbnMuY29udGVudCBpbnN0YW5jZW9mIEZvcm1EYXRhKSB7XG4gICAgICAgIGphdmFPcHRpb25zLmNvbnRlbnQgPSBvcHRpb25zLmNvbnRlbnQudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnRpbWVvdXQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgamF2YU9wdGlvbnMudGltZW91dCA9IG9wdGlvbnMudGltZW91dDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmRvbnRGb2xsb3dSZWRpcmVjdHMgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgIGphdmFPcHRpb25zLmRvbnRGb2xsb3dSZWRpcmVjdHMgPSBvcHRpb25zLmRvbnRGb2xsb3dSZWRpcmVjdHM7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgdmFyIGFycmF5TGlzdCA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0KCk7XG4gICAgICAgIHZhciBwYWlyID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkFzeW5jLkh0dHAuS2V5VmFsdWVQYWlyO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICAgICAgICBhcnJheUxpc3QuYWRkKG5ldyBwYWlyKGtleSwgb3B0aW9ucy5oZWFkZXJzW2tleV0gKyBcIlwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgamF2YU9wdGlvbnMuaGVhZGVycyA9IGFycmF5TGlzdDtcbiAgICB9XG4gICAgZW5zdXJlUGxhdGZvcm0oKTtcbiAgICB2YXIgc2NyZWVuID0gcGxhdGZvcm0uc2NyZWVuLm1haW5TY3JlZW47XG4gICAgamF2YU9wdGlvbnMuc2NyZWVuV2lkdGggPSBzY3JlZW4ud2lkdGhQaXhlbHM7XG4gICAgamF2YU9wdGlvbnMuc2NyZWVuSGVpZ2h0ID0gc2NyZWVuLmhlaWdodFBpeGVscztcbiAgICByZXR1cm4gamF2YU9wdGlvbnM7XG59XG5mdW5jdGlvbiByZXF1ZXN0KG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkIHx8IG9wdGlvbnMgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGphdmFPcHRpb25zID0gYnVpbGRKYXZhT3B0aW9ucyhvcHRpb25zKTtcbiAgICAgICAgICAgIGlmIChnbG9iYWwuX19pbnNwZWN0b3IgJiYgZ2xvYmFsLl9faW5zcGVjdG9yLmlzQ29ubmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgZGVidWdnZXJfMS5OZXR3b3JrQWdlbnQucmVxdWVzdFdpbGxCZVNlbnQocmVxdWVzdElkQ291bnRlciwgb3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tzID0ge1xuICAgICAgICAgICAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxiYWNrOiByZXNvbHZlLFxuICAgICAgICAgICAgICAgIHJlamVjdENhbGxiYWNrOiByZWplY3RcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBwZW5kaW5nUmVxdWVzdHNbcmVxdWVzdElkQ291bnRlcl0gPSBjYWxsYmFja3M7XG4gICAgICAgICAgICBlbnN1cmVDb21wbGV0ZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQXN5bmMuSHR0cC5NYWtlUmVxdWVzdChqYXZhT3B0aW9ucywgY29tcGxldGVDYWxsYmFjaywgbmV3IGphdmEubGFuZy5JbnRlZ2VyKHJlcXVlc3RJZENvdW50ZXIpKTtcbiAgICAgICAgICAgIHJlcXVlc3RJZENvdW50ZXIrKztcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMucmVxdWVzdCA9IHJlcXVlc3Q7XG5mdW5jdGlvbiBkZWNvZGVSZXNwb25zZShyYXcsIGVuY29kaW5nKSB7XG4gICAgdmFyIGNoYXJzZXROYW1lID0gXCJVVEYtOFwiO1xuICAgIGlmIChlbmNvZGluZyA9PT0gSHR0cFJlc3BvbnNlRW5jb2RpbmcuR0JLKSB7XG4gICAgICAgIGNoYXJzZXROYW1lID0gXCJHQktcIjtcbiAgICB9XG4gICAgcmV0dXJuIHJhdy50b1N0cmluZyhjaGFyc2V0TmFtZSk7XG59XG5mdW5jdGlvbiBhZGRIZWFkZXIoaGVhZGVycywga2V5LCB2YWx1ZSkge1xuICAgIGlmICghaGVhZGVyc1trZXldKSB7XG4gICAgICAgIGhlYWRlcnNba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGhlYWRlcnNba2V5XSkpIHtcbiAgICAgICAgaGVhZGVyc1trZXldLnB1c2godmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IFtoZWFkZXJzW2tleV1dO1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgIGhlYWRlcnNba2V5XSA9IHZhbHVlcztcbiAgICB9XG59XG5leHBvcnRzLmFkZEhlYWRlciA9IGFkZEhlYWRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAtcmVxdWVzdC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaHR0cFJlcXVlc3QgPSByZXF1aXJlKFwiLi9odHRwLXJlcXVlc3RcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9odHRwLXJlcXVlc3RcIikpO1xuZnVuY3Rpb24gZ2V0U3RyaW5nKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGh0dHBSZXF1ZXN0LnJlcXVlc3QodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIiA/IHsgdXJsOiBhcmcsIG1ldGhvZDogXCJHRVRcIiB9IDogYXJnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IHIuY29udGVudC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gcmVqZWN0KGUpOyB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZ2V0U3RyaW5nID0gZ2V0U3RyaW5nO1xuZnVuY3Rpb24gZ2V0SlNPTihhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBqc29uID0gci5jb250ZW50LnRvSlNPTigpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoanNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHJlamVjdChlKTsgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldEpTT04gPSBnZXRKU09OO1xuZnVuY3Rpb24gZ2V0SW1hZ2UoYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaHR0cFJlcXVlc3QucmVxdWVzdCh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8geyB1cmw6IGFyZywgbWV0aG9kOiBcIkdFVFwiIH0gOiBhcmcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHIuY29udGVudC50b0ltYWdlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldEltYWdlID0gZ2V0SW1hZ2U7XG5mdW5jdGlvbiBnZXRGaWxlKGFyZywgZGVzdGluYXRpb25GaWxlUGF0aCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGh0dHBSZXF1ZXN0LnJlcXVlc3QodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIiA/IHsgdXJsOiBhcmcsIG1ldGhvZDogXCJHRVRcIiB9IDogYXJnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGUgPSByLmNvbnRlbnQudG9GaWxlKGRlc3RpbmF0aW9uRmlsZVBhdGgpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHJlamVjdChlKTsgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldEZpbGUgPSBnZXRGaWxlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtXCIpO1xudmFyIEltYWdlQXNzZXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW1hZ2VBc3NldEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW1hZ2VBc3NldEJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9vcHRpb25zID0geyBrZWVwQXNwZWN0UmF0aW86IHRydWUsIGF1dG9TY2FsZUZhY3RvcjogdHJ1ZSB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUFzc2V0QmFzZS5wcm90b3R5cGUsIFwib3B0aW9uc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUFzc2V0QmFzZS5wcm90b3R5cGUsIFwibmF0aXZlSW1hZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYXRpdmVJbWFnZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX25hdGl2ZUltYWdlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEltYWdlQXNzZXRCYXNlLnByb3RvdHlwZS5nZXRJbWFnZUFzeW5jID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgfTtcbiAgICByZXR1cm4gSW1hZ2VBc3NldEJhc2U7XG59KG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLkltYWdlQXNzZXRCYXNlID0gSW1hZ2VBc3NldEJhc2U7XG5mdW5jdGlvbiBnZXRBc3BlY3RTYWZlRGltZW5zaW9ucyhzb3VyY2VXaWR0aCwgc291cmNlSGVpZ2h0LCByZXFXaWR0aCwgcmVxSGVpZ2h0KSB7XG4gICAgdmFyIHdpZHRoQ29lZiA9IHNvdXJjZVdpZHRoIC8gcmVxV2lkdGg7XG4gICAgdmFyIGhlaWdodENvZWYgPSBzb3VyY2VIZWlnaHQgLyByZXFIZWlnaHQ7XG4gICAgdmFyIGFzcGVjdENvZWYgPSBNYXRoLm1pbih3aWR0aENvZWYsIGhlaWdodENvZWYpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiBNYXRoLmZsb29yKHNvdXJjZVdpZHRoIC8gYXNwZWN0Q29lZiksXG4gICAgICAgIGhlaWdodDogTWF0aC5mbG9vcihzb3VyY2VIZWlnaHQgLyBhc3BlY3RDb2VmKVxuICAgIH07XG59XG5leHBvcnRzLmdldEFzcGVjdFNhZmVEaW1lbnNpb25zID0gZ2V0QXNwZWN0U2FmZURpbWVuc2lvbnM7XG5mdW5jdGlvbiBnZXRSZXF1ZXN0ZWRJbWFnZVNpemUoc3JjLCBvcHRpb25zKSB7XG4gICAgdmFyIHNjcmVlbiA9IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW47XG4gICAgdmFyIHJlcVdpZHRoID0gb3B0aW9ucy53aWR0aCB8fCBNYXRoLm1pbihzcmMud2lkdGgsIHNjcmVlbi53aWR0aFBpeGVscyk7XG4gICAgdmFyIHJlcUhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0IHx8IE1hdGgubWluKHNyYy5oZWlnaHQsIHNjcmVlbi5oZWlnaHRQaXhlbHMpO1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMua2VlcEFzcGVjdFJhdGlvKSB7XG4gICAgICAgIHZhciBzYWZlQXNwZWN0U2l6ZSA9IGdldEFzcGVjdFNhZmVEaW1lbnNpb25zKHNyYy53aWR0aCwgc3JjLmhlaWdodCwgcmVxV2lkdGgsIHJlcUhlaWdodCk7XG4gICAgICAgIHJlcVdpZHRoID0gc2FmZUFzcGVjdFNpemUud2lkdGg7XG4gICAgICAgIHJlcUhlaWdodCA9IHNhZmVBc3BlY3RTaXplLmhlaWdodDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHJlcVdpZHRoLFxuICAgICAgICBoZWlnaHQ6IHJlcUhlaWdodFxuICAgIH07XG59XG5leHBvcnRzLmdldFJlcXVlc3RlZEltYWdlU2l6ZSA9IGdldFJlcXVlc3RlZEltYWdlU2l6ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWltYWdlLWFzc2V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGltYWdlX2Fzc2V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaW1hZ2UtYXNzZXQtY29tbW9uXCIpO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW1cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9pbWFnZS1hc3NldC1jb21tb25cIikpO1xudmFyIEltYWdlQXNzZXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZUFzc2V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEltYWdlQXNzZXQoYXNzZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgdmFyIGZpbGVOYW1lID0gdHlwZW9mIGFzc2V0ID09PSBcInN0cmluZ1wiID8gYXNzZXQudHJpbSgpIDogXCJcIjtcbiAgICAgICAgaWYgKGZpbGVOYW1lLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgZmlsZU5hbWUgPSBmaWxlX3N5c3RlbV8xLnBhdGguam9pbihmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgZmlsZU5hbWUucmVwbGFjZShcIn4vXCIsIFwiXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5hbmRyb2lkID0gZmlsZU5hbWU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlQXNzZXQucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBJbWFnZUFzc2V0LnByb3RvdHlwZS5nZXRJbWFnZUFzeW5jID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBiaXRtYXBPcHRpb25zID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeS5PcHRpb25zKCk7XG4gICAgICAgIGJpdG1hcE9wdGlvbnMuaW5KdXN0RGVjb2RlQm91bmRzID0gdHJ1ZTtcbiAgICAgICAgdmFyIGJpdG1hcCA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeS5kZWNvZGVGaWxlKHRoaXMuYW5kcm9pZCwgYml0bWFwT3B0aW9ucyk7XG4gICAgICAgIHZhciBzb3VyY2VTaXplID0ge1xuICAgICAgICAgICAgd2lkdGg6IGJpdG1hcE9wdGlvbnMub3V0V2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGJpdG1hcE9wdGlvbnMub3V0SGVpZ2h0XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXF1ZXN0ZWRTaXplID0gaW1hZ2VfYXNzZXRfY29tbW9uXzEuZ2V0UmVxdWVzdGVkSW1hZ2VTaXplKHNvdXJjZVNpemUsIHRoaXMub3B0aW9ucyk7XG4gICAgICAgIHZhciBzYW1wbGVTaXplID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLmltYWdlLkZldGNoZXIuY2FsY3VsYXRlSW5TYW1wbGVTaXplKGJpdG1hcE9wdGlvbnMub3V0V2lkdGgsIGJpdG1hcE9wdGlvbnMub3V0SGVpZ2h0LCByZXF1ZXN0ZWRTaXplLndpZHRoLCByZXF1ZXN0ZWRTaXplLmhlaWdodCk7XG4gICAgICAgIHZhciBmaW5hbEJpdG1hcE9wdGlvbnMgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5Lk9wdGlvbnMoKTtcbiAgICAgICAgZmluYWxCaXRtYXBPcHRpb25zLmluU2FtcGxlU2l6ZSA9IHNhbXBsZVNpemU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgYml0bWFwID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5LmRlY29kZUZpbGUodGhpcy5hbmRyb2lkLCBmaW5hbEJpdG1hcE9wdGlvbnMpO1xuICAgICAgICAgICAgaWYgKGJpdG1hcCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0ZWRTaXplLndpZHRoICE9PSBiaXRtYXAuZ2V0V2lkdGgoKSB8fCByZXF1ZXN0ZWRTaXplLmhlaWdodCAhPT0gYml0bWFwLmdldEhlaWdodCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGJpdG1hcCA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLmNyZWF0ZVNjYWxlZEJpdG1hcChiaXRtYXAsIHJlcXVlc3RlZFNpemUud2lkdGgsIHJlcXVlc3RlZFNpemUuaGVpZ2h0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0aW9uQW5nbGUgPSBjYWxjdWxhdGVBbmdsZUZyb21GaWxlKHRoaXMuYW5kcm9pZCk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdGF0aW9uQW5nbGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLk1hdHJpeCgpO1xuICAgICAgICAgICAgICAgICAgICBtYXRyaXgucG9zdFJvdGF0ZShyb3RhdGlvbkFuZ2xlKTtcbiAgICAgICAgICAgICAgICAgICAgYml0bWFwID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuY3JlYXRlQml0bWFwKGJpdG1hcCwgMCwgMCwgYml0bWFwLmdldFdpZHRoKCksIGJpdG1hcC5nZXRIZWlnaHQoKSwgbWF0cml4LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWJpdG1hcCkge1xuICAgICAgICAgICAgICAgIGVycm9yID0gXCJBc3NldCAnXCIgKyB0aGlzLmFuZHJvaWQgKyBcIicgY2Fubm90IGJlIGZvdW5kLlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FsbGJhY2soYml0bWFwLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBJbWFnZUFzc2V0O1xufShpbWFnZV9hc3NldF9jb21tb25fMS5JbWFnZUFzc2V0QmFzZSkpO1xuZXhwb3J0cy5JbWFnZUFzc2V0ID0gSW1hZ2VBc3NldDtcbmZ1bmN0aW9uIGNhbGN1bGF0ZUFuZ2xlRnJvbUZpbGUoZmlsZW5hbWUpIHtcbiAgICB2YXIgcm90YXRpb25BbmdsZSA9IDA7XG4gICAgdmFyIGVpID0gbmV3IGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZShmaWxlbmFtZSk7XG4gICAgdmFyIG9yaWVudGF0aW9uID0gZWkuZ2V0QXR0cmlidXRlSW50KGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5UQUdfT1JJRU5UQVRJT04sIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9OT1JNQUwpO1xuICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcbiAgICAgICAgY2FzZSBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fUk9UQVRFXzkwOlxuICAgICAgICAgICAgcm90YXRpb25BbmdsZSA9IDkwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlLk9SSUVOVEFUSU9OX1JPVEFURV8xODA6XG4gICAgICAgICAgICByb3RhdGlvbkFuZ2xlID0gMTgwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgYW5kcm9pZC5tZWRpYS5FeGlmSW50ZXJmYWNlLk9SSUVOVEFUSU9OX1JPVEFURV8yNzA6XG4gICAgICAgICAgICByb3RhdGlvbkFuZ2xlID0gMjcwO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiByb3RhdGlvbkFuZ2xlO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYXNzZXQuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbVwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uL3V0aWxzL3V0aWxzXCIpO1xuZXhwb3J0cy5pc0ZpbGVPclJlc291cmNlUGF0aCA9IHV0aWxzXzEuaXNGaWxlT3JSZXNvdXJjZVBhdGg7XG52YXIgYXBwbGljYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvblwiKTtcbnZhciBodHRwO1xuZnVuY3Rpb24gZW5zdXJlSHR0cCgpIHtcbiAgICBpZiAoIWh0dHApIHtcbiAgICAgICAgaHR0cCA9IHJlcXVpcmUoXCIuLi9odHRwXCIpO1xuICAgIH1cbn1cbnZhciBhcHBsaWNhdGlvbjtcbnZhciByZXNvdXJjZXM7XG5mdW5jdGlvbiBnZXRBcHBsaWNhdGlvbigpIHtcbiAgICBpZiAoIWFwcGxpY2F0aW9uKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uID0gYXBwbGljYXRpb25fMS5nZXROYXRpdmVBcHBsaWNhdGlvbigpO1xuICAgIH1cbiAgICByZXR1cm4gYXBwbGljYXRpb247XG59XG5mdW5jdGlvbiBnZXRSZXNvdXJjZXMoKSB7XG4gICAgaWYgKCFyZXNvdXJjZXMpIHtcbiAgICAgICAgcmVzb3VyY2VzID0gZ2V0QXBwbGljYXRpb24oKS5nZXRSZXNvdXJjZXMoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc291cmNlcztcbn1cbnZhciBJbWFnZVNvdXJjZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSW1hZ2VTb3VyY2UoKSB7XG4gICAgfVxuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tQXNzZXQgPSBmdW5jdGlvbiAoYXNzZXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGFzc2V0LmdldEltYWdlQXN5bmMoZnVuY3Rpb24gKGltYWdlLCBlcnIpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0TmF0aXZlU291cmNlKGltYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUubG9hZEZyb21SZXNvdXJjZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHRoaXMuYW5kcm9pZCA9IG51bGw7XG4gICAgICAgIHZhciByZXMgPSBnZXRSZXNvdXJjZXMoKTtcbiAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgdmFyIGlkZW50aWZpZXIgPSByZXMuZ2V0SWRlbnRpZmllcihuYW1lLCBcImRyYXdhYmxlXCIsIGdldEFwcGxpY2F0aW9uKCkuZ2V0UGFja2FnZU5hbWUoKSk7XG4gICAgICAgICAgICBpZiAoMCA8IGlkZW50aWZpZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYml0bWFwRHJhd2FibGUgPSByZXMuZ2V0RHJhd2FibGUoaWRlbnRpZmllcik7XG4gICAgICAgICAgICAgICAgaWYgKGJpdG1hcERyYXdhYmxlICYmIGJpdG1hcERyYXdhYmxlLmdldEJpdG1hcCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFuZHJvaWQgPSBiaXRtYXBEcmF3YWJsZS5nZXRCaXRtYXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZCAhPSBudWxsO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmZyb21SZXNvdXJjZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZXNvbHZlKF90aGlzLmxvYWRGcm9tUmVzb3VyY2UobmFtZSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5zZXRSb3RhdGlvbkFuZ2xlRnJvbUZpbGUgPSBmdW5jdGlvbiAoZmlsZW5hbWUpIHtcbiAgICAgICAgdGhpcy5yb3RhdGlvbkFuZ2xlID0gMDtcbiAgICAgICAgdmFyIGVpID0gbmV3IGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZShmaWxlbmFtZSk7XG4gICAgICAgIHZhciBvcmllbnRhdGlvbiA9IGVpLmdldEF0dHJpYnV0ZUludChhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuVEFHX09SSUVOVEFUSU9OLCBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fTk9STUFMKTtcbiAgICAgICAgc3dpdGNoIChvcmllbnRhdGlvbikge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fUk9UQVRFXzkwOlxuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb25BbmdsZSA9IDkwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLm1lZGlhLkV4aWZJbnRlcmZhY2UuT1JJRU5UQVRJT05fUk9UQVRFXzE4MDpcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uQW5nbGUgPSAxODA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQubWVkaWEuRXhpZkludGVyZmFjZS5PUklFTlRBVElPTl9ST1RBVEVfMjcwOlxuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb25BbmdsZSA9IDI3MDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tRmlsZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBmaWxlTmFtZSA9IHR5cGVvZiBwYXRoID09PSBcInN0cmluZ1wiID8gcGF0aC50cmltKCkgOiBcIlwiO1xuICAgICAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBmaWxlTmFtZS5yZXBsYWNlKFwifi9cIiwgXCJcIikpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0Um90YXRpb25BbmdsZUZyb21GaWxlKGZpbGVOYW1lKTtcbiAgICAgICAgdGhpcy5hbmRyb2lkID0gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXBGYWN0b3J5LmRlY29kZUZpbGUoZmlsZU5hbWUsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuZnJvbUZpbGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5sb2FkRnJvbUZpbGUocGF0aCkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbURhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcEZhY3RvcnkuZGVjb2RlU3RyZWFtKGRhdGEpO1xuICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuZnJvbURhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5sb2FkRnJvbURhdGEoZGF0YSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbUJhc2U2NCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzb3VyY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBieXRlcyA9IGFuZHJvaWQudXRpbC5CYXNlNjQuZGVjb2RlKHNvdXJjZSwgYW5kcm9pZC51dGlsLkJhc2U2NC5ERUZBVUxUKTtcbiAgICAgICAgICAgIHRoaXMuYW5kcm9pZCA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwRmFjdG9yeS5kZWNvZGVCeXRlQXJyYXkoYnl0ZXMsIDAsIGJ5dGVzLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYW5kcm9pZCAhPSBudWxsO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmZyb21CYXNlNjQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVzb2x2ZShfdGhpcy5sb2FkRnJvbUJhc2U2NChkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tRm9udEljb25Db2RlID0gZnVuY3Rpb24gKHNvdXJjZSwgZm9udCwgY29sb3IpIHtcbiAgICAgICAgdmFyIHBhaW50ID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuUGFpbnQoKTtcbiAgICAgICAgcGFpbnQuc2V0VHlwZWZhY2UoZm9udC5nZXRBbmRyb2lkVHlwZWZhY2UoKSk7XG4gICAgICAgIHBhaW50LnNldEFudGlBbGlhcyh0cnVlKTtcbiAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICBwYWludC5zZXRDb2xvcihjb2xvci5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9udFNpemUgPSB1dGlsc18xLmxheW91dC50b0RldmljZVBpeGVscyhmb250LmZvbnRTaXplKTtcbiAgICAgICAgaWYgKCFmb250U2l6ZSkge1xuICAgICAgICAgICAgZm9udFNpemUgPSBwYWludC5nZXRUZXh0U2l6ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZW5zaXR5ID0gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgdmFyIHNjYWxlZEZvbnRTaXplID0gZm9udFNpemUgKiBkZW5zaXR5O1xuICAgICAgICBwYWludC5zZXRUZXh0U2l6ZShzY2FsZWRGb250U2l6ZSk7XG4gICAgICAgIHZhciB0ZXh0Qm91bmRzID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuUmVjdCgpO1xuICAgICAgICBwYWludC5nZXRUZXh0Qm91bmRzKHNvdXJjZSwgMCwgc291cmNlLmxlbmd0aCwgdGV4dEJvdW5kcyk7XG4gICAgICAgIHZhciB0ZXh0V2lkdGggPSB0ZXh0Qm91bmRzLndpZHRoKCk7XG4gICAgICAgIHZhciB0ZXh0SGVpZ2h0ID0gdGV4dEJvdW5kcy5oZWlnaHQoKTtcbiAgICAgICAgaWYgKHRleHRXaWR0aCA+IDAgJiYgdGV4dEhlaWdodCA+IDApIHtcbiAgICAgICAgICAgIHZhciBiaXRtYXAgPSBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcFxuICAgICAgICAgICAgICAgIC5jcmVhdGVCaXRtYXAodGV4dFdpZHRoLCB0ZXh0SGVpZ2h0LCBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcC5Db25maWcuQVJHQl84ODg4KTtcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5DYW52YXMoYml0bWFwKTtcbiAgICAgICAgICAgIGNhbnZhcy5kcmF3VGV4dChzb3VyY2UsIC10ZXh0Qm91bmRzLmxlZnQsIC10ZXh0Qm91bmRzLnRvcCwgcGFpbnQpO1xuICAgICAgICAgICAgdGhpcy5hbmRyb2lkID0gYml0bWFwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5zZXROYXRpdmVTb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIGlmIChzb3VyY2UgJiYgIShzb3VyY2UgaW5zdGFuY2VvZiBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBtZXRob2Qgc2V0TmF0aXZlU291cmNlKCkgZXhwZWN0cyBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcCBpbnN0YW5jZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbmRyb2lkID0gc291cmNlO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLnNhdmVUb0ZpbGUgPSBmdW5jdGlvbiAocGF0aCwgZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgICAgIGlmIChxdWFsaXR5ID09PSB2b2lkIDApIHsgcXVhbGl0eSA9IDEwMDsgfVxuICAgICAgICBpZiAoIXRoaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0YXJnZXRGb3JtYXQgPSBnZXRUYXJnZXRGb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgdmFyIG91dHB1dFN0cmVhbSA9IG5ldyBqYXZhLmlvLkJ1ZmZlcmVkT3V0cHV0U3RyZWFtKG5ldyBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW0ocGF0aCkpO1xuICAgICAgICB2YXIgcmVzID0gdGhpcy5hbmRyb2lkLmNvbXByZXNzKHRhcmdldEZvcm1hdCwgcXVhbGl0eSwgb3V0cHV0U3RyZWFtKTtcbiAgICAgICAgb3V0cHV0U3RyZWFtLmNsb3NlKCk7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUudG9CYXNlNjRTdHJpbmcgPSBmdW5jdGlvbiAoZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgICAgIGlmIChxdWFsaXR5ID09PSB2b2lkIDApIHsgcXVhbGl0eSA9IDEwMDsgfVxuICAgICAgICBpZiAoIXRoaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhcmdldEZvcm1hdCA9IGdldFRhcmdldEZvcm1hdChmb3JtYXQpO1xuICAgICAgICB2YXIgb3V0cHV0U3RyZWFtID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7XG4gICAgICAgIHZhciBiYXNlNjRTdHJlYW0gPSBuZXcgYW5kcm9pZC51dGlsLkJhc2U2NE91dHB1dFN0cmVhbShvdXRwdXRTdHJlYW0sIGFuZHJvaWQudXRpbC5CYXNlNjQuTk9fV1JBUCk7XG4gICAgICAgIHRoaXMuYW5kcm9pZC5jb21wcmVzcyh0YXJnZXRGb3JtYXQsIHF1YWxpdHksIGJhc2U2NFN0cmVhbSk7XG4gICAgICAgIGJhc2U2NFN0cmVhbS5jbG9zZSgpO1xuICAgICAgICBvdXRwdXRTdHJlYW0uY2xvc2UoKTtcbiAgICAgICAgcmV0dXJuIG91dHB1dFN0cmVhbS50b1N0cmluZygpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFuZHJvaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hbmRyb2lkLmdldEhlaWdodCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQuZ2V0V2lkdGgoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBOYU47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZVNvdXJjZS5wcm90b3R5cGUsIFwicm90YXRpb25BbmdsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JvdGF0aW9uQW5nbGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9yb3RhdGlvbkFuZ2xlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBJbWFnZVNvdXJjZTtcbn0oKSk7XG5leHBvcnRzLkltYWdlU291cmNlID0gSW1hZ2VTb3VyY2U7XG5mdW5jdGlvbiBnZXRUYXJnZXRGb3JtYXQoZm9ybWF0KSB7XG4gICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgICAgY2FzZSBcImpwZWdcIjpcbiAgICAgICAgY2FzZSBcImpwZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLkNvbXByZXNzRm9ybWF0LkpQRUc7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuQ29tcHJlc3NGb3JtYXQuUE5HO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGZyb21Bc3NldChhc3NldCkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5mcm9tQXNzZXQoYXNzZXQpO1xufVxuZXhwb3J0cy5mcm9tQXNzZXQgPSBmcm9tQXNzZXQ7XG5mdW5jdGlvbiBmcm9tUmVzb3VyY2UobmFtZSkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbVJlc291cmNlKG5hbWUpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tUmVzb3VyY2UgPSBmcm9tUmVzb3VyY2U7XG5mdW5jdGlvbiBmcm9tRmlsZShwYXRoKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRmlsZShwYXRoKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUZpbGUgPSBmcm9tRmlsZTtcbmZ1bmN0aW9uIGZyb21EYXRhKGRhdGEpIHtcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICByZXR1cm4gaW1hZ2UubG9hZEZyb21EYXRhKGRhdGEpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tRGF0YSA9IGZyb21EYXRhO1xuZnVuY3Rpb24gZnJvbUZvbnRJY29uQ29kZShzb3VyY2UsIGZvbnQsIGNvbG9yKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRm9udEljb25Db2RlKHNvdXJjZSwgZm9udCwgY29sb3IpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tRm9udEljb25Db2RlID0gZnJvbUZvbnRJY29uQ29kZTtcbmZ1bmN0aW9uIGZyb21CYXNlNjQoc291cmNlKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tQmFzZTY0KHNvdXJjZSkgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21CYXNlNjQgPSBmcm9tQmFzZTY0O1xuZnVuY3Rpb24gZnJvbU5hdGl2ZVNvdXJjZShzb3VyY2UpIHtcbiAgICB2YXIgaW1hZ2VTb3VyY2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICBpbWFnZVNvdXJjZS5zZXROYXRpdmVTb3VyY2Uoc291cmNlKTtcbiAgICByZXR1cm4gaW1hZ2VTb3VyY2U7XG59XG5leHBvcnRzLmZyb21OYXRpdmVTb3VyY2UgPSBmcm9tTmF0aXZlU291cmNlO1xuZnVuY3Rpb24gZnJvbVVybCh1cmwpIHtcbiAgICBlbnN1cmVIdHRwKCk7XG4gICAgcmV0dXJuIGh0dHAuZ2V0SW1hZ2UodXJsKTtcbn1cbmV4cG9ydHMuZnJvbVVybCA9IGZyb21Vcmw7XG5mdW5jdGlvbiBmcm9tRmlsZU9yUmVzb3VyY2UocGF0aCkge1xuICAgIGlmICghdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aChwYXRoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocGF0aCArIFwiIGlzIG5vdCBhIHZhbGlkIGZpbGUgb3IgcmVzb3VyY2UuXCIpO1xuICAgIH1cbiAgICBpZiAocGF0aC5pbmRleE9mKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZnJvbVJlc291cmNlKHBhdGguc3Vic3RyKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYLmxlbmd0aCkpO1xuICAgIH1cbiAgICByZXR1cm4gZnJvbUZpbGUocGF0aCk7XG59XG5leHBvcnRzLmZyb21GaWxlT3JSZXNvdXJjZSA9IGZyb21GaWxlT3JSZXNvdXJjZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWltYWdlLXNvdXJjZS5hbmRyb2lkLmpzLm1hcCIsIu+7v1x0Lypcblx0bmV3IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBwYXJzZXIgPSBuZXcgRWFzeVNBWFBhcnNlcigpO1xuXG5cdFx0cGFyc2VyLm5zKCdyc3MnLCB7IC8vIG9yIGZhbHNlXG5cdFx0XHRyc3M6ICdodHRwOi8vcHVybC5vcmcvcnNzLzEuMC8nLFxuXHRcdFx0YXRvbTogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDUvQXRvbScsXG5cdFx0XHR4aHRtbDogJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwnLFxuXHRcdFx0bWVkaWE6ICdodHRwOi8vc2VhcmNoLnlhaG9vLmNvbS9tcnNzLydcblx0XHR9KTtcblxuXG5cdFx0cGFyc2VyLm9uKCdlcnJvcicsIGZ1bmN0aW9uKG1zZykge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhtc2cpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ3N0YXJ0Tm9kZScsIGZ1bmN0aW9uKGVsZW0sIGF0dHIsIHVxLCB0YWdlbmQsIGdldFN0ck5vZGUpIHtcblx0XHRcdGF0dHIoKTtcblx0XHRcdHJldHVybjtcblx0XHRcdGlmICh0YWdlbmQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJyAgICcrc3RyKVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJysgICcrc3RyKVxuXHRcdFx0fTtcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbignZW5kTm9kZScsIGZ1bmN0aW9uKGVsZW0sIHVxLCB0YWdzdGFydCwgc3RyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0XHRpZiAoIXRhZ3N0YXJ0KSBjb25zb2xlLmxvZygnLSAgJyArIHN0cilcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbigndGV4dE5vZGUnLCBmdW5jdGlvbihzLCB1cSkge1xuXHRcdFx0dXEocyk7XG5cdFx0XHRyZXR1cm5cblx0XHRcdGNvbnNvbGUubG9nKCcgICAnK3MpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ2NkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuXHRcdH0pO1xuXG5cblx0XHRwYXJzZXIub24oJ2NvbW1lbnQnLCBmdW5jdGlvbih0ZXh0KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCctLScrdGV4dCsnLS0nKVxuXHRcdH0pO1xuXG5cdFx0Ly9wYXJzZXIub24oJ3F1ZXN0aW9uJywgZnVuY3Rpb24oKSB7fSk7IC8vIDw/IC4uLiA/PlxuXHRcdC8vcGFyc2VyLm9uKCdhdHRlbnRpb24nLCBmdW5jdGlvbigpIHt9KTsgLy8gPCFYWFhYWCB6enp6PVwiZWVlZVwiPlxuXG5cdFx0Y29uc29sZS50aW1lKCdlYXN5c2F4Jyk7XG5cdFx0Zm9yKHZhciB6PTEwMDA7ei0tOykge1xuXHRcdFx0cGFyc2VyLnBhcnNlKHhtbClcblx0XHR9O1xuXHRcdGNvbnNvbGUudGltZUVuZCgnZWFzeXNheCcpO1xuXHR9O1xuXG5cblx0Ki9cblxuLy8gPDwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tID4+IC8vXG5cblxuaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAvKiYmIHRoaXMgPT0gZXhwb3J0cyovKSB7XG5cdG1vZHVsZS5leHBvcnRzLkVhc3lTQVhQYXJzZXIgPSBFYXN5U0FYUGFyc2VyO1xufTtcblxuZnVuY3Rpb24gRWFzeVNBWFBhcnNlcigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGlmICghdGhpcykgcmV0dXJuIG51bGw7XG5cbiAgICB0aGlzLmFuZ3VsYXJTeW50YXggPSBmYWxzZTtcblxuXHRmdW5jdGlvbiBudWxsRnVuYygpIHt9O1xuXG5cdHRoaXMub25UZXh0Tm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25TdGFydE5vZGUgPSBudWxsRnVuYztcbiAgICB0aGlzLm9uRW5kTm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25DREFUQSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25FcnJvciA9IG51bGxGdW5jO1xuICAgIHRoaXMub25Db21tZW50ID0gbnVsbDtcbiAgICB0aGlzLm9uUXVlc3Rpb24gPSBudWxsO1xuICAgIHRoaXMub25BdHRlbnRpb24gPSBudWxsO1xuXHR0aGlzLmlzX29uQ29tbWVudCA9IHRoaXMuaXNfb25RdWVzdGlvbiA9IHRoaXMuaXNfb25BdHRlbnRpb24gPSBmYWxzZTtcblxuXHR0aGlzLmlzTmFtZXNwYWNlID0gZmFsc2U7XG4gICAgdGhpcy51c2VOUyA9IG51bGw7XG4gICAgdGhpcy5kZWZhdWx0X3htbG5zID0gbnVsbDtcbiAgICB0aGlzLnhtbG5zID0gbnVsbDtcblx0dGhpcy5uc21hdHJpeCA9IHt4bWxuczogdGhpcy54bWxuc307XG5cdHRoaXMuaGFzU3VybWlzZU5TID0gZmFsc2U7XG5cdDtcblxuXG5cdHRoaXMuYXR0cl9zdHJpbmcgPSAnJzsgLy8g0YHRgtGA0L7QutCwINCw0YLRgNC40LHRg9GC0L7QslxuXHR0aGlzLmF0dHJfcG9zc3RhcnQgPSAwOyAvL1xuXHR0aGlzLmF0dHJfcmVzOyAvLyDQt9Cw0LrQtdGI0LjRgNC+0LLQsNC90L3Ri9C5INGA0LXQt9GD0LvRjNGC0LDRgiDRgNCw0LfQsdC+0YDQsCDQsNGC0YDQuNCx0YPRgtC+0LIgLCBudWxsIC0g0YDQsNC30LHQvtGAINC90LUg0L/RgNC+0LLQvtC00LjQu9GB0Y8sIG9iamVjdCAtINGF0LXRiCDQsNGC0YDQuNCx0YPRgtC+0LIsIHRydWUgLSDQvdC10YIg0LDRgtGA0LjQsdGD0YLQvtCyLCBmYWxzZSAtINC90LXQstCw0LvQuNC00L3Ri9C5IHhtbFxufVxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKG5hbWUsIGNiKSB7XG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoY2IgIT09IG51bGwpIHJldHVybjtcbiAgICB9O1xuXG4gICAgc3dpdGNoKG5hbWUpIHtcbiAgICAgICAgY2FzZSAnZXJyb3InOiB0aGlzLm9uRXJyb3IgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3N0YXJ0Tm9kZSc6IHRoaXMub25TdGFydE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2VuZE5vZGUnOiB0aGlzLm9uRW5kTm9kZSA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAndGV4dE5vZGUnOiB0aGlzLm9uVGV4dE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NkYXRhJzogdGhpcy5vbkNEQVRBID0gY2IgfHwgbnVsbEZ1bmM7IGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2NvbW1lbnQnOiB0aGlzLm9uQ29tbWVudCA9IGNiOyB0aGlzLmlzX29uQ29tbWVudCA9ICEhY2I7IGJyZWFrO1xuICAgICAgICBjYXNlICdxdWVzdGlvbic6IHRoaXMub25RdWVzdGlvbiA9IGNiOyB0aGlzLmlzX29uUXVlc3Rpb24gPSAhIWNiOyBicmVhazsgLy8gPD8gLi4uLiAgPz5cbiAgICAgICAgY2FzZSAnYXR0ZW50aW9uJzogdGhpcy5vbkF0dGVudGlvbiA9IGNiOyB0aGlzLmlzX29uQXR0ZW50aW9uID0gISFjYjsgYnJlYWs7IC8vIDwhWFhYWFggenp6ej1cImVlZWVcIj5cbiAgICB9O1xufTtcblxuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUubnMgPSBmdW5jdGlvbihyb290LCBucykge1xuICAgIGlmICghcm9vdCB8fCB0eXBlb2Ygcm9vdCAhPT0gJ3N0cmluZycgfHwgIW5zKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgdmFyIHUsIHggPSB7fSwgb2ssIHYsIGk7XG5cbiAgICBmb3IoaSBpbiBucykge1xuICAgICAgICB2ID0gbnNbaV07XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmIChyb290ID09PSB2KSBvayA9IHRydWU7XG4gICAgICAgICAgICB4W2ldID0gdjtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgaWYgKG9rKSB7XG4gICAgICAgIHRoaXMuaXNOYW1lc3BhY2UgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlZmF1bHRfeG1sbnMgPSByb290O1xuICAgICAgICB0aGlzLnVzZU5TID0geDtcbiAgICB9O1xufTtcblxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHhtbCkge1xuICAgIGlmICh0eXBlb2YgeG1sICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgIHRoaXMubnNtYXRyaXggPSB7eG1sbnM6IHRoaXMuZGVmYXVsdF94bWxuc307XG5cbiAgICAgICAgcGFyc2UoeG1sKTtcblxuICAgICAgICB0aGlzLm5zbWF0cml4ID0gZmFsc2U7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXJzZSh4bWwpO1xuICAgIH07XG5cbiAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbnZhciB4aGFyc1F1b3Q9e2NvbnN0cnVjdG9yOiBmYWxzZSwgaGFzT3duUHJvcGVydHk6IGZhbHNlLCBpc1Byb3RvdHlwZU9mOiBmYWxzZSwgcHJvcGVydHlJc0VudW1lcmFibGU6IGZhbHNlLCB0b0xvY2FsZVN0cmluZzogZmFsc2UsIHRvU3RyaW5nOiBmYWxzZSwgdmFsdWVPZjogZmFsc2VcbiAgICAsIHF1b3Q6ICdcIidcbiAgICAsIFFVT1Q6ICdcIidcbiAgICAsIGFtcDogJyYnXG4gICAgLCBBTVA6ICcmJ1xuICAgICwgbmJzcDogJ1xcdTAwQTAnXG4gICAgLCBhcG9zOiAnXFwnJ1xuICAgICwgbHQ6ICc8J1xuICAgICwgTFQ6ICc8J1xuICAgICwgZ3Q6ICc+J1xuICAgICwgR1Q6ICc+J1xuICAgICwgY29weTogJ1xcdTAwQTknXG4gICAgLCBsYXF1bzogJ1xcdTAwQUInXG4gICAgLCByYXF1bzogJ1xcdTAwQkInXG4gICAgLCByZWc6ICdcXHUwMEFFJ1xuICAgICwgZGVnOiAnXFx1MDBCMCdcbiAgICAsIHBsdXNtbjogJ1xcdTAwQjEnXG4gICAgLCBzdXAyOiAnXFx1MDBCMidcbiAgICAsIHN1cDM6ICdcXHUwMEIzJ1xuICAgICwgbWljcm86ICdcXHUwMEI1J1xuICAgICwgcGFyYTogJ1xcdTAwQjYnXG59O1xuXG5cbmZ1bmN0aW9uIHJwRW50aXRpZXMocywgZCwgeCwgeikge1xuICAgIGlmICh6KSB7XG4gICAgICAgIHJldHVybiB4aGFyc1F1b3Rbel0gfHwgJ1xceDAxJztcbiAgICB9O1xuXG4gICAgaWYgKGQpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KGQpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU3RyaW5nLmZyb21Db2RlUG9pbnQocGFyc2VJbnQoeCwgMTYpKTtcbn07XG5cbmZ1bmN0aW9uIHVuRW50aXRpZXMocywgaSkge1xuICAgIHMgPSBTdHJpbmcocyk7XG4gICAgaWYgKHMubGVuZ3RoID4gMyAmJiBzLmluZGV4T2YoJyYnKSAhPT0gLTEpIHtcbiAgICAgICAgaWYgKHMuaW5kZXhPZignJmd0OycpICE9PSAtMSkgcyA9IHMucmVwbGFjZSgvJmd0Oy9nLCAnPicpO1xuICAgICAgICBpZiAocy5pbmRleE9mKCcmbHQ7JykgIT09IC0xKSBzID0gcy5yZXBsYWNlKC8mbHQ7L2csICc8Jyk7XG4gICAgICAgIGlmIChzLmluZGV4T2YoJyZxdW90OycpICE9PSAtMSkgcyA9IHMucmVwbGFjZSgvJnF1b3Q7L2csICdcIicpO1xuXG4gICAgICAgIGlmIChzLmluZGV4T2YoJyYnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UoLyYjKFxcZCspO3wmI3goWzAxMjM0NTY3ODlhYmNkZWZdKyk7fCYoXFx3Kyk7L2lnLCBycEVudGl0aWVzKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHM7XG59O1xuXG5cbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnMgPSBmdW5jdGlvbih3KSB7XG4gICAgaWYgKCF0aGlzLmFuZ3VsYXJTeW50YXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB3ID09PSA0MCB8fCAvLyAoXG4gICAgICAgICAgICB3ID09PSA0MSB8fCAvLyApXG4gICAgICAgICAgICB3ID09PSA5MSB8fCAvLyBbXG4gICAgICAgICAgICB3ID09PSA5MyB8fCAvLyBdXG4gICAgICAgICAgICB3ID09PSA5NCB8fCAvLyBeXG4gICAgICAgICAgICB3ID09PSAzNSAgICAvLyAjXG4gICAgICAgICk7XG4gICAgfVxufTtcblxuXHQvKlxuXHRcdNC/0LDRgNGB0LjRgiDQsNGC0YDQuNCx0YPRgtGLINC/0L4g0YLRgNC10LHQvtCy0LDQvdC40Y4uINCS0LDQttC90L4hIC0g0YTRg9C90LrRhtC40Y8g0L3QtSDQs9C10L3QtdGA0LjRgNGD0LXRgiDQuNGB0LrQu9GO0YfQtdC90LjRjy5cblxuXHRcdNC10YHQu9C4INCx0YvQu9CwINC+0YjQuNCx0LrQsCDRgNCw0LfQsdC+0YDQsCDQstC+0LfQstGA0LDRiNCw0LXRgtGB0Y8gZmFsc2Vcblx0XHTQtdGB0LvQuCDQsNGC0YDQuNCx0YPRgtC+0LIg0L3QtdGCINC4INGA0LDQt9Cx0L7RgCDRg9C00LDRh9C10L0g0YLQviDQstC+0LfQstGA0LDRiNCw0LXRgtGB0Y8gdHJ1ZVxuXHRcdNC10YHQu9C4INC10YHRgtGMINCw0YLRgNC40LHRg9GC0Ysg0YLQviDQstC+0LfQstGA0LDRiNCw0LXRgtGB0Y8g0L7QsdGM0LXQutGCKNGF0LXRiClcblx0Ki9cblxuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUuZ2V0QXR0cnMgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5hdHRyX3JlcyAhPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcztcbiAgICB9O1xuXG4gICAgLypcbiAgICBpZiAoeHh0ZXN0ICE9PSB1ICYmIGF0dHJfc3RyaW5nLmluZGV4T2YoeHh0ZXN0KSA9PT0gLTEpIHtcbiAgICAgICAgLyAqXG4gICAgICAgICAgICAvLyDQtNC70Y8g0YPRgdC60L7RgNC10L3QuNGPXG4gICAgICAgICAgICBpZiAoZ2V0QXR0cnMoJ2h0bWwnKS50eXBlID09ICdodG1sJykge1xuICAgICAgICAgICAgICAgIC4uLlxuICAgICAgICAgICAgfTtcbiAgICAgICAgKiAvXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgKi9cblxuICAgIHZhciB1XG4gICAgLCByZXMgPSB7fVxuICAgICwgcyA9IHRoaXMuYXR0cl9zdHJpbmdcbiAgICAsIGkgPSB0aGlzLmF0dHJfcG9zc3RhcnRcbiAgICAsIGwgPSBzLmxlbmd0aFxuICAgICwgYXR0cl9saXN0ID0gdGhpcy5oYXNTdXJtaXNlTlMgPyBbXSA6IGZhbHNlXG4gICAgLCBuYW1lLCB2YWx1ZSA9ICcnXG4gICAgLCBvayA9IGZhbHNlXG4gICAgLCBub1ZhbHVlQXR0cmlidXRlID0gZmFsc2VcbiAgICAsIGosIHcsIG5uLCBuXG4gICAgLCBoYXNOZXdNYXRyaXhcbiAgICAsIGFsaWFzLCBuZXdhbGlhc1xuICAgIDtcblxuICAgIGFhOlxuICAgIGZvcig7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgdyA9IHMuY2hhckNvZGVBdChpKTtcblxuICAgICAgICBpZiAodz09PTMyIHx8ICh3PDE0ICYmIHcgPiA4KSApIHsgLy8gXFxmXFxuXFxyXFx0XFx2XG4gICAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIENoZWNrIGZvciB2YWxpZCBhdHRyaWJ1dGUgc3RhcnQgY2hhclxuICAgICAgICBpZiAoKHcgPCA2NSAmJiAhdGhpcy5hbGxvd2VkQW5ndWxhckF0dHJpYnV0ZUNoYXJzKHcpKSB8fFxuICAgICAgICAgICAgICAgIHcgPiAxMjIgfHwgKHcgPiA5MCAmJiB3IDwgOTcgJiYgIXRoaXMuYWxsb3dlZEFuZ3VsYXJBdHRyaWJ1dGVDaGFycyh3KSkgKSB7IC8vINC+0LbQuNC00LDQtdC8INGB0LjQvNCy0L7Qu1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICB9O1xuXG4gICAgICAgIGZvcihqID0gaSArIDE7IGogPCBsOyBqKyspIHsgLy8g0L/RgNC+0LLQtdGA0Y/QtdC8INCy0YHQtSDRgdC40LzQstC+0LvRiyDQuNC80LXQvdC4INCw0YLRgNC40LHRg9GC0LBcbiAgICAgICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaik7XG5cbiAgICAgICAgICAgIGlmICh3ID4gOTYgJiYgdyA8IDEyMyB8fCB3ID4gNjQgJiYgdyA8IDkxIHx8IHcgPiA0NyAmJiB3IDwgNTkgfHwgdyA9PT0gNDUgfHwgdyA9PT0gOTUgfHwgdyA9PT0gNDYgLyogaHR0cHM6Ly9naXRodWIuY29tL3RlbGVyaWsveFBsYXRDb3JlL2lzc3Vlcy8xNzkgKi8pIHtcbiAgICAgICAgICAgICAgICBpZiAobm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBqLS07IC8vU3RhcnRlZCBuZXh0IGF0dHJpYnV0ZS4gR2V0IGJhY2sgYW5kIGJyZWFrIG91dCBvZiB0aGUgbG9vcC5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuYWxsb3dlZEFuZ3VsYXJBdHRyaWJ1dGVDaGFycyh3KSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodyA9PT0gMzIgfHwgKHcgPiA4ICYmIHcgPCAxNCkgKSB7ICAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgbm9WYWx1ZUF0dHJpYnV0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHcgPT09IDYxKSB7IC8vIFwiPVwiID09IDYxXG4gICAgICAgICAgICAgICAgbm9WYWx1ZUF0dHJpYnV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvciAyJyk7XG4gICAgICAgICAgICAgICAgaWYgKCFub1ZhbHVlQXR0cmlidXRlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfTtcblxuICAgICAgICBuYW1lID0gcy5zdWJzdHJpbmcoaSwgaikudHJpbSgpO1xuICAgICAgICBvayA9IHRydWU7XG5cbiAgICAgICAgaWYgKG5hbWUgPT09ICd4bWxuczp4bWxucycpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yIDYnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgbmFtZVxuICAgICAgICB9O1xuXG4gICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaisxKTtcblxuICAgICAgICB3aGlsZSAodyA9IHMuY2hhckNvZGVBdChqKzEpKSB7XG4gICAgICAgICAgICBpZiAodz09PTMyIHx8ICh3ID4gOCAmJiB3PDE0KSApIHsgIC8vIFxcZlxcblxcclxcdFxcdiDQv9GA0L7QsdC10LtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFub1ZhbHVlQXR0cmlidXRlKSB7XG4gICAgICAgICAgICBpZiAodyA9PT0gMzQpIHsgIC8vICdcIidcbiAgICAgICAgICAgICAgICBqID0gcy5pbmRleE9mKCdcIicsIGkgPSBqKzIgKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodyA9PT0gMzkpIHtcbiAgICAgICAgICAgICAgICAgICAgaiA9IHMuaW5kZXhPZignXFwnJywgaSA9IGorMiApO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgIC8vIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgNCcpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgIH07XG5cblxuICAgICAgICBpZiAoaisxIDwgbCAmJiAhbm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdyA9IHMuY2hhckNvZGVBdChqKzEpO1xuXG4gICAgICAgICAgICBpZiAodyA+IDMyIHx8IHcgPCA5IHx8ICh3IDwgMzIgJiYgdyA+IDEzKSkge1xuICAgICAgICAgICAgICAgIC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvciA1JylcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIGlmIChub1ZhbHVlQXR0cmlidXRlKSB7XG4gICAgICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSBzLnN1YnN0cmluZyhpLCBqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaSA9IGogKyAxOyAvLyDRgdC70LXQtC4g0YHQtdC80LLQvtC7INGD0LbQtSDQv9GA0L7QstC10YDQtdC9INC/0L7RgtC+0LzRgyDQv9GA0L7QstC10YDRj9GC0Ywg0L3Rg9C20L3QviDRgdC70LXQtNGD0Y7RiNC40LlcbiAgICAgICAgaSA9IGo7IC8vINGB0LvQtdC0LiDRgdC10LzQstC+0Lsg0YPQttC1INC/0YDQvtCy0LXRgNC10L0g0L/QvtGC0L7QvNGDINC/0YDQvtCy0LXRgNGP0YLRjCDQvdGD0LbQvdC+INGB0LvQtdC00YPRjtGI0LjQuVxuXG4gICAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7IC8vXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNTdXJtaXNlTlMpIHtcbiAgICAgICAgICAgICAgICAvLyDQtdGB0YLRjCDQv9C+0LTQvtC30YDQtdC90LjQtSDRh9GC0L4g0LIg0LDRgtGA0LjQsdGD0YLQsNGFINC/0YDQuNGB0YPRgtGB0YLQstGD0LXRgiB4bWxuc1xuXG4gICAgICAgICAgICAgICAgaWYgKG5ld2FsaWFzID0gbmFtZSA9PT0gJ3htbG5zJyA/ICd4bWxucycgOiBuYW1lLmNoYXJDb2RlQXQoMCkgPT09IDEyMCAmJiBuYW1lLnN1YnN0cigwLCA2KSA9PT0gJ3htbG5zOicgJiYgbmFtZS5zdWJzdHIoNikgKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsaWFzID0gdGhpcy51c2VOU1t1bkVudGl0aWVzKHZhbHVlKV07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uc21hdHJpeFtuZXdhbGlhc10gIT09IGFsaWFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXNOZXdNYXRyaXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV3TWF0cml4ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm4gPSB7fTsgZm9yIChuIGluIHRoaXMubnNtYXRyaXgpIG5uW25dID0gdGhpcy5uc21hdHJpeFtuXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IG5uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4W25ld2FsaWFzXSA9IGFsaWFzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5zbWF0cml4W25ld2FsaWFzXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzTmV3TWF0cml4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05ld01hdHJpeCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5uID0ge307IGZvciAobiBpbiB0aGlzLm5zbWF0cml4KSBubltuXSA9IHRoaXMubnNtYXRyaXhbbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBubjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeFtuZXdhbGlhc10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBhdHRyX2xpc3QucHVzaChuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB3ID0gbmFtZS5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSgtLXcpIHtcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5jaGFyQ29kZUF0KHcpID09PSA1OCkgeyAvLyAnOidcbiAgICAgICAgICAgICAgICAgICAgaWYgKHcgPSB0aGlzLm5zbWF0cml4W25hbWUuc3Vic3RyaW5nKDAsIHcpXSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc1t3ICsgbmFtZS5zdWJzdHIodyldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGFhO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vICd4bWw6YmFzZScgPz8/XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgIG5vVmFsdWVBdHRyaWJ1dGUgPSBmYWxzZTtcbiAgICB9O1xuXG5cbiAgICBpZiAoIW9rKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gdHJ1ZTsgIC8vINCw0YLRgNC40LHRg9GC0L7QsiDQvdC10YIsINC+0YjQuNCx0L7QuiDRgtC+0LbQtSDQvdC10YJcbiAgICB9O1xuXG5cbiAgICBpZiAodGhpcy5oYXNTdXJtaXNlTlMpICB7XG4gICAgICAgIGJiOlxuXG4gICAgICAgIGZvciAoaSA9IDAsIGwgPSBhdHRyX2xpc3QubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBuYW1lID0gYXR0cl9saXN0W2krK107XG5cbiAgICAgICAgICAgIHcgPSBuYW1lLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlKC0tdykgeyAvLyBuYW1lLmluZGV4T2YoJzonKVxuICAgICAgICAgICAgICAgIGlmIChuYW1lLmNoYXJDb2RlQXQodykgPT09IDU4KSB7IC8vICc6J1xuICAgICAgICAgICAgICAgICAgICBpZiAodyA9IHRoaXMubnNtYXRyaXhbbmFtZS5zdWJzdHJpbmcoMCwgdyldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNbdyArIG5hbWUuc3Vic3RyKHcpXSA9IGF0dHJfbGlzdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWUgYmI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXNbbmFtZV0gPSBhdHRyX2xpc3RbaV07XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gcmVzO1xufTtcblxuXG4vLyB4bWwgLSBzdHJpbmdcbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24oeG1sKSB7XG4gICAgdmFyIHVcbiAgICAsIHhtbCA9IFN0cmluZyh4bWwpXG4gICAgLCBub2Rlc3RhY2sgPSBbXVxuICAgICwgc3RhY2tuc21hdHJpeCA9IFtdXG4gICAgLy8sIHN0cmluZ19ub2RlXG4gICAgLCBlbGVtXG4gICAgLCB0YWdlbmQgPSBmYWxzZVxuICAgICwgdGFnc3RhcnQgPSBmYWxzZVxuICAgICwgaiA9IDAsIGkgPSAwLCBrID0gMCwgbGVuXG4gICAgLCB4LCB5LCBxLCB3XG4gICAgLCB4bWxuc1xuICAgICwgc3RvcEluZGV4ID0gMFxuICAgICwgc3RvcCAvLyDQuNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8g0L/RgNC4INGA0LDQt9Cx0L7RgNC1IFwibmFtZXNwYWNlXCIgLiDQtdGB0LvQuCDQstGB0YLRgNC10YLQuNC70YHRjyDQvdC10LjQt9Cy0LXRgdGC0L3QvtC1INC/0YDQvtGB0YLRgNCw0L3RgdGC0LLQviDRgtC+INGB0L7QsdGL0YLQuNGPINC90LUg0LPQtdC90LXRgNC40YDRg9GO0YLRgdGPXG4gICAgLCBfbnNtYXRyaXhcbiAgICAsIG9rXG4gICAgLCBwb3MgPSAwLCBsbiA9IDAsIGxuU3RhcnQgPSAtMiwgbG5FbmQgPSAtMVxuICAgIDtcblxuICAgIGxlbiA9IHhtbC5sZW5ndGg7XG4gICAgZnVuY3Rpb24gZ2V0U3RyaW5nTm9kZSgpIHtcbiAgICAgICAgcmV0dXJuIHhtbC5zdWJzdHJpbmcoaSwgaisxKVxuICAgIH07XG4gICAgZnVuY3Rpb24gZmluZExpbmVBbmRDb2x1bW5Gcm9tUG9zKCkge1xuICAgICAgICB3aGlsZSAobG5TdGFydCA8IGxuRW5kICYmIGxuRW5kIDwgcG9zKSB7XG4gICAgICAgICAgICBsblN0YXJ0ID0gbG5FbmQ7XG4gICAgICAgICAgICBsbkVuZCA9IHhtbC5pbmRleE9mKFwiXFxuXCIsIGxuRW5kICsgMSk7XG4gICAgICAgICAgICArK2xuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IGxpbmU6IGxuLCBjb2x1bW46IHBvcyAtIGxuU3RhcnQgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcG9zaXRpb24ocCkge1xuICAgICAgICBwb3MgPSBwO1xuICAgICAgICByZXR1cm4gZmluZExpbmVBbmRDb2x1bW5Gcm9tUG9zO1xuICAgIH1cblxuICAgIHdoaWxlKGogIT09IC0xKSB7XG4gICAgICAgIHN0b3AgPSBzdG9wSW5kZXggPiAwO1xuXG4gICAgICAgIGlmICh4bWwuY2hhckNvZGVBdChqKSA9PT0gNjApIHsgLy8gXCI8XCJcbiAgICAgICAgICAgIGkgPSBqO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaSA9IHhtbC5pbmRleE9mKCc8Jywgaik7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGkgPT09IC0xKSB7IC8vINC60L7QvdC10YYg0YDQsNC30LHQvtGA0LBcblxuICAgICAgICAgICAgaWYgKG5vZGVzdGFjay5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2VuZCBmaWxlJywgcG9zaXRpb24oaikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoaiAhPT0gaSAmJiAhc3RvcCkge1xuICAgICAgICAgICAgb2sgPSB0aGlzLm9uVGV4dE5vZGUoeG1sLnN1YnN0cmluZyhqLCBpKSwgdW5FbnRpdGllcywgcG9zaXRpb24oaikpO1xuICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICB9O1xuXG4gICAgICAgIHcgPSB4bWwuY2hhckNvZGVBdChpKzEpO1xuXG4gICAgICAgIGlmICh3ID09PSAzMykgeyAvLyBcIiFcIlxuICAgICAgICAgICAgdyA9IHhtbC5jaGFyQ29kZUF0KGkrMik7XG4gICAgICAgICAgICBpZiAodyA9PT0gOTEgJiYgeG1sLnN1YnN0cihpKzMsIDYpID09PSAnQ0RBVEFbJykgeyAvLyA5MSA9PSBcIltcIlxuICAgICAgICAgICAgICAgIGogPSB4bWwuaW5kZXhPZignXV0+JywgaSk7XG4gICAgICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignY2RhdGEnLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy94ID0geG1sLnN1YnN0cmluZyhpKzksIGopO1xuICAgICAgICAgICAgICAgIGlmICghc3RvcCkge1xuICAgICAgICAgICAgICAgICAgICBvayA9IHRoaXMub25DREFUQSh4bWwuc3Vic3RyaW5nKGkrOSwgaiksIGZhbHNlLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaiArPSAzO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHcgPT09IDQ1ICYmIHhtbC5jaGFyQ29kZUF0KGkrMykgPT09IDQ1KSB7IC8vIDQ1ID09IFwiLVwiXG4gICAgICAgICAgICAgICAgaiA9IHhtbC5pbmRleE9mKCctLT4nLCBpKTtcbiAgICAgICAgICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdleHBlY3RlZCAtLT4nLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc19vbkNvbW1lbnQgJiYgIXN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uQ29tbWVudCh4bWwuc3Vic3RyaW5nKGkrNCwgaiksIHVuRW50aXRpZXMsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBqICs9IDM7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJz4nLCBpKzEpO1xuICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdleHBlY3RlZCBcIj5cIicsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25BdHRlbnRpb24gJiYgIXN0b3ApIHtcbiAgICAgICAgICAgICAgICBvayA9IHRoaXMub25BdHRlbnRpb24oeG1sLnN1YnN0cmluZyhpLCBqKzEpLCB1bkVudGl0aWVzLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaiArPSAxO1xuICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh3ID09PSA2MykgeyAvLyBcIj9cIlxuICAgICAgICAgICAgICAgIGogPSB4bWwuaW5kZXhPZignPz4nLCBpKTtcbiAgICAgICAgICAgICAgICBpZiAoaiA9PT0gLTEpIHsgLy8gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCcuLi4/PicsIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc19vblF1ZXN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIG9rID0gdGhpcy5vblF1ZXN0aW9uKHhtbC5zdWJzdHJpbmcoaSwgaisyKSwgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMjtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluc2lkZT1mYWxzZTtcbiAgICAgICAgZm9yIChrPWksaj0tMTtrPGxlbjtrKyspIHtcbiAgICAgICAgICAgIHZhciBjID0geG1sLmNoYXJDb2RlQXQoayk7XG4gICAgICAgICAgICBpZiAoIWluc2lkZSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGMgPT09IDM0KSB7IC8vICdcIidcbiAgICAgICAgICAgICAgICAgICAgaW5zaWRlID0gYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYyA9PT0gMzkpIHsgLy8gXCInXCJcbiAgICAgICAgICAgICAgICAgICAgaW5zaWRlID0gYztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYyA9PT0gNjIpIHsgLy8gPFxuICAgICAgICAgICAgICAgICAgICBqID0gazsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gaW5zaWRlKSB7IGluc2lkZSA9IGZhbHNlOyB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaiA9PSAtMSkgeyAvLyBlcnJvclxuICAgICAgICAgICAgdGhpcy5vbkVycm9yKCcuLi4+JywgcG9zaXRpb24oaSArIDEpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTsgLy8g0LDRgtGA0LjQsdGD0YLQvtCyINC90LXRglxuXG4gICAgICAgIC8vaWYgKHhtbC5jaGFyQ29kZUF0KGkrMSkgPT09IDQ3KSB7IC8vIDwvLi4uXG4gICAgICAgIGlmICh3ID09PSA0NykgeyAvLyA8Ly4uLlxuICAgICAgICAgICAgdGFnc3RhcnQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRhZ2VuZCA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vINC/0YDQvtCy0LXRgNGP0LXQvCDRh9GC0L4g0LTQvtC70LbQtdC9INCx0YvRgtGMINC30LDQutGA0YvRgiDRgtC+0YLQttC1INGC0LXQsyDRh9GC0L4g0Lgg0L7RgtC60YDRi9Cy0LDQu9GB0Y9cbiAgICAgICAgICAgIHggPSBlbGVtID0gbm9kZXN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgcSA9IGkgKyAyICsgeC5sZW5ndGg7XG5cbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coKVxuICAgICAgICAgICAgaWYgKHhtbC5zdWJzdHJpbmcoaSsyLCBxKSAhPT0geCkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignY2xvc2UgdGFnbmFtZScsIHBvc2l0aW9uKGkgKyAyKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8g0L/RgNC+0LLQtdGA0LjQvCDRh9GC0L4g0LIg0LfQsNC60YDRi9Cy0LDRjtGI0LXQvCDRgtC10LPQtSDQvdC10YIg0LvQuNGI0L3QtdCz0L5cbiAgICAgICAgICAgIGZvcig7IHEgPCBqOyBxKyspIHtcbiAgICAgICAgICAgICAgICB3ID0geG1sLmNoYXJDb2RlQXQocSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodz09PTMyIHx8ICh3ID4gOCAmJiB3PDE0KSApIHsgIC8vIFxcZlxcblxcclxcdFxcdiDQv9GA0L7QsdC10LtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignY2xvc2UgdGFnJywgcG9zaXRpb24oaSArIDIpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoeG1sLmNoYXJDb2RlQXQoai0xKSA9PT0gIDQ3KSB7IC8vIC4uLi8+XG4gICAgICAgICAgICAgICAgeCA9IGVsZW0gPSB4bWwuc3Vic3RyaW5nKGkrMSwgai0xKTtcblxuICAgICAgICAgICAgICAgIHRhZ3N0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0YWdlbmQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4ID0gZWxlbSA9IHhtbC5zdWJzdHJpbmcoaSsxLCBqKTtcblxuICAgICAgICAgICAgICAgIHRhZ3N0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0YWdlbmQgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICggISh3ID4gOTYgICYmIHcgPCAxMjMgfHwgdyA+IDY0ICYmIHcgPDkxKSApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2ZpcnN0IGNoYXIgbm9kZU5hbWUnLCBwb3NpdGlvbihpICsgMSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvcihxID0gMSwgeSA9IHgubGVuZ3RoOyBxIDwgeTsgcSsrKSB7XG4gICAgICAgICAgICAgICAgdyA9IHguY2hhckNvZGVBdChxKTtcblxuICAgICAgICAgICAgICAgIGlmICh3ID4gOTYgJiYgdyA8IDEyMyB8fCB3ID4gNjQgJiYgdyA8IDkxIHx8IHcgPiA0NyAmJiB3IDwgNTkgfHwgdyA9PT0gNDUgfHwgdyA9PT0gOTUgfHwgdyA9PT0gNDYgLyogaHR0cHM6Ly9naXRodWIuY29tL3RlbGVyaWsveFBsYXRDb3JlL2lzc3Vlcy8xNzkgKi8pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmICh3PT09MzIgfHwgKHc8MTQgJiYgdyA+IDgpKSB7IC8vIFxcZlxcblxcclxcdFxcdiDQv9GA0L7QsdC10LtcbiAgICAgICAgICAgICAgICAgICAgZWxlbSA9IHguc3Vic3RyaW5nKDAsIHEpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0cl9yZXMgPSBudWxsOyAvLyDQstC+0LfQvNC+0LbQvdC+INC10YHRgtGMINCw0YLQuNGA0LjQsdGD0YLRi1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdpbnZhbGlkIG5vZGVOYW1lJywgcG9zaXRpb24oaSArIDEpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoIXRhZ2VuZCkge1xuICAgICAgICAgICAgICAgIG5vZGVzdGFjay5wdXNoKGVsZW0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgICAgICBpZiAoc3RvcCkge1xuICAgICAgICAgICAgICAgIGlmICh0YWdlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWdzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC0tc3RvcEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IHN0YWNrbnNtYXRyaXgucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcEluZGV4ICs9IDE7XG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgaiArPSAxO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgX25zbWF0cml4ID0gdGhpcy5uc21hdHJpeDtcblxuICAgICAgICAgICAgaWYgKCF0YWdlbmQpIHtcbiAgICAgICAgICAgICAgICBzdGFja25zbWF0cml4LnB1c2godGhpcy5uc21hdHJpeCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdHRyX3JlcyAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNTdXJtaXNlTlMgPSB4LmluZGV4T2YoJ3htbG5zJywgcSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfc3RyaW5nID0geDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0cl9wb3NzdGFydCA9IHE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXR0cnMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNTdXJtaXNlTlMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICB3ID0gZWxlbS5pbmRleE9mKCc6Jyk7XG4gICAgICAgICAgICBpZiAodyAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB4bWxucyA9IHRoaXMubnNtYXRyaXhbZWxlbS5zdWJzdHJpbmcoMCwgdyldO1xuICAgICAgICAgICAgICAgIGVsZW0gPSBlbGVtLnN1YnN0cih3KzEpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHhtbG5zID0gdGhpcy5uc21hdHJpeC54bWxucztcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICgheG1sbnMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWdzdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IF9uc21hdHJpeDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBzdGFja25zbWF0cml4LnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3BJbmRleCA9IDE7IC8vINC/0LXRgNCy0YvQuSDRjdC70LXQvNC10L3RgiDQtNC70Y8g0LrQvtGC0L7RgNC+0LPQviDQvdC1INC+0L/RgNC10LTQtdC70LXQvdC+INC/0YDQvtGB0YLRgNCw0L3RgdGC0LLQviDQuNC80LXQvVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaiArPSAxO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZWxlbSA9IHhtbG5zICsgJzonICsgZWxlbTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL3N0cmluZ19ub2RlID0geG1sLnN1YnN0cmluZyhpLCBqKzEpOyAvLyDRgtC10LrRgdGCINC90L7QtNGLINC60LDQuiDQtdGB0YLRjFxuXG4gICAgICAgIGlmICh0YWdzdGFydCkgeyAvLyBpc19vblN0YXJ0Tm9kZVxuICAgICAgICAgICAgdGhpcy5hdHRyX3N0cmluZyA9IHg7XG4gICAgICAgICAgICB0aGlzLmF0dHJfcG9zc3RhcnQgPSBxO1xuXG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICBvayA9IHRoaXMub25TdGFydE5vZGUoZWxlbSwgZnVuY3Rpb24oKSB7IHJldHVybiB0aGF0LmdldEF0dHJzKCkgfSwgdW5FbnRpdGllcywgdGFnZW5kXG4gICAgICAgICAgICAgICAgLCBnZXRTdHJpbmdOb2RlLCBwb3NpdGlvbihpKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuYXR0cl9yZXMgPSB0cnVlO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0YWdlbmQpIHtcbiAgICAgICAgICAgIG9rID0gdGhpcy5vbkVuZE5vZGUoZWxlbSwgdW5FbnRpdGllcywgdGFnc3RhcnRcbiAgICAgICAgICAgICAgICAsIGdldFN0cmluZ05vZGUsIHBvc2l0aW9uKGkpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNOYW1lc3BhY2UpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFnc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IF9uc21hdHJpeDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gc3RhY2tuc21hdHJpeC5wb3AoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcblxuICAgICAgICBqICs9IDE7XG4gICAgfTtcbn07XG4iLCLvu78vKlxuICBDb3B5cmlnaHQgKEMpIDIwMTMgQXJpeWEgSGlkYXlhdCA8YXJpeWEuaGlkYXlhdEBnbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMyBUaGFkZGVlIFR5bCA8dGhhZGRlZS50eWxAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgQXJpeWEgSGlkYXlhdCA8YXJpeWEuaGlkYXlhdEBnbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBNYXRoaWFzIEJ5bmVucyA8bWF0aGlhc0BxaXdpLmJlPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgSm9vc3QtV2ltIEJvZWtlc3RlaWpuIDxqb29zdC13aW1AYm9la2VzdGVpam4ubmw+XG4gIENvcHlyaWdodCAoQykgMjAxMiBLcmlzIEtvd2FsIDxrcmlzLmtvd2FsQGNpeGFyLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIFl1c3VrZSBTdXp1a2kgPHV0YXRhbmUudGVhQGdtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEFycGFkIEJvcnNvcyA8YXJwYWQuYm9yc29zQGdvb2dsZW1haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTEgQXJpeWEgSGlkYXlhdCA8YXJpeWEuaGlkYXlhdEBnbWFpbC5jb20+XG5cbiAgUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuXG4gICAgKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodFxuICAgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLlxuICAgICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGVcbiAgICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG5cbiAgVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUlMgQU5EIENPTlRSSUJVVE9SUyBcIkFTIElTXCJcbiAgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRVxuICBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgPENPUFlSSUdIVCBIT0xERVI+IEJFIExJQUJMRSBGT1IgQU5ZXG4gIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUztcbiAgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EXG4gIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRlxuICBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLlxuKi9cblxuKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgVG9rZW4sXG4gICAgICAgIFRva2VuTmFtZSxcbiAgICAgICAgU3ludGF4LFxuICAgICAgICBNZXNzYWdlcyxcbiAgICAgICAgc291cmNlLFxuICAgICAgICBpbmRleCxcbiAgICAgICAgbGVuZ3RoLFxuICAgICAgICBkZWxlZ2F0ZSxcbiAgICAgICAgbG9va2FoZWFkLFxuICAgICAgICBzdGF0ZTtcblxuICAgIFRva2VuID0ge1xuICAgICAgICBCb29sZWFuTGl0ZXJhbDogMSxcbiAgICAgICAgRU9GOiAyLFxuICAgICAgICBJZGVudGlmaWVyOiAzLFxuICAgICAgICBLZXl3b3JkOiA0LFxuICAgICAgICBOdWxsTGl0ZXJhbDogNSxcbiAgICAgICAgTnVtZXJpY0xpdGVyYWw6IDYsXG4gICAgICAgIFB1bmN0dWF0b3I6IDcsXG4gICAgICAgIFN0cmluZ0xpdGVyYWw6IDhcbiAgICB9O1xuXG4gICAgVG9rZW5OYW1lID0ge307XG4gICAgVG9rZW5OYW1lW1Rva2VuLkJvb2xlYW5MaXRlcmFsXSA9ICdCb29sZWFuJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uRU9GXSA9ICc8ZW5kPic7XG4gICAgVG9rZW5OYW1lW1Rva2VuLklkZW50aWZpZXJdID0gJ0lkZW50aWZpZXInO1xuICAgIFRva2VuTmFtZVtUb2tlbi5LZXl3b3JkXSA9ICdLZXl3b3JkJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uTnVsbExpdGVyYWxdID0gJ051bGwnO1xuICAgIFRva2VuTmFtZVtUb2tlbi5OdW1lcmljTGl0ZXJhbF0gPSAnTnVtZXJpYyc7XG4gICAgVG9rZW5OYW1lW1Rva2VuLlB1bmN0dWF0b3JdID0gJ1B1bmN0dWF0b3InO1xuICAgIFRva2VuTmFtZVtUb2tlbi5TdHJpbmdMaXRlcmFsXSA9ICdTdHJpbmcnO1xuXG4gICAgU3ludGF4ID0ge1xuICAgICAgICBBcnJheUV4cHJlc3Npb246ICdBcnJheUV4cHJlc3Npb24nLFxuICAgICAgICBCaW5hcnlFeHByZXNzaW9uOiAnQmluYXJ5RXhwcmVzc2lvbicsXG4gICAgICAgIENhbGxFeHByZXNzaW9uOiAnQ2FsbEV4cHJlc3Npb24nLFxuICAgICAgICBDb25kaXRpb25hbEV4cHJlc3Npb246ICdDb25kaXRpb25hbEV4cHJlc3Npb24nLFxuICAgICAgICBFbXB0eVN0YXRlbWVudDogJ0VtcHR5U3RhdGVtZW50JyxcbiAgICAgICAgRXhwcmVzc2lvblN0YXRlbWVudDogJ0V4cHJlc3Npb25TdGF0ZW1lbnQnLFxuICAgICAgICBJZGVudGlmaWVyOiAnSWRlbnRpZmllcicsXG4gICAgICAgIExpdGVyYWw6ICdMaXRlcmFsJyxcbiAgICAgICAgTGFiZWxlZFN0YXRlbWVudDogJ0xhYmVsZWRTdGF0ZW1lbnQnLFxuICAgICAgICBMb2dpY2FsRXhwcmVzc2lvbjogJ0xvZ2ljYWxFeHByZXNzaW9uJyxcbiAgICAgICAgTWVtYmVyRXhwcmVzc2lvbjogJ01lbWJlckV4cHJlc3Npb24nLFxuICAgICAgICBPYmplY3RFeHByZXNzaW9uOiAnT2JqZWN0RXhwcmVzc2lvbicsXG4gICAgICAgIFByb2dyYW06ICdQcm9ncmFtJyxcbiAgICAgICAgUHJvcGVydHk6ICdQcm9wZXJ0eScsXG4gICAgICAgIFRoaXNFeHByZXNzaW9uOiAnVGhpc0V4cHJlc3Npb24nLFxuICAgICAgICBVbmFyeUV4cHJlc3Npb246ICdVbmFyeUV4cHJlc3Npb24nXG4gICAgfTtcblxuICAgIC8vIEVycm9yIG1lc3NhZ2VzIHNob3VsZCBiZSBpZGVudGljYWwgdG8gVjguXG4gICAgTWVzc2FnZXMgPSB7XG4gICAgICAgIFVuZXhwZWN0ZWRUb2tlbjogJ1VuZXhwZWN0ZWQgdG9rZW4gJTAnLFxuICAgICAgICBVbmtub3duTGFiZWw6ICdVbmRlZmluZWQgbGFiZWwgXFwnJTBcXCcnLFxuICAgICAgICBSZWRlY2xhcmF0aW9uOiAnJTAgXFwnJTFcXCcgaGFzIGFscmVhZHkgYmVlbiBkZWNsYXJlZCdcbiAgICB9O1xuXG4gICAgLy8gRW5zdXJlIHRoZSBjb25kaXRpb24gaXMgdHJ1ZSwgb3RoZXJ3aXNlIHRocm93IGFuIGVycm9yLlxuICAgIC8vIFRoaXMgaXMgb25seSB0byBoYXZlIGEgYmV0dGVyIGNvbnRyYWN0IHNlbWFudGljLCBpLmUuIGFub3RoZXIgc2FmZXR5IG5ldFxuICAgIC8vIHRvIGNhdGNoIGEgbG9naWMgZXJyb3IuIFRoZSBjb25kaXRpb24gc2hhbGwgYmUgZnVsZmlsbGVkIGluIG5vcm1hbCBjYXNlLlxuICAgIC8vIERvIE5PVCB1c2UgdGhpcyB0byBlbmZvcmNlIGEgY2VydGFpbiBjb25kaXRpb24gb24gYW55IHVzZXIgaW5wdXQuXG5cbiAgICBmdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBtZXNzYWdlKSB7XG4gICAgICAgIGlmICghY29uZGl0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FTU0VSVDogJyArIG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNEZWNpbWFsRGlnaXQoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA+PSA0OCAmJiBjaCA8PSA1Nyk7ICAgLy8gMC4uOVxuICAgIH1cblxuXG4gICAgLy8gNy4yIFdoaXRlIFNwYWNlXG5cbiAgICBmdW5jdGlvbiBpc1doaXRlU3BhY2UoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA9PT0gMzIpIHx8ICAvLyBzcGFjZVxuICAgICAgICAgICAgKGNoID09PSA5KSB8fCAgICAgIC8vIHRhYlxuICAgICAgICAgICAgKGNoID09PSAweEIpIHx8XG4gICAgICAgICAgICAoY2ggPT09IDB4QykgfHxcbiAgICAgICAgICAgIChjaCA9PT0gMHhBMCkgfHxcbiAgICAgICAgICAgIChjaCA+PSAweDE2ODAgJiYgJ1xcdTE2ODBcXHUxODBFXFx1MjAwMFxcdTIwMDFcXHUyMDAyXFx1MjAwM1xcdTIwMDRcXHUyMDA1XFx1MjAwNlxcdTIwMDdcXHUyMDA4XFx1MjAwOVxcdTIwMEFcXHUyMDJGXFx1MjA1RlxcdTMwMDBcXHVGRUZGJy5pbmRleE9mKFN0cmluZy5mcm9tQ2hhckNvZGUoY2gpKSA+IDApO1xuICAgIH1cblxuICAgIC8vIDcuMyBMaW5lIFRlcm1pbmF0b3JzXG5cbiAgICBmdW5jdGlvbiBpc0xpbmVUZXJtaW5hdG9yKGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDEwKSB8fCAoY2ggPT09IDEzKSB8fCAoY2ggPT09IDB4MjAyOCkgfHwgKGNoID09PSAweDIwMjkpO1xuICAgIH1cblxuICAgIC8vIDcuNiBJZGVudGlmaWVyIE5hbWVzIGFuZCBJZGVudGlmaWVyc1xuXG4gICAgZnVuY3Rpb24gaXNJZGVudGlmaWVyU3RhcnQoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA9PT0gMzYpIHx8IChjaCA9PT0gOTUpIHx8ICAvLyAkIChkb2xsYXIpIGFuZCBfICh1bmRlcnNjb3JlKVxuICAgICAgICAgICAgKGNoID49IDY1ICYmIGNoIDw9IDkwKSB8fCAgICAgICAgIC8vIEEuLlpcbiAgICAgICAgICAgIChjaCA+PSA5NyAmJiBjaCA8PSAxMjIpOyAgICAgICAgICAvLyBhLi56XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNJZGVudGlmaWVyUGFydChjaCkge1xuICAgICAgICByZXR1cm4gKGNoID09PSAzNikgfHwgKGNoID09PSA5NSkgfHwgIC8vICQgKGRvbGxhcikgYW5kIF8gKHVuZGVyc2NvcmUpXG4gICAgICAgICAgICAoY2ggPj0gNjUgJiYgY2ggPD0gOTApIHx8ICAgICAgICAgLy8gQS4uWlxuICAgICAgICAgICAgKGNoID49IDk3ICYmIGNoIDw9IDEyMikgfHwgICAgICAgIC8vIGEuLnpcbiAgICAgICAgICAgIChjaCA+PSA0OCAmJiBjaCA8PSA1Nyk7ICAgICAgICAgICAvLyAwLi45XG4gICAgfVxuXG4gICAgLy8gNy42LjEuMSBLZXl3b3Jkc1xuXG4gICAgZnVuY3Rpb24gaXNLZXl3b3JkKGlkKSB7XG4gICAgICAgIHJldHVybiAoaWQgPT09ICd0aGlzJylcbiAgICB9XG5cbiAgICAvLyA3LjQgQ29tbWVudHNcblxuICAgIGZ1bmN0aW9uIHNraXBXaGl0ZXNwYWNlKCkge1xuICAgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGggJiYgaXNXaGl0ZVNwYWNlKHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRJZGVudGlmaWVyKCkge1xuICAgICAgICB2YXIgc3RhcnQsIGNoO1xuXG4gICAgICAgIHN0YXJ0ID0gaW5kZXgrKztcbiAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBjaCA9IHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KTtcbiAgICAgICAgICAgIGlmIChpc0lkZW50aWZpZXJQYXJ0KGNoKSkge1xuICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNvdXJjZS5zbGljZShzdGFydCwgaW5kZXgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjYW5JZGVudGlmaWVyKCkge1xuICAgICAgICB2YXIgc3RhcnQsIGlkLCB0eXBlO1xuXG4gICAgICAgIHN0YXJ0ID0gaW5kZXg7XG5cbiAgICAgICAgaWQgPSBnZXRJZGVudGlmaWVyKCk7XG5cbiAgICAgICAgLy8gVGhlcmUgaXMgbm8ga2V5d29yZCBvciBsaXRlcmFsIHdpdGggb25seSBvbmUgY2hhcmFjdGVyLlxuICAgICAgICAvLyBUaHVzLCBpdCBtdXN0IGJlIGFuIGlkZW50aWZpZXIuXG4gICAgICAgIGlmIChpZC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHR5cGUgPSBUb2tlbi5JZGVudGlmaWVyO1xuICAgICAgICB9IGVsc2UgaWYgKGlzS2V5d29yZChpZCkpIHtcbiAgICAgICAgICAgIHR5cGUgPSBUb2tlbi5LZXl3b3JkO1xuICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAnbnVsbCcpIHtcbiAgICAgICAgICAgIHR5cGUgPSBUb2tlbi5OdWxsTGl0ZXJhbDtcbiAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gJ3RydWUnIHx8IGlkID09PSAnZmFsc2UnKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uQm9vbGVhbkxpdGVyYWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uSWRlbnRpZmllcjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgdmFsdWU6IGlkLFxuICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICAvLyA3LjcgUHVuY3R1YXRvcnNcblxuICAgIGZ1bmN0aW9uIHNjYW5QdW5jdHVhdG9yKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBpbmRleCxcbiAgICAgICAgICAgIGNvZGUgPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCksXG4gICAgICAgICAgICBjb2RlMixcbiAgICAgICAgICAgIGNoMSA9IHNvdXJjZVtpbmRleF0sXG4gICAgICAgICAgICBjaDI7XG5cbiAgICAgICAgc3dpdGNoIChjb2RlKSB7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBtb3N0IGNvbW1vbiBzaW5nbGUtY2hhcmFjdGVyIHB1bmN0dWF0b3JzLlxuICAgICAgICAgICAgY2FzZSA0NjogICAvLyAuIGRvdFxuICAgICAgICAgICAgY2FzZSA0MDogICAvLyAoIG9wZW4gYnJhY2tldFxuICAgICAgICAgICAgY2FzZSA0MTogICAvLyApIGNsb3NlIGJyYWNrZXRcbiAgICAgICAgICAgIGNhc2UgNTk6ICAgLy8gOyBzZW1pY29sb25cbiAgICAgICAgICAgIGNhc2UgNDQ6ICAgLy8gLCBjb21tYVxuICAgICAgICAgICAgY2FzZSAxMjM6ICAvLyB7IG9wZW4gY3VybHkgYnJhY2VcbiAgICAgICAgICAgIGNhc2UgMTI1OiAgLy8gfSBjbG9zZSBjdXJseSBicmFjZVxuICAgICAgICAgICAgY2FzZSA5MTogICAvLyBbXG4gICAgICAgICAgICBjYXNlIDkzOiAgIC8vIF1cbiAgICAgICAgICAgIGNhc2UgNTg6ICAgLy8gOlxuICAgICAgICAgICAgY2FzZSA2MzogICAvLyA/XG4gICAgICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBjb2RlMiA9IHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4ICsgMSk7XG5cbiAgICAgICAgICAgICAgICAvLyAnPScgKGNoYXIgIzYxKSBtYXJrcyBhbiBhc3NpZ25tZW50IG9yIGNvbXBhcmlzb24gb3BlcmF0b3IuXG4gICAgICAgICAgICAgICAgaWYgKGNvZGUyID09PSA2MSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzc6ICAvLyAlXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OiAgLy8gJlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MjogIC8vICo6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQzOiAgLy8gK1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0NTogIC8vIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDc6ICAvLyAvXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDYwOiAgLy8gPFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2MjogIC8vID5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI0OiAvLyB8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggKz0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogU3RyaW5nLmZyb21DaGFyQ29kZShjb2RlKSArIFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZTIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMzOiAvLyAhXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDYxOiAvLyA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggKz0gMjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICE9PSBhbmQgPT09XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSA9PT0gNjEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNvdXJjZS5zbGljZShzdGFydCwgaW5kZXgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBlZWsgbW9yZSBjaGFyYWN0ZXJzLlxuXG4gICAgICAgIGNoMiA9IHNvdXJjZVtpbmRleCArIDFdO1xuXG4gICAgICAgIC8vIE90aGVyIDItY2hhcmFjdGVyIHB1bmN0dWF0b3JzOiAmJiB8fFxuXG4gICAgICAgIGlmIChjaDEgPT09IGNoMiAmJiAoJyZ8Jy5pbmRleE9mKGNoMSkgPj0gMCkpIHtcbiAgICAgICAgICAgIGluZGV4ICs9IDI7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGNoMSArIGNoMixcbiAgICAgICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJzw+PSErLSolJnxeLycuaW5kZXhPZihjaDEpID49IDApIHtcbiAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGNoMSxcbiAgICAgICAgICAgICAgICByYW5nZTogW3N0YXJ0LCBpbmRleF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgfVxuXG4gICAgLy8gNy44LjMgTnVtZXJpYyBMaXRlcmFsc1xuICAgIGZ1bmN0aW9uIHNjYW5OdW1lcmljTGl0ZXJhbCgpIHtcbiAgICAgICAgdmFyIG51bWJlciwgc3RhcnQsIGNoO1xuXG4gICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgYXNzZXJ0KGlzRGVjaW1hbERpZ2l0KGNoLmNoYXJDb2RlQXQoMCkpIHx8IChjaCA9PT0gJy4nKSxcbiAgICAgICAgICAgICdOdW1lcmljIGxpdGVyYWwgbXVzdCBzdGFydCB3aXRoIGEgZGVjaW1hbCBkaWdpdCBvciBhIGRlY2ltYWwgcG9pbnQnKTtcblxuICAgICAgICBzdGFydCA9IGluZGV4O1xuICAgICAgICBudW1iZXIgPSAnJztcbiAgICAgICAgaWYgKGNoICE9PSAnLicpIHtcbiAgICAgICAgICAgIG51bWJlciA9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcblxuICAgICAgICAgICAgLy8gSGV4IG51bWJlciBzdGFydHMgd2l0aCAnMHgnLlxuICAgICAgICAgICAgLy8gT2N0YWwgbnVtYmVyIHN0YXJ0cyB3aXRoICcwJy5cbiAgICAgICAgICAgIGlmIChudW1iZXIgPT09ICcwJykge1xuICAgICAgICAgICAgICAgIC8vIGRlY2ltYWwgbnVtYmVyIHN0YXJ0cyB3aXRoICcwJyBzdWNoIGFzICcwOScgaXMgaWxsZWdhbC5cbiAgICAgICAgICAgICAgICBpZiAoY2ggJiYgaXNEZWNpbWFsRGlnaXQoY2guY2hhckNvZGVBdCgwKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoID09PSAnLicpIHtcbiAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICB3aGlsZSAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2ggPT09ICdlJyB8fCBjaCA9PT0gJ0UnKSB7XG4gICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuXG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgICAgICBpZiAoY2ggPT09ICcrJyB8fCBjaCA9PT0gJy0nKSB7XG4gICAgICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc0lkZW50aWZpZXJTdGFydChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogVG9rZW4uTnVtZXJpY0xpdGVyYWwsXG4gICAgICAgICAgICB2YWx1ZTogcGFyc2VGbG9hdChudW1iZXIpLFxuICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gNy44LjQgU3RyaW5nIExpdGVyYWxzXG5cbiAgICBmdW5jdGlvbiBzY2FuU3RyaW5nTGl0ZXJhbCgpIHtcbiAgICAgICAgdmFyIHN0ciA9ICcnLCBxdW90ZSwgc3RhcnQsIGNoLCBvY3RhbCA9IGZhbHNlO1xuXG4gICAgICAgIHF1b3RlID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgYXNzZXJ0KChxdW90ZSA9PT0gJ1xcJycgfHwgcXVvdGUgPT09ICdcIicpLFxuICAgICAgICAgICAgJ1N0cmluZyBsaXRlcmFsIG11c3Qgc3RhcnRzIHdpdGggYSBxdW90ZScpO1xuXG4gICAgICAgIHN0YXJ0ID0gaW5kZXg7XG4gICAgICAgICsraW5kZXg7XG5cbiAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleCsrXTtcblxuICAgICAgICAgICAgaWYgKGNoID09PSBxdW90ZSkge1xuICAgICAgICAgICAgICAgIHF1b3RlID0gJyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNoID09PSAnXFxcXCcpIHtcbiAgICAgICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgICAgICBpZiAoIWNoIHx8ICFpc0xpbmVUZXJtaW5hdG9yKGNoLmNoYXJDb2RlQXQoMCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFxuJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3InOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFxyJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFx0JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2InOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFxiJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2YnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFxmJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3YnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAnXFx4MEInO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSBjaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaCA9PT0gJ1xccicgJiYgc291cmNlW2luZGV4XSA9PT0gJ1xcbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzTGluZVRlcm1pbmF0b3IoY2guY2hhckNvZGVBdCgwKSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyICs9IGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHF1b3RlICE9PSAnJykge1xuICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFRva2VuLlN0cmluZ0xpdGVyYWwsXG4gICAgICAgICAgICB2YWx1ZTogc3RyLFxuICAgICAgICAgICAgb2N0YWw6IG9jdGFsLFxuICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaXNJZGVudGlmaWVyTmFtZSh0b2tlbikge1xuICAgICAgICByZXR1cm4gdG9rZW4udHlwZSA9PT0gVG9rZW4uSWRlbnRpZmllciB8fFxuICAgICAgICAgICAgdG9rZW4udHlwZSA9PT0gVG9rZW4uS2V5d29yZCB8fFxuICAgICAgICAgICAgdG9rZW4udHlwZSA9PT0gVG9rZW4uQm9vbGVhbkxpdGVyYWwgfHxcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPT09IFRva2VuLk51bGxMaXRlcmFsO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkdmFuY2UoKSB7XG4gICAgICAgIHZhciBjaDtcblxuICAgICAgICBza2lwV2hpdGVzcGFjZSgpO1xuXG4gICAgICAgIGlmIChpbmRleCA+PSBsZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uRU9GLFxuICAgICAgICAgICAgICAgIHJhbmdlOiBbaW5kZXgsIGluZGV4XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNoID0gc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpO1xuXG4gICAgICAgIC8vIFZlcnkgY29tbW9uOiAoIGFuZCApIGFuZCA7XG4gICAgICAgIGlmIChjaCA9PT0gNDAgfHwgY2ggPT09IDQxIHx8IGNoID09PSA1OCkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5QdW5jdHVhdG9yKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdHJpbmcgbGl0ZXJhbCBzdGFydHMgd2l0aCBzaW5nbGUgcXVvdGUgKCMzOSkgb3IgZG91YmxlIHF1b3RlICgjMzQpLlxuICAgICAgICBpZiAoY2ggPT09IDM5IHx8IGNoID09PSAzNCkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5TdHJpbmdMaXRlcmFsKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQoY2gpKSB7XG4gICAgICAgICAgICByZXR1cm4gc2NhbklkZW50aWZpZXIoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERvdCAoLikgY2hhciAjNDYgY2FuIGFsc28gc3RhcnQgYSBmbG9hdGluZy1wb2ludCBudW1iZXIsIGhlbmNlIHRoZSBuZWVkXG4gICAgICAgIC8vIHRvIGNoZWNrIHRoZSBuZXh0IGNoYXJhY3Rlci5cbiAgICAgICAgaWYgKGNoID09PSA0Nikge1xuICAgICAgICAgICAgaWYgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4ICsgMSkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjYW5OdW1lcmljTGl0ZXJhbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNjYW5QdW5jdHVhdG9yKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNEZWNpbWFsRGlnaXQoY2gpKSB7XG4gICAgICAgICAgICByZXR1cm4gc2Nhbk51bWVyaWNMaXRlcmFsKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2NhblB1bmN0dWF0b3IoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsZXgoKSB7XG4gICAgICAgIHZhciB0b2tlbjtcblxuICAgICAgICB0b2tlbiA9IGxvb2thaGVhZDtcbiAgICAgICAgaW5kZXggPSB0b2tlbi5yYW5nZVsxXTtcblxuICAgICAgICBsb29rYWhlYWQgPSBhZHZhbmNlKCk7XG5cbiAgICAgICAgaW5kZXggPSB0b2tlbi5yYW5nZVsxXTtcblxuICAgICAgICByZXR1cm4gdG9rZW47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGVlaygpIHtcbiAgICAgICAgdmFyIHBvcztcblxuICAgICAgICBwb3MgPSBpbmRleDtcbiAgICAgICAgbG9va2FoZWFkID0gYWR2YW5jZSgpO1xuICAgICAgICBpbmRleCA9IHBvcztcbiAgICB9XG5cbiAgICAvLyBUaHJvdyBhbiBleGNlcHRpb25cblxuICAgIGZ1bmN0aW9uIHRocm93RXJyb3IodG9rZW4sIG1lc3NhZ2VGb3JtYXQpIHtcbiAgICAgICAgdmFyIGVycm9yLFxuICAgICAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMiksXG4gICAgICAgICAgICBtc2cgPSBtZXNzYWdlRm9ybWF0LnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgLyUoXFxkKS9nLFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh3aG9sZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGluZGV4IDwgYXJncy5sZW5ndGgsICdNZXNzYWdlIHJlZmVyZW5jZSBtdXN0IGJlIGluIHJhbmdlJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmdzW2luZGV4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKG1zZyk7XG4gICAgICAgIGVycm9yLmluZGV4ID0gaW5kZXg7XG4gICAgICAgIGVycm9yLmRlc2NyaXB0aW9uID0gbXNnO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG5cbiAgICAvLyBUaHJvdyBhbiBleGNlcHRpb24gYmVjYXVzZSBvZiB0aGUgdG9rZW4uXG5cbiAgICBmdW5jdGlvbiB0aHJvd1VuZXhwZWN0ZWQodG9rZW4pIHtcbiAgICAgICAgdGhyb3dFcnJvcih0b2tlbiwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCB0b2tlbi52YWx1ZSk7XG4gICAgfVxuXG4gICAgLy8gRXhwZWN0IHRoZSBuZXh0IHRva2VuIHRvIG1hdGNoIHRoZSBzcGVjaWZpZWQgcHVuY3R1YXRvci5cbiAgICAvLyBJZiBub3QsIGFuIGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93bi5cblxuICAgIGZ1bmN0aW9uIGV4cGVjdCh2YWx1ZSkge1xuICAgICAgICB2YXIgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgaWYgKHRva2VuLnR5cGUgIT09IFRva2VuLlB1bmN0dWF0b3IgfHwgdG9rZW4udmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQodG9rZW4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRydWUgaWYgdGhlIG5leHQgdG9rZW4gbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIHB1bmN0dWF0b3IuXG5cbiAgICBmdW5jdGlvbiBtYXRjaCh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbG9va2FoZWFkLnR5cGUgPT09IFRva2VuLlB1bmN0dWF0b3IgJiYgbG9va2FoZWFkLnZhbHVlID09PSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdHJ1ZSBpZiB0aGUgbmV4dCB0b2tlbiBtYXRjaGVzIHRoZSBzcGVjaWZpZWQga2V5d29yZFxuXG4gICAgZnVuY3Rpb24gbWF0Y2hLZXl3b3JkKGtleXdvcmQpIHtcbiAgICAgICAgcmV0dXJuIGxvb2thaGVhZC50eXBlID09PSBUb2tlbi5LZXl3b3JkICYmIGxvb2thaGVhZC52YWx1ZSA9PT0ga2V5d29yZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25zdW1lU2VtaWNvbG9uKCkge1xuICAgICAgICAvLyBDYXRjaCB0aGUgdmVyeSBjb21tb24gY2FzZSBmaXJzdDogaW1tZWRpYXRlbHkgYSBzZW1pY29sb24gKGNoYXIgIzU5KS5cbiAgICAgICAgaWYgKHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSA9PT0gNTkpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcblxuICAgICAgICBpZiAobWF0Y2goJzsnKSkge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9va2FoZWFkLnR5cGUgIT09IFRva2VuLkVPRiAmJiAhbWF0Y2goJ30nKSkge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGxvb2thaGVhZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAxMS4xLjQgQXJyYXkgSW5pdGlhbGlzZXJcblxuICAgIGZ1bmN0aW9uIHBhcnNlQXJyYXlJbml0aWFsaXNlcigpIHtcbiAgICAgICAgdmFyIGVsZW1lbnRzID0gW107XG5cbiAgICAgICAgZXhwZWN0KCdbJyk7XG5cbiAgICAgICAgd2hpbGUgKCFtYXRjaCgnXScpKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2goJywnKSkge1xuICAgICAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzLnB1c2gobnVsbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzLnB1c2gocGFyc2VFeHByZXNzaW9uKCkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaCgnXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdCgnLCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGV4cGVjdCgnXScpO1xuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVBcnJheUV4cHJlc3Npb24oZWxlbWVudHMpO1xuICAgIH1cblxuICAgIC8vIDExLjEuNSBPYmplY3QgSW5pdGlhbGlzZXJcblxuICAgIGZ1bmN0aW9uIHBhcnNlT2JqZWN0UHJvcGVydHlLZXkoKSB7XG4gICAgICAgIHZhciB0b2tlbjtcblxuICAgICAgICBza2lwV2hpdGVzcGFjZSgpO1xuICAgICAgICB0b2tlbiA9IGxleCgpO1xuXG4gICAgICAgIC8vIE5vdGU6IFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIG9ubHkgZnJvbSBwYXJzZU9iamVjdFByb3BlcnR5KCksIHdoZXJlXG4gICAgICAgIC8vIEVPRiBhbmQgUHVuY3R1YXRvciB0b2tlbnMgYXJlIGFscmVhZHkgZmlsdGVyZWQgb3V0LlxuICAgICAgICBpZiAodG9rZW4udHlwZSA9PT0gVG9rZW4uU3RyaW5nTGl0ZXJhbCB8fCB0b2tlbi50eXBlID09PSBUb2tlbi5OdW1lcmljTGl0ZXJhbCkge1xuICAgICAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwodG9rZW4pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUlkZW50aWZpZXIodG9rZW4udmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlT2JqZWN0UHJvcGVydHkoKSB7XG4gICAgICAgIHZhciB0b2tlbiwga2V5O1xuXG4gICAgICAgIHRva2VuID0gbG9va2FoZWFkO1xuICAgICAgICBza2lwV2hpdGVzcGFjZSgpO1xuXG4gICAgICAgIGlmICh0b2tlbi50eXBlID09PSBUb2tlbi5FT0YgfHwgdG9rZW4udHlwZSA9PT0gVG9rZW4uUHVuY3R1YXRvcikge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKHRva2VuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGtleSA9IHBhcnNlT2JqZWN0UHJvcGVydHlLZXkoKTtcbiAgICAgICAgZXhwZWN0KCc6Jyk7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVQcm9wZXJ0eSgnaW5pdCcsIGtleSwgcGFyc2VFeHByZXNzaW9uKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlT2JqZWN0SW5pdGlhbGlzZXIoKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gW107XG5cbiAgICAgICAgZXhwZWN0KCd7Jyk7XG5cbiAgICAgICAgd2hpbGUgKCFtYXRjaCgnfScpKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2gocGFyc2VPYmplY3RQcm9wZXJ0eSgpKTtcblxuICAgICAgICAgICAgaWYgKCFtYXRjaCgnfScpKSB7XG4gICAgICAgICAgICAgICAgZXhwZWN0KCcsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBleHBlY3QoJ30nKTtcblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlT2JqZWN0RXhwcmVzc2lvbihwcm9wZXJ0aWVzKTtcbiAgICB9XG5cbiAgICAvLyAxMS4xLjYgVGhlIEdyb3VwaW5nIE9wZXJhdG9yXG5cbiAgICBmdW5jdGlvbiBwYXJzZUdyb3VwRXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIGV4cHI7XG5cbiAgICAgICAgZXhwZWN0KCcoJyk7XG5cbiAgICAgICAgZXhwciA9IHBhcnNlRXhwcmVzc2lvbigpO1xuXG4gICAgICAgIGV4cGVjdCgnKScpO1xuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuXG4gICAgLy8gMTEuMSBQcmltYXJ5IEV4cHJlc3Npb25zXG5cbiAgICBmdW5jdGlvbiBwYXJzZVByaW1hcnlFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgdHlwZSwgdG9rZW4sIGV4cHI7XG5cbiAgICAgICAgaWYgKG1hdGNoKCcoJykpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUdyb3VwRXhwcmVzc2lvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHlwZSA9IGxvb2thaGVhZC50eXBlO1xuXG4gICAgICAgIGlmICh0eXBlID09PSBUb2tlbi5JZGVudGlmaWVyKSB7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlSWRlbnRpZmllcihsZXgoKS52YWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gVG9rZW4uU3RyaW5nTGl0ZXJhbCB8fCB0eXBlID09PSBUb2tlbi5OdW1lcmljTGl0ZXJhbCkge1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwobGV4KCkpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLktleXdvcmQpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaEtleXdvcmQoJ3RoaXMnKSkge1xuICAgICAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVUaGlzRXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLkJvb2xlYW5MaXRlcmFsKSB7XG4gICAgICAgICAgICB0b2tlbiA9IGxleCgpO1xuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSAodG9rZW4udmFsdWUgPT09ICd0cnVlJyk7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTGl0ZXJhbCh0b2tlbik7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gVG9rZW4uTnVsbExpdGVyYWwpIHtcbiAgICAgICAgICAgIHRva2VuID0gbGV4KCk7XG4gICAgICAgICAgICB0b2tlbi52YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTGl0ZXJhbCh0b2tlbik7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJ1snKSkge1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlQXJyYXlJbml0aWFsaXNlcigpO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCd7JykpIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZU9iamVjdEluaXRpYWxpc2VyKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXhwcikge1xuICAgICAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvd1VuZXhwZWN0ZWQobGV4KCkpO1xuICAgIH1cblxuICAgIC8vIDExLjIgTGVmdC1IYW5kLVNpZGUgRXhwcmVzc2lvbnNcblxuICAgIGZ1bmN0aW9uIHBhcnNlQXJndW1lbnRzKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuXG4gICAgICAgIGV4cGVjdCgnKCcpO1xuXG4gICAgICAgIGlmICghbWF0Y2goJyknKSkge1xuICAgICAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKHBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2goJyknKSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZXhwZWN0KCcsJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBleHBlY3QoJyknKTtcblxuICAgICAgICByZXR1cm4gYXJncztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU5vbkNvbXB1dGVkUHJvcGVydHkoKSB7XG4gICAgICAgIHZhciB0b2tlbjtcblxuICAgICAgICB0b2tlbiA9IGxleCgpO1xuXG4gICAgICAgIGlmICghaXNJZGVudGlmaWVyTmFtZSh0b2tlbikpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZCh0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlSWRlbnRpZmllcih0b2tlbi52YWx1ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VOb25Db21wdXRlZE1lbWJlcigpIHtcbiAgICAgICAgZXhwZWN0KCcuJyk7XG5cbiAgICAgICAgcmV0dXJuIHBhcnNlTm9uQ29tcHV0ZWRQcm9wZXJ0eSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlQ29tcHV0ZWRNZW1iZXIoKSB7XG4gICAgICAgIHZhciBleHByO1xuXG4gICAgICAgIGV4cGVjdCgnWycpO1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oKTtcblxuICAgICAgICBleHBlY3QoJ10nKTtcblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUxlZnRIYW5kU2lkZUV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciBleHByLCBhcmdzLCBwcm9wZXJ0eTtcblxuICAgICAgICBleHByID0gcGFyc2VQcmltYXJ5RXhwcmVzc2lvbigpO1xuXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2goJ1snKSkge1xuICAgICAgICAgICAgICAgIHByb3BlcnR5ID0gcGFyc2VDb21wdXRlZE1lbWJlcigpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVNZW1iZXJFeHByZXNzaW9uKCdbJywgZXhwciwgcHJvcGVydHkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgnLicpKSB7XG4gICAgICAgICAgICAgICAgcHJvcGVydHkgPSBwYXJzZU5vbkNvbXB1dGVkTWVtYmVyKCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZU1lbWJlckV4cHJlc3Npb24oJy4nLCBleHByLCBwcm9wZXJ0eSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCcoJykpIHtcbiAgICAgICAgICAgICAgICBhcmdzID0gcGFyc2VBcmd1bWVudHMoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlQ2FsbEV4cHJlc3Npb24oZXhwciwgYXJncyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgLy8gMTEuMyBQb3N0Zml4IEV4cHJlc3Npb25zXG5cbiAgICB2YXIgcGFyc2VQb3N0Zml4RXhwcmVzc2lvbiA9IHBhcnNlTGVmdEhhbmRTaWRlRXhwcmVzc2lvbjtcblxuICAgIC8vIDExLjQgVW5hcnkgT3BlcmF0b3JzXG5cbiAgICBmdW5jdGlvbiBwYXJzZVVuYXJ5RXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIHRva2VuLCBleHByO1xuXG4gICAgICAgIGlmIChsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uUHVuY3R1YXRvciAmJiBsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uS2V5d29yZCkge1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlUG9zdGZpeEV4cHJlc3Npb24oKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgnKycpIHx8IG1hdGNoKCctJykgfHwgbWF0Y2goJyEnKSkge1xuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVVuYXJ5RXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZVVuYXJ5RXhwcmVzc2lvbih0b2tlbi52YWx1ZSwgZXhwcik7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2hLZXl3b3JkKCdkZWxldGUnKSB8fCBtYXRjaEtleXdvcmQoJ3ZvaWQnKSB8fCBtYXRjaEtleXdvcmQoJ3R5cGVvZicpKSB7XG4gICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXhwciA9IHBhcnNlUG9zdGZpeEV4cHJlc3Npb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJpbmFyeVByZWNlZGVuY2UodG9rZW4pIHtcbiAgICAgICAgdmFyIHByZWMgPSAwO1xuXG4gICAgICAgIGlmICh0b2tlbi50eXBlICE9PSBUb2tlbi5QdW5jdHVhdG9yICYmIHRva2VuLnR5cGUgIT09IFRva2VuLktleXdvcmQpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoICh0b2tlbi52YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSAnfHwnOlxuICAgICAgICAgICAgICAgIHByZWMgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICcmJic6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJz09JzpcbiAgICAgICAgICAgIGNhc2UgJyE9JzpcbiAgICAgICAgICAgIGNhc2UgJz09PSc6XG4gICAgICAgICAgICBjYXNlICchPT0nOlxuICAgICAgICAgICAgICAgIHByZWMgPSA2O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICc8JzpcbiAgICAgICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgY2FzZSAnPD0nOlxuICAgICAgICAgICAgY2FzZSAnPj0nOlxuICAgICAgICAgICAgY2FzZSAnaW5zdGFuY2VvZic6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ2luJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gNztcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnKyc6XG4gICAgICAgICAgICBjYXNlICctJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gOTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnKic6XG4gICAgICAgICAgICBjYXNlICcvJzpcbiAgICAgICAgICAgIGNhc2UgJyUnOlxuICAgICAgICAgICAgICAgIHByZWMgPSAxMTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcmVjO1xuICAgIH1cblxuICAgIC8vIDExLjUgTXVsdGlwbGljYXRpdmUgT3BlcmF0b3JzXG4gICAgLy8gMTEuNiBBZGRpdGl2ZSBPcGVyYXRvcnNcbiAgICAvLyAxMS43IEJpdHdpc2UgU2hpZnQgT3BlcmF0b3JzXG4gICAgLy8gMTEuOCBSZWxhdGlvbmFsIE9wZXJhdG9yc1xuICAgIC8vIDExLjkgRXF1YWxpdHkgT3BlcmF0b3JzXG4gICAgLy8gMTEuMTAgQmluYXJ5IEJpdHdpc2UgT3BlcmF0b3JzXG4gICAgLy8gMTEuMTEgQmluYXJ5IExvZ2ljYWwgT3BlcmF0b3JzXG5cbiAgICBmdW5jdGlvbiBwYXJzZUJpbmFyeUV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciBleHByLCB0b2tlbiwgcHJlYywgc3RhY2ssIHJpZ2h0LCBvcGVyYXRvciwgbGVmdCwgaTtcblxuICAgICAgICBsZWZ0ID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICB0b2tlbiA9IGxvb2thaGVhZDtcbiAgICAgICAgcHJlYyA9IGJpbmFyeVByZWNlZGVuY2UodG9rZW4pO1xuICAgICAgICBpZiAocHJlYyA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGxlZnQ7XG4gICAgICAgIH1cbiAgICAgICAgdG9rZW4ucHJlYyA9IHByZWM7XG4gICAgICAgIGxleCgpO1xuXG4gICAgICAgIHJpZ2h0ID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICBzdGFjayA9IFtsZWZ0LCB0b2tlbiwgcmlnaHRdO1xuXG4gICAgICAgIHdoaWxlICgocHJlYyA9IGJpbmFyeVByZWNlZGVuY2UobG9va2FoZWFkKSkgPiAwKSB7XG5cbiAgICAgICAgICAgIC8vIFJlZHVjZTogbWFrZSBhIGJpbmFyeSBleHByZXNzaW9uIGZyb20gdGhlIHRocmVlIHRvcG1vc3QgZW50cmllcy5cbiAgICAgICAgICAgIHdoaWxlICgoc3RhY2subGVuZ3RoID4gMikgJiYgKHByZWMgPD0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMl0ucHJlYykpIHtcbiAgICAgICAgICAgICAgICByaWdodCA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIG9wZXJhdG9yID0gc3RhY2sucG9wKCkudmFsdWU7XG4gICAgICAgICAgICAgICAgbGVmdCA9IHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVCaW5hcnlFeHByZXNzaW9uKG9wZXJhdG9yLCBsZWZ0LCByaWdodCk7XG4gICAgICAgICAgICAgICAgc3RhY2sucHVzaChleHByKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2hpZnQuXG4gICAgICAgICAgICB0b2tlbiA9IGxleCgpO1xuICAgICAgICAgICAgdG9rZW4ucHJlYyA9IHByZWM7XG4gICAgICAgICAgICBzdGFjay5wdXNoKHRva2VuKTtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVVuYXJ5RXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgc3RhY2sucHVzaChleHByKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmFsIHJlZHVjZSB0byBjbGVhbi11cCB0aGUgc3RhY2suXG4gICAgICAgIGkgPSBzdGFjay5sZW5ndGggLSAxO1xuICAgICAgICBleHByID0gc3RhY2tbaV07XG4gICAgICAgIHdoaWxlIChpID4gMSkge1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUJpbmFyeUV4cHJlc3Npb24oc3RhY2tbaSAtIDFdLnZhbHVlLCBzdGFja1tpIC0gMl0sIGV4cHIpO1xuICAgICAgICAgICAgaSAtPSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG5cbiAgICAvLyAxMS4xMiBDb25kaXRpb25hbCBPcGVyYXRvclxuXG4gICAgZnVuY3Rpb24gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciBleHByLCBjb25zZXF1ZW50LCBhbHRlcm5hdGU7XG5cbiAgICAgICAgZXhwciA9IHBhcnNlQmluYXJ5RXhwcmVzc2lvbigpO1xuXG4gICAgICAgIGlmIChtYXRjaCgnPycpKSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIGNvbnNlcXVlbnQgPSBwYXJzZUNvbmRpdGlvbmFsRXhwcmVzc2lvbigpO1xuICAgICAgICAgICAgZXhwZWN0KCc6Jyk7XG4gICAgICAgICAgICBhbHRlcm5hdGUgPSBwYXJzZUNvbmRpdGlvbmFsRXhwcmVzc2lvbigpO1xuXG4gICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlQ29uZGl0aW9uYWxFeHByZXNzaW9uKGV4cHIsIGNvbnNlcXVlbnQsIGFsdGVybmF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cbiAgICAvLyBTaW1wbGlmaWNhdGlvbiBzaW5jZSB3ZSBkbyBub3Qgc3VwcG9ydCBBc3NpZ25tZW50RXhwcmVzc2lvbi5cbiAgICB2YXIgcGFyc2VFeHByZXNzaW9uID0gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb247XG5cbiAgICAvLyBQb2x5bWVyIFN5bnRheCBleHRlbnNpb25zXG5cbiAgICAvLyBGaWx0ZXIgOjpcbiAgICAvLyAgIElkZW50aWZpZXJcbiAgICAvLyAgIElkZW50aWZpZXIgXCIoXCIgXCIpXCJcbiAgICAvLyAgIElkZW50aWZpZXIgXCIoXCIgRmlsdGVyQXJndW1lbnRzIFwiKVwiXG5cbiAgICBmdW5jdGlvbiBwYXJzZUZpbHRlcigpIHtcbiAgICAgICAgdmFyIGlkZW50aWZpZXIsIGFyZ3M7XG5cbiAgICAgICAgaWRlbnRpZmllciA9IGxleCgpO1xuXG4gICAgICAgIGlmIChpZGVudGlmaWVyLnR5cGUgIT09IFRva2VuLklkZW50aWZpZXIpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChpZGVudGlmaWVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFyZ3MgPSBtYXRjaCgnKCcpID8gcGFyc2VBcmd1bWVudHMoKSA6IFtdO1xuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVGaWx0ZXIoaWRlbnRpZmllci52YWx1ZSwgYXJncyk7XG4gICAgfVxuXG4gICAgLy8gRmlsdGVycyA6OlxuICAgIC8vICAgXCJ8XCIgRmlsdGVyXG4gICAgLy8gICBGaWx0ZXJzIFwifFwiIEZpbHRlclxuXG4gICAgZnVuY3Rpb24gcGFyc2VGaWx0ZXJzKCkge1xuICAgICAgICB3aGlsZSAobWF0Y2goJ3wnKSkge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICBwYXJzZUZpbHRlcigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gVG9wTGV2ZWwgOjpcbiAgICAvLyAgIExhYmVsbGVkRXhwcmVzc2lvbnNcbiAgICAvLyAgIEFzRXhwcmVzc2lvblxuICAgIC8vICAgSW5FeHByZXNzaW9uXG4gICAgLy8gICBGaWx0ZXJFeHByZXNzaW9uXG5cbiAgICAvLyBBc0V4cHJlc3Npb24gOjpcbiAgICAvLyAgIEZpbHRlckV4cHJlc3Npb24gYXMgSWRlbnRpZmllclxuXG4gICAgLy8gSW5FeHByZXNzaW9uIDo6XG4gICAgLy8gICBJZGVudGlmaWVyLCBJZGVudGlmaWVyIGluIEZpbHRlckV4cHJlc3Npb25cbiAgICAvLyAgIElkZW50aWZpZXIgaW4gRmlsdGVyRXhwcmVzc2lvblxuXG4gICAgLy8gRmlsdGVyRXhwcmVzc2lvbiA6OlxuICAgIC8vICAgRXhwcmVzc2lvblxuICAgIC8vICAgRXhwcmVzc2lvbiBGaWx0ZXJzXG5cbiAgICBmdW5jdGlvbiBwYXJzZVRvcExldmVsKCkge1xuICAgICAgICBza2lwV2hpdGVzcGFjZSgpO1xuICAgICAgICBwZWVrKCk7XG5cbiAgICAgICAgdmFyIGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oKTtcbiAgICAgICAgaWYgKGV4cHIpIHtcbiAgICAgICAgICAgIGlmIChsb29rYWhlYWQudmFsdWUgPT09ICcsJyB8fCBsb29rYWhlYWQudmFsdWUgPT0gJ2luJyAmJlxuICAgICAgICAgICAgICAgICAgICAgICBleHByLnR5cGUgPT09IFN5bnRheC5JZGVudGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VJbkV4cHJlc3Npb24oZXhwcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcnNlRmlsdGVycygpO1xuICAgICAgICAgICAgICAgIGlmIChsb29rYWhlYWQudmFsdWUgPT09ICdhcycpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VBc0V4cHJlc3Npb24oZXhwcik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZWdhdGUuY3JlYXRlVG9wTGV2ZWwoZXhwcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5FT0YpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChsb29rYWhlYWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VBc0V4cHJlc3Npb24oZXhwcikge1xuICAgICAgICBsZXgoKTsgIC8vIGFzXG4gICAgICAgIHZhciBpZGVudGlmaWVyID0gbGV4KCkudmFsdWU7XG4gICAgICAgIGRlbGVnYXRlLmNyZWF0ZUFzRXhwcmVzc2lvbihleHByLCBpZGVudGlmaWVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUluRXhwcmVzc2lvbihpZGVudGlmaWVyKSB7XG4gICAgICAgIHZhciBpbmRleE5hbWU7XG4gICAgICAgIGlmIChsb29rYWhlYWQudmFsdWUgPT09ICcsJykge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICBpZiAobG9va2FoZWFkLnR5cGUgIT09IFRva2VuLklkZW50aWZpZXIpXG4gICAgICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGxvb2thaGVhZCk7XG4gICAgICAgICAgICBpbmRleE5hbWUgPSBsZXgoKS52YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxleCgpOyAgLy8gaW5cbiAgICAgICAgdmFyIGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oKTtcbiAgICAgICAgcGFyc2VGaWx0ZXJzKCk7XG4gICAgICAgIGRlbGVnYXRlLmNyZWF0ZUluRXhwcmVzc2lvbihpZGVudGlmaWVyLm5hbWUsIGluZGV4TmFtZSwgZXhwcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2UoY29kZSwgaW5EZWxlZ2F0ZSkge1xuICAgICAgICBkZWxlZ2F0ZSA9IGluRGVsZWdhdGU7XG4gICAgICAgIHNvdXJjZSA9IGNvZGU7XG4gICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgbGVuZ3RoID0gc291cmNlLmxlbmd0aDtcbiAgICAgICAgbG9va2FoZWFkID0gbnVsbDtcbiAgICAgICAgc3RhdGUgPSB7XG4gICAgICAgICAgICBsYWJlbFNldDoge31cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gcGFyc2VUb3BMZXZlbCgpO1xuICAgIH1cblxuICAgIGdsb2JhbC5lc3ByaW1hID0ge1xuICAgICAgICBwYXJzZTogcGFyc2VcbiAgICB9O1xufSkobW9kdWxlLmV4cG9ydHMpOyIsIu+7vy8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuICogQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbiAqIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBkZXRlY3RFdmFsKCkge1xuICAgIC8vIERvbid0IHRlc3QgZm9yIGV2YWwgaWYgd2UncmUgcnVubmluZyBpbiBhIENocm9tZSBBcHAgZW52aXJvbm1lbnQuXG4gICAgLy8gV2UgY2hlY2sgZm9yIEFQSXMgc2V0IHRoYXQgb25seSBleGlzdCBpbiBhIENocm9tZSBBcHAgY29udGV4dC5cbiAgICBpZiAodHlwZW9mIGNocm9tZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY2hyb21lLmFwcCAmJiBjaHJvbWUuYXBwLnJ1bnRpbWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEZpcmVmb3ggT1MgQXBwcyBkbyBub3QgYWxsb3cgZXZhbC4gVGhpcyBmZWF0dXJlIGRldGVjdGlvbiBpcyB2ZXJ5IGhhY2t5XG4gICAgLy8gYnV0IGV2ZW4gaWYgc29tZSBvdGhlciBwbGF0Zm9ybSBhZGRzIHN1cHBvcnQgZm9yIHRoaXMgZnVuY3Rpb24gdGhpcyBjb2RlXG4gICAgLy8gd2lsbCBjb250aW51ZSB0byB3b3JrLlxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci5nZXREZXZpY2VTdG9yYWdlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICB2YXIgZiA9IG5ldyBGdW5jdGlvbignJywgJ3JldHVybiB0cnVlOycpO1xuICAgICAgICByZXR1cm4gZigpO1xuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbnZhciBoYXNFdmFsID0gZGV0ZWN0RXZhbCgpO1xuXG5mdW5jdGlvbiBpc0luZGV4KHMpIHtcbiAgICByZXR1cm4gK3MgPT09IHMgPj4+IDAgJiYgcyAhPT0gJyc7XG59XG5cbmZ1bmN0aW9uIHRvTnVtYmVyKHMpIHtcbiAgICByZXR1cm4gK3M7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaikge1xuICAgIHJldHVybiBvYmogPT09IE9iamVjdChvYmopO1xufVxuXG52YXIgbnVtYmVySXNOYU4gPSBOdW1iZXIuaXNOYU4gfHwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNOYU4odmFsdWUpO1xufVxuXG5mdW5jdGlvbiBhcmVTYW1lVmFsdWUobGVmdCwgcmlnaHQpIHtcbiAgICBpZiAobGVmdCA9PT0gcmlnaHQpXG4gICAgICAgIHJldHVybiBsZWZ0ICE9PSAwIHx8IDEgLyBsZWZ0ID09PSAxIC8gcmlnaHQ7XG4gICAgaWYgKG51bWJlcklzTmFOKGxlZnQpICYmIG51bWJlcklzTmFOKHJpZ2h0KSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICByZXR1cm4gbGVmdCAhPT0gbGVmdCAmJiByaWdodCAhPT0gcmlnaHQ7XG59XG5cbnZhciBjcmVhdGVPYmplY3QgPSAoJ19fcHJvdG9fXycgaW4ge30pID9cbiAgZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqOyB9IDpcbiAgZnVuY3Rpb24gKG9iaikge1xuICAgICAgdmFyIHByb3RvID0gb2JqLl9fcHJvdG9fXztcbiAgICAgIGlmICghcHJvdG8pXG4gICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIHZhciBuZXdPYmplY3QgPSBPYmplY3QuY3JlYXRlKHByb3RvKTtcbiAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmplY3QsIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIG5hbWUpKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ld09iamVjdDtcbiAgfTtcblxudmFyIGlkZW50U3RhcnQgPSAnW1xcJF9hLXpBLVpdJztcbnZhciBpZGVudFBhcnQgPSAnW1xcJF9hLXpBLVowLTldJztcbnZhciBpZGVudFJlZ0V4cCA9IG5ldyBSZWdFeHAoJ14nICsgaWRlbnRTdGFydCArICcrJyArIGlkZW50UGFydCArICcqJyArICckJyk7XG5cbmZ1bmN0aW9uIGdldFBhdGhDaGFyVHlwZShjaGFyKSB7XG4gICAgaWYgKGNoYXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgcmV0dXJuICdlb2YnO1xuXG4gICAgdmFyIGNvZGUgPSBjaGFyLmNoYXJDb2RlQXQoMCk7XG5cbiAgICBzd2l0Y2ggKGNvZGUpIHtcbiAgICAgICAgY2FzZSAweDVCOiAvLyBbXG4gICAgICAgIGNhc2UgMHg1RDogLy8gXVxuICAgICAgICBjYXNlIDB4MkU6IC8vIC5cbiAgICAgICAgY2FzZSAweDIyOiAvLyBcIlxuICAgICAgICBjYXNlIDB4Mjc6IC8vICdcbiAgICAgICAgY2FzZSAweDMwOiAvLyAwXG4gICAgICAgICAgICByZXR1cm4gY2hhcjtcblxuICAgICAgICBjYXNlIDB4NUY6IC8vIF9cbiAgICAgICAgY2FzZSAweDI0OiAvLyAkXG4gICAgICAgICAgICByZXR1cm4gJ2lkZW50JztcblxuICAgICAgICBjYXNlIDB4MjA6IC8vIFNwYWNlXG4gICAgICAgIGNhc2UgMHgwOTogLy8gVGFiXG4gICAgICAgIGNhc2UgMHgwQTogLy8gTmV3bGluZVxuICAgICAgICBjYXNlIDB4MEQ6IC8vIFJldHVyblxuICAgICAgICBjYXNlIDB4QTA6ICAvLyBOby1icmVhayBzcGFjZVxuICAgICAgICBjYXNlIDB4RkVGRjogIC8vIEJ5dGUgT3JkZXIgTWFya1xuICAgICAgICBjYXNlIDB4MjAyODogIC8vIExpbmUgU2VwYXJhdG9yXG4gICAgICAgIGNhc2UgMHgyMDI5OiAgLy8gUGFyYWdyYXBoIFNlcGFyYXRvclxuICAgICAgICAgICAgcmV0dXJuICd3cyc7XG4gICAgfVxuXG4gICAgLy8gYS16LCBBLVpcbiAgICBpZiAoKDB4NjEgPD0gY29kZSAmJiBjb2RlIDw9IDB4N0EpIHx8ICgweDQxIDw9IGNvZGUgJiYgY29kZSA8PSAweDVBKSlcbiAgICAgICAgcmV0dXJuICdpZGVudCc7XG5cbiAgICAvLyAxLTlcbiAgICBpZiAoMHgzMSA8PSBjb2RlICYmIGNvZGUgPD0gMHgzOSlcbiAgICAgICAgcmV0dXJuICdudW1iZXInO1xuXG4gICAgcmV0dXJuICdlbHNlJztcbn1cblxudmFyIHBhdGhTdGF0ZU1hY2hpbmUgPSB7XG4gICAgJ2JlZm9yZVBhdGgnOiB7XG4gICAgICAgICd3cyc6IFsnYmVmb3JlUGF0aCddLFxuICAgICAgICAnaWRlbnQnOiBbJ2luSWRlbnQnLCAnYXBwZW5kJ10sXG4gICAgICAgICdbJzogWydiZWZvcmVFbGVtZW50J10sXG4gICAgICAgICdlb2YnOiBbJ2FmdGVyUGF0aCddXG4gICAgfSxcblxuICAgICdpblBhdGgnOiB7XG4gICAgICAgICd3cyc6IFsnaW5QYXRoJ10sXG4gICAgICAgICcuJzogWydiZWZvcmVJZGVudCddLFxuICAgICAgICAnWyc6IFsnYmVmb3JlRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydhZnRlclBhdGgnXVxuICAgIH0sXG5cbiAgICAnYmVmb3JlSWRlbnQnOiB7XG4gICAgICAgICd3cyc6IFsnYmVmb3JlSWRlbnQnXSxcbiAgICAgICAgJ2lkZW50JzogWydpbklkZW50JywgJ2FwcGVuZCddXG4gICAgfSxcblxuICAgICdpbklkZW50Jzoge1xuICAgICAgICAnaWRlbnQnOiBbJ2luSWRlbnQnLCAnYXBwZW5kJ10sXG4gICAgICAgICcwJzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnbnVtYmVyJzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnd3MnOiBbJ2luUGF0aCcsICdwdXNoJ10sXG4gICAgICAgICcuJzogWydiZWZvcmVJZGVudCcsICdwdXNoJ10sXG4gICAgICAgICdbJzogWydiZWZvcmVFbGVtZW50JywgJ3B1c2gnXSxcbiAgICAgICAgJ2VvZic6IFsnYWZ0ZXJQYXRoJywgJ3B1c2gnXVxuICAgIH0sXG5cbiAgICAnYmVmb3JlRWxlbWVudCc6IHtcbiAgICAgICAgJ3dzJzogWydiZWZvcmVFbGVtZW50J10sXG4gICAgICAgICcwJzogWydhZnRlclplcm8nLCAnYXBwZW5kJ10sXG4gICAgICAgICdudW1iZXInOiBbJ2luSW5kZXgnLCAnYXBwZW5kJ10sXG4gICAgICAgIFwiJ1wiOiBbJ2luU2luZ2xlUXVvdGUnLCAnYXBwZW5kJywgJyddLFxuICAgICAgICAnXCInOiBbJ2luRG91YmxlUXVvdGUnLCAnYXBwZW5kJywgJyddXG4gICAgfSxcblxuICAgICdhZnRlclplcm8nOiB7XG4gICAgICAgICd3cyc6IFsnYWZ0ZXJFbGVtZW50JywgJ3B1c2gnXSxcbiAgICAgICAgJ10nOiBbJ2luUGF0aCcsICdwdXNoJ11cbiAgICB9LFxuXG4gICAgJ2luSW5kZXgnOiB7XG4gICAgICAgICcwJzogWydpbkluZGV4JywgJ2FwcGVuZCddLFxuICAgICAgICAnbnVtYmVyJzogWydpbkluZGV4JywgJ2FwcGVuZCddLFxuICAgICAgICAnd3MnOiBbJ2FmdGVyRWxlbWVudCddLFxuICAgICAgICAnXSc6IFsnaW5QYXRoJywgJ3B1c2gnXVxuICAgIH0sXG5cbiAgICAnaW5TaW5nbGVRdW90ZSc6IHtcbiAgICAgICAgXCInXCI6IFsnYWZ0ZXJFbGVtZW50J10sXG4gICAgICAgICdlb2YnOiBbJ2Vycm9yJ10sXG4gICAgICAgICdlbHNlJzogWydpblNpbmdsZVF1b3RlJywgJ2FwcGVuZCddXG4gICAgfSxcblxuICAgICdpbkRvdWJsZVF1b3RlJzoge1xuICAgICAgICAnXCInOiBbJ2FmdGVyRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydlcnJvciddLFxuICAgICAgICAnZWxzZSc6IFsnaW5Eb3VibGVRdW90ZScsICdhcHBlbmQnXVxuICAgIH0sXG5cbiAgICAnYWZ0ZXJFbGVtZW50Jzoge1xuICAgICAgICAnd3MnOiBbJ2FmdGVyRWxlbWVudCddLFxuICAgICAgICAnXSc6IFsnaW5QYXRoJywgJ3B1c2gnXVxuICAgIH1cbn1cblxuZnVuY3Rpb24gbm9vcCgpIHsgfVxuXG5mdW5jdGlvbiBwYXJzZVBhdGgocGF0aCkge1xuICAgIHZhciBrZXlzID0gW107XG4gICAgdmFyIGluZGV4ID0gLTE7XG4gICAgdmFyIGMsIG5ld0NoYXIsIGtleSwgdHlwZSwgdHJhbnNpdGlvbiwgYWN0aW9uLCB0eXBlTWFwLCBtb2RlID0gJ2JlZm9yZVBhdGgnO1xuXG4gICAgdmFyIGFjdGlvbnMgPSB7XG4gICAgICAgIHB1c2g6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xuICAgICAgICAgICAga2V5ID0gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFwcGVuZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIGtleSA9IG5ld0NoYXJcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBrZXkgKz0gbmV3Q2hhcjtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBtYXliZVVuZXNjYXBlUXVvdGUoKSB7XG4gICAgICAgIGlmIChpbmRleCA+PSBwYXRoLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB2YXIgbmV4dENoYXIgPSBwYXRoW2luZGV4ICsgMV07XG4gICAgICAgIGlmICgobW9kZSA9PSAnaW5TaW5nbGVRdW90ZScgJiYgbmV4dENoYXIgPT0gXCInXCIpIHx8XG4gICAgICAgICAgICAobW9kZSA9PSAnaW5Eb3VibGVRdW90ZScgJiYgbmV4dENoYXIgPT0gJ1wiJykpIHtcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICBuZXdDaGFyID0gbmV4dENoYXI7XG4gICAgICAgICAgICBhY3Rpb25zLmFwcGVuZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB3aGlsZSAobW9kZSkge1xuICAgICAgICBpbmRleCsrO1xuICAgICAgICBjID0gcGF0aFtpbmRleF07XG5cbiAgICAgICAgaWYgKGMgPT0gJ1xcXFwnICYmIG1heWJlVW5lc2NhcGVRdW90ZShtb2RlKSlcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgIHR5cGUgPSBnZXRQYXRoQ2hhclR5cGUoYyk7XG4gICAgICAgIHR5cGVNYXAgPSBwYXRoU3RhdGVNYWNoaW5lW21vZGVdO1xuICAgICAgICB0cmFuc2l0aW9uID0gdHlwZU1hcFt0eXBlXSB8fCB0eXBlTWFwWydlbHNlJ10gfHwgJ2Vycm9yJztcblxuICAgICAgICBpZiAodHJhbnNpdGlvbiA9PSAnZXJyb3InKVxuICAgICAgICAgICAgcmV0dXJuOyAvLyBwYXJzZSBlcnJvcjtcblxuICAgICAgICBtb2RlID0gdHJhbnNpdGlvblswXTtcbiAgICAgICAgYWN0aW9uID0gYWN0aW9uc1t0cmFuc2l0aW9uWzFdXSB8fCBub29wO1xuICAgICAgICBuZXdDaGFyID0gdHJhbnNpdGlvblsyXSA9PT0gdW5kZWZpbmVkID8gYyA6IHRyYW5zaXRpb25bMl07XG4gICAgICAgIGFjdGlvbigpO1xuXG4gICAgICAgIGlmIChtb2RlID09PSAnYWZ0ZXJQYXRoJykge1xuICAgICAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm47IC8vIHBhcnNlIGVycm9yXG59XG5cbmZ1bmN0aW9uIGlzSWRlbnQocykge1xuICAgIHJldHVybiBpZGVudFJlZ0V4cC50ZXN0KHMpO1xufVxuXG52YXIgY29uc3RydWN0b3JJc1ByaXZhdGUgPSB7fTtcblxuZnVuY3Rpb24gUGF0aChwYXJ0cywgcHJpdmF0ZVRva2VuKSB7XG4gICAgaWYgKHByaXZhdGVUb2tlbiAhPT0gY29uc3RydWN0b3JJc1ByaXZhdGUpXG4gICAgICAgIHRocm93IEVycm9yKCdVc2UgUGF0aC5nZXQgdG8gcmV0cmlldmUgcGF0aCBvYmplY3RzJyk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMucHVzaChTdHJpbmcocGFydHNbaV0pKTtcbiAgICB9XG5cbiAgICBpZiAoaGFzRXZhbCAmJiB0aGlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmdldFZhbHVlRnJvbSA9IHRoaXMuY29tcGlsZWRHZXRWYWx1ZUZyb21GbigpO1xuICAgIH1cbn1cblxuLy8gVE9ETyhyYWZhZWx3KTogTWFrZSBzaW1wbGUgTFJVIGNhY2hlXG52YXIgcGF0aENhY2hlID0ge307XG5cbmZ1bmN0aW9uIGdldFBhdGgocGF0aFN0cmluZykge1xuICAgIGlmIChwYXRoU3RyaW5nIGluc3RhbmNlb2YgUGF0aClcbiAgICAgICAgcmV0dXJuIHBhdGhTdHJpbmc7XG5cbiAgICBpZiAocGF0aFN0cmluZyA9PSBudWxsIHx8IHBhdGhTdHJpbmcubGVuZ3RoID09IDApXG4gICAgICAgIHBhdGhTdHJpbmcgPSAnJztcblxuICAgIGlmICh0eXBlb2YgcGF0aFN0cmluZyAhPSAnc3RyaW5nJykge1xuICAgICAgICBpZiAoaXNJbmRleChwYXRoU3RyaW5nLmxlbmd0aCkpIHtcbiAgICAgICAgICAgIC8vIENvbnN0cnVjdGVkIHdpdGggYXJyYXktbGlrZSAocHJlLXBhcnNlZCkga2V5c1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQYXRoKHBhdGhTdHJpbmcsIGNvbnN0cnVjdG9ySXNQcml2YXRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhdGhTdHJpbmcgPSBTdHJpbmcocGF0aFN0cmluZyk7XG4gICAgfVxuXG4gICAgdmFyIHBhdGggPSBwYXRoQ2FjaGVbcGF0aFN0cmluZ107XG4gICAgaWYgKHBhdGgpXG4gICAgICAgIHJldHVybiBwYXRoO1xuXG4gICAgdmFyIHBhcnRzID0gcGFyc2VQYXRoKHBhdGhTdHJpbmcpO1xuICAgIGlmICghcGFydHMpXG4gICAgICAgIHJldHVybiBpbnZhbGlkUGF0aDtcblxuICAgIHZhciBwYXRoID0gbmV3IFBhdGgocGFydHMsIGNvbnN0cnVjdG9ySXNQcml2YXRlKTtcbiAgICBwYXRoQ2FjaGVbcGF0aFN0cmluZ10gPSBwYXRoO1xuICAgIHJldHVybiBwYXRoO1xufVxuXG5QYXRoLmdldCA9IGdldFBhdGg7XG5cbmZ1bmN0aW9uIGZvcm1hdEFjY2Vzc29yKGtleSkge1xuICAgIGlmIChpc0luZGV4KGtleSkpIHtcbiAgICAgICAgcmV0dXJuICdbJyArIGtleSArICddJztcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ1tcIicgKyBrZXkucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpICsgJ1wiXSc7XG4gICAgfVxufVxuXG5QYXRoLnByb3RvdHlwZSA9IGNyZWF0ZU9iamVjdCh7XG4gICAgX19wcm90b19fOiBbXSxcbiAgICB2YWxpZDogdHJ1ZSxcblxuICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXRoU3RyaW5nID0gJyc7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXNbaV07XG4gICAgICAgICAgICBpZiAoaXNJZGVudChrZXkpKSB7XG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSBpID8gJy4nICsga2V5IDoga2V5O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXRoU3RyaW5nICs9IGZvcm1hdEFjY2Vzc29yKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGF0aFN0cmluZztcbiAgICB9LFxuXG4gICAgZ2V0VmFsdWVGcm9tOiBmdW5jdGlvbiAob2JqLCBkaXJlY3RPYnNlcnZlcikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChvYmogPT0gbnVsbClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBvYmogPSBvYmpbdGhpc1tpXV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9LFxuXG4gICAgaXRlcmF0ZU9iamVjdHM6IGZ1bmN0aW9uIChvYmosIG9ic2VydmUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaSlcbiAgICAgICAgICAgICAgICBvYmogPSBvYmpbdGhpc1tpIC0gMV1dO1xuICAgICAgICAgICAgaWYgKCFpc09iamVjdChvYmopKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIG9ic2VydmUob2JqLCB0aGlzW2ldKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBjb21waWxlZEdldFZhbHVlRnJvbUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHIgPSAnJztcbiAgICAgICAgdmFyIHBhdGhTdHJpbmcgPSAnb2JqJztcbiAgICAgICAgc3RyICs9ICdpZiAob2JqICE9IG51bGwnO1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBrZXk7XG4gICAgICAgIGZvciAoOyBpIDwgKHRoaXMubGVuZ3RoIC0gMSkgOyBpKyspIHtcbiAgICAgICAgICAgIGtleSA9IHRoaXNbaV07XG4gICAgICAgICAgICBwYXRoU3RyaW5nICs9IGlzSWRlbnQoa2V5KSA/ICcuJyArIGtleSA6IGZvcm1hdEFjY2Vzc29yKGtleSk7XG4gICAgICAgICAgICBzdHIgKz0gJyAmJlxcbiAgICAgJyArIHBhdGhTdHJpbmcgKyAnICE9IG51bGwnO1xuICAgICAgICB9XG4gICAgICAgIHN0ciArPSAnKVxcbic7XG5cbiAgICAgICAgdmFyIGtleSA9IHRoaXNbaV07XG4gICAgICAgIHBhdGhTdHJpbmcgKz0gaXNJZGVudChrZXkpID8gJy4nICsga2V5IDogZm9ybWF0QWNjZXNzb3Ioa2V5KTtcblxuICAgICAgICBzdHIgKz0gJyAgcmV0dXJuICcgKyBwYXRoU3RyaW5nICsgJztcXG5lbHNlXFxuICByZXR1cm4gdW5kZWZpbmVkOyc7XG4gICAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oJ29iaicsIHN0cik7XG4gICAgfSxcblxuICAgIHNldFZhbHVlRnJvbTogZnVuY3Rpb24gKG9iaiwgdmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIWlzT2JqZWN0KG9iaikpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgb2JqID0gb2JqW3RoaXNbaV1dO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpc09iamVjdChvYmopKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIG9ialt0aGlzW2ldXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59KTtcblxudmFyIGludmFsaWRQYXRoID0gbmV3IFBhdGgoJycsIGNvbnN0cnVjdG9ySXNQcml2YXRlKTtcbmludmFsaWRQYXRoLnZhbGlkID0gZmFsc2U7XG5pbnZhbGlkUGF0aC5nZXRWYWx1ZUZyb20gPSBpbnZhbGlkUGF0aC5zZXRWYWx1ZUZyb20gPSBmdW5jdGlvbiAoKSB7IH07XG5cbmV4cG9ydHMuUGF0aCA9IFBhdGg7XG4iLCLvu78vLyBDb3B5cmlnaHQgKGMpIDIwMTQgVGhlIFBvbHltZXIgUHJvamVjdCBBdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuLy8gVGhpcyBjb2RlIG1heSBvbmx5IGJlIHVzZWQgdW5kZXIgdGhlIEJTRCBzdHlsZSBsaWNlbnNlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9MSUNFTlNFLnR4dFxuLy8gVGhlIGNvbXBsZXRlIHNldCBvZiBhdXRob3JzIG1heSBiZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQVVUSE9SUy50eHRcbi8vIFRoZSBjb21wbGV0ZSBzZXQgb2YgY29udHJpYnV0b3JzIG1heSBiZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vQ09OVFJJQlVUT1JTLnR4dFxuLy8gQ29kZSBkaXN0cmlidXRlZCBieSBHb29nbGUgYXMgcGFydCBvZiB0aGUgcG9seW1lciBwcm9qZWN0IGlzIGFsc29cbi8vIHN1YmplY3QgdG8gYW4gYWRkaXRpb25hbCBJUCByaWdodHMgZ3JhbnQgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL1BBVEVOVFMudHh0XG5cbnZhciBlc3ByaW1hID0gcmVxdWlyZShcImpzLWxpYnMvZXNwcmltYVwiKS5lc3ByaW1hO1xudmFyIFBhdGggPSByZXF1aXJlKFwianMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zL3BhdGgtcGFyc2VyXCIpLlBhdGg7XG5cbihmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gVE9ETyhyYWZhZWx3KTogSW1wbGVtZW50IHNpbXBsZSBMUlUuXG4gICAgdmFyIGV4cHJlc3Npb25QYXJzZUNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuICAgIGZ1bmN0aW9uIGdldEV4cHJlc3Npb24oZXhwcmVzc2lvblRleHQpIHtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uUGFyc2VDYWNoZVtleHByZXNzaW9uVGV4dF07XG4gICAgICAgIGlmICghZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGRlbGVnYXRlID0gbmV3IEFTVERlbGVnYXRlKCk7XG4gICAgICAgICAgICBlc3ByaW1hLnBhcnNlKGV4cHJlc3Npb25UZXh0LCBkZWxlZ2F0ZSk7XG4gICAgICAgICAgICBleHByZXNzaW9uID0gbmV3IEV4cHJlc3Npb24oZGVsZWdhdGUpO1xuICAgICAgICAgICAgZXhwcmVzc2lvblBhcnNlQ2FjaGVbZXhwcmVzc2lvblRleHRdID0gZXhwcmVzc2lvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBMaXRlcmFsKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy52YWx1ZUZuXyA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBMaXRlcmFsLnByb3RvdHlwZSA9IHtcbiAgICAgICAgdmFsdWVGbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlRm5fKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUZuXztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIElkZW50UGF0aChuYW1lKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMucGF0aCA9IFBhdGguZ2V0KG5hbWUpO1xuICAgIH1cblxuICAgIElkZW50UGF0aC5wcm90b3R5cGUgPSB7XG4gICAgICAgIHZhbHVlRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZUZuXykge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gdGhpcy5uYW1lO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5wYXRoO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBjaGFuZ2VkTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuYWRkUGF0aChtb2RlbCwgcGF0aCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nZWRNb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHBhdGguZ2V0VmFsdWVGcm9tKGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdGguZ2V0VmFsdWVGcm9tKG1vZGVsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlRm5fO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbHVlOiBmdW5jdGlvbiAobW9kZWwsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXRoLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwgPSBmaW5kU2NvcGUobW9kZWwsIHRoaXMucGF0aFswXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGguc2V0VmFsdWVGcm9tKG1vZGVsLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gTWVtYmVyRXhwcmVzc2lvbihvYmplY3QsIHByb3BlcnR5LCBhY2Nlc3Nvcikge1xuICAgICAgICB0aGlzLmNvbXB1dGVkID0gYWNjZXNzb3IgPT0gJ1snO1xuXG4gICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0eXBlb2Ygb2JqZWN0ID09ICdmdW5jdGlvbicgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5keW5hbWljRGVwcyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuY29tcHV0ZWQgJiYgIShwcm9wZXJ0eSBpbnN0YW5jZW9mIExpdGVyYWwpKTtcblxuICAgICAgICB0aGlzLnNpbXBsZVBhdGggPVxuICAgICAgICAgICAgIXRoaXMuZHluYW1pY0RlcHMgJiZcbiAgICAgICAgICAgIChwcm9wZXJ0eSBpbnN0YW5jZW9mIElkZW50UGF0aCB8fCBwcm9wZXJ0eSBpbnN0YW5jZW9mIExpdGVyYWwpICYmXG4gICAgICAgICAgICAob2JqZWN0IGluc3RhbmNlb2YgTWVtYmVyRXhwcmVzc2lvbiB8fCBvYmplY3QgaW5zdGFuY2VvZiBJZGVudFBhdGgpO1xuXG4gICAgICAgIHRoaXMub2JqZWN0ID0gdGhpcy5zaW1wbGVQYXRoID8gb2JqZWN0IDogZ2V0Rm4ob2JqZWN0KTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eSA9ICF0aGlzLmNvbXB1dGVkIHx8IHRoaXMuc2ltcGxlUGF0aCA/XG4gICAgICAgICAgICBwcm9wZXJ0eSA6IGdldEZuKHByb3BlcnR5KTtcbiAgICB9XG5cbiAgICBNZW1iZXJFeHByZXNzaW9uLnByb3RvdHlwZSA9IHtcbiAgICAgICAgZ2V0IGZ1bGxQYXRoKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmZ1bGxQYXRoXykge1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gdGhpcy5vYmplY3QgaW5zdGFuY2VvZiBNZW1iZXJFeHByZXNzaW9uID9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vYmplY3QuZnVsbFBhdGguc2xpY2UoKSA6IFt0aGlzLm9iamVjdC5uYW1lXTtcbiAgICAgICAgICAgICAgICBwYXJ0cy5wdXNoKHRoaXMucHJvcGVydHkgaW5zdGFuY2VvZiBJZGVudFBhdGggP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5Lm5hbWUgOiB0aGlzLnByb3BlcnR5LnZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZ1bGxQYXRoXyA9IFBhdGguZ2V0KHBhcnRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnVsbFBhdGhfO1xuICAgICAgICB9LFxuXG4gICAgICAgIHZhbHVlRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZUZuXykge1xuICAgICAgICAgICAgICAgIHZhciBvYmplY3QgPSB0aGlzLm9iamVjdDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNpbXBsZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSB0aGlzLmZ1bGxQYXRoO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuYWRkUGF0aChtb2RlbCwgcGF0aCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLmdldFZhbHVlRnJvbShtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5jb21wdXRlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IFBhdGguZ2V0KHRoaXMucHJvcGVydHkubmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IG9iamVjdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgoY29udGV4dCwgcGF0aCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLmdldFZhbHVlRnJvbShjb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENvbXB1dGVkIHByb3BlcnR5LlxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSB0aGlzLnByb3BlcnR5O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBvYmplY3QobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcE5hbWUgPSBwcm9wZXJ0eShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRQYXRoKGNvbnRleHQsIFtwcm9wTmFtZV0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCA/IGNvbnRleHRbcHJvcE5hbWVdIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlRm5fO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbHVlOiBmdW5jdGlvbiAobW9kZWwsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zaW1wbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mdWxsUGF0aC5zZXRWYWx1ZUZyb20obW9kZWwsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvYmplY3QgPSB0aGlzLm9iamVjdChtb2RlbCk7XG4gICAgICAgICAgICB2YXIgcHJvcE5hbWUgPSB0aGlzLnByb3BlcnR5IGluc3RhbmNlb2YgSWRlbnRQYXRoID8gdGhpcy5wcm9wZXJ0eS5uYW1lIDpcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5KG1vZGVsKTtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3RbcHJvcE5hbWVdID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gRmlsdGVyKG5hbWUsIGFyZ3MpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5hcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5hcmdzW2ldID0gZ2V0Rm4oYXJnc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBGaWx0ZXIucHJvdG90eXBlID0ge1xuICAgICAgICB0cmFuc2Zvcm06IGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5LCB0b01vZGVsRGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxBcmdzKSB7XG4gICAgICAgICAgICB2YXIgZm4gPSBmaWx0ZXJSZWdpc3RyeVt0aGlzLm5hbWVdO1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBtb2RlbDtcbiAgICAgICAgICAgIGlmIChmbikge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZuID0gY29udGV4dFt0aGlzLm5hbWVdO1xuICAgICAgICAgICAgICAgIGlmICghZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGZpbmQgZnVuY3Rpb24gb3IgZmlsdGVyOiAnICsgdGhpcy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgdG9Nb2RlbERpcmVjdGlvbiBpcyBmYWxzZXksIHRoZW4gdGhlIFwibm9ybWFsXCIgKGRvbS1ib3VuZCkgZGlyZWN0aW9uXG4gICAgICAgICAgICAvLyBpcyB1c2VkLiBPdGhlcndpc2UsIGl0IGxvb2tzIGZvciBhICd0b01vZGVsJyBwcm9wZXJ0eSBmdW5jdGlvbiBvbiB0aGVcbiAgICAgICAgICAgIC8vIG9iamVjdC5cbiAgICAgICAgICAgIGlmICh0b01vZGVsRGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgZm4gPSBmbi50b01vZGVsO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZm4udG9WaWV3ID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBmbiA9IGZuLnRvVmlldztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBmbiAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGZpbmQgZnVuY3Rpb24gb3IgZmlsdGVyOiAnICsgdGhpcy5uYW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBhcmdzID0gaW5pdGlhbEFyZ3MgfHwgW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChnZXRGbih0aGlzLmFyZ3NbaV0pKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG5vdEltcGxlbWVudGVkKCkgeyB0aHJvdyBFcnJvcignTm90IEltcGxlbWVudGVkJyk7IH1cblxuICAgIHZhciB1bmFyeU9wZXJhdG9ycyA9IHtcbiAgICAgICAgJysnOiBmdW5jdGlvbiAodikgeyByZXR1cm4gK3Y7IH0sXG4gICAgICAgICctJzogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIC12OyB9LFxuICAgICAgICAnISc6IGZ1bmN0aW9uICh2KSB7IHJldHVybiAhdjsgfVxuICAgIH07XG5cbiAgICB2YXIgYmluYXJ5T3BlcmF0b3JzID0ge1xuICAgICAgICAnKyc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICsgcjsgfSxcbiAgICAgICAgJy0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAtIHI7IH0sXG4gICAgICAgICcqJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgKiByOyB9LFxuICAgICAgICAnLyc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIC8gcjsgfSxcbiAgICAgICAgJyUnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAlIHI7IH0sXG4gICAgICAgICc8JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPCByOyB9LFxuICAgICAgICAnPic6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID4gcjsgfSxcbiAgICAgICAgJzw9JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPD0gcjsgfSxcbiAgICAgICAgJz49JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPj0gcjsgfSxcbiAgICAgICAgJz09JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgPT0gcjsgfSxcbiAgICAgICAgJyE9JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgIT0gcjsgfSxcbiAgICAgICAgJz09PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID09PSByOyB9LFxuICAgICAgICAnIT09JzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgIT09IHI7IH0sXG4gICAgICAgICcmJic6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICYmIHI7IH0sXG4gICAgICAgICd8fCc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIHx8IHI7IH0sXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldEZuKGFyZykge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGFyZyA9PSAnZnVuY3Rpb24nID8gYXJnIDogYXJnLnZhbHVlRm4oKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBBU1REZWxlZ2F0ZSgpIHtcbiAgICAgICAgdGhpcy5leHByZXNzaW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5maWx0ZXJzID0gW107XG4gICAgICAgIHRoaXMuZGVwcyA9IHt9O1xuICAgICAgICB0aGlzLmN1cnJlbnRQYXRoID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnNjb3BlSWRlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaW5kZXhJZGVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IGZhbHNlO1xuICAgIH1cblxuICAgIEFTVERlbGVnYXRlLnByb3RvdHlwZSA9IHtcbiAgICAgICAgY3JlYXRlVW5hcnlFeHByZXNzaW9uOiBmdW5jdGlvbiAob3AsIGFyZ3VtZW50KSB7XG4gICAgICAgICAgICBpZiAoIXVuYXJ5T3BlcmF0b3JzW29wXSlcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignRGlzYWxsb3dlZCBvcGVyYXRvcjogJyArIG9wKTtcblxuICAgICAgICAgICAgYXJndW1lbnQgPSBnZXRGbihhcmd1bWVudCk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmFyeU9wZXJhdG9yc1tvcF0oYXJndW1lbnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVCaW5hcnlFeHByZXNzaW9uOiBmdW5jdGlvbiAob3AsIGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgICAgICBpZiAoIWJpbmFyeU9wZXJhdG9yc1tvcF0pXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0Rpc2FsbG93ZWQgb3BlcmF0b3I6ICcgKyBvcCk7XG5cbiAgICAgICAgICAgIGxlZnQgPSBnZXRGbihsZWZ0KTtcbiAgICAgICAgICAgIHJpZ2h0ID0gZ2V0Rm4ocmlnaHQpO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKG9wKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnfHwnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGVmdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNhc2UgJyYmJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJpbmFyeU9wZXJhdG9yc1tvcF0obGVmdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUNvbmRpdGlvbmFsRXhwcmVzc2lvbjogZnVuY3Rpb24gKHRlc3QsIGNvbnNlcXVlbnQsIGFsdGVybmF0ZSkge1xuICAgICAgICAgICAgdGVzdCA9IGdldEZuKHRlc3QpO1xuICAgICAgICAgICAgY29uc2VxdWVudCA9IGdldEZuKGNvbnNlcXVlbnQpO1xuICAgICAgICAgICAgYWx0ZXJuYXRlID0gZ2V0Rm4oYWx0ZXJuYXRlKTtcblxuICAgICAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHRydWU7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpID9cbiAgICAgICAgICAgICAgICAgICAgY29uc2VxdWVudChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSA6XG4gICAgICAgICAgICAgICAgICAgIGFsdGVybmF0ZShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVJZGVudGlmaWVyOiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdmFyIGlkZW50ID0gbmV3IElkZW50UGF0aChuYW1lKTtcbiAgICAgICAgICAgIGlkZW50LnR5cGUgPSAnSWRlbnRpZmllcic7XG4gICAgICAgICAgICByZXR1cm4gaWRlbnQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlTWVtYmVyRXhwcmVzc2lvbjogZnVuY3Rpb24gKGFjY2Vzc29yLCBvYmplY3QsIHByb3BlcnR5KSB7XG4gICAgICAgICAgICB2YXIgZXggPSBuZXcgTWVtYmVyRXhwcmVzc2lvbihvYmplY3QsIHByb3BlcnR5LCBhY2Nlc3Nvcik7XG4gICAgICAgICAgICBpZiAoZXguZHluYW1pY0RlcHMpXG4gICAgICAgICAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gZXg7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQ2FsbEV4cHJlc3Npb246IGZ1bmN0aW9uIChleHByZXNzaW9uLCBhcmdzKSB7XG4gICAgICAgICAgICBpZiAoIShleHByZXNzaW9uIGluc3RhbmNlb2YgSWRlbnRQYXRoKSlcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignT25seSBpZGVudGlmaWVyIGZ1bmN0aW9uIGludm9jYXRpb25zIGFyZSBhbGxvd2VkJyk7XG5cbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBuZXcgRmlsdGVyKGV4cHJlc3Npb24ubmFtZSwgYXJncyk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXIudHJhbnNmb3JtKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnksIGZhbHNlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlTGl0ZXJhbDogZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExpdGVyYWwodG9rZW4udmFsdWUpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUFycmF5RXhwcmVzc2lvbjogZnVuY3Rpb24gKGVsZW1lbnRzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIGVsZW1lbnRzW2ldID0gZ2V0Rm4oZWxlbWVudHNbaV0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gW11cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBhcnIucHVzaChlbGVtZW50c1tpXShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVQcm9wZXJ0eTogZnVuY3Rpb24gKGtpbmQsIGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAga2V5OiBrZXkgaW5zdGFuY2VvZiBJZGVudFBhdGggPyBrZXkubmFtZSA6IGtleS52YWx1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlT2JqZWN0RXhwcmVzc2lvbjogZnVuY3Rpb24gKHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW2ldLnZhbHVlID0gZ2V0Rm4ocHJvcGVydGllc1tpXS52YWx1ZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIG9ialtwcm9wZXJ0aWVzW2ldLmtleV0gPVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc1tpXS52YWx1ZShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUZpbHRlcjogZnVuY3Rpb24gKG5hbWUsIGFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIobmFtZSwgYXJncykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUFzRXhwcmVzc2lvbjogZnVuY3Rpb24gKGV4cHJlc3Npb24sIHNjb3BlSWRlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgICAgICAgICB0aGlzLnNjb3BlSWRlbnQgPSBzY29wZUlkZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUluRXhwcmVzc2lvbjogZnVuY3Rpb24gKHNjb3BlSWRlbnQsIGluZGV4SWRlbnQsIGV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgICAgICAgICB0aGlzLnNjb3BlSWRlbnQgPSBzY29wZUlkZW50O1xuICAgICAgICAgICAgdGhpcy5pbmRleElkZW50ID0gaW5kZXhJZGVudDtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVUb3BMZXZlbDogZnVuY3Rpb24gKGV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGV4cHJlc3Npb247XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlVGhpc0V4cHJlc3Npb246IG5vdEltcGxlbWVudGVkXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gRXhwcmVzc2lvbihkZWxlZ2F0ZSkge1xuICAgICAgICB0aGlzLnNjb3BlSWRlbnQgPSBkZWxlZ2F0ZS5zY29wZUlkZW50O1xuICAgICAgICB0aGlzLmluZGV4SWRlbnQgPSBkZWxlZ2F0ZS5pbmRleElkZW50O1xuXG4gICAgICAgIGlmICghZGVsZWdhdGUuZXhwcmVzc2lvbilcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdObyBleHByZXNzaW9uIGZvdW5kLicpO1xuXG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IGRlbGVnYXRlLmV4cHJlc3Npb247XG4gICAgICAgIGdldEZuKHRoaXMuZXhwcmVzc2lvbik7IC8vIGZvcmNlcyBlbnVtZXJhdGlvbiBvZiBwYXRoIGRlcGVuZGVuY2llc1xuXG4gICAgICAgIHRoaXMuZmlsdGVycyA9IGRlbGVnYXRlLmZpbHRlcnM7XG4gICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSBkZWxlZ2F0ZS5keW5hbWljRGVwcztcbiAgICB9XG5cbiAgICBFeHByZXNzaW9uLnByb3RvdHlwZSA9IHtcbiAgICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uIChtb2RlbCwgaXNCYWNrQ29udmVydCwgY2hhbmdlZE1vZGVsLCBvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gZ2V0Rm4odGhpcy5leHByZXNzaW9uKShtb2RlbC5jb250ZXh0LCBvYnNlcnZlciwgY2hhbmdlZE1vZGVsKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLmZpbHRlcnNbaV0udHJhbnNmb3JtKG1vZGVsLmNvbnRleHQsIG9ic2VydmVyLCBtb2RlbC5jb250ZXh0LCBpc0JhY2tDb252ZXJ0LCBbdmFsdWVdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbHVlOiBmdW5jdGlvbiAobW9kZWwsIG5ld1ZhbHVlLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgdmFyIGNvdW50ID0gdGhpcy5maWx0ZXJzID8gdGhpcy5maWx0ZXJzLmxlbmd0aCA6IDA7XG4gICAgICAgICAgICB3aGlsZSAoY291bnQtLSA+IDApIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHRoaXMuZmlsdGVyc1tjb3VudF0udHJhbnNmb3JtKG1vZGVsLCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlclJlZ2lzdHJ5LCB0cnVlLCBbbmV3VmFsdWVdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuZXhwcmVzc2lvbi5zZXRWYWx1ZSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5leHByZXNzaW9uLnNldFZhbHVlKG1vZGVsLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIHN0eWxlIHByb3BlcnR5IG5hbWUgdG8gYSBjc3MgcHJvcGVydHkgbmFtZS4gRm9yIGV4YW1wbGU6XG4gICAgICogXCJXZWJraXRVc2VyU2VsZWN0XCIgdG8gXCItd2Via2l0LXVzZXItc2VsZWN0XCJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb252ZXJ0U3R5bGVQcm9wZXJ0eU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gU3RyaW5nKG5hbWUpLnJlcGxhY2UoL1tBLVpdL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICByZXR1cm4gJy0nICsgYy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgcGFyZW50U2NvcGVOYW1lID0gJ0AnICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMik7XG5cbiAgICAvLyBTaW5nbGUgaWRlbnQgcGF0aHMgbXVzdCBiaW5kIGRpcmVjdGx5IHRvIHRoZSBhcHByb3ByaWF0ZSBzY29wZSBvYmplY3QuXG4gICAgLy8gSS5lLiBQdXNoZWQgdmFsdWVzIGluIHR3by1iaW5kaW5ncyBuZWVkIHRvIGJlIGFzc2lnbmVkIHRvIHRoZSBhY3R1YWwgbW9kZWxcbiAgICAvLyBvYmplY3QuXG4gICAgZnVuY3Rpb24gZmluZFNjb3BlKG1vZGVsLCBwcm9wKSB7XG4gICAgICAgIHdoaWxlIChtb2RlbFtwYXJlbnRTY29wZU5hbWVdICYmXG4gICAgICAgICAgICAgICAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZGVsLCBwcm9wKSkge1xuICAgICAgICAgICAgbW9kZWwgPSBtb2RlbFtwYXJlbnRTY29wZU5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1vZGVsO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzTGl0ZXJhbEV4cHJlc3Npb24ocGF0aFN0cmluZykge1xuICAgICAgICBzd2l0Y2ggKHBhdGhTdHJpbmcpIHtcbiAgICAgICAgICAgIGNhc2UgJyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICBjYXNlICdmYWxzZSc6XG4gICAgICAgICAgICBjYXNlICdudWxsJzpcbiAgICAgICAgICAgIGNhc2UgJ3RydWUnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFpc05hTihOdW1iZXIocGF0aFN0cmluZykpKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBQb2x5bWVyRXhwcmVzc2lvbnMoKSB7IH1cblxuICAgIFBvbHltZXJFeHByZXNzaW9ucy5wcm90b3R5cGUgPSB7XG4gICAgICAgIC8vIFwiYnVpbHQtaW5cIiBmaWx0ZXJzXG4gICAgICAgIHN0eWxlT2JqZWN0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBwYXJ0cyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcGFydHMucHVzaChjb252ZXJ0U3R5bGVQcm9wZXJ0eU5hbWUoa2V5KSArICc6ICcgKyB2YWx1ZVtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYXJ0cy5qb2luKCc7ICcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRva2VuTGlzdDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW5zID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgdG9rZW5zLnB1c2goa2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0b2tlbnMuam9pbignICcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIGJpbmRpbmcgZGVsZWdhdGUgQVBJXG4gICAgICAgIHByZXBhcmVJbnN0YW5jZVBvc2l0aW9uQ2hhbmdlZDogZnVuY3Rpb24gKHRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhJZGVudCA9IHRlbXBsYXRlLnBvbHltZXJFeHByZXNzaW9uSW5kZXhJZGVudF87XG4gICAgICAgICAgICBpZiAoIWluZGV4SWRlbnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRlbXBsYXRlSW5zdGFuY2UsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdGVtcGxhdGVJbnN0YW5jZS5tb2RlbFtpbmRleElkZW50XSA9IGluZGV4O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBwcmVwYXJlSW5zdGFuY2VNb2RlbDogZnVuY3Rpb24gKHRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgc2NvcGVOYW1lID0gdGVtcGxhdGUucG9seW1lckV4cHJlc3Npb25TY29wZUlkZW50XztcbiAgICAgICAgICAgIGlmICghc2NvcGVOYW1lKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIHBhcmVudFNjb3BlID0gdGVtcGxhdGUudGVtcGxhdGVJbnN0YW5jZSA/XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUudGVtcGxhdGVJbnN0YW5jZS5tb2RlbCA6XG4gICAgICAgICAgICAgICAgdGVtcGxhdGUubW9kZWw7XG5cbiAgICAgICAgICAgIHZhciBpbmRleE5hbWUgPSB0ZW1wbGF0ZS5wb2x5bWVyRXhwcmVzc2lvbkluZGV4SWRlbnRfO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVNjb3BlT2JqZWN0KHBhcmVudFNjb3BlLCBtb2RlbCwgc2NvcGVOYW1lLCBpbmRleE5hbWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlU2NvcGVPYmplY3QgPSAoJ19fcHJvdG9fXycgaW4ge30pID9cbiAgICAgIGZ1bmN0aW9uIChwYXJlbnRTY29wZSwgbW9kZWwsIHNjb3BlTmFtZSwgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgdmFyIHNjb3BlID0ge307XG4gICAgICAgICAgc2NvcGVbc2NvcGVOYW1lXSA9IG1vZGVsO1xuICAgICAgICAgIHNjb3BlW2luZGV4TmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgc2NvcGVbcGFyZW50U2NvcGVOYW1lXSA9IHBhcmVudFNjb3BlO1xuICAgICAgICAgIHNjb3BlLl9fcHJvdG9fXyA9IHBhcmVudFNjb3BlO1xuICAgICAgICAgIHJldHVybiBzY29wZTtcbiAgICAgIH0gOlxuICAgICAgZnVuY3Rpb24gKHBhcmVudFNjb3BlLCBtb2RlbCwgc2NvcGVOYW1lLCBpbmRleE5hbWUpIHtcbiAgICAgICAgICB2YXIgc2NvcGUgPSBPYmplY3QuY3JlYXRlKHBhcmVudFNjb3BlKTtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2NvcGUsIHNjb3BlTmFtZSxcbiAgICAgICAgICAgICAgeyB2YWx1ZTogbW9kZWwsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjb3BlLCBpbmRleE5hbWUsXG4gICAgICAgICAgICAgIHsgdmFsdWU6IHVuZGVmaW5lZCwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2NvcGUsIHBhcmVudFNjb3BlTmFtZSxcbiAgICAgICAgICAgICAgeyB2YWx1ZTogcGFyZW50U2NvcGUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgcmV0dXJuIHNjb3BlO1xuICAgICAgfTtcblxuICAgIGdsb2JhbC5Qb2x5bWVyRXhwcmVzc2lvbnMgPSBQb2x5bWVyRXhwcmVzc2lvbnM7XG4gICAgUG9seW1lckV4cHJlc3Npb25zLmdldEV4cHJlc3Npb24gPSBnZXRFeHByZXNzaW9uO1xufSkobW9kdWxlLmV4cG9ydHMpOyIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBudW1iZXJfdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy9udW1iZXItdXRpbHNcIik7XG5leHBvcnRzLmdldFRyYW5zZm9ybU1hdHJpeCA9IGZ1bmN0aW9uIChfYSkge1xuICAgIHZhciBwcm9wZXJ0eSA9IF9hLnByb3BlcnR5LCB2YWx1ZSA9IF9hLnZhbHVlO1xuICAgIHJldHVybiBUUkFOU0ZPUk1fTUFUUklYRVNbcHJvcGVydHldKHZhbHVlKTtcbn07XG52YXIgVFJBTlNGT1JNX01BVFJJWEVTID0ge1xuICAgIFwic2NhbGVcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB4ID0gX2EueCwgeSA9IF9hLnk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB4LCAwLCAwLFxuICAgICAgICAgICAgMCwgeSwgMCxcbiAgICAgICAgICAgIDAsIDAsIDEsXG4gICAgICAgIF07XG4gICAgfSxcbiAgICBcInRyYW5zbGF0ZVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHggPSBfYS54LCB5ID0gX2EueTtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIDEsIDAsIHgsXG4gICAgICAgICAgICAwLCAxLCB5LFxuICAgICAgICAgICAgMCwgMCwgMSxcbiAgICAgICAgXTtcbiAgICB9LFxuICAgIFwicm90YXRlXCI6IGZ1bmN0aW9uIChhbmdsZUluRGVnKSB7XG4gICAgICAgIHZhciBhbmdsZUluUmFkID0gbnVtYmVyX3V0aWxzXzEuZGVncmVlc1RvUmFkaWFucyhhbmdsZUluRGVnKTtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIE1hdGguY29zKGFuZ2xlSW5SYWQpLCAtTWF0aC5zaW4oYW5nbGVJblJhZCksIDAsXG4gICAgICAgICAgICBNYXRoLnNpbihhbmdsZUluUmFkKSwgTWF0aC5jb3MoYW5nbGVJblJhZCksIDAsXG4gICAgICAgICAgICAwLCAwLCAxLFxuICAgICAgICBdO1xuICAgIH0sXG59O1xuZXhwb3J0cy5tYXRyaXhBcnJheVRvQ3NzTWF0cml4ID0gZnVuY3Rpb24gKG0pIHsgcmV0dXJuIFtcbiAgICBtWzBdLCBtWzNdLCBtWzFdLFxuICAgIG1bNF0sIG1bMl0sIG1bNV0sXG5dOyB9O1xuZnVuY3Rpb24gbXVsdGlwbHlBZmZpbmUyZChtMSwgbTIpIHtcbiAgICByZXR1cm4gW1xuICAgICAgICBtMVswXSAqIG0yWzBdICsgbTFbMV0gKiBtMlszXSxcbiAgICAgICAgbTFbMF0gKiBtMlsxXSArIG0xWzFdICogbTJbNF0sXG4gICAgICAgIG0xWzBdICogbTJbMl0gKyBtMVsxXSAqIG0yWzVdICsgbTFbMl0sXG4gICAgICAgIG0xWzNdICogbTJbMF0gKyBtMVs0XSAqIG0yWzNdLFxuICAgICAgICBtMVszXSAqIG0yWzFdICsgbTFbNF0gKiBtMls0XSxcbiAgICAgICAgbTFbM10gKiBtMlsyXSArIG0xWzRdICogbTJbNV0gKyBtMVs1XVxuICAgIF07XG59XG5leHBvcnRzLm11bHRpcGx5QWZmaW5lMmQgPSBtdWx0aXBseUFmZmluZTJkO1xuZnVuY3Rpb24gZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXgobWF0cml4KSB7XG4gICAgdmVyaWZ5VHJhbnNmb3JtTWF0cml4KG1hdHJpeCk7XG4gICAgdmFyIF9hID0gX19zcHJlYWRBcnJheXMobWF0cml4KSwgQSA9IF9hWzBdLCBCID0gX2FbMV0sIEMgPSBfYVsyXSwgRCA9IF9hWzNdLCBFID0gX2FbNF0sIEYgPSBfYVs1XTtcbiAgICB2YXIgZGV0ZXJtaW5hbnQgPSBBICogRCAtIEIgKiBDO1xuICAgIHZhciB0cmFuc2xhdGUgPSB7IHg6IEUgfHwgMCwgeTogRiB8fCAwIH07XG4gICAgdmFyIHJvdGF0ZSA9IDA7XG4gICAgdmFyIHNjYWxlID0geyB4OiAxLCB5OiAxIH07XG4gICAgaWYgKEEgfHwgQikge1xuICAgICAgICB2YXIgUiA9IE1hdGguc3FydChBICogQSArIEIgKiBCKTtcbiAgICAgICAgcm90YXRlID0gQiA+IDAgPyBNYXRoLmFjb3MoQSAvIFIpIDogLU1hdGguYWNvcyhBIC8gUik7XG4gICAgICAgIHNjYWxlID0geyB4OiBSLCB5OiBkZXRlcm1pbmFudCAvIFIgfTtcbiAgICB9XG4gICAgZWxzZSBpZiAoQyB8fCBEKSB7XG4gICAgICAgIHZhciBSID0gTWF0aC5zcXJ0KEMgKiBDICsgRCAqIEQpO1xuICAgICAgICByb3RhdGUgPSBNYXRoLlBJIC8gMiAtIChEID4gMCA/IE1hdGguYWNvcygtQyAvIFIpIDogLU1hdGguYWNvcyhDIC8gUikpO1xuICAgICAgICBzY2FsZSA9IHsgeDogZGV0ZXJtaW5hbnQgLyBSLCB5OiBSIH07XG4gICAgfVxuICAgIHJvdGF0ZSA9IG51bWJlcl91dGlsc18xLnJhZGlhbnNUb0RlZ3JlZXMocm90YXRlKTtcbiAgICByZXR1cm4geyB0cmFuc2xhdGU6IHRyYW5zbGF0ZSwgcm90YXRlOiByb3RhdGUsIHNjYWxlOiBzY2FsZSB9O1xufVxuZXhwb3J0cy5kZWNvbXBvc2UyRFRyYW5zZm9ybU1hdHJpeCA9IGRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4O1xuZnVuY3Rpb24gdmVyaWZ5VHJhbnNmb3JtTWF0cml4KG1hdHJpeCkge1xuICAgIGlmIChtYXRyaXgubGVuZ3RoIDwgNikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUcmFuc2Zvcm0gbWF0cml4IHNob3VsZCBiZSAyeDMuXCIpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1hdHJpeC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybS9wbGF0Zm9ybVwiKTtcbnZhciBhcHBDb21tb25Nb2R1bGUgPSByZXF1aXJlKFwiLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIHF1YWxpZmllcl9tYXRjaGVyXzEgPSByZXF1aXJlKFwiLi9xdWFsaWZpZXItbWF0Y2hlclwiKTtcbnZhciBub25fYnVuZGxlX3dvcmtmbG93X2NvbXBhdF8xID0gcmVxdWlyZShcIi4vbm9uLWJ1bmRsZS13b3JrZmxvdy1jb21wYXRcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi90cmFjZVwiKTtcbnZhciBNb2R1bGVOYW1lUmVzb2x2ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZU5hbWVSZXNvbHZlcihjb250ZXh0LCBtb2R1bGVMaXN0UHJvdmlkZXIpIHtcbiAgICAgICAgaWYgKG1vZHVsZUxpc3RQcm92aWRlciA9PT0gdm9pZCAwKSB7IG1vZHVsZUxpc3RQcm92aWRlciA9IGdsb2JhbC5nZXRSZWdpc3RlcmVkTW9kdWxlczsgfVxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLm1vZHVsZUxpc3RQcm92aWRlciA9IG1vZHVsZUxpc3RQcm92aWRlcjtcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlTW9kdWxlTmFtZSA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIGtleSA9IHBhdGggKyBleHQ7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9jYWNoZVtrZXldO1xuICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucmVzb2x2ZU1vZHVsZU5hbWVJbXBsKHBhdGgsIGV4dCk7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZVtrZXldID0gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwicGF0aDogJ1wiICsgcGF0aCArIFwiJyB3aXRoIGV4dDogJ1wiICsgZXh0ICsgXCInIHJlc29sdmVkOiAnXCIgKyByZXN1bHQgKyBcIidcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLk1vZHVsZU5hbWVSZXNvbHZlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE1vZHVsZU5hbWVSZXNvbHZlci5wcm90b3R5cGUuY2xlYXJDYWNoZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9O1xuICAgIE1vZHVsZU5hbWVSZXNvbHZlci5wcm90b3R5cGUucmVzb2x2ZU1vZHVsZU5hbWVJbXBsID0gZnVuY3Rpb24gKHBhdGgsIGV4dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgZXh0ID0gZXh0ID8gXCIuXCIgKyBleHQgOiBcIlwiO1xuICAgICAgICBpZiAoIWdsb2JhbC5UTlNfV0VCUEFDSykge1xuICAgICAgICAgICAgbm9uX2J1bmRsZV93b3JrZmxvd19jb21wYXRfMS5yZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbShwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2FuZGlkYXRlcyA9IHRoaXMuZ2V0Q2FuZGlkYXRlcyhwYXRoLCBleHQpO1xuICAgICAgICByZXN1bHQgPSBxdWFsaWZpZXJfbWF0Y2hlcl8xLmZpbmRNYXRjaChwYXRoLCBleHQsIGNhbmRpZGF0ZXMsIHRoaXMuY29udGV4dCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLmdldENhbmRpZGF0ZXMgPSBmdW5jdGlvbiAocGF0aCwgZXh0KSB7XG4gICAgICAgIHZhciBjYW5kaWRhdGVzID0gdGhpcy5tb2R1bGVMaXN0UHJvdmlkZXIoKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAobW9kdWxlTmFtZSkgeyByZXR1cm4gbW9kdWxlTmFtZS5zdGFydHNXaXRoKHBhdGgpICYmICghZXh0IHx8IG1vZHVsZU5hbWUuZW5kc1dpdGgoZXh0KSk7IH0pO1xuICAgICAgICByZXR1cm4gY2FuZGlkYXRlcztcbiAgICB9O1xuICAgIHJldHVybiBNb2R1bGVOYW1lUmVzb2x2ZXI7XG59KCkpO1xuZXhwb3J0cy5Nb2R1bGVOYW1lUmVzb2x2ZXIgPSBNb2R1bGVOYW1lUmVzb2x2ZXI7XG52YXIgcmVzb2x2ZXJJbnN0YW5jZTtcbmZ1bmN0aW9uIHJlc29sdmVNb2R1bGVOYW1lKHBhdGgsIGV4dCkge1xuICAgIGlmIChnbG9iYWwuX19zbmFwc2hvdCkge1xuICAgICAgICByZXR1cm4gcmVzb2x2ZU1vZHVsZVNuYXBzaG90KHBhdGgsIGV4dCk7XG4gICAgfVxuICAgIGlmICghcmVzb2x2ZXJJbnN0YW5jZSkge1xuICAgICAgICByZXNvbHZlckluc3RhbmNlID0gbmV3IE1vZHVsZU5hbWVSZXNvbHZlcih7XG4gICAgICAgICAgICB3aWR0aDogcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbi53aWR0aERJUHMsXG4gICAgICAgICAgICBoZWlnaHQ6IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4uaGVpZ2h0RElQcyxcbiAgICAgICAgICAgIG9zOiBwbGF0Zm9ybV8xLmRldmljZS5vcyxcbiAgICAgICAgICAgIGRldmljZVR5cGU6IHBsYXRmb3JtXzEuZGV2aWNlLmRldmljZVR5cGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXNvbHZlckluc3RhbmNlLnJlc29sdmVNb2R1bGVOYW1lKHBhdGgsIGV4dCk7XG59XG5leHBvcnRzLnJlc29sdmVNb2R1bGVOYW1lID0gcmVzb2x2ZU1vZHVsZU5hbWU7XG5mdW5jdGlvbiByZXNvbHZlTW9kdWxlU25hcHNob3QocGF0aCwgZXh0KSB7XG4gICAgdHJhY2VfMS53cml0ZShcIlJlc29sdmluZyBtb2R1bGUgaW4gU05BUFNIT1QgY29udGV4dCAtIHBhdGg6ICdcIiArIHBhdGggKyBcIicgd2l0aCBleHQ6ICdcIiArIGV4dCArIFwiJ1wiLCB0cmFjZV8xLmNhdGVnb3JpZXMuTW9kdWxlTmFtZVJlc29sdmVyKTtcbiAgICByZXR1cm4gbmV3IE1vZHVsZU5hbWVSZXNvbHZlcih7XG4gICAgICAgIHdpZHRoOiA0MDAsXG4gICAgICAgIGhlaWdodDogODAwLFxuICAgICAgICBvczogXCJBbmRyb2lkXCIsXG4gICAgICAgIGRldmljZVR5cGU6IFwiUGhvbmVcIlxuICAgIH0pLnJlc29sdmVNb2R1bGVOYW1lKHBhdGgsIGV4dCk7XG59XG5mdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICAgIGlmIChyZXNvbHZlckluc3RhbmNlKSB7XG4gICAgICAgIHJlc29sdmVySW5zdGFuY2UuY2xlYXJDYWNoZSgpO1xuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJDYWNoZSA9IGNsZWFyQ2FjaGU7XG5mdW5jdGlvbiBfc2V0UmVzb2x2ZXIocmVzb2x2ZXIpIHtcbiAgICByZXNvbHZlckluc3RhbmNlID0gcmVzb2x2ZXI7XG59XG5leHBvcnRzLl9zZXRSZXNvbHZlciA9IF9zZXRSZXNvbHZlcjtcbmFwcENvbW1vbk1vZHVsZS5vbihcImxpdmVzeW5jXCIsIGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBjbGVhckNhY2hlKCk7IH0pO1xuYXBwQ29tbW9uTW9kdWxlLm9uKFwib3JpZW50YXRpb25DaGFuZ2VkXCIsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgcmVzb2x2ZXJJbnN0YW5jZSA9IHVuZGVmaW5lZDtcbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLW5hbWUtcmVzb2x2ZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZzID0gcmVxdWlyZShcIi4uL2ZpbGUtc3lzdGVtL2ZpbGUtc3lzdGVtXCIpO1xudmFyIGFwcENvbW1vbk1vZHVsZSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi90cmFjZVwiKTtcbnZhciBjYWNoZSA9IG5ldyBTZXQoKTtcbnZhciBpbml0aWFsaXplZCA9IGZhbHNlO1xuZnVuY3Rpb24gcmVnaXN0ZXIobmFtZSwgbG9hZGVyKSB7XG4gICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgdHJhY2VfMS53cml0ZShcIltDb21wYXRdIFJlZ2lzdGVyIG1vZHVsZTogXCIgKyBuYW1lLCB0cmFjZV8xLmNhdGVnb3JpZXMuTW9kdWxlTmFtZVJlc29sdmVyKTtcbiAgICB9XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKG5hbWUsIGxvYWRlcik7XG4gICAgaWYgKG5hbWUuc3RhcnRzV2l0aChcInRuc19tb2R1bGVzXCIpKSB7XG4gICAgICAgIHZhciBub25UbnNNb2R1bGVzTmFtZSA9IG5hbWUuc3Vic3RyKFwidG5zX21vZHVsZXNcIi5sZW5ndGggKyAxKTtcbiAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJbQ29tcGF0XSBSZWdpc3RlciBtb2R1bGU6IFwiICsgbm9uVG5zTW9kdWxlc05hbWUsIHRyYWNlXzEuY2F0ZWdvcmllcy5Nb2R1bGVOYW1lUmVzb2x2ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShub25UbnNNb2R1bGVzTmFtZSwgbG9hZGVyKTtcbiAgICB9XG59XG5mdW5jdGlvbiBwcm9jZXNzRmlsZShmaWxlKSB7XG4gICAgdmFyIGZpbGVQYXRoUmVsYXRpdmVUb0FwcCA9IGZpbGUucGF0aC5zdWJzdHIoZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLmxlbmd0aCArIDEpO1xuICAgIHZhciBsb2FkQ29udGVudCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZpbGUucmVhZFRleHRTeW5jKCk7IH07XG4gICAgc3dpdGNoIChmaWxlLmV4dGVuc2lvbi50b0xvY2FsZUxvd2VyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgXCIuanNcIjpcbiAgICAgICAgICAgIHZhciBub0V4dFBhdGggPSBmaWxlUGF0aFJlbGF0aXZlVG9BcHAuc3Vic3RyKDAsIGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5sZW5ndGggLSBcIi5qc1wiLmxlbmd0aCk7XG4gICAgICAgICAgICByZWdpc3RlcihmaWxlUGF0aFJlbGF0aXZlVG9BcHAsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7IH0pO1xuICAgICAgICAgICAgcmVnaXN0ZXIobm9FeHRQYXRoLCBmdW5jdGlvbiAoKSB7IHJldHVybiBnbG9iYWwucmVxdWlyZShmaWxlLnBhdGgpOyB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiLmNzc1wiOlxuICAgICAgICAgICAgcmVnaXN0ZXIoZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLCBsb2FkQ29udGVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIi54bWxcIjpcbiAgICAgICAgICAgIHJlZ2lzdGVyKGZpbGVQYXRoUmVsYXRpdmVUb0FwcCwgbG9hZENvbnRlbnQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmIChmaWxlLm5hbWUgPT09IFwicGFja2FnZS5qc29uXCIpIHtcbiAgICAgICAgdmFyIGpzb24gPSBnbG9iYWwucmVxdWlyZShmaWxlLnBhdGgpO1xuICAgICAgICBpZiAoanNvbi5tYWluKSB7XG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLnN1YnN0cigwLCBmaWxlUGF0aFJlbGF0aXZlVG9BcHAubGVuZ3RoIC0gXCJwYWNrYWdlLmpzb25cIi5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgIHZhciByZXF1aXJlUGF0aF8xID0gZnMucGF0aC5qb2luKGZpbGUucGFyZW50LnBhdGgsIGpzb24ubWFpbik7XG4gICAgICAgICAgICByZWdpc3RlcihuYW1lXzEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKHJlcXVpcmVQYXRoXzEpOyB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHByb2Nlc3NGb2xkZXIocGF0aCkge1xuICAgIGlmIChjYWNoZS5oYXMocGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNhY2hlLmFkZChwYXRoKTtcbiAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiW0NvbXBhdF0gUHJvY2Vzc2luZyBmb2xkZXI6IFwiICsgcGF0aCwgdHJhY2VfMS5jYXRlZ29yaWVzLk1vZHVsZU5hbWVSZXNvbHZlcik7XG4gICAgfVxuICAgIHZhciBmb2xkZXJFbXB0eSA9IHRydWU7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHMocGF0aCkpIHtcbiAgICAgICAgdmFyIGZvbGRlciA9IGZzLkZvbGRlci5mcm9tUGF0aChwYXRoKTtcbiAgICAgICAgZm9sZGVyLmVhY2hFbnRpdHkoZnVuY3Rpb24gKGZpbGUpIHtcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgZnMuRmlsZSkge1xuICAgICAgICAgICAgICAgIHByb2Nlc3NGaWxlKGZpbGUpO1xuICAgICAgICAgICAgICAgIGZvbGRlckVtcHR5ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiAhZm9sZGVyRW1wdHk7XG59XG5mdW5jdGlvbiByZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbShtb2R1bGVOYW1lKSB7XG4gICAgaW5pdGlhbGl6ZSgpO1xuICAgIHZhciBmb2xkZXJQcm9jZXNzZWQgPSBmYWxzZTtcbiAgICB2YXIgcGFyZW50Rm9sZGVyUHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgdmFyIHBhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBtb2R1bGVOYW1lKTtcbiAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyhwYXRoKSkge1xuICAgICAgICBmb2xkZXJQcm9jZXNzZWQgPSBwcm9jZXNzRm9sZGVyKHBhdGgpO1xuICAgIH1cbiAgICB2YXIgcGFyZW50TmFtZSA9IG1vZHVsZU5hbWUuc3Vic3RyKDAsIG1vZHVsZU5hbWUubGFzdEluZGV4T2YoZnMucGF0aC5zZXBhcmF0b3IpKTtcbiAgICB2YXIgcGFyZW50Rm9sZGVyUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIHBhcmVudE5hbWUpO1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHBhcmVudEZvbGRlclBhdGgpKSB7XG4gICAgICAgIHBhcmVudEZvbGRlclByb2Nlc3NlZCA9IHByb2Nlc3NGb2xkZXIocGFyZW50Rm9sZGVyUGF0aCk7XG4gICAgfVxuICAgIGlmIChmb2xkZXJQcm9jZXNzZWQgfHwgKHBhcmVudEZvbGRlclByb2Nlc3NlZCAmJiBwYXJlbnROYW1lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0bnNNb2R1bGVzUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIFwidG5zX21vZHVsZXNcIiwgbW9kdWxlTmFtZSk7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHModG5zTW9kdWxlc1BhdGgpKSB7XG4gICAgICAgIHByb2Nlc3NGb2xkZXIodG5zTW9kdWxlc1BhdGgpO1xuICAgIH1cbiAgICBpZiAocGFyZW50TmFtZSkge1xuICAgICAgICB2YXIgdG5zUGFyZW50Rm9sZGVyUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIFwidG5zX21vZHVsZXNcIiwgcGFyZW50TmFtZSk7XG4gICAgICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHRuc1BhcmVudEZvbGRlclBhdGgpKSB7XG4gICAgICAgICAgICBwcm9jZXNzRm9sZGVyKHRuc1BhcmVudEZvbGRlclBhdGgpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5yZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbSA9IHJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICBpZiAoIWluaXRpYWxpemVkKSB7XG4gICAgICAgIGFwcENvbW1vbk1vZHVsZS5vbihcImxpdmVzeW5jXCIsIGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBjYWNoZS5jbGVhcigpOyB9KTtcbiAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBNSU5fV0ggPSBcIm1pbldIXCI7XG52YXIgTUlOX1cgPSBcIm1pbldcIjtcbnZhciBNSU5fSCA9IFwibWluSFwiO1xudmFyIFBSSU9SSVRZX1NURVAgPSAxMDAwMDtcbnZhciBtaW5XaWR0aEhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA9PT0gMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsTGVuZ3RoID0gTWF0aC5taW4oY29udGV4dC53aWR0aCwgY29udGV4dC5oZWlnaHQpO1xuICAgICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgbnVtVmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBSSU9SSVRZX1NURVAgLSAoYWN0dWFsTGVuZ3RoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbldpZHRoUXVhbGlmaWVyID0ge1xuICAgIGlzTWF0Y2g6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5kZXhPZihNSU5fVykgPT09IDAgJiYgdmFsdWUuaW5kZXhPZihNSU5fV0gpIDwgMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XLmxlbmd0aCkpO1xuICAgICAgICBpZiAoaXNOYU4obnVtVmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhY3R1YWxXaWR0aCA9IGNvbnRleHQud2lkdGg7XG4gICAgICAgIGlmIChhY3R1YWxXaWR0aCA8IG51bVZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQUklPUklUWV9TVEVQIC0gKGFjdHVhbFdpZHRoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbkhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX0gpID09PSAwICYmIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA8IDA7XG4gICAgfSxcbiAgICBnZXRNYXRjaFZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcbiAgICAgICAgdmFyIG51bVZhbCA9IHBhcnNlSW50KHZhbHVlLnN1YnN0cihNSU5fSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsSGVpZ2h0ID0gY29udGV4dC5oZWlnaHQ7XG4gICAgICAgIGlmIChhY3R1YWxIZWlnaHQgPCBudW1WYWwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUFJJT1JJVFlfU1RFUCAtIChhY3R1YWxIZWlnaHQgLSBudW1WYWwpO1xuICAgIH1cbn07XG52YXIgcGxhdGZvcm1RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJhbmRyb2lkXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcImlvc1wiO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gY29udGV4dC5vcy50b0xvd2VyQ2FzZSgpID8gMSA6IC0xO1xuICAgIH1cbn07XG52YXIgb3JpZW50YXRpb25RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJsYW5kXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcInBvcnRcIjtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgaXNMYW5kc2NhcGUgPSAoY29udGV4dC53aWR0aCA+IGNvbnRleHQuaGVpZ2h0KSA/IDEgOiAtMTtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSA9PT0gXCJsYW5kXCIpID8gaXNMYW5kc2NhcGUgOiAtaXNMYW5kc2NhcGU7XG4gICAgfVxufTtcbnZhciBzdXBwb3J0ZWRRdWFsaWZpZXJzID0gW1xuICAgIG1pbldpZHRoSGVpZ2h0UXVhbGlmaWVyLFxuICAgIG1pbldpZHRoUXVhbGlmaWVyLFxuICAgIG1pbkhlaWdodFF1YWxpZmllcixcbiAgICBvcmllbnRhdGlvblF1YWxpZmllcixcbiAgICBwbGF0Zm9ybVF1YWxpZmllclxuXTtcbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVycyhxdWFsaWZpZXJzLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgdmFyIHZhbHVlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVhbGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocXVhbGlmaWVyc1tpXSkge1xuICAgICAgICAgICAgdmFsdWUgPSBjaGVja1F1YWxpZmllcihxdWFsaWZpZXJzW2ldLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgKz0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVyKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1cHBvcnRlZFF1YWxpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uaXNNYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uZ2V0TWF0Y2hWYWx1ZSh2YWx1ZSwgY29udGV4dCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAoc3VwcG9ydGVkUXVhbGlmaWVycy5sZW5ndGggLSBpKSAqIFBSSU9SSVRZX1NURVA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGZpbmRNYXRjaChwYXRoLCBleHQsIGNhbmRpZGF0ZXMsIGNvbnRleHQpIHtcbiAgICB2YXIgYmVzdFZhbHVlID0gLTE7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBmaWxlUGF0aCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIHZhciBxdWFsaWZpZXJzU3RyID0gZmlsZVBhdGguc3Vic3RyKHBhdGgubGVuZ3RoLCBmaWxlUGF0aC5sZW5ndGggLSBwYXRoLmxlbmd0aCAtIChleHQgPyBleHQubGVuZ3RoIDogMCkpO1xuICAgICAgICB2YXIgcXVhbGlmaWVycyA9IHF1YWxpZmllcnNTdHIuc3BsaXQoXCIuXCIpO1xuICAgICAgICB2YXIgdmFsdWUgPSBjaGVja1F1YWxpZmllcnMocXVhbGlmaWVycywgY29udGV4dCk7XG4gICAgICAgIGlmICh2YWx1ZSA+PSAwICYmIHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZmluZE1hdGNoID0gZmluZE1hdGNoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVhbGlmaWVyLW1hdGNoZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFwcE1vZHVsZSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvblwiKTtcbnZhciBNSU5fVEFCTEVUX1BJWEVMUyA9IDYwMDtcbnZhciBwbGF0Zm9ybU5hbWVzO1xuKGZ1bmN0aW9uIChwbGF0Zm9ybU5hbWVzKSB7XG4gICAgcGxhdGZvcm1OYW1lcy5hbmRyb2lkID0gXCJBbmRyb2lkXCI7XG4gICAgcGxhdGZvcm1OYW1lcy5pb3MgPSBcImlPU1wiO1xufSkocGxhdGZvcm1OYW1lcyA9IGV4cG9ydHMucGxhdGZvcm1OYW1lcyB8fCAoZXhwb3J0cy5wbGF0Zm9ybU5hbWVzID0ge30pKTtcbnZhciBEZXZpY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERldmljZSgpIHtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwibWFudWZhY3R1cmVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX21hbnVmYWN0dXJlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX21hbnVmYWN0dXJlciA9IGFuZHJvaWQub3MuQnVpbGQuTUFOVUZBQ1RVUkVSO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hbnVmYWN0dXJlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwib3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwbGF0Zm9ybU5hbWVzLmFuZHJvaWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm9zVmVyc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vc1ZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vc1ZlcnNpb24gPSBhbmRyb2lkLm9zLkJ1aWxkLlZFUlNJT04uUkVMRUFTRTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vc1ZlcnNpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX21vZGVsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwgPSBhbmRyb2lkLm9zLkJ1aWxkLk1PREVMO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZGVsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJzZGtWZXJzaW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3Nka1ZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZGtWZXJzaW9uID0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNESztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZGtWZXJzaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJkZXZpY2VUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RldmljZVR5cGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlwcyA9IE1hdGgubWluKHNjcmVlbi5tYWluU2NyZWVuLndpZHRoUGl4ZWxzLCBzY3JlZW4ubWFpblNjcmVlbi5oZWlnaHRQaXhlbHMpIC8gc2NyZWVuLm1haW5TY3JlZW4uc2NhbGU7XG4gICAgICAgICAgICAgICAgaWYgKGRpcHMgPj0gTUlOX1RBQkxFVF9QSVhFTFMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGV2aWNlVHlwZSA9IFwiVGFibGV0XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXZpY2VUeXBlID0gXCJQaG9uZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZXZpY2VUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJ1dWlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3V1aWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmF0aXZlQXBwID0gYXBwTW9kdWxlLmFuZHJvaWQubmF0aXZlQXBwO1xuICAgICAgICAgICAgICAgIHRoaXMuX3V1aWQgPSBhbmRyb2lkLnByb3ZpZGVyLlNldHRpbmdzLlNlY3VyZS5nZXRTdHJpbmcobmF0aXZlQXBwLmdldENvbnRlbnRSZXNvbHZlcigpLCBhbmRyb2lkLnByb3ZpZGVyLlNldHRpbmdzLlNlY3VyZS5BTkRST0lEX0lEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91dWlkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJsYW5ndWFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9sYW5ndWFnZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhbmd1YWdlID0gamF2YS51dGlsLkxvY2FsZS5nZXREZWZhdWx0KCkuZ2V0TGFuZ3VhZ2UoKS5yZXBsYWNlKFwiX1wiLCBcIi1cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGFuZ3VhZ2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcInJlZ2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9yZWdpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWdpb24gPSBqYXZhLnV0aWwuTG9jYWxlLmdldERlZmF1bHQoKS5nZXRDb3VudHJ5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVnaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gRGV2aWNlO1xufSgpKTtcbnZhciBNYWluU2NyZWVuID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNYWluU2NyZWVuKCkge1xuICAgIH1cbiAgICBNYWluU2NyZWVuLnByb3RvdHlwZS5yZWluaXRNZXRyaWNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX21ldHJpY3MpIHtcbiAgICAgICAgICAgIHRoaXMuX21ldHJpY3MgPSBuZXcgYW5kcm9pZC51dGlsLkRpc3BsYXlNZXRyaWNzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0TWV0cmljcygpO1xuICAgIH07XG4gICAgTWFpblNjcmVlbi5wcm90b3R5cGUuaW5pdE1ldHJpY3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVBcHAgPSBhcHBNb2R1bGUuZ2V0TmF0aXZlQXBwbGljYXRpb24oKTtcbiAgICAgICAgbmF0aXZlQXBwLmdldFN5c3RlbVNlcnZpY2UoYW5kcm9pZC5jb250ZW50LkNvbnRleHQuV0lORE9XX1NFUlZJQ0UpLmdldERlZmF1bHREaXNwbGF5KCkuZ2V0UmVhbE1ldHJpY3ModGhpcy5fbWV0cmljcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwibWV0cmljc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9tZXRyaWNzKSB7XG4gICAgICAgICAgICAgICAgYXBwTW9kdWxlLm9uKFwiY3NzQ2hhbmdlZFwiLCB0aGlzLnJlaW5pdE1ldHJpY3MsIHRoaXMpO1xuICAgICAgICAgICAgICAgIGFwcE1vZHVsZS5vbihhcHBNb2R1bGUub3JpZW50YXRpb25DaGFuZ2VkRXZlbnQsIHRoaXMucmVpbml0TWV0cmljcywgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0cmljcyA9IG5ldyBhbmRyb2lkLnV0aWwuRGlzcGxheU1ldHJpY3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRNZXRyaWNzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWV0cmljcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcIndpZHRoUGl4ZWxzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXRyaWNzLndpZHRoUGl4ZWxzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwiaGVpZ2h0UGl4ZWxzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXRyaWNzLmhlaWdodFBpeGVscztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcInNjYWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZXRyaWNzLmRlbnNpdHk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYWluU2NyZWVuLnByb3RvdHlwZSwgXCJ3aWR0aERJUHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1ldHJpY3Mud2lkdGhQaXhlbHMgLyB0aGlzLm1ldHJpY3MuZGVuc2l0eTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcImhlaWdodERJUHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1ldHJpY3MuaGVpZ2h0UGl4ZWxzIC8gdGhpcy5tZXRyaWNzLmRlbnNpdHk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBNYWluU2NyZWVuO1xufSgpKTtcbmV4cG9ydHMuZGV2aWNlID0gbmV3IERldmljZSgpO1xudmFyIHNjcmVlbjtcbihmdW5jdGlvbiAoc2NyZWVuKSB7XG4gICAgc2NyZWVuLm1haW5TY3JlZW4gPSBuZXcgTWFpblNjcmVlbigpO1xufSkoc2NyZWVuID0gZXhwb3J0cy5zY3JlZW4gfHwgKGV4cG9ydHMuc2NyZWVuID0ge30pKTtcbmV4cG9ydHMuaXNBbmRyb2lkID0gdHJ1ZTtcbmV4cG9ydHMuaXNJT1MgPSBmYWxzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBsYXRmb3JtLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gdXB0aW1lKCkge1xuICAgIHJldHVybiBnbG9iYWwuYW5kcm9pZCA/IG9yZy5uYXRpdmVzY3JpcHQuUHJvY2Vzcy5nZXRVcFRpbWUoKSA6IGdsb2JhbC5fX3Ruc191cHRpbWUoKTtcbn1cbmV4cG9ydHMudXB0aW1lID0gdXB0aW1lO1xuZnVuY3Rpb24gbG9nKG1lc3NhZ2UpIHtcbiAgICBpZiAoZ2xvYmFsLl9fbnNsb2cpIHtcbiAgICAgICAgZ2xvYmFsLl9fbnNsb2coXCJDT05TT0xFIExPRzogXCIgKyBtZXNzYWdlKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG59XG5leHBvcnRzLmxvZyA9IGxvZztcbnZhciB0aW1lcnMgPSB7fTtcbnZhciBhbnlHbG9iYWwgPSBnbG9iYWw7XG52YXIgcHJvZmlsZU5hbWVzID0gW107XG5leHBvcnRzLnRpbWUgPSBnbG9iYWwuX190aW1lIHx8IERhdGUubm93O1xuZnVuY3Rpb24gc3RhcnQobmFtZSkge1xuICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgIGlmIChpbmZvKSB7XG4gICAgICAgIGluZm8uY3VycmVudFN0YXJ0ID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgIGluZm8ucnVuQ291bnQrKztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGluZm8gPSB7XG4gICAgICAgICAgICB0b3RhbFRpbWU6IDAsXG4gICAgICAgICAgICBjb3VudDogMCxcbiAgICAgICAgICAgIGN1cnJlbnRTdGFydDogZXhwb3J0cy50aW1lKCksXG4gICAgICAgICAgICBydW5Db3VudDogMVxuICAgICAgICB9O1xuICAgICAgICB0aW1lcnNbbmFtZV0gPSBpbmZvO1xuICAgICAgICBwcm9maWxlTmFtZXMucHVzaChuYW1lKTtcbiAgICB9XG59XG5leHBvcnRzLnN0YXJ0ID0gc3RhcnQ7XG5mdW5jdGlvbiBzdG9wKG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGltZXIgc3RhcnRlZDogXCIgKyBuYW1lKTtcbiAgICB9XG4gICAgaWYgKGluZm8ucnVuQ291bnQpIHtcbiAgICAgICAgaW5mby5ydW5Db3VudC0tO1xuICAgICAgICBpZiAoaW5mby5ydW5Db3VudCkge1xuICAgICAgICAgICAgaW5mby5jb3VudCsrO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW5mby5sYXN0VGltZSA9IGV4cG9ydHMudGltZSgpIC0gaW5mby5jdXJyZW50U3RhcnQ7XG4gICAgICAgICAgICBpbmZvLnRvdGFsVGltZSArPSBpbmZvLmxhc3RUaW1lO1xuICAgICAgICAgICAgaW5mby5jb3VudCsrO1xuICAgICAgICAgICAgaW5mby5jdXJyZW50U3RhcnQgPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaW1lciBcIiArIG5hbWUgKyBcIiBwYXVzZWQgbW9yZSB0aW1lcyB0aGFuIHN0YXJ0ZWQuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gaW5mbztcbn1cbmV4cG9ydHMuc3RvcCA9IHN0b3A7XG5mdW5jdGlvbiB0aW1lcihuYW1lKSB7XG4gICAgcmV0dXJuIHRpbWVyc1tuYW1lXTtcbn1cbmV4cG9ydHMudGltZXIgPSB0aW1lcjtcbmZ1bmN0aW9uIHByaW50KG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICBpZiAoIWluZm8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGltZXIgc3RhcnRlZDogXCIgKyBuYW1lKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCItLS0tIFtcIiArIG5hbWUgKyBcIl0gU1RPUCB0b3RhbDogXCIgKyBpbmZvLnRvdGFsVGltZSArIFwiIGNvdW50OlwiICsgaW5mby5jb3VudCk7XG4gICAgcmV0dXJuIGluZm87XG59XG5leHBvcnRzLnByaW50ID0gcHJpbnQ7XG5mdW5jdGlvbiBpc1J1bm5pbmcobmFtZSkge1xuICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgIHJldHVybiAhIShpbmZvICYmIGluZm8ucnVuQ291bnQpO1xufVxuZXhwb3J0cy5pc1J1bm5pbmcgPSBpc1J1bm5pbmc7XG5mdW5jdGlvbiBjb3VudGVyc1Byb2ZpbGVGdW5jdGlvbkZhY3RvcnkoZm4sIG5hbWUsIHR5cGUpIHtcbiAgICBpZiAodHlwZSA9PT0gdm9pZCAwKSB7IHR5cGUgPSAxOyB9XG4gICAgcHJvZmlsZU5hbWVzLnB1c2gobmFtZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3RhcnQobmFtZSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHN0b3AobmFtZSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gdGltZWxpbmVQcm9maWxlRnVuY3Rpb25GYWN0b3J5KGZuLCBuYW1lLCB0eXBlKSB7XG4gICAgaWYgKHR5cGUgPT09IHZvaWQgMCkgeyB0eXBlID0gMTsgfVxuICAgIHJldHVybiB0eXBlID09PSAxID8gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdmFyIGVuZCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lbGluZTogTW9kdWxlczogXCIgKyBuYW1lICsgXCIgXCIgKyB0aGlzICsgXCIgIChcIiArIHN0YXJ0ICsgXCJtcy4gLSBcIiArIGVuZCArIFwibXMuKVwiKTtcbiAgICAgICAgfVxuICAgIH0gOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB2YXIgZW5kID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRpbWVsaW5lOiBNb2R1bGVzOiBcIiArIG5hbWUgKyBcIiAgKFwiICsgc3RhcnQgKyBcIm1zLiAtIFwiICsgZW5kICsgXCJtcy4pXCIpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbnZhciBMZXZlbDtcbihmdW5jdGlvbiAoTGV2ZWwpIHtcbiAgICBMZXZlbFtMZXZlbFtcIm5vbmVcIl0gPSAwXSA9IFwibm9uZVwiO1xuICAgIExldmVsW0xldmVsW1wibGlmZWN5Y2xlXCJdID0gMV0gPSBcImxpZmVjeWNsZVwiO1xuICAgIExldmVsW0xldmVsW1widGltZWxpbmVcIl0gPSAyXSA9IFwidGltZWxpbmVcIjtcbn0pKExldmVsID0gZXhwb3J0cy5MZXZlbCB8fCAoZXhwb3J0cy5MZXZlbCA9IHt9KSk7XG52YXIgdHJhY2luZ0xldmVsID0gTGV2ZWwubm9uZTtcbnZhciBwcm9maWxlRnVuY3Rpb25GYWN0b3J5O1xuZnVuY3Rpb24gZW5hYmxlKG1vZGUpIHtcbiAgICBpZiAobW9kZSA9PT0gdm9pZCAwKSB7IG1vZGUgPSBcImNvdW50ZXJzXCI7IH1cbiAgICBwcm9maWxlRnVuY3Rpb25GYWN0b3J5ID0gbW9kZSAmJiB7XG4gICAgICAgIGNvdW50ZXJzOiBjb3VudGVyc1Byb2ZpbGVGdW5jdGlvbkZhY3RvcnksXG4gICAgICAgIHRpbWVsaW5lOiB0aW1lbGluZVByb2ZpbGVGdW5jdGlvbkZhY3RvcnlcbiAgICB9W21vZGVdO1xuICAgIHRyYWNpbmdMZXZlbCA9IHtcbiAgICAgICAgbGlmZWN5Y2xlOiBMZXZlbC5saWZlY3ljbGUsXG4gICAgICAgIHRpbWVsaW5lOiBMZXZlbC50aW1lbGluZSxcbiAgICB9W21vZGVdIHx8IExldmVsLm5vbmU7XG59XG5leHBvcnRzLmVuYWJsZSA9IGVuYWJsZTtcbnRyeSB7XG4gICAgdmFyIGFwcENvbmZpZyA9IHJlcXVpcmUoXCJ+L3BhY2thZ2UuanNvblwiKTtcbiAgICBpZiAoYXBwQ29uZmlnICYmIGFwcENvbmZpZy5wcm9maWxpbmcpIHtcbiAgICAgICAgZW5hYmxlKGFwcENvbmZpZy5wcm9maWxpbmcpO1xuICAgIH1cbn1cbmNhdGNoIChlMSkge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUHJvZmlsaW5nIHN0YXJ0dXAgZmFpbGVkIHRvIGZpZ3VyZSBvdXQgZGVmYXVsdHMgZnJvbSBwYWNrYWdlLmpzb24sIGVycm9yOiBcIiArIGUxKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUyKSB7XG4gICAgfVxufVxuZnVuY3Rpb24gZGlzYWJsZSgpIHtcbiAgICBwcm9maWxlRnVuY3Rpb25GYWN0b3J5ID0gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5kaXNhYmxlID0gZGlzYWJsZTtcbmZ1bmN0aW9uIHByb2ZpbGVGdW5jdGlvbihmbiwgY3VzdG9tTmFtZSkge1xuICAgIHJldHVybiBwcm9maWxlRnVuY3Rpb25GYWN0b3J5KGZuLCBjdXN0b21OYW1lIHx8IGZuLm5hbWUpO1xufVxudmFyIHByb2ZpbGVNZXRob2RVbm5hbWVkID0gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSk7XG4gICAgfVxuICAgIHZhciBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgdmFyIGNsYXNzTmFtZSA9IFwiXCI7XG4gICAgaWYgKHRhcmdldCAmJiB0YXJnZXQuY29uc3RydWN0b3IgJiYgdGFyZ2V0LmNvbnN0cnVjdG9yLm5hbWUpIHtcbiAgICAgICAgY2xhc3NOYW1lID0gdGFyZ2V0LmNvbnN0cnVjdG9yLm5hbWUgKyBcIi5cIjtcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBjbGFzc05hbWUgKyBrZXk7XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnkob3JpZ2luYWxNZXRob2QsIG5hbWUsIDEpO1xuICAgIHJldHVybiBkZXNjcmlwdG9yO1xufTtcbnZhciBwcm9maWxlU3RhdGljTWV0aG9kVW5uYW1lZCA9IGZ1bmN0aW9uIChjdG9yLCBrZXksIGRlc2NyaXB0b3IpIHtcbiAgICBpZiAoZGVzY3JpcHRvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGN0b3IsIGtleSk7XG4gICAgfVxuICAgIHZhciBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgdmFyIGNsYXNzTmFtZSA9IFwiXCI7XG4gICAgaWYgKGN0b3IgJiYgY3Rvci5uYW1lKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IGN0b3IubmFtZSArIFwiLlwiO1xuICAgIH1cbiAgICB2YXIgbmFtZSA9IGNsYXNzTmFtZSArIGtleTtcbiAgICBkZXNjcmlwdG9yLnZhbHVlID0gcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShvcmlnaW5hbE1ldGhvZCwgbmFtZSwgMCk7XG4gICAgcmV0dXJuIGRlc2NyaXB0b3I7XG59O1xuZnVuY3Rpb24gcHJvZmlsZU1ldGhvZE5hbWVkKG5hbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIGlmIChkZXNjcmlwdG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShvcmlnaW5hbE1ldGhvZCwgbmFtZSk7XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH07XG59XG52YXIgdm9pZE1ldGhvZERlY29yYXRvciA9IGZ1bmN0aW9uICgpIHtcbn07XG5mdW5jdGlvbiBwcm9maWxlKG5hbWVGbk9yVGFyZ2V0LCBmbk9yS2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJvYmplY3RcIiAmJiAodHlwZW9mIGZuT3JLZXkgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGZuT3JLZXkgPT09IFwic3ltYm9sXCIpKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlTWV0aG9kVW5uYW1lZChuYW1lRm5PclRhcmdldCwgZm5PcktleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJmdW5jdGlvblwiICYmICh0eXBlb2YgZm5PcktleSA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgZm5PcktleSA9PT0gXCJzeW1ib2xcIikpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVTdGF0aWNNZXRob2RVbm5hbWVkKG5hbWVGbk9yVGFyZ2V0LCBmbk9yS2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIG5hbWVGbk9yVGFyZ2V0ID09PSBcInN0cmluZ1wiICYmIHR5cGVvZiBmbk9yS2V5ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gZm5PcktleTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZUZ1bmN0aW9uKGZuT3JLZXksIG5hbWVGbk9yVGFyZ2V0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIG5hbWVGbk9yVGFyZ2V0ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gbmFtZUZuT3JUYXJnZXQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVGdW5jdGlvbihuYW1lRm5PclRhcmdldCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybiB2b2lkTWV0aG9kRGVjb3JhdG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlTWV0aG9kTmFtZWQobmFtZUZuT3JUYXJnZXQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gdm9pZE1ldGhvZERlY29yYXRvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZU1ldGhvZFVubmFtZWQ7XG4gICAgfVxufVxuZXhwb3J0cy5wcm9maWxlID0gcHJvZmlsZTtcbmZ1bmN0aW9uIGR1bXBQcm9maWxlcygpIHtcbiAgICBwcm9maWxlTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLSBbXCIgKyBuYW1lICsgXCJdIFNUT1AgdG90YWw6IFwiICsgaW5mby50b3RhbFRpbWUgKyBcIiBjb3VudDpcIiArIGluZm8uY291bnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tIFtcIiArIG5hbWUgKyBcIl0gTmV2ZXIgY2FsbGVkXCIpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmR1bXBQcm9maWxlcyA9IGR1bXBQcm9maWxlcztcbmZ1bmN0aW9uIHJlc2V0UHJvZmlsZXMoKSB7XG4gICAgcHJvZmlsZU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICBpZiAoaW5mby5ydW5Db3VudCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLSB0aW1lciB3aXRoIG5hbWUgW1wiICsgbmFtZSArIFwiXSBpcyBjdXJyZW50bHkgcnVubmluZyBhbmQgd29uJ3QgYmUgcmVzZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aW1lcnNbbmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMucmVzZXRQcm9maWxlcyA9IHJlc2V0UHJvZmlsZXM7XG5mdW5jdGlvbiBzdGFydENQVVByb2ZpbGUobmFtZSkge1xuICAgIGlmIChhbnlHbG9iYWwuYW5kcm9pZCkge1xuICAgICAgICBfX3N0YXJ0Q1BVUHJvZmlsZXIobmFtZSk7XG4gICAgfVxufVxuZXhwb3J0cy5zdGFydENQVVByb2ZpbGUgPSBzdGFydENQVVByb2ZpbGU7XG5mdW5jdGlvbiBzdG9wQ1BVUHJvZmlsZShuYW1lKSB7XG4gICAgaWYgKGFueUdsb2JhbC5hbmRyb2lkKSB7XG4gICAgICAgIF9fc3RvcENQVVByb2ZpbGVyKG5hbWUpO1xuICAgIH1cbn1cbmV4cG9ydHMuc3RvcENQVVByb2ZpbGUgPSBzdG9wQ1BVUHJvZmlsZTtcbmZ1bmN0aW9uIGxldmVsKCkge1xuICAgIHJldHVybiB0cmFjaW5nTGV2ZWw7XG59XG5leHBvcnRzLmxldmVsID0gbGV2ZWw7XG5mdW5jdGlvbiB0cmFjZShtZXNzYWdlLCBzdGFydCwgZW5kKSB7XG4gICAgbG9nKFwiVGltZWxpbmU6IE1vZHVsZXM6IFwiICsgbWVzc2FnZSArIFwiICAoXCIgKyBzdGFydCArIFwibXMuIC0gXCIgKyBlbmQgKyBcIm1zLilcIik7XG59XG5leHBvcnRzLnRyYWNlID0gdHJhY2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9maWxpbmcuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNwYW5fMSA9IHJlcXVpcmUoXCIuL3NwYW5cIik7XG5leHBvcnRzLlNwYW4gPSBzcGFuXzEuU3BhbjtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIG9ic2VydmFibGVfYXJyYXlfMSA9IHJlcXVpcmUoXCIuLi9kYXRhL29ic2VydmFibGUtYXJyYXlcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL3VpL2NvcmUvdmlld1wiKTtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5zcGFucyA9IFwic3BhbnNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgRm9ybWF0dGVkU3RyaW5nID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRm9ybWF0dGVkU3RyaW5nLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZvcm1hdHRlZFN0cmluZygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3NwYW5zID0gbmV3IG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkoKTtcbiAgICAgICAgX3RoaXMuX3NwYW5zLmFkZEV2ZW50TGlzdGVuZXIob2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgX3RoaXMub25TcGFuc0NvbGxlY3Rpb25DaGFuZ2VkLCBfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiZm9udEZhbWlseVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udEZhbWlseTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udEZhbWlseSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJmb250U2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U3R5bGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiZm9udFdlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFdlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFdlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJ0ZXh0RGVjb3JhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5jb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiYmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJzcGFuc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9zcGFucykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NwYW5zID0gbmV3IG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcGFucztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IHRoaXMuX3NwYW5zLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSB0aGlzLl9zcGFucy5nZXRJdGVtKGkpLnRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IGtub3duQ29sbGVjdGlvbnMuc3BhbnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3BhbnMucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc3Bhbl8xLlNwYW4pIHtcbiAgICAgICAgICAgIHRoaXMuc3BhbnMucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUub25TcGFuc0NvbGxlY3Rpb25DaGFuZ2VkID0gZnVuY3Rpb24gKGV2ZW50RGF0YSkge1xuICAgICAgICBpZiAoZXZlbnREYXRhLmFkZGVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50RGF0YS5hZGRlZENvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGV2ZW50RGF0YS5vYmplY3QuZ2V0SXRlbShldmVudERhdGEuaW5kZXggKyBpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHNwYW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkUHJvcGVydHlDaGFuZ2VIYW5kbGVyKHNwYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudERhdGEucmVtb3ZlZCAmJiBldmVudERhdGEucmVtb3ZlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGV2ZW50RGF0YS5yZW1vdmVkLmxlbmd0aDsgcCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBldmVudERhdGEucmVtb3ZlZFtwXTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByb3BlcnR5Q2hhbmdlSGFuZGxlcihzcGFuKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHNwYW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UoXCIuXCIsIHRoaXMpO1xuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5hZGRQcm9wZXJ0eUNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoc3Bhbikge1xuICAgICAgICB2YXIgc3R5bGUgPSBzcGFuLnN0eWxlO1xuICAgICAgICBzcGFuLm9uKG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiZm9udEZhbWlseUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRTaXplQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiZm9udFN0eWxlQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiZm9udFdlaWdodENoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcInRleHREZWNvcmF0aW9uQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJiYWNrZ3JvdW5kQ29sb3JDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUucmVtb3ZlUHJvcGVydHlDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24gKHNwYW4pIHtcbiAgICAgICAgdmFyIHN0eWxlID0gc3Bhbi5zdHlsZTtcbiAgICAgICAgc3Bhbi5vZmYob2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udEZhbWlseUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJmb250U2l6ZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJmb250U3R5bGVDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udFdlaWdodENoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJ0ZXh0RGVjb3JhdGlvbkNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJjb2xvckNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vZmYoXCJiYWNrZ3JvdW5kQ29sb3JDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UoZGF0YS5wcm9wZXJ0eU5hbWUsIHRoaXMpO1xuICAgIH07XG4gICAgRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5zcGFucy5mb3JFYWNoKGZ1bmN0aW9uICh2LCBpLCBhcnIpIHsgcmV0dXJuIGNhbGxiYWNrKHYpOyB9KTtcbiAgICB9O1xuICAgIHJldHVybiBGb3JtYXR0ZWRTdHJpbmc7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5Gb3JtYXR0ZWRTdHJpbmcgPSBGb3JtYXR0ZWRTdHJpbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mb3JtYXR0ZWQtc3RyaW5nLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vdWkvY29yZS92aWV3XCIpO1xudmFyIFNwYW4gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTcGFuLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNwYW4oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImZvbnRGYW1pbHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRGYW1pbHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRGYW1pbHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImZvbnRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImZvbnRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U3R5bGUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImZvbnRXZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRXZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRXZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcInRleHREZWNvcmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5jb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcImJhY2tncm91bmRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNwYW4ucHJvdG90eXBlLCBcInRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZXh0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RleHQgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UoXCJ0ZXh0XCIsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3Bhbi5wcm90b3R5cGUuX3NldFRleHRJbnRlcm5hbCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl90ZXh0ID0gdmFsdWU7XG4gICAgfTtcbiAgICByZXR1cm4gU3Bhbjtcbn0odmlld18xLlZpZXdCYXNlKSk7XG5leHBvcnRzLlNwYW4gPSBTcGFuO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Bhbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW5jb2Rpbmc7XG4oZnVuY3Rpb24gKGVuY29kaW5nKSB7XG4gICAgZW5jb2RpbmcuSVNPXzg4NTlfMSA9IFwiSVNPLTg4NTktMVwiO1xuICAgIGVuY29kaW5nLlVTX0FTQ0lJID0gXCJVUy1BU0NJSVwiO1xuICAgIGVuY29kaW5nLlVURl8xNiA9IFwiVVRGLTE2XCI7XG4gICAgZW5jb2RpbmcuVVRGXzE2QkUgPSBcIlVURi0xNkJFXCI7XG4gICAgZW5jb2RpbmcuVVRGXzE2TEUgPSBcIlVURi0xNkxFXCI7XG4gICAgZW5jb2RpbmcuVVRGXzggPSBcIlVURi04XCI7XG59KShlbmNvZGluZyA9IGV4cG9ydHMuZW5jb2RpbmcgfHwgKGV4cG9ydHMuZW5jb2RpbmcgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0aW1lb3V0SGFuZGxlcjtcbnZhciB0aW1lb3V0Q2FsbGJhY2tzID0ge307XG52YXIgdGltZXJJZCA9IDA7XG5mdW5jdGlvbiBjcmVhdGVIYW5kbGVyQW5kR2V0SWQoKSB7XG4gICAgaWYgKCF0aW1lb3V0SGFuZGxlcikge1xuICAgICAgICB0aW1lb3V0SGFuZGxlciA9IG5ldyBhbmRyb2lkLm9zLkhhbmRsZXIoYW5kcm9pZC5vcy5Mb29wZXIubXlMb29wZXIoKSk7XG4gICAgfVxuICAgIHRpbWVySWQrKztcbiAgICByZXR1cm4gdGltZXJJZDtcbn1cbmZ1bmN0aW9uIHNldFRpbWVvdXQoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcykge1xuICAgIGlmIChtaWxsaXNlY29uZHMgPT09IHZvaWQgMCkgeyBtaWxsaXNlY29uZHMgPSAwOyB9XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBtaWxsaXNlY29uZHMgKz0gMDtcbiAgICB2YXIgaWQgPSBjcmVhdGVIYW5kbGVyQW5kR2V0SWQoKTtcbiAgICB2YXIgaW52b2tlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FsbGJhY2suYXBwbHkodm9pZCAwLCBhcmdzKTsgfTtcbiAgICB2YXIgem9uZUJvdW5kID0gem9uZWRDYWxsYmFjayhpbnZva2UpO1xuICAgIHZhciBydW5uYWJsZSA9IG5ldyBqYXZhLmxhbmcuUnVubmFibGUoe1xuICAgICAgICBydW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHpvbmVCb3VuZCgpO1xuICAgICAgICAgICAgaWYgKHRpbWVvdXRDYWxsYmFja3NbaWRdKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRpbWVvdXRDYWxsYmFja3NbaWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCF0aW1lb3V0Q2FsbGJhY2tzW2lkXSkge1xuICAgICAgICB0aW1lb3V0Q2FsbGJhY2tzW2lkXSA9IHJ1bm5hYmxlO1xuICAgIH1cbiAgICB0aW1lb3V0SGFuZGxlci5wb3N0RGVsYXllZChydW5uYWJsZSwgbG9uZyhtaWxsaXNlY29uZHMpKTtcbiAgICByZXR1cm4gaWQ7XG59XG5leHBvcnRzLnNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuZnVuY3Rpb24gY2xlYXJUaW1lb3V0KGlkKSB7XG4gICAgdmFyIGluZGV4ID0gaWQ7XG4gICAgaWYgKHRpbWVvdXRDYWxsYmFja3NbaW5kZXhdKSB7XG4gICAgICAgIHRpbWVvdXRIYW5kbGVyLnJlbW92ZUNhbGxiYWNrcyh0aW1lb3V0Q2FsbGJhY2tzW2luZGV4XSk7XG4gICAgICAgIGRlbGV0ZSB0aW1lb3V0Q2FsbGJhY2tzW2luZGV4XTtcbiAgICB9XG59XG5leHBvcnRzLmNsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbmZ1bmN0aW9uIHNldEludGVydmFsKGNhbGxiYWNrLCBtaWxsaXNlY29uZHMpIHtcbiAgICBpZiAobWlsbGlzZWNvbmRzID09PSB2b2lkIDApIHsgbWlsbGlzZWNvbmRzID0gMDsgfVxuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgbWlsbGlzZWNvbmRzICs9IDA7XG4gICAgdmFyIGlkID0gY3JlYXRlSGFuZGxlckFuZEdldElkKCk7XG4gICAgdmFyIGhhbmRsZXIgPSB0aW1lb3V0SGFuZGxlcjtcbiAgICB2YXIgaW52b2tlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FsbGJhY2suYXBwbHkodm9pZCAwLCBhcmdzKTsgfTtcbiAgICB2YXIgem9uZUJvdW5kID0gem9uZWRDYWxsYmFjayhpbnZva2UpO1xuICAgIHZhciBydW5uYWJsZSA9IG5ldyBqYXZhLmxhbmcuUnVubmFibGUoe1xuICAgICAgICBydW46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHpvbmVCb3VuZCgpO1xuICAgICAgICAgICAgaWYgKHRpbWVvdXRDYWxsYmFja3NbaWRdKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlci5wb3N0RGVsYXllZChydW5uYWJsZSwgbG9uZyhtaWxsaXNlY29uZHMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICghdGltZW91dENhbGxiYWNrc1tpZF0pIHtcbiAgICAgICAgdGltZW91dENhbGxiYWNrc1tpZF0gPSBydW5uYWJsZTtcbiAgICB9XG4gICAgdGltZW91dEhhbmRsZXIucG9zdERlbGF5ZWQocnVubmFibGUsIGxvbmcobWlsbGlzZWNvbmRzKSk7XG4gICAgcmV0dXJuIGlkO1xufVxuZXhwb3J0cy5zZXRJbnRlcnZhbCA9IHNldEludGVydmFsO1xuZXhwb3J0cy5jbGVhckludGVydmFsID0gY2xlYXJUaW1lb3V0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGltZXIuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW5hYmxlZCA9IGZhbHNlO1xudmFyIF9jYXRlZ29yaWVzID0ge307XG52YXIgX3dyaXRlcnMgPSBbXTtcbnZhciBfZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbnZhciBfZXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIGVuYWJsZWQgPSB0cnVlO1xufVxuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIGVuYWJsZWQgPSBmYWxzZTtcbn1cbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5mdW5jdGlvbiBpc0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIGVuYWJsZWQ7XG59XG5leHBvcnRzLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcbmZ1bmN0aW9uIGlzQ2F0ZWdvcnlTZXQoY2F0ZWdvcnkpIHtcbiAgICByZXR1cm4gY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXM7XG59XG5leHBvcnRzLmlzQ2F0ZWdvcnlTZXQgPSBpc0NhdGVnb3J5U2V0O1xuZnVuY3Rpb24gYWRkV3JpdGVyKHdyaXRlcikge1xuICAgIF93cml0ZXJzLnB1c2god3JpdGVyKTtcbn1cbmV4cG9ydHMuYWRkV3JpdGVyID0gYWRkV3JpdGVyO1xuZnVuY3Rpb24gcmVtb3ZlV3JpdGVyKHdyaXRlcikge1xuICAgIHZhciBpbmRleCA9IF93cml0ZXJzLmluZGV4T2Yod3JpdGVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfd3JpdGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlV3JpdGVyID0gcmVtb3ZlV3JpdGVyO1xuZnVuY3Rpb24gY2xlYXJXcml0ZXJzKCkge1xuICAgIGlmIChfd3JpdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF93cml0ZXJzLnNwbGljZSgwLCBfd3JpdGVycy5sZW5ndGgpO1xuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJXcml0ZXJzID0gY2xlYXJXcml0ZXJzO1xuZnVuY3Rpb24gc2V0Q2F0ZWdvcmllcyhjYXRlZ29yaWVzKSB7XG4gICAgX2NhdGVnb3JpZXMgPSB7fTtcbiAgICBhZGRDYXRlZ29yaWVzKGNhdGVnb3JpZXMpO1xufVxuZXhwb3J0cy5zZXRDYXRlZ29yaWVzID0gc2V0Q2F0ZWdvcmllcztcbmZ1bmN0aW9uIGFkZENhdGVnb3JpZXMoY2F0ZWdvcmllcykge1xuICAgIHZhciBzcGxpdCA9IGNhdGVnb3JpZXMuc3BsaXQoXCIsXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2NhdGVnb3JpZXNbc3BsaXRbaV0udHJpbSgpXSA9IHRydWU7XG4gICAgfVxufVxuZXhwb3J0cy5hZGRDYXRlZ29yaWVzID0gYWRkQ2F0ZWdvcmllcztcbmZ1bmN0aW9uIHdyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKSB7XG4gICAgdmFyIGk7XG4gICAgaWYgKHR5cGUgPT09IG1lc3NhZ2VUeXBlLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBfd3JpdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX3dyaXRlcnNbaV0ud3JpdGUobWVzc2FnZSwgY2F0ZWdvcnksIHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFlbmFibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEoY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXMpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IF93cml0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF93cml0ZXJzW2ldLndyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKTtcbiAgICB9XG59XG5leHBvcnRzLndyaXRlID0gd3JpdGU7XG5mdW5jdGlvbiBub3RpZnlFdmVudChvYmplY3QsIG5hbWUsIGRhdGEpIHtcbiAgICBpZiAoIWVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaSwgbGlzdGVuZXIsIGZpbHRlcnM7XG4gICAgZm9yIChpID0gMDsgaSA8IF9ldmVudExpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsaXN0ZW5lciA9IF9ldmVudExpc3RlbmVyc1tpXTtcbiAgICAgICAgaWYgKGxpc3RlbmVyLmZpbHRlcikge1xuICAgICAgICAgICAgZmlsdGVycyA9IGxpc3RlbmVyLmZpbHRlci5zcGxpdChcIixcIik7XG4gICAgICAgICAgICBmaWx0ZXJzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnRyaW0oKSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5vbihvYmplY3QsIG5hbWUsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdGVuZXIub24ob2JqZWN0LCBuYW1lLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMubm90aWZ5RXZlbnQgPSBub3RpZnlFdmVudDtcbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICBfZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG59XG5leHBvcnRzLmFkZEV2ZW50TGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyO1xuZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIHZhciBpbmRleCA9IF9ldmVudExpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfZXZlbnRMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG59XG5leHBvcnRzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSByZW1vdmVFdmVudExpc3RlbmVyO1xudmFyIG1lc3NhZ2VUeXBlO1xuKGZ1bmN0aW9uIChtZXNzYWdlVHlwZSkge1xuICAgIG1lc3NhZ2VUeXBlLmxvZyA9IDA7XG4gICAgbWVzc2FnZVR5cGUuaW5mbyA9IDE7XG4gICAgbWVzc2FnZVR5cGUud2FybiA9IDI7XG4gICAgbWVzc2FnZVR5cGUuZXJyb3IgPSAzO1xufSkobWVzc2FnZVR5cGUgPSBleHBvcnRzLm1lc3NhZ2VUeXBlIHx8IChleHBvcnRzLm1lc3NhZ2VUeXBlID0ge30pKTtcbnZhciBjYXRlZ29yaWVzO1xuKGZ1bmN0aW9uIChjYXRlZ29yaWVzKSB7XG4gICAgY2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzID0gXCJWaXN1YWxUcmVlRXZlbnRzXCI7XG4gICAgY2F0ZWdvcmllcy5MYXlvdXQgPSBcIkxheW91dFwiO1xuICAgIGNhdGVnb3JpZXMuU3R5bGUgPSBcIlN0eWxlXCI7XG4gICAgY2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5ID0gXCJWaWV3SGllcmFyY2h5XCI7XG4gICAgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUgPSBcIk5hdGl2ZUxpZmVjeWNsZVwiO1xuICAgIGNhdGVnb3JpZXMuRGVidWcgPSBcIkRlYnVnXCI7XG4gICAgY2F0ZWdvcmllcy5OYXZpZ2F0aW9uID0gXCJOYXZpZ2F0aW9uXCI7XG4gICAgY2F0ZWdvcmllcy5UZXN0ID0gXCJUZXN0XCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nID0gXCJCaW5kaW5nXCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nRXJyb3IgPSBcIkJpbmRpbmdFcnJvclwiO1xuICAgIGNhdGVnb3JpZXMuRXJyb3IgPSBcIkVycm9yXCI7XG4gICAgY2F0ZWdvcmllcy5BbmltYXRpb24gPSBcIkFuaW1hdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuVHJhbnNpdGlvbiA9IFwiVHJhbnNpdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuTGl2ZXN5bmMgPSBcIkxpdmVzeW5jXCI7XG4gICAgY2F0ZWdvcmllcy5Nb2R1bGVOYW1lUmVzb2x2ZXIgPSBcIk1vZHVsZU5hbWVSZXNvbHZlclwiO1xuICAgIGNhdGVnb3JpZXMuc2VwYXJhdG9yID0gXCIsXCI7XG4gICAgY2F0ZWdvcmllcy5BbGwgPSBbXG4gICAgICAgIGNhdGVnb3JpZXMuVmlzdWFsVHJlZUV2ZW50cywgY2F0ZWdvcmllcy5MYXlvdXQsIGNhdGVnb3JpZXMuU3R5bGUsXG4gICAgICAgIGNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSwgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUsXG4gICAgICAgIGNhdGVnb3JpZXMuRGVidWcsIGNhdGVnb3JpZXMuTmF2aWdhdGlvbiwgY2F0ZWdvcmllcy5UZXN0LCBjYXRlZ29yaWVzLkJpbmRpbmcsXG4gICAgICAgIGNhdGVnb3JpZXMuRXJyb3IsIGNhdGVnb3JpZXMuQW5pbWF0aW9uLCBjYXRlZ29yaWVzLlRyYW5zaXRpb24sIGNhdGVnb3JpZXMuTGl2ZXN5bmMsXG4gICAgICAgIGNhdGVnb3JpZXMuTW9kdWxlTmFtZVJlc29sdmVyXG4gICAgXVxuICAgICAgICAuam9pbihjYXRlZ29yaWVzLnNlcGFyYXRvcik7XG4gICAgZnVuY3Rpb24gY29uY2F0KCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGNhdGVnb3JpZXMuc2VwYXJhdG9yLCBhcmd1bWVudHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGNhdGVnb3JpZXMuY29uY2F0ID0gY29uY2F0O1xufSkoY2F0ZWdvcmllcyA9IGV4cG9ydHMuY2F0ZWdvcmllcyB8fCAoZXhwb3J0cy5jYXRlZ29yaWVzID0ge30pKTtcbnZhciBDb25zb2xlV3JpdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb25zb2xlV3JpdGVyKCkge1xuICAgIH1cbiAgICBDb25zb2xlV3JpdGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBjYXRlZ29yeSwgdHlwZSkge1xuICAgICAgICBpZiAoIWNvbnNvbGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXNnVHlwZTtcbiAgICAgICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbXNnVHlwZSA9IG1lc3NhZ2VUeXBlLmxvZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1zZ1R5cGUgPSB0eXBlO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAobXNnVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS5sb2c6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuaW5mbzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUud2FybjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuZXJyb3I6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ29uc29sZVdyaXRlcjtcbn0oKSk7XG5hZGRXcml0ZXIobmV3IENvbnNvbGVXcml0ZXIoKSk7XG52YXIgRGVmYXVsdEVycm9ySGFuZGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVmYXVsdEVycm9ySGFuZGxlcigpIHtcbiAgICB9XG4gICAgRGVmYXVsdEVycm9ySGFuZGxlci5wcm90b3R5cGUuaGFuZGxlckVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH07XG4gICAgcmV0dXJuIERlZmF1bHRFcnJvckhhbmRsZXI7XG59KCkpO1xuZXhwb3J0cy5EZWZhdWx0RXJyb3JIYW5kbGVyID0gRGVmYXVsdEVycm9ySGFuZGxlcjtcbnNldEVycm9ySGFuZGxlcihuZXcgRGVmYXVsdEVycm9ySGFuZGxlcigpKTtcbmZ1bmN0aW9uIGdldEVycm9ySGFuZGxlcigpIHtcbiAgICByZXR1cm4gX2Vycm9ySGFuZGxlcjtcbn1cbmV4cG9ydHMuZ2V0RXJyb3JIYW5kbGVyID0gZ2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gc2V0RXJyb3JIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICBfZXJyb3JIYW5kbGVyID0gaGFuZGxlcjtcbn1cbmV4cG9ydHMuc2V0RXJyb3JIYW5kbGVyID0gc2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoIV9lcnJvckhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKGVycm9yKTtcbiAgICB9XG4gICAgX2Vycm9ySGFuZGxlci5oYW5kbGVyRXJyb3IoZXJyb3IpO1xufVxuZXhwb3J0cy5lcnJvciA9IGVycm9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhY2UuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLmFjdGlvbkl0ZW1zID0gXCJhY3Rpb25JdGVtc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBBY3Rpb25CYXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uQmFyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpb25CYXJCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYWN0aW9uSXRlbXMgPSBuZXcgQWN0aW9uSXRlbXMoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJuYXZpZ2F0aW9uQnV0dG9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fbmF2aWdhdGlvbkJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25hdmlnYXRpb25CdXR0b24uYWN0aW9uQmFyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbi5hY3Rpb25CYXIgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX25hdmlnYXRpb25CdXR0b24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUsIFwiYWN0aW9uSXRlbXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hY3Rpb25JdGVtcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImFjdGlvbkl0ZW1zIHByb3BlcnR5IGlzIHJlYWQtb25seVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkJhckJhc2UucHJvdG90eXBlLCBcInRpdGxlVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpdGxlVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aXRsZVZpZXcgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlVmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHRoaXMuX3RpdGxlVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlVmlldy5zdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlVmlldy5zdHlsZVt2aWV3XzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IHZpZXdfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl90aXRsZVZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHZhbHVlLnN0eWxlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXdfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gXCJjZW50ZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXdfMS52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVbdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcIm1pZGRsZVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb25WaWV3c0NvdW50ID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbkl0ZW1zLmdldEl0ZW1zKCkuZm9yRWFjaChmdW5jdGlvbiAoYWN0aW9uSXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChhY3Rpb25JdGVtLmFjdGlvblZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uVmlld3NDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvblZpZXdzQ291bnQgKyAodGhpcy50aXRsZVZpZXcgPyAxIDogMCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLl9vblRpdGxlUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiYWN0aW9uSXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25JdGVtcy5zZXRJdGVtcyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRpdGxlVmlldyA9IHRoaXMudGl0bGVWaWV3O1xuICAgICAgICBpZiAodGl0bGVWaWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aXRsZVZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRpdGxlVmlldyA9IHRoaXMudGl0bGVWaWV3O1xuICAgICAgICBpZiAodGl0bGVWaWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aXRsZVZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQnV0dG9uID0gdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbjtcbiAgICAgICAgaWYgKG5hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG5hdmlnYXRpb25CdXR0b24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb25JdGVtKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhhY3Rpb25JdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlLnByb3RvdHlwZS5faXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGl0bGUgfHxcbiAgICAgICAgICAgIHRoaXMudGl0bGVWaWV3IHx8XG4gICAgICAgICAgICAodGhpcy5hbmRyb2lkICYmIHRoaXMuYW5kcm9pZC5pY29uKSB8fFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uQnV0dG9uIHx8XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkl0ZW1zLmdldEl0ZW1zKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkFjdGlvbkJhclwiKVxuICAgIF0sIEFjdGlvbkJhckJhc2UpO1xuICAgIHJldHVybiBBY3Rpb25CYXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5BY3Rpb25CYXJCYXNlID0gQWN0aW9uQmFyQmFzZTtcbnZhciBBY3Rpb25JdGVtcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbXMoYWN0aW9uQmFyKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IGFjdGlvbkJhcjtcbiAgICB9XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmFkZEl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoIWl0ZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBhZGQgZW1wdHkgaXRlbVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICBpdGVtLmFjdGlvbkJhciA9IHRoaXMuX2FjdGlvbkJhcjtcbiAgICAgICAgdGhpcy5fYWN0aW9uQmFyLl9hZGRWaWV3KGl0ZW0pO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1zLnByb3RvdHlwZS5yZW1vdmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcmVtb3ZlIGVtcHR5IGl0ZW1cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW1JbmRleCA9IHRoaXMuX2l0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgICAgIGlmIChpdGVtSW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBpdGVtIHRvIHJlbW92ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pdGVtcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fYWN0aW9uQmFyLl9yZW1vdmVWaWV3KGl0ZW0pO1xuICAgICAgICBpdGVtLmFjdGlvbkJhciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pdGVtcy5zbGljZSgpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmdldFZpc2libGVJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpc2libGVJdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXNWaXNpYmxlKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgdmlzaWJsZUl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdmlzaWJsZUl0ZW1zO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmdldEl0ZW1BdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuX2l0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXRlbXNbaW5kZXhdO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLnNldEl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLl9pdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUl0ZW0odGhpcy5faXRlbXNbdGhpcy5faXRlbXMubGVuZ3RoIC0gMV0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuYWRkSXRlbShpdGVtc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FjdGlvbkJhcikge1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aW9uSXRlbXM7XG59KCkpO1xuZXhwb3J0cy5BY3Rpb25JdGVtcyA9IEFjdGlvbkl0ZW1zO1xudmFyIEFjdGlvbkl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uSXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbUJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25WaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcuc3R5bGVbdmlld18xLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IHZpZXdfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25WaWV3LnN0eWxlW3ZpZXdfMS52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fYWN0aW9uVmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2FjdGlvblZpZXcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUsIFwiYWN0aW9uQmFyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uVmlldy5zdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gXCJjZW50ZXJcIjtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcuc3R5bGVbdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcIm1pZGRsZVwiO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZS5fcmFpc2VUYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2VtaXQoQWN0aW9uSXRlbUJhc2UudGFwRXZlbnQpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uVmlldyA9IHZhbHVlO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLl9vblZpc2liaWxpdHlDaGFuZ2VkID0gZnVuY3Rpb24gKHZpc2liaWxpdHkpIHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkJhci51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5fYWN0aW9uVmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1CYXNlLnRhcEV2ZW50ID0gXCJ0YXBcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICByZXR1cm4gQWN0aW9uSXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5BY3Rpb25JdGVtQmFzZSA9IEFjdGlvbkl0ZW1CYXNlO1xuZnVuY3Rpb24gaXNWaXNpYmxlKGl0ZW0pIHtcbiAgICByZXR1cm4gaXRlbS52aXNpYmlsaXR5ID09PSBcInZpc2libGVcIjtcbn1cbmV4cG9ydHMuaXNWaXNpYmxlID0gaXNWaXNpYmxlO1xuZnVuY3Rpb24gb25UaXRsZVByb3BlcnR5Q2hhbmdlZChhY3Rpb25CYXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGFjdGlvbkJhci5fb25UaXRsZVByb3BlcnR5Q2hhbmdlZCgpO1xufVxuZXhwb3J0cy50aXRsZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGl0bGVcIiwgdmFsdWVDaGFuZ2VkOiBvblRpdGxlUHJvcGVydHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy50aXRsZVByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkJhckJhc2UpO1xuZnVuY3Rpb24gb25JdGVtQ2hhbmdlZChpdGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpZiAoaXRlbS5hY3Rpb25CYXIpIHtcbiAgICAgICAgaXRlbS5hY3Rpb25CYXIudXBkYXRlKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gb25WaXNpYmlsaXR5Q2hhbmdlZChpdGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpdGVtLl9vblZpc2liaWxpdHlDaGFuZ2VkKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIHRyYWNlTWlzc2luZ0ljb24oaWNvbikge1xuICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ291bGQgbm90IGxvYWQgYWN0aW9uIGJhciBpY29uOiBcIiArIGljb24sIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuRXJyb3IsIHZpZXdfMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbn1cbmV4cG9ydHMudHJhY2VNaXNzaW5nSWNvbiA9IHRyYWNlTWlzc2luZ0ljb247XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpb3NJY29uUmVuZGVyaW5nTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwiYWx3YXlzT3JpZ2luYWxcIiB9KTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eS5yZWdpc3RlcihBY3Rpb25CYXJCYXNlKTtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIHZhbHVlQ2hhbmdlZDogb25JdGVtQ2hhbmdlZCB9KTtcbmV4cG9ydHMudGV4dFByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkl0ZW1CYXNlKTtcbmV4cG9ydHMuaWNvblByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaWNvblwiLCB2YWx1ZUNoYW5nZWQ6IG9uSXRlbUNoYW5nZWQgfSk7XG5leHBvcnRzLmljb25Qcm9wZXJ0eS5yZWdpc3RlcihBY3Rpb25JdGVtQmFzZSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBcInZpc2libGVcIiwgdmFsdWVDaGFuZ2VkOiBvblZpc2liaWxpdHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIoQWN0aW9uSXRlbUJhc2UpO1xuZXhwb3J0cy5mbGF0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJmbGF0XCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuZmxhdFByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkJhckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aW9uLWJhci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhY3Rpb25fYmFyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYWN0aW9uLWJhci1jb21tb25cIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hY3Rpb24tYmFyLWNvbW1vblwiKSk7XG52YXIgUl9JRF9IT01FID0gMHgwMTAyMDAyYztcbnZhciBBQ1RJT05fSVRFTV9JRF9PRkZTRVQgPSAxMDAwMDtcbnZhciBERUZBVUxUX0VMRVZBVElPTiA9IDQ7XG52YXIgQXBwQ29tcGF0VGV4dFZpZXc7XG52YXIgYWN0aW9uSXRlbUlkR2VuZXJhdG9yID0gQUNUSU9OX0lURU1fSURfT0ZGU0VUO1xuZnVuY3Rpb24gZ2VuZXJhdGVJdGVtSWQoKSB7XG4gICAgYWN0aW9uSXRlbUlkR2VuZXJhdG9yKys7XG4gICAgcmV0dXJuIGFjdGlvbkl0ZW1JZEdlbmVyYXRvcjtcbn1cbnZhciBhcHBSZXNvdXJjZXM7XG52YXIgTWVudUl0ZW1DbGlja0xpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZU1lbnVJdGVtQ2xpY2tMaXN0ZW5lcigpIHtcbiAgICBpZiAoTWVudUl0ZW1DbGlja0xpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgQXBwQ29tcGF0VGV4dFZpZXcgPSBhbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LkFwcENvbXBhdFRleHRWaWV3O1xuICAgIHZhciBNZW51SXRlbUNsaWNrTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgTWVudUl0ZW1DbGlja0xpc3RlbmVySW1wbC5wcm90b3R5cGUub25NZW51SXRlbUNsaWNrID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciBpdGVtSWQgPSBpdGVtLmdldEl0ZW1JZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3duZXIuX29uQW5kcm9pZEl0ZW1TZWxlY3RlZChpdGVtSWQpO1xuICAgICAgICB9O1xuICAgICAgICBNZW51SXRlbUNsaWNrTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlRvb2xiYXIuT25NZW51SXRlbUNsaWNrTGlzdGVuZXJdKVxuICAgICAgICBdLCBNZW51SXRlbUNsaWNrTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIE1lbnVJdGVtQ2xpY2tMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgTWVudUl0ZW1DbGlja0xpc3RlbmVyID0gTWVudUl0ZW1DbGlja0xpc3RlbmVySW1wbDtcbiAgICBhcHBSZXNvdXJjZXMgPSBhcHBsaWNhdGlvbi5hbmRyb2lkLmNvbnRleHQuZ2V0UmVzb3VyY2VzKCk7XG59XG52YXIgQWN0aW9uSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGlvbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuZHJvaWRQb3NpdGlvbiA9IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBcImFjdGlvbkJhclwiLFxuICAgICAgICAgICAgc3lzdGVtSWNvbjogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9pdGVtSWQgPSBnZW5lcmF0ZUl0ZW1JZCgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25JdGVtLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5kcm9pZFBvc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWN0aW9uSXRlbS5hbmRyb2lkIGlzIHJlYWQtb25seVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uSXRlbS5wcm90b3R5cGUuX2dldEl0ZW1JZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1JZDtcbiAgICB9O1xuICAgIHJldHVybiBBY3Rpb25JdGVtO1xufShhY3Rpb25fYmFyX2NvbW1vbl8xLkFjdGlvbkl0ZW1CYXNlKSk7XG5leHBvcnRzLkFjdGlvbkl0ZW0gPSBBY3Rpb25JdGVtO1xudmFyIEFuZHJvaWRBY3Rpb25CYXJTZXR0aW5ncyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzKGFjdGlvbkJhcikge1xuICAgICAgICB0aGlzLl9pY29uVmlzaWJpbGl0eSA9IFwiYXV0b1wiO1xuICAgICAgICB0aGlzLl9hY3Rpb25CYXIgPSBhY3Rpb25CYXI7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3MucHJvdG90eXBlLCBcImljb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pY29uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9pY29uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faWNvbiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhci5fb25JY29uUHJvcGVydHlDaGFuZ2VkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkQWN0aW9uQmFyU2V0dGluZ3MucHJvdG90eXBlLCBcImljb25WaXNpYmlsaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWNvblZpc2liaWxpdHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX2ljb25WaXNpYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faWNvblZpc2liaWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25CYXIuX29uSWNvblByb3BlcnR5Q2hhbmdlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzO1xufSgpKTtcbmV4cG9ydHMuQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzID0gQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzO1xudmFyIE5hdmlnYXRpb25CdXR0b24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOYXZpZ2F0aW9uQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE5hdmlnYXRpb25CdXR0b24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIE5hdmlnYXRpb25CdXR0b247XG59KEFjdGlvbkl0ZW0pKTtcbmV4cG9ydHMuTmF2aWdhdGlvbkJ1dHRvbiA9IE5hdmlnYXRpb25CdXR0b247XG52YXIgQWN0aW9uQmFyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uQmFyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGlvbkJhcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuZHJvaWQgPSBuZXcgQW5kcm9pZEFjdGlvbkJhclNldHRpbmdzKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5kcm9pZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBOYXZpZ2F0aW9uQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25CdXR0b24gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFjdGlvbkl0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uSXRlbXMuYWRkSXRlbSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBhY3Rpb25fYmFyX2NvbW1vbl8xLlZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGVWaWV3ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlRvb2xiYXIodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpbml0aWFsaXplTWVudUl0ZW1DbGlja0xpc3RlbmVyKCk7XG4gICAgICAgIHZhciBtZW51SXRlbUNsaWNrTGlzdGVuZXIgPSBuZXcgTWVudUl0ZW1DbGlja0xpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uTWVudUl0ZW1DbGlja0xpc3RlbmVyKG1lbnVJdGVtQ2xpY2tMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcubWVudUl0ZW1DbGlja0xpc3RlbmVyID0gbWVudUl0ZW1DbGlja0xpc3RlbmVyO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1lbnVJdGVtQ2xpY2tMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICBpZiAoIXBhZ2UuZnJhbWUgfHwgIXBhZ2UuZnJhbWUuX2dldE5hdkJhclZpc2libGUocGFnZSkpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LkdPTkUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LlZJU0lCTEUpO1xuICAgICAgICB0aGlzLl9hZGRBY3Rpb25JdGVtcygpO1xuICAgICAgICB0aGlzLl91cGRhdGVUaXRsZUFuZFRpdGxlVmlldygpO1xuICAgICAgICB0aGlzLl91cGRhdGVJY29uKCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZU5hdmlnYXRpb25CdXR0b24oKTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX29uQW5kcm9pZEl0ZW1TZWxlY3RlZCA9IGZ1bmN0aW9uIChpdGVtSWQpIHtcbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvbkJ1dHRvbiAmJiBpdGVtSWQgPT09IFJfSURfSE9NRSkge1xuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uQnV0dG9uLl9yYWlzZVRhcCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lbnVJdGVtID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLmFjdGlvbkl0ZW1zLmdldEl0ZW1zKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpdGVtc1tpXS5fZ2V0SXRlbUlkKCkgPT09IGl0ZW1JZCkge1xuICAgICAgICAgICAgICAgIG1lbnVJdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lbnVJdGVtKSB7XG4gICAgICAgICAgICBtZW51SXRlbS5fcmFpc2VUYXAoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX3VwZGF0ZU5hdmlnYXRpb25CdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXZCdXR0b24gPSB0aGlzLm5hdmlnYXRpb25CdXR0b247XG4gICAgICAgIGlmIChuYXZCdXR0b24gJiYgYWN0aW9uX2Jhcl9jb21tb25fMS5pc1Zpc2libGUobmF2QnV0dG9uKSkge1xuICAgICAgICAgICAgdmFyIHN5c3RlbUljb24gPSBuYXZCdXR0b24uYW5kcm9pZC5zeXN0ZW1JY29uO1xuICAgICAgICAgICAgaWYgKHN5c3RlbUljb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBzeXN0ZW1SZXNvdXJjZUlkID0gZ2V0U3lzdGVtUmVzb3VyY2VJZChzeXN0ZW1JY29uKTtcbiAgICAgICAgICAgICAgICBpZiAoc3lzdGVtUmVzb3VyY2VJZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TmF2aWdhdGlvbkljb24oc3lzdGVtUmVzb3VyY2VJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmF2QnV0dG9uLmljb24pIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd2FibGVPcklkID0gZ2V0RHJhd2FibGVPclJlc291cmNlSWQobmF2QnV0dG9uLmljb24sIGFwcFJlc291cmNlcyk7XG4gICAgICAgICAgICAgICAgaWYgKGRyYXdhYmxlT3JJZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TmF2aWdhdGlvbkljb24oZHJhd2FibGVPcklkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TmF2aWdhdGlvbkNvbnRlbnREZXNjcmlwdGlvbihuYXZCdXR0b24udGV4dCB8fCBudWxsKTtcbiAgICAgICAgICAgIHZhciBuYXZCdG5fMSA9IG5ldyBXZWFrUmVmKG5hdkJ1dHRvbik7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TmF2aWdhdGlvbk9uQ2xpY2tMaXN0ZW5lcihuZXcgYW5kcm9pZC52aWV3LlZpZXcuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3duZXIgPSBuYXZCdG5fMS5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvd25lci5fcmFpc2VUYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXROYXZpZ2F0aW9uSWNvbihudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fdXBkYXRlSWNvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpc2liaWxpdHkgPSBnZXRJY29uVmlzaWJpbGl0eSh0aGlzLmFuZHJvaWQuaWNvblZpc2liaWxpdHkpO1xuICAgICAgICBpZiAodmlzaWJpbGl0eSkge1xuICAgICAgICAgICAgdmFyIGljb24gPSB0aGlzLmFuZHJvaWQuaWNvbjtcbiAgICAgICAgICAgIGlmIChpY29uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZHJhd2FibGVPcklkID0gZ2V0RHJhd2FibGVPclJlc291cmNlSWQoaWNvbiwgYXBwUmVzb3VyY2VzKTtcbiAgICAgICAgICAgICAgICBpZiAoZHJhd2FibGVPcklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRMb2dvKGRyYXdhYmxlT3JJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRJY29uID0gYXBwbGljYXRpb24uYW5kcm9pZC5uYXRpdmVBcHAuZ2V0QXBwbGljYXRpb25JbmZvKCkuaWNvbjtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TG9nbyhkZWZhdWx0SWNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TG9nbyhudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fdXBkYXRlVGl0bGVBbmRUaXRsZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy50aXRsZVZpZXcpIHtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMudGl0bGU7XG4gICAgICAgICAgICBpZiAodGl0bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUaXRsZSh0aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYXBwQ29udGV4dCA9IGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgYXBwSW5mbyA9IGFwcENvbnRleHQuZ2V0QXBwbGljYXRpb25JbmZvKCk7XG4gICAgICAgICAgICAgICAgdmFyIGFwcExhYmVsID0gYXBwQ29udGV4dC5nZXRQYWNrYWdlTWFuYWdlcigpLmdldEFwcGxpY2F0aW9uTGFiZWwoYXBwSW5mbyk7XG4gICAgICAgICAgICAgICAgaWYgKGFwcExhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUaXRsZShhcHBMYWJlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9hZGRBY3Rpb25JdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1lbnUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TWVudSgpO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLmFjdGlvbkl0ZW1zLmdldFZpc2libGVJdGVtcygpO1xuICAgICAgICBtZW51LmNsZWFyKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICB2YXIgbWVudUl0ZW0gPSBtZW51LmFkZChhbmRyb2lkLnZpZXcuTWVudS5OT05FLCBpdGVtLl9nZXRJdGVtSWQoKSwgYW5kcm9pZC52aWV3Lk1lbnUuTk9ORSwgaXRlbS50ZXh0ICsgXCJcIik7XG4gICAgICAgICAgICBpZiAoaXRlbS5hY3Rpb25WaWV3ICYmIGl0ZW0uYWN0aW9uVmlldy5hbmRyb2lkKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5hbmRyb2lkLnBvc2l0aW9uID0gXCJhY3Rpb25CYXJcIjtcbiAgICAgICAgICAgICAgICBtZW51SXRlbS5zZXRBY3Rpb25WaWV3KGl0ZW0uYWN0aW9uVmlldy5hbmRyb2lkKTtcbiAgICAgICAgICAgICAgICBBY3Rpb25CYXIuX3NldE9uQ2xpY2tMaXN0ZW5lcihpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0uYW5kcm9pZC5zeXN0ZW1JY29uKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN5c3RlbVJlc291cmNlSWQgPSBnZXRTeXN0ZW1SZXNvdXJjZUlkKGl0ZW0uYW5kcm9pZC5zeXN0ZW1JY29uKTtcbiAgICAgICAgICAgICAgICBpZiAoc3lzdGVtUmVzb3VyY2VJZCkge1xuICAgICAgICAgICAgICAgICAgICBtZW51SXRlbS5zZXRJY29uKHN5c3RlbVJlc291cmNlSWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0uaWNvbikge1xuICAgICAgICAgICAgICAgIGlmICh1dGlsc18xLmlzRm9udEljb25VUkkoaXRlbS5pY29uKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm9udEljb25Db2RlID0gaXRlbS5pY29uLnNwbGl0KFwiLy9cIilbMV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBmb250ID0gaXRlbS5zdHlsZS5mb250SW50ZXJuYWw7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IGl0ZW0uc3R5bGUuY29sb3I7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpcyA9IGltYWdlX3NvdXJjZV8xLmZyb21Gb250SWNvbkNvZGUoZm9udEljb25Db2RlLCBmb250LCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpcyAmJiBpcy5hbmRyb2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHJhd2FibGUgPSBuZXcgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5CaXRtYXBEcmF3YWJsZShhcHBSZXNvdXJjZXMsIGlzLmFuZHJvaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVudUl0ZW0uc2V0SWNvbihkcmF3YWJsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkcmF3YWJsZU9ySWQgPSBnZXREcmF3YWJsZU9yUmVzb3VyY2VJZChpdGVtLmljb24sIGFwcFJlc291cmNlcyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkcmF3YWJsZU9ySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnVJdGVtLnNldEljb24oZHJhd2FibGVPcklkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzaG93QXNBY3Rpb24gPSBnZXRTaG93QXNBY3Rpb24oaXRlbSk7XG4gICAgICAgICAgICBtZW51SXRlbS5zZXRTaG93QXNBY3Rpb24oc2hvd0FzQWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLl9zZXRPbkNsaWNrTGlzdGVuZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgd2Vha1JlZiA9IG5ldyBXZWFrUmVmKGl0ZW0pO1xuICAgICAgICBpdGVtLmFjdGlvblZpZXcuYW5kcm9pZC5zZXRPbkNsaWNrTGlzdGVuZXIobmV3IGFuZHJvaWQudmlldy5WaWV3Lk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHZhciBvd25lciA9IHdlYWtSZWYuZ2V0KCk7XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLl9yYWlzZVRhcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fb25UaXRsZVByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlVGl0bGVBbmRUaXRsZVZpZXcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fb25JY29uUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVJY29uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKGF0SW5kZXggPT09IHZvaWQgMCkgeyBhdEluZGV4ID0gTnVtYmVyLk1BWF9WQUxVRTsgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIGlmIChhdEluZGV4ID49IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRDaGlsZENvdW50KCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkVmlldyhjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRWaWV3KGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGF0SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlVmlldyhjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIWRlZmF1bHRUaXRsZVRleHRDb2xvcikge1xuICAgICAgICAgICAgdmFyIHR2ID0gZ2V0QXBwQ29tcGF0VGV4dFZpZXcobmF0aXZlVmlldyk7XG4gICAgICAgICAgICBpZiAoIXR2KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gbmF0aXZlVmlldy5nZXRUaXRsZSgpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0VGl0bGUoXCJcIik7XG4gICAgICAgICAgICAgICAgdHYgPSBnZXRBcHBDb21wYXRUZXh0VmlldyhuYXRpdmVWaWV3KTtcbiAgICAgICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUaXRsZSh0aXRsZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdFRpdGxlVGV4dENvbG9yID0gdHYgPyB0di5nZXRUZXh0Q29sb3JzKCkuZ2V0RGVmYXVsdENvbG9yKCkgOiAtNTcwNDI1MzQ0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZhdWx0VGl0bGVUZXh0Q29sb3I7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlW2FjdGlvbl9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgYWN0aW9uX2Jhcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRpdGxlVGV4dENvbG9yKGNvbG9yKTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGVbYWN0aW9uX2Jhcl9jb21tb25fMS5mbGF0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29tcGF0ID0gYW5kcm9pZHguY29yZS52aWV3LlZpZXdDb21wYXQ7XG4gICAgICAgIGlmIChjb21wYXQuc2V0RWxldmF0aW9uKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb21wYXQuc2V0RWxldmF0aW9uKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gREVGQVVMVF9FTEVWQVRJT04gKiBhY3Rpb25fYmFyX2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICAgICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aW9uQmFyO1xufShhY3Rpb25fYmFyX2NvbW1vbl8xLkFjdGlvbkJhckJhc2UpKTtcbmV4cG9ydHMuQWN0aW9uQmFyID0gQWN0aW9uQmFyO1xuZnVuY3Rpb24gZ2V0QXBwQ29tcGF0VGV4dFZpZXcodG9vbGJhcikge1xuICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IHRvb2xiYXIuZ2V0Q2hpbGRDb3VudCgpOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICB2YXIgY2hpbGQgPSB0b29sYmFyLmdldENoaWxkQXQoaSk7XG4gICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIEFwcENvbXBhdFRleHRWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5BY3Rpb25CYXIucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG52YXIgZGVmYXVsdFRpdGxlVGV4dENvbG9yO1xuZnVuY3Rpb24gZ2V0RHJhd2FibGVPclJlc291cmNlSWQoaWNvbiwgcmVzb3VyY2VzKSB7XG4gICAgaWYgKHR5cGVvZiBpY29uICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSB1bmRlZmluZWQ7XG4gICAgaWYgKGljb24uaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgdmFyIHJlc291cmNlSWQgPSByZXNvdXJjZXMuZ2V0SWRlbnRpZmllcihpY29uLnN1YnN0cih1dGlsc18xLlJFU09VUkNFX1BSRUZJWC5sZW5ndGgpLCBcImRyYXdhYmxlXCIsIGFwcGxpY2F0aW9uLmFuZHJvaWQucGFja2FnZU5hbWUpO1xuICAgICAgICBpZiAocmVzb3VyY2VJZCA+IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc291cmNlSWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBkcmF3YWJsZSA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGljb24pO1xuICAgICAgICBpZiAoaXMpIHtcbiAgICAgICAgICAgIGRyYXdhYmxlID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuQml0bWFwRHJhd2FibGUoYXBwUmVzb3VyY2VzLCBpcy5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBkcmF3YWJsZTtcbiAgICB9XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgYWN0aW9uX2Jhcl9jb21tb25fMS50cmFjZU1pc3NpbmdJY29uKGljb24pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0U2hvd0FzQWN0aW9uKG1lbnVJdGVtKSB7XG4gICAgc3dpdGNoIChtZW51SXRlbS5hbmRyb2lkLnBvc2l0aW9uKSB7XG4gICAgICAgIGNhc2UgXCJhY3Rpb25CYXJJZlJvb21cIjpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkLnZpZXcuTWVudUl0ZW0uU0hPV19BU19BQ1RJT05fSUZfUk9PTTtcbiAgICAgICAgY2FzZSBcInBvcHVwXCI6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC52aWV3Lk1lbnVJdGVtLlNIT1dfQVNfQUNUSU9OX05FVkVSO1xuICAgICAgICBjYXNlIFwiYWN0aW9uQmFyXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC52aWV3Lk1lbnVJdGVtLlNIT1dfQVNfQUNUSU9OX0FMV0FZUztcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRJY29uVmlzaWJpbGl0eShpY29uVmlzaWJpbGl0eSkge1xuICAgIHN3aXRjaCAoaWNvblZpc2liaWxpdHkpIHtcbiAgICAgICAgY2FzZSBcImFsd2F5c1wiOlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGNhc2UgXCJhdXRvXCI6XG4gICAgICAgIGNhc2UgXCJuZXZlclwiOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldFN5c3RlbVJlc291cmNlSWQoc3lzdGVtSWNvbikge1xuICAgIHJldHVybiBhbmRyb2lkLmNvbnRlbnQucmVzLlJlc291cmNlcy5nZXRTeXN0ZW0oKS5nZXRJZGVudGlmaWVyKHN5c3RlbUljb24sIFwiZHJhd2FibGVcIiwgXCJhbmRyb2lkXCIpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aW9uLWJhci5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIEFjdGl2aXR5SW5kaWNhdG9yQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGl2aXR5SW5kaWNhdG9yQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpdml0eUluZGljYXRvckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWN0aXZpdHlJbmRpY2F0b3JCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiQWN0aXZpdHlJbmRpY2F0b3JcIilcbiAgICBdLCBBY3Rpdml0eUluZGljYXRvckJhc2UpO1xuICAgIHJldHVybiBBY3Rpdml0eUluZGljYXRvckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLkFjdGl2aXR5SW5kaWNhdG9yQmFzZSA9IEFjdGl2aXR5SW5kaWNhdG9yQmFzZTtcbkFjdGl2aXR5SW5kaWNhdG9yQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuYnVzeVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYnVzeVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmJ1c3lQcm9wZXJ0eS5yZWdpc3RlcihBY3Rpdml0eUluZGljYXRvckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aXZpdHktaW5kaWNhdG9yLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2FjdGl2aXR5LWluZGljYXRvci1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hY3Rpdml0eS1pbmRpY2F0b3ItY29tbW9uXCIpKTtcbnZhciBBY3Rpdml0eUluZGljYXRvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGl2aXR5SW5kaWNhdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGl2aXR5SW5kaWNhdG9yKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcHJvZ3Jlc3NCYXIgPSBuZXcgYW5kcm9pZC53aWRnZXQuUHJvZ3Jlc3NCYXIodGhpcy5fY29udGV4dCk7XG4gICAgICAgIHByb2dyZXNzQmFyLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFKTtcbiAgICAgICAgcHJvZ3Jlc3NCYXIuc2V0SW5kZXRlcm1pbmF0ZSh0cnVlKTtcbiAgICAgICAgcmV0dXJuIHByb2dyZXNzQmFyO1xuICAgIH07XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlW2FjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5idXN5UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuYnVzeVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudmlzaWJpbGl0eSA9PT0gYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuVklTSUJMRSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkodmFsdWUgPyBhbmRyb2lkLnZpZXcuVmlldy5WSVNJQkxFIDogYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlW2FjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS52aXNpYmlsaXR5UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5ISURERU47XG4gICAgfTtcbiAgICBBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGVbYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLnZpc2liaWxpdHlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuVklTSUJMRTpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VmlzaWJpbGl0eSh0aGlzLmJ1c3kgPyBhbmRyb2lkLnZpZXcuVmlldy5WSVNJQkxFIDogYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuSElEREVOOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LklOVklTSUJMRSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5WaXNpYmlsaXR5LkNPTExBUFNFOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LkdPTkUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZpc2liaWxpdHkgdmFsdWU6IFwiICsgdmFsdWUgKyBcIi4gVmFsaWQgdmFsdWVzIGFyZTogXFxcIlwiICsgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuVklTSUJMRSArIFwiXFxcIiwgXFxcIlwiICsgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLlZpc2liaWxpdHkuSElEREVOICsgXCJcXFwiLCBcXFwiXCIgKyBhY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuVmlzaWJpbGl0eS5DT0xMQVBTRSArIFwiXFxcIi5cIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgQWN0aXZpdHlJbmRpY2F0b3IucHJvdG90eXBlW2FjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0SW5kZXRlcm1pbmF0ZURyYXdhYmxlKCkuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRJbmRldGVybWluYXRlRHJhd2FibGUoKS5jbGVhckNvbG9yRmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBBY3Rpdml0eUluZGljYXRvcjtcbn0oYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLkFjdGl2aXR5SW5kaWNhdG9yQmFzZSkpO1xuZXhwb3J0cy5BY3Rpdml0eUluZGljYXRvciA9IEFjdGl2aXR5SW5kaWNhdG9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aXZpdHktaW5kaWNhdG9yLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG5leHBvcnRzLkNvbG9yID0gY29sb3JfMS5Db2xvcjtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xuZXhwb3J0cy50cmFjZUVuYWJsZWQgPSB0cmFjZV8xLmlzRW5hYmxlZDtcbmV4cG9ydHMudHJhY2VXcml0ZSA9IHRyYWNlXzEud3JpdGU7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcmllcyA9IHRyYWNlXzEuY2F0ZWdvcmllcztcbmV4cG9ydHMudHJhY2VUeXBlID0gdHJhY2VfMS5tZXNzYWdlVHlwZTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIFByb3BlcnRpZXM7XG4oZnVuY3Rpb24gKFByb3BlcnRpZXMpIHtcbiAgICBQcm9wZXJ0aWVzLm9wYWNpdHkgPSBcIm9wYWNpdHlcIjtcbiAgICBQcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvciA9IFwiYmFja2dyb3VuZENvbG9yXCI7XG4gICAgUHJvcGVydGllcy50cmFuc2xhdGUgPSBcInRyYW5zbGF0ZVwiO1xuICAgIFByb3BlcnRpZXMucm90YXRlID0gXCJyb3RhdGVcIjtcbiAgICBQcm9wZXJ0aWVzLnNjYWxlID0gXCJzY2FsZVwiO1xuICAgIFByb3BlcnRpZXMuaGVpZ2h0ID0gXCJoZWlnaHRcIjtcbiAgICBQcm9wZXJ0aWVzLndpZHRoID0gXCJ3aWR0aFwiO1xufSkoUHJvcGVydGllcyA9IGV4cG9ydHMuUHJvcGVydGllcyB8fCAoZXhwb3J0cy5Qcm9wZXJ0aWVzID0ge30pKTtcbnZhciBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgIHRoaXMueDEgPSB4MTtcbiAgICAgICAgdGhpcy55MSA9IHkxO1xuICAgICAgICB0aGlzLngyID0geDI7XG4gICAgICAgIHRoaXMueTIgPSB5MjtcbiAgICB9XG4gICAgcmV0dXJuIEN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmU7XG59KCkpO1xuZXhwb3J0cy5DdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZTtcbnZhciBBbmltYXRpb25CYXNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25CYXNlKGFuaW1hdGlvbkRlZmluaXRpb25zLCBwbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgIGlmICghYW5pbWF0aW9uRGVmaW5pdGlvbnMgfHwgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhbmltYXRpb24gZGVmaW5pdGlvbnMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQW5hbHl6aW5nIFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoICsgXCIgYW5pbWF0aW9uIGRlZmluaXRpb25zLi4uXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBhbmltYXRpb25EZWZpbml0aW9ucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbnNbaV0uY3VydmUpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSA9IHRoaXMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMgPSB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMuY29uY2F0KEFuaW1hdGlvbkJhc2UuX2NyZWF0ZVByb3BlcnR5QW5pbWF0aW9ucyhhbmltYXRpb25EZWZpbml0aW9uc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3RoaW5nIHRvIGFuaW1hdGUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ3JlYXRlZCBcIiArIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGggKyBcIiBpbmRpdmlkdWFsIHByb3BlcnR5IGFuaW1hdGlvbnMuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BsYXlTZXF1ZW50aWFsbHkgPSBwbGF5U2VxdWVudGlhbGx5O1xuICAgIH1cbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVqZWN0QWxyZWFkeVBsYXlpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZWFzb24gPSBcIkFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCI7XG4gICAgICAgIHRyYWNlXzEud3JpdGUocmVhc29uLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXNfMS5fcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICBfdGhpc18xLl9yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmZpeHVwQW5pbWF0aW9uUHJvbWlzZShhbmltYXRpb25GaW5pc2hlZFByb21pc2UpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUuZml4dXBBbmltYXRpb25Qcm9taXNlID0gZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcHJvbWlzZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF90aGVuID0gcHJvbWlzZS50aGVuO1xuICAgICAgICBwcm9taXNlLnRoZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF90aGVuLmFwcGx5KHByb21pc2UsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBfdGhpcy5maXh1cEFuaW1hdGlvblByb21pc2Uocik7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9jYXRjaCA9IHByb21pc2UuY2F0Y2g7XG4gICAgICAgIHByb21pc2UuY2F0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF9jYXRjaC5hcHBseShwcm9taXNlLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgX3RoaXMuZml4dXBBbmltYXRpb25Qcm9taXNlKHIpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUsIFwiaXNQbGF5aW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNQbGF5aW5nO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLl9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWplY3QobmV3IEVycm9yKFwiQW5pbWF0aW9uIGNhbmNlbGxlZC5cIikpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5fY3JlYXRlUHJvcGVydHlBbmltYXRpb25zID0gZnVuY3Rpb24gKGFuaW1hdGlvbkRlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKCFhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYW5pbWF0aW9uIHRhcmdldCBzcGVjaWZpZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGl0ZW0gaW4gYW5pbWF0aW9uRGVmaW5pdGlvbikge1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLm9wYWNpdHkgfHxcbiAgICAgICAgICAgICAgICBpdGVtID09PSBQcm9wZXJ0aWVzLnJvdGF0ZSB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZHVyYXRpb25cIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZGVsYXlcIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiaXRlcmF0aW9uc1wiKSAmJiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgaXRlbSArIFwiIG11c3QgYmUgdmFsaWQgbnVtYmVyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLnNjYWxlIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMudHJhbnNsYXRlKSAmJlxuICAgICAgICAgICAgICAgICh0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXS54ICE9PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dLnkgIT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBQYWlyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT09IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yICYmICFjb2xvcl8xLkNvbG9yLmlzVmFsaWQoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBjb2xvci4gVmFsdWU6IFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpdGVtID09PSBQcm9wZXJ0aWVzLndpZHRoIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnBhcnNlKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9wZXJ0eUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ub3BhY2l0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5vcGFjaXR5LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLm9wYWNpdHksXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgPT09IFwic3RyaW5nXCIgP1xuICAgICAgICAgICAgICAgICAgICBuZXcgY29sb3JfMS5Db2xvcihhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcikgOiBhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLnRyYW5zbGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy50cmFuc2xhdGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24udHJhbnNsYXRlLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuc2NhbGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5yb3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMucm90YXRlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLnJvdGF0ZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMud2lkdGgsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGgsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8ga25vd24gYW5pbWF0aW9uIHByb3BlcnRpZXMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eUFuaW1hdGlvbnM7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLl9nZXRBbmltYXRpb25JbmZvID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb24udGFyZ2V0LmlkLFxuICAgICAgICAgICAgcHJvcGVydHk6IGFuaW1hdGlvbi5wcm9wZXJ0eSxcbiAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb24udmFsdWUsXG4gICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbi5kZWxheSxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbi5jdXJ2ZVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBBbmltYXRpb25CYXNlO1xufSgpKTtcbmV4cG9ydHMuQW5pbWF0aW9uQmFzZSA9IEFuaW1hdGlvbkJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmltYXRpb24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYW5pbWF0aW9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYW5pbWF0aW9uLWNvbW1vblwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBsYXp5XzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbGF6eVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2FuaW1hdGlvbi1jb21tb25cIikpO1xudmFyIGFyZ2JFdmFsdWF0b3I7XG5mdW5jdGlvbiBlbnN1cmVBcmdiRXZhbHVhdG9yKCkge1xuICAgIGlmICghYXJnYkV2YWx1YXRvcikge1xuICAgICAgICBhcmdiRXZhbHVhdG9yID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFyZ2JFdmFsdWF0b3IoKTtcbiAgICB9XG59XG52YXIgZWFzZUluID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IGFuZHJvaWQudmlldy5hbmltYXRpb24uQWNjZWxlcmF0ZUludGVycG9sYXRvcigxKTsgfSk7XG52YXIgZWFzZU91dCA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkRlY2VsZXJhdGVJbnRlcnBvbGF0b3IoMSk7IH0pO1xudmFyIGVhc2VJbk91dCA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkFjY2VsZXJhdGVEZWNlbGVyYXRlSW50ZXJwb2xhdG9yKCk7IH0pO1xudmFyIGxpbmVhciA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkxpbmVhckludGVycG9sYXRvcigpOyB9KTtcbnZhciBib3VuY2UgPSBsYXp5XzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgYW5kcm9pZC52aWV3LmFuaW1hdGlvbi5Cb3VuY2VJbnRlcnBvbGF0b3IoKTsgfSk7XG52YXIga2V5UHJlZml4ID0gXCJ1aS5hbmltYXRpb24uXCI7XG52YXIgcHJvcGVydHlLZXlzID0ge307XG5wcm9wZXJ0eUtleXNbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yXSA9IFN5bWJvbChrZXlQcmVmaXggKyBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3IpO1xucHJvcGVydHlLZXlzW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLm9wYWNpdHldID0gU3ltYm9sKGtleVByZWZpeCArIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLm9wYWNpdHkpO1xucHJvcGVydHlLZXlzW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZV0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMucm90YXRlKTtcbnByb3BlcnR5S2V5c1thbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGUpO1xucHJvcGVydHlLZXlzW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZV0gPSBTeW1ib2woa2V5UHJlZml4ICsgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlKTtcbnByb3BlcnR5S2V5c1thbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5oZWlnaHRdID0gU3ltYm9sKGtleVByZWZpeCArIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmhlaWdodCk7XG5wcm9wZXJ0eUtleXNbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMud2lkdGhdID0gU3ltYm9sKGtleVByZWZpeCArIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLndpZHRoKTtcbmZ1bmN0aW9uIF9yZXNvbHZlQW5pbWF0aW9uQ3VydmUoY3VydmUpIHtcbiAgICBzd2l0Y2ggKGN1cnZlKSB7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5cIjpcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkFjY2VsZXJhdGVJbnRlcnBvbGF0b3IoMSkuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlYXNlSW4oKTtcbiAgICAgICAgY2FzZSBcImVhc2VPdXRcIjpcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkRlY2VsZXJhdGVJbnRlcnBvbGF0b3IoMSkuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlYXNlT3V0KCk7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5PdXRcIjpcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkFjY2VsZXJhdGVEZWNlbGVyYXRlSW50ZXJwb2xhdG9yKCkuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlYXNlSW5PdXQoKTtcbiAgICAgICAgY2FzZSBcImxpbmVhclwiOlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIGFuZHJvaWQudmlldy5hbmltYXRpb24uTGluZWFySW50ZXJwb2xhdG9yKCkuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBsaW5lYXIoKTtcbiAgICAgICAgY2FzZSBcInNwcmluZ1wiOlxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQW5pbWF0aW9uIGN1cnZlIHJlc29sdmVkIHRvIGFuZHJvaWQudmlldy5hbmltYXRpb24uQm91bmNlSW50ZXJwb2xhdG9yKCkuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBib3VuY2UoKTtcbiAgICAgICAgY2FzZSBcImVhc2VcIjpcbiAgICAgICAgICAgIHJldHVybiBhbmRyb2lkeC5jb3JlLnZpZXcuYW5pbWF0aW9uLlBhdGhJbnRlcnBvbGF0b3JDb21wYXQuY3JlYXRlKDAuMjUsIDAuMSwgMC4yNSwgMS4wKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBvcmlnaW5hbDogXCIgKyBjdXJ2ZSwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGN1cnZlIGluc3RhbmNlb2YgYW5pbWF0aW9uX2NvbW1vbl8xLkN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYW5kcm9pZHguY29yZS52aWV3LmFuaW1hdGlvbi5QYXRoSW50ZXJwb2xhdG9yQ29tcGF0LmNyZWF0ZShjdXJ2ZS54MSwgY3VydmUueTEsIGN1cnZlLngyLCBjdXJ2ZS55Mik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjdXJ2ZSAmJiBjdXJ2ZS5nZXRJbnRlcnBvbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnZlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY3VydmUgaW5zdGFuY2VvZiBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkxpbmVhckludGVycG9sYXRvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJ2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYW5pbWF0aW9uIGN1cnZlOiBcIiArIGN1cnZlKTtcbiAgICAgICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLl9yZXNvbHZlQW5pbWF0aW9uQ3VydmUgPSBfcmVzb2x2ZUFuaW1hdGlvbkN1cnZlO1xudmFyIEFuaW1hdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFuaW1hdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmltYXRpb24oYW5pbWF0aW9uRGVmaW5pdGlvbnMsIHBsYXlTZXF1ZW50aWFsbHkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgYW5pbWF0aW9uRGVmaW5pdGlvbnMsIHBsYXlTZXF1ZW50aWFsbHkpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9yZXNldE9uRmluaXNoID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25zLmxlbmd0aCA+IDAgJiYgYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRoYXQgPSBuZXcgV2Vha1JlZihfdGhpcyk7XG4gICAgICAgIF90aGlzLl9hbmltYXRvckxpc3RlbmVyID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLkFuaW1hdG9yTGlzdGVuZXIoe1xuICAgICAgICAgICAgb25BbmltYXRpb25TdGFydDogZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIk1haW5BbmltYXRvckxpc3RlbmVyLm9uQW5kcm9pZEFuaW1hdGlvblN0YXJ0KFwiICsgYW5pbWF0b3IgKyBcIilcIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkFuaW1hdGlvblJlcGVhdDogZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIk1haW5BbmltYXRvckxpc3RlbmVyLm9uQW5pbWF0aW9uUmVwZWF0KFwiICsgYW5pbWF0b3IgKyBcIilcIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkFuaW1hdGlvbkVuZDogZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIk1haW5BbmltYXRvckxpc3RlbmVyLm9uQW5pbWF0aW9uRW5kKFwiICsgYW5pbWF0b3IgKyBcIilcIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgdGhpc1JlZiA9IHRoYXQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1JlZi5fb25BbmRyb2lkQW5pbWF0aW9uRW5kKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQW5pbWF0aW9uQ2FuY2VsOiBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWFpbkFuaW1hdG9yTGlzdGVuZXIub25BbmltYXRpb25DYW5jZWwoXCIgKyBhbmltYXRvciArIFwiKVwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB0aGlzUmVmID0gdGhhdC5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpc1JlZikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzUmVmLl9vbkFuZHJvaWRBbmltYXRpb25DYW5jZWwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIChyZXNldE9uRmluaXNoKSB7XG4gICAgICAgIGlmIChyZXNldE9uRmluaXNoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0T25GaW5pc2ggPSByZXNldE9uRmluaXNoO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzUGxheWluZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlamVjdEFscmVhZHlQbGF5aW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2FuaW1hdG9yU2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGxheSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuaW1hdG9ycyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVBbmltYXRvcnModGhpcy5fcHJvcGVydHlBbmltYXRpb25zW2ldKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRvcnNBcnJheSA9IEFycmF5LmNyZWF0ZShhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvciwgdGhpcy5fYW5pbWF0b3JzLmxlbmd0aCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMiA9IHRoaXMuX2FuaW1hdG9ycy5sZW5ndGg7IGkgPCBsZW5ndGhfMjsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRvcnNBcnJheVtpXSA9IHRoaXMuX2FuaW1hdG9yc1tpXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hbmltYXRvclNldCA9IG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvclNldCgpO1xuICAgICAgICB0aGlzLl9hbmltYXRvclNldC5hZGRMaXN0ZW5lcih0aGlzLl9hbmltYXRvckxpc3RlbmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXkoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNQbGF5aW5nKSB7XG4gICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIkFuaW1hdGlvbiBpcyBub3QgY3VycmVudGx5IHBsYXlpbmcuXCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQ2FuY2VsbGluZyBBbmltYXRvclNldC5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB0aGlzLl9hbmltYXRvclNldC5jYW5jZWwoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZSA9IGZ1bmN0aW9uIChjdXJ2ZSkge1xuICAgICAgICByZXR1cm4gX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShjdXJ2ZSk7XG4gICAgfTtcbiAgICBBbmltYXRpb24ucHJvdG90eXBlLl9wbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gX3N1cGVyLnByb3RvdHlwZS5wbGF5LmNhbGwodGhpcyk7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uIDw9IFwiMjNcIikge1xuICAgICAgICAgICAgdGhpcy5fYW5pbWF0b3JTZXQgPSBuZXcgYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3JTZXQoKTtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LmFkZExpc3RlbmVyKHRoaXMuX2FuaW1hdG9yTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9hbmltYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BsYXlTZXF1ZW50aWFsbHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hbmltYXRvclNldC5wbGF5U2VxdWVudGlhbGx5KHRoaXMuX25hdGl2ZUFuaW1hdG9yc0FycmF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LnBsYXlUb2dldGhlcih0aGlzLl9uYXRpdmVBbmltYXRvcnNBcnJheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJTdGFydGluZyBcIiArIHRoaXMuX25hdGl2ZUFuaW1hdG9yc0FycmF5Lmxlbmd0aCArIFwiIGFuaW1hdGlvbnMgXCIgKyAodGhpcy5fcGxheVNlcXVlbnRpYWxseSA/IFwic2VxdWVudGlhbGx5LlwiIDogXCJ0b2dldGhlci5cIiksIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hbmltYXRvclNldC5zZXR1cFN0YXJ0VmFsdWVzKCk7XG4gICAgICAgIHRoaXMuX2FuaW1hdG9yU2V0LnN0YXJ0KCk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25GaW5pc2hlZFByb21pc2U7XG4gICAgfTtcbiAgICBBbmltYXRpb24ucHJvdG90eXBlLl9vbkFuZHJvaWRBbmltYXRpb25FbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2KCk7IH0pO1xuICAgICAgICB0aGlzLl9yZXNvbHZlQW5pbWF0aW9uRmluaXNoZWRQcm9taXNlKCk7XG4gICAgICAgIGlmICh0aGlzLl9yZXNldE9uRmluaXNoICYmIHRoaXMuX3RhcmdldCkge1xuICAgICAgICAgICAgdGhpcy5fdGFyZ2V0Ll9yZW1vdmVBbmltYXRpb24odGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuX29uQW5kcm9pZEFuaW1hdGlvbkNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcHJvcGVydHlSZXNldENhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB2KCk7IH0pO1xuICAgICAgICB0aGlzLl9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgaWYgKHRoaXMuX3RhcmdldCkge1xuICAgICAgICAgICAgdGhpcy5fdGFyZ2V0Ll9yZW1vdmVBbmltYXRpb24odGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbi5wcm90b3R5cGUuX2NyZWF0ZUFuaW1hdG9ycyA9IGZ1bmN0aW9uIChwcm9wZXJ0eUFuaW1hdGlvbikge1xuICAgICAgICBpZiAoIXByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDcmVhdGluZyBPYmplY3RBbmltYXRvcihzKSBmb3IgYW5pbWF0aW9uOiBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhwcm9wZXJ0eUFuaW1hdGlvbikgKyBcIi4uLlwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldCA9PT0gbnVsbCB8fCBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQW5pbWF0aW9uIHRhcmdldCBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQ7IHByb3BlcnR5OiBcIiArIHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ICsgXCI7IHZhbHVlOiBcIiArIHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlICsgXCI7XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSA9PT0gbnVsbCB8fCBwcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbmltYXRpb24gcHJvcGVydHkgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmVkOyB0YXJnZXQ6IFwiICsgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0ICsgXCI7IHZhbHVlOiBcIiArIHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlICsgXCI7XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZSA9PT0gbnVsbCB8fCBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbmltYXRpb24gdmFsdWUgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmVkOyB0YXJnZXQ6IFwiICsgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0ICsgXCI7IHByb3BlcnR5OiBcIiArIHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ICsgXCI7XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RhcmdldCA9IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldDtcbiAgICAgICAgdmFyIG5hdGl2ZUFycmF5O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgYW5pbWF0b3JzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBwcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgcHJvcGVydHlSZXNldENhbGxiYWNrcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgIHZhciBvcmlnaW5hbFZhbHVlMjtcbiAgICAgICAgdmFyIGRlbnNpdHkgPSB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB2YXIgeHlPYmplY3RBbmltYXRvcnM7XG4gICAgICAgIHZhciBhbmltYXRvclNldDtcbiAgICAgICAgdmFyIGtleSA9IHByb3BlcnR5S2V5c1twcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eV07XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtrZXldID0gcHJvcGVydHlBbmltYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gY2hlY2tBbmltYXRpb24oY2IpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtrZXldID09PSBwcm9wZXJ0eUFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W2tleV07XG4gICAgICAgICAgICAgICAgICAgIGNiKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2V0TG9jYWwgPSB0aGlzLl92YWx1ZVNvdXJjZSA9PT0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgdmFyIHN0eWxlID0gcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlO1xuICAgICAgICBzd2l0Y2ggKHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5KSB7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLm9wYWNpdHk6XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5faW5pdERlZmF1bHROYXRpdmVWYWx1ZShzdHlsZSk7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxWYWx1ZTEgPSBuYXRpdmVWaWV3LmdldEFscGhhKCk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAxKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheVswXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0TG9jYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5Lm5hbWVdID0gb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLm9wYWNpdHkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9ycy5wdXNoKGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJhbHBoYVwiLCBuYXRpdmVBcnJheSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3I6XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5Ll9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlKHN0eWxlKTtcbiAgICAgICAgICAgICAgICBlbnN1cmVBcmdiRXZhbHVhdG9yKCk7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxWYWx1ZTEgPSBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKGphdmEubGFuZy5PYmplY3QsIDIpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LmJhY2tncm91bmRDb2xvciA/IGphdmEubGFuZy5JbnRlZ2VyLnZhbHVlT2YocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LmJhY2tncm91bmRDb2xvci5hcmdiKSA6IGphdmEubGFuZy5JbnRlZ2VyLnZhbHVlT2YoLTEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzFdID0gamF2YS5sYW5nLkludGVnZXIudmFsdWVPZihwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS5hcmdiKTtcbiAgICAgICAgICAgICAgICB2YXIgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yLm9mT2JqZWN0KGFyZ2JFdmFsdWF0b3IsIG5hdGl2ZUFycmF5KTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5hZGRVcGRhdGVMaXN0ZW5lcihuZXcgYW5kcm9pZC5hbmltYXRpb24uVmFsdWVBbmltYXRvci5BbmltYXRvclVwZGF0ZUxpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICAgICAgb25BbmltYXRpb25VcGRhdGU6IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ2IgPSBhbmltYXRvci5nZXRBbmltYXRlZFZhbHVlKCkuaW50VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmtleWZyYW1lXSA9IG5ldyBhbmltYXRpb25fY29tbW9uXzEuQ29sb3IoYXJnYik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlVcGRhdGVDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0TG9jYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9ycy5wdXNoKGFuaW1hdG9yKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlOlxuICAgICAgICAgICAgICAgIHN0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIHN0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCAyKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWUueCAqIGRlbnNpdHk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnNbMF0gPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwidHJhbnNsYXRpb25YXCIsIG5hdGl2ZUFycmF5KTtcbiAgICAgICAgICAgICAgICB4eU9iamVjdEFuaW1hdG9yc1swXS5zZXRSZXBlYXRDb3VudChBbmltYXRpb24uX2dldEFuZHJvaWRSZXBlYXRDb3VudChwcm9wZXJ0eUFuaW1hdGlvbi5pdGVyYXRpb25zKSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAxKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheVswXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLnkgKiBkZW5zaXR5O1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzFdID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcInRyYW5zbGF0aW9uWVwiLCBuYXRpdmVBcnJheSk7XG4gICAgICAgICAgICAgICAgeHlPYmplY3RBbmltYXRvcnNbMV0uc2V0UmVwZWF0Q291bnQoQW5pbWF0aW9uLl9nZXRBbmRyb2lkUmVwZWF0Q291bnQocHJvcGVydHlBbmltYXRpb24uaXRlcmF0aW9ucykpO1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsVmFsdWUxID0gbmF0aXZlVmlldy5nZXRUcmFuc2xhdGlvblgoKSAvIGRlbnNpdHk7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxWYWx1ZTIgPSBuYXRpdmVWaWV3LmdldFRyYW5zbGF0aW9uWSgpIC8gZGVuc2l0eTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcy5wdXNoKGNoZWNrQW5pbWF0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS54O1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlLnk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5UmVzZXRDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXRMb2NhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5Lm5hbWVdID0gb3JpZ2luYWxWYWx1ZTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IG9yaWdpbmFsVmFsdWUyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkuc2V0TmF0aXZlXShwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGUudHJhbnNsYXRlWCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZS50cmFuc2xhdGVZKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvclNldCA9IG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvclNldCgpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yU2V0LnBsYXlUb2dldGhlcih4eU9iamVjdEFuaW1hdG9ycyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JTZXQuc2V0dXBTdGFydFZhbHVlcygpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9ycy5wdXNoKGFuaW1hdG9yU2V0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGU6XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5Ll9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlKHN0eWxlKTtcbiAgICAgICAgICAgICAgICBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCAyKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWUueDtcbiAgICAgICAgICAgICAgICB4eU9iamVjdEFuaW1hdG9yc1swXSA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJzY2FsZVhcIiwgbmF0aXZlQXJyYXkpO1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzBdLnNldFJlcGVhdENvdW50KEFuaW1hdGlvbi5fZ2V0QW5kcm9pZFJlcGVhdENvdW50KHByb3BlcnR5QW5pbWF0aW9uLml0ZXJhdGlvbnMpKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWUueTtcbiAgICAgICAgICAgICAgICB4eU9iamVjdEFuaW1hdG9yc1sxXSA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJzY2FsZVlcIiwgbmF0aXZlQXJyYXkpO1xuICAgICAgICAgICAgICAgIHh5T2JqZWN0QW5pbWF0b3JzWzFdLnNldFJlcGVhdENvdW50KEFuaW1hdGlvbi5fZ2V0QW5kcm9pZFJlcGVhdENvdW50KHByb3BlcnR5QW5pbWF0aW9uLml0ZXJhdGlvbnMpKTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMSA9IG5hdGl2ZVZpZXcuZ2V0U2NhbGVYKCk7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxWYWx1ZTIgPSBuYXRpdmVWaWV3LmdldFNjYWxlWSgpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS54O1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZS55O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0TG9jYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkua2V5ZnJhbWVdID0gb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LmtleWZyYW1lXSA9IG9yaWdpbmFsVmFsdWUyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZS5zY2FsZVgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0W3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZS5zY2FsZVkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yU2V0ID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yU2V0KCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JTZXQucGxheVRvZ2V0aGVyKHh5T2JqZWN0QW5pbWF0b3JzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvclNldC5zZXR1cFN0YXJ0VmFsdWVzKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goYW5pbWF0b3JTZXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5yb3RhdGU6XG4gICAgICAgICAgICAgICAgc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5Ll9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlKHN0eWxlKTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMSA9IG5hdGl2ZVZpZXcuZ2V0Um90YXRpb24oKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheSA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDEpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5WzBdID0gcHJvcGVydHlBbmltYXRpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlVcGRhdGVDYWxsYmFja3MucHVzaChjaGVja0FuaW1hdGlvbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0TG9jYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkubmFtZV0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkua2V5ZnJhbWVdID0gb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXRbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlLnJvdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChuYXRpdmVWaWV3LCBcInJvdGF0aW9uXCIsIG5hdGl2ZUFycmF5KSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLndpZHRoOlxuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5oZWlnaHQ6IHtcbiAgICAgICAgICAgICAgICB2YXIgaXNWZXJ0aWNhbCA9IHByb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5ID09PSBcImhlaWdodFwiO1xuICAgICAgICAgICAgICAgIHZhciBleHRlbnRQcm9wZXJ0eV8xID0gaXNWZXJ0aWNhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eSA6IHN0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5O1xuICAgICAgICAgICAgICAgIGV4dGVudFByb3BlcnR5XzEuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUoc3R5bGUpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFyIHRvVmFsdWUgPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzEgPSBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQucGFyZW50O1xuICAgICAgICAgICAgICAgIGlmICghcGFyZW50XzEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2Fubm90IGFuaW1hdGUgXCIgKyBwcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSArIFwiIG9uIHJvb3Qgdmlld1wiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudEV4dGVudCA9IGlzVmVydGljYWwgPyBwYXJlbnRfMS5nZXRNZWFzdXJlZEhlaWdodCgpIDogcGFyZW50XzEuZ2V0TWVhc3VyZWRXaWR0aCgpO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyh0b1ZhbHVlLCBwYXJlbnRFeHRlbnQsIHBhcmVudEV4dGVudCkgLyBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLnNjYWxlO1xuICAgICAgICAgICAgICAgIHZhciBuYXRpdmVIZWlnaHQgPSBpc1ZlcnRpY2FsID8gbmF0aXZlVmlldy5nZXRIZWlnaHQoKSA6IG5hdGl2ZVZpZXcuZ2V0V2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0U3R5bGVfMSA9IHNldExvY2FsID8gZXh0ZW50UHJvcGVydHlfMS5uYW1lIDogZXh0ZW50UHJvcGVydHlfMS5rZXlmcmFtZTtcbiAgICAgICAgICAgICAgICBvcmlnaW5hbFZhbHVlMSA9IG5hdGl2ZUhlaWdodCAvIHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4uc2NhbGU7XG4gICAgICAgICAgICAgICAgbmF0aXZlQXJyYXlbMF0gPSBvcmlnaW5hbFZhbHVlMTtcbiAgICAgICAgICAgICAgICBuYXRpdmVBcnJheVsxXSA9IHRvVmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGV4dGVudEFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uVmFsdWVBbmltYXRvci5vZkZsb2F0KG5hdGl2ZUFycmF5KTtcbiAgICAgICAgICAgICAgICBleHRlbnRBbmltYXRvci5hZGRVcGRhdGVMaXN0ZW5lcihuZXcgYW5kcm9pZC5hbmltYXRpb24uVmFsdWVBbmltYXRvci5BbmltYXRvclVwZGF0ZUxpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICAgICAgb25BbmltYXRpb25VcGRhdGU6IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ2IgPSBhbmltYXRvci5nZXRBbmltYXRlZFZhbHVlKCkuZmxvYXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gZXh0ZW50UHJvcGVydHlfMS5uYW1lIDogZXh0ZW50UHJvcGVydHlfMS5rZXlmcmFtZV0gPSBhcmdiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHByb3BlcnR5VXBkYXRlQ2FsbGJhY2tzLnB1c2goY2hlY2tBbmltYXRpb24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuc3R5bGVbdGFyZ2V0U3R5bGVfMV0gPSBwcm9wZXJ0eUFuaW1hdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgcHJvcGVydHlSZXNldENhbGxiYWNrcy5wdXNoKGNoZWNrQW5pbWF0aW9uKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3RhcmdldFN0eWxlXzFdID0gb3JpZ2luYWxWYWx1ZTE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNldHRlciA9IHByb3BlcnR5QW5pbWF0aW9uLnRhcmdldFtleHRlbnRQcm9wZXJ0eV8xLnNldE5hdGl2ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0ZXIocHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlW3Byb3BlcnR5QW5pbWF0aW9uLnByb3BlcnR5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzLnB1c2goZXh0ZW50QW5pbWF0b3IpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBbmltYXRpbmcgcHJvcGVydHkgJ1wiICsgcHJvcGVydHlBbmltYXRpb24ucHJvcGVydHkgKyBcIicgaXMgdW5zdXBwb3J0ZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8zID0gYW5pbWF0b3JzLmxlbmd0aDsgaSA8IGxlbmd0aF8zOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi5kdXJhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzW2ldLnNldER1cmF0aW9uKHByb3BlcnR5QW5pbWF0aW9uLmR1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi5kZWxheSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzW2ldLnNldFN0YXJ0RGVsYXkocHJvcGVydHlBbmltYXRpb24uZGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3BlcnR5QW5pbWF0aW9uLml0ZXJhdGlvbnMgIT09IHVuZGVmaW5lZCAmJiBhbmltYXRvcnNbaV0gaW5zdGFuY2VvZiBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzW2ldLnNldFJlcGVhdENvdW50KEFuaW1hdGlvbi5fZ2V0QW5kcm9pZFJlcGVhdENvdW50KHByb3BlcnR5QW5pbWF0aW9uLml0ZXJhdGlvbnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbi5jdXJ2ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3JzW2ldLnNldEludGVycG9sYXRvcihwcm9wZXJ0eUFuaW1hdGlvbi5jdXJ2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRvciBjcmVhdGVkOiBcIiArIGFuaW1hdG9yc1tpXSwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuaW1hdG9ycyA9IHRoaXMuX2FuaW1hdG9ycy5jb25jYXQoYW5pbWF0b3JzKTtcbiAgICAgICAgdGhpcy5fcHJvcGVydHlVcGRhdGVDYWxsYmFja3MgPSB0aGlzLl9wcm9wZXJ0eVVwZGF0ZUNhbGxiYWNrcy5jb25jYXQocHJvcGVydHlVcGRhdGVDYWxsYmFja3MpO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2tzID0gdGhpcy5fcHJvcGVydHlSZXNldENhbGxiYWNrcy5jb25jYXQocHJvcGVydHlSZXNldENhbGxiYWNrcyk7XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2dldEFuZHJvaWRSZXBlYXRDb3VudCA9IGZ1bmN0aW9uIChpdGVyYXRpb25zKSB7XG4gICAgICAgIHJldHVybiAoaXRlcmF0aW9ucyA9PT0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSA/IGFuZHJvaWQudmlldy5hbmltYXRpb24uQW5pbWF0aW9uLklORklOSVRFIDogaXRlcmF0aW9ucyAtIDE7XG4gICAgfTtcbiAgICByZXR1cm4gQW5pbWF0aW9uO1xufShhbmltYXRpb25fY29tbW9uXzEuQW5pbWF0aW9uQmFzZSkpO1xuZXhwb3J0cy5BbmltYXRpb24gPSBBbmltYXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmltYXRpb24uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW51bXNfMSA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi9hbmltYXRpb25cIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBLZXlmcmFtZXMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lcygpIHtcbiAgICB9XG4gICAgcmV0dXJuIEtleWZyYW1lcztcbn0oKSk7XG5leHBvcnRzLktleWZyYW1lcyA9IEtleWZyYW1lcztcbnZhciBVbnBhcnNlZEtleWZyYW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBVbnBhcnNlZEtleWZyYW1lKCkge1xuICAgIH1cbiAgICByZXR1cm4gVW5wYXJzZWRLZXlmcmFtZTtcbn0oKSk7XG5leHBvcnRzLlVucGFyc2VkS2V5ZnJhbWUgPSBVbnBhcnNlZEtleWZyYW1lO1xudmFyIEtleWZyYW1lRGVjbGFyYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lRGVjbGFyYXRpb24oKSB7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZURlY2xhcmF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVEZWNsYXJhdGlvbiA9IEtleWZyYW1lRGVjbGFyYXRpb247XG52YXIgS2V5ZnJhbWVJbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUluZm8oKSB7XG4gICAgICAgIHRoaXMuY3VydmUgPSBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2U7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZUluZm87XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZUluZm8gPSBLZXlmcmFtZUluZm87XG52YXIgS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbkluZm8oKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZHVyYXRpb24gPSAwLjM7XG4gICAgICAgIHRoaXMuZGVsYXkgPSAwO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAxO1xuICAgICAgICB0aGlzLmN1cnZlID0gXCJlYXNlXCI7XG4gICAgICAgIHRoaXMuaXNGb3J3YXJkcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xudmFyIEtleWZyYW1lQW5pbWF0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbigpIHtcbiAgICAgICAgdGhpcy5kZWxheSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDE7XG4gICAgfVxuICAgIEtleWZyYW1lQW5pbWF0aW9uLmtleWZyYW1lQW5pbWF0aW9uRnJvbUluZm8gPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICB2YXIgbGVuZ3RoID0gaW5mby5rZXlmcmFtZXMubGVuZ3RoO1xuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgc3RhcnREdXJhdGlvbiA9IDA7XG4gICAgICAgIGlmIChpbmZvLmlzUmV2ZXJzZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMSA9IGxlbmd0aCAtIDE7IGluZGV4XzEgPj0gMDsgaW5kZXhfMS0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gaW5mby5rZXlmcmFtZXNbaW5kZXhfMV07XG4gICAgICAgICAgICAgICAgc3RhcnREdXJhdGlvbiA9IEtleWZyYW1lQW5pbWF0aW9uLnBhcnNlS2V5ZnJhbWUoaW5mbywga2V5ZnJhbWUsIGFuaW1hdGlvbnMsIHN0YXJ0RHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMiA9IDA7IGluZGV4XzIgPCBsZW5ndGg7IGluZGV4XzIrKykge1xuICAgICAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IGluZm8ua2V5ZnJhbWVzW2luZGV4XzJdO1xuICAgICAgICAgICAgICAgIHN0YXJ0RHVyYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbi5wYXJzZUtleWZyYW1lKGluZm8sIGtleWZyYW1lLCBhbmltYXRpb25zLCBzdGFydER1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4XzMgPSBsZW5ndGggLSAxOyBpbmRleF8zID4gMDsgaW5kZXhfMy0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGExID0gYW5pbWF0aW9uc1tpbmRleF8zXTtcbiAgICAgICAgICAgICAgICB2YXIgYTIgPSBhbmltYXRpb25zW2luZGV4XzMgLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAoYTJbXCJjdXJ2ZVwiXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGExW1wiY3VydmVcIl0gPSBhMltcImN1cnZlXCJdO1xuICAgICAgICAgICAgICAgICAgICBhMltcImN1cnZlXCJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb25zLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYVtcImN1cnZlXCJdID8gYSA6IE9iamVjdC5hc3NpZ24oYSwgeyBjdXJ2ZTogaW5mby5jdXJ2ZSB9KTsgfSk7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSBuZXcgS2V5ZnJhbWVBbmltYXRpb24oKTtcbiAgICAgICAgYW5pbWF0aW9uLmRlbGF5ID0gaW5mby5kZWxheTtcbiAgICAgICAgYW5pbWF0aW9uLml0ZXJhdGlvbnMgPSBpbmZvLml0ZXJhdGlvbnM7XG4gICAgICAgIGFuaW1hdGlvbi5hbmltYXRpb25zID0gYW5pbWF0aW9ucztcbiAgICAgICAgYW5pbWF0aW9uLl9pc0ZvcndhcmRzID0gaW5mby5pc0ZvcndhcmRzO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucGFyc2VLZXlmcmFtZSA9IGZ1bmN0aW9uIChpbmZvLCBrZXlmcmFtZSwgYW5pbWF0aW9ucywgc3RhcnREdXJhdGlvbikge1xuICAgICAgICB2YXIgYW5pbWF0aW9uID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBrZXlmcmFtZS5kZWNsYXJhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZGVjbGFyYXRpb24gPSBfYVtfaV07XG4gICAgICAgICAgICBhbmltYXRpb25bZGVjbGFyYXRpb24ucHJvcGVydHldID0gZGVjbGFyYXRpb24udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGR1cmF0aW9uID0ga2V5ZnJhbWUuZHVyYXRpb247XG4gICAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAwLjAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAoaW5mby5kdXJhdGlvbiAqIGR1cmF0aW9uKSAtIHN0YXJ0RHVyYXRpb247XG4gICAgICAgICAgICBzdGFydER1cmF0aW9uICs9IGR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbi5kdXJhdGlvbiA9IGluZm8uaXNSZXZlcnNlID8gaW5mby5kdXJhdGlvbiAtIGR1cmF0aW9uIDogZHVyYXRpb247XG4gICAgICAgIGFuaW1hdGlvbi5jdXJ2ZSA9IGtleWZyYW1lLmN1cnZlO1xuICAgICAgICBhbmltYXRpb24uZm9yY2VMYXllciA9IHRydWU7XG4gICAgICAgIGFuaW1hdGlvbi52YWx1ZVNvdXJjZSA9IFwia2V5ZnJhbWVcIjtcbiAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgIHJldHVybiBzdGFydER1cmF0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZSwgXCJpc1BsYXlpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1BsYXlpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJLZXlmcmFtZSBhbmltYXRpb24gaXMgYWxyZWFkeSBwbGF5aW5nLlwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuX25hdGl2ZUFuaW1hdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmlzUGxheWluZykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1swXTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHRoaXMuX3RhcmdldCwgYW5pbWF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNldEFuaW1hdGlvbnMoKTtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuX2lzUGxheWluZykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lIGFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgIF90aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdmlldztcbiAgICAgICAgaWYgKHRoaXMuZGVsYXkgIT09IDApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYW5pbWF0ZSh2aWV3LCAwLCBfdGhpcy5pdGVyYXRpb25zKTsgfSwgdGhpcy5kZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgdGhpcy5pdGVyYXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiAodmlldywgaW5kZXgsIGl0ZXJhdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLl9pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB0aGlzLmFuaW1hdGlvbnNbMF07XG4gICAgICAgICAgICBpZiAoXCJiYWNrZ3JvdW5kQ29sb3JcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueDtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInRyYW5zbGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24udHJhbnNsYXRlLng7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi50cmFuc2xhdGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInJvdGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5yb3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5vcGFjaXR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuaGVpZ2h0UHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcIndpZHRoXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24ud2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFuaW1hdGUodmlldywgMSwgaXRlcmF0aW9ucyk7IH0sIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpdGVyYXRpb25zIC09IDE7XG4gICAgICAgICAgICBpZiAoaXRlcmF0aW9ucyA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgaXRlcmF0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNGb3J3YXJkcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uc1t0aGlzLmFuaW1hdGlvbnMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHZpZXcsIGFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgY2FjaGVkQW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1tpbmRleCAtIDFdO1xuICAgICAgICAgICAgaWYgKGNhY2hlZEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IGNhY2hlZEFuaW1hdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb25EZWYgPSB0aGlzLmFuaW1hdGlvbnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkRlZi50YXJnZXQgPSB2aWV3O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IG5ldyBhbmltYXRpb25fMS5BbmltYXRpb24oW2FuaW1hdGlvbkRlZl0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzTGFzdEl0ZXJhdGlvbiA9IGl0ZXJhdGlvbnMgLSAxIDw9IDA7XG4gICAgICAgICAgICBhbmltYXRpb24ucGxheShpc0xhc3RJdGVyYXRpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFuaW1hdGUodmlldywgaW5kZXggKyAxLCBpdGVyYXRpb25zKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiID8gZXJyb3IgOiBlcnJvci5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIgPyBlcnJvciA6IGVycm9yLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLl9yZXNvbHZlQW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90YXJnZXQgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wcm90b3R5cGUuX3Jlc2V0QW5pbWF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbmF0aXZlQW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzZXRBbmltYXRpb25WYWx1ZXMgPSBmdW5jdGlvbiAodmlldywgYW5pbWF0aW9uKSB7XG4gICAgICAgIGlmIChcImJhY2tncm91bmRDb2xvclwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwidHJhbnNsYXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwicm90YXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJ3aWR0aFwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEtleWZyYW1lQW5pbWF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtleWZyYW1lLWFuaW1hdGlvbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpO1xudmFyIEJvcmRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJvcmRlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCb3JkZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJvcmRlci5wcm90b3R5cGUsIFwiY29ybmVyUmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuYm9yZGVyUmFkaXVzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyUmFkaXVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmJvcmRlclJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCb3JkZXIucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSBjb250ZW50X3ZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gY29udGVudF92aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGNvbnRlbnRfdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGNvbnRlbnRfdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaG9yaXpvbnRhbEJvcmRlckxlbmd0aCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoO1xuICAgICAgICB2YXIgdmVydGljYWxCb3JkZXJMZW5ndGggPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGNvbnRlbnRfdmlld18xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMsIHRoaXMubGF5b3V0VmlldywgY29udGVudF92aWV3XzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyh3aWR0aCAtIGhvcml6b250YWxCb3JkZXJMZW5ndGgsIHdpZHRoTW9kZSksIGNvbnRlbnRfdmlld18xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoaGVpZ2h0IC0gdmVydGljYWxCb3JkZXJMZW5ndGgsIGhlaWdodE1vZGUpKTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBjb250ZW50X3ZpZXdfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUocmVzdWx0Lm1lYXN1cmVkV2lkdGggKyBob3Jpem9udGFsQm9yZGVyTGVuZ3RoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gY29udGVudF92aWV3XzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHJlc3VsdC5tZWFzdXJlZEhlaWdodCArIHZlcnRpY2FsQm9yZGVyTGVuZ3RoLCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIEJvcmRlci5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciBob3Jpem9udGFsQm9yZGVyTGVuZ3RoID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgIHZhciB2ZXJ0aWNhbEJvcmRlckxlbmd0aCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICBjb250ZW50X3ZpZXdfMS5WaWV3LmxheW91dENoaWxkKHRoaXMsIHRoaXMubGF5b3V0VmlldywgdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGgsIHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGgsIHJpZ2h0IC0gbGVmdCAtIGhvcml6b250YWxCb3JkZXJMZW5ndGgsIGJvdHRvbSAtIHRvcCAtIHZlcnRpY2FsQm9yZGVyTGVuZ3RoKTtcbiAgICB9O1xuICAgIEJvcmRlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBEZXByZWNhdGVkLFxuICAgICAgICBjb250ZW50X3ZpZXdfMS5DU1NUeXBlKFwiQm9yZGVyXCIpXG4gICAgXSwgQm9yZGVyKTtcbiAgICByZXR1cm4gQm9yZGVyO1xufShjb250ZW50X3ZpZXdfMS5Db250ZW50VmlldykpO1xuZXhwb3J0cy5Cb3JkZXIgPSBCb3JkZXI7XG5Cb3JkZXIucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ib3JkZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0YWJfc3RyaXBfMSA9IHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiKTtcbnZhciB0YWJfc3RyaXBfaXRlbV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG52YXIgaW1hZ2Vfc291cmNlXzEgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2Utc291cmNlXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4uL2ZyYW1lXCIpO1xudmFyIHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2VcIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItbmF2aWdhdGlvbi1iYXNlXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiKSk7XG52YXIgUFJJTUFSWV9DT0xPUiA9IFwiY29sb3JQcmltYXJ5XCI7XG52YXIgREVGQVVMVF9FTEVWQVRJT04gPSA4O1xudmFyIFRBQklEID0gXCJfdGFiSWRcIjtcbnZhciBJTkRFWCA9IFwiX2luZGV4XCI7XG52YXIgb3duZXJTeW1ib2wgPSBTeW1ib2woXCJfb3duZXJcIik7XG52YXIgVGFiRnJhZ21lbnQ7XG52YXIgQm90dG9tTmF2aWdhdGlvbkJhcjtcbnZhciBBdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyO1xuZnVuY3Rpb24gbWFrZUZyYWdtZW50TmFtZSh2aWV3SWQsIGlkKSB7XG4gICAgcmV0dXJuIFwiYW5kcm9pZDpib3R0b21uYXZpZ2F0aW9uOlwiICsgdmlld0lkICsgXCI6XCIgKyBpZDtcbn1cbmZ1bmN0aW9uIGdldFRhYkJ5SWQoaWQpIHtcbiAgICB2YXIgcmVmID0gZXhwb3J0cy50YWJzLmZpbmQoZnVuY3Rpb24gKHJlZikge1xuICAgICAgICB2YXIgdGFiID0gcmVmLmdldCgpO1xuICAgICAgICByZXR1cm4gdGFiICYmIHRhYi5fZG9tSWQgPT09IGlkO1xuICAgIH0pO1xuICAgIHJldHVybiByZWYgJiYgcmVmLmdldCgpO1xufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKSB7XG4gICAgaWYgKEJvdHRvbU5hdmlnYXRpb25CYXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ubmV3SW5zdGFuY2UgPSBmdW5jdGlvbiAodGFiSWQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBhbmRyb2lkLm9zLkJ1bmRsZSgpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoVEFCSUQsIHRhYklkKTtcbiAgICAgICAgICAgIGFyZ3MucHV0SW50KElOREVYLCBpbmRleCk7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBuZXcgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgICAgICAgZnJhZ21lbnQuc2V0QXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9O1xuICAgICAgICBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZSA9IGZ1bmN0aW9uIChzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGUuY2FsbCh0aGlzLCBzYXZlZEluc3RhbmNlU3RhdGUpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmdldEFyZ3VtZW50cygpO1xuICAgICAgICAgICAgdGhpcy50YWIgPSBnZXRUYWJCeUlkKGFyZ3MuZ2V0SW50KFRBQklEKSk7XG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gYXJncy5nZXRJbnQoSU5ERVgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRhYikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIEJvdHRvbU5hdmlnYXRpb25cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlVmlldyA9IGZ1bmN0aW9uIChpbmZsYXRlciwgY29udGFpbmVyLCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciB0YWJJdGVtID0gdGhpcy50YWIuaXRlbXNbdGhpcy5pbmRleF07XG4gICAgICAgICAgICByZXR1cm4gdGFiSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbjtcbiAgICB9KG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5GcmFnbWVudEJhc2UpKTtcbiAgICB2YXIgQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEJvdHRvbU5hdmlnYXRpb25CYXJJbXBsZW1lbnRhdGlvbiwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uKGNvbnRleHQsIG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250ZXh0KSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEJvdHRvbU5hdmlnYXRpb25CYXJJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TZWxlY3RlZFBvc2l0aW9uQ2hhbmdlID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBwcmV2UG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3duZXIuY2hhbmdlVGFiKHBvc2l0aW9uKTtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcEl0ZW1zID0gb3duZXIudGFiU3RyaXAgJiYgb3duZXIudGFiU3RyaXAuaXRlbXM7XG4gICAgICAgICAgICBpZiAocG9zaXRpb24gPj0gMCAmJiB0YWJTdHJpcEl0ZW1zICYmIHRhYlN0cmlwSXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0uc2VsZWN0RXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZXZQb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXMgJiYgdGFiU3RyaXBJdGVtc1twcmV2UG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twcmV2UG9zaXRpb25dLl9lbWl0KHRhYl9zdHJpcF9pdGVtXzEuVGFiU3RyaXBJdGVtLnVuc2VsZWN0RXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3duZXIuc2VsZWN0ZWRJbmRleCA9IHBvc2l0aW9uO1xuICAgICAgICB9O1xuICAgICAgICBCb3R0b21OYXZpZ2F0aW9uQmFySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uVGFwID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJTdHJpcCA9IG93bmVyLnRhYlN0cmlwO1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwSXRlbXMgPSB0YWJTdHJpcCAmJiB0YWJTdHJpcC5pdGVtcztcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0udGFwRXZlbnQpO1xuICAgICAgICAgICAgICAgIHRhYlN0cmlwLm5vdGlmeSh7IGV2ZW50TmFtZTogdGFiX3N0cmlwXzEuVGFiU3RyaXAuaXRlbVRhcEV2ZW50LCBvYmplY3Q6IHRhYlN0cmlwLCBpbmRleDogcG9zaXRpb24gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW93bmVyLml0ZW1zW3Bvc2l0aW9uXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQm90dG9tTmF2aWdhdGlvbkJhckltcGxlbWVudGF0aW9uO1xuICAgIH0ob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkJvdHRvbU5hdmlnYXRpb25CYXIpKTtcbiAgICB2YXIgQXR0YWNoTGlzdGVuZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQXR0YWNoTGlzdGVuZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEF0dGFjaExpc3RlbmVyKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEF0dGFjaExpc3RlbmVyLnByb3RvdHlwZS5vblZpZXdBdHRhY2hlZFRvV2luZG93ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHZpZXdbb3duZXJTeW1ib2xdO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX29uQXR0YWNoZWRUb1dpbmRvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdHRhY2hMaXN0ZW5lci5wcm90b3R5cGUub25WaWV3RGV0YWNoZWRGcm9tV2luZG93ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHZpZXdbb3duZXJTeW1ib2xdO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX29uRGV0YWNoZWRGcm9tV2luZG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEF0dGFjaExpc3RlbmVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLnZpZXcuVmlldy5PbkF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXJdKVxuICAgICAgICBdLCBBdHRhY2hMaXN0ZW5lcik7XG4gICAgICAgIHJldHVybiBBdHRhY2hMaXN0ZW5lcjtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBUYWJGcmFnbWVudCA9IFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb247XG4gICAgQm90dG9tTmF2aWdhdGlvbkJhciA9IEJvdHRvbU5hdmlnYXRpb25CYXJJbXBsZW1lbnRhdGlvbjtcbiAgICBBdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyID0gbmV3IEF0dGFjaExpc3RlbmVyKCk7XG59XG5mdW5jdGlvbiBzZXRFbGV2YXRpb24oYm90dG9tTmF2aWdhdGlvbkJhcikge1xuICAgIHZhciBjb21wYXQgPSBhbmRyb2lkeC5jb3JlLnZpZXcuVmlld0NvbXBhdDtcbiAgICBpZiAoY29tcGF0LnNldEVsZXZhdGlvbikge1xuICAgICAgICB2YXIgdmFsID0gREVGQVVMVF9FTEVWQVRJT04gKiB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICBjb21wYXQuc2V0RWxldmF0aW9uKGJvdHRvbU5hdmlnYXRpb25CYXIsIHZhbCk7XG4gICAgfVxufVxuZXhwb3J0cy50YWJzID0gbmV3IEFycmF5KCk7XG5mdW5jdGlvbiBpdGVyYXRlSW5kZXhSYW5nZShpbmRleCwgZXBzLCBsYXN0SW5kZXgsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHJhbmdlU3RhcnQgPSBNYXRoLm1heCgwLCBpbmRleCAtIGVwcyk7XG4gICAgdmFyIHJhbmdlRW5kID0gTWF0aC5taW4oaW5kZXggKyBlcHMsIGxhc3RJbmRleCk7XG4gICAgZm9yICh2YXIgaSA9IHJhbmdlU3RhcnQ7IGkgPD0gcmFuZ2VFbmQ7IGkrKykge1xuICAgICAgICBjYWxsYmFjayhpKTtcbiAgICB9XG59XG52YXIgQm90dG9tTmF2aWdhdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJvdHRvbU5hdmlnYXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQm90dG9tTmF2aWdhdGlvbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRWaWV3SWQgPSAtMTtcbiAgICAgICAgX3RoaXMuX2F0dGFjaGVkVG9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgZXhwb3J0cy50YWJzLnB1c2gobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUsIFwiX2hhc0ZyYWdtZW50c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkLmNhbGwodGhpcywgb2xkSXRlbXMsIG5ld0l0ZW1zKTtcbiAgICAgICAgaWYgKG9sZEl0ZW1zKSB7XG4gICAgICAgICAgICBvbGRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBpdGVtLnRhYkl0ZW1TcGVjID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpdGVtLnNldE5hdGl2ZVZpZXcobnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKTtcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZExheW91dChjb250ZXh0KTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLmF1dG8pKTtcbiAgICAgICAgdmFyIGNvbnRlbnRWaWV3ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db250ZW50TGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICB2YXIgY29udGVudFZpZXdMYXlvdXRQYXJhbXMgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICBjb250ZW50Vmlld0xheW91dFBhcmFtcy5yb3cgPSAwO1xuICAgICAgICBjb250ZW50Vmlldy5zZXRMYXlvdXRQYXJhbXMoY29udGVudFZpZXdMYXlvdXRQYXJhbXMpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFZpZXcoY29udGVudFZpZXcpO1xuICAgICAgICBuYXRpdmVWaWV3LmNvbnRlbnRWaWV3ID0gY29udGVudFZpZXc7XG4gICAgICAgIHZhciBib3R0b21OYXZpZ2F0aW9uQmFyID0gbmV3IEJvdHRvbU5hdmlnYXRpb25CYXIoY29udGV4dCwgdGhpcyk7XG4gICAgICAgIHZhciBib3R0b21OYXZpZ2F0aW9uQmFyTGF5b3V0UGFyYW1zID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgYm90dG9tTmF2aWdhdGlvbkJhckxheW91dFBhcmFtcy5yb3cgPSAxO1xuICAgICAgICBib3R0b21OYXZpZ2F0aW9uQmFyLnNldExheW91dFBhcmFtcyhib3R0b21OYXZpZ2F0aW9uQmFyTGF5b3V0UGFyYW1zKTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRWaWV3KGJvdHRvbU5hdmlnYXRpb25CYXIpO1xuICAgICAgICBuYXRpdmVWaWV3LmJvdHRvbU5hdmlnYXRpb25CYXIgPSBib3R0b21OYXZpZ2F0aW9uQmFyO1xuICAgICAgICBzZXRFbGV2YXRpb24oYm90dG9tTmF2aWdhdGlvbkJhcik7XG4gICAgICAgIHZhciBwcmltYXJ5Q29sb3IgPSB1dGlsc18xLmFkLnJlc291cmNlcy5nZXRQYWxldHRlQ29sb3IoUFJJTUFSWV9DT0xPUiwgY29udGV4dCk7XG4gICAgICAgIGlmIChwcmltYXJ5Q29sb3IpIHtcbiAgICAgICAgICAgIGJvdHRvbU5hdmlnYXRpb25CYXIuc2V0QmFja2dyb3VuZENvbG9yKHByaW1hcnlDb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXc7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5fY29udGVudFZpZXdJZCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRWaWV3SWQgPSBhbmRyb2lkLnZpZXcuVmlldy5nZW5lcmF0ZVZpZXdJZCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZE9uQXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lcihBdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlld1tvd25lclN5bWJvbF0gPSB0aGlzO1xuICAgICAgICB0aGlzLl9jb250ZW50VmlldyA9IG5hdGl2ZVZpZXcuY29udGVudFZpZXc7XG4gICAgICAgIHRoaXMuX2NvbnRlbnRWaWV3LnNldElkKHRoaXMuX2NvbnRlbnRWaWV3SWQpO1xuICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyID0gbmF0aXZlVmlldy5ib3R0b21OYXZpZ2F0aW9uQmFyO1xuICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLm93bmVyID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMudGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMudGFiU3RyaXAuc2V0TmF0aXZlVmlldyh0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX2xvYWRVbmxvYWRUYWJJdGVtcyA9IGZ1bmN0aW9uIChuZXdJbmRleCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICB2YXIgbGFzdEluZGV4ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgb2Zmc2lkZUl0ZW1zID0gMDtcbiAgICAgICAgdmFyIHRvVW5sb2FkID0gW107XG4gICAgICAgIHZhciB0b0xvYWQgPSBbXTtcbiAgICAgICAgaXRlcmF0ZUluZGV4UmFuZ2UobmV3SW5kZXgsIG9mZnNpZGVJdGVtcywgbGFzdEluZGV4LCBmdW5jdGlvbiAoaSkgeyByZXR1cm4gdG9Mb2FkLnB1c2goaSk7IH0pO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhPZkkgPSB0b0xvYWQuaW5kZXhPZihpKTtcbiAgICAgICAgICAgIGlmIChpbmRleE9mSSA8IDApIHtcbiAgICAgICAgICAgICAgICB0b1VubG9hZC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdG9VbmxvYWQuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIGl0ZW0udW5sb2FkVmlldyhpdGVtLmNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG5ld0l0ZW0gPSBpdGVtc1tuZXdJbmRleF07XG4gICAgICAgIHZhciBzZWxlY3RlZFZpZXcgPSBuZXdJdGVtICYmIG5ld0l0ZW0uY29udGVudDtcbiAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkVmlldy5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRvTG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2FkZWQgJiYgaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5sb2FkVmlldyhpdGVtLmNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLnRhYlN0cmlwKSB7XG4gICAgICAgICAgICB0aGlzLnNldFRhYlN0cmlwSXRlbXModGhpcy50YWJTdHJpcC5pdGVtcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2F0dGFjaGVkVG9XaW5kb3cpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlVGFiKHRoaXMuc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLl9vbkF0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9hdHRhY2hlZFRvV2luZG93ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VUYWIodGhpcy5zZWxlY3RlZEluZGV4KTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLl9vbkRldGFjaGVkRnJvbVdpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25EZXRhY2hlZEZyb21XaW5kb3cuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fYXR0YWNoZWRUb1dpbmRvdyA9IGZhbHNlO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLnRhYlN0cmlwKSB7XG4gICAgICAgICAgICB0aGlzLnNldFRhYlN0cmlwSXRlbXMobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZyYWdtZW50VG9EZXRhY2ggPSB0aGlzLl9jdXJyZW50RnJhZ21lbnQ7XG4gICAgICAgIGlmIChmcmFnbWVudFRvRGV0YWNoKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lJdGVtKGZyYWdtZW50VG9EZXRhY2guaW5kZXgsIGZyYWdtZW50VG9EZXRhY2gpO1xuICAgICAgICAgICAgdGhpcy5jb21taXRDdXJyZW50VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0SXRlbXMobnVsbCk7XG4gICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIgPSBudWxsO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlT25BdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyKEF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWRbb3duZXJTeW1ib2xdID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGlzcG9zZVRhYkZyYWdtZW50cygpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZGlzcG9zZVRhYkZyYWdtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBmcmFnbWVudE1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZnJhZ21lbnRNYW5hZ2VyLmdldEZyYWdtZW50cygpLnRvQXJyYXkoKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IF9hW19pXTtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLnJlbW92ZShmcmFnbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0Tm93QWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZSwgXCJjdXJyZW50VHJhbnNhY3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY3VycmVudFRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRUcmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFRyYW5zYWN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5jb21taXRDdXJyZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jdXJyZW50VHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRUcmFuc2FjdGlvbi5jb21taXROb3dBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFRyYW5zYWN0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuY2hhbmdlVGFiID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJhZ21lbnRUb0RldGFjaCA9IHRoaXMuX2N1cnJlbnRGcmFnbWVudDtcbiAgICAgICAgaWYgKGZyYWdtZW50VG9EZXRhY2gpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveUl0ZW0oZnJhZ21lbnRUb0RldGFjaC5pbmRleCwgZnJhZ21lbnRUb0RldGFjaCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZyYWdtZW50ID0gdGhpcy5pbnN0YW50aWF0ZUl0ZW0odGhpcy5fY29udGVudFZpZXcsIGluZGV4KTtcbiAgICAgICAgdGhpcy5zZXRQcmltYXJ5SXRlbShpbmRleCwgZnJhZ21lbnQpO1xuICAgICAgICB0aGlzLmNvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbigpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuaW5zdGFudGlhdGVJdGVtID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcG9zaXRpb24pIHtcbiAgICAgICAgdmFyIG5hbWUgPSBtYWtlRnJhZ21lbnROYW1lKGNvbnRhaW5lci5nZXRJZCgpLCBwb3NpdGlvbik7XG4gICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gZnJhZ21lbnRNYW5hZ2VyLmZpbmRGcmFnbWVudEJ5VGFnKG5hbWUpO1xuICAgICAgICBpZiAoZnJhZ21lbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VHJhbnNhY3Rpb24uYXR0YWNoKGZyYWdtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZyYWdtZW50ID0gVGFiRnJhZ21lbnQubmV3SW5zdGFuY2UodGhpcy5fZG9tSWQsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRyYW5zYWN0aW9uLmFkZChjb250YWluZXIuZ2V0SWQoKSwgZnJhZ21lbnQsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmcmFnbWVudCAhPT0gdGhpcy5fY3VycmVudEZyYWdtZW50KSB7XG4gICAgICAgICAgICBmcmFnbWVudC5zZXRNZW51VmlzaWJpbGl0eShmYWxzZSk7XG4gICAgICAgICAgICBmcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcmFnbWVudDtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFByaW1hcnlJdGVtID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBmcmFnbWVudCkge1xuICAgICAgICBpZiAoZnJhZ21lbnQgIT09IHRoaXMuX2N1cnJlbnRGcmFnbWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRGcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudEZyYWdtZW50LnNldE1lbnVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50RnJhZ21lbnQuc2V0VXNlclZpc2libGVIaW50KGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0TWVudVZpc2liaWxpdHkodHJ1ZSk7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0VXNlclZpc2libGVIaW50KHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fY3VycmVudEZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodGFiSXRlbSkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW0uY2FuQmVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRVbmxvYWRUYWJJdGVtcyhwb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmRlc3Ryb3lJdGVtID0gZnVuY3Rpb24gKHBvc2l0aW9uLCBmcmFnbWVudCkge1xuICAgICAgICBpZiAoZnJhZ21lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRyYW5zYWN0aW9uLmRldGFjaChmcmFnbWVudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudEZyYWdtZW50ID09PSBmcmFnbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRGcmFnbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXRlbXMgJiYgdGhpcy5pdGVtc1twb3NpdGlvbl0pIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbXNbcG9zaXRpb25dLmNhbkJlTG9hZGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYlN0cmlwSXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLnRhYlN0cmlwIHx8ICFpdGVtcykge1xuICAgICAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5zZXRJdGVtcyhudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFiSXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSwgYXJyKSB7XG4gICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgIGlmIChpdGVtc1tpXSkge1xuICAgICAgICAgICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IF90aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKGl0ZW1zW2ldKTtcbiAgICAgICAgICAgICAgICB0YWJJdGVtcy5wdXNoKHRhYkl0ZW1TcGVjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0SXRlbXModGFiSXRlbXMpO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0VmlldyA9IF90aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLmdldFRleHRWaWV3Rm9ySXRlbUF0KGkpO1xuICAgICAgICAgICAgaXRlbS5zZXROYXRpdmVWaWV3KHRleHRWaWV3KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5jcmVhdGVUYWJJdGVtU3BlYyA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgdmFyIHRhYkl0ZW1TcGVjID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5UYWJJdGVtU3BlYygpO1xuICAgICAgICBpZiAodGFiU3RyaXBJdGVtLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB2YXIgdGl0bGVMYWJlbCA9IHRhYlN0cmlwSXRlbS5sYWJlbDtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRpdGxlTGFiZWwudGV4dDtcbiAgICAgICAgICAgIHZhciB0ZXh0VHJhbnNmb3JtID0gdGl0bGVMYWJlbC5zdHlsZS50ZXh0VHJhbnNmb3JtO1xuICAgICAgICAgICAgaWYgKHRleHRUcmFuc2Zvcm0pIHtcbiAgICAgICAgICAgICAgICB0aXRsZSA9IHRleHRfYmFzZV8xLmdldFRyYW5zZm9ybWVkVGV4dCh0aXRsZSwgdGV4dFRyYW5zZm9ybSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0YWJJdGVtU3BlYy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvciA9IHRhYlN0cmlwSXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICBpZiAoYmFja2dyb3VuZENvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yLmFuZHJvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY29sb3IgPSB0aXRsZUxhYmVsLnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGFiSXRlbVNwZWMuY29sb3IgPSBjb2xvci5hbmRyb2lkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZvbnRJbnRlcm5hbCA9IHRpdGxlTGFiZWwuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgaWYgKGZvbnRJbnRlcm5hbCkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmZvbnRTaXplID0gZm9udEludGVybmFsLmZvbnRTaXplO1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLnR5cGVGYWNlID0gZm9udEludGVybmFsLmdldEFuZHJvaWRUeXBlZmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGljb25Tb3VyY2UgPSB0YWJTdHJpcEl0ZW0uaW1hZ2UgJiYgdGFiU3RyaXBJdGVtLmltYWdlLnNyYztcbiAgICAgICAgICAgIGlmIChpY29uU291cmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGljb24gPSB0aGlzLmdldEljb24odGFiU3RyaXBJdGVtKTtcbiAgICAgICAgICAgICAgICBpZiAoaWNvbikge1xuICAgICAgICAgICAgICAgICAgICB0YWJJdGVtU3BlYy5pY29uRHJhd2FibGUgPSBpY29uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhYkl0ZW1TcGVjO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZ2V0SWNvbiA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgdmFyIGljb25Tb3VyY2UgPSB0YWJTdHJpcEl0ZW0uaW1hZ2UgJiYgdGFiU3RyaXBJdGVtLmltYWdlLnNyYztcbiAgICAgICAgdmFyIGlzO1xuICAgICAgICBpZiAodXRpbHNfMS5pc0ZvbnRJY29uVVJJKGljb25Tb3VyY2UpKSB7XG4gICAgICAgICAgICB2YXIgZm9udEljb25Db2RlID0gaWNvblNvdXJjZS5zcGxpdChcIi8vXCIpWzFdO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRhYlN0cmlwSXRlbS5pbWFnZSA/IHRhYlN0cmlwSXRlbS5pbWFnZSA6IHRhYlN0cmlwSXRlbTtcbiAgICAgICAgICAgIHZhciBmb250ID0gdGFyZ2V0LnN0eWxlLmZvbnRJbnRlcm5hbDtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IHRhcmdldC5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGljb25Tb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbWFnZURyYXdhYmxlO1xuICAgICAgICBpZiAoaXMgJiYgaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgdmFyIGltYWdlID0gaXMuYW5kcm9pZDtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhYlN0cmlwICYmIHRoaXMudGFiU3RyaXAuaXNJY29uU2l6ZUZpeGVkKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2UgPSB0aGlzLmdldEZpeGVkU2l6ZUljb24oaW1hZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW1hZ2VEcmF3YWJsZSA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkJpdG1hcERyYXdhYmxlKGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dC5nZXRSZXNvdXJjZXMoKSwgaW1hZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbWFnZURyYXdhYmxlO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZ2V0Rml4ZWRTaXplSWNvbiA9IGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICB2YXIgaW5XaWR0aCA9IGltYWdlLmdldFdpZHRoKCk7XG4gICAgICAgIHZhciBpbkhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpO1xuICAgICAgICB2YXIgaWNvblNwZWNTaXplID0gdGFiX25hdmlnYXRpb25fYmFzZV8xLmdldEljb25TcGVjU2l6ZSh7IHdpZHRoOiBpbldpZHRoLCBoZWlnaHQ6IGluSGVpZ2h0IH0pO1xuICAgICAgICB2YXIgd2lkdGhQaXhlbHMgPSBpY29uU3BlY1NpemUud2lkdGggKiB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB2YXIgaGVpZ2h0UGl4ZWxzID0gaWNvblNwZWNTaXplLmhlaWdodCAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIHZhciBzY2FsZWRJbWFnZSA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLmNyZWF0ZVNjYWxlZEJpdG1hcChpbWFnZSwgd2lkdGhQaXhlbHMsIGhlaWdodFBpeGVscywgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBzY2FsZWRJbWFnZTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnVwZGF0ZUFuZHJvaWRJdGVtQXQgPSBmdW5jdGlvbiAoaW5kZXgsIHNwZWMpIHtcbiAgICAgICAgdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci51cGRhdGVJdGVtQXQoaW5kZXgsIHNwZWMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZ2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm90dG9tTmF2aWdhdGlvbkJhci5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygdmlld18xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLl9ib3R0b21OYXZpZ2F0aW9uQmFyLnNldEJhY2tncm91bmRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0QmFja2dyb3VuZCh0cnlDbG9uZURyYXdhYmxlKHZhbHVlLCB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UmVzb3VyY2VzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UaXRsZSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciB0YWJTdHJpcEl0ZW1JbmRleCA9IHRoaXMudGFiU3RyaXAuaXRlbXMuaW5kZXhPZih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSB0aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHRoaXMudXBkYXRlQW5kcm9pZEl0ZW1BdCh0YWJTdHJpcEl0ZW1JbmRleCwgdGFiSXRlbVNwZWMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciB0YWJTdHJpcEl0ZW1JbmRleCA9IHRoaXMudGFiU3RyaXAuaXRlbXMuaW5kZXhPZih0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSB0aGlzLmNyZWF0ZVRhYkl0ZW1TcGVjKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIHRoaXMudXBkYXRlQW5kcm9pZEl0ZW1BdCh0YWJTdHJpcEl0ZW1JbmRleCwgdGFiSXRlbVNwZWMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dENvbG9yKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySWNvbkNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gdGFiU3RyaXBJdGVtLmluZGV4O1xuICAgICAgICB2YXIgdGFiQmFySXRlbSA9IHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuZ2V0Vmlld0Zvckl0ZW1BdChpbmRleCk7XG4gICAgICAgIHZhciBpbWdWaWV3ID0gdGFiQmFySXRlbS5nZXRDaGlsZEF0KDApO1xuICAgICAgICB2YXIgZHJhd2FibGUgPSB0aGlzLmdldEljb24odGFiU3RyaXBJdGVtKTtcbiAgICAgICAgaW1nVmlldy5zZXRJbWFnZURyYXdhYmxlKGRyYXdhYmxlKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZSh2YWx1ZS5mb250U2l6ZSk7XG4gICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFR5cGVmYWNlKHZhbHVlLmdldEFuZHJvaWRUeXBlZmFjZSgpKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHRpdGxlTGFiZWwgPSB0YWJTdHJpcEl0ZW0ubGFiZWw7XG4gICAgICAgIHZhciB0aXRsZSA9IHRleHRfYmFzZV8xLmdldFRyYW5zZm9ybWVkVGV4dCh0aXRsZUxhYmVsLnRleHQsIHZhbHVlKTtcbiAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dCh0aXRsZSk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZVt0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMuX2JvdHRvbU5hdmlnYXRpb25CYXIuc2V0U2VsZWN0ZWRQb3NpdGlvbih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZVRhYih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5pbmRleCA9IGk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS50YWJTdHJpcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS50YWJTdHJpcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy50YWJTdHJpcCA/IHRoaXMudGFiU3RyaXAuaXRlbXMgOiBudWxsO1xuICAgICAgICB0aGlzLnNldFRhYlN0cmlwSXRlbXMoaXRlbXMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbiA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkJvdHRvbU5hdmlnYXRpb25cIilcbiAgICBdLCBCb3R0b21OYXZpZ2F0aW9uKTtcbiAgICByZXR1cm4gQm90dG9tTmF2aWdhdGlvbjtcbn0odGFiX25hdmlnYXRpb25fYmFzZV8xLlRhYk5hdmlnYXRpb25CYXNlKSk7XG5leHBvcnRzLkJvdHRvbU5hdmlnYXRpb24gPSBCb3R0b21OYXZpZ2F0aW9uO1xuZnVuY3Rpb24gdHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgcmVzb3VyY2VzKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb25zdGFudFN0YXRlID0gdmFsdWUuZ2V0Q29uc3RhbnRTdGF0ZSgpO1xuICAgICAgICBpZiAoY29uc3RhbnRTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbnN0YW50U3RhdGUubmV3RHJhd2FibGUocmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ib3R0b20tbmF2aWdhdGlvbi5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBleHByZXNzaW9uU3ltYm9sc1JlZ2V4ID0gL1tcXCtcXC1cXCpcXC8lXFw/Ojw+PSFcXHwmXFwoXFwpXn5dLztcbnZhciBiaW5kaW5nQ29uc3RhbnRzO1xuKGZ1bmN0aW9uIChiaW5kaW5nQ29uc3RhbnRzKSB7XG4gICAgYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eSA9IFwic291cmNlUHJvcGVydHlcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnRhcmdldFByb3BlcnR5ID0gXCJ0YXJnZXRQcm9wZXJ0eVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMuZXhwcmVzc2lvbiA9IFwiZXhwcmVzc2lvblwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMudHdvV2F5ID0gXCJ0d29XYXlcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZSA9IFwic291cmNlXCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5iaW5kaW5nVmFsdWVLZXkgPSBcIiR2YWx1ZVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMucGFyZW50VmFsdWVLZXkgPSBcIiRwYXJlbnRcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnBhcmVudHNWYWx1ZUtleSA9IFwiJHBhcmVudHNcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLm5ld1Byb3BlcnR5VmFsdWVLZXkgPSBcIiRuZXdQcm9wZXJ0eVZhbHVlXCI7XG59KShiaW5kaW5nQ29uc3RhbnRzID0gZXhwb3J0cy5iaW5kaW5nQ29uc3RhbnRzIHx8IChleHBvcnRzLmJpbmRpbmdDb25zdGFudHMgPSB7fSkpO1xudmFyIGhhc0VxdWFsU2lnblJlZ2V4ID0gLz0rLztcbnZhciBlcXVhbFNpZ25Db21wYXJpc2lvbk9wZXJhdG9yc1JlZ2V4ID0gLyg9PXw9PT18Pj18PD18IT18IT09KS87XG5leHBvcnRzLnBhcmVudHNSZWdleCA9IC9cXCRwYXJlbnRzXFxzKlxcW1xccyooWydcIl0qKVxcdypcXDFcXHMqXFxdL2c7XG5mdW5jdGlvbiBpc05hbWVkUGFyYW0odmFsdWUpIHtcbiAgICB2YXIgZXF1YWxTaWduSW5kZXggPSB2YWx1ZS5zZWFyY2goaGFzRXF1YWxTaWduUmVnZXgpO1xuICAgIGlmIChlcXVhbFNpZ25JbmRleCA+IC0xKSB7XG4gICAgICAgIHZhciBlcXVhbFNpZ25TdXJyb3VuZCA9IHZhbHVlLnN1YnN0cihlcXVhbFNpZ25JbmRleCA+IDAgPyBlcXVhbFNpZ25JbmRleCAtIDEgOiAwLCAzKTtcbiAgICAgICAgaWYgKGVxdWFsU2lnblN1cnJvdW5kLnNlYXJjaChlcXVhbFNpZ25Db21wYXJpc2lvbk9wZXJhdG9yc1JlZ2V4KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGFyZU5hbWVkUGFyYW1zKHBhcmFtcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpc05hbWVkUGFyYW0ocGFyYW1zW2ldKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxudmFyIG5hbWVkUGFyYW1Db25zdGFudHMgPSB7XG4gICAgcHJvcE5hbWU6IFwicHJvcE5hbWVcIixcbiAgICBwcm9wVmFsdWU6IFwicHJvcFZhbHVlXCJcbn07XG5mdW5jdGlvbiBnZXRQcm9wZXJ0eU5hbWVWYWx1ZVBhaXIocGFyYW0sIGtub3duT3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICB2YXIgbmFtZVZhbHVlUGFpciA9IHt9O1xuICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBwYXJhbS5zdWJzdHIoMCwgcGFyYW0uaW5kZXhPZihcIj1cIikpLnRyaW0oKTtcbiAgICB2YXIgcHJvcGVydHlWYWx1ZSA9IHBhcmFtLnN1YnN0cihwYXJhbS5pbmRleE9mKFwiPVwiKSArIDEpLnRyaW0oKTtcbiAgICBpZiAoa25vd25PcHRpb25zKSB7XG4gICAgICAgIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBrbm93bk9wdGlvbnMuZGVmYXVsdFByb3BlcnR5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lIGluIGtub3duT3B0aW9ucyA/IHByb3BlcnR5TmFtZSA6IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIG5hbWVWYWx1ZVBhaXIgPSBjYWxsYmFjayhwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BOYW1lXSA9IHByb3BlcnR5TmFtZTtcbiAgICAgICAgICAgIG5hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdID0gcHJvcGVydHlWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZVZhbHVlUGFpcjtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBwYXJzZU5hbWVkUHJvcGVydGllcyhwYXJhbWV0ZXJMaXN0LCBrbm93bk9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBuYW1lVmFsdWVQYWlyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1ldGVyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBuYW1lVmFsdWVQYWlyID0gZ2V0UHJvcGVydHlOYW1lVmFsdWVQYWlyKHBhcmFtZXRlckxpc3RbaV0sIGtub3duT3B0aW9ucywgY2FsbGJhY2spO1xuICAgICAgICBpZiAobmFtZVZhbHVlUGFpcikge1xuICAgICAgICAgICAgcmVzdWx0W25hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wTmFtZV1dID0gbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldFBhcmFtc0FycmF5KHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBza2lwQ29tbWEgPSAwO1xuICAgIHZhciBpbmRleFJlYWNoZWQgPSAwO1xuICAgIHZhciBzaW5nbGVRdW90ZUJsb2NrID0gZmFsc2U7XG4gICAgdmFyIGRvdWJsZVF1b3RlQmxvY2sgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgIGRvdWJsZVF1b3RlQmxvY2sgPSAhZG91YmxlUXVvdGVCbG9jaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICBzaW5nbGVRdW90ZUJsb2NrID0gIXNpbmdsZVF1b3RlQmxvY2s7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIihcIiB8fCB2YWx1ZVtpXSA9PT0gXCJbXCIpIHtcbiAgICAgICAgICAgIHNraXBDb21tYSsrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCIpXCIgfHwgdmFsdWVbaV0gPT09IFwiXVwiKSB7XG4gICAgICAgICAgICBza2lwQ29tbWEtLTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiLFwiICYmIHNraXBDb21tYSA9PT0gMCAmJiAhKHNpbmdsZVF1b3RlQmxvY2sgfHwgZG91YmxlUXVvdGVCbG9jaykpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlLnN1YnN0cihpbmRleFJlYWNoZWQsIGkgLSBpbmRleFJlYWNoZWQpKTtcbiAgICAgICAgICAgIGluZGV4UmVhY2hlZCA9IGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKHZhbHVlLnN1YnN0cihpbmRleFJlYWNoZWQpKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gaXNFeHByZXNzaW9uKGV4cHJlc3Npb24pIHtcbiAgICBpZiAoZXhwcmVzc2lvbi5zZWFyY2goZXhwcmVzc2lvblN5bWJvbHNSZWdleCkgPiAtMSkge1xuICAgICAgICB2YXIgcGFyZW50c01hdGNoZXMgPSBleHByZXNzaW9uLm1hdGNoKGV4cG9ydHMucGFyZW50c1JlZ2V4KTtcbiAgICAgICAgaWYgKHBhcmVudHNNYXRjaGVzKSB7XG4gICAgICAgICAgICB2YXIgcmVzdE9mRXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uc3Vic3RyKGV4cHJlc3Npb24uaW5kZXhPZihwYXJlbnRzTWF0Y2hlc1swXSkgKyBwYXJlbnRzTWF0Y2hlc1swXS5sZW5ndGgpO1xuICAgICAgICAgICAgaWYgKCEocmVzdE9mRXhwcmVzc2lvbi5zZWFyY2goZXhwcmVzc2lvblN5bWJvbHNSZWdleCkgPiAtMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGdldEJpbmRpbmdPcHRpb25zKG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIG5hbWVkUGFyYW1zID0gW107XG4gICAgdmFyIHBhcmFtcyA9IGdldFBhcmFtc0FycmF5KHZhbHVlKTtcbiAgICBpZiAoIWFyZU5hbWVkUGFyYW1zKHBhcmFtcykpIHtcbiAgICAgICAgaWYgKHBhcmFtcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHZhciB0cmltbWVkVmFsdWUgPSBwYXJhbXNbMF0udHJpbSgpO1xuICAgICAgICAgICAgdmFyIHNvdXJjZVByb3AgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAoaXNFeHByZXNzaW9uKHRyaW1tZWRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VQcm9wID0gYmluZGluZ0NvbnN0YW50cy5iaW5kaW5nVmFsdWVLZXk7XG4gICAgICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb24gKyBcIiA9IFwiICsgdHJpbW1lZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNvdXJjZVByb3AgPSB0cmltbWVkVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHkgKyBcIiA9IFwiICsgc291cmNlUHJvcCk7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMudHdvV2F5ICsgXCIgPSB0cnVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5ICsgXCIgPSBcIiArIHBhcmFtc1swXS50cmltKCkpO1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb24gKyBcIiA9IFwiICsgcGFyYW1zWzFdLnRyaW0oKSk7XG4gICAgICAgICAgICB2YXIgdHdvV2F5ID0gcGFyYW1zWzJdID8gcGFyYW1zWzJdLnRvTG93ZXJDYXNlKCkudHJpbSgpID09PSBcInRydWVcIiA6IHRydWU7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMudHdvV2F5ICsgXCIgPSBcIiArIHR3b1dheSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG5hbWVkUGFyYW1zID0gcGFyYW1zO1xuICAgIH1cbiAgICB2YXIgYmluZGluZ1Byb3BlcnR5SGFuZGxlciA9IGZ1bmN0aW9uIChwcm9wLCB2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BOYW1lXSA9IHByb3A7XG4gICAgICAgIGlmIChwcm9wID09PSBiaW5kaW5nQ29uc3RhbnRzLnR3b1dheSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBcInRydWVcIikge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICB2YXIgYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzID0gcGFyc2VOYW1lZFByb3BlcnRpZXMobmFtZWRQYXJhbXMsIHhtbEJpbmRpbmdQcm9wZXJ0aWVzLCBiaW5kaW5nUHJvcGVydHlIYW5kbGVyKTtcbiAgICB2YXIgYmluZE9wdGlvbnMgPSB7XG4gICAgICAgIHRhcmdldFByb3BlcnR5OiBuYW1lXG4gICAgfTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGJpbmRpbmdPcHRpb25zUGFyYW1ldGVycykge1xuICAgICAgICBpZiAoYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICAgICAgICBiaW5kT3B0aW9uc1twcm9wXSA9IGJpbmRpbmdPcHRpb25zUGFyYW1ldGVyc1twcm9wXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoYmluZE9wdGlvbnNbYmluZGluZ0NvbnN0YW50cy50d29XYXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYmluZE9wdGlvbnNbYmluZGluZ0NvbnN0YW50cy50d29XYXldID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGJpbmRPcHRpb25zO1xufVxuZXhwb3J0cy5nZXRCaW5kaW5nT3B0aW9ucyA9IGdldEJpbmRpbmdPcHRpb25zO1xudmFyIHhtbEJpbmRpbmdQcm9wZXJ0aWVzID0ge1xuICAgIHNvdXJjZVByb3BlcnR5OiB0cnVlLFxuICAgIGV4cHJlc3Npb246IHRydWUsXG4gICAgdHdvV2F5OiB0cnVlLFxuICAgIHNvdXJjZTogdHJ1ZSxcbiAgICBkZWZhdWx0UHJvcGVydHk6IGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iaW5kaW5nLWJ1aWxkZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRlYnVnXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvZGVidWdcIik7XG52YXIgeG1sID0gcmVxdWlyZShcIi4uLy4uL3htbFwiKTtcbnZhciB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGNvbXBvbmVudF9idWlsZGVyXzEgPSByZXF1aXJlKFwiLi9jb21wb25lbnQtYnVpbGRlclwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xID0gcmVxdWlyZShcIi4uLy4uL21vZHVsZS1uYW1lLXJlc29sdmVyXCIpO1xudmFyIGlvcyA9IHBsYXRmb3JtXzEucGxhdGZvcm1OYW1lcy5pb3MudG9Mb3dlckNhc2UoKTtcbnZhciBhbmRyb2lkID0gcGxhdGZvcm1fMS5wbGF0Zm9ybU5hbWVzLmFuZHJvaWQudG9Mb3dlckNhc2UoKTtcbnZhciBkZWZhdWx0TmFtZVNwYWNlTWF0Y2hlciA9IC90bnNcXC54c2QkL2k7XG5mdW5jdGlvbiBwYXJzZSh2YWx1ZSwgY29udGV4dCkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gdmFsdWUoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBleHBvcnRzXzEgPSBjb250ZXh0ID8gZ2V0RXhwb3J0cyhjb250ZXh0KSA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGNvbXBvbmVudE1vZHVsZSA9IHBhcnNlSW50ZXJuYWwodmFsdWUsIGV4cG9ydHNfMSk7XG4gICAgICAgIHJldHVybiBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICB9XG59XG5leHBvcnRzLnBhcnNlID0gcGFyc2U7XG5mdW5jdGlvbiBwYXJzZU11bHRpcGxlVGVtcGxhdGVzKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIGR1bW15Q29tcG9uZW50ID0gXCI8TGlzdFZpZXc+PExpc3RWaWV3Lml0ZW1UZW1wbGF0ZXM+XCIgKyB2YWx1ZSArIFwiPC9MaXN0Vmlldy5pdGVtVGVtcGxhdGVzPjwvTGlzdFZpZXc+XCI7XG4gICAgcmV0dXJuIHBhcnNlSW50ZXJuYWwoZHVtbXlDb21wb25lbnQsIGNvbnRleHQpLmNvbXBvbmVudFtcIml0ZW1UZW1wbGF0ZXNcIl07XG59XG5leHBvcnRzLnBhcnNlTXVsdGlwbGVUZW1wbGF0ZXMgPSBwYXJzZU11bHRpcGxlVGVtcGxhdGVzO1xuZnVuY3Rpb24gbG9hZChwYXRoT3JPcHRpb25zLCBjb250ZXh0KSB7XG4gICAgdmFyIGNvbXBvbmVudE1vZHVsZTtcbiAgICBpZiAodHlwZW9mIHBhdGhPck9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUocGF0aE9yT3B0aW9ucyk7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBjb250ZXh0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IGxvYWRDdXN0b21Db21wb25lbnQocGF0aE9yT3B0aW9ucy5wYXRoLCBwYXRoT3JPcHRpb25zLm5hbWUsIHBhdGhPck9wdGlvbnMuYXR0cmlidXRlcywgcGF0aE9yT3B0aW9ucy5leHBvcnRzLCBwYXRoT3JPcHRpb25zLnBhZ2UsIHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlICYmIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG59XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy5jcmVhdGVWaWV3RnJvbUVudHJ5ID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImNyZWF0ZVZpZXdGcm9tRW50cnlcIiwgZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgaWYgKGVudHJ5LmNyZWF0ZSkge1xuICAgICAgICB2YXIgdmlldyA9IGVudHJ5LmNyZWF0ZSgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgVmlldyB3aXRoIGVudHJ5LmNyZWF0ZSgpIGZ1bmN0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9XG4gICAgZWxzZSBpZiAoZW50cnkubW9kdWxlTmFtZSkge1xuICAgICAgICB2YXIgbW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShlbnRyeS5tb2R1bGVOYW1lKTtcbiAgICAgICAgdmFyIHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiXCIpO1xuICAgICAgICB2YXIgbW9kdWxlRXhwb3J0cyA9IHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPyBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZENvZGVNb2R1bGVOYW1lLCB0cnVlKSA6IG51bGw7XG4gICAgICAgIGlmIChtb2R1bGVFeHBvcnRzICYmIG1vZHVsZUV4cG9ydHMuY3JlYXRlUGFnZSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBtb2R1bGVFeHBvcnRzLmNyZWF0ZVBhZ2UoKTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiY3NzXCIpO1xuICAgICAgICAgICAgaWYgKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgICAgIHZpZXcuYWRkQ3NzRmlsZShyZXNvbHZlZENzc01vZHVsZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50TW9kdWxlID0gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIG1vZHVsZUV4cG9ydHMpO1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudFZpZXcgPSBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnRWaWV3O1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBsb2FkIHBhZ2UgWE1MIGZpbGUgZm9yIG1vZHVsZTogXCIgKyBlbnRyeS5tb2R1bGVOYW1lKTtcbn0pO1xuZnVuY3Rpb24gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIG1vZHVsZUV4cG9ydHMpIHtcbiAgICB2YXIgY29tcG9uZW50TW9kdWxlO1xuICAgIHZhciByZXNvbHZlZFhtbE1vZHVsZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJ4bWxcIik7XG4gICAgaWYgKHJlc29sdmVkWG1sTW9kdWxlKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRYbWxNb2R1bGUsIHRydWUpO1xuICAgICAgICBjb21wb25lbnRNb2R1bGUgPSBwYXJzZUludGVybmFsKHRleHQsIG1vZHVsZUV4cG9ydHMsIHJlc29sdmVkWG1sTW9kdWxlLCBtb2R1bGVOYW1lKTtcbiAgICB9XG4gICAgdmFyIGNvbXBvbmVudFZpZXcgPSBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICBpZiAoY29tcG9uZW50Vmlldykge1xuICAgICAgICBjb21wb25lbnRWaWV3LmV4cG9ydHMgPSBtb2R1bGVFeHBvcnRzO1xuICAgICAgICBjb21wb25lbnRWaWV3Ll9tb2R1bGVOYW1lID0gbW9kdWxlTmFtZTtcbiAgICB9XG4gICAgaWYgKCFjb21wb25lbnRNb2R1bGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGxvYWQgY29tcG9uZW50IGZyb20gbW9kdWxlOiBcIiArIG1vZHVsZU5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlO1xufVxuZnVuY3Rpb24gbG9hZEN1c3RvbUNvbXBvbmVudChjb21wb25lbnROYW1lc3BhY2UsIGNvbXBvbmVudE5hbWUsIGF0dHJpYnV0ZXMsIGNvbnRleHQsIHBhcmVudFBhZ2UsIGlzUm9vdENvbXBvbmVudCwgbW9kdWxlTmFtZVBhdGgpIHtcbiAgICBpZiAoaXNSb290Q29tcG9uZW50ID09PSB2b2lkIDApIHsgaXNSb290Q29tcG9uZW50ID0gdHJ1ZTsgfVxuICAgIGlmICghcGFyZW50UGFnZSAmJiBjb250ZXh0KSB7XG4gICAgICAgIHBhcmVudFBhZ2UgPSBjb250ZXh0W1wiX3BhcmVudFBhZ2VcIl07XG4gICAgICAgIGRlbGV0ZSBjb250ZXh0W1wiX3BhcmVudFBhZ2VcIl07XG4gICAgfVxuICAgIHZhciByZXN1bHQ7XG4gICAgY29tcG9uZW50TmFtZXNwYWNlID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGNvbXBvbmVudE5hbWVzcGFjZSk7XG4gICAgdmFyIG1vZHVsZU5hbWUgPSBjb21wb25lbnROYW1lc3BhY2UgKyBcIi9cIiArIGNvbXBvbmVudE5hbWU7XG4gICAgdmFyIHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiXCIpO1xuICAgIHZhciByZXNvbHZlZFhtbE1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwieG1sXCIpO1xuICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiY3NzXCIpO1xuICAgIGlmIChyZXNvbHZlZFhtbE1vZHVsZU5hbWUpIHtcbiAgICAgICAgdmFyIHN1YkV4cG9ydHMgPSBjb250ZXh0O1xuICAgICAgICBpZiAocmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgc3ViRXhwb3J0cyA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkQ29kZU1vZHVsZU5hbWUsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3ViRXhwb3J0cykge1xuICAgICAgICAgICAgc3ViRXhwb3J0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHN1YkV4cG9ydHNbXCJfcGFyZW50UGFnZVwiXSA9IHBhcmVudFBhZ2U7XG4gICAgICAgIHJlc3VsdCA9IGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBzdWJFeHBvcnRzKTtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNEZWZpbmVkKHJlc3VsdCkgJiYgdHlwZXNfMS5pc0RlZmluZWQocmVzdWx0LmNvbXBvbmVudCkgJiYgdHlwZXNfMS5pc0RlZmluZWQoYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudF9idWlsZGVyXzEuc2V0UHJvcGVydHlWYWx1ZShyZXN1bHQuY29tcG9uZW50LCBzdWJFeHBvcnRzLCBjb250ZXh0LCBhdHRyLCBhdHRyaWJ1dGVzW2F0dHJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gY29tcG9uZW50X2J1aWxkZXJfMS5nZXRDb21wb25lbnRNb2R1bGUoY29tcG9uZW50TmFtZSwgY29tcG9uZW50TmFtZXNwYWNlLCBhdHRyaWJ1dGVzLCBjb250ZXh0LCBtb2R1bGVOYW1lUGF0aCwgaXNSb290Q29tcG9uZW50KTtcbiAgICAgICAgaWYgKCFyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUoY29tcG9uZW50TmFtZXNwYWNlLCBcImNzc1wiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocGFyZW50UGFnZSAmJiByZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgcGFyZW50UGFnZS5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRFeHBvcnRzKGluc3RhbmNlKSB7XG4gICAgdmFyIGlzVmlldyA9ICEhaW5zdGFuY2UuX2RvbUlkO1xuICAgIGlmICghaXNWaWV3KSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZS5leHBvcnRzIHx8IGluc3RhbmNlO1xuICAgIH1cbiAgICB2YXIgZXhwb3J0T2JqZWN0ID0gaW5zdGFuY2UuZXhwb3J0cztcbiAgICB2YXIgcGFyZW50ID0gaW5zdGFuY2UucGFyZW50O1xuICAgIHdoaWxlIChleHBvcnRPYmplY3QgPT09IHVuZGVmaW5lZCAmJiBwYXJlbnQpIHtcbiAgICAgICAgZXhwb3J0T2JqZWN0ID0gcGFyZW50LmV4cG9ydHM7XG4gICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgfVxuICAgIHJldHVybiBleHBvcnRPYmplY3Q7XG59XG5mdW5jdGlvbiBwYXJzZUludGVybmFsKHZhbHVlLCBjb250ZXh0LCB4bWxNb2R1bGUsIG1vZHVsZU5hbWUpIHtcbiAgICB2YXIgc3RhcnQ7XG4gICAgdmFyIHVpO1xuICAgIHZhciBlcnJvckZvcm1hdCA9IChkZWJ1Z18xLmRlYnVnICYmIHhtbE1vZHVsZSkgPyB4bWwydWkuU291cmNlRXJyb3JGb3JtYXQoeG1sTW9kdWxlKSA6IHhtbDJ1aS5Qb3NpdGlvbkVycm9yRm9ybWF0O1xuICAgIHZhciBjb21wb25lbnRTb3VyY2VUcmFja2VyID0gKGRlYnVnXzEuZGVidWcgJiYgeG1sTW9kdWxlKSA/IHhtbDJ1aS5Db21wb25lbnRTb3VyY2VUcmFja2VyKHhtbE1vZHVsZSkgOiBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICAoc3RhcnQgPSBuZXcgeG1sMnVpLlhtbFN0cmluZ1BhcnNlcihlcnJvckZvcm1hdCkpXG4gICAgICAgIC5waXBlKG5ldyB4bWwydWkuUGxhdGZvcm1GaWx0ZXIoKSlcbiAgICAgICAgLnBpcGUobmV3IHhtbDJ1aS5YbWxTdGF0ZVBhcnNlcih1aSA9IG5ldyB4bWwydWkuQ29tcG9uZW50UGFyc2VyKGNvbnRleHQsIGVycm9yRm9ybWF0LCBjb21wb25lbnRTb3VyY2VUcmFja2VyLCBtb2R1bGVOYW1lKSkpO1xuICAgIHN0YXJ0LnBhcnNlKHZhbHVlKTtcbiAgICByZXR1cm4gdWkucm9vdENvbXBvbmVudE1vZHVsZTtcbn1cbnZhciB4bWwydWk7XG4oZnVuY3Rpb24gKHhtbDJ1aSkge1xuICAgIHZhciBYbWxQcm9kdWNlckJhc2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYbWxQcm9kdWNlckJhc2UoKSB7XG4gICAgICAgIH1cbiAgICAgICAgWG1sUHJvZHVjZXJCYXNlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgIHRoaXMuX25leHQgPSBuZXh0O1xuICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG4gICAgICAgIFhtbFByb2R1Y2VyQmFzZS5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLl9uZXh0LnBhcnNlKGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sUHJvZHVjZXJCYXNlO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLlhtbFByb2R1Y2VyQmFzZSA9IFhtbFByb2R1Y2VyQmFzZTtcbiAgICB2YXIgWG1sU3RyaW5nUGFyc2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFhtbFN0cmluZ1BhcnNlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gWG1sU3RyaW5nUGFyc2VyKGVycm9yKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvciB8fCBQb3NpdGlvbkVycm9yRm9ybWF0O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIFhtbFN0cmluZ1BhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgeG1sUGFyc2VyID0gbmV3IHhtbC5YbWxQYXJzZXIoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5uZXh0KGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvcihlLCBhcmdzLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSwgcCkge1xuICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yKGUsIHApO1xuICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB4bWxQYXJzZXIucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sU3RyaW5nUGFyc2VyO1xuICAgIH0oWG1sUHJvZHVjZXJCYXNlKSk7XG4gICAgeG1sMnVpLlhtbFN0cmluZ1BhcnNlciA9IFhtbFN0cmluZ1BhcnNlcjtcbiAgICBmdW5jdGlvbiBQb3NpdGlvbkVycm9yRm9ybWF0KGUsIHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBkZWJ1Z18xLlNjb3BlRXJyb3IoZSwgXCJQYXJzaW5nIFhNTCBhdCBcIiArIHAubGluZSArIFwiOlwiICsgcC5jb2x1bW4pO1xuICAgIH1cbiAgICB4bWwydWkuUG9zaXRpb25FcnJvckZvcm1hdCA9IFBvc2l0aW9uRXJyb3JGb3JtYXQ7XG4gICAgZnVuY3Rpb24gU291cmNlRXJyb3JGb3JtYXQodXJpKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgcCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHAgPyBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCBwLmxpbmUsIHAuY29sdW1uKSA6IG5ldyBkZWJ1Z18xLlNvdXJjZSh1cmksIC0xLCAtMSk7XG4gICAgICAgICAgICBlID0gbmV3IGRlYnVnXzEuU291cmNlRXJyb3IoZSwgc291cmNlLCBcIkJ1aWxkaW5nIFVJIGZyb20gWE1MLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9O1xuICAgIH1cbiAgICB4bWwydWkuU291cmNlRXJyb3JGb3JtYXQgPSBTb3VyY2VFcnJvckZvcm1hdDtcbiAgICBmdW5jdGlvbiBDb21wb25lbnRTb3VyY2VUcmFja2VyKHVyaSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbXBvbmVudCwgcCkge1xuICAgICAgICAgICAgaWYgKCFkZWJ1Z18xLlNvdXJjZS5nZXQoY29tcG9uZW50KSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBwID8gbmV3IGRlYnVnXzEuU291cmNlKHVyaSwgcC5saW5lLCBwLmNvbHVtbikgOiBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCAtMSwgLTEpO1xuICAgICAgICAgICAgICAgIGRlYnVnXzEuU291cmNlLnNldChjb21wb25lbnQsIHNvdXJjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHhtbDJ1aS5Db21wb25lbnRTb3VyY2VUcmFja2VyID0gQ29tcG9uZW50U291cmNlVHJhY2tlcjtcbiAgICB2YXIgUGxhdGZvcm1GaWx0ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoUGxhdGZvcm1GaWx0ZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFBsYXRmb3JtRmlsdGVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIFBsYXRmb3JtRmlsdGVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFBsYXRmb3JtRmlsdGVyLmlzUGxhdGZvcm0oYXJncy5lbGVtZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWxyZWFkeSBpbiAnXCIgKyB0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgKyBcIicgcGxhdGZvcm0gY29udGV4dCBhbmQgY2Fubm90IHN3aXRjaCB0byAnXCIgKyBhcmdzLmVsZW1lbnROYW1lICsgXCInIHBsYXRmb3JtISBQbGF0Zm9ybSB0YWdzIGNhbm5vdCBiZSBuZXN0ZWQuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCA9IGFyZ3MuZWxlbWVudE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChQbGF0Zm9ybUZpbHRlci5pc1BsYXRmb3JtKGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgJiYgIVBsYXRmb3JtRmlsdGVyLmlzQ3VyZW50UGxhdGZvcm0odGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dChhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgUGxhdGZvcm1GaWx0ZXIuaXNQbGF0Zm9ybSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvTG93ZXIgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0b0xvd2VyID09PSBhbmRyb2lkIHx8IHRvTG93ZXIgPT09IGlvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgUGxhdGZvcm1GaWx0ZXIuaXNDdXJlbnRQbGF0Zm9ybSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlICYmIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IHBsYXRmb3JtXzEuZGV2aWNlLm9zLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBQbGF0Zm9ybUZpbHRlcjtcbiAgICB9KFhtbFByb2R1Y2VyQmFzZSkpO1xuICAgIHhtbDJ1aS5QbGF0Zm9ybUZpbHRlciA9IFBsYXRmb3JtRmlsdGVyO1xuICAgIHZhciBYbWxBcmdzUmVwbGF5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFhtbEFyZ3NSZXBsYXksIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFhtbEFyZ3NSZXBsYXkoYXJncywgZXJyb3JGb3JtYXQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5hcmdzID0gYXJncztcbiAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3JGb3JtYXQ7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgWG1sQXJnc1JlcGxheS5wcm90b3R5cGUucmVwbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuYXJncy5mb3JFYWNoKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubmV4dChhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3IoZSwgYXJncy5wb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBYbWxBcmdzUmVwbGF5O1xuICAgIH0oWG1sUHJvZHVjZXJCYXNlKSk7XG4gICAgeG1sMnVpLlhtbEFyZ3NSZXBsYXkgPSBYbWxBcmdzUmVwbGF5O1xuICAgIHZhciBYbWxTdGF0ZVBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhtbFN0YXRlUGFyc2VyKHN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgICAgIH1cbiAgICAgICAgWG1sU3RhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLnN0YXRlLnBhcnNlKGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sU3RhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuWG1sU3RhdGVQYXJzZXIgPSBYbWxTdGF0ZVBhcnNlcjtcbiAgICB2YXIgVGVtcGxhdGVQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBUZW1wbGF0ZVBhcnNlcihwYXJlbnQsIHRlbXBsYXRlUHJvcGVydHksIHNldFRlbXBsYXRlUHJvcGVydHkpIHtcbiAgICAgICAgICAgIGlmIChzZXRUZW1wbGF0ZVByb3BlcnR5ID09PSB2b2lkIDApIHsgc2V0VGVtcGxhdGVQcm9wZXJ0eSA9IHRydWU7IH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dCA9IHRlbXBsYXRlUHJvcGVydHkuY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMuX3JlY29yZGVkWG1sU3RyZWFtID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5ID0gdGVtcGxhdGVQcm9wZXJ0eTtcbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zZXRUZW1wbGF0ZVByb3BlcnR5ID0gc2V0VGVtcGxhdGVQcm9wZXJ0eTtcbiAgICAgICAgfVxuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VTdGFydEVsZW1lbnQoYXJncy5wcmVmaXgsIGFyZ3MubmFtZXNwYWNlLCBhcmdzLmVsZW1lbnROYW1lLCBhcmdzLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VFbmRFbGVtZW50KGFyZ3MucHJlZml4LCBhcmdzLmVsZW1lbnROYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZGVkWG1sU3RyZWFtLnB1c2goYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IDIgPyB0aGlzLnBhcmVudCA6IHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUsIFwiZWxlbWVudE5hbWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkuZWxlbWVudE5hbWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlU3RhcnRFbGVtZW50ID0gZnVuY3Rpb24gKHByZWZpeCwgbmFtZXNwYWNlLCBlbGVtZW50TmFtZSwgYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fc3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUZW1wbGF0ZSBtdXN0IGhhdmUgZXhhY3RseSBvbmUgcm9vdCBlbGVtZW50IGJ1dCBtdWx0aXBsZSBlbGVtZW50cyB3ZXJlIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbCsrO1xuICAgICAgICB9O1xuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2VFbmRFbGVtZW50ID0gZnVuY3Rpb24gKHByZWZpeCwgZWxlbWVudE5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRlbXBsYXRlIG11c3QgaGF2ZSBleGFjdGx5IG9uZSByb290IGVsZW1lbnQgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX3N0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gbW9yZSBjbG9zaW5nIGVsZW1lbnRzIGV4cGVjdGVkIGZvciB0aGlzIHRlbXBsYXRlLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbC0tO1xuICAgICAgICAgICAgaWYgKHRoaXMuX25lc3RpbmdMZXZlbCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gMjtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2V0VGVtcGxhdGVQcm9wZXJ0eSAmJiB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5Lm5hbWUgaW4gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5wYXJlbnQuY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuYnVpbGRUZW1wbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LnBhcmVudC5jb21wb25lbnRbdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5uYW1lXSA9IHRlbXBsYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLmJ1aWxkVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICAgICAgdmFyIGVycm9yRm9ybWF0ID0gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5lcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHZhciBzb3VyY2VUcmFja2VyID0gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5zb3VyY2VUcmFja2VyO1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlRlbXBsYXRlKClcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydDtcbiAgICAgICAgICAgICAgICB2YXIgdWk7XG4gICAgICAgICAgICAgICAgKHN0YXJ0ID0gbmV3IHhtbDJ1aS5YbWxBcmdzUmVwbGF5KF90aGlzLl9yZWNvcmRlZFhtbFN0cmVhbSwgZXJyb3JGb3JtYXQpKVxuICAgICAgICAgICAgICAgICAgICAucGlwZShuZXcgWG1sU3RhdGVQYXJzZXIodWkgPSBuZXcgQ29tcG9uZW50UGFyc2VyKGNvbnRleHQsIGVycm9yRm9ybWF0LCBzb3VyY2VUcmFja2VyKSkpO1xuICAgICAgICAgICAgICAgIHN0YXJ0LnJlcGxheSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1aS5yb290Q29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVGVtcGxhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuVGVtcGxhdGVQYXJzZXIgPSBUZW1wbGF0ZVBhcnNlcjtcbiAgICB2YXIgTXVsdGlUZW1wbGF0ZVBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIE11bHRpVGVtcGxhdGVQYXJzZXIocGFyZW50LCB0ZW1wbGF0ZVByb3BlcnR5KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVQcm9wZXJ0eSA9IHRlbXBsYXRlUHJvcGVydHk7XG4gICAgICAgICAgICB0aGlzLl9jaGlsZFBhcnNlcnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTXVsdGlUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl92YWx1ZTsgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE11bHRpVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQgJiYgYXJncy5lbGVtZW50TmFtZSA9PT0gXCJ0ZW1wbGF0ZVwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkUGFyc2VyID0gbmV3IFRlbXBsYXRlUGFyc2VyKHRoaXMsIHRoaXMudGVtcGxhdGVQcm9wZXJ0eSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNoaWxkUGFyc2VyW1wia2V5XCJdID0gYXJncy5hdHRyaWJ1dGVzW1wia2V5XCJdO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkUGFyc2Vycy5wdXNoKGNoaWxkUGFyc2VyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGRQYXJzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lXzEgPSBDb21wb25lbnRQYXJzZXIuZ2V0Q29tcGxleFByb3BlcnR5TmFtZShhcmdzLmVsZW1lbnROYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZV8xID09PSB0aGlzLnRlbXBsYXRlUHJvcGVydHkubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2hpbGRQYXJzZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLl9jaGlsZFBhcnNlcnNbaV1bXCJrZXlcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlVmlldzogdGhpcy5fY2hpbGRQYXJzZXJzW2ldLmJ1aWxkVGVtcGxhdGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB0ZW1wbGF0ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5wYXJzZShhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE11bHRpVGVtcGxhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuTXVsdGlUZW1wbGF0ZVBhcnNlciA9IE11bHRpVGVtcGxhdGVQYXJzZXI7XG4gICAgdmFyIENvbXBvbmVudFBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENvbXBvbmVudFBhcnNlcihjb250ZXh0LCBlcnJvckZvcm1hdCwgc291cmNlVHJhY2tlciwgbW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVOYW1lID0gbW9kdWxlTmFtZTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgdGhpcy5jb21wbGV4UHJvcGVydGllcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHJhY2tlciA9IHNvdXJjZVRyYWNrZXI7XG4gICAgICAgIH1cbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLnByb3RvdHlwZS5idWlsZENvbXBvbmVudCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5wcmVmaXggJiYgYXJncy5uYW1lc3BhY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZEN1c3RvbUNvbXBvbmVudChhcmdzLm5hbWVzcGFjZSwgYXJncy5lbGVtZW50TmFtZSwgYXJncy5hdHRyaWJ1dGVzLCB0aGlzLmNvbnRleHQsIHRoaXMuY3VycmVudFJvb3RWaWV3LCAhdGhpcy5jdXJyZW50Um9vdFZpZXcsIHRoaXMubW9kdWxlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZXNwYWNlID0gYXJncy5uYW1lc3BhY2U7XG4gICAgICAgICAgICAgICAgaWYgKGRlZmF1bHROYW1lU3BhY2VNYXRjaGVyLnRlc3QobmFtZXNwYWNlIHx8IFwiXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudF9idWlsZGVyXzEuZ2V0Q29tcG9uZW50TW9kdWxlKGFyZ3MuZWxlbWVudE5hbWUsIG5hbWVzcGFjZSwgYXJncy5hdHRyaWJ1dGVzLCB0aGlzLmNvbnRleHQsIHRoaXMubW9kdWxlTmFtZSwgIXRoaXMuY3VycmVudFJvb3RWaWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnRzW3RoaXMucGFyZW50cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHZhciBjb21wbGV4UHJvcGVydHkgPSB0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzW3RoaXMuY29tcGxleFByb3BlcnRpZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0NvbXBsZXhQcm9wZXJ0eShhcmdzLmVsZW1lbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZV8yID0gQ29tcG9uZW50UGFyc2VyLmdldENvbXBsZXhQcm9wZXJ0eU5hbWUoYXJncy5lbGVtZW50TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wbGV4UHJvcGVydHlfMSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZV8yLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleFByb3BlcnRpZXMucHVzaChjb21wbGV4UHJvcGVydHlfMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNLbm93blRlbXBsYXRlKG5hbWVfMiwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRlbXBsYXRlUGFyc2VyKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiAocGFyZW50ID8gZ2V0RXhwb3J0cyhwYXJlbnQuY29tcG9uZW50KSA6IG51bGwpIHx8IHRoaXMuY29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudE5hbWU6IGFyZ3MuZWxlbWVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVJdGVtczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JGb3JtYXQ6IHRoaXMuZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVHJhY2tlcjogdGhpcy5zb3VyY2VUcmFja2VyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzS25vd25NdWx0aVRlbXBsYXRlKG5hbWVfMiwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyc2VyID0gbmV3IE11bHRpVGVtcGxhdGVQYXJzZXIodGhpcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IChwYXJlbnQgPyBnZXRFeHBvcnRzKHBhcmVudC5jb21wb25lbnQpIDogbnVsbCkgfHwgdGhpcy5jb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVfMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50TmFtZTogYXJncy5lbGVtZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUl0ZW1zOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckZvcm1hdDogdGhpcy5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUcmFja2VyOiB0aGlzLnNvdXJjZVRyYWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxleFByb3BlcnR5XzEucGFyc2VyID0gcGFyc2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudE1vZHVsZSA9IHRoaXMuYnVpbGRDb21wb25lbnQoYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVHJhY2tlcihjb21wb25lbnRNb2R1bGUuY29tcG9uZW50LCBhcmdzLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxleFByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbXBvbmVudFBhcnNlci5hZGRUb0NvbXBsZXhQcm9wZXJ0eShwYXJlbnQsIGNvbXBsZXhQcm9wZXJ0eSwgY29tcG9uZW50TW9kdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50LmNvbXBvbmVudC5fYWRkQ2hpbGRGcm9tQnVpbGRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKGFyZ3MuZWxlbWVudE5hbWUsIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3RDb21wb25lbnRNb2R1bGUgPSBjb21wb25lbnRNb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdENvbXBvbmVudE1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb290VmlldyA9IHRoaXMucm9vdENvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSb290Vmlldy5leHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmN1cnJlbnRSb290Vmlldy5leHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2goY29tcG9uZW50TW9kdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzQ29tcGxleFByb3BlcnR5KGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV4UHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV4UHJvcGVydHkucGFyc2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXBvbmVudFtjb21wbGV4UHJvcGVydHkubmFtZV0gPSBjb21wbGV4UHJvcGVydHkucGFyc2VyLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50ICYmIHBhcmVudC5jb21wb25lbnQuX2FkZEFycmF5RnJvbUJ1aWxkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY29tcG9uZW50Ll9hZGRBcnJheUZyb21CdWlsZGVyKGNvbXBsZXhQcm9wZXJ0eS5uYW1lLCBjb21wbGV4UHJvcGVydHkuaXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXhQcm9wZXJ0eS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleFByb3BlcnRpZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudHMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0NvbXBsZXhQcm9wZXJ0eSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZXNfMS5pc1N0cmluZyhuYW1lKSAmJiBuYW1lLmluZGV4T2YoXCIuXCIpICE9PSAtMTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmdldENvbXBsZXhQcm9wZXJ0eU5hbWUgPSBmdW5jdGlvbiAoZnVsbE5hbWUpIHtcbiAgICAgICAgICAgIHZhciBuYW1lO1xuICAgICAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoZnVsbE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWVzID0gZnVsbE5hbWUuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lc1tuYW1lcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuaXNLbm93blRlbXBsYXRlID0gZnVuY3Rpb24gKG5hbWUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiBDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVMgaW4gZXhwb3J0cyAmJiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFU10gJiYgbmFtZSBpbiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFU107XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0tub3duTXVsdGlUZW1wbGF0ZSA9IGZ1bmN0aW9uIChuYW1lLCBleHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVMgaW4gZXhwb3J0cyAmJiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTXSAmJiBuYW1lIGluIGV4cG9ydHNbQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVNdO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuYWRkVG9Db21wbGV4UHJvcGVydHkgPSBmdW5jdGlvbiAocGFyZW50LCBjb21wbGV4UHJvcGVydHksIGVsZW1lbnRNb2R1bGUpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRDb21wb25lbnQgPSBwYXJlbnQuY29tcG9uZW50O1xuICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0tub3duQ29sbGVjdGlvbihjb21wbGV4UHJvcGVydHkubmFtZSwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgY29tcGxleFByb3BlcnR5Lml0ZW1zLnB1c2goZWxlbWVudE1vZHVsZS5jb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50Q29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKGNvbXBsZXhQcm9wZXJ0eS5uYW1lLCBlbGVtZW50TW9kdWxlLmNvbXBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRDb21wb25lbnRbY29tcGxleFByb3BlcnR5Lm5hbWVdID0gZWxlbWVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0tub3duQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlMgaW4gY29udGV4dCAmJiBjb250ZXh0W0NvbXBvbmVudFBhcnNlci5LTk9XTkNPTExFQ1RJT05TXSAmJiBuYW1lIGluIGNvbnRleHRbQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlNdO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuS05PV05DT0xMRUNUSU9OUyA9IFwia25vd25Db2xsZWN0aW9uc1wiO1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVMgPSBcImtub3duVGVtcGxhdGVzXCI7XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTID0gXCJrbm93bk11bHRpVGVtcGxhdGVzXCI7XG4gICAgICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgICAgICBdLCBDb21wb25lbnRQYXJzZXIucHJvdG90eXBlLCBcImJ1aWxkQ29tcG9uZW50XCIsIG51bGwpO1xuICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLkNvbXBvbmVudFBhcnNlciA9IENvbXBvbmVudFBhcnNlcjtcbn0pKHhtbDJ1aSB8fCAoeG1sMnVpID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1aWxkZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGJpbmRhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS9iaW5kYWJsZVwiKTtcbnZhciBiaW5kaW5nX2J1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9iaW5kaW5nLWJ1aWxkZXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIHBsYXRmb3JtID0gcmVxdWlyZShcIi4uLy4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL21vZHVsZS1uYW1lLXJlc29sdmVyXCIpO1xudmFyIFVJX1BBVEggPSBcInVpL1wiO1xudmFyIE1PRFVMRVMgPSB7XG4gICAgXCJUYWJWaWV3SXRlbVwiOiBcInVpL3RhYi12aWV3XCIsXG4gICAgXCJUYWJTdHJpcFwiOiBcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIsXG4gICAgXCJUYWJTdHJpcEl0ZW1cIjogXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIsXG4gICAgXCJUYWJDb250ZW50SXRlbVwiOiBcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiLFxuICAgIFwiRm9ybWF0dGVkU3RyaW5nXCI6IFwidGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIsXG4gICAgXCJTcGFuXCI6IFwidGV4dC9zcGFuXCIsXG4gICAgXCJBY3Rpb25JdGVtXCI6IFwidWkvYWN0aW9uLWJhclwiLFxuICAgIFwiTmF2aWdhdGlvbkJ1dHRvblwiOiBcInVpL2FjdGlvbi1iYXJcIixcbiAgICBcIlNlZ21lbnRlZEJhckl0ZW1cIjogXCJ1aS9zZWdtZW50ZWQtYmFyXCIsXG59O1xudmFyIENPREVfRklMRSA9IFwiY29kZUZpbGVcIjtcbnZhciBDU1NfRklMRSA9IFwiY3NzRmlsZVwiO1xudmFyIElNUE9SVCA9IFwiaW1wb3J0XCI7XG52YXIgY3JlYXRlQ29tcG9uZW50SW5zdGFuY2UgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiY3JlYXRlQ29tcG9uZW50SW5zdGFuY2VcIiwgZnVuY3Rpb24gKGVsZW1lbnROYW1lLCBuYW1lc3BhY2UpIHtcbiAgICB2YXIgaW5zdGFuY2U7XG4gICAgdmFyIGluc3RhbmNlTW9kdWxlO1xuICAgIHZhciByZXNvbHZlZE1vZHVsZU5hbWU7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJlc29sdmVkTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobmFtZXNwYWNlLCBcIlwiKTtcbiAgICAgICAgICAgIGluc3RhbmNlTW9kdWxlID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRNb2R1bGVOYW1lLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmVkTW9kdWxlTmFtZSA9IE1PRFVMRVNbZWxlbWVudE5hbWVdIHx8IFVJX1BBVEggK1xuICAgICAgICAgICAgICAgIChlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJsYXlvdXRcIikgIT09IC0xID8gXCJsYXlvdXRzL1wiIDogXCJcIikgK1xuICAgICAgICAgICAgICAgIGVsZW1lbnROYW1lLnNwbGl0KC8oPz1bQS1aXSkvKS5qb2luKFwiLVwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaW5zdGFuY2VNb2R1bGUgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZE1vZHVsZU5hbWUsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5zdGFuY2VUeXBlID0gaW5zdGFuY2VNb2R1bGVbZWxlbWVudE5hbWVdIHx8IE9iamVjdDtcbiAgICAgICAgaW5zdGFuY2UgPSBuZXcgaW5zdGFuY2VUeXBlKCk7XG4gICAgfVxuICAgIGNhdGNoIChleCkge1xuICAgICAgICB2YXIgZGVidWcgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvZGVidWdcIik7XG4gICAgICAgIHRocm93IG5ldyBkZWJ1Zy5TY29wZUVycm9yKGV4LCBcIk1vZHVsZSAnXCIgKyByZXNvbHZlZE1vZHVsZU5hbWUgKyBcIicgbm90IGZvdW5kIGZvciBlbGVtZW50ICdcIiArIChuYW1lc3BhY2UgPyBuYW1lc3BhY2UgKyBcIjpcIiA6IFwiXCIpICsgZWxlbWVudE5hbWUgKyBcIicuXCIpO1xuICAgIH1cbiAgICByZXR1cm4geyBpbnN0YW5jZTogaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlOiBpbnN0YW5jZU1vZHVsZSB9O1xufSk7XG52YXIgZ2V0Q29tcG9uZW50TW9kdWxlRXhwb3J0cyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJnZXRDb21wb25lbnRNb2R1bGVFeHBvcnRzXCIsIGZ1bmN0aW9uIChpbnN0YW5jZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcykge1xuICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBjb2RlRmlsZUF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbQ09ERV9GSUxFXSB8fCBhdHRyaWJ1dGVzW0lNUE9SVF07XG4gICAgICAgIGlmIChjb2RlRmlsZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkQ29kZUZpbGVNb2R1bGUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShjb2RlRmlsZUF0dHJpYnV0ZSksIFwiXCIpO1xuICAgICAgICAgICAgaWYgKHJlc29sdmVkQ29kZUZpbGVNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICBtb2R1bGVFeHBvcnRzID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRDb2RlRmlsZU1vZHVsZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZXhwb3J0cyA9IG1vZHVsZUV4cG9ydHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2RlIGZpbGUgd2l0aCBwYXRoIFxcXCJcIiArIGNvZGVGaWxlQXR0cmlidXRlICsgXCJcXFwiIGNhbm5vdCBiZSBmb3VuZCEgTG9va2luZyBmb3Igd2VicGFjayBtb2R1bGUgd2l0aCBuYW1lIFxcXCJcIiArIHJlc29sdmVkQ29kZUZpbGVNb2R1bGUgKyBcIlxcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vZHVsZUV4cG9ydHM7XG59KTtcbnZhciBhcHBseUNvbXBvbmVudENzcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJhcHBseUNvbXBvbmVudENzc1wiLCBmdW5jdGlvbiAoaW5zdGFuY2UsIG1vZHVsZU5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICB2YXIgY3NzQXBwbGllZCA9IGZhbHNlO1xuICAgIGlmIChhdHRyaWJ1dGVzICYmIGF0dHJpYnV0ZXNbQ1NTX0ZJTEVdKSB7XG4gICAgICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShhdHRyaWJ1dGVzW0NTU19GSUxFXSksIFwiY3NzXCIpO1xuICAgICAgICBpZiAocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICBjc3NBcHBsaWVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNzcyBmaWxlIHdpdGggcGF0aCBcXFwiXCIgKyBhdHRyaWJ1dGVzW0NTU19GSUxFXSArIFwiXFxcIiBjYW5ub3QgYmUgZm91bmQhIExvb2tpbmcgZm9yIHdlYnBhY2sgbW9kdWxlIHdpdGggbmFtZSBcXFwiXCIgKyByZXNvbHZlZENzc01vZHVsZU5hbWUgKyBcIlxcXCJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1vZHVsZU5hbWUgJiYgIWNzc0FwcGxpZWQpIHtcbiAgICAgICAgdmFyIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJjc3NcIik7XG4gICAgICAgIGlmIChyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLmFkZENzc0ZpbGUocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xudmFyIGFwcGx5Q29tcG9uZW50QXR0cmlidXRlcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJhcHBseUNvbXBvbmVudEF0dHJpYnV0ZXNcIiwgZnVuY3Rpb24gKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcykge1xuICAgIGlmIChpbnN0YW5jZSAmJiBpbnN0YW5jZU1vZHVsZSkge1xuICAgICAgICBmb3IgKHZhciBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHZhciBhdHRyVmFsdWUgPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgICAgICAgICAgaWYgKGF0dHIuaW5kZXhPZihcIjpcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBsYXRmb3JtTmFtZSA9IGF0dHIuc3BsaXQoXCI6XCIpWzBdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBpZiAocGxhdGZvcm1OYW1lLnRvTG93ZXJDYXNlKCkgPT09IHBsYXRmb3JtLmRldmljZS5vcy50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHIgPSBhdHRyLnNwbGl0KFwiOlwiKVsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0ci5pbmRleE9mKFwiLlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViT2JqID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBhdHRyLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvcE5hbWUgPSBwcm9wZXJ0aWVzW3Byb3BlcnRpZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViT2JqICE9PSB1bmRlZmluZWQgJiYgc3ViT2JqICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJPYmogPSBzdWJPYmpbcHJvcGVydGllc1tpXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN1Yk9iaiAhPT0gdW5kZWZpbmVkICYmIHN1Yk9iaiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRQcm9wZXJ0eVZhbHVlKHN1Yk9iaiwgaW5zdGFuY2VNb2R1bGUsIG1vZHVsZUV4cG9ydHMsIHN1YlByb3BOYW1lLCBhdHRyVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldFByb3BlcnR5VmFsdWUoaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlLCBtb2R1bGVFeHBvcnRzLCBhdHRyLCBhdHRyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5mdW5jdGlvbiBnZXRDb21wb25lbnRNb2R1bGUoZWxlbWVudE5hbWUsIG5hbWVzcGFjZSwgYXR0cmlidXRlcywgbW9kdWxlRXhwb3J0cywgbW9kdWxlTmFtZVBhdGgsIGlzUm9vdENvbXBvbmVudCkge1xuICAgIGVsZW1lbnROYW1lID0gZWxlbWVudE5hbWUuc3BsaXQoXCItXCIpLm1hcChmdW5jdGlvbiAocykgeyByZXR1cm4gc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zdWJzdHJpbmcoMSk7IH0pLmpvaW4oXCJcIik7XG4gICAgdmFyIF9hID0gY3JlYXRlQ29tcG9uZW50SW5zdGFuY2UoZWxlbWVudE5hbWUsIG5hbWVzcGFjZSksIGluc3RhbmNlID0gX2EuaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlID0gX2EuaW5zdGFuY2VNb2R1bGU7XG4gICAgbW9kdWxlRXhwb3J0cyA9IGdldENvbXBvbmVudE1vZHVsZUV4cG9ydHMoaW5zdGFuY2UsIG1vZHVsZUV4cG9ydHMsIGF0dHJpYnV0ZXMpO1xuICAgIGlmIChpc1Jvb3RDb21wb25lbnQpIHtcbiAgICAgICAgYXBwbHlDb21wb25lbnRDc3MoaW5zdGFuY2UsIG1vZHVsZU5hbWVQYXRoLCBhdHRyaWJ1dGVzKTtcbiAgICB9XG4gICAgYXBwbHlDb21wb25lbnRBdHRyaWJ1dGVzKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcyk7XG4gICAgdmFyIGNvbXBvbmVudE1vZHVsZTtcbiAgICBpZiAoaW5zdGFuY2UgJiYgaW5zdGFuY2VNb2R1bGUpIHtcbiAgICAgICAgY29tcG9uZW50TW9kdWxlID0geyBjb21wb25lbnQ6IGluc3RhbmNlLCBleHBvcnRzOiBpbnN0YW5jZU1vZHVsZSB9O1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlO1xufVxuZXhwb3J0cy5nZXRDb21wb25lbnRNb2R1bGUgPSBnZXRDb21wb25lbnRNb2R1bGU7XG5mdW5jdGlvbiBzZXRQcm9wZXJ0eVZhbHVlKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgZXhwb3J0cywgcHJvcGVydHlOYW1lLCBwcm9wZXJ0eVZhbHVlKSB7XG4gICAgaWYgKGlzQmluZGluZyhwcm9wZXJ0eVZhbHVlKSAmJiBpbnN0YW5jZS5iaW5kKSB7XG4gICAgICAgIHZhciBiaW5kT3B0aW9ucyA9IGJpbmRpbmdfYnVpbGRlcl8xLmdldEJpbmRpbmdPcHRpb25zKHByb3BlcnR5TmFtZSwgZ2V0QmluZGluZ0V4cHJlc3Npb25Gcm9tQXR0cmlidXRlKHByb3BlcnR5VmFsdWUpKTtcbiAgICAgICAgaW5zdGFuY2UuYmluZCh7XG4gICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eTogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eV0sXG4gICAgICAgICAgICB0YXJnZXRQcm9wZXJ0eTogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy50YXJnZXRQcm9wZXJ0eV0sXG4gICAgICAgICAgICBleHByZXNzaW9uOiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb25dLFxuICAgICAgICAgICAgdHdvV2F5OiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLnR3b1dheV1cbiAgICAgICAgfSwgYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy5zb3VyY2VdKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYmluZGFibGVfMS5pc0V2ZW50T3JHZXN0dXJlKHByb3BlcnR5TmFtZSwgaW5zdGFuY2UpKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gZXhwb3J0cyAmJiBleHBvcnRzW3Byb3BlcnR5VmFsdWVdO1xuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgaW5zdGFuY2Uub24ocHJvcGVydHlOYW1lLCBoYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc0tub3duRnVuY3Rpb24ocHJvcGVydHlOYW1lLCBpbnN0YW5jZSkgJiYgZXhwb3J0cyAmJiB0eXBlb2YgZXhwb3J0c1twcm9wZXJ0eVZhbHVlXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGluc3RhbmNlW3Byb3BlcnR5TmFtZV0gPSBleHBvcnRzW3Byb3BlcnR5VmFsdWVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5VmFsdWU7XG4gICAgfVxufVxuZXhwb3J0cy5zZXRQcm9wZXJ0eVZhbHVlID0gc2V0UHJvcGVydHlWYWx1ZTtcbmZ1bmN0aW9uIGdldEJpbmRpbmdFeHByZXNzaW9uRnJvbUF0dHJpYnV0ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKFwie3tcIiwgXCJcIikucmVwbGFjZShcIn19XCIsIFwiXCIpLnRyaW0oKTtcbn1cbmZ1bmN0aW9uIGlzQmluZGluZyh2YWx1ZSkge1xuICAgIHZhciBpc0JpbmRpbmc7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgc3RyID0gdmFsdWUudHJpbSgpO1xuICAgICAgICBpc0JpbmRpbmcgPSBzdHIuaW5kZXhPZihcInt7XCIpID09PSAwICYmIHN0ci5sYXN0SW5kZXhPZihcIn19XCIpID09PSBzdHIubGVuZ3RoIC0gMjtcbiAgICB9XG4gICAgcmV0dXJuIGlzQmluZGluZztcbn1cbnZhciBLTk9XTl9GVU5DVElPTlMgPSBcImtub3duRnVuY3Rpb25zXCI7XG5mdW5jdGlvbiBpc0tub3duRnVuY3Rpb24obmFtZSwgaW5zdGFuY2UpIHtcbiAgICByZXR1cm4gaW5zdGFuY2UuY29uc3RydWN0b3JcbiAgICAgICAgJiYgS05PV05fRlVOQ1RJT05TIGluIGluc3RhbmNlLmNvbnN0cnVjdG9yXG4gICAgICAgICYmIGluc3RhbmNlLmNvbnN0cnVjdG9yW0tOT1dOX0ZVTkNUSU9OU10uaW5kZXhPZihuYW1lKSAhPT0gLTE7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb21wb25lbnQtYnVpbGRlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBzYW5pdGl6ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgcmVtb3ZlRXh0ZW5zaW9uKSB7XG4gICAgaWYgKHJlbW92ZUV4dGVuc2lvbiA9PT0gdm9pZCAwKSB7IHJlbW92ZUV4dGVuc2lvbiA9IHRydWU7IH1cbiAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS50cmltKCk7XG4gICAgaWYgKG1vZHVsZU5hbWUuc3RhcnRzV2l0aChcIn4vXCIpKSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lLnN1YnN0cmluZygyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobW9kdWxlTmFtZS5zdGFydHNXaXRoKFwiflwiKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG1vZHVsZU5hbWUuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICBpZiAocmVtb3ZlRXh0ZW5zaW9uKSB7XG4gICAgICAgIHZhciBleHRUb1JlbW92ZSA9IFtcImpzXCIsIFwidHNcIiwgXCJ4bWxcIiwgXCJodG1sXCIsIFwiY3NzXCIsIFwic2Nzc1wiXTtcbiAgICAgICAgdmFyIGV4dGVuc2lvblJlZ0V4ID0gbmV3IFJlZ0V4cChcIiguKilcXFxcLig/OlwiICsgZXh0VG9SZW1vdmUuam9pbihcInxcIikgKyBcIilcIiwgXCJpXCIpO1xuICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5yZXBsYWNlKGV4dGVuc2lvblJlZ0V4LCBcIiQxXCIpO1xuICAgIH1cbiAgICByZXR1cm4gbW9kdWxlTmFtZTtcbn1cbmV4cG9ydHMuc2FuaXRpemVNb2R1bGVOYW1lID0gc2FuaXRpemVNb2R1bGVOYW1lO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bW9kdWxlLW5hbWUtc2FuaXRpemVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKSk7XG52YXIgQnV0dG9uQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJ1dHRvbkJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQnV0dG9uQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnV0dG9uQmFzZS5wcm90b3R5cGUsIFwidGV4dFdyYXBcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLndoaXRlU3BhY2UgPT09IFwibm9ybWFsXCI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0ZXh0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9IHZhbHVlID8gXCJub3JtYWxcIiA6IFwibm93cmFwXCI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJ1dHRvbkJhc2UudGFwRXZlbnQgPSBcInRhcFwiO1xuICAgIEJ1dHRvbkJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdGV4dF9iYXNlXzEuQ1NTVHlwZShcIkJ1dHRvblwiKVxuICAgIF0sIEJ1dHRvbkJhc2UpO1xuICAgIHJldHVybiBCdXR0b25CYXNlO1xufSh0ZXh0X2Jhc2VfMS5UZXh0QmFzZSkpO1xuZXhwb3J0cy5CdXR0b25CYXNlID0gQnV0dG9uQmFzZTtcbkJ1dHRvbkJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1idXR0b24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYnV0dG9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYnV0dG9uLWNvbW1vblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIgZ2VzdHVyZXNfMSA9IHJlcXVpcmUoXCIuLi9nZXN0dXJlc1wiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIGxhenlfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9sYXp5XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYnV0dG9uLWNvbW1vblwiKSk7XG52YXIgc2RrVmVyc2lvbiA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcnNlSW50KHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24pOyB9KTtcbnZhciBDbGlja0xpc3RlbmVyO1xudmFyIEFQSUxFVkVMO1xudmFyIEFuZHJvaWRCdXR0b247XG5mdW5jdGlvbiBpbml0aWFsaXplQ2xpY2tMaXN0ZW5lcigpIHtcbiAgICBpZiAoQ2xpY2tMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBDbGlja0xpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhDbGlja0xpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ2xpY2tMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgQ2xpY2tMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uQ2xpY2sgPSBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIG93bmVyLl9lbWl0KGJ1dHRvbl9jb21tb25fMS5CdXR0b25CYXNlLnRhcEV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ2xpY2tMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQudmlldy5WaWV3Lk9uQ2xpY2tMaXN0ZW5lcl0pXG4gICAgICAgIF0sIENsaWNrTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIENsaWNrTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIENsaWNrTGlzdGVuZXIgPSBDbGlja0xpc3RlbmVySW1wbDtcbn1cbnZhciBCdXR0b24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhCdXR0b24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQnV0dG9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBpZiAoIUFQSUxFVkVMKSB7XG4gICAgICAgICAgICBBUElMRVZFTCA9IGFuZHJvaWQub3MuQnVpbGQuVkVSU0lPTi5TREtfSU5UO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQnV0dG9uLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIUFuZHJvaWRCdXR0b24pIHtcbiAgICAgICAgICAgIEFuZHJvaWRCdXR0b24gPSBhbmRyb2lkLndpZGdldC5CdXR0b247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBBbmRyb2lkQnV0dG9uKHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaW5pdGlhbGl6ZUNsaWNrTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIGNsaWNrTGlzdGVuZXIgPSBuZXcgQ2xpY2tMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRPbkNsaWNrTGlzdGVuZXIoY2xpY2tMaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuY2xpY2tMaXN0ZW5lciA9IGNsaWNrTGlzdGVuZXI7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY2xpY2tMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUxpc3RBbmltYXRvciAmJiBBUElMRVZFTCA+PSAyMSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFN0YXRlTGlzdEFuaW1hdG9yKHRoaXMuX3N0YXRlTGlzdEFuaW1hdG9yKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlTGlzdEFuaW1hdG9yID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLl91cGRhdGVCdXR0b25TdGF0ZUNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoc3Vic2NyaWJlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChzdWJzY3JpYmUpIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlciA9IHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlciB8fCAoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGFyZ3MuYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZ2VzdHVyZXNfMS5Ub3VjaEFjdGlvbi51cDpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBnZXN0dXJlc18xLlRvdWNoQWN0aW9uLmNhbmNlbDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJub3JtYWxcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBnZXN0dXJlc18xLlRvdWNoQWN0aW9uLmRvd246XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub24oZ2VzdHVyZXNfMS5HZXN0dXJlVHlwZXMudG91Y2gsIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm9mZihnZXN0dXJlc18xLkdlc3R1cmVUeXBlcy50b3VjaCwgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3AsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ1RvcCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGJ1dHRvbl9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgYnV0dG9uX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nUmlnaHQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGJ1dHRvbl9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJSaWdodFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0JvdHRvbSwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nQm90dG9tKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgYnV0dG9uX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGgsIDApKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdMZWZ0KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgYnV0dG9uX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyBidXR0b25fY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS56SW5kZXhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChBUElMRVZFTCA+PSAyMSkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3N0YXRlTGlzdEFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGVMaXN0QW5pbWF0b3IgPSBuYXRpdmVWaWV3LmdldFN0YXRlTGlzdEFuaW1hdG9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldFN0YXRlTGlzdEFuaW1hdG9yKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFpJbmRleCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHZhbHVlID09PSBcImluaXRpYWxcIiA/IFwiY2VudGVyXCIgOiB2YWx1ZTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEudGV4dEFsaWdubWVudFByb3BlcnR5LnNldE5hdGl2ZV0uY2FsbCh0aGlzLCBuZXdWYWx1ZSk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmdldERlZmF1bHRFbGV2YXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyMSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDI7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmdldERlZmF1bHREeW5hbWljRWxldmF0aW9uT2Zmc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2RrVmVyc2lvbigpIDwgMjEpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiA0O1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBCdXR0b24ucHJvdG90eXBlLCBcImNyZWF0ZU5hdGl2ZVZpZXdcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGJ1dHRvbl9jb21tb25fMS5Qc2V1ZG9DbGFzc0hhbmRsZXIoXCJub3JtYWxcIiwgXCJoaWdobGlnaHRlZFwiLCBcInByZXNzZWRcIiwgXCJhY3RpdmVcIilcbiAgICBdLCBCdXR0b24ucHJvdG90eXBlLCBcIl91cGRhdGVCdXR0b25TdGF0ZUNoYW5nZUhhbmRsZXJcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEJ1dHRvbjtcbn0oYnV0dG9uX2NvbW1vbl8xLkJ1dHRvbkJhc2UpKTtcbmV4cG9ydHMuQnV0dG9uID0gQnV0dG9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnV0dG9uLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgQ29udGVudFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb250ZW50VmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb250ZW50VmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGVudFZpZXcucHJvdG90eXBlLCBcImNvbnRlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIG9sZFZpZXcgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHRoaXMuX2NvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fY29udGVudCA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2NvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fb25Db250ZW50Q2hhbmdlZChvbGRWaWV3LCB2YWx1ZSk7XG4gICAgICAgICAgICBpZiAodmlld18xLmlzSU9TICYmIG9sZFZpZXcgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250ZW50Vmlldy5wcm90b3R5cGUsIFwibGF5b3V0Vmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0XzEgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQuX2VhY2hMYXlvdXRWaWV3KGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RfMSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNb3JlIHRoYW4gb25lIGxheW91dCBjaGlsZCBpbnNpZGUgYSBDb250ZW50Vmlld1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRlbnRWaWV3LnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnQgPyAxIDogMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLl9vbkNvbnRlbnRDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFZpZXcsIG5ld1ZpZXcpIHtcbiAgICB9O1xuICAgIENvbnRlbnRWaWV3LnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuVmlldykge1xuICAgICAgICAgICAgdGhpcy5jb250ZW50ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRlbnRWaWV3LnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5fY29udGVudDtcbiAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb250ZW50Vmlldy5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB2aWV3XzEuVmlldy5tZWFzdXJlQ2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aCA9IHZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSB2aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgbWVhc3VyZVdpZHRoID0gTWF0aC5tYXgocmVzdWx0Lm1lYXN1cmVkV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KHJlc3VsdC5tZWFzdXJlZEhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IHZpZXdfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIENvbnRlbnRWaWV3LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmlld18xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCAwLCAwLCByaWdodCAtIGxlZnQsIGJvdHRvbSAtIHRvcCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29udGVudFZpZXc7XG59KHZpZXdfMS5DdXN0b21MYXlvdXRWaWV3KSk7XG5leHBvcnRzLkNvbnRlbnRWaWV3ID0gQ29udGVudFZpZXc7XG5Db250ZW50Vmlldy5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnRlbnQtdmlldy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3Byb3BlcnRpZXNcIik7XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbmV4cG9ydHMuT2JzZXJ2YWJsZSA9IG9ic2VydmFibGVfMS5PYnNlcnZhYmxlO1xuZXhwb3J0cy5XcmFwcGVkVmFsdWUgPSBvYnNlcnZhYmxlXzEuV3JhcHBlZFZhbHVlO1xudmFyIHdlYWtfZXZlbnRfbGlzdGVuZXJfMSA9IHJlcXVpcmUoXCIuLi93ZWFrLWV2ZW50LWxpc3RlbmVyXCIpO1xudmFyIGJpbmRpbmdfYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uLy4uL2J1aWxkZXIvYmluZGluZy1idWlsZGVyXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi90cmFjZVwiKTtcbmV4cG9ydHMudHJhY2VFbmFibGVkID0gdHJhY2VfMS5pc0VuYWJsZWQ7XG5leHBvcnRzLnRyYWNlV3JpdGUgPSB0cmFjZV8xLndyaXRlO1xuZXhwb3J0cy50cmFjZUVycm9yID0gdHJhY2VfMS5lcnJvcjtcbmV4cG9ydHMudHJhY2VDYXRlZ29yaWVzID0gdHJhY2VfMS5jYXRlZ29yaWVzO1xuZXhwb3J0cy50cmFjZU5vdGlmeUV2ZW50ID0gdHJhY2VfMS5ub3RpZnlFdmVudDtcbmV4cG9ydHMuaXNDYXRlZ29yeVNldCA9IHRyYWNlXzEuaXNDYXRlZ29yeVNldDtcbmV4cG9ydHMudHJhY2VNZXNzYWdlVHlwZSA9IHRyYWNlXzEubWVzc2FnZVR5cGU7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgYXBwbGljYXRpb25Db21tb24gPSByZXF1aXJlKFwiLi4vLi4vLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIHBvbHltZXJFeHByZXNzaW9ucyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9qcy1saWJzL3BvbHltZXItZXhwcmVzc2lvbnNcIik7XG52YXIgY29udGV4dEtleSA9IFwiY29udGV4dFwiO1xudmFyIHBhcmFtc1JlZ2V4ID0gL1xcW1xccyooWydcIl0pKihcXHcqKVxcMVxccypcXF0vO1xudmFyIGJjID0gYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cztcbnZhciBlbXB0eUFycmF5ID0gW107XG52YXIgcHJvcGVydGllc0NhY2hlID0ge307XG5mdW5jdGlvbiBnZXRQcm9wZXJ0aWVzKHByb3BlcnR5KSB7XG4gICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICByZXR1cm4gZW1wdHlBcnJheTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IHByb3BlcnRpZXNDYWNoZVtwcm9wZXJ0eV07XG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgcGFyZW50c01hdGNoZXMgPSBwcm9wZXJ0eS5tYXRjaChiaW5kaW5nX2J1aWxkZXJfMS5wYXJlbnRzUmVnZXgpO1xuICAgIHJlc3VsdCA9IHByb3BlcnR5LnJlcGxhY2UoYmluZGluZ19idWlsZGVyXzEucGFyZW50c1JlZ2V4LCBcInBhcmVudHNNYXRjaFwiKVxuICAgICAgICAucmVwbGFjZSgvXFxdL2csIFwiXCIpXG4gICAgICAgIC5zcGxpdCgvXFwufFxcWy8pO1xuICAgIHZhciBwYXJlbnRzTWF0Y2hlc0NvdW50ZXIgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwLCByZXN1bHRMZW5ndGggPSByZXN1bHQubGVuZ3RoOyBpIDwgcmVzdWx0TGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHJlc3VsdFtpXSA9PT0gXCJwYXJlbnRzTWF0Y2hcIikge1xuICAgICAgICAgICAgcmVzdWx0W2ldID0gcGFyZW50c01hdGNoZXNbcGFyZW50c01hdGNoZXNDb3VudGVyKytdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByb3BlcnRpZXNDYWNoZVtwcm9wZXJ0eV0gPSByZXN1bHQ7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldEV2ZW50T3JHZXN0dXJlTmFtZShuYW1lKSB7XG4gICAgcmV0dXJuIG5hbWUuaW5kZXhPZihcIm9uXCIpID09PSAwID8gbmFtZS5zdWJzdHIoMiwgbmFtZS5sZW5ndGggLSAyKSA6IG5hbWU7XG59XG5leHBvcnRzLmdldEV2ZW50T3JHZXN0dXJlTmFtZSA9IGdldEV2ZW50T3JHZXN0dXJlTmFtZTtcbmZ1bmN0aW9uIGlzR2VzdHVyZShldmVudE9yR2VzdHVyZU5hbWUpIHtcbiAgICB2YXIgdCA9IGV2ZW50T3JHZXN0dXJlTmFtZS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gdCA9PT0gXCJ0YXBcIlxuICAgICAgICB8fCB0ID09PSBcImRvdWJsZXRhcFwiXG4gICAgICAgIHx8IHQgPT09IFwicGluY2hcIlxuICAgICAgICB8fCB0ID09PSBcInBhblwiXG4gICAgICAgIHx8IHQgPT09IFwic3dpcGVcIlxuICAgICAgICB8fCB0ID09PSBcInJvdGF0aW9uXCJcbiAgICAgICAgfHwgdCA9PT0gXCJsb25ncHJlc3NcIlxuICAgICAgICB8fCB0ID09PSBcInRvdWNoXCI7XG59XG5leHBvcnRzLmlzR2VzdHVyZSA9IGlzR2VzdHVyZTtcbmZ1bmN0aW9uIGlzRXZlbnRPckdlc3R1cmUobmFtZSwgdmlldykge1xuICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgZXZlbnRPckdlc3R1cmVOYW1lID0gZ2V0RXZlbnRPckdlc3R1cmVOYW1lKG5hbWUpO1xuICAgICAgICB2YXIgZXZ0ID0gZXZlbnRPckdlc3R1cmVOYW1lICsgXCJFdmVudFwiO1xuICAgICAgICByZXR1cm4gdmlldy5jb25zdHJ1Y3RvciAmJiBldnQgaW4gdmlldy5jb25zdHJ1Y3RvciB8fCBpc0dlc3R1cmUoZXZlbnRPckdlc3R1cmVOYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnRzLmlzRXZlbnRPckdlc3R1cmUgPSBpc0V2ZW50T3JHZXN0dXJlO1xudmFyIEJpbmRpbmcgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJpbmRpbmcodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbmV3IFdlYWtSZWYodGFyZ2V0KTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5zb3VyY2VQcm9wZXJ0aWVzID0gZ2V0UHJvcGVydGllcyhvcHRpb25zLnNvdXJjZVByb3BlcnR5KTtcbiAgICAgICAgdGhpcy50YXJnZXRPcHRpb25zID0gdGhpcy5yZXNvbHZlT3B0aW9ucyh0YXJnZXQsIGdldFByb3BlcnRpZXMob3B0aW9ucy50YXJnZXRQcm9wZXJ0eSkpO1xuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0T3B0aW9ucykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwcm9wZXJ0eTogXCIgKyBvcHRpb25zLnRhcmdldFByb3BlcnR5ICsgXCIgZm9yIHRhcmdldDogXCIgKyB0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnR3b1dheSkge1xuICAgICAgICAgICAgdmFyIHRhcmdldF8xID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICAgICAgaWYgKHRhcmdldF8xIGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXRfMS5vbih0aGlzLnRhcmdldE9wdGlvbnMucHJvcGVydHkgKyBcIkNoYW5nZVwiLCB0aGlzLm9uVGFyZ2V0UHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBCaW5kaW5nLnByb3RvdHlwZS5vblRhcmdldFByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVHdvV2F5KGRhdGEudmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUubG9hZGVkSGFuZGxlclZpc3VhbFRyZWVCaW5kaW5nID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGFyZ3Mub2JqZWN0O1xuICAgICAgICB0YXJnZXQub2ZmKFwibG9hZGVkXCIsIHRoaXMubG9hZGVkSGFuZGxlclZpc3VhbFRyZWVCaW5kaW5nLCB0aGlzKTtcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0YXJnZXQuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgIGlmIChjb250ZXh0ICE9PSB1bmRlZmluZWQgJiYgY29udGV4dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoY29udGV4dCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmNsZWFyU291cmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKG9ic2VydmFibGUsIGluZGV4LCBtYXApIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5yZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihvYnNlcnZhYmxlLCBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCBfdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgX3RoaXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5jbGVhcigpO1xuICAgICAgICBpZiAodGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc291cmNlT3B0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2VPcHRpb25zLmluc3RhbmNlLmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnNvdXJjZUFzT2JqZWN0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgb2JqZWN0VHlwZSA9IHR5cGVvZiBzb3VyY2U7XG4gICAgICAgIGlmIChvYmplY3RUeXBlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgTnVtYmVyKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob2JqZWN0VHlwZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBCb29sZWFuKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob2JqZWN0VHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IFN0cmluZyhzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5iaW5kaW5nQ29udGV4dENoYW5nZWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy51bmJpbmQoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmFsdWUgPSBkYXRhLnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbGVhckJpbmRpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0T3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgaWYgKHRoaXMuc291cmNlSXNCaW5kaW5nQ29udGV4dCAmJiB0YXJnZXQgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSAmJiB0aGlzLnRhcmdldE9wdGlvbnMucHJvcGVydHkgIT09IFwiYmluZGluZ0NvbnRleHRcIikge1xuICAgICAgICAgICAgdGFyZ2V0Lm9uKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlKHNvdXJjZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIHRoaXMuY2xlYXJTb3VyY2UoKTtcbiAgICAgICAgc291cmNlID0gdGhpcy5zb3VyY2VBc09iamVjdChzb3VyY2UpO1xuICAgICAgICBpZiAoIXR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKHNvdXJjZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlID0gbmV3IFdlYWtSZWYoc291cmNlKTtcbiAgICAgICAgICAgIHRoaXMuc291cmNlT3B0aW9ucyA9IHRoaXMucmVzb2x2ZU9wdGlvbnMoc291cmNlLCB0aGlzLnNvdXJjZVByb3BlcnRpZXMpO1xuICAgICAgICAgICAgdmFyIHNvdXJjZVZhbHVlID0gdGhpcy5nZXRTb3VyY2VQcm9wZXJ0eVZhbHVlKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChzb3VyY2VWYWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzKHRoaXMuc291cmNlLCB0aGlzLnNvdXJjZVByb3BlcnRpZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF0aGlzLnNvdXJjZUlzQmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VWYWx1ZSA9IHRoaXMuZ2V0U291cmNlUHJvcGVydHlWYWx1ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQoc291cmNlVmFsdWUgPyBzb3VyY2VWYWx1ZSA6IHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0T3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnR3b1dheSkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5vZmYodGhpcy50YXJnZXRPcHRpb25zLnByb3BlcnR5ICsgXCJDaGFuZ2VcIiwgdGhpcy5vblRhcmdldFByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0ICYmIHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJiaW5kaW5nQ29udGV4dFwiKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lm9mZihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50YXJnZXRPcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldE9wdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zb3VyY2VQcm9wZXJ0aWVzID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIXRoaXMuc291cmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbGVhclNvdXJjZSgpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUucmVzb2x2ZU9iamVjdHNBbmRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKHNvdXJjZSwgcHJvcGVydGllcykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBjdXJyZW50T2JqZWN0ID0gc291cmNlO1xuICAgICAgICB2YXIgY3VycmVudE9iamVjdENoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHByb3BzQXJyYXlMZW5ndGggPSBwcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IHByb3BzQXJyYXlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gcHJvcGVydGllc1tpXTtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gYmMuYmluZGluZ1ZhbHVlS2V5KSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE9iamVjdENoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBiYy5wYXJlbnRWYWx1ZUtleSB8fCBwcm9wZXJ0eS5pbmRleE9mKGJjLnBhcmVudHNWYWx1ZUtleSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50VmlldyA9IHRoaXMuZ2V0UGFyZW50Vmlldyh0aGlzLnRhcmdldC5nZXQoKSwgcHJvcGVydHkpLnZpZXc7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudFZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudE9iamVjdCA9IHBhcmVudFZpZXcuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5zdGFuY2UgPSB0aGlzLnRhcmdldC5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SW5zdGFuY2Uub2ZmKFwibG9hZGVkXCIsIHRoaXMubG9hZGVkSGFuZGxlclZpc3VhbFRyZWVCaW5kaW5nLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SW5zdGFuY2Uub24oXCJsb2FkZWRcIiwgdGhpcy5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY3VycmVudE9iamVjdCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgaW5zdGFuY2U6IGN1cnJlbnRPYmplY3QsIHByb3BlcnR5OiBwcm9wZXJ0eSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjdXJyZW50T2JqZWN0Q2hhbmdlZCAmJiAoaSA8IHByb3BzQXJyYXlMZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmplY3QgPSBjdXJyZW50T2JqZWN0ID8gY3VycmVudE9iamVjdFtwcm9wZXJ0aWVzW2ldXSA6IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5hZGRQcm9wZXJ0eUNoYW5nZUxpc3RlbmVycyA9IGZ1bmN0aW9uIChzb3VyY2UsIHNvdXJjZVByb3BlcnR5LCBwYXJlbnRQcm9wZXJpZXMpIHtcbiAgICAgICAgdmFyIG9iamVjdHNBbmRQcm9wZXJ0aWVzID0gdGhpcy5yZXNvbHZlT2JqZWN0c0FuZFByb3BlcnRpZXMoc291cmNlLmdldCgpLCBzb3VyY2VQcm9wZXJ0eSk7XG4gICAgICAgIHZhciBwcm9wID0gcGFyZW50UHJvcGVyaWVzIHx8IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwcm9wTmFtZSA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW2ldLnByb3BlcnR5O1xuICAgICAgICAgICAgcHJvcCArPSBcIiRcIiArIHByb3BOYW1lO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRPYmplY3QgPSBvYmplY3RzQW5kUHJvcGVydGllc1tpXS5pbnN0YW5jZTtcbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5oYXMocHJvcCkgJiYgY3VycmVudE9iamVjdCBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlICYmIGN1cnJlbnRPYmplY3QuX2lzVmlld0Jhc2UpIHtcbiAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIoY3VycmVudE9iamVjdCwgcHJvcE5hbWUgKyBcIkNoYW5nZVwiLCB0aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIoY3VycmVudE9iamVjdCwgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5zZXQocHJvcCwgY3VycmVudE9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5oYXMocHJvcCkgJiYgY3VycmVudE9iamVjdCBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLmFkZFdlYWtFdmVudExpc3RlbmVyKGN1cnJlbnRPYmplY3QsIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuc2V0KHByb3AsIGN1cnJlbnRPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5wcmVwYXJlRXhwcmVzc2lvbkZvclVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVzY2FwZWRTb3VyY2VQcm9wZXJ0eSA9IHV0aWxzXzEuZXNjYXBlUmVnZXhTeW1ib2xzKHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSk7XG4gICAgICAgIHZhciBleHBSZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlZFNvdXJjZVByb3BlcnR5LCBcImdcIik7XG4gICAgICAgIHZhciByZXN1bHRFeHAgPSB0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbi5yZXBsYWNlKGV4cFJlZ2V4LCBiYy5uZXdQcm9wZXJ0eVZhbHVlS2V5KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdEV4cDtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZVR3b1dheSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy51cGRhdGluZyB8fCAhdGhpcy5vcHRpb25zLnR3b1dheSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkTW9kZWwgPSB7fTtcbiAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtiYy5iaW5kaW5nVmFsdWVLZXldID0gdmFsdWU7XG4gICAgICAgICAgICBjaGFuZ2VkTW9kZWxbYmMubmV3UHJvcGVydHlWYWx1ZUtleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VQcm9wZXJ0eU5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlT3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHNvdXJjZVByb3BlcnR5TmFtZSA9IHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHkgPT09IFwic3RyaW5nXCIgJiYgdGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5LmluZGV4T2YoXCIuXCIpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVByb3BlcnR5TmFtZSA9IHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzb3VyY2VQcm9wZXJ0eU5hbWUgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkTW9kZWxbc291cmNlUHJvcGVydHlOYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHVwZGF0ZUV4cHJlc3Npb24gPSB0aGlzLnByZXBhcmVFeHByZXNzaW9uRm9yVXBkYXRlKCk7XG4gICAgICAgICAgICB0aGlzLnByZXBhcmVDb250ZXh0Rm9yRXhwcmVzc2lvbihjaGFuZ2VkTW9kZWwsIHVwZGF0ZUV4cHJlc3Npb24sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvblZhbHVlID0gdGhpcy5fZ2V0RXhwcmVzc2lvblZhbHVlKHVwZGF0ZUV4cHJlc3Npb24sIHRydWUsIGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvblZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGV4cHJlc3Npb25WYWx1ZS5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IGV4cHJlc3Npb25WYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZVNvdXJjZShuZXdWYWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5fZ2V0RXhwcmVzc2lvblZhbHVlID0gZnVuY3Rpb24gKGV4cHJlc3Npb24sIGlzQmFja0NvbnZlcnQsIGNoYW5nZWRNb2RlbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGV4cF8xID0gcG9seW1lckV4cHJlc3Npb25zLlBvbHltZXJFeHByZXNzaW9ucy5nZXRFeHByZXNzaW9uKGV4cHJlc3Npb24pO1xuICAgICAgICAgICAgaWYgKGV4cF8xKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHRfMSA9IHRoaXMuc291cmNlICYmIHRoaXMuc291cmNlLmdldCAmJiB0aGlzLnNvdXJjZS5nZXQoKSB8fCBnbG9iYWw7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgdmFyIGFkZGVkUHJvcHMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb3VyY2VzID0gYXBwbGljYXRpb25Db21tb24uZ2V0UmVzb3VyY2VzKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgcHJvcCBpbiByZXNvdXJjZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc291cmNlcy5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiAhY29udGV4dF8xLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0XzFbcHJvcF0gPSByZXNvdXJjZXNbcHJvcF07XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRlZFByb3BzLnB1c2gocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlQ29udGV4dEZvckV4cHJlc3Npb24oY29udGV4dF8xLCBleHByZXNzaW9uLCBhZGRlZFByb3BzKTtcbiAgICAgICAgICAgICAgICBtb2RlbFtjb250ZXh0S2V5XSA9IGNvbnRleHRfMTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZXhwXzEuZ2V0VmFsdWUobW9kZWwsIGlzQmFja0NvbnZlcnQsIGNoYW5nZWRNb2RlbCA/IGNoYW5nZWRNb2RlbCA6IG1vZGVsKTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkZWRQcm9wc0xlbmd0aCA9IGFkZGVkUHJvcHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWRkZWRQcm9wc0xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb250ZXh0XzFbYWRkZWRQcm9wc1tpXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFkZGVkUHJvcHMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcihleHByZXNzaW9uICsgXCIgaXMgbm90IGEgdmFsaWQgZXhwcmVzc2lvbi5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBcIlJ1bi10aW1lIGVycm9yIG9jY3VyZWQgaW4gZmlsZTogXCIgKyBlLnNvdXJjZVVSTCArIFwiIGF0IGxpbmU6IFwiICsgZS5saW5lICsgXCIgYW5kIGNvbHVtbjogXCIgKyBlLmNvbHVtbjtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgc291cmNlUHJvcHMgPSB0aGlzLnNvdXJjZVByb3BlcnRpZXM7XG4gICAgICAgIHZhciBzb3VyY2VQcm9wc0xlbmd0aCA9IHNvdXJjZVByb3BzLmxlbmd0aDtcbiAgICAgICAgdmFyIGNoYW5nZWRQcm9wZXJ0eUluZGV4ID0gc291cmNlUHJvcHMuaW5kZXhPZihkYXRhLnByb3BlcnR5TmFtZSk7XG4gICAgICAgIHZhciBwYXJlbnRQcm9wcyA9IFwiXCI7XG4gICAgICAgIGlmIChjaGFuZ2VkUHJvcGVydHlJbmRleCA+IC0xKSB7XG4gICAgICAgICAgICBwYXJlbnRQcm9wcyA9IFwiJFwiICsgc291cmNlUHJvcHMuc2xpY2UoMCwgY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKS5qb2luKFwiJFwiKTtcbiAgICAgICAgICAgIHdoaWxlICh0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmdldChwYXJlbnRQcm9wcykgIT09IGRhdGEub2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZFByb3BlcnR5SW5kZXggKz0gc291cmNlUHJvcHMuc2xpY2UoY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKS5pbmRleE9mKGRhdGEucHJvcGVydHlOYW1lKSArIDE7XG4gICAgICAgICAgICAgICAgcGFyZW50UHJvcHMgPSBcIiRcIiArIHNvdXJjZVByb3BzLnNsaWNlKDAsIGNoYW5nZWRQcm9wZXJ0eUluZGV4ICsgMSkuam9pbihcIiRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvblZhbHVlID0gdGhpcy5fZ2V0RXhwcmVzc2lvblZhbHVlKHRoaXMub3B0aW9ucy5leHByZXNzaW9uLCBmYWxzZSwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIGlmIChleHByZXNzaW9uVmFsdWUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoZXhwcmVzc2lvblZhbHVlLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KGV4cHJlc3Npb25WYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlZFByb3BlcnR5SW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9IHNvdXJjZVByb3BzLnNsaWNlKGNoYW5nZWRQcm9wZXJ0eUluZGV4ICsgMSk7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BzTGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wc0xlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wc0xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlW3Byb3BzW2ldXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEucHJvcGVydHlOYW1lID09PSB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQoZGF0YS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGFuZ2VkUHJvcGVydHlJbmRleCA+IC0xICYmIGNoYW5nZWRQcm9wZXJ0eUluZGV4IDwgc291cmNlUHJvcHNMZW5ndGggLSAxKSB7XG4gICAgICAgICAgICB2YXIgcHJvYmFibHlDaGFuZ2VkT2JqZWN0ID0gdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5nZXQocGFyZW50UHJvcHMpO1xuICAgICAgICAgICAgaWYgKHByb2JhYmx5Q2hhbmdlZE9iamVjdCAmJlxuICAgICAgICAgICAgICAgIHByb2JhYmx5Q2hhbmdlZE9iamVjdCAhPT0gZGF0YS5vYmplY3Rbc291cmNlUHJvcHNbY2hhbmdlZFByb3BlcnR5SW5kZXhdXSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBzb3VyY2VQcm9wc0xlbmd0aCAtIDE7IGkgPiBjaGFuZ2VkUHJvcGVydHlJbmRleDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wID0gXCIkXCIgKyBzb3VyY2VQcm9wcy5zbGljZSgwLCBpICsgMSkuam9pbihcIiRcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmhhcyhwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyKHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZ2V0KHByb3ApLCBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZGVsZXRlKHByb3ApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuZXdQcm9wcyA9IHNvdXJjZVByb3BzLnNsaWNlKGNoYW5nZWRQcm9wZXJ0eUluZGV4ICsgMSk7XG4gICAgICAgICAgICAgICAgdmFyIG5ld09iamVjdCA9IGRhdGEub2JqZWN0W3NvdXJjZVByb3BzW2NoYW5nZWRQcm9wZXJ0eUluZGV4XV07XG4gICAgICAgICAgICAgICAgaWYgKCF0eXBlcy5pc051bGxPclVuZGVmaW5lZChuZXdPYmplY3QpICYmIHR5cGVvZiBuZXdPYmplY3QgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRQcm9wZXJ0eUNoYW5nZUxpc3RlbmVycyhuZXcgV2Vha1JlZihuZXdPYmplY3QpLCBuZXdQcm9wcywgcGFyZW50UHJvcHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUucHJlcGFyZUNvbnRleHRGb3JFeHByZXNzaW9uID0gZnVuY3Rpb24gKG1vZGVsLCBleHByZXNzaW9uLCBuZXdQcm9wcykge1xuICAgICAgICB2YXIgcGFyZW50Vmlld0FuZEluZGV4O1xuICAgICAgICB2YXIgcGFyZW50VmlldztcbiAgICAgICAgdmFyIGFkZGVkUHJvcHMgPSBuZXdQcm9wcyB8fCBbXTtcbiAgICAgICAgaWYgKGV4cHJlc3Npb24uaW5kZXhPZihiYy5iaW5kaW5nVmFsdWVLZXkpID4gLTEpIHtcbiAgICAgICAgICAgIG1vZGVsW2JjLmJpbmRpbmdWYWx1ZUtleV0gPSBtb2RlbDtcbiAgICAgICAgICAgIGFkZGVkUHJvcHMucHVzaChiYy5iaW5kaW5nVmFsdWVLZXkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChleHByZXNzaW9uLmluZGV4T2YoYmMucGFyZW50VmFsdWVLZXkpID4gLTEpIHtcbiAgICAgICAgICAgIHBhcmVudFZpZXcgPSB0aGlzLmdldFBhcmVudFZpZXcodGhpcy50YXJnZXQuZ2V0KCksIGJjLnBhcmVudFZhbHVlS2V5KS52aWV3O1xuICAgICAgICAgICAgaWYgKHBhcmVudFZpZXcpIHtcbiAgICAgICAgICAgICAgICBtb2RlbFtiYy5wYXJlbnRWYWx1ZUtleV0gPSBwYXJlbnRWaWV3LmJpbmRpbmdDb250ZXh0O1xuICAgICAgICAgICAgICAgIGFkZGVkUHJvcHMucHVzaChiYy5wYXJlbnRWYWx1ZUtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudHNBcnJheSA9IGV4cHJlc3Npb24ubWF0Y2goYmluZGluZ19idWlsZGVyXzEucGFyZW50c1JlZ2V4KTtcbiAgICAgICAgaWYgKHBhcmVudHNBcnJheSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJlbnRzQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRWaWV3QW5kSW5kZXggPSB0aGlzLmdldFBhcmVudFZpZXcodGhpcy50YXJnZXQuZ2V0KCksIHBhcmVudHNBcnJheVtpXSk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudFZpZXdBbmRJbmRleC52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsW2JjLnBhcmVudHNWYWx1ZUtleV0gPSBtb2RlbFtiYy5wYXJlbnRzVmFsdWVLZXldIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFtiYy5wYXJlbnRzVmFsdWVLZXldW3BhcmVudFZpZXdBbmRJbmRleC5pbmRleF0gPSBwYXJlbnRWaWV3QW5kSW5kZXgudmlldy5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKGJjLnBhcmVudHNWYWx1ZUtleSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5nZXRTb3VyY2VQcm9wZXJ0eVZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkTW9kZWwgPSB7fTtcbiAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtiYy5iaW5kaW5nVmFsdWVLZXldID0gdGhpcy5zb3VyY2UgPyB0aGlzLnNvdXJjZS5nZXQoKSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uVmFsdWUgPSB0aGlzLl9nZXRFeHByZXNzaW9uVmFsdWUodGhpcy5vcHRpb25zLmV4cHJlc3Npb24sIGZhbHNlLCBjaGFuZ2VkTW9kZWwpO1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25WYWx1ZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShleHByZXNzaW9uVmFsdWUubWVzc2FnZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25WYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlT3B0aW9uc0luc3RhbmNlID0gdGhpcy5zb3VyY2VPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSA9PT0gYmMuYmluZGluZ1ZhbHVlS2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZU9wdGlvbnNJbnN0YW5jZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChzb3VyY2VPcHRpb25zSW5zdGFuY2UgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkgJiYgKHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAmJiB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgIT09IFwiXCIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZU9wdGlvbnNJbnN0YW5jZS5nZXQodGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNvdXJjZU9wdGlvbnNJbnN0YW5jZSAmJiB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgJiYgdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICE9PSBcIlwiICYmXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5IGluIHNvdXJjZU9wdGlvbnNJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2VPcHRpb25zSW5zdGFuY2VbdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJQcm9wZXJ0eTogJ1wiICsgdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICsgXCInIGlzIGludmFsaWQgb3IgZG9lcyBub3QgZXhpc3QuIFNvdXJjZVByb3BlcnR5OiAnXCIgKyB0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHkgKyBcIidcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuY2xlYXJCaW5kaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmNsZWFyU291cmNlKCk7XG4gICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHByb3BlcnRpZXNfMS51bnNldFZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZVRhcmdldCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy51cGRhdGluZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlT3B0aW9ucyh0aGlzLnRhcmdldE9wdGlvbnMsIHR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSA/IHByb3BlcnRpZXNfMS51bnNldFZhbHVlIDogdmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlU291cmNlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0aW5nIHx8ICF0aGlzLnNvdXJjZSB8fCAhdGhpcy5zb3VyY2UuZ2V0KCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZU9wdGlvbnModGhpcy5zb3VyY2VPcHRpb25zLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5nZXRQYXJlbnRWaWV3ID0gZnVuY3Rpb24gKHRhcmdldCwgcHJvcGVydHkpIHtcbiAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHZpZXc6IG51bGwsIGluZGV4OiBudWxsIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgaWYgKHByb3BlcnR5ID09PSBiYy5wYXJlbnRWYWx1ZUtleSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSBudWxsO1xuICAgICAgICBpZiAocHJvcGVydHkuaW5kZXhPZihiYy5wYXJlbnRzVmFsdWVLZXkpID09PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0YXJnZXQucGFyZW50O1xuICAgICAgICAgICAgdmFyIGluZGV4UGFyYW1zID0gcGFyYW1zUmVnZXguZXhlYyhwcm9wZXJ0eSk7XG4gICAgICAgICAgICBpZiAoaW5kZXhQYXJhbXMgJiYgaW5kZXhQYXJhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXhQYXJhbXNbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzTmFOKGluZGV4KSkge1xuICAgICAgICAgICAgICAgIHZhciBpbmRleEFzSW50ID0gcGFyc2VJbnQoaW5kZXgpO1xuICAgICAgICAgICAgICAgIHdoaWxlIChpbmRleEFzSW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICBpbmRleEFzSW50LS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZXMuaXNTdHJpbmcoaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHJlc3VsdCAmJiByZXN1bHQudHlwZU5hbWUgIT09IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHZpZXc6IHJlc3VsdCwgaW5kZXg6IGluZGV4IH07XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5yZXNvbHZlT3B0aW9ucyA9IGZ1bmN0aW9uIChvYmosIHByb3BlcnRpZXMpIHtcbiAgICAgICAgdmFyIG9iamVjdHNBbmRQcm9wZXJ0aWVzID0gdGhpcy5yZXNvbHZlT2JqZWN0c0FuZFByb3BlcnRpZXMob2JqLCBwcm9wZXJ0aWVzKTtcbiAgICAgICAgaWYgKG9iamVjdHNBbmRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZE9iaiA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW29iamVjdHNBbmRQcm9wZXJ0aWVzLmxlbmd0aCAtIDFdLmluc3RhbmNlO1xuICAgICAgICAgICAgdmFyIHByb3AgPSBvYmplY3RzQW5kUHJvcGVydGllc1tvYmplY3RzQW5kUHJvcGVydGllcy5sZW5ndGggLSAxXS5wcm9wZXJ0eTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2U6IG5ldyBXZWFrUmVmKHRoaXMuc291cmNlQXNPYmplY3QocmVzb2x2ZWRPYmopKSxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogcHJvcFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZU9wdGlvbnMgPSBmdW5jdGlvbiAob3B0aW9ucywgdmFsdWUpIHtcbiAgICAgICAgdmFyIG9wdGlvbnNJbnN0YW5jZTtcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbnN0YW5jZSkge1xuICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlID0gb3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9wdGlvbnNJbnN0YW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRpbmcgPSB0cnVlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGlzRXZlbnRPckdlc3R1cmUob3B0aW9ucy5wcm9wZXJ0eSwgb3B0aW9uc0luc3RhbmNlKSAmJlxuICAgICAgICAgICAgICAgIHR5cGVzLmlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlLm9mZihvcHRpb25zLnByb3BlcnR5LCBudWxsLCBvcHRpb25zSW5zdGFuY2UuYmluZGluZ0NvbnRleHQpO1xuICAgICAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZS5vbihvcHRpb25zLnByb3BlcnR5LCB2YWx1ZSwgb3B0aW9uc0luc3RhbmNlLmJpbmRpbmdDb250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnNJbnN0YW5jZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlLnNldChvcHRpb25zLnByb3BlcnR5LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Vbb3B0aW9ucy5wcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJCaW5kaW5nIGVycm9yIHdoaWxlIHNldHRpbmcgcHJvcGVydHkgXCIgKyBvcHRpb25zLnByb3BlcnR5ICsgXCIgb2YgXCIgKyBvcHRpb25zSW5zdGFuY2UgKyBcIjogXCIgKyBleCwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRpbmcgPSBmYWxzZTtcbiAgICB9O1xuICAgIHJldHVybiBCaW5kaW5nO1xufSgpKTtcbmV4cG9ydHMuQmluZGluZyA9IEJpbmRpbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iaW5kYWJsZS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcmVkdWNlQ1NTQ2FsYyA9IHJlcXVpcmUoXCJyZWR1Y2UtY3NzLWNhbGNcIik7XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3RyYWNlXCIpO1xudmFyIHN0eWxlXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZVwiKTtcbmV4cG9ydHMuU3R5bGUgPSBzdHlsZV8xLlN0eWxlO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3Byb2ZpbGluZ1wiKTtcbmV4cG9ydHMudW5zZXRWYWx1ZSA9IG5ldyBPYmplY3QoKTtcbnZhciBjc3NQcm9wZXJ0eU5hbWVzID0gW107XG52YXIgc3ltYm9sUHJvcGVydHlNYXAgPSB7fTtcbnZhciBjc3NTeW1ib2xQcm9wZXJ0eU1hcCA9IHt9O1xudmFyIGluaGVyaXRhYmxlUHJvcGVydGllcyA9IG5ldyBBcnJheSgpO1xudmFyIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllcyA9IG5ldyBBcnJheSgpO1xuZnVuY3Rpb24gcHJpbnQobWFwKSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG1hcCk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzEgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfMVtfaV07XG4gICAgICAgIHZhciBwcm9wID0gbWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcC5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlByb3BlcnR5IFwiICsgcHJvcC5uYW1lICsgXCIgbm90IFJlZ2lzdGVyZWQhISEhIVwiKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIF9wcmludFVucmVnaXN0ZXJlZFByb3BlcnRpZXMoKSB7XG4gICAgcHJpbnQoc3ltYm9sUHJvcGVydHlNYXApO1xuICAgIHByaW50KGNzc1N5bWJvbFByb3BlcnR5TWFwKTtcbn1cbmV4cG9ydHMuX3ByaW50VW5yZWdpc3RlcmVkUHJvcGVydGllcyA9IF9wcmludFVucmVnaXN0ZXJlZFByb3BlcnRpZXM7XG5mdW5jdGlvbiBfZ2V0UHJvcGVydGllcygpIHtcbiAgICByZXR1cm4gZ2V0UHJvcGVydGllc0Zyb21NYXAoc3ltYm9sUHJvcGVydHlNYXApO1xufVxuZXhwb3J0cy5fZ2V0UHJvcGVydGllcyA9IF9nZXRQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gX2dldFN0eWxlUHJvcGVydGllcygpIHtcbiAgICByZXR1cm4gZ2V0UHJvcGVydGllc0Zyb21NYXAoY3NzU3ltYm9sUHJvcGVydHlNYXApO1xufVxuZXhwb3J0cy5fZ2V0U3R5bGVQcm9wZXJ0aWVzID0gX2dldFN0eWxlUHJvcGVydGllcztcbnZhciBjc3NWYXJpYWJsZUV4cHJlc3Npb25SZWdleHAgPSAvXFxidmFyXFwoXFxzKigtLVteLFxcc10rPykoPzpcXHMqLFxccyooLispKT9cXHMqXFwpLztcbnZhciBjc3NWYXJpYWJsZUFsbEV4cHJlc3Npb25zUmVnZXhwID0gL1xcYnZhclxcKFxccyooLS1bXixcXHNdKz8pKD86XFxzKixcXHMqKC4rKSk/XFxzKlxcKS9nO1xuZnVuY3Rpb24gaXNDc3NWYXJpYWJsZShwcm9wZXJ0eSkge1xuICAgIHJldHVybiAvXi0tW14sXFxzXSs/JC8udGVzdChwcm9wZXJ0eSk7XG59XG5leHBvcnRzLmlzQ3NzVmFyaWFibGUgPSBpc0Nzc1ZhcmlhYmxlO1xuZnVuY3Rpb24gaXNDc3NDYWxjRXhwcmVzc2lvbih2YWx1ZSkge1xuICAgIHJldHVybiAvXFxiY2FsY1xcKC8udGVzdCh2YWx1ZSk7XG59XG5leHBvcnRzLmlzQ3NzQ2FsY0V4cHJlc3Npb24gPSBpc0Nzc0NhbGNFeHByZXNzaW9uO1xuZnVuY3Rpb24gaXNDc3NWYXJpYWJsZUV4cHJlc3Npb24odmFsdWUpIHtcbiAgICByZXR1cm4gY3NzVmFyaWFibGVFeHByZXNzaW9uUmVnZXhwLnRlc3QodmFsdWUpO1xufVxuZXhwb3J0cy5pc0Nzc1ZhcmlhYmxlRXhwcmVzc2lvbiA9IGlzQ3NzVmFyaWFibGVFeHByZXNzaW9uO1xuZnVuY3Rpb24gX2V2YWx1YXRlQ3NzVmFyaWFibGVFeHByZXNzaW9uKHZpZXcsIGNzc05hbWUsIHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGlmICghaXNDc3NWYXJpYWJsZUV4cHJlc3Npb24odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgdmFyIG91dHB1dCA9IHZhbHVlLnRyaW0oKTtcbiAgICB2YXIgbGFzdFZhbHVlO1xuICAgIHdoaWxlIChsYXN0VmFsdWUgIT09IG91dHB1dCkge1xuICAgICAgICBsYXN0VmFsdWUgPSBvdXRwdXQ7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKGNzc1ZhcmlhYmxlQWxsRXhwcmVzc2lvbnNSZWdleHAsIGZ1bmN0aW9uIChtYXRjaFN0ciwgY3NzVmFyaWFibGVOYW1lLCBmYWxsYmFja1N0cikge1xuICAgICAgICAgICAgdmFyIGNzc1ZhcmlhYmxlVmFsdWUgPSB2aWV3LnN0eWxlLmdldENzc1ZhcmlhYmxlKGNzc1ZhcmlhYmxlTmFtZSk7XG4gICAgICAgICAgICBpZiAoY3NzVmFyaWFibGVWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjc3NWYXJpYWJsZVZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZhbGxiYWNrU3RyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZhbGxiYWNrT3V0cHV0ID0gX2V2YWx1YXRlQ3NzVmFyaWFibGVFeHByZXNzaW9uKHZpZXcsIGNzc05hbWUsIGZhbGxiYWNrU3RyKTtcbiAgICAgICAgICAgICAgICBpZiAoZmFsbGJhY2tPdXRwdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrT3V0cHV0LnNwbGl0KFwiLFwiKVswXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRmFpbGVkIHRvIGdldCB2YWx1ZSBmb3IgY3NzLXZhcmlhYmxlIFxcXCJcIiArIGNzc1ZhcmlhYmxlTmFtZSArIFwiXFxcIiB1c2VkIGluIFxcXCJcIiArIGNzc05hbWUgKyBcIlxcXCI9W1wiICsgdmFsdWUgKyBcIl0gdG8gXCIgKyB2aWV3LCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIFwidW5zZXRcIjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG59XG5leHBvcnRzLl9ldmFsdWF0ZUNzc1ZhcmlhYmxlRXhwcmVzc2lvbiA9IF9ldmFsdWF0ZUNzc1ZhcmlhYmxlRXhwcmVzc2lvbjtcbmZ1bmN0aW9uIF9ldmFsdWF0ZUNzc0NhbGNFeHByZXNzaW9uKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGlmIChpc0Nzc0NhbGNFeHByZXNzaW9uKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gcmVkdWNlQ1NTQ2FsYyh2YWx1ZS5yZXBsYWNlKC8oWzAtOV0rKFxcLlswLTldKyk/KWRpcFxcYi9nLCBcIiQxXCIpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5leHBvcnRzLl9ldmFsdWF0ZUNzc0NhbGNFeHByZXNzaW9uID0gX2V2YWx1YXRlQ3NzQ2FsY0V4cHJlc3Npb247XG5mdW5jdGlvbiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChtYXApIHtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG1hcCkuZm9yRWFjaChmdW5jdGlvbiAoc3ltYm9sKSB7IHJldHVybiBwcm9wcy5wdXNoKG1hcFtzeW1ib2xdKTsgfSk7XG4gICAgcmV0dXJuIHByb3BzO1xufVxudmFyIFByb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZW51bWVyYWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5uYW1lID0gcHJvcGVydHlOYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6Z2V0RGVmYXVsdFwiKTtcbiAgICAgICAgdGhpcy5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpzZXROYXRpdmVcIik7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlID0gc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOm5hdGl2ZURlZmF1bHRWYWx1ZVwiKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWVLZXkgPSBkZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXQgPSBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQ7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdyYXBwZWQgPSBib3hlZFZhbHVlICYmIGJveGVkVmFsdWUud3JhcHBlZDtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBwZWQgPyBvYnNlcnZhYmxlXzEuV3JhcHBlZFZhbHVlLnVud3JhcChib3hlZFZhbHVlKSA6IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlQ29udmVydGVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAod3JhcHBlZCB8fCBjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHRoaXNbZ2V0RGVmYXVsdF0gPyB0aGlzW2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlUmVtb3ZlZChwcm9wZXJ0eU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmF0dHJpYnV0ZU1vZGlmaWVkKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5uYXRpdmVWYWx1ZUNoYW5nZSA9IGZ1bmN0aW9uIChvd25lciwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiBvd25lciA/IG93bmVyW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBvd25lcltrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQob3duZXIsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvd25lci5uYXRpdmVWaWV3UHJvdGVjdGVkICYmICEoZGVmYXVsdFZhbHVlS2V5IGluIG93bmVyKSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lcltkZWZhdWx0VmFsdWVLZXldID0gb3duZXJbZ2V0RGVmYXVsdF0gPyBvd25lcltnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3duZXIuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIubm90aWZ5KHsgb2JqZWN0OiBvd25lciwgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3duZXIuZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5kb21Ob2RlLmF0dHJpYnV0ZU1vZGlmaWVkKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc3ltYm9sUHJvcGVydHlNYXBba2V5XSA9IHRoaXM7XG4gICAgfVxuICAgIFByb3BlcnR5LnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyB0aGlzLm5hbWUgKyBcIiBhbHJlYWR5IHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLm5hbWUsIHRoaXMpO1xuICAgIH07XG4gICAgUHJvcGVydHkucHJvdG90eXBlLmlzU2V0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleSBpbiBpbnN0YW5jZTtcbiAgICB9O1xuICAgIHJldHVybiBQcm9wZXJ0eTtcbn0oKSk7XG5leHBvcnRzLlByb3BlcnR5ID0gUHJvcGVydHk7XG5Qcm9wZXJ0eS5wcm90b3R5cGUuaXNTdHlsZVByb3BlcnR5ID0gZmFsc2U7XG52YXIgQ29lcmNpYmxlUHJvcGVydHkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb2VyY2libGVQcm9wZXJ0eSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2VyY2libGVQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBfdGhpcy5rZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gX3RoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IF90aGlzLnNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IF90aGlzLmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IF90aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGNvZXJjZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpjb2VyY2VLZXlcIik7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgYWZmZWN0c0xheW91dCA9IG9wdGlvbnMuYWZmZWN0c0xheW91dDtcbiAgICAgICAgdmFyIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXI7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIGNvZXJjZUNhbGxiYWNrID0gb3B0aW9ucy5jb2VyY2VWYWx1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gX3RoaXM7XG4gICAgICAgIF90aGlzLmNvZXJjZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbFZhbHVlID0gY29lcmNlS2V5IGluIHRhcmdldCA/IHRhcmdldFtjb2VyY2VLZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdGFyZ2V0W3Byb3BlcnR5TmFtZV0gPSBvcmlnaW5hbFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zZXQgPSBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQ7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tjb2VyY2VLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlZCA9IGJveGVkVmFsdWUgJiYgYm94ZWRWYWx1ZS53cmFwcGVkO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gd3JhcHBlZCA/IG9ic2VydmFibGVfMS5XcmFwcGVkVmFsdWUudW53cmFwKGJveGVkVmFsdWUpIDogYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzW2NvZXJjZUtleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvZXJjZUNhbGxiYWNrKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh3cmFwcGVkIHx8IGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB0aGlzW2dldERlZmF1bHRdID8gdGhpc1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5hdHRyaWJ1dGVSZW1vdmVkKHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlTW9kaWZpZWQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIENvZXJjaWJsZVByb3BlcnR5O1xufShQcm9wZXJ0eSkpO1xuZXhwb3J0cy5Db2VyY2libGVQcm9wZXJ0eSA9IENvZXJjaWJsZVByb3BlcnR5O1xudmFyIEluaGVyaXRlZFByb3BlcnR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW5oZXJpdGVkUHJvcGVydHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5oZXJpdGVkUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB2YXIgbmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdmFyIGtleSA9IF90aGlzLmtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gU3ltYm9sKG5hbWUgKyBcIjp2YWx1ZVNvdXJjZUtleVwiKTtcbiAgICAgICAgX3RoaXMuc291cmNlS2V5ID0gc291cmNlS2V5O1xuICAgICAgICB2YXIgc2V0QmFzZSA9IF90aGlzLnNldDtcbiAgICAgICAgdmFyIHNldEZ1bmMgPSBmdW5jdGlvbiAodmFsdWVTb3VyY2UpIHsgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHVuYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZVNvdXJjZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhhdC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudF8xICYmIHBhcmVudF8xW3NvdXJjZUtleV0gIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdW5ib3hlZFZhbHVlID0gcGFyZW50XzFbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlU291cmNlID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVuYm94ZWRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTb3VyY2UgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHVuYm94ZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlU291cmNlID0gdmFsdWVTb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gdGhhdFtrZXldO1xuICAgICAgICAgICAgc2V0QmFzZS5jYWxsKHRoYXQsIHVuYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGF0W2tleV07XG4gICAgICAgICAgICB0aGF0W3NvdXJjZUtleV0gPSBuZXdWYWx1ZVNvdXJjZTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc2V0XzEgPSBuZXdWYWx1ZVNvdXJjZSA9PT0gMDtcbiAgICAgICAgICAgICAgICB0aGF0LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkVmFsdWVTb3VyY2UgPSBjaGlsZFtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEZ1bmMuY2FsbChjaGlsZCwgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKGNoaWxkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07IH07XG4gICAgICAgIHZhciBzZXRJbmhlcml0ZWRWYWx1ZSA9IHNldEZ1bmMoMSk7XG4gICAgICAgIF90aGlzLnNldEluaGVyaXRlZFZhbHVlID0gc2V0SW5oZXJpdGVkVmFsdWU7XG4gICAgICAgIF90aGlzLnNldCA9IHNldEZ1bmMoMyk7XG4gICAgICAgIGluaGVyaXRhYmxlUHJvcGVydGllcy5wdXNoKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gSW5oZXJpdGVkUHJvcGVydHk7XG59KFByb3BlcnR5KSk7XG5leHBvcnRzLkluaGVyaXRlZFByb3BlcnR5ID0gSW5oZXJpdGVkUHJvcGVydHk7XG52YXIgQ3NzUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENzc1Byb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5uYW1lID0gcHJvcGVydHlOYW1lO1xuICAgICAgICBjc3NQcm9wZXJ0eU5hbWVzLnB1c2gob3B0aW9ucy5jc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jc3NOYW1lID0gXCJjc3M6XCIgKyBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHRoaXMuY3NzTG9jYWxOYW1lID0gb3B0aW9ucy5jc3NOYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjp2YWx1ZVNvdXJjZUtleVwiKTtcbiAgICAgICAgdGhpcy5zb3VyY2VLZXkgPSBzb3VyY2VLZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOmdldERlZmF1bHRcIik7XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdCA9IGdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6c2V0TmF0aXZlXCIpO1xuICAgICAgICB0aGlzLnNldE5hdGl2ZSA9IHNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpuYXRpdmVEZWZhdWx0VmFsdWVcIik7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlS2V5ID0gZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyO1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQ7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHNldExvY2FsVmFsdWUobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc2V0ID0gbmV3VmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSB8fCBuZXdWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW3NvdXJjZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzW3NvdXJjZUtleV0gPSAzO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIikgP1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNvbnZlcnRlcihuZXdWYWx1ZSkgOlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldENzc1ZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSB0aGlzW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPT09IDMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBuZXdWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlIHx8IG5ld1ZhbHVlID09PSBcIlwiO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbc291cmNlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiID9cbiAgICAgICAgICAgICAgICAgICAgdmFsdWVDb252ZXJ0ZXIobmV3VmFsdWUpIDpcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNzc1ZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIHNldDogc2V0Q3NzVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIHNldDogc2V0TG9jYWxWYWx1ZVxuICAgICAgICB9O1xuICAgICAgICBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtrZXldID0gdGhpcztcbiAgICB9XG4gICAgQ3NzUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIHRoaXMubmFtZSArIFwiIGFscmVhZHkgcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMubmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc05hbWUsIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgaWYgKHRoaXMuY3NzTG9jYWxOYW1lICE9PSB0aGlzLmNzc05hbWUpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc0xvY2FsTmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1Byb3BlcnR5LnByb3RvdHlwZS5pc1NldCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXkgaW4gaW5zdGFuY2U7XG4gICAgfTtcbiAgICByZXR1cm4gQ3NzUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5Dc3NQcm9wZXJ0eSA9IENzc1Byb3BlcnR5O1xuQ3NzUHJvcGVydHkucHJvdG90eXBlLmlzU3R5bGVQcm9wZXJ0eSA9IHRydWU7XG52YXIgQ3NzQW5pbWF0aW9uUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENzc0FuaW1hdGlvblByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlciwgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlciwgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQsIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB0aGlzLm5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIGNzc1Byb3BlcnR5TmFtZXMucHVzaChvcHRpb25zLmNzc05hbWUpO1xuICAgICAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV0gPSB0aGlzO1xuICAgICAgICBpZiAob3B0aW9ucy5jc3NOYW1lICYmIG9wdGlvbnMuY3NzTmFtZSAhPT0gcHJvcGVydHlOYW1lKSB7XG4gICAgICAgICAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzW29wdGlvbnMuY3NzTmFtZV0gPSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3ZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIGNzc0xvY2FsTmFtZSA9IChvcHRpb25zLmNzc05hbWUgfHwgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgdGhpcy5jc3NMb2NhbE5hbWUgPSBjc3NMb2NhbE5hbWU7XG4gICAgICAgIHZhciBjc3NOYW1lID0gXCJjc3M6XCIgKyBjc3NMb2NhbE5hbWU7XG4gICAgICAgIHRoaXMuY3NzTmFtZSA9IGNzc05hbWU7XG4gICAgICAgIHZhciBrZXlmcmFtZU5hbWUgPSBcImtleWZyYW1lOlwiICsgcHJvcGVydHlOYW1lO1xuICAgICAgICB0aGlzLmtleWZyYW1lID0ga2V5ZnJhbWVOYW1lO1xuICAgICAgICB2YXIgZGVmYXVsdE5hbWUgPSBcImRlZmF1bHQ6XCIgKyBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBTeW1ib2woZGVmYXVsdE5hbWUpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZUtleSA9IGRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBjc3NWYWx1ZSA9IFN5bWJvbChjc3NOYW1lKTtcbiAgICAgICAgdmFyIHN0eWxlVmFsdWUgPSBTeW1ib2woXCJsb2NhbDpcIiArIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHZhciBrZXlmcmFtZVZhbHVlID0gU3ltYm9sKGtleWZyYW1lTmFtZSk7XG4gICAgICAgIHZhciBjb21wdXRlZFZhbHVlID0gU3ltYm9sKFwiY29tcHV0ZWQtdmFsdWU6XCIgKyBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICB0aGlzLmtleSA9IGNvbXB1dGVkVmFsdWU7XG4gICAgICAgIHZhciBjb21wdXRlZFNvdXJjZSA9IFN5bWJvbChcImNvbXB1dGVkLXNvdXJjZTpcIiArIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHRoaXMuc291cmNlID0gY29tcHV0ZWRTb3VyY2U7XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdCA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpnZXREZWZhdWx0XCIpO1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHRoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IHRoaXMuc2V0TmF0aXZlID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnNldE5hdGl2ZVwiKTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGRlc2NyaXB0b3Ioc3ltYm9sLCBwcm9wZXJ0eVNvdXJjZSwgZW51bWVyYWJsZSwgY29uZmlndXJhYmxlLCBnZXRzQ29tcHV0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZW51bWVyYWJsZSwgY29uZmlndXJhYmxlOiBjb25maWd1cmFibGUsXG4gICAgICAgICAgICAgICAgZ2V0OiBnZXRzQ29tcHV0ZWQgPyBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzW2NvbXB1dGVkVmFsdWVdOyB9IDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpc1tzeW1ib2xdOyB9LFxuICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJveGVkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShib3hlZFZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0gdGhpc1tjb21wdXRlZFZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFNvdXJjZSA9IHRoaXNbY29tcHV0ZWRTb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2FzU2V0ID0gb2xkU291cmNlICE9PSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgYm94ZWRWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3N5bWJvbF0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tjb21wdXRlZFNvdXJjZV0gPT09IHByb3BlcnR5U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc3R5bGVWYWx1ZV0gIT09IGV4cG9ydHMudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkU291cmNlXSA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRWYWx1ZV0gPSB0aGlzW3N0eWxlVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzW2Nzc1ZhbHVlXSAhPT0gZXhwb3J0cy51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRTb3VyY2VdID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFZhbHVlXSA9IHRoaXNbY3NzVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbY29tcHV0ZWRTb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tjb21wdXRlZFZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIGJveGVkVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3hlZFZhbHVlID0gdmFsdWVDb252ZXJ0ZXIoYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3N5bWJvbF0gPSBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbY29tcHV0ZWRTb3VyY2VdIDw9IHByb3BlcnR5U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFNvdXJjZV0gPSBwcm9wZXJ0eVNvdXJjZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkVmFsdWVdID0gYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzW2NvbXB1dGVkVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gdGhpc1tjb21wdXRlZFNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc1NldCA9IHNvdXJjZSAhPT0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXB1dGVkVmFsdWVDaGFuZ2VkID0gb2xkVmFsdWUgIT09IHZhbHVlICYmICghZXF1YWxpdHlDb21wYXJlciB8fCAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXB1dGVkVmFsdWVDaGFuZ2VkICYmIHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSAmJiAoY29tcHV0ZWRWYWx1ZUNoYW5nZWQgfHwgaXNTZXQgIT09IHdhc1NldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghd2FzU2V0ICYmICEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdhc1NldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXB1dGVkVmFsdWVDaGFuZ2VkICYmIHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmYXVsdFByb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3IoZGVmYXVsdFZhbHVlS2V5LCAwLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgdmFyIGNzc1Byb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3IoY3NzVmFsdWUsIDIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICB2YXIgc3R5bGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKHN0eWxlVmFsdWUsIDMsIHRydWUsIHRydWUsIHRydWUpO1xuICAgICAgICB2YXIga2V5ZnJhbWVQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKGtleWZyYW1lVmFsdWUsIDQsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICBzeW1ib2xQcm9wZXJ0eU1hcFtjb21wdXRlZFZhbHVlXSA9IHRoaXM7XG4gICAgICAgIGNzc1N5bWJvbFByb3BlcnR5TWFwW2NvbXB1dGVkVmFsdWVdID0gdGhpcztcbiAgICAgICAgdGhpcy5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY29tcHV0ZWRWYWx1ZV0gPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY29tcHV0ZWRTb3VyY2VdID0gMDtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY3NzVmFsdWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtzdHlsZVZhbHVlXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVba2V5ZnJhbWVWYWx1ZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgZGVmYXVsdE5hbWUsIGRlZmF1bHRQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIGNzc05hbWUsIGNzc1Byb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgcHJvcGVydHlOYW1lLCBzdHlsZVByb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jc3NOYW1lICYmIG9wdGlvbnMuY3NzTmFtZSAhPT0gb3B0aW9ucy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIG9wdGlvbnMuY3NzTmFtZSwgc3R5bGVQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIGtleWZyYW1lTmFtZSwga2V5ZnJhbWVQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm90b3R5cGUuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIl9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IHRoaXMuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGFyZ2V0KSkge1xuICAgICAgICAgICAgdmFyIGdldERlZmF1bHQgPSB0aGlzLmdldERlZmF1bHQ7XG4gICAgICAgICAgICB0YXJnZXRbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkuX2dldEJ5Q3NzTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXNbbmFtZV07XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5fZ2V0UHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKENzc0FuaW1hdGlvblByb3BlcnR5LnByb3BlcnRpZXMpO1xuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvdG90eXBlLmlzU2V0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZVt0aGlzLnNvdXJjZV0gIT09IDA7XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzID0ge307XG4gICAgcmV0dXJuIENzc0FuaW1hdGlvblByb3BlcnR5O1xufSgpKTtcbmV4cG9ydHMuQ3NzQW5pbWF0aW9uUHJvcGVydHkgPSBDc3NBbmltYXRpb25Qcm9wZXJ0eTtcbkNzc0FuaW1hdGlvblByb3BlcnR5LnByb3RvdHlwZS5pc1N0eWxlUHJvcGVydHkgPSB0cnVlO1xudmFyIEluaGVyaXRlZENzc1Byb3BlcnR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW5oZXJpdGVkQ3NzUHJvcGVydHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5oZXJpdGVkQ3NzUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gX3RoaXMua2V5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gX3RoaXMuc291cmNlS2V5O1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IF90aGlzLmdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBfdGhpcy5zZXROYXRpdmU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBfdGhpcy5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBhZmZlY3RzTGF5b3V0ID0gb3B0aW9ucy5hZmZlY3RzTGF5b3V0O1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkO1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBfdGhpcztcbiAgICAgICAgdmFyIHNldEZ1bmMgPSBmdW5jdGlvbiAodmFsdWVTb3VyY2UpIHsgcmV0dXJuIGZ1bmN0aW9uIChib3hlZFZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoYm94ZWRWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgYm94ZWRWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSB0aGlzW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVNvdXJjZSA9PT0gMiAmJiBjdXJyZW50VmFsdWVTb3VyY2UgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPiB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICB2YXIgdW5zZXROYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8yID0gdmlldy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gcGFyZW50XzIgPyBwYXJlbnRfMi5zdHlsZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlICYmIHN0eWxlW3NvdXJjZUtleV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc3R5bGVbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gMTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbc291cmNlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgdW5zZXROYXRpdmVWYWx1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gdmFsdWVTb3VyY2U7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBib3hlZFZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIoYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bnNldE5hdGl2ZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkVmFsdWVTb3VyY2UgPSBjaGlsZFN0eWxlW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldERlZmF1bHRGdW5jLmNhbGwoY2hpbGRTdHlsZSwgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmhlcml0ZWRGdW5jLmNhbGwoY2hpbGRTdHlsZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9OyB9O1xuICAgICAgICB2YXIgc2V0RGVmYXVsdEZ1bmMgPSBzZXRGdW5jKDApO1xuICAgICAgICB2YXIgc2V0SW5oZXJpdGVkRnVuYyA9IHNldEZ1bmMoMSk7XG4gICAgICAgIF90aGlzLnNldEluaGVyaXRlZFZhbHVlID0gc2V0SW5oZXJpdGVkRnVuYztcbiAgICAgICAgX3RoaXMuY3NzVmFsdWVEZXNjcmlwdG9yLnNldCA9IHNldEZ1bmMoMik7XG4gICAgICAgIF90aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yLnNldCA9IHNldEZ1bmMoMyk7XG4gICAgICAgIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllcy5wdXNoKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gSW5oZXJpdGVkQ3NzUHJvcGVydHk7XG59KENzc1Byb3BlcnR5KSk7XG5leHBvcnRzLkluaGVyaXRlZENzc1Byb3BlcnR5ID0gSW5oZXJpdGVkQ3NzUHJvcGVydHk7XG52YXIgU2hvcnRoYW5kUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNob3J0aGFuZFByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHRoaXMubmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdGhpcy5jc3NOYW1lID0gXCJjc3M6XCIgKyBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHRoaXMuY3NzTG9jYWxOYW1lID0gXCJcIiArIG9wdGlvbnMuY3NzTmFtZTtcbiAgICAgICAgdmFyIGNvbnZlcnRlciA9IG9wdGlvbnMuY29udmVydGVyO1xuICAgICAgICBmdW5jdGlvbiBzZXRMb2NhbFZhbHVlKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwic2V0TG9jYWxWYWx1ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udmVydGVyKHZhbHVlKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBwID0gX2JbMF0sIHYgPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcC5uYW1lXSA9IHY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2V0Q3NzVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJzZXRDc3NWYWx1ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udmVydGVyKHZhbHVlKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBwID0gX2JbMF0sIHYgPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcC5jc3NOYW1lXSA9IHY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBvcHRpb25zLmdldHRlcixcbiAgICAgICAgICAgIHNldDogc2V0Q3NzVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IG9wdGlvbnMuZ2V0dGVyLFxuICAgICAgICAgICAgc2V0OiBzZXRMb2NhbFZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvcGVydHlCYWdEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgY29udmVydGVyKHZhbHVlKS5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcHJvcGVydHkuY3NzTG9jYWxOYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtrZXldID0gdGhpcztcbiAgICB9XG4gICAgU2hvcnRoYW5kUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIHRoaXMubmFtZSArIFwiIGFscmVhZHkgcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMubmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc05hbWUsIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgaWYgKHRoaXMuY3NzTG9jYWxOYW1lICE9PSB0aGlzLmNzc05hbWUpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc0xvY2FsTmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUuUHJvcGVydHlCYWcsIHRoaXMuY3NzTG9jYWxOYW1lLCB0aGlzLnByb3BlcnR5QmFnRGVzY3JpcHRvcik7XG4gICAgfTtcbiAgICByZXR1cm4gU2hvcnRoYW5kUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5TaG9ydGhhbmRQcm9wZXJ0eSA9IFNob3J0aGFuZFByb3BlcnR5O1xuZnVuY3Rpb24gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc09uKHZpZXcpIHtcbiAgICB2YXIgYXJyYXkgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlUHJvcGVydGllc18xID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzOyBfaSA8IGluaGVyaXRhYmxlUHJvcGVydGllc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlUHJvcGVydGllc18xW19pXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICB2YXIgdmFsdWVTb3VyY2UgPSB2aWV3W3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKHZhbHVlU291cmNlICE9PSAwKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKHsgcHJvcGVydHk6IHByb3AsIHZhbHVlOiB2aWV3W3Byb3AubmFtZV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc09uKHN0eWxlKSB7XG4gICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMSA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllczsgX2kgPCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMVtfaV07XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIHZhbHVlU291cmNlID0gc3R5bGVbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICBpZiAodmFsdWVTb3VyY2UgIT09IDApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2goeyBwcm9wZXJ0eTogcHJvcCwgdmFsdWU6IHN0eWxlW3Byb3AubmFtZV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZXhwb3J0cy5pbml0TmF0aXZlVmlldyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwicHJvcGVydGllc1xcXCIuaW5pdE5hdGl2ZVZpZXdcIiwgZnVuY3Rpb24gaW5pdE5hdGl2ZVZpZXcodmlldykge1xuICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgIGFwcGx5UGVuZGluZ05hdGl2ZVNldHRlcnModmlldyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhcHBseUFsbE5hdGl2ZVNldHRlcnModmlldyk7XG4gICAgfVxuICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMgPSB7fTtcbn0pO1xuZnVuY3Rpb24gYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycyh2aWV3KSB7XG4gICAgdmFyIHN1c3BlbmRlZFVwZGF0ZXMgPSB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzO1xuICAgIGZvciAodmFyIHByb3BlcnR5TmFtZSBpbiBzdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IHByb3BlcnR5LnNldE5hdGl2ZTtcbiAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgdmFyIGdldERlZmF1bHQgPSBwcm9wZXJ0eS5nZXREZWZhdWx0LCBpc1N0eWxlUHJvcGVydHkgPSBwcm9wZXJ0eS5pc1N0eWxlUHJvcGVydHksIGRlZmF1bHRWYWx1ZUtleSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleSwgZGVmYXVsdFZhbHVlID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGlzU3R5bGVQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LmlzU2V0KHZpZXcuc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiBzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmlldy5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHlsZVtkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5pc1NldCh2aWV3KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2aWV3W3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZpZXdbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5hcHBseVBlbmRpbmdOYXRpdmVTZXR0ZXJzID0gYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycztcbmZ1bmN0aW9uIGFwcGx5QWxsTmF0aXZlU2V0dGVycyh2aWV3KSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc18yID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzJbX2ldO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2V0TmF0aXZlID0gcHJvcGVydHkuc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHByb3BlcnR5LmdldERlZmF1bHQ7XG4gICAgICAgIGlmIChzZXROYXRpdmUgaW4gdmlldykge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB2aWV3KSkge1xuICAgICAgICAgICAgICAgIHZpZXdbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBwcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB2aWV3W3N5bWJvbF07XG4gICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc3R5bGUpO1xuICAgIGZvciAodmFyIF9hID0gMCwgc3ltYm9sc18zID0gc3ltYm9sczsgX2EgPCBzeW1ib2xzXzMubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzNbX2FdO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHN0eWxlKSkge1xuICAgICAgICAgICAgICAgIHN0eWxlW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W3Byb3BlcnR5LmdldERlZmF1bHRdID8gdmlld1twcm9wZXJ0eS5nZXREZWZhdWx0XSgpIDogcHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gc3R5bGVbc3ltYm9sXTtcbiAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmFwcGx5QWxsTmF0aXZlU2V0dGVycyA9IGFwcGx5QWxsTmF0aXZlU2V0dGVycztcbmZ1bmN0aW9uIHJlc2V0TmF0aXZlVmlldyh2aWV3KSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc180ID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzQubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzRbX2ldO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5IGluIHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0odmlld1twcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdmlld1twcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5LmRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzdHlsZSk7XG4gICAgZm9yICh2YXIgX2EgPSAwLCBzeW1ib2xzXzUgPSBzeW1ib2xzOyBfYSA8IHN5bWJvbHNfNS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfNVtfYV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IGNzc1N5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXkgaW4gc3R5bGUpIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0oc3R5bGVbcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHN0eWxlW3Byb3BlcnR5LmRlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHkuZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucmVzZXROYXRpdmVWaWV3ID0gcmVzZXROYXRpdmVWaWV3O1xuZnVuY3Rpb24gY2xlYXJJbmhlcml0ZWRQcm9wZXJ0aWVzKHZpZXcpIHtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlUHJvcGVydGllc18yID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzOyBfaSA8IGluaGVyaXRhYmxlUHJvcGVydGllc18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlUHJvcGVydGllc18yW19pXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICBpZiAodmlld1tzb3VyY2VLZXldID09PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldC5jYWxsKHZpZXcsIGV4cG9ydHMudW5zZXRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBmb3IgKHZhciBfYSA9IDAsIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzOyBfYSA8IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yLmxlbmd0aDsgX2ErKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yW19hXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICBpZiAoc3R5bGVbc291cmNlS2V5XSA9PT0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKHN0eWxlLCBleHBvcnRzLnVuc2V0VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhckluaGVyaXRlZFByb3BlcnRpZXMgPSBjbGVhckluaGVyaXRlZFByb3BlcnRpZXM7XG5mdW5jdGlvbiByZXNldENTU1Byb3BlcnRpZXMoc3R5bGUpIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc3R5bGUpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc182ID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzYubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzZbX2ldO1xuICAgICAgICB2YXIgY3NzUHJvcGVydHkgPSB2b2lkIDA7XG4gICAgICAgIGlmIChjc3NQcm9wZXJ0eSA9IGNzc1N5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF0pIHtcbiAgICAgICAgICAgIHN0eWxlW2Nzc1Byb3BlcnR5LmNzc05hbWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgaWYgKGNzc1Byb3BlcnR5IGluc3RhbmNlb2YgQ3NzQW5pbWF0aW9uUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICBzdHlsZVtjc3NQcm9wZXJ0eS5rZXlmcmFtZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlc2V0Q1NTUHJvcGVydGllcyA9IHJlc2V0Q1NTUHJvcGVydGllcztcbmZ1bmN0aW9uIHByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcyh2aWV3LCBjaGlsZCkge1xuICAgIHZhciBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc09uKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc18xID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlczsgX2kgPCBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwYWlyID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBwYWlyLnByb3BlcnR5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSBjaGlsZFtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPD0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKGNoaWxkLCBwYWlyLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzID0gcHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gcHJvcGFnYXRlSW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzKHBhcmVudFN0eWxlLCBjaGlsZFN0eWxlKSB7XG4gICAgdmFyIGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXMgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzT24ocGFyZW50U3R5bGUpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc18xID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlczsgX2kgPCBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwYWlyID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBwYWlyLnByb3BlcnR5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSBjaGlsZFN0eWxlW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVNvdXJjZSA8PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldEluaGVyaXRlZFZhbHVlLmNhbGwoY2hpbGRTdHlsZSwgcGFpci52YWx1ZSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcyA9IHByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcztcbmZ1bmN0aW9uIG1ha2VWYWxpZGF0b3IoKSB7XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhbHVlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgc2V0ID0gbmV3IFNldCh2YWx1ZXMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHNldC5oYXModmFsdWUpOyB9O1xufVxuZXhwb3J0cy5tYWtlVmFsaWRhdG9yID0gbWFrZVZhbGlkYXRvcjtcbmZ1bmN0aW9uIG1ha2VQYXJzZXIoaXNWYWxpZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGxvd2VyID0gdmFsdWUgJiYgdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGlzVmFsaWQobG93ZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gbG93ZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5leHBvcnRzLm1ha2VQYXJzZXIgPSBtYWtlUGFyc2VyO1xuZnVuY3Rpb24gZ2V0U2V0UHJvcGVydGllcyh2aWV3KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHZpZXcpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3AsIHZpZXdbcHJvcF1dKTtcbiAgICB9KTtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModmlldyk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzcgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfNy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfN1tfaV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IHZpZXdbcHJvcGVydHkua2V5XTtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3BlcnR5Lm5hbWUsIHZhbHVlXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldFNldFByb3BlcnRpZXMgPSBnZXRTZXRQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gZ2V0Q29tcHV0ZWRDc3NWYWx1ZXModmlldykge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgIGZvciAodmFyIF9pID0gMCwgY3NzUHJvcGVydHlOYW1lc18xID0gY3NzUHJvcGVydHlOYW1lczsgX2kgPCBjc3NQcm9wZXJ0eU5hbWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gY3NzUHJvcGVydHlOYW1lc18xW19pXTtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3AsIHN0eWxlW3Byb3BdXSk7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKFtcInRvcFwiLCBcImF1dG9cIl0pO1xuICAgIHJlc3VsdC5wdXNoKFtcImxlZnRcIiwgXCJhdXRvXCJdKTtcbiAgICByZXN1bHQucHVzaChbXCJib3R0b21cIiwgXCJhdXRvXCJdKTtcbiAgICByZXN1bHQucHVzaChbXCJyaWdodFwiLCBcImF1dG9cIl0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldENvbXB1dGVkQ3NzVmFsdWVzID0gZ2V0Q29tcHV0ZWRDc3NWYWx1ZXM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9wZXJ0aWVzLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3Byb3BlcnRpZXNcIik7XG52YXIgc3lzdGVtX2NsYXNzZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jc3Mvc3lzdGVtLWNsYXNzZXNcIik7XG52YXIgZGVidWdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy9kZWJ1Z1wiKTtcbnZhciBiaW5kYWJsZV8xID0gcmVxdWlyZShcIi4uL2JpbmRhYmxlXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcGxhdGZvcm1cIik7XG5leHBvcnRzLmlzSU9TID0gcGxhdGZvcm1fMS5pc0lPUztcbmV4cG9ydHMuaXNBbmRyb2lkID0gcGxhdGZvcm1fMS5pc0FuZHJvaWQ7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMubGF5b3V0ID0gdXRpbHNfMS5sYXlvdXQ7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NvbG9yXCIpO1xuZXhwb3J0cy5Db2xvciA9IGNvbG9yXzEuQ29sb3I7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2JpbmRhYmxlXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9wcm9wZXJ0aWVzXCIpKTtcbnZhciBzc20gPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1zY29wZVwiKTtcbnZhciBkb21Ob2RlTW9kdWxlO1xuZnVuY3Rpb24gZW5zdXJlZG9tTm9kZU1vZHVsZSgpIHtcbiAgICBpZiAoIWRvbU5vZGVNb2R1bGUpIHtcbiAgICAgICAgZG9tTm9kZU1vZHVsZSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9kZWJ1Z2dlci9kb20tbm9kZVwiKTtcbiAgICB9XG59XG52YXIgc3R5bGVTY29wZU1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZVN0eWxlU2NvcGVNb2R1bGUoKSB7XG4gICAgaWYgKCFzdHlsZVNjb3BlTW9kdWxlKSB7XG4gICAgICAgIHN0eWxlU2NvcGVNb2R1bGUgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1zY29wZVwiKTtcbiAgICB9XG59XG52YXIgZGVmYXVsdEJpbmRpbmdTb3VyY2UgPSB7fTtcbmZ1bmN0aW9uIGdldEFuY2VzdG9yKHZpZXcsIGNyaXRlcmlvbikge1xuICAgIHZhciBtYXRjaGVyID0gbnVsbDtcbiAgICBpZiAodHlwZW9mIGNyaXRlcmlvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtYXRjaGVyID0gZnVuY3Rpb24gKHZpZXcpIHsgcmV0dXJuIHZpZXcudHlwZU5hbWUgPT09IGNyaXRlcmlvbjsgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG1hdGNoZXIgPSBmdW5jdGlvbiAodmlldykgeyByZXR1cm4gdmlldyBpbnN0YW5jZW9mIGNyaXRlcmlvbjsgfTtcbiAgICB9XG4gICAgZm9yICh2YXIgcGFyZW50XzEgPSB2aWV3LnBhcmVudDsgcGFyZW50XzEgIT0gbnVsbDsgcGFyZW50XzEgPSBwYXJlbnRfMS5wYXJlbnQpIHtcbiAgICAgICAgaWYgKG1hdGNoZXIocGFyZW50XzEpKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50XzE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLmdldEFuY2VzdG9yID0gZ2V0QW5jZXN0b3I7XG5mdW5jdGlvbiBnZXRWaWV3QnlJZCh2aWV3LCBpZCkge1xuICAgIGlmICghdmlldykge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodmlldy5pZCA9PT0gaWQpIHtcbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfVxuICAgIHZhciByZXRWYWw7XG4gICAgdmFyIGRlc2NlbmRhbnRzQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgaWYgKGNoaWxkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgcmV0VmFsID0gY2hpbGQ7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBlYWNoRGVzY2VuZGFudCh2aWV3LCBkZXNjZW5kYW50c0NhbGxiYWNrKTtcbiAgICByZXR1cm4gcmV0VmFsO1xufVxuZXhwb3J0cy5nZXRWaWV3QnlJZCA9IGdldFZpZXdCeUlkO1xuZnVuY3Rpb24gZWFjaERlc2NlbmRhbnQodmlldywgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNhbGxiYWNrIHx8ICF2aWV3KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGNvbnRpbnVlSXRlcmF0aW9uO1xuICAgIHZhciBsb2NhbENhbGxiYWNrID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGNvbnRpbnVlSXRlcmF0aW9uID0gY2FsbGJhY2soY2hpbGQpO1xuICAgICAgICBpZiAoY29udGludWVJdGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNoaWxkLmVhY2hDaGlsZChsb2NhbENhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGludWVJdGVyYXRpb247XG4gICAgfTtcbiAgICB2aWV3LmVhY2hDaGlsZChsb2NhbENhbGxiYWNrKTtcbn1cbmV4cG9ydHMuZWFjaERlc2NlbmRhbnQgPSBlYWNoRGVzY2VuZGFudDtcbnZhciB2aWV3SWRDb3VudGVyID0gMTtcbnZhciBGbGFncztcbihmdW5jdGlvbiAoRmxhZ3MpIHtcbiAgICBGbGFnc1tcInN1cGVyT25Mb2FkZWRDYWxsZWRcIl0gPSBcIkxvYWRlZFwiO1xuICAgIEZsYWdzW1wic3VwZXJPblVubG9hZGVkQ2FsbGVkXCJdID0gXCJVbmxvYWRlZFwiO1xufSkoRmxhZ3MgfHwgKEZsYWdzID0ge30pKTtcbnZhciBTdXNwZW5kVHlwZTtcbihmdW5jdGlvbiAoU3VzcGVuZFR5cGUpIHtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIkluY3JlbWVudGFsXCJdID0gMF0gPSBcIkluY3JlbWVudGFsXCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJMb2FkZWRcIl0gPSAxMDQ4NTc2XSA9IFwiTG9hZGVkXCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJOYXRpdmVWaWV3XCJdID0gMjA5NzE1Ml0gPSBcIk5hdGl2ZVZpZXdcIjtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIlVJU2V0dXBcIl0gPSA0MTk0MzA0XSA9IFwiVUlTZXR1cFwiO1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiSW5jcmVtZW50YWxDb3VudE1hc2tcIl0gPSAtNzM0MDAzM10gPSBcIkluY3JlbWVudGFsQ291bnRNYXNrXCI7XG59KShTdXNwZW5kVHlwZSB8fCAoU3VzcGVuZFR5cGUgPSB7fSkpO1xuKGZ1bmN0aW9uIChTdXNwZW5kVHlwZSkge1xuICAgIGZ1bmN0aW9uIHRvU3RyaW5nKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuICh0eXBlID8gXCJzdXNwZW5kZWRcIiA6IFwicmVzdW1lZFwiKSArIFwiKFwiICtcbiAgICAgICAgICAgIFwiSW5jcmVtZW50YWw6IFwiICsgKHR5cGUgJiBTdXNwZW5kVHlwZS5JbmNyZW1lbnRhbENvdW50TWFzaykgKyBcIiwgXCIgK1xuICAgICAgICAgICAgXCJMb2FkZWQ6IFwiICsgISh0eXBlICYgU3VzcGVuZFR5cGUuTG9hZGVkKSArIFwiLCBcIiArXG4gICAgICAgICAgICBcIk5hdGl2ZVZpZXc6IFwiICsgISh0eXBlICYgU3VzcGVuZFR5cGUuTmF0aXZlVmlldykgKyBcIiwgXCIgK1xuICAgICAgICAgICAgXCJVSVNldHVwOiBcIiArICEodHlwZSAmIFN1c3BlbmRUeXBlLlVJU2V0dXApICtcbiAgICAgICAgICAgIFwiKVwiO1xuICAgIH1cbiAgICBTdXNwZW5kVHlwZS50b1N0cmluZyA9IHRvU3RyaW5nO1xufSkoU3VzcGVuZFR5cGUgfHwgKFN1c3BlbmRUeXBlID0ge30pKTtcbnZhciBWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZpZXdCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fb25Mb2FkZWRDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX29uVW5sb2FkZWRDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2Nzc1N0YXRlID0gbmV3IHNzbS5Dc3NTdGF0ZShuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICBfdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXMgPSB7XG4gICAgICAgICAgICBcImhpZ2hsaWdodGVkXCI6IFtcbiAgICAgICAgICAgICAgICBcImFjdGl2ZVwiLFxuICAgICAgICAgICAgICAgIFwicHJlc3NlZFwiXG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNzc0NsYXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIF90aGlzLmNzc1BzZXVkb0NsYXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIF90aGlzLl9kb21JZCA9IHZpZXdJZENvdW50ZXIrKztcbiAgICAgICAgX3RoaXMuX3N0eWxlID0gbmV3IHByb3BlcnRpZXNfMS5TdHlsZShuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwicGFyZW50Tm9kZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlUGFyZW50IHx8IHRoaXMucGFyZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVBhcmVudCA9IG5vZGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwibmF0aXZlVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyh2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwidHlwZU5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlcy5nZXRDbGFzcyh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJzdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChpbmxpbmVTdHlsZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbmxpbmVTdHlsZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0SW5saW5lU3R5bGUoaW5saW5lU3R5bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlldy5zdHlsZSBwcm9wZXJ0eSBpcyByZWFkLW9ubHkuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3NWaWV3O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImlzTG9hZGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNMb2FkZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwiY2xhc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNsYXNzTmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB2O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZ2V0Vmlld0J5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIGdldFZpZXdCeUlkKHRoaXMsIGlkKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwicGFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnBhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmVuc3VyZURvbU5vZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICBlbnN1cmVkb21Ob2RlTW9kdWxlKCk7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUgPSBuZXcgZG9tTm9kZU1vZHVsZS5ET01Ob2RlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXNbbmFtZV0gPSBiaW5kYWJsZV8xLldyYXBwZWRWYWx1ZS51bndyYXAodmFsdWUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldEZsYWcoRmxhZ3Muc3VwZXJPbkxvYWRlZENhbGxlZCwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY3NzU3RhdGUub25Mb2FkZWQoKTtcbiAgICAgICAgdGhpcy5fcmVzdW1lTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5Mb2FkZWQpO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIF90aGlzLmxvYWRWaWV3KGNoaWxkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZW1pdChcImxvYWRlZFwiKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldEZsYWcoRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkLCB0cnVlKTtcbiAgICAgICAgaWYgKCF0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkxvYWRlZCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgX3RoaXMudW5sb2FkVmlldyhjaGlsZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2lzTG9hZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2Nzc1N0YXRlLm9uVW5sb2FkZWQoKTtcbiAgICAgICAgdGhpcy5fZW1pdChcInVubG9hZGVkXCIpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ID0gdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCB8IHR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50Kys7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVzdW1lTmF0aXZlVXBkYXRlcyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ID0gdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCAmIH50eXBlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ICYgU3VzcGVuZFR5cGUuSW5jcmVtZW50YWxDb3VudE1hc2spID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBjYWxsIHRvIFwiICsgdGhpcyArIFwiLl9yZXN1bWVOYXRpdmVVcGRhdGVzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudC0tO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5vblJlc3VtZU5hdGl2ZVVwZGF0ZXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9iYXRjaFVwZGF0ZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuSW5jcmVtZW50YWwpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkluY3JlbWVudGFsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNldEZsYWcgPSBmdW5jdGlvbiAoZmxhZywgdmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChmbGFnKSB7XG4gICAgICAgICAgICBjYXNlIEZsYWdzLnN1cGVyT25Mb2FkZWRDYWxsZWQ6XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Mb2FkZWRDYWxsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHRoaXMuX29uVW5sb2FkZWRDYWxsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmlzRmxhZ1NldCA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICAgIHN3aXRjaCAoZmxhZykge1xuICAgICAgICAgICAgY2FzZSBGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkxvYWRlZENhbGxlZDtcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblVubG9hZGVkQ2FsbGVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY2FsbEZ1bmN0aW9uV2l0aFN1cGVyID0gZnVuY3Rpb24gKGZsYWcsIGZ1bmMpIHtcbiAgICAgICAgdGhpcy5zZXRGbGFnKGZsYWcsIGZhbHNlKTtcbiAgICAgICAgZnVuYygpO1xuICAgICAgICBpZiAoIXRoaXMuaXNGbGFnU2V0KGZsYWcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdXBlci5cIiArIGZsYWcgKyBcIiBub3QgY2FsbGVkIGluIFwiICsgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jYWxsTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbGxGdW5jdGlvbldpdGhTdXBlcihGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vbkxvYWRlZCgpOyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jYWxsVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY2FsbEZ1bmN0aW9uV2l0aFN1cGVyKEZsYWdzLnN1cGVyT25VbmxvYWRlZENhbGxlZCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMub25VbmxvYWRlZCgpOyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5ub3RpZnlQc2V1ZG9DbGFzc0NoYW5nZWQgPSBmdW5jdGlvbiAocHNldWRvQ2xhc3MpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IFwiOlwiICsgcHNldWRvQ2xhc3MsIG9iamVjdDogdGhpcyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5nZXRBbGxBbGlhc2VkU3RhdGVzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGFsbFN0YXRlcyA9IFtdO1xuICAgICAgICBhbGxTdGF0ZXMucHVzaChuYW1lKTtcbiAgICAgICAgaWYgKG5hbWUgaW4gdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXNbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhbGxTdGF0ZXMucHVzaCh0aGlzLnBzZXVkb0NsYXNzQWxpYXNlc1tuYW1lXVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsbFN0YXRlcztcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5hZGRQc2V1ZG9DbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBhbGxTdGF0ZXMgPSB0aGlzLmdldEFsbEFsaWFzZWRTdGF0ZXMobmFtZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsU3RhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5oYXMoYWxsU3RhdGVzW2ldKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5hZGQoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVBzZXVkb0NsYXNzQ2hhbmdlZChhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZGVsZXRlUHNldWRvQ2xhc3MgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgYWxsU3RhdGVzID0gdGhpcy5nZXRBbGxBbGlhc2VkU3RhdGVzKG5hbWUpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbFN0YXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5oYXMoYWxsU3RhdGVzW2ldKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5kZWxldGUoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVBzZXVkb0NsYXNzQ2hhbmdlZChhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuYmluZGluZ0NvbnRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5iaW5kaW5ncy5nZXQoXCJiaW5kaW5nQ29udGV4dFwiKS5iaW5kKGRhdGEudmFsdWUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAob3B0aW9ucywgc291cmNlKSB7XG4gICAgICAgIGlmIChzb3VyY2UgPT09IHZvaWQgMCkgeyBzb3VyY2UgPSBkZWZhdWx0QmluZGluZ1NvdXJjZTsgfVxuICAgICAgICB2YXIgdGFyZ2V0UHJvcGVydHkgPSBvcHRpb25zLnRhcmdldFByb3BlcnR5O1xuICAgICAgICB0aGlzLnVuYmluZCh0YXJnZXRQcm9wZXJ0eSk7XG4gICAgICAgIGlmICghdGhpcy5iaW5kaW5ncykge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5ncyA9IG5ldyBNYXAoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmluZGluZyA9IG5ldyBiaW5kYWJsZV8xLkJpbmRpbmcodGhpcywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYmluZGluZ3Muc2V0KHRhcmdldFByb3BlcnR5LCBiaW5kaW5nKTtcbiAgICAgICAgdmFyIGJpbmRpbmdTb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIGlmIChiaW5kaW5nU291cmNlID09PSBkZWZhdWx0QmluZGluZ1NvdXJjZSkge1xuICAgICAgICAgICAgYmluZGluZ1NvdXJjZSA9IHRoaXMuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICBiaW5kaW5nLnNvdXJjZUlzQmluZGluZ0NvbnRleHQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRhcmdldFByb3BlcnR5ID09PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8yID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudF8yKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudF8yLm9uKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG91bGRBZGRIYW5kbGVyVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBiaW5kaW5nLmJpbmQoYmluZGluZ1NvdXJjZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgIHZhciBiaW5kaW5ncyA9IHRoaXMuYmluZGluZ3M7XG4gICAgICAgIGlmICghYmluZGluZ3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmluZGluZyA9IGJpbmRpbmdzLmdldChwcm9wZXJ0eSk7XG4gICAgICAgIGlmIChiaW5kaW5nKSB7XG4gICAgICAgICAgICBiaW5kaW5nLnVuYmluZCgpO1xuICAgICAgICAgICAgYmluZGluZ3MuZGVsZXRlKHByb3BlcnR5KTtcbiAgICAgICAgICAgIGlmIChiaW5kaW5nLnNvdXJjZUlzQmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IFwiYmluZGluZ0NvbnRleHRcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3VsZEFkZEhhbmRsZXJUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzMgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudF8zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfMy5vZmYoXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYWRkVmlldyA9IGZ1bmN0aW9uICh2aWV3LCBhdEluZGV4KSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9hZGRWaWV3KFwiICsgdmlldyArIFwiLCBcIiArIGF0SW5kZXggKyBcIilcIiwgYmluZGFibGVfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RpbmcgYSB2YWxpZCBWaWV3IGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISh2aWV3IGluc3RhbmNlb2YgVmlld0Jhc2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodmlldyArIFwiIGlzIG5vdCBhIHZhbGlkIFZpZXcgaW5zdGFuY2UuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3LnBhcmVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlldyBhbHJlYWR5IGhhcyBhIHBhcmVudC4gVmlldzogXCIgKyB2aWV3ICsgXCIgUGFyZW50OiBcIiArIHZpZXcucGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3LnBhcmVudCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2FkZFZpZXdDb3JlKHZpZXcsIGF0SW5kZXgpO1xuICAgICAgICB2aWV3Ll9wYXJlbnRDaGFuZ2VkKG51bGwpO1xuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUub25DaGlsZEFkZGVkKHZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2FkZFZpZXdDb3JlID0gZnVuY3Rpb24gKHZpZXcsIGF0SW5kZXgpIHtcbiAgICAgICAgcHJvcGVydGllc18xLnByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcyh0aGlzLCB2aWV3KTtcbiAgICAgICAgdmlldy5faW5oZXJpdFN0eWxlU2NvcGUodGhpcy5fc3R5bGVTY29wZSk7XG4gICAgICAgIHByb3BlcnRpZXNfMS5wcm9wYWdhdGVJbmhlcml0YWJsZUNzc1Byb3BlcnRpZXModGhpcy5zdHlsZSwgdmlldy5zdHlsZSk7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICB2aWV3Ll9zZXR1cFVJKHRoaXMuX2NvbnRleHQsIGF0SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkVmlldyh2aWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKHZpZXcgJiYgIXZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHZpZXcuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudW5sb2FkVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHZpZXcuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVtb3ZlVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9yZW1vdmVWaWV3KFwiICsgdmlldyArIFwiKVwiLCBiaW5kYWJsZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlldy5wYXJlbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZpZXcgbm90IGFkZGVkIHRvIHRoaXMgaW5zdGFuY2UuIFZpZXc6IFwiICsgdmlldyArIFwiIEN1cnJlbnRQYXJlbnQ6IFwiICsgdmlldy5wYXJlbnQgKyBcIiBFeHBlY3RlZFBhcmVudDogXCIgKyB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUub25DaGlsZFJlbW92ZWQodmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVtb3ZlVmlld0NvcmUodmlldyk7XG4gICAgICAgIHZpZXcucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB2aWV3Ll9wYXJlbnRDaGFuZ2VkKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3Q29yZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHRoaXMudW5sb2FkVmlldyh2aWV3KTtcbiAgICAgICAgaWYgKHZpZXcuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHZpZXcuX3RlYXJEb3duVUkoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlld0ludGVybmFsID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zZXR1cEFzUm9vdFZpZXcgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICB0aGlzLl9zZXR1cFVJKGNvbnRleHQpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zZXR1cFVJID0gZnVuY3Rpb24gKGNvbnRleHQsIGF0SW5kZXgsIHBhcmVudElzTG9hZGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0ID09PSBjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldyA9IHRoaXMuY3JlYXRlTmF0aXZlVmlldygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzQW5kcm9pZCkge1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXcgPSBuYXRpdmVWaWV3O1xuICAgICAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNQYWRkaW5nUmVsYXRpdmUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc1BhZGRpbmdSZWxhdGl2ZSA9IG5hdGl2ZVZpZXcuaXNQYWRkaW5nUmVsYXRpdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5hdGl2ZVZpZXcuZGVmYXVsdFBhZGRpbmdzO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5nZXRQYWRkaW5nKG5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmRlZmF1bHRQYWRkaW5ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3AgPSByZXN1bHQudG9wO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQgPSByZXN1bHQucmlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b20gPSByZXN1bHQuYm90dG9tO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdCA9IHJlc3VsdC5sZWZ0O1xuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHRoaXMuc3R5bGU7XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ1RvcFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ID0gdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gPSB0aGlzLl9kZWZhdWx0UGFkZGluZ0JvdHRvbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCA9IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9pb3NWaWV3ID0gbmF0aXZlVmlldztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldE5hdGl2ZVZpZXcobmF0aXZlVmlldyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZUluZGV4ID0gdGhpcy5wYXJlbnQuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXgoYXRJbmRleCk7XG4gICAgICAgICAgICB0aGlzLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gdGhpcy5wYXJlbnQuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUodGhpcywgbmF0aXZlSW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuVUlTZXR1cCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX3NldHVwVUkoY29udGV4dCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5fX25hdGl2ZVZpZXcgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX19uYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5OYXRpdmVWaWV3KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9fbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5fX25hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmluaXROYXRpdmVWaWV3KCk7XG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLk5hdGl2ZVZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3RlYXJEb3duVUkgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNldE5hdGl2ZVZpZXdJbnRlcm5hbCgpO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl90ZWFyRG93blVJKGZvcmNlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcG9zZU5hdGl2ZVZpZXcoKTtcbiAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuVUlTZXR1cCk7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzQW5kcm9pZCkge1xuICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KG51bGwpO1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXcgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUuZGlzcG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKHZpZXcsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKHZpZXcuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNoaWxkIGFscmVhZHkgYWRkZWQgdG8gdGhlIG5hdGl2ZSB2aXN1YWwgdHJlZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZpZXcuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fZ29Ub1Zpc3VhbFN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiIGdvaW5nIHRvIHN0YXRlOiBcIiArIHN0YXRlLCBiaW5kYWJsZV8xLnRyYWNlQ2F0ZWdvcmllcy5TdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXRlID09PSB0aGlzLl92aXN1YWxTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVsZXRlUHNldWRvQ2xhc3ModGhpcy5fdmlzdWFsU3RhdGUpO1xuICAgICAgICB0aGlzLl92aXN1YWxTdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLmFkZFBzZXVkb0NsYXNzKHN0YXRlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYXBwbHlYbWxBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlZpZXdCYXNlLl9hcHBseVhtbEF0dHJpYnV0ZSguLi4pIGlzIGRlcHJlY2F0ZWQ7IHNldCBhdHRyaWJ1dGVzIGFzIHBsYWluIHByb3BlcnRpZXMgaW5zdGVhZFwiKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZSA9PT0gXCJzdHlsZVwiIHx8IGF0dHJpYnV0ZSA9PT0gXCJyb3dzXCIgfHwgYXR0cmlidXRlID09PSBcImNvbHVtbnNcIiB8fCBhdHRyaWJ1dGUgPT09IFwiZm9udEF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgICAgdGhpc1thdHRyaWJ1dGVdID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0SW5saW5lU3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHlsZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyIHNob3VsZCBiZSB2YWxpZCBDU1Mgc3RyaW5nIVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbnN1cmVTdHlsZVNjb3BlTW9kdWxlKCk7XG4gICAgICAgIHN0eWxlU2NvcGVNb2R1bGUuYXBwbHlJbmxpbmVTdHlsZSh0aGlzLCBzdHlsZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3BhcmVudENoYW5nZWQgPSBmdW5jdGlvbiAob2xkUGFyZW50KSB7XG4gICAgICAgIHZhciBuZXdQYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKG9sZFBhcmVudCkge1xuICAgICAgICAgICAgcHJvcGVydGllc18xLmNsZWFySW5oZXJpdGVkUHJvcGVydGllcyh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIG9sZFBhcmVudC5vZmYoXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zaG91bGRBZGRIYW5kbGVyVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQpIHtcbiAgICAgICAgICAgIG5ld1BhcmVudC5vbihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYmluZGluZ3MuZ2V0KFwiYmluZGluZ0NvbnRleHRcIikuYmluZChuZXdQYXJlbnQuYmluZGluZ0NvbnRleHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUub25SZXN1bWVOYXRpdmVVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwcm9wZXJ0aWVzXzEuaW5pdE5hdGl2ZVZpZXcodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzLnR5cGVOYW1lO1xuICAgICAgICBpZiAodGhpcy5pZCkge1xuICAgICAgICAgICAgc3RyICs9IFwiPFwiICsgdGhpcy5pZCArIFwiPlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RyICs9IFwiKFwiICsgdGhpcy5fZG9tSWQgKyBcIilcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc291cmNlID0gZGVidWdfMS5Tb3VyY2UuZ2V0KHRoaXMpO1xuICAgICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgICAgICBzdHIgKz0gXCJAXCIgKyBzb3VyY2UgKyBcIjtcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9vbkNzc1N0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jc3NTdGF0ZS5vbkNoYW5nZSgpO1xuICAgICAgICBlYWNoRGVzY2VuZGFudCh0aGlzLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl9jc3NTdGF0ZS5vbkNoYW5nZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9pbmhlcml0U3R5bGVTY29wZSA9IGZ1bmN0aW9uIChzdHlsZVNjb3BlKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1N0eWxlU2NvcGVIb3N0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3N0eWxlU2NvcGUgIT09IHN0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlU2NvcGUgPSBzdHlsZVNjb3BlO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQuX2luaGVyaXRTdHlsZVNjb3BlKHN0eWxlU2NvcGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5zaG93TW9kYWwuYXBwbHkocGFyZW50LCBhcmdzKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jbG9zZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgcGFyZW50LmNsb3NlTW9kYWwuYXBwbHkocGFyZW50LCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9kaWFsb2dDbG9zZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVhY2hEZXNjZW5kYW50KHRoaXMsIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX2RpYWxvZ0Nsb3NlZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVhY2hEZXNjZW5kYW50KHRoaXMsIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX29uUm9vdFZpZXdSZXNldCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UubG9hZGVkRXZlbnQgPSBcImxvYWRlZFwiO1xuICAgIFZpZXdCYXNlLnVubG9hZGVkRXZlbnQgPSBcInVubG9hZGVkXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwib25VbmxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJhZGRQc2V1ZG9DbGFzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJkZWxldGVQc2V1ZG9DbGFzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJyZXF1ZXN0TGF5b3V0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl9hZGRWaWV3XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl9zZXR1cFVJXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl90ZWFyRG93blVJXCIsIG51bGwpO1xuICAgIHJldHVybiBWaWV3QmFzZTtcbn0oYmluZGFibGVfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLlZpZXdCYXNlID0gVmlld0Jhc2U7XG5WaWV3QmFzZS5wcm90b3R5cGUuaXNDb2xsYXBzZWQgPSBmYWxzZTtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkTGVmdCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZFRvcCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZFJpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkQm90dG9tID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNaW5XaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWluSGVpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVXaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlSGVpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5Ub3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpblJpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5Cb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpbkxlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ0xlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdUb3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ1JpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdCb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ0xlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9pc1ZpZXdCYXNlID0gdHJ1ZTtcblZpZXdCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwibmV2ZXJcIjtcblZpZXdCYXNlLnByb3RvdHlwZS5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCA9XG4gICAgU3VzcGVuZFR5cGUuTG9hZGVkIHxcbiAgICAgICAgU3VzcGVuZFR5cGUuTmF0aXZlVmlldyB8XG4gICAgICAgIFN1c3BlbmRUeXBlLlVJU2V0dXA7XG5leHBvcnRzLmJpbmRpbmdDb250ZXh0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZFByb3BlcnR5KHsgbmFtZTogXCJiaW5kaW5nQ29udGV4dFwiIH0pO1xuZXhwb3J0cy5iaW5kaW5nQ29udGV4dFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmV4cG9ydHMuY2xhc3NOYW1lUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImNsYXNzTmFtZVwiLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHZpZXcuY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIG1vZGFsVmlld0Nzc0NsYXNzID0gc3lzdGVtX2NsYXNzZXNfMS5nZXRNb2RhbFJvb3RWaWV3Q3NzQ2xhc3MoKTtcbiAgICAgICAgdmFyIHJvb3RWaWV3Q3NzQ2xhc3NlcyA9IHN5c3RlbV9jbGFzc2VzXzEuZ2V0Um9vdFZpZXdDc3NDbGFzc2VzKCk7XG4gICAgICAgIHZhciBzaG91bGRBZGRNb2RhbFJvb3RWaWV3Q3NzQ2xhc3MgPSBjc3NDbGFzc2VzLmhhcyhtb2RhbFZpZXdDc3NDbGFzcyk7XG4gICAgICAgIHZhciBzaG91bGRBZGRSb290Vmlld0Nzc0NsYXNzZXMgPSBjc3NDbGFzc2VzLmhhcyhyb290Vmlld0Nzc0NsYXNzZXNbMF0pO1xuICAgICAgICBjc3NDbGFzc2VzLmNsZWFyKCk7XG4gICAgICAgIGlmIChzaG91bGRBZGRNb2RhbFJvb3RWaWV3Q3NzQ2xhc3MpIHtcbiAgICAgICAgICAgIGNzc0NsYXNzZXMuYWRkKG1vZGFsVmlld0Nzc0NsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzaG91bGRBZGRSb290Vmlld0Nzc0NsYXNzZXMpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3Q3NzQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjc3NDbGFzc2VzLmFkZChjKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBuZXdWYWx1ZSAhPT0gXCJcIikge1xuICAgICAgICAgICAgbmV3VmFsdWUuc3BsaXQoXCIgXCIpLmZvckVhY2goZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGNzc0NsYXNzZXMuYWRkKGMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLmNsYXNzTmFtZVByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmV4cG9ydHMuaWRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoeyBuYW1lOiBcImlkXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkgeyByZXR1cm4gdmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpOyB9IH0pO1xuZXhwb3J0cy5pZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmZ1bmN0aW9uIGJvb2xlYW5Db252ZXJ0ZXIodikge1xuICAgIHZhciBsb3dlcmNhc2UgPSAodiArIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGxvd2VyY2FzZSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxvd2VyY2FzZSA9PT0gXCJmYWxzZVwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBib29sZWFuOiBcIiArIHYpO1xufVxuZXhwb3J0cy5ib29sZWFuQ29udmVydGVyID0gYm9vbGVhbkNvbnZlcnRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXctYmFzZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfYmFzZV8xID0gcmVxdWlyZShcIi4uL3ZpZXctYmFzZVwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIGdlc3R1cmVzXzEgPSByZXF1aXJlKFwiLi4vLi4vZ2VzdHVyZXNcIik7XG52YXIgc3lzdGVtX2NsYXNzZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jc3Mvc3lzdGVtLWNsYXNzZXNcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uLy4uL2J1aWxkZXJcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG52YXIgc3R5bGVfc2NvcGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXNjb3BlXCIpO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvbGluZWFyLWdyYWRpZW50XCIpO1xuZXhwb3J0cy5MaW5lYXJHcmFkaWVudCA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50O1xuX19leHBvcnQocmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdmlldy1iYXNlXCIpKTtcbnZhciBhbmltYXRpb25Nb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVBbmltYXRpb25Nb2R1bGUoKSB7XG4gICAgaWYgKCFhbmltYXRpb25Nb2R1bGUpIHtcbiAgICAgICAgYW5pbWF0aW9uTW9kdWxlID0gcmVxdWlyZShcIi4uLy4uL2FuaW1hdGlvblwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBDU1NUeXBlKHR5cGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBjbHMucHJvdG90eXBlLmNzc1R5cGUgPSB0eXBlO1xuICAgIH07XG59XG5leHBvcnRzLkNTU1R5cGUgPSBDU1NUeXBlO1xuZnVuY3Rpb24gdmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHZpZXcsIGNvbnRleHQsIHR5cGVzKSB7XG4gICAgcmV0dXJuIGNvbnRleHQgJiZcbiAgICAgICAgdmlldy5fbW9kdWxlTmFtZSAmJlxuICAgICAgICBjb250ZXh0LnR5cGUgJiZcbiAgICAgICAgdHlwZXMuc29tZShmdW5jdGlvbiAodHlwZSkgeyByZXR1cm4gdHlwZSA9PT0gY29udGV4dC50eXBlOyB9KSAmJlxuICAgICAgICBjb250ZXh0LnBhdGggJiZcbiAgICAgICAgY29udGV4dC5wYXRoLmluY2x1ZGVzKHZpZXcuX21vZHVsZU5hbWUpO1xufVxuZXhwb3J0cy52aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQgPSB2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQ7XG5mdW5jdGlvbiBQc2V1ZG9DbGFzc0hhbmRsZXIoKSB7XG4gICAgdmFyIHBzZXVkb0NsYXNzZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBwc2V1ZG9DbGFzc2VzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBzdGF0ZUV2ZW50TmFtZXMgPSBwc2V1ZG9DbGFzc2VzLm1hcChmdW5jdGlvbiAocykgeyByZXR1cm4gXCI6XCIgKyBzOyB9KTtcbiAgICB2YXIgbGlzdGVuZXJzID0gU3ltYm9sKFwibGlzdGVuZXJzXCIpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoY2hhbmdlKSB7XG4gICAgICAgICAgICB2YXIgcHJldiA9IHRoaXNbbGlzdGVuZXJzXSB8fCAwO1xuICAgICAgICAgICAgdmFyIG5leHQgPSBwcmV2ICsgY2hhbmdlO1xuICAgICAgICAgICAgaWYgKHByZXYgPD0gMCAmJiBuZXh0ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHlLZXldKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocHJldiA+IDAgJiYgbmV4dCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eUtleV0oZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0YXRlRXZlbnROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7IHJldHVybiB0YXJnZXRbc10gPSB1cGRhdGU7IH0pO1xuICAgIH07XG59XG5leHBvcnRzLlBzZXVkb0NsYXNzSGFuZGxlciA9IFBzZXVkb0NsYXNzSGFuZGxlcjtcbmV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzID0gbmV3IEFycmF5KCk7XG52YXIgVmlld0NvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXdDb21tb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlld0NvbW1vbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzID0ge307XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNjb3BlID0gdGhpcy5fc3R5bGVTY29wZTtcbiAgICAgICAgICAgIHJldHVybiBzY29wZSAmJiBzY29wZS5jc3M7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTdHlsZVNjb3BlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFkZENzcyA9IGZ1bmN0aW9uIChjc3NTdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGVTY29wZSh1bmRlZmluZWQsIGNzc1N0cmluZyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5hZGRDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUoY3NzRmlsZU5hbWUpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuY2hhbmdlQ3NzRmlsZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSkge1xuICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoc2NvcGUgJiYgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgICAgIHNjb3BlLmNoYW5nZUNzc0ZpbGUoY3NzRmlsZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fdXBkYXRlU3R5bGVTY29wZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gdGhpcy5fc3R5bGVTY29wZTtcbiAgICAgICAgaWYgKCFzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUgPSBuZXcgc3R5bGVfc2NvcGVfMS5TdHlsZVNjb3BlKCk7XG4gICAgICAgICAgICB0aGlzLnNldFNjb3BlUHJvcGVydHkoc2NvcGUsIGNzc0ZpbGVOYW1lLCBjc3NTdHJpbmcsIGNzcyk7XG4gICAgICAgICAgICB0aGlzLl9pbmhlcml0U3R5bGVTY29wZShzY29wZSk7XG4gICAgICAgICAgICB0aGlzLl9pc1N0eWxlU2NvcGVIb3N0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcGVQcm9wZXJ0eShzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKTtcbiAgICAgICAgICAgIHRoaXMuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuc2V0U2NvcGVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKSB7XG4gICAgICAgIGlmIChjc3NGaWxlTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzY29wZS5hZGRDc3NGaWxlKGNzc0ZpbGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjc3NTdHJpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2NvcGUuYWRkQ3NzKGNzc1N0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3NzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNjb3BlLmNzcyA9IGNzcztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2Nsb3NlQWxsTW9kYWxWaWV3c0ludGVybmFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MgJiYgZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MuZm9yRWFjaChmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgIHYuY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZ2V0Um9vdE1vZGFsVmlld3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHBvcnRzLl9yb290TW9kYWxWaWV3cztcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9vbkxpdmVzeW5jID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5fb25MaXZlc3luYyhcIiArIEpTT04uc3RyaW5naWZ5KGNvbnRleHQpICsgXCIpXCIsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2Nsb3NlQWxsTW9kYWxWaWV3c0ludGVybmFsKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9oYW5kbGVMaXZlc3luYyhjb250ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhbmRsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgaWYgKGNoaWxkLl9vbkxpdmVzeW5jKGNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhhbmRsZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9oYW5kbGVMaXZlc3luYyhcIiArIEpTT04uc3RyaW5naWZ5KGNvbnRleHQpICsgXCIpXCIsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCh0aGlzLCBjb250ZXh0LCBbXCJzdHlsZVwiXSkpIHtcbiAgICAgICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoXCJDaGFuZ2UgSGFuZGxlZDogQ2hhbmdpbmcgQ1NTIGZvciBcIiArIHRoaXMsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShjb250ZXh0LnBhdGgpICsgXCIuY3NzXCI7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZUNzc0ZpbGUoY3NzTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHRoaXMsIGNvbnRleHQsIFtcIm1hcmt1cFwiLCBcInNjcmlwdFwiXSkgJiZcbiAgICAgICAgICAgIHRoaXMucGFnZSAmJlxuICAgICAgICAgICAgdGhpcy5wYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKFwiQ2hhbmdlIEhhbmRsZWQ6IENoYW5naW5nIFwiICsgY29udGV4dC50eXBlICsgXCIgZm9yIFwiICsgdGhpcyArIFwiIGluc2lkZSBcIiArIHRoaXMucGFnZSwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZ2UuZnJhbWUuX2hhbmRsZUxpdmVzeW5jKHsgdHlwZTogY29udGV4dC50eXBlLCBwYXRoOiB0aGlzLnBhZ2UuX21vZHVsZU5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldHVwQXNSb290VmlldyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3NldHVwQXNSb290Vmlldy5jYWxsKHRoaXMsIGNvbnRleHQpO1xuICAgICAgICBpZiAoIXRoaXMuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29ic2VydmUgPSBmdW5jdGlvbiAodHlwZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdKSB7XG4gICAgICAgICAgICB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXS5wdXNoKGdlc3R1cmVzXzEub2JzZXJ2ZSh0aGlzLCB0eXBlLCBjYWxsYmFjaywgdGhpc0FyZykpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0R2VzdHVyZU9ic2VydmVycyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBhcmcgPSB2aWV3X2Jhc2VfMS5nZXRFdmVudE9yR2VzdHVyZU5hbWUoYXJnKTtcbiAgICAgICAgICAgIHZhciBnZXN0dXJlID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGFyZyk7XG4gICAgICAgICAgICBpZiAoZ2VzdHVyZSAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZShnZXN0dXJlLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gKGFyZykuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2dCA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3N0ID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGV2dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3N0ICYmICF0aGlzLl9pc0V2ZW50KGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlKGdzdCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgZXZ0LCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZlKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBnZXN0dXJlID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGFyZyk7XG4gICAgICAgICAgICBpZiAoZ2VzdHVyZSAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoZ2VzdHVyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gYXJnLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldnQgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdzdCA9IGdlc3R1cmVzXzEuZnJvbVN0cmluZyhldnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdzdCAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoZ3N0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGV2dCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoYXJnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldEZyYWdtZW50TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1vZGFsT3B0aW9ucyA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic2hvd01vZGFsIHdpdGhvdXQgcGFyYW1ldGVycyBpcyBkZXByZWNhdGVkLiBQbGVhc2UgY2FsbCBzaG93TW9kYWwgb24gYSB2aWV3IGluc3RhbmNlIGluc3RlYWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3NbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYXJnc1swXSBpbnN0YW5jZW9mIFZpZXdDb21tb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzaG93TW9kYWwodmlldzogVmlld0Jhc2UsIGNvbnRleHQ6IGFueSwgY2xvc2VDYWxsYmFjazogRnVuY3Rpb24sIGZ1bGxzY3JlZW4/OiBib29sZWFuLCBhbmltYXRlZD86IGJvb2xlYW4sIHN0cmV0Y2hlZD86IGJvb2xlYW4pIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXMgZGVwcmVjYXRlZC4gVXNlIHNob3dNb2RhbCh2aWV3OiBWaWV3QmFzZSwgbW9kYWxPcHRpb25zOiBTaG93TW9kYWxPcHRpb25zKSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2hvd01vZGFsKG1vZHVsZU5hbWU6IHN0cmluZywgY29udGV4dDogYW55LCBjbG9zZUNhbGxiYWNrOiBGdW5jdGlvbiwgZnVsbHNjcmVlbj86IGJvb2xlYW4sIGFuaW1hdGVkPzogYm9vbGVhbiwgc3RyZXRjaGVkPzogYm9vbGVhbikgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpcyBkZXByZWNhdGVkLiBVc2Ugc2hvd01vZGFsKG1vZHVsZU5hbWU6IHN0cmluZywgbW9kYWxPcHRpb25zOiBTaG93TW9kYWxPcHRpb25zKSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dDogYXJnc1sxXSxcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogYXJnc1syXSxcbiAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbjogYXJnc1szXSxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQ6IGFyZ3NbNF0sXG4gICAgICAgICAgICAgICAgICAgIHN0cmV0Y2hlZDogYXJnc1s1XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmlyc3RBcmd1bWVudCA9IGFyZ3NbMF07XG4gICAgICAgICAgICB2YXIgdmlldyA9IGZpcnN0QXJndW1lbnQgaW5zdGFuY2VvZiBWaWV3Q29tbW9uXG4gICAgICAgICAgICAgICAgPyBmaXJzdEFyZ3VtZW50IDogYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkoeyBtb2R1bGVOYW1lOiBmaXJzdEFyZ3VtZW50IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmlldzogdmlldywgb3B0aW9uczogb3B0aW9ucyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5zaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYSA9IHRoaXMuZ2V0TW9kYWxPcHRpb25zKGFyZ3VtZW50cyksIHZpZXcgPSBfYS52aWV3LCBvcHRpb25zID0gX2Eub3B0aW9ucztcbiAgICAgICAgdmlldy5fc2hvd05hdGl2ZU1vZGFsVmlldyh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5jbG9zZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbG9zZUNhbGxiYWNrID0gdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrO1xuICAgICAgICBpZiAoY2xvc2VDYWxsYmFjaykge1xuICAgICAgICAgICAgY2xvc2VDYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50XzEgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIGlmIChwYXJlbnRfMSkge1xuICAgICAgICAgICAgICAgIHBhcmVudF8xLmNsb3NlTW9kYWwuYXBwbHkocGFyZW50XzEsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibW9kYWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2RhbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3Nob3dOYXRpdmVNb2RhbFZpZXcgPSBmdW5jdGlvbiAocGFyZW50LCBvcHRpb25zKSB7XG4gICAgICAgIGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzLnB1c2godGhpcyk7XG4gICAgICAgIHZhciBtb2RhbFJvb3RWaWV3Q3NzQ2xhc3MgPSBzeXN0ZW1fY2xhc3Nlc18xLmdldE1vZGFsUm9vdFZpZXdDc3NDbGFzcygpO1xuICAgICAgICB0aGlzLmNzc0NsYXNzZXMuYWRkKG1vZGFsUm9vdFZpZXdDc3NDbGFzcyk7XG4gICAgICAgIHBhcmVudC5fbW9kYWwgPSB0aGlzO1xuICAgICAgICB0aGlzLl9tb2RhbFBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5fbW9kYWxDb250ZXh0ID0gb3B0aW9ucy5jb250ZXh0O1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbEFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxBcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhhdC5fY2xvc2VNb2RhbENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5kZXggPSBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5pbmRleE9mKHRoYXQpO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzLnNwbGljZShtb2RhbEluZGV4KTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9tb2RhbFBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhhdC5fbW9kYWxDb250ZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jbG9zZU1vZGFsQ2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoYXQuX2RpYWxvZ0Nsb3NlZCgpO1xuICAgICAgICAgICAgICAgIHBhcmVudC5fbW9kYWwgPSBudWxsO1xuICAgICAgICAgICAgICAgIHZhciB3aGVuQ2xvc2VkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5jbG9zZUNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY2xvc2VDYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIG9yaWdpbmFsQXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoYXQuX2hpZGVOYXRpdmVNb2RhbFZpZXcocGFyZW50LCB3aGVuQ2xvc2VkQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JhaXNlTGF5b3V0Q2hhbmdlZEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmFpc2VTaG93bk1vZGFsbHlFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IFZpZXdDb21tb24uc2hvd25Nb2RhbGx5RXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBjb250ZXh0OiB0aGlzLl9tb2RhbENvbnRleHQsXG4gICAgICAgICAgICBjbG9zZUNhbGxiYWNrOiB0aGlzLl9jbG9zZU1vZGFsQ2FsbGJhY2tcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmFpc2VTaG93aW5nTW9kYWxseUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogVmlld0NvbW1vbi5zaG93aW5nTW9kYWxseUV2ZW50LFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5fbW9kYWxDb250ZXh0LFxuICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2lzRXZlbnQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciAmJiBuYW1lICsgXCJFdmVudFwiIGluIHRoaXMuY29uc3RydWN0b3I7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5nZXRHZXN0dXJlT2JzZXJ2ZXJzKHR5cGUpO1xuICAgICAgICBpZiAob2JzZXJ2ZXJzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9ic2VydmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyc1tpXS5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSaWdodENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJSaWdodENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJSaWdodENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21Db2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbUNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJMZWZ0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyTGVmdENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlcldpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSaWdodFdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJSaWdodFdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21XaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJMZWZ0V2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckxlZnRXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyUmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BMZWZ0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BSaWdodFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wUmlnaHRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21SaWdodFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21MZWZ0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kSW1hZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRJbWFnZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kUG9zaXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kUmVwZWF0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUmVwZWF0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUmVwZWF0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtaW5XaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWluV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1pbldpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtaW5IZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1pbkhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWluSGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuaGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5MZWZ0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW5MZWZ0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW5MZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5Ub3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpblRvcDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5SaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luUmlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpblJpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5Cb3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpbkJvdHRvbTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luQm90dG9tID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJob3Jpem9udGFsQWxpZ25tZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ2ZXJ0aWNhbEFsaWdubWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudmVydGljYWxBbGlnbm1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ2aXNpYmlsaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS52aXNpYmlsaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS52aXNpYmlsaXR5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJvcGFjaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5vcGFjaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5vcGFjaXR5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJyb3RhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnJvdGF0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucm90YXRlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ0cmFuc2xhdGVYXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50cmFuc2xhdGVYO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50cmFuc2xhdGVYID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ0cmFuc2xhdGVZXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50cmFuc2xhdGVZO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50cmFuc2xhdGVZID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJzY2FsZVhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNjYWxlWDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2NhbGVYID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJzY2FsZVlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNjYWxlWTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2NhbGVZID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJhbmRyb2lkRWxldmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbmRyb2lkRWxldmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkRWxldmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJhbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJpc0xheW91dFZhbGlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNMYXlvdXRWYWxpZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImNzc1R5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY3NzVHlwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nzc1R5cGUgPSB0aGlzLnR5cGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3NzVHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy5fY3NzVHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImlzTGF5b3V0UmVxdWlyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRNZWFzdXJlU3BlY3Mod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB0aGlzLl9zZXRDdXJyZW50TGF5b3V0Qm91bmRzKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNZWFzdXJlZFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWVhc3VyZWRXaWR0aCAmIHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TSVpFX01BU0sgfHwgMDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1lYXN1cmVkSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWVhc3VyZWRIZWlnaHQgJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU0laRV9NQVNLIHx8IDA7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNZWFzdXJlZFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX21lYXN1cmVkV2lkdGggJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfTUFTSylcbiAgICAgICAgICAgIHwgKCh0aGlzLl9tZWFzdXJlZEhlaWdodCA+PiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfSEVJR0hUX1NUQVRFX1NISUZUKVxuICAgICAgICAgICAgICAgICYgKHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9NQVNLID4+IHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQpKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnNldE1lYXN1cmVkRGltZW5zaW9uID0gZnVuY3Rpb24gKG1lYXN1cmVkV2lkdGgsIG1lYXN1cmVkSGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkV2lkdGggPSBtZWFzdXJlZFdpZHRoO1xuICAgICAgICB0aGlzLl9tZWFzdXJlZEhlaWdodCA9IG1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiIDpzZXRNZWFzdXJlZERpbWVuc2lvbjogXCIgKyBtZWFzdXJlZFdpZHRoICsgXCIsIFwiICsgbWVhc3VyZWRIZWlnaHQsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9pc0xheW91dFZhbGlkID0gZmFsc2U7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVxdWVzdExheW91dC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5yZXNvbHZlU2l6ZUFuZFN0YXRlID0gZnVuY3Rpb24gKHNpemUsIHNwZWNTaXplLCBzcGVjTW9kZSwgY2hpbGRNZWFzdXJlZFN0YXRlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBzaXplO1xuICAgICAgICBzd2l0Y2ggKHNwZWNNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmNlaWwoc2l6ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5BVF9NT1NUOlxuICAgICAgICAgICAgICAgIGlmIChzcGVjU2l6ZSA8IHNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHNwZWNTaXplKSB8IHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9UT09fU01BTEw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmNlaWwoc3BlY1NpemUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQgfCAoY2hpbGRNZWFzdXJlZFN0YXRlICYgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX01BU0spO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5jb21iaW5lTWVhc3VyZWRTdGF0ZXMgPSBmdW5jdGlvbiAoY3VyU3RhdGUsIG5ld1N0YXRlKSB7XG4gICAgICAgIHJldHVybiBjdXJTdGF0ZSB8IG5ld1N0YXRlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5sYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChwYXJlbnQsIGNoaWxkLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIHNldEZyYW1lKSB7XG4gICAgICAgIGlmIChzZXRGcmFtZSA9PT0gdm9pZCAwKSB7IHNldEZyYW1lID0gdHJ1ZTsgfVxuICAgICAgICBpZiAoIWNoaWxkIHx8IGNoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgdmFyIGNoaWxkVG9wO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0O1xuICAgICAgICB2YXIgY2hpbGRXaWR0aCA9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKTtcbiAgICAgICAgdmFyIGNoaWxkSGVpZ2h0ID0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKTtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpblRvcCA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpblRvcDtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbSA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgdmFyIHZBbGlnbm1lbnQ7XG4gICAgICAgIGlmIChjaGlsZC5lZmZlY3RpdmVIZWlnaHQgPj0gMCAmJiBjaGlsZFN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIikge1xuICAgICAgICAgICAgdkFsaWdubWVudCA9IFwibWlkZGxlXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2QWxpZ25tZW50ID0gY2hpbGRTdHlsZS52ZXJ0aWNhbEFsaWdubWVudDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHZBbGlnbm1lbnQpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHRvcCArIGVmZmVjdGl2ZU1hcmdpblRvcDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJtaWRkbGVcIjpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHRvcCArIChib3R0b20gLSB0b3AgLSBjaGlsZEhlaWdodCArIChlZmZlY3RpdmVNYXJnaW5Ub3AgLSBlZmZlY3RpdmVNYXJnaW5Cb3R0b20pKSAvIDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSBib3R0b20gLSBjaGlsZEhlaWdodCAtIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzdHJldGNoXCI6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gdG9wICsgZWZmZWN0aXZlTWFyZ2luVG9wO1xuICAgICAgICAgICAgICAgIGNoaWxkSGVpZ2h0ID0gYm90dG9tIC0gdG9wIC0gKGVmZmVjdGl2ZU1hcmdpblRvcCArIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpbkxlZnQgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5MZWZ0O1xuICAgICAgICB2YXIgZWZmZWN0aXZlTWFyZ2luUmlnaHQgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgdmFyIGhBbGlnbm1lbnQ7XG4gICAgICAgIGlmIChjaGlsZC5lZmZlY3RpdmVXaWR0aCA+PSAwICYmIGNoaWxkU3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIpIHtcbiAgICAgICAgICAgIGhBbGlnbm1lbnQgPSBcImNlbnRlclwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaEFsaWdubWVudCA9IGNoaWxkU3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGhBbGlnbm1lbnQpIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIGVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIChyaWdodCAtIGxlZnQgLSBjaGlsZFdpZHRoICsgKGVmZmVjdGl2ZU1hcmdpbkxlZnQgLSBlZmZlY3RpdmVNYXJnaW5SaWdodCkpIC8gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHJpZ2h0IC0gY2hpbGRXaWR0aCAtIGVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInN0cmV0Y2hcIjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIGVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgICAgICAgICAgY2hpbGRXaWR0aCA9IHJpZ2h0IC0gbGVmdCAtIChlZmZlY3RpdmVNYXJnaW5MZWZ0ICsgZWZmZWN0aXZlTWFyZ2luUmlnaHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZFJpZ2h0ID0gTWF0aC5yb3VuZChjaGlsZExlZnQgKyBjaGlsZFdpZHRoKTtcbiAgICAgICAgdmFyIGNoaWxkQm90dG9tID0gTWF0aC5yb3VuZChjaGlsZFRvcCArIGNoaWxkSGVpZ2h0KTtcbiAgICAgICAgY2hpbGRMZWZ0ID0gTWF0aC5yb3VuZChjaGlsZExlZnQpO1xuICAgICAgICBjaGlsZFRvcCA9IE1hdGgucm91bmQoY2hpbGRUb3ApO1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoY2hpbGQucGFyZW50ICsgXCIgOmxheW91dENoaWxkOiBcIiArIGNoaWxkICsgXCIgXCIgKyBjaGlsZExlZnQgKyBcIiwgXCIgKyBjaGlsZFRvcCArIFwiLCBcIiArIGNoaWxkUmlnaHQgKyBcIiwgXCIgKyBjaGlsZEJvdHRvbSwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxheW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGQubGF5b3V0KGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkUmlnaHQsIGNoaWxkQm90dG9tLCBzZXRGcmFtZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLm1lYXN1cmVDaGlsZCA9IGZ1bmN0aW9uIChwYXJlbnQsIGNoaWxkLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgbWVhc3VyZVdpZHRoID0gMDtcbiAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSAwO1xuICAgICAgICBpZiAoY2hpbGQgJiYgIWNoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGhTcGVjID0gcGFyZW50ID8gcGFyZW50Ll9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYyA6IHdpZHRoTWVhc3VyZVNwZWM7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0U3BlYyA9IHBhcmVudCA/IHBhcmVudC5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjIDogaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoU3BlYyk7XG4gICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aFNwZWMpO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0U3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0U3BlYyk7XG4gICAgICAgICAgICBjaGlsZC5fdXBkYXRlRWZmZWN0aXZlTGF5b3V0VmFsdWVzKHdpZHRoLCB3aWR0aE1vZGUsIGhlaWdodCwgaGVpZ2h0TW9kZSk7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgICAgIHZhciBob3Jpem9udGFsTWFyZ2lucyA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgIHZhciB2ZXJ0aWNhbE1hcmdpbnMgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Ub3AgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgICAgICB2YXIgY2hpbGRXaWR0aE1lYXN1cmVTcGVjID0gVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyh3aWR0aE1lYXN1cmVTcGVjLCBob3Jpem9udGFsTWFyZ2lucywgY2hpbGQuZWZmZWN0aXZlV2lkdGgsIHN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiKTtcbiAgICAgICAgICAgIHZhciBjaGlsZEhlaWdodE1lYXN1cmVTcGVjID0gVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyhoZWlnaHRNZWFzdXJlU3BlYywgdmVydGljYWxNYXJnaW5zLCBjaGlsZC5lZmZlY3RpdmVIZWlnaHQsIHN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIik7XG4gICAgICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKGNoaWxkLnBhcmVudCArIFwiIDptZWFzdXJlQ2hpbGQ6IFwiICsgY2hpbGQgKyBcIiBcIiArIHZpZXdfYmFzZV8xLmxheW91dC5tZWFzdXJlU3BlY1RvU3RyaW5nKGNoaWxkV2lkdGhNZWFzdXJlU3BlYykgKyBcIiwgXCIgKyB2aWV3X2Jhc2VfMS5sYXlvdXQubWVhc3VyZVNwZWNUb1N0cmluZyhjaGlsZEhlaWdodE1lYXN1cmVTcGVjKSArIFwifVwiLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoaWxkLm1lYXN1cmUoY2hpbGRXaWR0aE1lYXN1cmVTcGVjLCBjaGlsZEhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIG1lYXN1cmVXaWR0aCA9IE1hdGgucm91bmQoY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpICsgaG9yaXpvbnRhbE1hcmdpbnMpO1xuICAgICAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgucm91bmQoY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIHZlcnRpY2FsTWFyZ2lucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgbWVhc3VyZWRXaWR0aDogbWVhc3VyZVdpZHRoLCBtZWFzdXJlZEhlaWdodDogbWVhc3VyZUhlaWdodCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyA9IGZ1bmN0aW9uIChwYXJlbnRTcGVjLCBtYXJnaW5zLCBjaGlsZExlbmd0aCwgc3RyZXRjaGVkKSB7XG4gICAgICAgIHZhciBwYXJlbnRMZW5ndGggPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHBhcmVudFNwZWMpO1xuICAgICAgICB2YXIgcGFyZW50U3BlY01vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHBhcmVudFNwZWMpO1xuICAgICAgICB2YXIgcmVzdWx0U2l6ZTtcbiAgICAgICAgdmFyIHJlc3VsdE1vZGU7XG4gICAgICAgIGlmIChjaGlsZExlbmd0aCA+PSAwKSB7XG4gICAgICAgICAgICByZXN1bHRTaXplID0gcGFyZW50U3BlY01vZGUgPT09IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRCA/IGNoaWxkTGVuZ3RoIDogTWF0aC5taW4ocGFyZW50TGVuZ3RoLCBjaGlsZExlbmd0aCk7XG4gICAgICAgICAgICByZXN1bHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcmVudFNwZWNNb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IE1hdGgubWF4KDAsIHBhcmVudExlbmd0aCAtIG1hcmdpbnMpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gc3RyZXRjaGVkID8gdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFkgOiB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IE1hdGgubWF4KDAsIHBhcmVudExlbmd0aCAtIG1hcmdpbnMpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LkFUX01PU1Q7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gMDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXdfYmFzZV8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMocmVzdWx0U2l6ZSwgcmVzdWx0TW9kZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgY2hhbmdlZCA9IHRoaXMuX2N1cnJlbnRXaWR0aE1lYXN1cmVTcGVjICE9PSB3aWR0aE1lYXN1cmVTcGVjIHx8IHRoaXMuX2N1cnJlbnRIZWlnaHRNZWFzdXJlU3BlYyAhPT0gaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRXaWR0aE1lYXN1cmVTcGVjID0gd2lkdGhNZWFzdXJlU3BlYztcbiAgICAgICAgdGhpcy5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjID0gaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgIHJldHVybiBjaGFuZ2VkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHRoaXMuX2lzTGF5b3V0VmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgYm91bmRzQ2hhbmdlZCA9IHRoaXMuX29sZExlZnQgIT09IGxlZnQgfHwgdGhpcy5fb2xkVG9wICE9PSB0b3AgfHwgdGhpcy5fb2xkUmlnaHQgIT09IHJpZ2h0IHx8IHRoaXMuX29sZEJvdHRvbSAhPT0gYm90dG9tO1xuICAgICAgICB2YXIgc2l6ZUNoYW5nZWQgPSAodGhpcy5fb2xkUmlnaHQgLSB0aGlzLl9vbGRMZWZ0ICE9PSByaWdodCAtIGxlZnQpIHx8ICh0aGlzLl9vbGRCb3R0b20gLSB0aGlzLl9vbGRUb3AgIT09IGJvdHRvbSAtIHRvcCk7XG4gICAgICAgIHRoaXMuX29sZExlZnQgPSBsZWZ0O1xuICAgICAgICB0aGlzLl9vbGRUb3AgPSB0b3A7XG4gICAgICAgIHRoaXMuX29sZFJpZ2h0ID0gcmlnaHQ7XG4gICAgICAgIHRoaXMuX29sZEJvdHRvbSA9IGJvdHRvbTtcbiAgICAgICAgcmV0dXJuIHsgYm91bmRzQ2hhbmdlZDogYm91bmRzQ2hhbmdlZCwgc2l6ZUNoYW5nZWQ6IHNpemVDaGFuZ2VkIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGNhbGxiYWNrKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXROYXRpdmVWaWV3c0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSA/IDEgOiAwO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2VhY2hMYXlvdXRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0U2FmZUFyZWFJbnNldHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TG9jYXRpb25JbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldExvY2F0aW9uT25TY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvblJlbGF0aXZlVG8gPSBmdW5jdGlvbiAob3RoZXJWaWV3KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRBY3R1YWxTaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VycmVudEJvdW5kcyA9IHRoaXMuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMoKTtcbiAgICAgICAgaWYgKCFjdXJyZW50Qm91bmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogdmlld19iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoY3VycmVudEJvdW5kcy5yaWdodCAtIGN1cnJlbnRCb3VuZHMubGVmdCksXG4gICAgICAgICAgICBoZWlnaHQ6IHZpZXdfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGN1cnJlbnRCb3VuZHMuYm90dG9tIC0gY3VycmVudEJvdW5kcy50b3ApLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQW5pbWF0aW9uKGFuaW1hdGlvbikucGxheSgpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuY3JlYXRlQW5pbWF0aW9uID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICBlbnN1cmVBbmltYXRpb25Nb2R1bGUoKTtcbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhbEFuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2FsQW5pbWF0aW9ucyA9IG5ldyBTZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb24udGFyZ2V0ID0gdGhpcztcbiAgICAgICAgdmFyIGFuaW0gPSBuZXcgYW5pbWF0aW9uTW9kdWxlLkFuaW1hdGlvbihbYW5pbWF0aW9uXSk7XG4gICAgICAgIHRoaXMuX2xvY2FsQW5pbWF0aW9ucy5hZGQoYW5pbSk7XG4gICAgICAgIHJldHVybiBhbmltO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JlbW92ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcbiAgICAgICAgdmFyIGxvY2FsQW5pbWF0aW9ucyA9IHRoaXMuX2xvY2FsQW5pbWF0aW9ucztcbiAgICAgICAgaWYgKGxvY2FsQW5pbWF0aW9ucyAmJiBsb2NhbEFuaW1hdGlvbnMuaGFzKGFuaW1hdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2FsQW5pbWF0aW9ucy5kZWxldGUoYW5pbWF0aW9uKTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb24uaXNQbGF5aW5nKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5fbG9jYWxBbmltYXRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbEFuaW1hdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoYSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZUFuaW1hdGlvbihhKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXROYXRpdmVWaWV3RnJhbWUgPSBmdW5jdGlvbiAobmF0aXZlVmlldywgZnJhbWUpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFZpZXcuX2dldFZhbHVlIGlzIG9ic29sZXRlLiBUaGVyZSBpcyBhIG5ldyBwcm9wZXJ0eSBzeXN0ZW0uXCIpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgVmlldy5fc2V0VmFsdWUgaXMgb2Jzb2xldGUuIFRoZXJlIGlzIGEgbmV3IHByb3BlcnR5IHN5c3RlbS5cIik7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fdXBkYXRlRWZmZWN0aXZlTGF5b3V0VmFsdWVzID0gZnVuY3Rpb24gKHBhcmVudFdpZHRoTWVhc3VyZVNpemUsIHBhcmVudFdpZHRoTWVhc3VyZU1vZGUsIHBhcmVudEhlaWdodE1lYXN1cmVTaXplLCBwYXJlbnRIZWlnaHRNZWFzdXJlTW9kZSkge1xuICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLnN0eWxlO1xuICAgICAgICB2YXIgYXZhaWxhYmxlV2lkdGggPSBwYXJlbnRXaWR0aE1lYXN1cmVNb2RlID09PSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyAtMSA6IHBhcmVudFdpZHRoTWVhc3VyZVNpemU7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlV2lkdGggPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS53aWR0aCwgLTIsIGF2YWlsYWJsZVdpZHRoKTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXJnaW5MZWZ0ID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luTGVmdCwgMCwgYXZhaWxhYmxlV2lkdGgpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpblJpZ2h0ID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luUmlnaHQsIDAsIGF2YWlsYWJsZVdpZHRoKTtcbiAgICAgICAgdmFyIGF2YWlsYWJsZUhlaWdodCA9IHBhcmVudEhlaWdodE1lYXN1cmVNb2RlID09PSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyAtMSA6IHBhcmVudEhlaWdodE1lYXN1cmVTaXplO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZUhlaWdodCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLmhlaWdodCwgLTIsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWFyZ2luVG9wID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luVG9wLCAwLCBhdmFpbGFibGVIZWlnaHQpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLm1hcmdpbkJvdHRvbSwgMCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9vbkRldGFjaGVkRnJvbVdpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9oYXNBbmNlc3RvclZpZXcgPSBmdW5jdGlvbiAoYW5jZXN0b3JWaWV3KSB7XG4gICAgICAgIHZhciBtYXRjaGVyID0gZnVuY3Rpb24gKHZpZXcpIHsgcmV0dXJuIHZpZXcgPT09IGFuY2VzdG9yVmlldzsgfTtcbiAgICAgICAgZm9yICh2YXIgcGFyZW50XzIgPSB0aGlzLnBhcmVudDsgcGFyZW50XzIgIT0gbnVsbDsgcGFyZW50XzIgPSBwYXJlbnRfMi5wYXJlbnQpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaGVyKHBhcmVudF8yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ubGF5b3V0Q2hhbmdlZEV2ZW50ID0gXCJsYXlvdXRDaGFuZ2VkXCI7XG4gICAgVmlld0NvbW1vbi5zaG93bk1vZGFsbHlFdmVudCA9IFwic2hvd25Nb2RhbGx5XCI7XG4gICAgVmlld0NvbW1vbi5zaG93aW5nTW9kYWxseUV2ZW50ID0gXCJzaG93aW5nTW9kYWxseVwiO1xuICAgIHJldHVybiBWaWV3Q29tbW9uO1xufSh2aWV3X2Jhc2VfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5WaWV3Q29tbW9uID0gVmlld0NvbW1vbjtcbmV4cG9ydHMuYXV0b21hdGlvblRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYXV0b21hdGlvblRleHRcIiB9KTtcbmV4cG9ydHMuYXV0b21hdGlvblRleHRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMub3JpZ2luWFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmlnaW5YXCIsIGRlZmF1bHRWYWx1ZTogMC41LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLm9yaWdpblhQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMub3JpZ2luWVByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmlnaW5ZXCIsIGRlZmF1bHRWYWx1ZTogMC41LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLm9yaWdpbllQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaXNFbmFibGVkUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXNFbmFibGVkXCIsXG4gICAgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgIHZhbHVlQ29udmVydGVyOiB2aWV3X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5fZ29Ub1Zpc3VhbFN0YXRlKG5ld1ZhbHVlID8gXCJub3JtYWxcIiA6IFwiZGlzYWJsZWRcIik7XG4gICAgfVxufSk7XG5leHBvcnRzLmlzRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pb3NPdmVyZmxvd1NhZmVBcmVhUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImlvc092ZXJmbG93U2FmZUFyZWFcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlvc092ZXJmbG93U2FmZUFyZWFQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Jbmhlcml0ZWRQcm9wZXJ0eSh7IG5hbWU6IFwiaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld19iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3ZpZXctY29tbW9uXCIpO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgYmFja2dyb3VuZF8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvYmFja2dyb3VuZFwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wcm9maWxpbmdcIik7XG52YXIgZnJhbWVfc3RhY2tfMSA9IHJlcXVpcmUoXCIuLi8uLi9mcmFtZS9mcmFtZS1zdGFja1wiKTtcbnZhciBhcHBsaWNhdGlvbl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbGF6eV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL2xhenlcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi92aWV3LWNvbW1vblwiKSk7XG52YXIgRE9NSUQgPSBcIl9kb21JZFwiO1xudmFyIGFuZHJvaWRCYWNrUHJlc3NlZEV2ZW50ID0gXCJhbmRyb2lkQmFja1ByZXNzZWRcIjtcbnZhciBzaG9ydEFuaW1UaW1lID0gMTc2OTQ3MjA7XG52YXIgc3RhdGVQcmVzc2VkID0gMTY4NDI5MTk7XG52YXIgc3RhdGVFbmFibGVkID0gMTY4NDI5MTA7XG52YXIgc2RrVmVyc2lvbiA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBhcnNlSW50KHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24pOyB9KTtcbnZhciBtb2RhbE1hcCA9IG5ldyBNYXAoKTtcbnZhciBUb3VjaExpc3RlbmVyO1xudmFyIERpYWxvZ0ZyYWdtZW50O1xuZnVuY3Rpb24gaW5pdGlhbGl6ZVRvdWNoTGlzdGVuZXIoKSB7XG4gICAgaWYgKFRvdWNoTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVG91Y2hMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVG91Y2hMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRvdWNoTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBuZXcgV2Vha1JlZihvd25lcik7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBUb3VjaExpc3RlbmVySW1wbC5wcm90b3R5cGUub25Ub3VjaCA9IGZ1bmN0aW9uICh2aWV3LCBldmVudCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5oYW5kbGVHZXN0dXJlVG91Y2goZXZlbnQpO1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBvd25lci5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKCFuYXRpdmVWaWV3IHx8ICFuYXRpdmVWaWV3Lm9uVG91Y2hFdmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVWaWV3Lm9uVG91Y2hFdmVudChldmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIFRvdWNoTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLnZpZXcuVmlldy5PblRvdWNoTGlzdGVuZXJdKVxuICAgICAgICBdLCBUb3VjaExpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBUb3VjaExpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBUb3VjaExpc3RlbmVyID0gVG91Y2hMaXN0ZW5lckltcGw7XG59XG5mdW5jdGlvbiBpbml0aWFsaXplRGlhbG9nRnJhZ21lbnQoKSB7XG4gICAgaWYgKERpYWxvZ0ZyYWdtZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIERpYWxvZ0ltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRGlhbG9nSW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRGlhbG9nSW1wbChmcmFnbWVudCwgY29udGV4dCwgdGhlbWVSZXNJZCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgY29udGV4dCwgdGhlbWVSZXNJZCkgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLmZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBEaWFsb2dJbXBsLnByb3RvdHlwZS5vbkRldGFjaGVkRnJvbVdpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25EZXRhY2hlZEZyb21XaW5kb3cuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBEaWFsb2dJbXBsLnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLmZyYWdtZW50Lm93bmVyO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBcImFjdGl2aXR5QmFja1ByZXNzZWRcIixcbiAgICAgICAgICAgICAgICBvYmplY3Q6IHZpZXcsXG4gICAgICAgICAgICAgICAgYWN0aXZpdHk6IHZpZXcuX2NvbnRleHQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBmYWxzZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhcHBsaWNhdGlvbl8xLmFuZHJvaWQubm90aWZ5KGFyZ3MpO1xuICAgICAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlldy5ub3RpZnkoYXJncyk7XG4gICAgICAgICAgICBpZiAoIWFyZ3MuY2FuY2VsICYmICF2aWV3Lm9uQmFja1ByZXNzZWQoKSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25CYWNrUHJlc3NlZC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRGlhbG9nSW1wbDtcbiAgICB9KGFuZHJvaWQuYXBwLkRpYWxvZykpO1xuICAgIHZhciBEaWFsb2dGcmFnbWVudEltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRGlhbG9nRnJhZ21lbnRJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBEaWFsb2dGcmFnbWVudEltcGwoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRGlhbG9nRnJhZ21lbnRJbXBsLnByb3RvdHlwZS5vbkNyZWF0ZURpYWxvZyA9IGZ1bmN0aW9uIChzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBvd25lcklkID0gdGhpcy5nZXRBcmd1bWVudHMoKS5nZXRJbnQoRE9NSUQpO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBnZXRNb2RhbE9wdGlvbnMob3duZXJJZCk7XG4gICAgICAgICAgICB0aGlzLm93bmVyID0gb3B0aW9ucy5vd25lcjtcbiAgICAgICAgICAgIHRoaXMuX2Z1bGxzY3JlZW4gPSBvcHRpb25zLmZ1bGxzY3JlZW47XG4gICAgICAgICAgICB0aGlzLl9hbmltYXRlZCA9IG9wdGlvbnMuYW5pbWF0ZWQ7XG4gICAgICAgICAgICB0aGlzLl9jYW5jZWxhYmxlID0gb3B0aW9ucy5jYW5jZWxhYmxlO1xuICAgICAgICAgICAgdGhpcy5fc3RyZXRjaGVkID0gb3B0aW9ucy5zdHJldGNoZWQ7XG4gICAgICAgICAgICB0aGlzLl9kaXNtaXNzQ2FsbGJhY2sgPSBvcHRpb25zLmRpc21pc3NDYWxsYmFjaztcbiAgICAgICAgICAgIHRoaXMuX3Nob3duQ2FsbGJhY2sgPSBvcHRpb25zLnNob3duQ2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLnNldFN0eWxlKGFuZHJvaWR4LmZyYWdtZW50LmFwcC5EaWFsb2dGcmFnbWVudC5TVFlMRV9OT19USVRMRSwgMCk7XG4gICAgICAgICAgICB2YXIgdGhlbWUgPSB0aGlzLmdldFRoZW1lKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5fZnVsbHNjcmVlbikge1xuICAgICAgICAgICAgICAgIHRoZW1lID0gdGhpcy5nZXRBY3Rpdml0eSgpLmdldEFwcGxpY2F0aW9uSW5mbygpLnRoZW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRpYWxvZyA9IG5ldyBEaWFsb2dJbXBsKHRoaXMsIHRoaXMuZ2V0QWN0aXZpdHkoKSwgdGhlbWUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9mdWxsc2NyZWVuICYmICF0aGlzLl9zdHJldGNoZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLmhvcml6b250YWxBbGlnbm1lbnQgPSBcImNlbnRlclwiO1xuICAgICAgICAgICAgICAgIHRoaXMub3duZXIudmVydGljYWxBbGlnbm1lbnQgPSBcIm1pZGRsZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci5ob3Jpem9udGFsQWxpZ25tZW50ID0gXCJzdHJldGNoXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci52ZXJ0aWNhbEFsaWdubWVudCA9IFwic3RyZXRjaFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2FuaW1hdGVkKSB7XG4gICAgICAgICAgICAgICAgZGlhbG9nXG4gICAgICAgICAgICAgICAgICAgIC5nZXRXaW5kb3coKVxuICAgICAgICAgICAgICAgICAgICAuc2V0V2luZG93QW5pbWF0aW9ucyhhbmRyb2lkLlIuc3R5bGUuQW5pbWF0aW9uX0RpYWxvZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkaWFsb2cuc2V0Q2FuY2VsZWRPblRvdWNoT3V0c2lkZSh0aGlzLl9jYW5jZWxhYmxlKTtcbiAgICAgICAgICAgIHJldHVybiBkaWFsb2c7XG4gICAgICAgIH07XG4gICAgICAgIERpYWxvZ0ZyYWdtZW50SW1wbC5wcm90b3R5cGUub25DcmVhdGVWaWV3ID0gZnVuY3Rpb24gKGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIG93bmVyLl9zZXR1cEFzUm9vdFZpZXcodGhpcy5nZXRBY3Rpdml0eSgpKTtcbiAgICAgICAgICAgIG93bmVyLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBvd25lci5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9O1xuICAgICAgICBEaWFsb2dGcmFnbWVudEltcGwucHJvdG90eXBlLm9uU3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uU3RhcnQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9mdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdpbmRvd18xID0gdGhpcy5nZXREaWFsb2coKS5nZXRXaW5kb3coKTtcbiAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoXzEgPSBhbmRyb2lkLnZpZXcuVmlld0dyb3VwLkxheW91dFBhcmFtcy5NQVRDSF9QQVJFTlQ7XG4gICAgICAgICAgICAgICAgd2luZG93XzEuc2V0TGF5b3V0KGxlbmd0aF8xLCBsZW5ndGhfMSk7XG4gICAgICAgICAgICAgICAgd2luZG93XzEuc2V0QmFja2dyb3VuZERyYXdhYmxlKG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkNvbG9yRHJhd2FibGUoYW5kcm9pZC5ncmFwaGljcy5Db2xvci5XSElURSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChvd25lciAmJiAhb3duZXIuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBvd25lci5jYWxsTG9hZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zaG93bkNhbGxiYWNrKCk7XG4gICAgICAgIH07XG4gICAgICAgIERpYWxvZ0ZyYWdtZW50SW1wbC5wcm90b3R5cGUub25EaXNtaXNzID0gZnVuY3Rpb24gKGRpYWxvZykge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkRpc21pc3MuY2FsbCh0aGlzLCBkaWFsb2cpO1xuICAgICAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLmdldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgaWYgKG1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICByZW1vdmVNb2RhbCh0aGlzLm93bmVyLl9kb21JZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzbWlzc0NhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyICYmIG93bmVyLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERpYWxvZ0ZyYWdtZW50SW1wbC5wcm90b3R5cGUub25EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkRlc3Ryb3kuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG93bmVyLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgb3duZXIuX3RlYXJEb3duVUkodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBEaWFsb2dGcmFnbWVudEltcGw7XG4gICAgfShhbmRyb2lkeC5mcmFnbWVudC5hcHAuRGlhbG9nRnJhZ21lbnQpKTtcbiAgICBEaWFsb2dGcmFnbWVudCA9IERpYWxvZ0ZyYWdtZW50SW1wbDtcbn1cbmZ1bmN0aW9uIHNhdmVNb2RhbChvcHRpb25zKSB7XG4gICAgbW9kYWxNYXAuc2V0KG9wdGlvbnMub3duZXIuX2RvbUlkLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZU1vZGFsKGRvbUlkKSB7XG4gICAgbW9kYWxNYXAuZGVsZXRlKGRvbUlkKTtcbn1cbmZ1bmN0aW9uIGdldE1vZGFsT3B0aW9ucyhkb21JZCkge1xuICAgIHJldHVybiBtb2RhbE1hcC5nZXQoZG9tSWQpO1xufVxudmFyIFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVmlldy5wcm90b3R5cGUuX29ic2VydmUgPSBmdW5jdGlvbiAodHlwZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb2JzZXJ2ZS5jYWxsKHRoaXMsIHR5cGUsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2FkZWQgJiYgIXRoaXMudG91Y2hMaXN0ZW5lcklzU2V0KSB7XG4gICAgICAgICAgICB0aGlzLnNldE9uVG91Y2hMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uLmNhbGwodGhpcywgZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICB2YXIgaXNMYXlvdXRFdmVudCA9IHR5cGVvZiBldmVudE5hbWVzID09PSBcInN0cmluZ1wiID8gZXZlbnROYW1lcy5pbmRleE9mKHZpZXdfY29tbW9uXzEuVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQpICE9PSAtMSA6IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCAmJiAhdGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcklzU2V0ICYmIGlzTGF5b3V0RXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0T25MYXlvdXRDaGFuZ2VMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vZmYuY2FsbCh0aGlzLCBldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgIHZhciBpc0xheW91dEV2ZW50ID0gdHlwZW9mIGV2ZW50TmFtZXMgPT09IFwic3RyaW5nXCIgPyBldmVudE5hbWVzLmluZGV4T2Yodmlld19jb21tb25fMS5WaWV3Q29tbW9uLmxheW91dENoYW5nZWRFdmVudCkgIT09IC0xIDogZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGVkICYmIHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXJJc1NldCAmJiBpc0xheW91dEV2ZW50ICYmICF0aGlzLmhhc0xpc3RlbmVycyh2aWV3X2NvbW1vbl8xLlZpZXdDb21tb24ubGF5b3V0Q2hhbmdlZEV2ZW50KSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZU9uTGF5b3V0Q2hhbmdlTGlzdGVuZXIodGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcik7XG4gICAgICAgICAgICB0aGlzLmxheW91dENoYW5nZUxpc3RlbmVySXNTZXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX2dldENoaWxkRnJhZ21lbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9nZXRSb290RnJhZ21lbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3Jvb3RNYW5hZ2VyICYmIHRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jvb3RNYW5hZ2VyID0gdGhpcy5fY29udGV4dC5nZXRTdXBwb3J0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jvb3RNYW5hZ2VyO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX2dldEZyYWdtZW50TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9tYW5hZ2VyO1xuICAgICAgICBpZiAoIW1hbmFnZXIpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcztcbiAgICAgICAgICAgIHZhciBmcmFtZU9yVGFiVmlld0l0ZW1Gb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgd2hpbGUgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGlhbG9nRnJhZ21lbnQgPSB2aWV3Ll9kaWFsb2dGcmFnbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoZGlhbG9nRnJhZ21lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFuYWdlciA9IGRpYWxvZ0ZyYWdtZW50LmdldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmlldy5faGFzRnJhZ21lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcmFtZU9yVGFiVmlld0l0ZW1Gb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlciA9IHZpZXcuX2dldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmcmFtZU9yVGFiVmlld0l0ZW1Gb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZpZXcgPSB2aWV3LnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghbWFuYWdlcikge1xuICAgICAgICAgICAgICAgIG1hbmFnZXIgPSB0aGlzLl9nZXRSb290RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9tYW5hZ2VyID0gbWFuYWdlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWFuYWdlcjtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9tYW5hZ2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcm9vdE1hbmFnZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0T25Ub3VjaExpc3RlbmVyKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50b3VjaExpc3RlbmVySXNTZXQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRPblRvdWNoTGlzdGVuZXIobnVsbCk7XG4gICAgICAgICAgICB0aGlzLnRvdWNoTGlzdGVuZXJJc1NldCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldENsaWNrYWJsZSh0aGlzLl9pc0NsaWNrYWJsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWFuYWdlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jvb3RNYW5hZ2VyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vbkJhY2tQcmVzc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9wbW9zdEZyYW1lID0gZnJhbWVfc3RhY2tfMS50b3Btb3N0KCk7XG4gICAgICAgIGlmICh0b3Btb3N0RnJhbWUgJiYgdG9wbW9zdEZyYW1lLl9oYXNBbmNlc3RvclZpZXcodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiB0b3Btb3N0RnJhbWUub25CYWNrUHJlc3NlZCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmhhbmRsZUdlc3R1cmVUb3VjaCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX2dlc3R1cmVPYnNlcnZlcnMpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXTtcbiAgICAgICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYW5kcm9pZE9uVG91Y2hFdmVudChldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5oYW5kbGVHZXN0dXJlVG91Y2goZXZlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5oYXNHZXN0dXJlT2JzZXJ2ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2VzdHVyZU9ic2VydmVycyAmJiBPYmplY3Qua2V5cyh0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzKS5sZW5ndGggPiAwO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5faXNDbGlja2FibGUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaXNDbGlja2FibGUoKTtcbiAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKHZpZXdfY29tbW9uXzEuVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQpKSB7XG4gICAgICAgICAgICB0aGlzLnNldE9uTGF5b3V0Q2hhbmdlTGlzdGVuZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXJJc1NldCkge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lcklzU2V0ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlT25MYXlvdXRDaGFuZ2VMaXN0ZW5lcih0aGlzLmxheW91dENoYW5nZUxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuc2V0T25Ub3VjaExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCB8fCAhdGhpcy5oYXNHZXN0dXJlT2JzZXJ2ZXJzKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpbml0aWFsaXplVG91Y2hMaXN0ZW5lcigpO1xuICAgICAgICB0aGlzLnRvdWNoTGlzdGVuZXIgPSB0aGlzLnRvdWNoTGlzdGVuZXIgfHwgbmV3IFRvdWNoTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRPblRvdWNoTGlzdGVuZXIodGhpcy50b3VjaExpc3RlbmVyKTtcbiAgICAgICAgdGhpcy50b3VjaExpc3RlbmVySXNTZXQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldENsaWNrYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldENsaWNrYWJsZSh0aGlzLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnNldE9uTGF5b3V0Q2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBvd25lcl8xID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXJJc1NldCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmxheW91dENoYW5nZUxpc3RlbmVyID0gdGhpcy5sYXlvdXRDaGFuZ2VMaXN0ZW5lciB8fCBuZXcgYW5kcm9pZC52aWV3LlZpZXcuT25MYXlvdXRDaGFuZ2VMaXN0ZW5lcih7XG4gICAgICAgICAgICAgICAgb25MYXlvdXRDaGFuZ2U6IGZ1bmN0aW9uICh2LCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIG9sZExlZnQsIG9sZFRvcCwgb2xkUmlnaHQsIG9sZEJvdHRvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGVmdCAhPT0gb2xkTGVmdCB8fCB0b3AgIT09IG9sZFRvcCB8fCByaWdodCAhPT0gb2xkUmlnaHQgfHwgYm90dG9tICE9PSBvbGRCb3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyXzEuX3JhaXNlTGF5b3V0Q2hhbmdlZEV2ZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRPbkxheW91dENoYW5nZUxpc3RlbmVyKHRoaXMubGF5b3V0Q2hhbmdlTGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldy5wcm90b3R5cGUsIFwiaXNMYXlvdXRSZXF1aXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzTGF5b3V0VmFsaWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3LnByb3RvdHlwZSwgXCJpc0xheW91dFZhbGlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaXNMYXlvdXRSZXF1ZXN0ZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcucHJvdG90eXBlLCBcIl9oYXNGcmFnbWVudHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlldy5wcm90b3R5cGUubGF5b3V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheW91dChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUubWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm1lYXN1cmUuY2FsbCh0aGlzLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHRoaXMub25NZWFzdXJlKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sYXlvdXQuY2FsbCh0aGlzLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICB0aGlzLm9uTGF5b3V0KGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3Lm1lYXN1cmUod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih2aWV3LmdldE1lYXN1cmVkV2lkdGgoKSwgdmlldy5nZXRNZWFzdXJlZEhlaWdodCgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXROYXRpdmVWaWV3KGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9nZXRDdXJyZW50TGF5b3V0Qm91bmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmICF0aGlzLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRMZWZ0KCksXG4gICAgICAgICAgICAgICAgdG9wOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VG9wKCksXG4gICAgICAgICAgICAgICAgcmlnaHQ6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRSaWdodCgpLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldEJvdHRvbSgpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHsgbGVmdDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldE1lYXN1cmVkV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TWVhc3VyZWRXaWR0aCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmdldE1lYXN1cmVkV2lkdGguY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldE1lYXN1cmVkSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldE1lYXN1cmVkSGVpZ2h0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuZ2V0TWVhc3VyZWRIZWlnaHQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlcXVlc3RGb2N1cygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldExvY2F0aW9uSW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0V2luZG93VG9rZW4oKSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUoXCJpbnRcIiwgMik7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRMb2NhdGlvbkluV2luZG93KG5hdGl2ZUFycmF5KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMobmF0aXZlQXJyYXlbMF0pLFxuICAgICAgICAgICAgeTogdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhuYXRpdmVBcnJheVsxXSksXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5nZXRMb2NhdGlvbk9uU2NyZWVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCB8fCAhdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFdpbmRvd1Rva2VuKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKFwiaW50XCIsIDIpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TG9jYXRpb25PblNjcmVlbihuYXRpdmVBcnJheSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG5hdGl2ZUFycmF5WzBdKSxcbiAgICAgICAgICAgIHk6IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMobmF0aXZlQXJyYXlbMV0pLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TG9jYXRpb25SZWxhdGl2ZVRvID0gZnVuY3Rpb24gKG90aGVyVmlldykge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCB8fCAhdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFdpbmRvd1Rva2VuKCkgfHxcbiAgICAgICAgICAgICFvdGhlclZpZXcgfHwgIW90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICFvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRXaW5kb3dUb2tlbigpIHx8XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0V2luZG93VG9rZW4oKSAhPT0gb3RoZXJWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0V2luZG93VG9rZW4oKSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXlBcnJheSA9IEFycmF5LmNyZWF0ZShcImludFwiLCAyKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldExvY2F0aW9uT25TY3JlZW4obXlBcnJheSk7XG4gICAgICAgIHZhciBvdGhlckFycmF5ID0gQXJyYXkuY3JlYXRlKFwiaW50XCIsIDIpO1xuICAgICAgICBvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRMb2NhdGlvbk9uU2NyZWVuKG90aGVyQXJyYXkpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhteUFycmF5WzBdIC0gb3RoZXJBcnJheVswXSksXG4gICAgICAgICAgICB5OiB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG15QXJyYXlbMV0gLSBvdGhlckFycmF5WzFdKSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZSA9IGZ1bmN0aW9uIChzaXplLCBzcGVjU2l6ZSwgc3BlY01vZGUsIGNoaWxkTWVhc3VyZWRTdGF0ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gc2l6ZTtcbiAgICAgICAgc3dpdGNoIChzcGVjTW9kZSkge1xuICAgICAgICAgICAgY2FzZSB2aWV3X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBzaXplO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB2aWV3X2NvbW1vbl8xLmxheW91dC5BVF9NT1NUOlxuICAgICAgICAgICAgICAgIGlmIChzcGVjU2l6ZSA8IHNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gc3BlY1NpemUgfCB2aWV3X2NvbW1vbl8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9UT09fU01BTEw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB2aWV3X2NvbW1vbl8xLmxheW91dC5FWEFDVExZOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNwZWNTaXplO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQgfCAoY2hpbGRNZWFzdXJlZFN0YXRlICYgdmlld19jb21tb25fMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfTUFTSyk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fc2hvd05hdGl2ZU1vZGFsVmlldyA9IGZ1bmN0aW9uIChwYXJlbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2hvd05hdGl2ZU1vZGFsVmlldy5jYWxsKHRoaXMsIHBhcmVudCwgb3B0aW9ucyk7XG4gICAgICAgIGluaXRpYWxpemVEaWFsb2dGcmFnbWVudCgpO1xuICAgICAgICB2YXIgZGYgPSBuZXcgRGlhbG9nRnJhZ21lbnQoKTtcbiAgICAgICAgdmFyIGFyZ3MgPSBuZXcgYW5kcm9pZC5vcy5CdW5kbGUoKTtcbiAgICAgICAgYXJncy5wdXRJbnQoRE9NSUQsIHRoaXMuX2RvbUlkKTtcbiAgICAgICAgZGYuc2V0QXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICB2YXIgZGlhbG9nT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG93bmVyOiB0aGlzLFxuICAgICAgICAgICAgZnVsbHNjcmVlbjogISFvcHRpb25zLmZ1bGxzY3JlZW4sXG4gICAgICAgICAgICBhbmltYXRlZDogISFvcHRpb25zLmFuaW1hdGVkLFxuICAgICAgICAgICAgc3RyZXRjaGVkOiAhIW9wdGlvbnMuc3RyZXRjaGVkLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogb3B0aW9ucy5hbmRyb2lkID8gISFvcHRpb25zLmFuZHJvaWQuY2FuY2VsYWJsZSA6IHRydWUsXG4gICAgICAgICAgICBzaG93bkNhbGxiYWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fcmFpc2VTaG93bk1vZGFsbHlFdmVudCgpOyB9LFxuICAgICAgICAgICAgZGlzbWlzc0NhbGxiYWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5jbG9zZU1vZGFsKCk7IH1cbiAgICAgICAgfTtcbiAgICAgICAgc2F2ZU1vZGFsKGRpYWxvZ09wdGlvbnMpO1xuICAgICAgICB0aGlzLl9kaWFsb2dGcmFnbWVudCA9IGRmO1xuICAgICAgICB0aGlzLl9yYWlzZVNob3dpbmdNb2RhbGx5RXZlbnQoKTtcbiAgICAgICAgdGhpcy5fZGlhbG9nRnJhZ21lbnQuc2hvdyhwYXJlbnQuX2dldFJvb3RGcmFnbWVudE1hbmFnZXIoKSwgdGhpcy5fZG9tSWQudG9TdHJpbmcoKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5faGlkZU5hdGl2ZU1vZGFsVmlldyA9IGZ1bmN0aW9uIChwYXJlbnQsIHdoZW5DbG9zZWRDYWxsYmFjaykge1xuICAgICAgICB2YXIgbWFuYWdlciA9IHRoaXMuX2RpYWxvZ0ZyYWdtZW50LmdldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICBpZiAobWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5fZGlhbG9nRnJhZ21lbnQuZGlzbWlzc0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlhbG9nRnJhZ21lbnQgPSBudWxsO1xuICAgICAgICB3aGVuQ2xvc2VkQ2FsbGJhY2soKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuaXNFbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0RW5hYmxlZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLm9yaWdpblhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQaXZvdFgoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWdpblBvaW50LnNldFgodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLm9yaWdpbllQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQaXZvdFkoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLk9yaWdpblBvaW50LnNldFkodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmF1dG9tYXRpb25UZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q29udGVudERlc2NyaXB0aW9uKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmF1dG9tYXRpb25UZXh0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q29udGVudERlc2NyaXB0aW9uKHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q2xpY2thYmxlKHZhbHVlKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEZvY3VzYWJsZSh2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudmlzaWJpbGl0eVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlzaWJpbGl0eSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRWaXNpYmlsaXR5KCk7XG4gICAgICAgIHN3aXRjaCAobmF0aXZlVmlzaWJpbGl0eSkge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuVmlldy5WSVNJQkxFOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInZpc2libGVcIjtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImhpZGRlblwiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuVmlldy5HT05FOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImNvbGxhcHNlXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIGFuZHJvaWQudmlldy5WaWV3IHZpc2liaWxpdHk6IFwiICsgbmF0aXZlVmlzaWJpbGl0eSArIFwiLiBDdXJyZW50bHkgc3VwcG9ydGVkIHZhbHVlcyBhcmUgYW5kcm9pZC52aWV3LlZpZXcuVklTSUJMRSwgYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFLCBhbmRyb2lkLnZpZXcuVmlldy5HT05FLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnZpc2liaWxpdHlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ2aXNpYmxlXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuVklTSUJMRSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiaGlkZGVuXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuSU5WSVNJQkxFKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjb2xsYXBzZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LkdPTkUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZpc2liaWxpdHkgdmFsdWU6IFwiICsgdmFsdWUgKyBcIi4gVmFsaWQgdmFsdWVzIGFyZTogdmlzaWJsZSwgaGlkZGVuLCBjb2xsYXBzZS5cIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0QWxwaGEoKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0QWxwaGEoZmxvYXQodmFsdWUpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHRFbGV2YXRpb24oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoc2RrVmVyc2lvbigpIDwgMjEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2hTdGF0ZUxpc3RBbmltYXRvcigpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHREeW5hbWljRWxldmF0aW9uT2Zmc2V0KCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uKCkgPCAyMSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVmcmVzaFN0YXRlTGlzdEFuaW1hdG9yKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5nZXREZWZhdWx0RWxldmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2RrVmVyc2lvbigpIDwgMjEpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRFbGV2YXRpb24oKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5nZXREZWZhdWx0RHluYW1pY0VsZXZhdGlvbk9mZnNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5yZWZyZXNoU3RhdGVMaXN0QW5pbWF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgT2JqZWN0QW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvcjtcbiAgICAgICAgdmFyIEFuaW1hdG9yU2V0ID0gYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3JTZXQ7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9IG5hdGl2ZVZpZXcuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldEludGVnZXIoc2hvcnRBbmltVGltZSkgLyAyO1xuICAgICAgICB2YXIgZWxldmF0aW9uID0gdGhpcy5hbmRyb2lkRWxldmF0aW9uO1xuICAgICAgICBpZiAodHlwZW9mIGVsZXZhdGlvbiA9PT0gXCJ1bmRlZmluZWRcIiB8fCBlbGV2YXRpb24gPT09IG51bGwpIHtcbiAgICAgICAgICAgIGVsZXZhdGlvbiA9IHRoaXMuZ2V0RGVmYXVsdEVsZXZhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsZXZhdGlvbiA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGVsZXZhdGlvbik7XG4gICAgICAgIHZhciB6ID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoMCk7XG4gICAgICAgIHZhciBwcmVzc2VkWiA9IHRoaXMuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXQ7XG4gICAgICAgIGlmICh0eXBlb2YgcHJlc3NlZFogPT09IFwidW5kZWZpbmVkXCIgfHwgcHJlc3NlZFogPT09IG51bGwpIHtcbiAgICAgICAgICAgIHByZXNzZWRaID0gdGhpcy5nZXREZWZhdWx0RHluYW1pY0VsZXZhdGlvbk9mZnNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHByZXNzZWRaID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMocHJlc3NlZFopO1xuICAgICAgICB2YXIgcHJlc3NlZFNldCA9IG5ldyBBbmltYXRvclNldCgpO1xuICAgICAgICBwcmVzc2VkU2V0LnBsYXlUb2dldGhlcihqYXZhLnV0aWwuQXJyYXlzLmFzTGlzdChbXG4gICAgICAgICAgICBPYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwidHJhbnNsYXRpb25aXCIsIFtwcmVzc2VkWl0pXG4gICAgICAgICAgICAgICAgLnNldER1cmF0aW9uKGR1cmF0aW9uKSxcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJlbGV2YXRpb25cIiwgW2VsZXZhdGlvbl0pXG4gICAgICAgICAgICAgICAgLnNldER1cmF0aW9uKDApLFxuICAgICAgICBdKSk7XG4gICAgICAgIHZhciBub3RQcmVzc2VkU2V0ID0gbmV3IEFuaW1hdG9yU2V0KCk7XG4gICAgICAgIG5vdFByZXNzZWRTZXQucGxheVRvZ2V0aGVyKGphdmEudXRpbC5BcnJheXMuYXNMaXN0KFtcbiAgICAgICAgICAgIE9iamVjdEFuaW1hdG9yLm9mRmxvYXQobmF0aXZlVmlldywgXCJ0cmFuc2xhdGlvblpcIiwgW3pdKVxuICAgICAgICAgICAgICAgIC5zZXREdXJhdGlvbihkdXJhdGlvbiksXG4gICAgICAgICAgICBPYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwiZWxldmF0aW9uXCIsIFtlbGV2YXRpb25dKVxuICAgICAgICAgICAgICAgIC5zZXREdXJhdGlvbigwKSxcbiAgICAgICAgXSkpO1xuICAgICAgICB2YXIgZGVmYXVsdFNldCA9IG5ldyBBbmltYXRvclNldCgpO1xuICAgICAgICBkZWZhdWx0U2V0LnBsYXlUb2dldGhlcihqYXZhLnV0aWwuQXJyYXlzLmFzTGlzdChbXG4gICAgICAgICAgICBPYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwidHJhbnNsYXRpb25aXCIsIFswXSkuc2V0RHVyYXRpb24oMCksXG4gICAgICAgICAgICBPYmplY3RBbmltYXRvci5vZkZsb2F0KG5hdGl2ZVZpZXcsIFwiZWxldmF0aW9uXCIsIFswXSkuc2V0RHVyYXRpb24oMCksXG4gICAgICAgIF0pKTtcbiAgICAgICAgdmFyIHN0YXRlTGlzdEFuaW1hdG9yID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLlN0YXRlTGlzdEFuaW1hdG9yKCk7XG4gICAgICAgIHN0YXRlTGlzdEFuaW1hdG9yLmFkZFN0YXRlKFtzdGF0ZVByZXNzZWQsIHN0YXRlRW5hYmxlZF0sIHByZXNzZWRTZXQpO1xuICAgICAgICBzdGF0ZUxpc3RBbmltYXRvci5hZGRTdGF0ZShbc3RhdGVFbmFibGVkXSwgbm90UHJlc3NlZFNldCk7XG4gICAgICAgIHN0YXRlTGlzdEFuaW1hdG9yLmFkZFN0YXRlKFtdLCBkZWZhdWx0U2V0KTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRTdGF0ZUxpc3RBbmltYXRvcihzdGF0ZUxpc3RBbmltYXRvcik7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuZ2V0SG9yaXpvbnRhbEFsaWdubWVudCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbHAgPSBuYXRpdmVWaWV3LmdldExheW91dFBhcmFtcygpIHx8IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGlmIChscC5ncmF2aXR5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgICAgICBscC5ncmF2aXR5ID0gYW5kcm9pZC52aWV3LkdyYXZpdHkuTEVGVCB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuVkVSVElDQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLndlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLndlaWdodCA9IC0yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LkNFTlRFUl9IT1JJWk9OVEFMIHwgKGxwLmdyYXZpdHkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5WRVJUSUNBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAud2VpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAud2VpZ2h0ID0gLTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgICAgIGxwLmdyYXZpdHkgPSBhbmRyb2lkLnZpZXcuR3Jhdml0eS5SSUdIVCB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuVkVSVElDQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLndlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLndlaWdodCA9IC0yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJzdHJldGNoXCI6XG4gICAgICAgICAgICAgICAgICAgIGxwLmdyYXZpdHkgPSBhbmRyb2lkLnZpZXcuR3Jhdml0eS5GSUxMX0hPUklaT05UQUwgfCAobHAuZ3Jhdml0eSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LlZFUlRJQ0FMX0dSQVZJVFlfTUFTSyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChscC53ZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBscC53ZWlnaHQgPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5nZXRWZXJ0aWNhbEFsaWdubWVudCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxwID0gbmF0aXZlVmlldy5nZXRMYXlvdXRQYXJhbXMoKSB8fCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICBpZiAobHAuZ3Jhdml0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcInRvcFwiOlxuICAgICAgICAgICAgICAgICAgICBscC5ncmF2aXR5ID0gYW5kcm9pZC52aWV3LkdyYXZpdHkuVE9QIHwgKGxwLmdyYXZpdHkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5IT1JJWk9OVEFMX0dSQVZJVFlfTUFTSyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChscC5oZWlnaHQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBscC5oZWlnaHQgPSAtMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibWlkZGxlXCI6XG4gICAgICAgICAgICAgICAgICAgIGxwLmdyYXZpdHkgPSBhbmRyb2lkLnZpZXcuR3Jhdml0eS5DRU5URVJfVkVSVElDQUwgfCAobHAuZ3Jhdml0eSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LkhPUklaT05UQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLmhlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLmhlaWdodCA9IC0yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LkJPVFRPTSB8IChscC5ncmF2aXR5ICYgYW5kcm9pZC52aWV3LkdyYXZpdHkuSE9SSVpPTlRBTF9HUkFWSVRZX01BU0spO1xuICAgICAgICAgICAgICAgICAgICBpZiAobHAuaGVpZ2h0IDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbHAuaGVpZ2h0ID0gLTI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmV0Y2hcIjpcbiAgICAgICAgICAgICAgICAgICAgbHAuZ3Jhdml0eSA9IGFuZHJvaWQudmlldy5HcmF2aXR5LkZJTExfVkVSVElDQUwgfCAobHAuZ3Jhdml0eSAmIGFuZHJvaWQudmlldy5HcmF2aXR5LkhPUklaT05UQUxfR1JBVklUWV9NQVNLKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxwLmhlaWdodCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxwLmhlaWdodCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRSb3RhdGUodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBmbG9hdCh2YWx1ZSkpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0U2NhbGVYKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgZmxvYXQodmFsdWUpKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFNjYWxlWSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGZsb2F0KHZhbHVlKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0VHJhbnNsYXRlWCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHZhbHVlKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0VHJhbnNsYXRlWSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHZhbHVlKSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuekluZGV4UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnpJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0WkluZGV4KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmFsdWUpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGRyYXdhYmxlID0gbmF0aXZlVmlldy5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgICAgIGlmIChkcmF3YWJsZSkge1xuICAgICAgICAgICAgdmFyIGNvbnN0YW50U3RhdGUgPSBkcmF3YWJsZS5nZXRDb25zdGFudFN0YXRlKCk7XG4gICAgICAgICAgICBpZiAoY29uc3RhbnRTdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb25zdGFudFN0YXRlLm5ld0RyYXdhYmxlKG5hdGl2ZVZpZXcuZ2V0UmVzb3VyY2VzKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHJhd2FibGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRyYXdhYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEubWluV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCBpbnN0YW5jZW9mIEN1c3RvbUxheW91dFZpZXcgJiYgdGhpcy5wYXJlbnQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3NldENoaWxkTWluV2lkdGhOYXRpdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRNaW5XaWR0aE5hdGl2ZSh0aGlzLm1pbldpZHRoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLm1pbkhlaWdodFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50IGluc3RhbmNlb2YgQ3VzdG9tTGF5b3V0VmlldyAmJiB0aGlzLnBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fc2V0Q2hpbGRNaW5IZWlnaHROYXRpdmUodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRNaW5IZWlnaHROYXRpdmUodGhpcy5taW5IZWlnaHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBiYWNrZ3JvdW5kXzEuQmFja2dyb3VuZCkge1xuICAgICAgICAgICAgYmFja2dyb3VuZF8xLmFkLm9uQmFja2dyb3VuZE9yQm9yZGVyUHJvcGVydHlDaGFuZ2VkKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldEJhY2tncm91bmQodmFsdWUpO1xuICAgICAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5zdHlsZTtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nVG9wID0gdmlld19jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuaXNTZXQoc3R5bGUpID8gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wIDogdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3A7XG4gICAgICAgICAgICB2YXIgcGFkZGluZ1JpZ2h0ID0gdmlld19jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5pc1NldChzdHlsZSkgPyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA6IHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQ7XG4gICAgICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHZpZXdfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmlzU2V0KHN0eWxlKSA/IHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA6IHRoaXMuX2RlZmF1bHRQYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgdmFyIHBhZGRpbmdMZWZ0ID0gdmlld19jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LmlzU2V0KHN0eWxlKSA/IHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5faXNQYWRkaW5nUmVsYXRpdmUpIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFBhZGRpbmdSZWxhdGl2ZShwYWRkaW5nTGVmdCwgcGFkZGluZ1RvcCwgcGFkZGluZ1JpZ2h0LCBwYWRkaW5nQm90dG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0UGFkZGluZyhwYWRkaW5nTGVmdCwgcGFkZGluZ1RvcCwgcGFkZGluZ1JpZ2h0LCBwYWRkaW5nQm90dG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYmFja2dyb3VuZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5hbmRyb2lkQmFja1ByZXNzZWRFdmVudCA9IGFuZHJvaWRCYWNrUHJlc3NlZEV2ZW50O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlldy5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3LnByb3RvdHlwZSwgXCJvblVubG9hZGVkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlldy5wcm90b3R5cGUsIFwicmVxdWVzdExheW91dFwiLCBudWxsKTtcbiAgICByZXR1cm4gVmlldztcbn0odmlld19jb21tb25fMS5WaWV3Q29tbW9uKSk7XG5leHBvcnRzLlZpZXcgPSBWaWV3O1xudmFyIENvbnRhaW5lclZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb250YWluZXJWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENvbnRhaW5lclZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIENvbnRhaW5lclZpZXc7XG59KFZpZXcpKTtcbmV4cG9ydHMuQ29udGFpbmVyVmlldyA9IENvbnRhaW5lclZpZXc7XG52YXIgQ3VzdG9tTGF5b3V0VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEN1c3RvbUxheW91dFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3VzdG9tTGF5b3V0VmlldygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db250ZW50TGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKGF0SW5kZXggPT09IHZvaWQgMCkgeyBhdEluZGV4ID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7IH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICBpZiAodmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZSh0aGlzICsgXCIubmF0aXZlVmlldy5hZGRWaWV3KFwiICsgY2hpbGQgKyBcIi5uYXRpdmVWaWV3LCBcIiArIGF0SW5kZXggKyBcIilcIiwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVmlzdWFsVHJlZUV2ZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkVmlldyhjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkLCBhdEluZGV4KTtcbiAgICAgICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFZpZXcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVOYXRpdmVMYXlvdXRQYXJhbXMoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX3VwZGF0ZU5hdGl2ZUxheW91dFBhcmFtcyA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICB0aGlzLl9zZXRDaGlsZE1pbldpZHRoTmF0aXZlKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fc2V0Q2hpbGRNaW5IZWlnaHROYXRpdmUoY2hpbGQpO1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX3NldENoaWxkTWluV2lkdGhOYXRpdmUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY2hpbGQuX3NldE1pbldpZHRoTmF0aXZlKGNoaWxkLm1pbldpZHRoKTtcbiAgICB9O1xuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLl9zZXRDaGlsZE1pbkhlaWdodE5hdGl2ZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjaGlsZC5fc2V0TWluSGVpZ2h0TmF0aXZlKGNoaWxkLm1pbkhlaWdodCk7XG4gICAgfTtcbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBjaGlsZFZpZXcgPSBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyAmJiBjaGlsZFZpZXcpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcucmVtb3ZlVmlldyhjaGlsZFZpZXcpO1xuICAgICAgICAgICAgaWYgKHZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUobmF0aXZlVmlldyArIFwiLnJlbW92ZVZpZXcoXCIgKyBjaGlsZFZpZXcgKyBcIilcIiwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVmlzdWFsVHJlZUV2ZW50cyk7XG4gICAgICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZU5vdGlmeUV2ZW50KGNoaWxkLCBcImNoaWxkSW5MYXlvdXRSZW1vdmVkRnJvbU5hdGl2ZVZpc3VhbFRyZWVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBDdXN0b21MYXlvdXRWaWV3O1xufShDb250YWluZXJWaWV3KSk7XG5leHBvcnRzLkN1c3RvbUxheW91dFZpZXcgPSBDdXN0b21MYXlvdXRWaWV3O1xudmFyIHBlcmNlbnROb3RTdXBwb3J0ZWQgPSBmdW5jdGlvbiAodmlldywgdmFsdWUpIHsgdGhyb3cgbmV3IEVycm9yKFwiUGVyY2VudExlbmd0aCBpcyBub3Qgc3VwcG9ydGVkLlwiKTsgfTtcbmZ1bmN0aW9uIGNyZWF0ZU5hdGl2ZVBlcmNlbnRMZW5ndGhQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgdmFyIGdldHRlciA9IG9wdGlvbnMuZ2V0dGVyLCBzZXR0ZXIgPSBvcHRpb25zLnNldHRlciwgX2EgPSBvcHRpb25zLmF1dG8sIGF1dG8gPSBfYSA9PT0gdm9pZCAwID8gMCA6IF9hO1xuICAgIHZhciBzZXRQaXhlbHMsIGdldFBpeGVscywgc2V0UGVyY2VudDtcbiAgICBpZiAoZ2V0dGVyKSB7XG4gICAgICAgIFZpZXcucHJvdG90eXBlW2dldHRlcl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHNldFBpeGVscyA9IG9wdGlvbnMuc2V0UGl4ZWxzO1xuICAgICAgICAgICAgICAgIGdldFBpeGVscyA9IG9wdGlvbnMuZ2V0UGl4ZWxzO1xuICAgICAgICAgICAgICAgIHNldFBlcmNlbnQgPSBvcHRpb25zLnNldFBlcmNlbnQgfHwgcGVyY2VudE5vdFN1cHBvcnRlZDtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGdldFBpeGVscyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09IGF1dG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogdmFsdWUsIHVuaXQ6IFwicHhcIiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBpZiAoc2V0dGVyKSB7XG4gICAgICAgIFZpZXcucHJvdG90eXBlW3NldHRlcl0gPSBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucykge1xuICAgICAgICAgICAgICAgIHNldFBpeGVscyA9IG9wdGlvbnMuc2V0UGl4ZWxzO1xuICAgICAgICAgICAgICAgIGdldFBpeGVscyA9IG9wdGlvbnMuZ2V0UGl4ZWxzO1xuICAgICAgICAgICAgICAgIHNldFBlcmNlbnQgPSBvcHRpb25zLnNldFBlcmNlbnQgfHwgcGVyY2VudE5vdFN1cHBvcnRlZDtcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZW5ndGggPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgICAgICBzZXRQaXhlbHModGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBhdXRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBsZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgICAgICBzZXRQaXhlbHModGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsZW5ndGgudW5pdCA9PSBcImRpcFwiKSB7XG4gICAgICAgICAgICAgICAgc2V0UGl4ZWxzKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMobGVuZ3RoLnZhbHVlKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobGVuZ3RoLnVuaXQgPT0gXCJweFwiKSB7XG4gICAgICAgICAgICAgICAgc2V0UGl4ZWxzKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdmlld19jb21tb25fMS5sYXlvdXQucm91bmQobGVuZ3RoLnZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChsZW5ndGgudW5pdCA9PSBcIiVcIikge1xuICAgICAgICAgICAgICAgIHNldFBlcmNlbnQodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBsZW5ndGgudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgUGVyY2VudExlbmd0aCBcIiArIGxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxufVxuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS5tYXJnaW5Ub3BQcm9wZXJ0eS5zZXROYXRpdmUsXG4gICAgZ2V0IHNldFBpeGVscygpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpblRvcDsgfSxcbiAgICBnZXQgc2V0UGVyY2VudCgpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpblRvcFBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS5tYXJnaW5SaWdodFByb3BlcnR5LnNldE5hdGl2ZSxcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luUmlnaHQ7IH0sXG4gICAgZ2V0IHNldFBlcmNlbnQoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRNYXJnaW5SaWdodFBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS5tYXJnaW5Cb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmUsXG4gICAgZ2V0IHNldFBpeGVscygpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpbkJvdHRvbTsgfSxcbiAgICBnZXQgc2V0UGVyY2VudCgpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1hcmdpbkJvdHRvbVBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS5tYXJnaW5MZWZ0UHJvcGVydHkuc2V0TmF0aXZlLFxuICAgIGdldCBzZXRQaXhlbHMoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRNYXJnaW5MZWZ0OyB9LFxuICAgIGdldCBzZXRQZXJjZW50KCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWFyZ2luTGVmdFBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5LnNldE5hdGl2ZSxcbiAgICBhdXRvOiAtMSxcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0V2lkdGg7IH0sXG4gICAgZ2V0IHNldFBlcmNlbnQoKSB7IHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRXaWR0aFBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IHN0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5zZXROYXRpdmUsXG4gICAgYXV0bzogLTEsXG4gICAgZ2V0IHNldFBpeGVscygpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldEhlaWdodDsgfSxcbiAgICBnZXQgc2V0UGVyY2VudCgpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldEhlaWdodFBlcmNlbnQ7IH1cbn0pO1xuY3JlYXRlTmF0aXZlUGVyY2VudExlbmd0aFByb3BlcnR5KHtcbiAgICBzZXR0ZXI6IFwiX3NldE1pbldpZHRoTmF0aXZlXCIsXG4gICAgZ2V0IHNldFBpeGVscygpIHsgcmV0dXJuIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldE1pbldpZHRoOyB9XG59KTtcbmNyZWF0ZU5hdGl2ZVBlcmNlbnRMZW5ndGhQcm9wZXJ0eSh7XG4gICAgc2V0dGVyOiBcIl9zZXRNaW5IZWlnaHROYXRpdmVcIixcbiAgICBnZXQgc2V0UGl4ZWxzKCkgeyByZXR1cm4gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0TWluSGVpZ2h0OyB9XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaGFuZGxlcnNGb3JFdmVudE5hbWUgPSBuZXcgTWFwKCk7XG52YXIgc291cmNlc01hcCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgVGFyZ2V0SGFuZGxlclBhaXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRhcmdldEhhbmRsZXJQYWlyKHRhcmdldCwgaGFuZGxlcikge1xuICAgICAgICB0aGlzLnRhZ2V0UmVmID0gbmV3IFdlYWtSZWYodGFyZ2V0KTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlcjtcbiAgICB9XG4gICAgcmV0dXJuIFRhcmdldEhhbmRsZXJQYWlyO1xufSgpKTtcbmZ1bmN0aW9uIGdldEhhbmRsZXJGb3JFdmVudE5hbWUoZXZlbnROYW1lKSB7XG4gICAgdmFyIGhhbmRsZXIgPSBoYW5kbGVyc0ZvckV2ZW50TmFtZS5nZXQoZXZlbnROYW1lKTtcbiAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgaGFuZGxlciA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldmVudERhdGEub2JqZWN0O1xuICAgICAgICAgICAgdmFyIHNvdXJjZUV2ZW50TWFwID0gc291cmNlc01hcC5nZXQoc291cmNlKTtcbiAgICAgICAgICAgIGlmICghc291cmNlRXZlbnRNYXApIHtcbiAgICAgICAgICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgICAgICAgICBpZiAoIXRhcmdldEhhbmRsZXJQYWlyTGlzdCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWFkUGFpcnNJbmRleGVzID0gW107XG4gICAgICAgICAgICB2YXIgcGFpcjtcbiAgICAgICAgICAgIHZhciB0YXJnZXQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhaXIgPSB0YXJnZXRIYW5kbGVyUGFpckxpc3RbaV07XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGFpci50YWdldFJlZi5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhaXIuaGFuZGxlci5jYWxsKHRhcmdldCwgZXZlbnREYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYWRQYWlyc0luZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGVhZFBhaXJzSW5kZXhlcy5sZW5ndGggPT09IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VFdmVudE1hcC5kZWxldGUoZXZlbnROYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBkZWFkUGFpcnNJbmRleGVzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEhhbmRsZXJQYWlyTGlzdC5zcGxpY2UoZGVhZFBhaXJzSW5kZXhlc1tqXSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBoYW5kbGVyc0ZvckV2ZW50TmFtZS5zZXQoZXZlbnROYW1lLCBoYW5kbGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGhhbmRsZXI7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCkge1xuICAgIGlmICghc291cmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInNvdXJjZSBpcyBudWxsIG9yIHVuZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGFyZ2V0IGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGV2ZW50TmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJldmVudE5hbWUgaXMgbm90IGEgc3RyaW5nXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJoYW5kbGVyIGlzIG5vdCBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZFdlYWtFdmVudExpc3RlbmVyKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpIHtcbiAgICB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCk7XG4gICAgdmFyIHNob3VsZEF0dGFjaCA9IGZhbHNlO1xuICAgIHZhciBzb3VyY2VFdmVudE1hcCA9IHNvdXJjZXNNYXAuZ2V0KHNvdXJjZSk7XG4gICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICBzb3VyY2VFdmVudE1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgc291cmNlc01hcC5zZXQoc291cmNlLCBzb3VyY2VFdmVudE1hcCk7XG4gICAgICAgIHNob3VsZEF0dGFjaCA9IHRydWU7XG4gICAgfVxuICAgIHZhciBwYWlyTGlzdCA9IHNvdXJjZUV2ZW50TWFwLmdldChldmVudE5hbWUpO1xuICAgIGlmICghcGFpckxpc3QpIHtcbiAgICAgICAgcGFpckxpc3QgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgc291cmNlRXZlbnRNYXAuc2V0KGV2ZW50TmFtZSwgcGFpckxpc3QpO1xuICAgICAgICBzaG91bGRBdHRhY2ggPSB0cnVlO1xuICAgIH1cbiAgICBwYWlyTGlzdC5wdXNoKG5ldyBUYXJnZXRIYW5kbGVyUGFpcih0YXJnZXQsIGhhbmRsZXIpKTtcbiAgICBpZiAoc2hvdWxkQXR0YWNoKSB7XG4gICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZ2V0SGFuZGxlckZvckV2ZW50TmFtZShldmVudE5hbWUpKTtcbiAgICB9XG59XG5leHBvcnRzLmFkZFdlYWtFdmVudExpc3RlbmVyID0gYWRkV2Vha0V2ZW50TGlzdGVuZXI7XG5mdW5jdGlvbiByZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KSB7XG4gICAgdmFsaWRhdGVBcmdzKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpO1xuICAgIHZhciBoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSA9IGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpO1xuICAgIGlmICghaGFuZGxlckZvckV2ZW50V2l0aE5hbWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc291cmNlRXZlbnRNYXAgPSBzb3VyY2VzTWFwLmdldChzb3VyY2UpO1xuICAgIGlmICghc291cmNlRXZlbnRNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCF0YXJnZXRIYW5kbGVyUGFpckxpc3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUgPSBbXTtcbiAgICB2YXIgcGFpcjtcbiAgICB2YXIgcmVnaXN0ZXJlZFRhcmdldDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBwYWlyID0gdGFyZ2V0SGFuZGxlclBhaXJMaXN0W2ldO1xuICAgICAgICByZWdpc3RlcmVkVGFyZ2V0ID0gcGFpci50YWdldFJlZi5nZXQoKTtcbiAgICAgICAgaWYgKCFyZWdpc3RlcmVkVGFyZ2V0IHx8IChyZWdpc3RlcmVkVGFyZ2V0ID09PSB0YXJnZXQgJiYgaGFuZGxlciA9PT0gcGFpci5oYW5kbGVyKSkge1xuICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUucHVzaChpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUubGVuZ3RoID09PSB0YXJnZXRIYW5kbGVyUGFpckxpc3QubGVuZ3RoKSB7XG4gICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlckZvckV2ZW50V2l0aE5hbWUpO1xuICAgICAgICBzb3VyY2VFdmVudE1hcC5kZWxldGUoZXZlbnROYW1lKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGogPSB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJMaXN0LnNwbGljZSh0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZVtqXSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyID0gcmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWFrLWV2ZW50LWxpc3RlbmVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIGRlZmF1bHREYXRlID0gbmV3IERhdGUoKTtcbnZhciBkYXRlQ29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPD0geSAmJiB4ID49IHkpOyB9O1xudmFyIERhdGVQaWNrZXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRGF0ZVBpY2tlckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGF0ZVBpY2tlckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRGF0ZVBpY2tlckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJEYXRlUGlja2VyXCIpXG4gICAgXSwgRGF0ZVBpY2tlckJhc2UpO1xuICAgIHJldHVybiBEYXRlUGlja2VyQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuRGF0ZVBpY2tlckJhc2UgPSBEYXRlUGlja2VyQmFzZTtcbkRhdGVQaWNrZXJCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy55ZWFyUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInllYXJcIixcbiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHREYXRlLmdldEZ1bGxZZWFyKCksXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbn0pO1xuZXhwb3J0cy55ZWFyUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tb250aFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtb250aFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUuZ2V0TW9udGgoKSArIDEsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbn0pO1xuZXhwb3J0cy5tb250aFByb3BlcnR5LnJlZ2lzdGVyKERhdGVQaWNrZXJCYXNlKTtcbmV4cG9ydHMuZGF5UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRheVwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUuZ2V0RGF0ZSgpLFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH0sXG59KTtcbmV4cG9ydHMuZGF5UHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tYXhEYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heERhdGVcIixcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBkYXRlQ29tcGFyZXIsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgRGF0ZSh2KTsgfSxcbn0pO1xuZXhwb3J0cy5tYXhEYXRlUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5taW5EYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbkRhdGVcIixcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBkYXRlQ29tcGFyZXIsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgRGF0ZSh2KTsgfSxcbn0pO1xuZXhwb3J0cy5taW5EYXRlUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5kYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRhdGVcIixcbiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHREYXRlLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGRhdGVDb21wYXJlcixcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBEYXRlKHYpOyB9LFxufSk7XG5leHBvcnRzLmRhdGVQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRlLXBpY2tlci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkYXRlX3BpY2tlcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2RhdGUtcGlja2VyLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2RhdGUtcGlja2VyLWNvbW1vblwiKSk7XG52YXIgRGF0ZUNoYW5nZWRMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVEYXRlQ2hhbmdlZExpc3RlbmVyKCkge1xuICAgIGlmIChEYXRlQ2hhbmdlZExpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIERhdGVDaGFuZ2VkTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKERhdGVDaGFuZ2VkTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBEYXRlQ2hhbmdlZExpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBEYXRlQ2hhbmdlZExpc3RlbmVySW1wbC5wcm90b3R5cGUub25EYXRlQ2hhbmdlZCA9IGZ1bmN0aW9uIChwaWNrZXIsIHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICB2YXIgZGF0ZUNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh5ZWFyICE9PSBvd25lci55ZWFyKSB7XG4gICAgICAgICAgICAgICAgZGF0ZV9waWNrZXJfY29tbW9uXzEueWVhclByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCB5ZWFyKTtcbiAgICAgICAgICAgICAgICBkYXRlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW9udGggIT09IChvd25lci5tb250aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgZGF0ZV9waWNrZXJfY29tbW9uXzEubW9udGhQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgbW9udGggKyAxKTtcbiAgICAgICAgICAgICAgICBkYXRlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF5ICE9PSBvd25lci5kYXkpIHtcbiAgICAgICAgICAgICAgICBkYXRlX3BpY2tlcl9jb21tb25fMS5kYXlQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgZGF5KTtcbiAgICAgICAgICAgICAgICBkYXRlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGF0ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBkYXRlX3BpY2tlcl9jb21tb25fMS5kYXRlUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQud2lkZ2V0LkRhdGVQaWNrZXIuT25EYXRlQ2hhbmdlZExpc3RlbmVyXSlcbiAgICAgICAgXSwgRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gRGF0ZUNoYW5nZWRMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgRGF0ZUNoYW5nZWRMaXN0ZW5lciA9IERhdGVDaGFuZ2VkTGlzdGVuZXJJbXBsO1xufVxudmFyIERhdGVQaWNrZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEYXRlUGlja2VyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERhdGVQaWNrZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBpY2tlciA9IG5ldyBhbmRyb2lkLndpZGdldC5EYXRlUGlja2VyKHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBwaWNrZXIuc2V0Q2FsZW5kYXJWaWV3U2hvd24oZmFsc2UpO1xuICAgICAgICByZXR1cm4gcGlja2VyO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaW5pdGlhbGl6ZURhdGVDaGFuZ2VkTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IG5ldyBEYXRlQ2hhbmdlZExpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LmluaXQodGhpcy55ZWFyLCB0aGlzLm1vbnRoIC0gMSwgdGhpcy5kYXksIGxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5saXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlLnVwZGF0ZU5hdGl2ZURhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgeWVhciA9IHR5cGVvZiB0aGlzLnllYXIgPT09IFwibnVtYmVyXCIgPyB0aGlzLnllYXIgOiBuYXRpdmVWaWV3LmdldFllYXIoKTtcbiAgICAgICAgdmFyIG1vbnRoID0gdHlwZW9mIHRoaXMubW9udGggPT09IFwibnVtYmVyXCIgPyB0aGlzLm1vbnRoIC0gMSA6IG5hdGl2ZVZpZXcuZ2V0TW9udGgoKTtcbiAgICAgICAgdmFyIGRheSA9IHR5cGVvZiB0aGlzLmRheSA9PT0gXCJudW1iZXJcIiA/IHRoaXMuZGF5IDogbmF0aXZlVmlldy5nZXREYXlPZk1vbnRoKCk7XG4gICAgICAgIHRoaXMuZGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEueWVhclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRZZWFyKCkgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU5hdGl2ZURhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEubW9udGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TW9udGgoKSAhPT0gKHZhbHVlIC0gMSkpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTmF0aXZlRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5kYXlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0RGF5T2ZNb250aCgpICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVEYXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLmRhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldy5nZXREYXlPZk1vbnRoKCkgIT09IHZhbHVlLmdldERhdGUoKVxuICAgICAgICAgICAgfHwgbmF0aXZlVmlldy5nZXRNb250aCgpICE9PSB2YWx1ZS5nZXRNb250aCgpXG4gICAgICAgICAgICB8fCBuYXRpdmVWaWV3LmdldFllYXIoKSAhPT0gdmFsdWUuZ2V0RnVsbFllYXIoKSkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy51cGRhdGVEYXRlKHZhbHVlLmdldEZ1bGxZZWFyKCksIHZhbHVlLmdldE1vbnRoKCksIHZhbHVlLmdldERhdGUoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1heERhdGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRNYXhEYXRlKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5tYXhEYXRlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSB2YWx1ZSBpbnN0YW5jZW9mIERhdGUgPyB2YWx1ZS5nZXRUaW1lKCkgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldE1heERhdGUobmV3VmFsdWUpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEubWluRGF0ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldE1pbkRhdGUoKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1pbkRhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IHZhbHVlIGluc3RhbmNlb2YgRGF0ZSA/IHZhbHVlLmdldFRpbWUoKSA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TWluRGF0ZShuZXdWYWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gRGF0ZVBpY2tlcjtcbn0oZGF0ZV9waWNrZXJfY29tbW9uXzEuRGF0ZVBpY2tlckJhc2UpKTtcbmV4cG9ydHMuRGF0ZVBpY2tlciA9IERhdGVQaWNrZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRlLXBpY2tlci5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG5leHBvcnRzLlNUUklORyA9IFwic3RyaW5nXCI7XG5leHBvcnRzLlBST01QVCA9IFwiUHJvbXB0XCI7XG5leHBvcnRzLkNPTkZJUk0gPSBcIkNvbmZpcm1cIjtcbmV4cG9ydHMuQUxFUlQgPSBcIkFsZXJ0XCI7XG5leHBvcnRzLkxPR0lOID0gXCJMb2dpblwiO1xuZXhwb3J0cy5PSyA9IFwiT0tcIjtcbmV4cG9ydHMuQ0FOQ0VMID0gXCJDYW5jZWxcIjtcbnZhciBpbnB1dFR5cGU7XG4oZnVuY3Rpb24gKGlucHV0VHlwZSkge1xuICAgIGlucHV0VHlwZS50ZXh0ID0gXCJ0ZXh0XCI7XG4gICAgaW5wdXRUeXBlLnBhc3N3b3JkID0gXCJwYXNzd29yZFwiO1xuICAgIGlucHV0VHlwZS5lbWFpbCA9IFwiZW1haWxcIjtcbiAgICBpbnB1dFR5cGUubnVtYmVyID0gXCJudW1iZXJcIjtcbiAgICBpbnB1dFR5cGUuZGVjaW1hbCA9IFwiZGVjaW1hbFwiO1xuICAgIGlucHV0VHlwZS5waG9uZSA9IFwicGhvbmVcIjtcbn0pKGlucHV0VHlwZSA9IGV4cG9ydHMuaW5wdXRUeXBlIHx8IChleHBvcnRzLmlucHV0VHlwZSA9IHt9KSk7XG52YXIgY2FwaXRhbGl6YXRpb25UeXBlO1xuKGZ1bmN0aW9uIChjYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICBjYXBpdGFsaXphdGlvblR5cGUubm9uZSA9IFwibm9uZVwiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5hbGwgPSBcImFsbFwiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5zZW50ZW5jZXMgPSBcInNlbnRlbmNlc1wiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS53b3JkcyA9IFwid29yZHNcIjtcbn0pKGNhcGl0YWxpemF0aW9uVHlwZSA9IGV4cG9ydHMuY2FwaXRhbGl6YXRpb25UeXBlIHx8IChleHBvcnRzLmNhcGl0YWxpemF0aW9uVHlwZSA9IHt9KSk7XG52YXIgZnJhbWU7XG5mdW5jdGlvbiBnZXRDdXJyZW50UGFnZSgpIHtcbiAgICBpZiAoIWZyYW1lKSB7XG4gICAgICAgIGZyYW1lID0gcmVxdWlyZShcIi4uL2ZyYW1lXCIpO1xuICAgIH1cbiAgICB2YXIgdG9wbW9zdEZyYW1lID0gZnJhbWUudG9wbW9zdCgpO1xuICAgIGlmICh0b3Btb3N0RnJhbWUpIHtcbiAgICAgICAgcmV0dXJuIHRvcG1vc3RGcmFtZS5jdXJyZW50UGFnZTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZ2V0Q3VycmVudFBhZ2UgPSBnZXRDdXJyZW50UGFnZTtcbmZ1bmN0aW9uIGFwcGx5U2VsZWN0b3JzKHZpZXcsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGN1cnJlbnRQYWdlID0gZ2V0Q3VycmVudFBhZ2UoKTtcbiAgICBpZiAoY3VycmVudFBhZ2UpIHtcbiAgICAgICAgdmFyIHN0eWxlU2NvcGUgPSBjdXJyZW50UGFnZS5fc3R5bGVTY29wZTtcbiAgICAgICAgaWYgKHN0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHZpZXcuX2luaGVyaXRTdHlsZVNjb3BlKHN0eWxlU2NvcGUpO1xuICAgICAgICAgICAgdmlldy5vbkxvYWRlZCgpO1xuICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgICAgICB2aWV3Lm9uVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbnZhciBidXR0b247XG52YXIgbGFiZWw7XG52YXIgdGV4dEZpZWxkO1xuZnVuY3Rpb24gZ2V0QnV0dG9uQ29sb3JzKCkge1xuICAgIGlmICghYnV0dG9uKSB7XG4gICAgICAgIHZhciBCdXR0b24gPSByZXF1aXJlKFwiLi4vYnV0dG9uXCIpLkJ1dHRvbjtcbiAgICAgICAgYnV0dG9uID0gbmV3IEJ1dHRvbjtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGJ1dHRvbkNvbG9yO1xuICAgIHZhciBidXR0b25CYWNrZ3JvdW5kQ29sb3I7XG4gICAgYXBwbHlTZWxlY3RvcnMoYnV0dG9uLCBmdW5jdGlvbiAoYnRuKSB7XG4gICAgICAgIGJ1dHRvbkNvbG9yID0gYnRuLmNvbG9yO1xuICAgICAgICBidXR0b25CYWNrZ3JvdW5kQ29sb3IgPSBidG4uYmFja2dyb3VuZENvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiB7IGNvbG9yOiBidXR0b25Db2xvciwgYmFja2dyb3VuZENvbG9yOiBidXR0b25CYWNrZ3JvdW5kQ29sb3IgfTtcbn1cbmV4cG9ydHMuZ2V0QnV0dG9uQ29sb3JzID0gZ2V0QnV0dG9uQ29sb3JzO1xuZnVuY3Rpb24gZ2V0TGFiZWxDb2xvcigpIHtcbiAgICBpZiAoIWxhYmVsKSB7XG4gICAgICAgIHZhciBMYWJlbCA9IHJlcXVpcmUoXCIuLi9sYWJlbFwiKS5MYWJlbDtcbiAgICAgICAgbGFiZWwgPSBuZXcgTGFiZWw7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICBsYWJlbC5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGxhYmVsQ29sb3I7XG4gICAgYXBwbHlTZWxlY3RvcnMobGFiZWwsIGZ1bmN0aW9uIChsYmwpIHtcbiAgICAgICAgbGFiZWxDb2xvciA9IGxibC5jb2xvcjtcbiAgICB9KTtcbiAgICByZXR1cm4gbGFiZWxDb2xvcjtcbn1cbmV4cG9ydHMuZ2V0TGFiZWxDb2xvciA9IGdldExhYmVsQ29sb3I7XG5mdW5jdGlvbiBnZXRUZXh0RmllbGRDb2xvcigpIHtcbiAgICBpZiAoIXRleHRGaWVsZCkge1xuICAgICAgICB2YXIgVGV4dEZpZWxkID0gcmVxdWlyZShcIi4uL3RleHQtZmllbGRcIikuVGV4dEZpZWxkO1xuICAgICAgICB0ZXh0RmllbGQgPSBuZXcgVGV4dEZpZWxkKCk7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICB0ZXh0RmllbGQuX3NldHVwVUkoe30pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB0ZXh0RmllbGRDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyh0ZXh0RmllbGQsIGZ1bmN0aW9uICh0Zikge1xuICAgICAgICB0ZXh0RmllbGRDb2xvciA9IHRmLmNvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiB0ZXh0RmllbGRDb2xvcjtcbn1cbmV4cG9ydHMuZ2V0VGV4dEZpZWxkQ29sb3IgPSBnZXRUZXh0RmllbGRDb2xvcjtcbmZ1bmN0aW9uIGlzRGlhbG9nT3B0aW9ucyhhcmcpIHtcbiAgICByZXR1cm4gYXJnICYmIChhcmcubWVzc2FnZSB8fCBhcmcudGl0bGUpO1xufVxuZXhwb3J0cy5pc0RpYWxvZ09wdGlvbnMgPSBpc0RpYWxvZ09wdGlvbnM7XG5mdW5jdGlvbiBwYXJzZUxvZ2luT3B0aW9ucyhhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIHR5cGVzXzEuaXNPYmplY3QoYXJnc1swXSkpIHtcbiAgICAgICAgcmV0dXJuIGFyZ3NbMF07XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0geyB0aXRsZTogZXhwb3J0cy5MT0dJTiwgb2tCdXR0b25UZXh0OiBleHBvcnRzLk9LLCBjYW5jZWxCdXR0b25UZXh0OiBleHBvcnRzLkNBTkNFTCB9O1xuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbMF0pKSB7XG4gICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3NbMF07XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbMV0pKSB7XG4gICAgICAgIG9wdGlvbnMudXNlck5hbWVIaW50ID0gYXJnc1sxXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1syXSkpIHtcbiAgICAgICAgb3B0aW9ucy5wYXNzd29yZEhpbnQgPSBhcmdzWzJdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzNdKSkge1xuICAgICAgICBvcHRpb25zLnVzZXJOYW1lID0gYXJnc1szXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1s0XSkpIHtcbiAgICAgICAgb3B0aW9ucy5wYXNzd29yZCA9IGFyZ3NbNF07XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xufVxuZXhwb3J0cy5wYXJzZUxvZ2luT3B0aW9ucyA9IHBhcnNlTG9naW5PcHRpb25zO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGlhbG9ncy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkaWFsb2dzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZGlhbG9ncy1jb21tb25cIik7XG52YXIgYXBwbGljYXRpb25fMSA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2RpYWxvZ3MtY29tbW9uXCIpKTtcbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIjtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUFsZXJ0RGlhbG9nKG9wdGlvbnMpIHtcbiAgICB2YXIgYWxlcnQgPSBuZXcgYW5kcm9pZC5hcHAuQWxlcnREaWFsb2cuQnVpbGRlcihhcHBsaWNhdGlvbl8xLmFuZHJvaWQuZm9yZWdyb3VuZEFjdGl2aXR5KTtcbiAgICBhbGVydC5zZXRUaXRsZShvcHRpb25zICYmIGlzU3RyaW5nKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6IFwiXCIpO1xuICAgIGFsZXJ0LnNldE1lc3NhZ2Uob3B0aW9ucyAmJiBpc1N0cmluZyhvcHRpb25zLm1lc3NhZ2UpID8gb3B0aW9ucy5tZXNzYWdlIDogXCJcIik7XG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5jYW5jZWxhYmxlID09PSBmYWxzZSkge1xuICAgICAgICBhbGVydC5zZXRDYW5jZWxhYmxlKGZhbHNlKTtcbiAgICB9XG4gICAgcmV0dXJuIGFsZXJ0O1xufVxuZnVuY3Rpb24gc2hvd0RpYWxvZyhidWlsZGVyKSB7XG4gICAgdmFyIGRsZyA9IGJ1aWxkZXIuc2hvdygpO1xuICAgIHZhciBsYWJlbENvbG9yID0gZGlhbG9nc19jb21tb25fMS5nZXRMYWJlbENvbG9yKCk7XG4gICAgaWYgKGxhYmVsQ29sb3IpIHtcbiAgICAgICAgdmFyIHRleHRWaWV3SWQgPSBkbGcuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldElkZW50aWZpZXIoXCJhbmRyb2lkOmlkL2FsZXJ0VGl0bGVcIiwgbnVsbCwgbnVsbCk7XG4gICAgICAgIGlmICh0ZXh0Vmlld0lkKSB7XG4gICAgICAgICAgICB2YXIgdHYgPSBkbGcuZmluZFZpZXdCeUlkKHRleHRWaWV3SWQpO1xuICAgICAgICAgICAgaWYgKHR2KSB7XG4gICAgICAgICAgICAgICAgdHYuc2V0VGV4dENvbG9yKGxhYmVsQ29sb3IuYW5kcm9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lc3NhZ2VUZXh0Vmlld0lkID0gZGxnLmdldENvbnRleHQoKS5nZXRSZXNvdXJjZXMoKS5nZXRJZGVudGlmaWVyKFwiYW5kcm9pZDppZC9tZXNzYWdlXCIsIG51bGwsIG51bGwpO1xuICAgICAgICBpZiAobWVzc2FnZVRleHRWaWV3SWQpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlVGV4dFZpZXcgPSBkbGcuZmluZFZpZXdCeUlkKG1lc3NhZ2VUZXh0Vmlld0lkKTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlVGV4dFZpZXcpIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dFZpZXcuc2V0VGV4dENvbG9yKGxhYmVsQ29sb3IuYW5kcm9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIF9hID0gZGlhbG9nc19jb21tb25fMS5nZXRCdXR0b25Db2xvcnMoKSwgY29sb3IgPSBfYS5jb2xvciwgYmFja2dyb3VuZENvbG9yID0gX2EuYmFja2dyb3VuZENvbG9yO1xuICAgIGlmIChjb2xvcikge1xuICAgICAgICB2YXIgYnV0dG9ucyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgdmFyIGlkID0gZGxnLmdldENvbnRleHQoKS5nZXRSZXNvdXJjZXMoKS5nZXRJZGVudGlmaWVyKFwiYW5kcm9pZDppZC9idXR0b25cIiArIGksIG51bGwsIG51bGwpO1xuICAgICAgICAgICAgYnV0dG9uc1tpXSA9IGRsZy5maW5kVmlld0J5SWQoaWQpO1xuICAgICAgICB9XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgICAgICBpZiAoYnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRUZXh0Q29sb3IoY29sb3IuYW5kcm9pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChiYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnNldEJhY2tncm91bmRDb2xvcihiYWNrZ3JvdW5kQ29sb3IuYW5kcm9pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRCdXR0b25zVG9BbGVydERpYWxvZyhhbGVydCwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5va0J1dHRvblRleHQpIHtcbiAgICAgICAgYWxlcnQuc2V0UG9zaXRpdmVCdXR0b24ob3B0aW9ucy5va0J1dHRvblRleHQsIG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoZGlhbG9nLCBpZCkge1xuICAgICAgICAgICAgICAgIGRpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0KSB7XG4gICAgICAgIGFsZXJ0LnNldE5lZ2F0aXZlQnV0dG9uKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCwgbmV3IGFuZHJvaWQuY29udGVudC5EaWFsb2dJbnRlcmZhY2UuT25DbGlja0xpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChkaWFsb2csIGlkKSB7XG4gICAgICAgICAgICAgICAgZGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5uZXV0cmFsQnV0dG9uVGV4dCkge1xuICAgICAgICBhbGVydC5zZXROZXV0cmFsQnV0dG9uKG9wdGlvbnMubmV1dHJhbEJ1dHRvblRleHQsIG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoZGlhbG9nLCBpZCkge1xuICAgICAgICAgICAgICAgIGRpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGFsZXJ0LnNldE9uRGlzbWlzc0xpc3RlbmVyKG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uRGlzbWlzc0xpc3RlbmVyKHtcbiAgICAgICAgb25EaXNtaXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9KSk7XG59XG5mdW5jdGlvbiBhbGVydChhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAhZGlhbG9nc19jb21tb25fMS5pc0RpYWxvZ09wdGlvbnMoYXJnKSA/IHsgdGl0bGU6IGRpYWxvZ3NfY29tbW9uXzEuQUxFUlQsIG9rQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5PSywgbWVzc2FnZTogYXJnICsgXCJcIiB9IDogYXJnO1xuICAgICAgICAgICAgdmFyIGFsZXJ0XzEgPSBjcmVhdGVBbGVydERpYWxvZyhvcHRpb25zKTtcbiAgICAgICAgICAgIGFsZXJ0XzEuc2V0UG9zaXRpdmVCdXR0b24ob3B0aW9ucy5va0J1dHRvblRleHQsIG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gKGRpYWxvZywgaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgYWxlcnRfMS5zZXRPbkRpc21pc3NMaXN0ZW5lcihuZXcgYW5kcm9pZC5jb250ZW50LkRpYWxvZ0ludGVyZmFjZS5PbkRpc21pc3NMaXN0ZW5lcih7XG4gICAgICAgICAgICAgICAgb25EaXNtaXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzaG93RGlhbG9nKGFsZXJ0XzEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5hbGVydCA9IGFsZXJ0O1xuZnVuY3Rpb24gY29uZmlybShhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAhZGlhbG9nc19jb21tb25fMS5pc0RpYWxvZ09wdGlvbnMoYXJnKSA/IHsgdGl0bGU6IGRpYWxvZ3NfY29tbW9uXzEuQ09ORklSTSwgb2tCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLk9LLCBjYW5jZWxCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLkNBTkNFTCwgbWVzc2FnZTogYXJnICsgXCJcIiB9IDogYXJnO1xuICAgICAgICAgICAgdmFyIGFsZXJ0XzIgPSBjcmVhdGVBbGVydERpYWxvZyhvcHRpb25zKTtcbiAgICAgICAgICAgIGFkZEJ1dHRvbnNUb0FsZXJ0RGlhbG9nKGFsZXJ0XzIsIG9wdGlvbnMsIGZ1bmN0aW9uIChyZXN1bHQpIHsgcmVzb2x2ZShyZXN1bHQpOyB9KTtcbiAgICAgICAgICAgIHNob3dEaWFsb2coYWxlcnRfMik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmNvbmZpcm0gPSBjb25maXJtO1xuZnVuY3Rpb24gcHJvbXB0KGFyZykge1xuICAgIHZhciBvcHRpb25zO1xuICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgdGl0bGU6IGRpYWxvZ3NfY29tbW9uXzEuUFJPTVBULFxuICAgICAgICBva0J1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuT0ssXG4gICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuQ0FOQ0VMLFxuICAgICAgICBpbnB1dFR5cGU6IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLnRleHQsXG4gICAgfTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBpZiAoaXNTdHJpbmcoYXJnKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmIChpc1N0cmluZyhhcmd1bWVudHNbMF0pICYmIGlzU3RyaW5nKGFyZ3VtZW50c1sxXSkpIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIG9wdGlvbnMuZGVmYXVsdFRleHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBhbGVydF8zID0gY3JlYXRlQWxlcnREaWFsb2cob3B0aW9ucyk7XG4gICAgICAgICAgICB2YXIgaW5wdXRfMSA9IG5ldyBhbmRyb2lkLndpZGdldC5FZGl0VGV4dChhcHBsaWNhdGlvbl8xLmFuZHJvaWQuZm9yZWdyb3VuZEFjdGl2aXR5KTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuaW5wdXRUeXBlID09PSBkaWFsb2dzX2NvbW1vbl8xLmlucHV0VHlwZS5wYXNzd29yZCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dF8xLnNldElucHV0VHlwZShhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9QQVNTV09SRCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMuaW5wdXRUeXBlID09PSBkaWFsb2dzX2NvbW1vbl8xLmlucHV0VHlwZS5lbWFpbCkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dF8xLnNldElucHV0VHlwZShhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9FTUFJTF9BRERSRVNTKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLm51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dF8xLnNldElucHV0VHlwZShhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfTlVNQkVSKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLmRlY2ltYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRfMS5zZXRJbnB1dFR5cGUoYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX05VTUJFUiB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfRkxBR19ERUNJTUFMKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLnBob25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19QSE9ORSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN3aXRjaCAob3B0aW9ucy5jYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBkaWFsb2dzX2NvbW1vbl8xLmNhcGl0YWxpemF0aW9uVHlwZS5hbGw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGlucHV0XzEuZ2V0SW5wdXRUeXBlKCkgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9DSEFSQUNURVJTKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZGlhbG9nc19jb21tb25fMS5jYXBpdGFsaXphdGlvblR5cGUuc2VudGVuY2VzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dF8xLnNldElucHV0VHlwZShpbnB1dF8xLmdldElucHV0VHlwZSgpIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZGlhbG9nc19jb21tb25fMS5jYXBpdGFsaXphdGlvblR5cGUud29yZHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0XzEuc2V0SW5wdXRUeXBlKGlucHV0XzEuZ2V0SW5wdXRUeXBlKCkgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9XT1JEUyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlucHV0XzEuc2V0VGV4dChvcHRpb25zICYmIG9wdGlvbnMuZGVmYXVsdFRleHQgfHwgXCJcIik7XG4gICAgICAgICAgICBhbGVydF8zLnNldFZpZXcoaW5wdXRfMSk7XG4gICAgICAgICAgICB2YXIgZ2V0VGV4dF8xID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gaW5wdXRfMS5nZXRUZXh0KCkudG9TdHJpbmcoKTsgfTtcbiAgICAgICAgICAgIGFkZEJ1dHRvbnNUb0FsZXJ0RGlhbG9nKGFsZXJ0XzMsIG9wdGlvbnMsIGZ1bmN0aW9uIChyKSB7IHJlc29sdmUoeyByZXN1bHQ6IHIsIHRleHQ6IGdldFRleHRfMSgpIH0pOyB9KTtcbiAgICAgICAgICAgIHNob3dEaWFsb2coYWxlcnRfMyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnByb21wdCA9IHByb21wdDtcbmZ1bmN0aW9uIGxvZ2luKCkge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgb3B0aW9ucyA9IGRpYWxvZ3NfY29tbW9uXzEucGFyc2VMb2dpbk9wdGlvbnMoYXJncyk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0XzEgPSBhcHBsaWNhdGlvbl8xLmFuZHJvaWQuZm9yZWdyb3VuZEFjdGl2aXR5O1xuICAgICAgICAgICAgdmFyIGFsZXJ0XzQgPSBjcmVhdGVBbGVydERpYWxvZyhvcHRpb25zKTtcbiAgICAgICAgICAgIHZhciB1c2VyTmFtZUlucHV0XzEgPSBuZXcgYW5kcm9pZC53aWRnZXQuRWRpdFRleHQoY29udGV4dF8xKTtcbiAgICAgICAgICAgIHVzZXJOYW1lSW5wdXRfMS5zZXRIaW50KG9wdGlvbnMudXNlck5hbWVIaW50ID8gb3B0aW9ucy51c2VyTmFtZUhpbnQgOiBcIlwiKTtcbiAgICAgICAgICAgIHVzZXJOYW1lSW5wdXRfMS5zZXRUZXh0KG9wdGlvbnMudXNlck5hbWUgPyBvcHRpb25zLnVzZXJOYW1lIDogXCJcIik7XG4gICAgICAgICAgICB2YXIgcGFzc3dvcmRJbnB1dF8xID0gbmV3IGFuZHJvaWQud2lkZ2V0LkVkaXRUZXh0KGNvbnRleHRfMSk7XG4gICAgICAgICAgICBwYXNzd29yZElucHV0XzEuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX1BBU1NXT1JEKTtcbiAgICAgICAgICAgIHBhc3N3b3JkSW5wdXRfMS5zZXRUeXBlZmFjZShhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLkRFRkFVTFQpO1xuICAgICAgICAgICAgcGFzc3dvcmRJbnB1dF8xLnNldEhpbnQob3B0aW9ucy5wYXNzd29yZEhpbnQgPyBvcHRpb25zLnBhc3N3b3JkSGludCA6IFwiXCIpO1xuICAgICAgICAgICAgcGFzc3dvcmRJbnB1dF8xLnNldFRleHQob3B0aW9ucy5wYXNzd29yZCA/IG9wdGlvbnMucGFzc3dvcmQgOiBcIlwiKTtcbiAgICAgICAgICAgIHZhciBsYXlvdXQgPSBuZXcgYW5kcm9pZC53aWRnZXQuTGluZWFyTGF5b3V0KGNvbnRleHRfMSk7XG4gICAgICAgICAgICBsYXlvdXQuc2V0T3JpZW50YXRpb24oMSk7XG4gICAgICAgICAgICBsYXlvdXQuYWRkVmlldyh1c2VyTmFtZUlucHV0XzEpO1xuICAgICAgICAgICAgbGF5b3V0LmFkZFZpZXcocGFzc3dvcmRJbnB1dF8xKTtcbiAgICAgICAgICAgIGFsZXJ0XzQuc2V0VmlldyhsYXlvdXQpO1xuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnREaWFsb2coYWxlcnRfNCwgb3B0aW9ucywgZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiByLFxuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZTogdXNlck5hbWVJbnB1dF8xLmdldFRleHQoKS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRJbnB1dF8xLmdldFRleHQoKS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNob3dEaWFsb2coYWxlcnRfNCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmxvZ2luID0gbG9naW47XG5mdW5jdGlvbiBhY3Rpb24oYXJnKSB7XG4gICAgdmFyIG9wdGlvbnM7XG4gICAgdmFyIGRlZmF1bHRPcHRpb25zID0geyB0aXRsZTogbnVsbCwgY2FuY2VsQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5DQU5DRUwgfTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBpZiAoaXNTdHJpbmcoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmIChpc1N0cmluZyhhcmd1bWVudHNbMF0pICYmIGlzU3RyaW5nKGFyZ3VtZW50c1sxXSkpIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIGlmIChpc1N0cmluZyhhcmd1bWVudHNbMF0pICYmIGlzU3RyaW5nKGFyZ3VtZW50c1sxXSkgJiYgdHlwZW9mIGFyZ3VtZW50c1syXSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgb3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgb3B0aW9ucy5hY3Rpb25zID0gYXJndW1lbnRzWzJdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZpdHkgPSBhcHBsaWNhdGlvbl8xLmFuZHJvaWQuZm9yZWdyb3VuZEFjdGl2aXR5IHx8IGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5zdGFydEFjdGl2aXR5O1xuICAgICAgICAgICAgdmFyIGFsZXJ0XzUgPSBuZXcgYW5kcm9pZC5hcHAuQWxlcnREaWFsb2cuQnVpbGRlcihhY3Rpdml0eSk7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IG9wdGlvbnMgJiYgaXNTdHJpbmcob3B0aW9ucy5tZXNzYWdlKSA/IG9wdGlvbnMubWVzc2FnZSA6IFwiXCI7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBvcHRpb25zICYmIGlzU3RyaW5nKG9wdGlvbnMudGl0bGUpID8gb3B0aW9ucy50aXRsZSA6IFwiXCI7XG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNhbmNlbGFibGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRfNS5zZXRDYW5jZWxhYmxlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aXRsZSkge1xuICAgICAgICAgICAgICAgIGFsZXJ0XzUuc2V0VGl0bGUodGl0bGUpO1xuICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5hY3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0XzUuc2V0TWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbGVydF81LnNldFRpdGxlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYWN0aW9ucykge1xuICAgICAgICAgICAgICAgIGFsZXJ0XzUuc2V0SXRlbXMob3B0aW9ucy5hY3Rpb25zLCBuZXcgYW5kcm9pZC5jb250ZW50LkRpYWxvZ0ludGVyZmFjZS5PbkNsaWNrTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiAoZGlhbG9nLCB3aGljaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvcHRpb25zLmFjdGlvbnNbd2hpY2hdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc1N0cmluZyhvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQpKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRfNS5zZXROZWdhdGl2ZUJ1dHRvbihvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQsIG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uQ2xpY2tMaXN0ZW5lcih7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIChkaWFsb2csIGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbGVydF81LnNldE9uRGlzbWlzc0xpc3RlbmVyKG5ldyBhbmRyb2lkLmNvbnRlbnQuRGlhbG9nSW50ZXJmYWNlLk9uRGlzbWlzc0xpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICBvbkRpc21pc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzU3RyaW5nKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBzaG93RGlhbG9nKGFsZXJ0XzUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5hY3Rpb24gPSBhY3Rpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaWFsb2dzLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBFZGl0YWJsZVRleHRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRWRpdGFibGVUZXh0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBFZGl0YWJsZVRleHRCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2ZvY3VzSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJmb2N1c1wiKTsgfTtcbiAgICAgICAgX3RoaXMuX2JsdXJIYW5kbGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImJsdXJcIik7IH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUuX3VwZGF0ZVRleHRCYXNlRm9jdXNTdGF0ZUhhbmRsZXIgPSBmdW5jdGlvbiAoc3Vic2NyaWJlKSB7XG4gICAgICAgIHZhciBtZXRob2QgPSBzdWJzY3JpYmUgPyBcIm9uXCIgOiBcIm9mZlwiO1xuICAgICAgICB0aGlzW21ldGhvZF0oXCJmb2N1c1wiLCB0aGlzLl9mb2N1c0hhbmRsZXIpO1xuICAgICAgICB0aGlzW21ldGhvZF0oXCJibHVyXCIsIHRoaXMuX2JsdXJIYW5kbGVyKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UuYmx1ckV2ZW50ID0gXCJibHVyXCI7XG4gICAgRWRpdGFibGVUZXh0QmFzZS5mb2N1c0V2ZW50ID0gXCJmb2N1c1wiO1xuICAgIEVkaXRhYmxlVGV4dEJhc2UudGV4dENoYW5nZUV2ZW50ID0gXCJ0ZXh0Q2hhbmdlXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHRleHRfYmFzZV8xLlBzZXVkb0NsYXNzSGFuZGxlcihcImZvY3VzXCIsIFwiYmx1clwiKVxuICAgIF0sIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLCBcIl91cGRhdGVUZXh0QmFzZUZvY3VzU3RhdGVIYW5kbGVyXCIsIG51bGwpO1xuICAgIHJldHVybiBFZGl0YWJsZVRleHRCYXNlO1xufSh0ZXh0X2Jhc2VfMS5UZXh0QmFzZSkpO1xuZXhwb3J0cy5FZGl0YWJsZVRleHRCYXNlID0gRWRpdGFibGVUZXh0QmFzZTtcbmV4cG9ydHMucGxhY2Vob2xkZXJDb2xvclByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJwbGFjZWhvbGRlckNvbG9yXCIsIGNzc05hbWU6IFwicGxhY2Vob2xkZXItY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdGV4dF9iYXNlXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB0ZXh0X2Jhc2VfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMucGxhY2Vob2xkZXJDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHRleHRfYmFzZV8xLlN0eWxlKTtcbnZhciBrZXlib2FyZFR5cGVDb252ZXJ0ZXIgPSB0ZXh0X2Jhc2VfMS5tYWtlUGFyc2VyKHRleHRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJkYXRldGltZVwiLCBcInBob25lXCIsIFwibnVtYmVyXCIsIFwidXJsXCIsIFwiZW1haWxcIikpO1xuZXhwb3J0cy5rZXlib2FyZFR5cGVQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwia2V5Ym9hcmRUeXBlXCIsIHZhbHVlQ29udmVydGVyOiBrZXlib2FyZFR5cGVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLmtleWJvYXJkVHlwZVByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xudmFyIHJldHVybktleVR5cGVDb252ZXJ0ZXIgPSB0ZXh0X2Jhc2VfMS5tYWtlUGFyc2VyKHRleHRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJkb25lXCIsIFwibmV4dFwiLCBcImdvXCIsIFwic2VhcmNoXCIsIFwic2VuZFwiKSk7XG5leHBvcnRzLnJldHVybktleVR5cGVQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwicmV0dXJuS2V5VHlwZVwiLCB2YWx1ZUNvbnZlcnRlcjogcmV0dXJuS2V5VHlwZUNvbnZlcnRlciB9KTtcbmV4cG9ydHMucmV0dXJuS2V5VHlwZVByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuZXhwb3J0cy5lZGl0YWJsZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJlZGl0YWJsZVwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB0ZXh0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5lZGl0YWJsZVByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuZXhwb3J0cy51cGRhdGVUZXh0VHJpZ2dlclByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJ1cGRhdGVUZXh0VHJpZ2dlclwiLCBkZWZhdWx0VmFsdWU6IFwidGV4dENoYW5nZWRcIiB9KTtcbmV4cG9ydHMudXBkYXRlVGV4dFRyaWdnZXJQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbnZhciBhdXRvY2FwaXRhbGl6YXRpb25UeXBlQ29udmVydGVyID0gdGV4dF9iYXNlXzEubWFrZVBhcnNlcih0ZXh0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwibm9uZVwiLCBcIndvcmRzXCIsIFwic2VudGVuY2VzXCIsIFwiYWxsY2hhcmFjdGVyc1wiKSk7XG5leHBvcnRzLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYXV0b2NhcGl0YWxpemF0aW9uVHlwZVwiLCBkZWZhdWx0VmFsdWU6IFwic2VudGVuY2VzXCIsIHZhbHVlQ29udmVydGVyOiBhdXRvY2FwaXRhbGl6YXRpb25UeXBlQ29udmVydGVyIH0pO1xuZXhwb3J0cy5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLmF1dG9jb3JyZWN0UHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImF1dG9jb3JyZWN0XCIsIHZhbHVlQ29udmVydGVyOiB0ZXh0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5hdXRvY29ycmVjdFByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuZXhwb3J0cy5oaW50UHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImhpbnRcIiwgZGVmYXVsdFZhbHVlOiBcIlwiIH0pO1xuZXhwb3J0cy5oaW50UHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLm1heExlbmd0aFByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJtYXhMZW5ndGhcIiwgZGVmYXVsdFZhbHVlOiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIHZhbHVlQ29udmVydGVyOiBwYXJzZUludCB9KTtcbmV4cG9ydHMubWF4TGVuZ3RoUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZWRpdGFibGUtdGV4dC1iYXNlLWNvbW1vblwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZWRpdGFibGUtdGV4dC1iYXNlLWNvbW1vblwiKSk7XG52YXIgRWRpdFRleHRMaXN0ZW5lcnM7XG5mdW5jdGlvbiBjbGVhckRpc21pc3NUaW1lcigpIHtcbiAgICBleHBvcnRzLmRpc21pc3NLZXlib2FyZE93bmVyID0gbnVsbDtcbiAgICBpZiAoZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRUaW1lb3V0SWQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGV4cG9ydHMuZGlzbWlzc0tleWJvYXJkVGltZW91dElkKTtcbiAgICAgICAgZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRUaW1lb3V0SWQgPSBudWxsO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRpc21pc3NTb2Z0SW5wdXQob3duZXIpIHtcbiAgICBjbGVhckRpc21pc3NUaW1lcigpO1xuICAgIGlmICghZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRUaW1lb3V0SWQpIHtcbiAgICAgICAgZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IGV4cG9ydHMuZGlzbWlzc0tleWJvYXJkT3duZXIgJiYgZXhwb3J0cy5kaXNtaXNzS2V5Ym9hcmRPd25lci5nZXQoKTtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IChvd25lciAmJiBvd25lci5fY29udGV4dCk7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG93bmVyICYmIG93bmVyLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBleHBvcnRzLmRpc21pc3NLZXlib2FyZFRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgICAgICBleHBvcnRzLmRpc21pc3NLZXlib2FyZE93bmVyID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBmb2N1c2VkID0gYWN0aXZpdHkgJiYgYWN0aXZpdHkuZ2V0Q3VycmVudEZvY3VzKCk7XG4gICAgICAgICAgICBpZiAoIWZvY3VzZWQgfHwgIShmb2N1c2VkIGluc3RhbmNlb2YgYW5kcm9pZC53aWRnZXQuRWRpdFRleHQpKSB7XG4gICAgICAgICAgICAgICAgdXRpbHNfMS5hZC5kaXNtaXNzU29mdElucHV0KG5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAxMCk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5pdGlhbGl6ZUVkaXRUZXh0TGlzdGVuZXJzKCkge1xuICAgIGlmIChFZGl0VGV4dExpc3RlbmVycykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBFZGl0VGV4dExpc3RlbmVyc0ltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRWRpdFRleHRMaXN0ZW5lcnNJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBFZGl0VGV4dExpc3RlbmVyc0ltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRWRpdFRleHRMaXN0ZW5lcnNJbXBsLnByb3RvdHlwZS5iZWZvcmVUZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICh0ZXh0LCBzdGFydCwgY291bnQsIGFmdGVyKSB7XG4gICAgICAgIH07XG4gICAgICAgIEVkaXRUZXh0TGlzdGVuZXJzSW1wbC5wcm90b3R5cGUub25UZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICh0ZXh0LCBzdGFydCwgYmVmb3JlLCBjb3VudCkge1xuICAgICAgICB9O1xuICAgICAgICBFZGl0VGV4dExpc3RlbmVyc0ltcGwucHJvdG90eXBlLmFmdGVyVGV4dENoYW5nZWQgPSBmdW5jdGlvbiAoZWRpdGFibGUpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyIHx8IG93bmVyLl9jaGFuZ2VGcm9tQ29kZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAob3duZXIudXBkYXRlVGV4dFRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiZm9jdXNMb3N0XCI6XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLl9kaXJ0eVRleHRBY2N1bXVsYXRvciA9IGVkaXRhYmxlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ0ZXh0Q2hhbmdlZFwiOlxuICAgICAgICAgICAgICAgICAgICBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBlZGl0YWJsZS50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB1cGRhdGVUZXh0VHJpZ2dlcjogXCIgKyBvd25lci51cGRhdGVUZXh0VHJpZ2dlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEVkaXRUZXh0TGlzdGVuZXJzSW1wbC5wcm90b3R5cGUub25Gb2N1c0NoYW5nZSA9IGZ1bmN0aW9uICh2aWV3LCBoYXNGb2N1cykge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzRm9jdXMpIHtcbiAgICAgICAgICAgICAgICBjbGVhckRpc21pc3NUaW1lcigpO1xuICAgICAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogRWRpdGFibGVUZXh0QmFzZS5mb2N1c0V2ZW50LCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyLl9kaXJ0eVRleHRBY2N1bXVsYXRvciB8fCBvd25lci5fZGlydHlUZXh0QWNjdW11bGF0b3IgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgb3duZXIuX2RpcnR5VGV4dEFjY3VtdWxhdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX2RpcnR5VGV4dEFjY3VtdWxhdG9yID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvd25lci5ub3RpZnkoeyBldmVudE5hbWU6IEVkaXRhYmxlVGV4dEJhc2UuYmx1ckV2ZW50LCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICAgICAgICAgIGRpc21pc3NTb2Z0SW5wdXQob3duZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBFZGl0VGV4dExpc3RlbmVyc0ltcGwucHJvdG90eXBlLm9uRWRpdG9yQWN0aW9uID0gZnVuY3Rpb24gKHRleHRWaWV3LCBhY3Rpb25JZCwgZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGlvbklkID09PSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX0RPTkUgfHxcbiAgICAgICAgICAgICAgICBhY3Rpb25JZCA9PT0gYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9VTlNQRUNJRklFRCB8fFxuICAgICAgICAgICAgICAgIChldmVudCAmJiBldmVudC5nZXRLZXlDb2RlKCkgPT09IGFuZHJvaWQudmlldy5LZXlFdmVudC5LRVlDT0RFX0VOVEVSKSkge1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0Vmlldy5nZXRNYXhMaW5lcygpID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3duZXIuX29uUmV0dXJuUHJlc3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbklkID09PSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX05FWFQgfHxcbiAgICAgICAgICAgICAgICBhY3Rpb25JZCA9PT0gYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9QUkVWSU9VUykge1xuICAgICAgICAgICAgICAgIG93bmVyLl9vblJldHVyblByZXNzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH07XG4gICAgICAgIEVkaXRUZXh0TGlzdGVuZXJzSW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC50ZXh0LlRleHRXYXRjaGVyLCBhbmRyb2lkLnZpZXcuVmlldy5PbkZvY3VzQ2hhbmdlTGlzdGVuZXIsIGFuZHJvaWQud2lkZ2V0LlRleHRWaWV3Lk9uRWRpdG9yQWN0aW9uTGlzdGVuZXJdKVxuICAgICAgICBdLCBFZGl0VGV4dExpc3RlbmVyc0ltcGwpO1xuICAgICAgICByZXR1cm4gRWRpdFRleHRMaXN0ZW5lcnNJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIEVkaXRUZXh0TGlzdGVuZXJzID0gRWRpdFRleHRMaXN0ZW5lcnNJbXBsO1xufVxudmFyIEVkaXRhYmxlVGV4dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFZGl0YWJsZVRleHRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVkaXRhYmxlVGV4dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUuX29uUmV0dXJuUHJlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuZHJvaWQud2lkZ2V0LkVkaXRUZXh0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIGVkaXRUZXh0ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdGhpcy5fY29uZmlndXJlRWRpdFRleHQoZWRpdFRleHQpO1xuICAgICAgICBpbml0aWFsaXplRWRpdFRleHRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IG5ldyBFZGl0VGV4dExpc3RlbmVycyh0aGlzKTtcbiAgICAgICAgZWRpdFRleHQuYWRkVGV4dENoYW5nZWRMaXN0ZW5lcihsaXN0ZW5lcnMpO1xuICAgICAgICBlZGl0VGV4dC5zZXRPbkZvY3VzQ2hhbmdlTGlzdGVuZXIobGlzdGVuZXJzKTtcbiAgICAgICAgZWRpdFRleHQuc2V0T25FZGl0b3JBY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcnMpO1xuICAgICAgICBlZGl0VGV4dC5saXN0ZW5lciA9IGxpc3RlbmVycztcbiAgICAgICAgdGhpcy5faW5wdXRUeXBlID0gZWRpdFRleHQuZ2V0SW5wdXRUeXBlKCk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5saXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2tleUxpc3RlbmVyQ2FjaGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0SW5wdXRUeXBlKHRoaXMuX2lucHV0VHlwZSk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5kaXNtaXNzU29mdElucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHV0aWxzXzEuYWQuZGlzbWlzc1NvZnRJbnB1dChuYXRpdmVWaWV3KTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBfc3VwZXIucHJvdG90eXBlLmZvY3VzLmNhbGwodGhpcyk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIHV0aWxzXzEuYWQuc2hvd1NvZnRJbnB1dCh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUuX3NldElucHV0VHlwZSA9IGZ1bmN0aW9uIChpbnB1dFR5cGUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fY2hhbmdlRnJvbUNvZGUgPSB0cnVlO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRJbnB1dFR5cGUoaW5wdXRUeXBlKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX2NoYW5nZUZyb21Db2RlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmF0aXZlVmlldy5nZXRLZXlMaXN0ZW5lcigpO1xuICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2tleUxpc3RlbmVyQ2FjaGUgPSBsaXN0ZW5lcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuZWRpdGFibGUpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0S2V5TGlzdGVuZXIobnVsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEucmVzZXRTeW1ib2w7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2NoYW5nZUZyb21Db2RlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQodmFsdWUgPT09IGVkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbCk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9jaGFuZ2VGcm9tQ29kZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEua2V5Ym9hcmRUeXBlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldElucHV0VHlwZSgpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmtleWJvYXJkVHlwZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld0lucHV0VHlwZTtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImRhdGV0aW1lXCI6XG4gICAgICAgICAgICAgICAgbmV3SW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX0RBVEVUSU1FIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0RBVEVUSU1FX1ZBUklBVElPTl9OT1JNQUw7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicGhvbmVcIjpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfUEhPTkU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgbmV3SW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX05VTUJFUiB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfVkFSSUFUSU9OX05PUk1BTCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfRkxBR19TSUdORUQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfTlVNQkVSX0ZMQUdfREVDSU1BTDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ1cmxcIjpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9VUkk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZW1haWxcIjpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9FTUFJTF9BRERSRVNTO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBuZXdJbnB1dFR5cGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRJbnB1dFR5cGUobmV3SW5wdXRUeXBlKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5yZXR1cm5LZXlUeXBlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbWUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldEltZU9wdGlvbnMoKTtcbiAgICAgICAgc3dpdGNoIChpbWUpIHtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9ET05FOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImRvbmVcIjtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9HTzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJnb1wiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX05FWFQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibmV4dFwiO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1NFQVJDSDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzZWFyY2hcIjtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9TRU5EOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInNlbmRcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGltZS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEucmV0dXJuS2V5VHlwZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld0ltZU9wdGlvbnM7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJkb25lXCI6XG4gICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fRE9ORTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJnb1wiOlxuICAgICAgICAgICAgICAgIG5ld0ltZU9wdGlvbnMgPSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX0dPO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm5leHRcIjpcbiAgICAgICAgICAgICAgICBuZXdJbWVPcHRpb25zID0gYW5kcm9pZC52aWV3LmlucHV0bWV0aG9kLkVkaXRvckluZm8uSU1FX0FDVElPTl9ORVhUO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNlYXJjaFwiOlxuICAgICAgICAgICAgICAgIG5ld0ltZU9wdGlvbnMgPSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1NFQVJDSDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzZW5kXCI6XG4gICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5FZGl0b3JJbmZvLklNRV9BQ1RJT05fU0VORDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdmFyIGltZSA9ICt2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGltZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SW1lT3B0aW9ucyA9IGltZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ltZU9wdGlvbnMgPSBhbmRyb2lkLnZpZXcuaW5wdXRtZXRob2QuRWRpdG9ySW5mby5JTUVfQUNUSU9OX1VOU1BFQ0lGSUVEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEltZU9wdGlvbnMobmV3SW1lT3B0aW9ucyk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuZWRpdGFibGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldEtleUxpc3RlbmVyKHRoaXMuX2tleUxpc3RlbmVyQ2FjaGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9rZXlMaXN0ZW5lckNhY2hlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fa2V5TGlzdGVuZXJDYWNoZSA9IG5hdGl2ZVZpZXcuZ2V0S2V5TGlzdGVuZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0S2V5TGlzdGVuZXIobnVsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnB1dFR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldElucHV0VHlwZSgpO1xuICAgICAgICBpZiAoKGlucHV0VHlwZSAmIGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTKSA9PT0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfV09SRFMpIHtcbiAgICAgICAgICAgIHJldHVybiBcIndvcmRzXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKGlucHV0VHlwZSAmIGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1NFTlRFTkNFUykgPT09IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1NFTlRFTkNFUykge1xuICAgICAgICAgICAgcmV0dXJuIFwic2VudGVuY2VzXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKGlucHV0VHlwZSAmIGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX0NIQVJBQ1RFUlMpID09PSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9DSEFSQUNURVJTKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJhbGxjaGFyYWN0ZXJzXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXRUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5wdXRUeXBlID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRJbnB1dFR5cGUoKTtcbiAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlICYgfjI4NjcyO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIndvcmRzXCI6XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfV09SRFM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2VudGVuY2VzXCI6XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImFsbGNoYXJhY3RlcnNcIjpcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9DSEFSQUNURVJTO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB2YXIgbnVtYmVyID0gK3ZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBudW1iZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0NBUF9TRU5URU5DRVM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NldElucHV0VHlwZShpbnB1dFR5cGUpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jb3JyZWN0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhdXRvY29ycmVjdCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0SW5wdXRUeXBlKCk7XG4gICAgICAgIGlmICgoYXV0b2NvcnJlY3QgJiBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVCkgPT09IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT1JSRUNUKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuYXV0b2NvcnJlY3RQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnB1dFR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldElucHV0VHlwZSgpO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIHRydWU6XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT1JSRUNUO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSAmIH5hbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX05PX1NVR0dFU1RJT05TO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBmYWxzZTpcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgJiB+YW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19BVVRPX0NPTVBMRVRFO1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSAmIH5hbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDtcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX05PX1NVR0dFU1RJT05TO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRJbnB1dFR5cGUoaW5wdXRUeXBlKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5oaW50UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldEhpbnQoKTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5oaW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdGV4dCA9ICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSA/IG51bGwgOiB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEhpbnQodGV4dCk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEucGxhY2Vob2xkZXJDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRIaW50VGV4dENvbG9ycygpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnBsYWNlaG9sZGVyQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuYW5kcm9pZCA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEhpbnRUZXh0Q29sb3IoY29sb3IpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEubWF4TGVuZ3RoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRGaWx0ZXJzKFtdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBsZW5ndGhGaWx0ZXIgPSBuZXcgYW5kcm9pZC50ZXh0LklucHV0RmlsdGVyLkxlbmd0aEZpbHRlcih2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZmlsdGVycyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0RmlsdGVycygpO1xuICAgICAgICAgICAgdmFyIG5ld0ZpbHRlcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBmaWx0ZXJzW2ldO1xuICAgICAgICAgICAgICAgIGlmICghKGZpbHRlciBpbnN0YW5jZW9mIGFuZHJvaWQudGV4dC5JbnB1dEZpbHRlci5MZW5ndGhGaWx0ZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpbHRlcnMucHVzaChmaWx0ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0ZpbHRlcnMucHVzaChsZW5ndGhGaWx0ZXIpO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRGaWx0ZXJzKG5ld0ZpbHRlcnMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gRWRpdGFibGVUZXh0QmFzZTtcbn0oZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLkVkaXRhYmxlVGV4dEJhc2UpKTtcbmV4cG9ydHMuRWRpdGFibGVUZXh0QmFzZSA9IEVkaXRhYmxlVGV4dEJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lZGl0YWJsZS10ZXh0LWJhc2UuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgS2V5Ym9hcmRUeXBlO1xuKGZ1bmN0aW9uIChLZXlib2FyZFR5cGUpIHtcbiAgICBLZXlib2FyZFR5cGUuZGF0ZXRpbWUgPSBcImRhdGV0aW1lXCI7XG4gICAgS2V5Ym9hcmRUeXBlLnBob25lID0gXCJwaG9uZVwiO1xuICAgIEtleWJvYXJkVHlwZS5udW1iZXIgPSBcIm51bWJlclwiO1xuICAgIEtleWJvYXJkVHlwZS51cmwgPSBcInVybFwiO1xuICAgIEtleWJvYXJkVHlwZS5lbWFpbCA9IFwiZW1haWxcIjtcbn0pKEtleWJvYXJkVHlwZSA9IGV4cG9ydHMuS2V5Ym9hcmRUeXBlIHx8IChleHBvcnRzLktleWJvYXJkVHlwZSA9IHt9KSk7XG52YXIgUmV0dXJuS2V5VHlwZTtcbihmdW5jdGlvbiAoUmV0dXJuS2V5VHlwZSkge1xuICAgIFJldHVybktleVR5cGUuZG9uZSA9IFwiZG9uZVwiO1xuICAgIFJldHVybktleVR5cGUubmV4dCA9IFwibmV4dFwiO1xuICAgIFJldHVybktleVR5cGUuZ28gPSBcImdvXCI7XG4gICAgUmV0dXJuS2V5VHlwZS5zZWFyY2ggPSBcInNlYXJjaFwiO1xuICAgIFJldHVybktleVR5cGUuc2VuZCA9IFwic2VuZFwiO1xufSkoUmV0dXJuS2V5VHlwZSA9IGV4cG9ydHMuUmV0dXJuS2V5VHlwZSB8fCAoZXhwb3J0cy5SZXR1cm5LZXlUeXBlID0ge30pKTtcbnZhciBUZXh0QWxpZ25tZW50O1xuKGZ1bmN0aW9uIChUZXh0QWxpZ25tZW50KSB7XG4gICAgVGV4dEFsaWdubWVudC5sZWZ0ID0gXCJsZWZ0XCI7XG4gICAgVGV4dEFsaWdubWVudC5jZW50ZXIgPSBcImNlbnRlclwiO1xuICAgIFRleHRBbGlnbm1lbnQucmlnaHQgPSBcInJpZ2h0XCI7XG59KShUZXh0QWxpZ25tZW50ID0gZXhwb3J0cy5UZXh0QWxpZ25tZW50IHx8IChleHBvcnRzLlRleHRBbGlnbm1lbnQgPSB7fSkpO1xudmFyIFRleHREZWNvcmF0aW9uO1xuKGZ1bmN0aW9uIChUZXh0RGVjb3JhdGlvbikge1xuICAgIFRleHREZWNvcmF0aW9uLm5vbmUgPSBcIm5vbmVcIjtcbiAgICBUZXh0RGVjb3JhdGlvbi51bmRlcmxpbmUgPSBcInVuZGVybGluZVwiO1xuICAgIFRleHREZWNvcmF0aW9uLmxpbmVUaHJvdWdoID0gXCJsaW5lLXRocm91Z2hcIjtcbn0pKFRleHREZWNvcmF0aW9uID0gZXhwb3J0cy5UZXh0RGVjb3JhdGlvbiB8fCAoZXhwb3J0cy5UZXh0RGVjb3JhdGlvbiA9IHt9KSk7XG52YXIgVGV4dFRyYW5zZm9ybTtcbihmdW5jdGlvbiAoVGV4dFRyYW5zZm9ybSkge1xuICAgIFRleHRUcmFuc2Zvcm0ubm9uZSA9IFwibm9uZVwiO1xuICAgIFRleHRUcmFuc2Zvcm0uY2FwaXRhbGl6ZSA9IFwiY2FwaXRhbGl6ZVwiO1xuICAgIFRleHRUcmFuc2Zvcm0udXBwZXJjYXNlID0gXCJ1cHBlcmNhc2VcIjtcbiAgICBUZXh0VHJhbnNmb3JtLmxvd2VyY2FzZSA9IFwibG93ZXJjYXNlXCI7XG59KShUZXh0VHJhbnNmb3JtID0gZXhwb3J0cy5UZXh0VHJhbnNmb3JtIHx8IChleHBvcnRzLlRleHRUcmFuc2Zvcm0gPSB7fSkpO1xudmFyIFdoaXRlU3BhY2U7XG4oZnVuY3Rpb24gKFdoaXRlU3BhY2UpIHtcbiAgICBXaGl0ZVNwYWNlLm5vcm1hbCA9IFwibm9ybWFsXCI7XG4gICAgV2hpdGVTcGFjZS5ub3dyYXAgPSBcIm5vd3JhcFwiO1xufSkoV2hpdGVTcGFjZSA9IGV4cG9ydHMuV2hpdGVTcGFjZSB8fCAoZXhwb3J0cy5XaGl0ZVNwYWNlID0ge30pKTtcbnZhciBPcmllbnRhdGlvbjtcbihmdW5jdGlvbiAoT3JpZW50YXRpb24pIHtcbiAgICBPcmllbnRhdGlvbi5ob3Jpem9udGFsID0gXCJob3Jpem9udGFsXCI7XG4gICAgT3JpZW50YXRpb24udmVydGljYWwgPSBcInZlcnRpY2FsXCI7XG59KShPcmllbnRhdGlvbiA9IGV4cG9ydHMuT3JpZW50YXRpb24gfHwgKGV4cG9ydHMuT3JpZW50YXRpb24gPSB7fSkpO1xudmFyIERldmljZU9yaWVudGF0aW9uO1xuKGZ1bmN0aW9uIChEZXZpY2VPcmllbnRhdGlvbikge1xuICAgIERldmljZU9yaWVudGF0aW9uLnBvcnRyYWl0ID0gXCJwb3J0cmFpdFwiO1xuICAgIERldmljZU9yaWVudGF0aW9uLmxhbmRzY2FwZSA9IFwibGFuZHNjYXBlXCI7XG4gICAgRGV2aWNlT3JpZW50YXRpb24udW5rbm93biA9IFwidW5rbm93blwiO1xufSkoRGV2aWNlT3JpZW50YXRpb24gPSBleHBvcnRzLkRldmljZU9yaWVudGF0aW9uIHx8IChleHBvcnRzLkRldmljZU9yaWVudGF0aW9uID0ge30pKTtcbnZhciBIb3Jpem9udGFsQWxpZ25tZW50O1xuKGZ1bmN0aW9uIChIb3Jpem9udGFsQWxpZ25tZW50KSB7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5sZWZ0ID0gXCJsZWZ0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5jZW50ZXIgPSBcImNlbnRlclwiO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQucmlnaHQgPSBcInJpZ2h0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5zdHJldGNoID0gXCJzdHJldGNoXCI7XG59KShIb3Jpem9udGFsQWxpZ25tZW50ID0gZXhwb3J0cy5Ib3Jpem9udGFsQWxpZ25tZW50IHx8IChleHBvcnRzLkhvcml6b250YWxBbGlnbm1lbnQgPSB7fSkpO1xudmFyIFZlcnRpY2FsQWxpZ25tZW50O1xuKGZ1bmN0aW9uIChWZXJ0aWNhbEFsaWdubWVudCkge1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LnRvcCA9IFwidG9wXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQubWlkZGxlID0gXCJtaWRkbGVcIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5ib3R0b20gPSBcImJvdHRvbVwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LnN0cmV0Y2ggPSBcInN0cmV0Y2hcIjtcbn0pKFZlcnRpY2FsQWxpZ25tZW50ID0gZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCA9IHt9KSk7XG52YXIgU3RyZXRjaDtcbihmdW5jdGlvbiAoU3RyZXRjaCkge1xuICAgIFN0cmV0Y2gubm9uZSA9IFwibm9uZVwiO1xuICAgIFN0cmV0Y2guYXNwZWN0RmlsbCA9IFwiYXNwZWN0RmlsbFwiO1xuICAgIFN0cmV0Y2guYXNwZWN0Rml0ID0gXCJhc3BlY3RGaXRcIjtcbiAgICBTdHJldGNoLmZpbGwgPSBcImZpbGxcIjtcbn0pKFN0cmV0Y2ggPSBleHBvcnRzLlN0cmV0Y2ggfHwgKGV4cG9ydHMuU3RyZXRjaCA9IHt9KSk7XG52YXIgVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoVmlzaWJpbGl0eSkge1xuICAgIFZpc2liaWxpdHkudmlzaWJsZSA9IFwidmlzaWJsZVwiO1xuICAgIFZpc2liaWxpdHkuY29sbGFwc2UgPSBcImNvbGxhcHNlXCI7XG4gICAgVmlzaWJpbGl0eS5jb2xsYXBzZWQgPSBcImNvbGxhcHNlZFwiO1xufSkoVmlzaWJpbGl0eSA9IGV4cG9ydHMuVmlzaWJpbGl0eSB8fCAoZXhwb3J0cy5WaXNpYmlsaXR5ID0ge30pKTtcbnZhciBGb250QXR0cmlidXRlcztcbihmdW5jdGlvbiAoRm9udEF0dHJpYnV0ZXMpIHtcbiAgICBGb250QXR0cmlidXRlcy5Ob3JtYWwgPSAwO1xuICAgIEZvbnRBdHRyaWJ1dGVzLkJvbGQgPSAxO1xuICAgIEZvbnRBdHRyaWJ1dGVzLkl0YWxpYyA9IDEgPDwgMTtcbn0pKEZvbnRBdHRyaWJ1dGVzID0gZXhwb3J0cy5Gb250QXR0cmlidXRlcyB8fCAoZXhwb3J0cy5Gb250QXR0cmlidXRlcyA9IHt9KSk7XG52YXIgRGV2aWNlVHlwZTtcbihmdW5jdGlvbiAoRGV2aWNlVHlwZSkge1xuICAgIERldmljZVR5cGUuUGhvbmUgPSBcIlBob25lXCI7XG4gICAgRGV2aWNlVHlwZS5UYWJsZXQgPSBcIlRhYmxldFwiO1xufSkoRGV2aWNlVHlwZSA9IGV4cG9ydHMuRGV2aWNlVHlwZSB8fCAoZXhwb3J0cy5EZXZpY2VUeXBlID0ge30pKTtcbnZhciBVcGRhdGVUZXh0VHJpZ2dlcjtcbihmdW5jdGlvbiAoVXBkYXRlVGV4dFRyaWdnZXIpIHtcbiAgICBVcGRhdGVUZXh0VHJpZ2dlci5mb2N1c0xvc3QgPSBcImZvY3VzTG9zdFwiO1xuICAgIFVwZGF0ZVRleHRUcmlnZ2VyLnRleHRDaGFuZ2VkID0gXCJ0ZXh0Q2hhbmdlZFwiO1xufSkoVXBkYXRlVGV4dFRyaWdnZXIgPSBleHBvcnRzLlVwZGF0ZVRleHRUcmlnZ2VyIHx8IChleHBvcnRzLlVwZGF0ZVRleHRUcmlnZ2VyID0ge30pKTtcbnZhciBBY2N1cmFjeTtcbihmdW5jdGlvbiAoQWNjdXJhY3kpIHtcbiAgICBBY2N1cmFjeS5hbnkgPSAzMDA7XG4gICAgQWNjdXJhY3kuaGlnaCA9IDM7XG59KShBY2N1cmFjeSA9IGV4cG9ydHMuQWNjdXJhY3kgfHwgKGV4cG9ydHMuQWNjdXJhY3kgPSB7fSkpO1xudmFyIERvY2s7XG4oZnVuY3Rpb24gKERvY2spIHtcbiAgICBEb2NrLmxlZnQgPSBcImxlZnRcIjtcbiAgICBEb2NrLnRvcCA9IFwidG9wXCI7XG4gICAgRG9jay5yaWdodCA9IFwicmlnaHRcIjtcbiAgICBEb2NrLmJvdHRvbSA9IFwiYm90dG9tXCI7XG59KShEb2NrID0gZXhwb3J0cy5Eb2NrIHx8IChleHBvcnRzLkRvY2sgPSB7fSkpO1xudmFyIEF1dG9jYXBpdGFsaXphdGlvblR5cGU7XG4oZnVuY3Rpb24gKEF1dG9jYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICBBdXRvY2FwaXRhbGl6YXRpb25UeXBlLm5vbmUgPSBcIm5vbmVcIjtcbiAgICBBdXRvY2FwaXRhbGl6YXRpb25UeXBlLndvcmRzID0gXCJ3b3Jkc1wiO1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUuc2VudGVuY2VzID0gXCJzZW50ZW5jZXNcIjtcbiAgICBBdXRvY2FwaXRhbGl6YXRpb25UeXBlLmFsbENoYXJhY3RlcnMgPSBcImFsbGNoYXJhY3RlcnNcIjtcbn0pKEF1dG9jYXBpdGFsaXphdGlvblR5cGUgPSBleHBvcnRzLkF1dG9jYXBpdGFsaXphdGlvblR5cGUgfHwgKGV4cG9ydHMuQXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IHt9KSk7XG52YXIgTmF2aWdhdGlvbkJhclZpc2liaWxpdHk7XG4oZnVuY3Rpb24gKE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5KSB7XG4gICAgTmF2aWdhdGlvbkJhclZpc2liaWxpdHkuYXV0byA9IFwiYXV0b1wiO1xuICAgIE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5Lm5ldmVyID0gXCJuZXZlclwiO1xuICAgIE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5LmFsd2F5cyA9IFwiYWx3YXlzXCI7XG59KShOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSA9IGV4cG9ydHMuTmF2aWdhdGlvbkJhclZpc2liaWxpdHkgfHwgKGV4cG9ydHMuTmF2aWdhdGlvbkJhclZpc2liaWxpdHkgPSB7fSkpO1xudmFyIEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5KSB7XG4gICAgQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5LmF1dG8gPSBcImF1dG9cIjtcbiAgICBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkubmV2ZXIgPSBcIm5ldmVyXCI7XG4gICAgQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5LmFsd2F5cyA9IFwiYWx3YXlzXCI7XG59KShBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkgPSBleHBvcnRzLkFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSB8fCAoZXhwb3J0cy5BbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkgPSB7fSkpO1xudmFyIEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb247XG4oZnVuY3Rpb24gKEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24pIHtcbiAgICBBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uLmFjdGlvbkJhciA9IFwiYWN0aW9uQmFyXCI7XG4gICAgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbi5hY3Rpb25CYXJJZlJvb20gPSBcImFjdGlvbkJhcklmUm9vbVwiO1xuICAgIEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24ucG9wdXAgPSBcInBvcHVwXCI7XG59KShBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uID0gZXhwb3J0cy5BbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uIHx8IChleHBvcnRzLkFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24gPSB7fSkpO1xudmFyIElPU0FjdGlvbkl0ZW1Qb3NpdGlvbjtcbihmdW5jdGlvbiAoSU9TQWN0aW9uSXRlbVBvc2l0aW9uKSB7XG4gICAgSU9TQWN0aW9uSXRlbVBvc2l0aW9uLmxlZnQgPSBcImxlZnRcIjtcbiAgICBJT1NBY3Rpb25JdGVtUG9zaXRpb24ucmlnaHQgPSBcInJpZ2h0XCI7XG59KShJT1NBY3Rpb25JdGVtUG9zaXRpb24gPSBleHBvcnRzLklPU0FjdGlvbkl0ZW1Qb3NpdGlvbiB8fCAoZXhwb3J0cy5JT1NBY3Rpb25JdGVtUG9zaXRpb24gPSB7fSkpO1xudmFyIEltYWdlRm9ybWF0O1xuKGZ1bmN0aW9uIChJbWFnZUZvcm1hdCkge1xuICAgIEltYWdlRm9ybWF0LnBuZyA9IFwicG5nXCI7XG4gICAgSW1hZ2VGb3JtYXQuanBlZyA9IFwianBlZ1wiO1xuICAgIEltYWdlRm9ybWF0LmpwZyA9IFwianBnXCI7XG59KShJbWFnZUZvcm1hdCA9IGV4cG9ydHMuSW1hZ2VGb3JtYXQgfHwgKGV4cG9ydHMuSW1hZ2VGb3JtYXQgPSB7fSkpO1xudmFyIEZvbnRTdHlsZTtcbihmdW5jdGlvbiAoRm9udFN0eWxlKSB7XG4gICAgRm9udFN0eWxlLm5vcm1hbCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFN0eWxlLml0YWxpYyA9IFwiaXRhbGljXCI7XG59KShGb250U3R5bGUgPSBleHBvcnRzLkZvbnRTdHlsZSB8fCAoZXhwb3J0cy5Gb250U3R5bGUgPSB7fSkpO1xudmFyIEZvbnRXZWlnaHQ7XG4oZnVuY3Rpb24gKEZvbnRXZWlnaHQpIHtcbiAgICBGb250V2VpZ2h0LnRoaW4gPSBcIjEwMFwiO1xuICAgIEZvbnRXZWlnaHQuZXh0cmFMaWdodCA9IFwiMjAwXCI7XG4gICAgRm9udFdlaWdodC5saWdodCA9IFwiMzAwXCI7XG4gICAgRm9udFdlaWdodC5ub3JtYWwgPSBcIm5vcm1hbFwiO1xuICAgIEZvbnRXZWlnaHQubWVkaXVtID0gXCI1MDBcIjtcbiAgICBGb250V2VpZ2h0LnNlbWlCb2xkID0gXCI2MDBcIjtcbiAgICBGb250V2VpZ2h0LmJvbGQgPSBcImJvbGRcIjtcbiAgICBGb250V2VpZ2h0LmV4dHJhQm9sZCA9IFwiODAwXCI7XG4gICAgRm9udFdlaWdodC5ibGFjayA9IFwiOTAwXCI7XG59KShGb250V2VpZ2h0ID0gZXhwb3J0cy5Gb250V2VpZ2h0IHx8IChleHBvcnRzLkZvbnRXZWlnaHQgPSB7fSkpO1xudmFyIEJhY2tncm91bmRSZXBlYXQ7XG4oZnVuY3Rpb24gKEJhY2tncm91bmRSZXBlYXQpIHtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnJlcGVhdCA9IFwicmVwZWF0XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5yZXBlYXRYID0gXCJyZXBlYXQteFwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQucmVwZWF0WSA9IFwicmVwZWF0LXlcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0Lm5vUmVwZWF0ID0gXCJuby1yZXBlYXRcIjtcbn0pKEJhY2tncm91bmRSZXBlYXQgPSBleHBvcnRzLkJhY2tncm91bmRSZXBlYXQgfHwgKGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCA9IHt9KSk7XG52YXIgYW5pbWF0aW9uO1xudmFyIEFuaW1hdGlvbkN1cnZlO1xuKGZ1bmN0aW9uIChBbmltYXRpb25DdXJ2ZSkge1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2UgPSBcImVhc2VcIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5lYXNlSW4gPSBcImVhc2VJblwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2VPdXQgPSBcImVhc2VPdXRcIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5lYXNlSW5PdXQgPSBcImVhc2VJbk91dFwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmxpbmVhciA9IFwibGluZWFyXCI7XG4gICAgQW5pbWF0aW9uQ3VydmUuc3ByaW5nID0gXCJzcHJpbmdcIjtcbiAgICBmdW5jdGlvbiBjdWJpY0Jlemllcih4MSwgeTEsIHgyLCB5Mikge1xuICAgICAgICBhbmltYXRpb24gPSBhbmltYXRpb24gfHwgcmVxdWlyZShcIi4uL2FuaW1hdGlvblwiKTtcbiAgICAgICAgcmV0dXJuIG5ldyBhbmltYXRpb24uQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZSh4MSwgeTEsIHgyLCB5Mik7XG4gICAgfVxuICAgIEFuaW1hdGlvbkN1cnZlLmN1YmljQmV6aWVyID0gY3ViaWNCZXppZXI7XG59KShBbmltYXRpb25DdXJ2ZSA9IGV4cG9ydHMuQW5pbWF0aW9uQ3VydmUgfHwgKGV4cG9ydHMuQW5pbWF0aW9uQ3VydmUgPSB7fSkpO1xudmFyIFN0YXR1c0JhclN0eWxlO1xuKGZ1bmN0aW9uIChTdGF0dXNCYXJTdHlsZSkge1xuICAgIFN0YXR1c0JhclN0eWxlLmxpZ2h0ID0gXCJsaWdodFwiO1xuICAgIFN0YXR1c0JhclN0eWxlLmRhcmsgPSBcImRhcmtcIjtcbn0pKFN0YXR1c0JhclN0eWxlID0gZXhwb3J0cy5TdGF0dXNCYXJTdHlsZSB8fCAoZXhwb3J0cy5TdGF0dXNCYXJTdHlsZSA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbnVtcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuL2ZyYW1lXCIpO1xudmFyIGdsb2JhbHMgPSByZXF1aXJlKFwiLi4vLi4vZ2xvYmFsc1wiKTtcbnZhciBhcHBNb2R1bGUgPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG5pZiAoZ2xvYmFsLl9fc25hcHNob3QpIHtcbiAgICBnbG9iYWxzLmluc3RhbGwoKTtcbn1cbnZhciBOYXRpdmVTY3JpcHRBY3Rpdml0eSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE5hdGl2ZVNjcmlwdEFjdGl2aXR5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE5hdGl2ZVNjcmlwdEFjdGl2aXR5KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICB9XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICBhcHBNb2R1bGUuYW5kcm9pZC5pbml0KHRoaXMuZ2V0QXBwbGljYXRpb24oKSk7XG4gICAgICAgIHRoaXMuaXNOYXRpdmVTY3JpcHRBY3Rpdml0eSA9IHRydWU7XG4gICAgICAgIGlmICghdGhpcy5fY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICBmcmFtZV8xLnNldEFjdGl2aXR5Q2FsbGJhY2tzKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbkNyZWF0ZSh0aGlzLCBzYXZlZEluc3RhbmNlU3RhdGUsIHRoaXMuZ2V0SW50ZW50KCksIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGUpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uTmV3SW50ZW50ID0gZnVuY3Rpb24gKGludGVudCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25OZXdJbnRlbnQodGhpcywgaW50ZW50LCBfc3VwZXIucHJvdG90eXBlLnNldEludGVudCwgX3N1cGVyLnByb3RvdHlwZS5vbk5ld0ludGVudCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25TYXZlSW5zdGFuY2VTdGF0ZSA9IGZ1bmN0aW9uIChvdXRTdGF0ZSkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25TYXZlSW5zdGFuY2VTdGF0ZSh0aGlzLCBvdXRTdGF0ZSwgX3N1cGVyLnByb3RvdHlwZS5vblNhdmVJbnN0YW5jZVN0YXRlKTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5LnByb3RvdHlwZS5vblN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25TdGFydCh0aGlzLCBfc3VwZXIucHJvdG90eXBlLm9uU3RhcnQpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uU3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uU3RvcCh0aGlzLCBfc3VwZXIucHJvdG90eXBlLm9uU3RvcCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25EZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25EZXN0cm95KHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25EZXN0cm95KTtcbiAgICB9O1xuICAgIE5hdGl2ZVNjcmlwdEFjdGl2aXR5LnByb3RvdHlwZS5vblBvc3RSZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vblBvc3RSZXN1bWUodGhpcywgX3N1cGVyLnByb3RvdHlwZS5vblBvc3RSZXN1bWUpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbkJhY2tQcmVzc2VkKHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25CYWNrUHJlc3NlZCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eS5wcm90b3R5cGUub25SZXF1ZXN0UGVybWlzc2lvbnNSZXN1bHQgPSBmdW5jdGlvbiAocmVxdWVzdENvZGUsIHBlcm1pc3Npb25zLCBncmFudFJlc3VsdHMpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uUmVxdWVzdFBlcm1pc3Npb25zUmVzdWx0KHRoaXMsIHJlcXVlc3RDb2RlLCBwZXJtaXNzaW9ucywgZ3JhbnRSZXN1bHRzLCB1bmRlZmluZWQpO1xuICAgIH07XG4gICAgTmF0aXZlU2NyaXB0QWN0aXZpdHkucHJvdG90eXBlLm9uQWN0aXZpdHlSZXN1bHQgPSBmdW5jdGlvbiAocmVxdWVzdENvZGUsIHJlc3VsdENvZGUsIGRhdGEpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uQWN0aXZpdHlSZXN1bHQodGhpcywgcmVxdWVzdENvZGUsIHJlc3VsdENvZGUsIGRhdGEsIF9zdXBlci5wcm90b3R5cGUub25BY3Rpdml0eVJlc3VsdCk7XG4gICAgfTtcbiAgICBOYXRpdmVTY3JpcHRBY3Rpdml0eSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBKYXZhUHJveHkoXCJjb20udG5zLk5hdGl2ZVNjcmlwdEFjdGl2aXR5XCIpXG4gICAgXSwgTmF0aXZlU2NyaXB0QWN0aXZpdHkpO1xuICAgIHJldHVybiBOYXRpdmVTY3JpcHRBY3Rpdml0eTtcbn0oYW5kcm9pZHguYXBwY29tcGF0LmFwcC5BcHBDb21wYXRBY3Rpdml0eSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aXZpdHkuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuL2ZyYW1lXCIpO1xudmFyIEZyYWdtZW50Q2xhc3MgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGcmFnbWVudENsYXNzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZyYWdtZW50Q2xhc3MoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgIH1cbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS5vbkhpZGRlbkNoYW5nZWQgPSBmdW5jdGlvbiAoaGlkZGVuKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vbkhpZGRlbkNoYW5nZWQodGhpcywgaGlkZGVuLCBfc3VwZXIucHJvdG90eXBlLm9uSGlkZGVuQ2hhbmdlZCk7XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS5vbkNyZWF0ZUFuaW1hdG9yID0gZnVuY3Rpb24gKHRyYW5zaXQsIGVudGVyLCBuZXh0QW5pbSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FsbGJhY2tzLm9uQ3JlYXRlQW5pbWF0b3IodGhpcywgdHJhbnNpdCwgZW50ZXIsIG5leHRBbmltLCBfc3VwZXIucHJvdG90eXBlLm9uQ3JlYXRlQW5pbWF0b3IpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDbGFzcy5wcm90b3R5cGUub25TdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25TdG9wKHRoaXMsIF9zdXBlci5wcm90b3R5cGUub25TdG9wKTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uQ3JlYXRlID0gZnVuY3Rpb24gKHNhdmVkSW5zdGFuY2VTdGF0ZSkge1xuICAgICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrcykge1xuICAgICAgICAgICAgZnJhbWVfMS5zZXRGcmFnbWVudENhbGxiYWNrcyh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldEhhc09wdGlvbnNNZW51KHRydWUpO1xuICAgICAgICB0aGlzLl9jYWxsYmFja3Mub25DcmVhdGUodGhpcywgc2F2ZWRJbnN0YW5jZVN0YXRlLCBfc3VwZXIucHJvdG90eXBlLm9uQ3JlYXRlKTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uQ3JlYXRlVmlldyA9IGZ1bmN0aW9uIChpbmZsYXRlciwgY29udGFpbmVyLCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2NhbGxiYWNrcy5vbkNyZWF0ZVZpZXcodGhpcywgaW5mbGF0ZXIsIGNvbnRhaW5lciwgc2F2ZWRJbnN0YW5jZVN0YXRlLCBfc3VwZXIucHJvdG90eXBlLm9uQ3JlYXRlVmlldyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS5vblNhdmVJbnN0YW5jZVN0YXRlID0gZnVuY3Rpb24gKG91dFN0YXRlKSB7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrcy5vblNhdmVJbnN0YW5jZVN0YXRlKHRoaXMsIG91dFN0YXRlLCBfc3VwZXIucHJvdG90eXBlLm9uU2F2ZUluc3RhbmNlU3RhdGUpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDbGFzcy5wcm90b3R5cGUub25EZXN0cm95VmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uRGVzdHJveVZpZXcodGhpcywgX3N1cGVyLnByb3RvdHlwZS5vbkRlc3Ryb3lWaWV3KTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2xhc3MucHJvdG90eXBlLm9uRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzLm9uRGVzdHJveSh0aGlzLCBfc3VwZXIucHJvdG90eXBlLm9uRGVzdHJveSk7XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHRoaXMuX2NhbGxiYWNrcztcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy50b1N0cmluZ092ZXJyaWRlKHRoaXMsIF9zdXBlci5wcm90b3R5cGUudG9TdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFnbWVudENsYXNzID0gX19kZWNvcmF0ZShbXG4gICAgICAgIEphdmFQcm94eShcImNvbS50bnMuRnJhZ21lbnRDbGFzc1wiKVxuICAgIF0sIEZyYWdtZW50Q2xhc3MpO1xuICAgIHJldHVybiBGcmFnbWVudENsYXNzO1xufShvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuRnJhZ21lbnRCYXNlKSk7XG5mcmFtZV8xLnNldEZyYWdtZW50Q2xhc3MoRnJhZ21lbnRDbGFzcyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFnbWVudC5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmcmFtZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZyYW1lLWNvbW1vblwiKTtcbnZhciB0cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vdHJhbnNpdGlvbi90cmFuc2l0aW9uXCIpO1xudmFyIHNsaWRlX3RyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuLi90cmFuc2l0aW9uL3NsaWRlLXRyYW5zaXRpb25cIik7XG52YXIgZmFkZV90cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vdHJhbnNpdGlvbi9mYWRlLXRyYW5zaXRpb25cIik7XG52YXIgZmxpcF90cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vdHJhbnNpdGlvbi9mbGlwLXRyYW5zaXRpb25cIik7XG52YXIgYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi4vYW5pbWF0aW9uXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbGF6eV8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2xhenlcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbnZhciBzZGtWZXJzaW9uID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcGFyc2VJbnQocGxhdGZvcm1fMS5kZXZpY2Uuc2RrVmVyc2lvbik7IH0pO1xudmFyIGludEV2YWx1YXRvciA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLmFuaW1hdGlvbi5JbnRFdmFsdWF0b3IoKTsgfSk7XG52YXIgZGVmYXVsdEludGVycG9sYXRvciA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkFjY2VsZXJhdGVEZWNlbGVyYXRlSW50ZXJwb2xhdG9yKCk7IH0pO1xuZXhwb3J0cy53YWl0aW5nUXVldWUgPSBuZXcgTWFwKCk7XG5leHBvcnRzLmNvbXBsZXRlZEVudHJpZXMgPSBuZXcgTWFwKCk7XG52YXIgVHJhbnNpdGlvbkxpc3RlbmVyO1xudmFyIEFuaW1hdGlvbkxpc3RlbmVyO1xuZnVuY3Rpb24gX3NldEFuZHJvaWRGcmFnbWVudFRyYW5zaXRpb25zKGFuaW1hdGVkLCBuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgY3VycmVudEVudHJ5LCBuZXdFbnRyeSwgZnJhZ21lbnRUcmFuc2FjdGlvbiwgZnJhbWVJZCkge1xuICAgIHZhciBjdXJyZW50RnJhZ21lbnQgPSBjdXJyZW50RW50cnkgPyBjdXJyZW50RW50cnkuZnJhZ21lbnQgOiBudWxsO1xuICAgIHZhciBuZXdGcmFnbWVudCA9IG5ld0VudHJ5LmZyYWdtZW50O1xuICAgIHZhciBlbnRyaWVzID0gZXhwb3J0cy53YWl0aW5nUXVldWUuZ2V0KGZyYW1lSWQpO1xuICAgIGlmIChlbnRyaWVzICYmIGVudHJpZXMuc2l6ZSA+IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FsbGluZyBuYXZpZ2F0aW9uIGJlZm9yZSBwcmV2aW91cyBuYXZpZ2F0aW9uIGZpbmlzaC5cIik7XG4gICAgfVxuICAgIGlmIChzZGtWZXJzaW9uKCkgPj0gMjEpIHtcbiAgICAgICAgYWxsb3dUcmFuc2l0aW9uT3ZlcmxhcChjdXJyZW50RnJhZ21lbnQpO1xuICAgICAgICBhbGxvd1RyYW5zaXRpb25PdmVybGFwKG5ld0ZyYWdtZW50KTtcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBcIlwiO1xuICAgIHZhciB0cmFuc2l0aW9uO1xuICAgIGlmIChuYXZpZ2F0aW9uVHJhbnNpdGlvbikge1xuICAgICAgICB0cmFuc2l0aW9uID0gbmF2aWdhdGlvblRyYW5zaXRpb24uaW5zdGFuY2U7XG4gICAgICAgIG5hbWUgPSBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5uYW1lID8gbmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZS50b0xvd2VyQ2FzZSgpIDogXCJcIjtcbiAgICB9XG4gICAgdmFyIHVzZUxvbGxpcG9wVHJhbnNpdGlvbiA9ICEhKG5hbWUgJiYgKG5hbWUuaW5kZXhPZihcInNsaWRlXCIpID09PSAwIHx8IG5hbWUgPT09IFwiZmFkZVwiIHx8IG5hbWUgPT09IFwiZXhwbG9kZVwiKSAmJiBzZGtWZXJzaW9uKCkgPj0gMjEpO1xuICAgIGlmIChjdXJyZW50RnJhZ21lbnQgJiZcbiAgICAgICAgY3VycmVudEZyYWdtZW50LmdldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCkgJiZcbiAgICAgICAgY3VycmVudEZyYWdtZW50LmdldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCkuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdXNlTG9sbGlwb3BUcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgfVxuICAgIG5ld0VudHJ5LnVzZUxvbGxpcG9wVHJhbnNpdGlvbiA9IHVzZUxvbGxpcG9wVHJhbnNpdGlvbjtcbiAgICBpZiAoIWFuaW1hdGVkKSB7XG4gICAgICAgIG5hbWUgPSBcIm5vbmVcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHJhbnNpdGlvbikge1xuICAgICAgICBuYW1lID0gXCJjdXN0b21cIjtcbiAgICAgICAgdXNlTG9sbGlwb3BUcmFuc2l0aW9uID0gZmFsc2U7XG4gICAgfVxuICAgIGVsc2UgaWYgKCF1c2VMb2xsaXBvcFRyYW5zaXRpb24gJiYgbmFtZS5pbmRleE9mKFwic2xpZGVcIikgIT09IDAgJiYgbmFtZSAhPT0gXCJmYWRlXCIgJiYgbmFtZS5pbmRleE9mKFwiZmxpcFwiKSAhPT0gMCkge1xuICAgICAgICBuYW1lID0gXCJkZWZhdWx0XCI7XG4gICAgfVxuICAgIHZhciBjdXJyZW50RnJhZ21lbnROZWVkc0RpZmZlcmVudEFuaW1hdGlvbiA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50RW50cnkpIHtcbiAgICAgICAgX3VwZGF0ZVRyYW5zaXRpb25zKGN1cnJlbnRFbnRyeSk7XG4gICAgICAgIGlmIChjdXJyZW50RW50cnkudHJhbnNpdGlvbk5hbWUgIT09IG5hbWUgfHxcbiAgICAgICAgICAgIGN1cnJlbnRFbnRyeS50cmFuc2l0aW9uICE9PSB0cmFuc2l0aW9uIHx8XG4gICAgICAgICAgICAhIWN1cnJlbnRFbnRyeS51c2VMb2xsaXBvcFRyYW5zaXRpb24gIT09IHVzZUxvbGxpcG9wVHJhbnNpdGlvbiB8fFxuICAgICAgICAgICAgIXVzZUxvbGxpcG9wVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgY2xlYXJFeGl0QW5kUmVlbnRlclRyYW5zaXRpb25zKGN1cnJlbnRFbnRyeSwgdHJ1ZSk7XG4gICAgICAgICAgICBjdXJyZW50RnJhZ21lbnROZWVkc0RpZmZlcmVudEFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG5hbWUgPT09IFwibm9uZVwiKSB7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuZXcgTm9UcmFuc2l0aW9uKDAsIG51bGwpO1xuICAgIH1cbiAgICBlbHNlIGlmIChuYW1lID09PSBcImRlZmF1bHRcIikge1xuICAgICAgICB0cmFuc2l0aW9uID0gbmV3IGZhZGVfdHJhbnNpdGlvbl8xLkZhZGVUcmFuc2l0aW9uKDE1MCwgbnVsbCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHVzZUxvbGxpcG9wVHJhbnNpdGlvbikge1xuICAgICAgICBpZiAobmFtZS5pbmRleE9mKFwic2xpZGVcIikgPT09IDApIHtcbiAgICAgICAgICAgIHNldHVwTmV3RnJhZ21lbnRTbGlkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5ld0VudHJ5LCBuYW1lKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50RnJhZ21lbnROZWVkc0RpZmZlcmVudEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHNldHVwQ3VycmVudEZyYWdtZW50U2xpZGVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJyZW50RW50cnksIG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWUgPT09IFwiZmFkZVwiKSB7XG4gICAgICAgICAgICBzZXR1cE5ld0ZyYWdtZW50RmFkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5ld0VudHJ5KTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50RnJhZ21lbnROZWVkc0RpZmZlcmVudEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHNldHVwQ3VycmVudEZyYWdtZW50RmFkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGN1cnJlbnRFbnRyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gXCJleHBsb2RlXCIpIHtcbiAgICAgICAgICAgIHNldHVwTmV3RnJhZ21lbnRFeHBsb2RlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmV3RW50cnkpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgc2V0dXBDdXJyZW50RnJhZ21lbnRFeHBsb2RlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgY3VycmVudEVudHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChuYW1lLmluZGV4T2YoXCJzbGlkZVwiKSA9PT0gMCkge1xuICAgICAgICB2YXIgZGlyZWN0aW9uID0gbmFtZS5zdWJzdHIoXCJzbGlkZVwiLmxlbmd0aCkgfHwgXCJsZWZ0XCI7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuZXcgc2xpZGVfdHJhbnNpdGlvbl8xLlNsaWRlVHJhbnNpdGlvbihkaXJlY3Rpb24sIG5hdmlnYXRpb25UcmFuc2l0aW9uLmR1cmF0aW9uLCBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5jdXJ2ZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hbWUgPT09IFwiZmFkZVwiKSB7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuZXcgZmFkZV90cmFuc2l0aW9uXzEuRmFkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24sIG5hdmlnYXRpb25UcmFuc2l0aW9uLmN1cnZlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobmFtZS5pbmRleE9mKFwiZmxpcFwiKSA9PT0gMCkge1xuICAgICAgICB2YXIgZGlyZWN0aW9uID0gbmFtZS5zdWJzdHIoXCJmbGlwXCIubGVuZ3RoKSB8fCBcInJpZ2h0XCI7XG4gICAgICAgIHRyYW5zaXRpb24gPSBuZXcgZmxpcF90cmFuc2l0aW9uXzEuRmxpcFRyYW5zaXRpb24oZGlyZWN0aW9uLCBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbiwgbmF2aWdhdGlvblRyYW5zaXRpb24uY3VydmUpO1xuICAgIH1cbiAgICBuZXdFbnRyeS50cmFuc2l0aW9uTmFtZSA9IG5hbWU7XG4gICAgaWYgKG5hbWUgPT09IFwiY3VzdG9tXCIpIHtcbiAgICAgICAgbmV3RW50cnkudHJhbnNpdGlvbiA9IHRyYW5zaXRpb247XG4gICAgfVxuICAgIGlmICh0cmFuc2l0aW9uKSB7XG4gICAgICAgIGlmIChmcmFnbWVudFRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICBmcmFnbWVudFRyYW5zYWN0aW9uLnNldEN1c3RvbUFuaW1hdGlvbnMoLTEwLCAtMjApO1xuICAgICAgICB9XG4gICAgICAgIHNldHVwQWxsQW5pbWF0aW9uKG5ld0VudHJ5LCB0cmFuc2l0aW9uKTtcbiAgICAgICAgaWYgKGN1cnJlbnRGcmFnbWVudE5lZWRzRGlmZmVyZW50QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICBzZXR1cEV4aXRBbmRQb3BFbnRlckFuaW1hdGlvbihjdXJyZW50RW50cnksIHRyYW5zaXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjdXJyZW50RW50cnkpIHtcbiAgICAgICAgY3VycmVudEVudHJ5LnRyYW5zaXRpb25OYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiY3VzdG9tXCIpIHtcbiAgICAgICAgICAgIGN1cnJlbnRFbnRyeS50cmFuc2l0aW9uID0gdHJhbnNpdGlvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXR1cERlZmF1bHRBbmltYXRpb25zKG5ld0VudHJ5LCBuZXcgZmFkZV90cmFuc2l0aW9uXzEuRmFkZVRyYW5zaXRpb24oMTUwLCBudWxsKSk7XG4gICAgcHJpbnRUcmFuc2l0aW9ucyhjdXJyZW50RW50cnkpO1xuICAgIHByaW50VHJhbnNpdGlvbnMobmV3RW50cnkpO1xufVxuZXhwb3J0cy5fc2V0QW5kcm9pZEZyYWdtZW50VHJhbnNpdGlvbnMgPSBfc2V0QW5kcm9pZEZyYWdtZW50VHJhbnNpdGlvbnM7XG5mdW5jdGlvbiBfb25GcmFnbWVudENyZWF0ZUFuaW1hdG9yKGVudHJ5LCBmcmFnbWVudCwgbmV4dEFuaW0sIGVudGVyKSB7XG4gICAgdmFyIGFuaW1hdG9yO1xuICAgIHN3aXRjaCAobmV4dEFuaW0pIHtcbiAgICAgICAgY2FzZSAtMTA6XG4gICAgICAgICAgICBhbmltYXRvciA9IGVudHJ5LmVudGVyQW5pbWF0b3IgfHwgZW50cnkuZGVmYXVsdEVudGVyQW5pbWF0b3I7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAtMjA6XG4gICAgICAgICAgICBhbmltYXRvciA9IGVudHJ5LmV4aXRBbmltYXRvciB8fCBlbnRyeS5kZWZhdWx0RXhpdEFuaW1hdG9yO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgLTMwOlxuICAgICAgICAgICAgYW5pbWF0b3IgPSBlbnRyeS5wb3BFbnRlckFuaW1hdG9yO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgLTQwOlxuICAgICAgICAgICAgYW5pbWF0b3IgPSBlbnRyeS5wb3BFeGl0QW5pbWF0b3I7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKCFhbmltYXRvciAmJiBzZGtWZXJzaW9uKCkgPj0gMjEpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBmcmFnbWVudC5nZXRWaWV3KCk7XG4gICAgICAgIHZhciBqc1BhcmVudCA9IGVudHJ5LnJlc29sdmVkUGFnZS5wYXJlbnQ7XG4gICAgICAgIHZhciBwYXJlbnRfMSA9IHZpZXcuZ2V0UGFyZW50KCkgfHwgKGpzUGFyZW50ICYmIGpzUGFyZW50Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICB2YXIgYW5pbWF0ZWRFbnRyaWVzID0gX2dldEFuaW1hdGVkRW50cmllcyhlbnRyeS5mcmFtZUlkKTtcbiAgICAgICAgaWYgKCFhbmltYXRlZEVudHJpZXMgfHwgIWFuaW1hdGVkRW50cmllcy5oYXMoZW50cnkpKSB7XG4gICAgICAgICAgICBpZiAocGFyZW50XzEgJiYgIXBhcmVudF8xLmlzTGFpZE91dCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBlbnRlciA/IGVudHJ5LmRlZmF1bHRFbnRlckFuaW1hdG9yIDogZW50cnkuZGVmYXVsdEV4aXRBbmltYXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYW5pbWF0b3I7XG59XG5leHBvcnRzLl9vbkZyYWdtZW50Q3JlYXRlQW5pbWF0b3IgPSBfb25GcmFnbWVudENyZWF0ZUFuaW1hdG9yO1xuZnVuY3Rpb24gX2dldEFuaW1hdGVkRW50cmllcyhmcmFtZUlkKSB7XG4gICAgcmV0dXJuIGV4cG9ydHMud2FpdGluZ1F1ZXVlLmdldChmcmFtZUlkKTtcbn1cbmV4cG9ydHMuX2dldEFuaW1hdGVkRW50cmllcyA9IF9nZXRBbmltYXRlZEVudHJpZXM7XG5mdW5jdGlvbiBfdXBkYXRlVHJhbnNpdGlvbnMoZW50cnkpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICB2YXIgZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgPSBlbnRyeS5lbnRlclRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICBpZiAoZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgJiYgZnJhZ21lbnQpIHtcbiAgICAgICAgZnJhZ21lbnQuc2V0RW50ZXJUcmFuc2l0aW9uKGVudGVyVHJhbnNpdGlvbkxpc3RlbmVyLnRyYW5zaXRpb24pO1xuICAgIH1cbiAgICB2YXIgZXhpdFRyYW5zaXRpb25MaXN0ZW5lciA9IGVudHJ5LmV4aXRUcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgaWYgKGV4aXRUcmFuc2l0aW9uTGlzdGVuZXIgJiYgZnJhZ21lbnQpIHtcbiAgICAgICAgZnJhZ21lbnQuc2V0RXhpdFRyYW5zaXRpb24oZXhpdFRyYW5zaXRpb25MaXN0ZW5lci50cmFuc2l0aW9uKTtcbiAgICB9XG4gICAgdmFyIHJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIgPSBlbnRyeS5yZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgIGlmIChyZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyICYmIGZyYWdtZW50KSB7XG4gICAgICAgIGZyYWdtZW50LnNldFJlZW50ZXJUcmFuc2l0aW9uKHJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIudHJhbnNpdGlvbik7XG4gICAgfVxuICAgIHZhciByZXR1cm5UcmFuc2l0aW9uTGlzdGVuZXIgPSBlbnRyeS5yZXR1cm5UcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgaWYgKHJldHVyblRyYW5zaXRpb25MaXN0ZW5lciAmJiBmcmFnbWVudCkge1xuICAgICAgICBmcmFnbWVudC5zZXRSZXR1cm5UcmFuc2l0aW9uKHJldHVyblRyYW5zaXRpb25MaXN0ZW5lci50cmFuc2l0aW9uKTtcbiAgICB9XG59XG5leHBvcnRzLl91cGRhdGVUcmFuc2l0aW9ucyA9IF91cGRhdGVUcmFuc2l0aW9ucztcbmZ1bmN0aW9uIF9yZXZlcnNlVHJhbnNpdGlvbnMocHJldmlvdXNFbnRyeSwgY3VycmVudEVudHJ5KSB7XG4gICAgdmFyIHByZXZpb3VzRnJhZ21lbnQgPSBwcmV2aW91c0VudHJ5LmZyYWdtZW50O1xuICAgIHZhciBjdXJyZW50RnJhZ21lbnQgPSBjdXJyZW50RW50cnkuZnJhZ21lbnQ7XG4gICAgdmFyIHRyYW5zaXRpb25Vc2VkID0gZmFsc2U7XG4gICAgaWYgKHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICB2YXIgcmV0dXJuVHJhbnNpdGlvbkxpc3RlbmVyID0gY3VycmVudEVudHJ5LnJldHVyblRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICAgICAgaWYgKHJldHVyblRyYW5zaXRpb25MaXN0ZW5lcikge1xuICAgICAgICAgICAgdHJhbnNpdGlvblVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgY3VycmVudEZyYWdtZW50LnNldEV4aXRUcmFuc2l0aW9uKHJldHVyblRyYW5zaXRpb25MaXN0ZW5lci50cmFuc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnRGcmFnbWVudC5zZXRFeGl0VHJhbnNpdGlvbihudWxsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lciA9IHByZXZpb3VzRW50cnkucmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICAgICAgaWYgKHJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRyYW5zaXRpb25Vc2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHByZXZpb3VzRnJhZ21lbnQuc2V0RW50ZXJUcmFuc2l0aW9uKHJlZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXIudHJhbnNpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcmV2aW91c0ZyYWdtZW50LnNldEVudGVyVHJhbnNpdGlvbihudWxsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJhbnNpdGlvblVzZWQ7XG59XG5leHBvcnRzLl9yZXZlcnNlVHJhbnNpdGlvbnMgPSBfcmV2ZXJzZVRyYW5zaXRpb25zO1xuZnVuY3Rpb24gZ2V0VHJhbnNpdGlvbkxpc3RlbmVyKGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgaWYgKCFUcmFuc2l0aW9uTGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIFRyYW5zaXRpb25MaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFRyYW5zaXRpb25MaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsKGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5lbnRyeSA9IGVudHJ5O1xuICAgICAgICAgICAgICAgIF90aGlzLnRyYW5zaXRpb24gPSB0cmFuc2l0aW9uO1xuICAgICAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVHJhbnNpdGlvbkxpc3RlbmVySW1wbC5wcm90b3R5cGUub25UcmFuc2l0aW9uU3RhcnQgPSBmdW5jdGlvbiAodHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgICAgICAgICAgICAgYWRkVG9XYWl0aW5nUXVldWUoZW50cnkpO1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJTVEFSVCBcIiArIHRvU2hvcnRTdHJpbmcodHJhbnNpdGlvbikgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIGVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uVHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5lbnRyeTtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRU5EIFwiICsgdG9TaG9ydFN0cmluZyh0cmFuc2l0aW9uKSArIFwiIHRyYW5zaXRpb24gZm9yIFwiICsgZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbk9yQW5pbWF0aW9uQ29tcGxldGVkKGVudHJ5KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRyYW5zaXRpb25SZXN1bWUgPSBmdW5jdGlvbiAodHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IHRoaXMuZW50cnkuZnJhZ21lbnRUYWc7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJSRVNVTUUgXCIgKyB0b1Nob3J0U3RyaW5nKHRyYW5zaXRpb24pICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyBmcmFnbWVudCwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRyYW5zaXRpb25QYXVzZSA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlBBVVNFIFwiICsgdG9TaG9ydFN0cmluZyh0cmFuc2l0aW9uKSArIFwiIHRyYW5zaXRpb24gZm9yIFwiICsgdGhpcy5lbnRyeS5mcmFnbWVudFRhZywgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBUcmFuc2l0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblRyYW5zaXRpb25DYW5jZWwgPSBmdW5jdGlvbiAodHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDQU5DRUwgXCIgKyB0b1Nob3J0U3RyaW5nKHRyYW5zaXRpb24pICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyB0aGlzLmVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLnRyYW5zaXRpb24uVHJhbnNpdGlvbi5UcmFuc2l0aW9uTGlzdGVuZXJdKVxuICAgICAgICAgICAgXSwgVHJhbnNpdGlvbkxpc3RlbmVySW1wbCk7XG4gICAgICAgICAgICByZXR1cm4gVHJhbnNpdGlvbkxpc3RlbmVySW1wbDtcbiAgICAgICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgICAgIFRyYW5zaXRpb25MaXN0ZW5lciA9IFRyYW5zaXRpb25MaXN0ZW5lckltcGw7XG4gICAgfVxuICAgIHJldHVybiBuZXcgVHJhbnNpdGlvbkxpc3RlbmVyKGVudHJ5LCB0cmFuc2l0aW9uKTtcbn1cbmZ1bmN0aW9uIGdldEFuaW1hdGlvbkxpc3RlbmVyKCkge1xuICAgIGlmICghQW5pbWF0aW9uTGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIEFuaW1hdGlvbkxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoQW5pbWF0aW9uTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gQW5pbWF0aW9uTGlzdGVuZXJJbXBsKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBbmltYXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uQW5pbWF0aW9uU3RhcnQgPSBmdW5jdGlvbiAoYW5pbWF0b3IpIHtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnkgPSBhbmltYXRvci5lbnRyeTtcbiAgICAgICAgICAgICAgICBhZGRUb1dhaXRpbmdRdWV1ZShlbnRyeSk7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlNUQVJUIFwiICsgYW5pbWF0b3IudHJhbnNpdGlvblR5cGUgKyBcIiBmb3IgXCIgKyBlbnRyeS5mcmFnbWVudFRhZywgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBbmltYXRpb25MaXN0ZW5lckltcGwucHJvdG90eXBlLm9uQW5pbWF0aW9uUmVwZWF0ID0gZnVuY3Rpb24gKGFuaW1hdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlJFUEVBVCBcIiArIGFuaW1hdG9yLnRyYW5zaXRpb25UeXBlICsgXCIgZm9yIFwiICsgYW5pbWF0b3IuZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQW5pbWF0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkFuaW1hdGlvbkVuZCA9IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJFTkQgXCIgKyBhbmltYXRvci50cmFuc2l0aW9uVHlwZSArIFwiIGZvciBcIiArIGFuaW1hdG9yLmVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyYW5zaXRpb25PckFuaW1hdGlvbkNvbXBsZXRlZChhbmltYXRvci5lbnRyeSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgQW5pbWF0aW9uTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkFuaW1hdGlvbkNhbmNlbCA9IGZ1bmN0aW9uIChhbmltYXRvcikge1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDQU5DRUwgXCIgKyBhbmltYXRvci50cmFuc2l0aW9uVHlwZSArIFwiIGZvciBcIiArIGFuaW1hdG9yLmVudHJ5LmZyYWdtZW50VGFnLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEFuaW1hdGlvbkxpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLkFuaW1hdG9yTGlzdGVuZXJdKVxuICAgICAgICAgICAgXSwgQW5pbWF0aW9uTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgICAgIHJldHVybiBBbmltYXRpb25MaXN0ZW5lckltcGw7XG4gICAgICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgICAgICBBbmltYXRpb25MaXN0ZW5lciA9IG5ldyBBbmltYXRpb25MaXN0ZW5lckltcGwoKTtcbiAgICB9XG4gICAgcmV0dXJuIEFuaW1hdGlvbkxpc3RlbmVyO1xufVxuZnVuY3Rpb24gYWRkVG9XYWl0aW5nUXVldWUoZW50cnkpIHtcbiAgICB2YXIgZnJhbWVJZCA9IGVudHJ5LmZyYW1lSWQ7XG4gICAgdmFyIGVudHJpZXMgPSBleHBvcnRzLndhaXRpbmdRdWV1ZS5nZXQoZnJhbWVJZCk7XG4gICAgaWYgKCFlbnRyaWVzKSB7XG4gICAgICAgIGVudHJpZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIGV4cG9ydHMud2FpdGluZ1F1ZXVlLnNldChmcmFtZUlkLCBlbnRyaWVzKTtcbiAgICB9XG4gICAgZW50cmllcy5hZGQoZW50cnkpO1xufVxuZnVuY3Rpb24gY2xlYXJBbmltYXRpb25MaXN0ZW5lcihhbmltYXRvciwgbGlzdGVuZXIpIHtcbiAgICBpZiAoIWFuaW1hdG9yKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYW5pbWF0b3IucmVtb3ZlTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGlmIChhbmltYXRvci5lbnRyeSAmJiB0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IGFuaW1hdG9yLmVudHJ5O1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ2xlYXIgXCIgKyBhbmltYXRvci50cmFuc2l0aW9uVHlwZSArIFwiIC0gXCIgKyBlbnRyeS50cmFuc2l0aW9uICsgXCIgZm9yIFwiICsgZW50cnkuZnJhZ21lbnRUYWcsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICB9XG4gICAgYW5pbWF0b3IuZW50cnkgPSBudWxsO1xufVxuZnVuY3Rpb24gY2xlYXJFeGl0QW5kUmVlbnRlclRyYW5zaXRpb25zKGVudHJ5LCByZW1vdmVMaXN0ZW5lcikge1xuICAgIGlmIChzZGtWZXJzaW9uKCkgPj0gMjEpIHtcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gZW50cnkuZnJhZ21lbnQ7XG4gICAgICAgIHZhciBleGl0TGlzdGVuZXIgPSBlbnRyeS5leGl0VHJhbnNpdGlvbkxpc3RlbmVyO1xuICAgICAgICBpZiAoZXhpdExpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgZXhpdFRyYW5zaXRpb24gPSBmcmFnbWVudC5nZXRFeGl0VHJhbnNpdGlvbigpO1xuICAgICAgICAgICAgaWYgKGV4aXRUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4aXRUcmFuc2l0aW9uLnJlbW92ZUxpc3RlbmVyKGV4aXRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldEV4aXRUcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDbGVhcmVkIEV4aXQgXCIgKyBleGl0VHJhbnNpdGlvbi5nZXRDbGFzcygpLmdldFNpbXBsZU5hbWUoKSArIFwiIHRyYW5zaXRpb24gZm9yIFwiICsgZnJhZ21lbnQsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBlbnRyeS5leGl0VHJhbnNpdGlvbkxpc3RlbmVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVlbnRlckxpc3RlbmVyID0gZW50cnkucmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lcjtcbiAgICAgICAgaWYgKHJlZW50ZXJMaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIHJlZW50ZXJUcmFuc2l0aW9uID0gZnJhZ21lbnQuZ2V0UmVlbnRlclRyYW5zaXRpb24oKTtcbiAgICAgICAgICAgIGlmIChyZWVudGVyVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChyZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgICByZWVudGVyVHJhbnNpdGlvbi5yZW1vdmVMaXN0ZW5lcihyZWVudGVyTGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRSZWVudGVyVHJhbnNpdGlvbihudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ2xlYXJlZCBSZWVudGVyIFwiICsgcmVlbnRlclRyYW5zaXRpb24uZ2V0Q2xhc3MoKS5nZXRTaW1wbGVOYW1lKCkgKyBcIiB0cmFuc2l0aW9uIGZvciBcIiArIGZyYWdtZW50LCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgZW50cnkucmVlbnRlclRyYW5zaXRpb25MaXN0ZW5lciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBfY2xlYXJGcmFnbWVudChlbnRyeSkge1xuICAgIGNsZWFyRW50cnkoZW50cnksIGZhbHNlKTtcbn1cbmV4cG9ydHMuX2NsZWFyRnJhZ21lbnQgPSBfY2xlYXJGcmFnbWVudDtcbmZ1bmN0aW9uIF9jbGVhckVudHJ5KGVudHJ5KSB7XG4gICAgY2xlYXJFbnRyeShlbnRyeSwgdHJ1ZSk7XG59XG5leHBvcnRzLl9jbGVhckVudHJ5ID0gX2NsZWFyRW50cnk7XG5mdW5jdGlvbiBjbGVhckVudHJ5KGVudHJ5LCByZW1vdmVMaXN0ZW5lcikge1xuICAgIGNsZWFyRXhpdEFuZFJlZW50ZXJUcmFuc2l0aW9ucyhlbnRyeSwgcmVtb3ZlTGlzdGVuZXIpO1xuICAgIGlmIChzZGtWZXJzaW9uKCkgPj0gMjEpIHtcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gZW50cnkuZnJhZ21lbnQ7XG4gICAgICAgIHZhciBlbnRlckxpc3RlbmVyID0gZW50cnkuZW50ZXJUcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgICAgIGlmIChlbnRlckxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgZW50ZXJUcmFuc2l0aW9uID0gZnJhZ21lbnQuZ2V0RW50ZXJUcmFuc2l0aW9uKCk7XG4gICAgICAgICAgICBpZiAoZW50ZXJUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGVyVHJhbnNpdGlvbi5yZW1vdmVMaXN0ZW5lcihlbnRlckxpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0RW50ZXJUcmFuc2l0aW9uKG51bGwpO1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDbGVhcmVkIEVudGVyIFwiICsgZW50ZXJUcmFuc2l0aW9uLmdldENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyBmcmFnbWVudCwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGVudHJ5LmVudGVyVHJhbnNpdGlvbkxpc3RlbmVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcmV0dXJuTGlzdGVuZXIgPSBlbnRyeS5yZXR1cm5UcmFuc2l0aW9uTGlzdGVuZXI7XG4gICAgICAgIGlmIChyZXR1cm5MaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIHJldHVyblRyYW5zaXRpb24gPSBmcmFnbWVudC5nZXRSZXR1cm5UcmFuc2l0aW9uKCk7XG4gICAgICAgICAgICBpZiAocmV0dXJuVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChyZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5UcmFuc2l0aW9uLnJlbW92ZUxpc3RlbmVyKHJldHVybkxpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0UmV0dXJuVHJhbnNpdGlvbihudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ2xlYXJlZCBSZXR1cm4gXCIgKyByZXR1cm5UcmFuc2l0aW9uLmdldENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpICsgXCIgdHJhbnNpdGlvbiBmb3IgXCIgKyBmcmFnbWVudCwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1vdmVMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgIGVudHJ5LnJldHVyblRyYW5zaXRpb25MaXN0ZW5lciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJlbW92ZUxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGdldEFuaW1hdGlvbkxpc3RlbmVyKCk7XG4gICAgICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkuZW50ZXJBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgICAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LmV4aXRBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgICAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LnBvcEVudGVyQW5pbWF0b3IsIGxpc3RlbmVyKTtcbiAgICAgICAgY2xlYXJBbmltYXRpb25MaXN0ZW5lcihlbnRyeS5wb3BFeGl0QW5pbWF0b3IsIGxpc3RlbmVyKTtcbiAgICAgICAgY2xlYXJBbmltYXRpb25MaXN0ZW5lcihlbnRyeS5kZWZhdWx0RW50ZXJBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgICAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LmRlZmF1bHRFeGl0QW5pbWF0b3IsIGxpc3RlbmVyKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhbGxvd1RyYW5zaXRpb25PdmVybGFwKGZyYWdtZW50KSB7XG4gICAgaWYgKGZyYWdtZW50KSB7XG4gICAgICAgIGZyYWdtZW50LnNldEFsbG93RW50ZXJUcmFuc2l0aW9uT3ZlcmxhcCh0cnVlKTtcbiAgICAgICAgZnJhZ21lbnQuc2V0QWxsb3dSZXR1cm5UcmFuc2l0aW9uT3ZlcmxhcCh0cnVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRFbnRlclRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgc2V0VXBOYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcbiAgICB2YXIgbGlzdGVuZXIgPSBhZGROYXRpdmVUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pO1xuICAgIGVudHJ5LmVudGVyVHJhbnNpdGlvbkxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgdmFyIGZyYWdtZW50ID0gZW50cnkuZnJhZ21lbnQ7XG4gICAgZnJhZ21lbnQuc2V0RW50ZXJUcmFuc2l0aW9uKHRyYW5zaXRpb24pO1xufVxuZnVuY3Rpb24gc2V0RXhpdFRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgc2V0VXBOYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcbiAgICB2YXIgbGlzdGVuZXIgPSBhZGROYXRpdmVUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIHRyYW5zaXRpb24pO1xuICAgIGVudHJ5LmV4aXRUcmFuc2l0aW9uTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICBmcmFnbWVudC5zZXRFeGl0VHJhbnNpdGlvbih0cmFuc2l0aW9uKTtcbn1cbmZ1bmN0aW9uIHNldFJlZW50ZXJUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBlbnRyeSwgdHJhbnNpdGlvbikge1xuICAgIHNldFVwTmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgdHJhbnNpdGlvbik7XG4gICAgdmFyIGxpc3RlbmVyID0gYWRkTmF0aXZlVHJhbnNpdGlvbkxpc3RlbmVyKGVudHJ5LCB0cmFuc2l0aW9uKTtcbiAgICBlbnRyeS5yZWVudGVyVHJhbnNpdGlvbkxpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgdmFyIGZyYWdtZW50ID0gZW50cnkuZnJhZ21lbnQ7XG4gICAgZnJhZ21lbnQuc2V0UmVlbnRlclRyYW5zaXRpb24odHJhbnNpdGlvbik7XG59XG5mdW5jdGlvbiBzZXRSZXR1cm5UcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBlbnRyeSwgdHJhbnNpdGlvbikge1xuICAgIHNldFVwTmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgdHJhbnNpdGlvbik7XG4gICAgdmFyIGxpc3RlbmVyID0gYWRkTmF0aXZlVHJhbnNpdGlvbkxpc3RlbmVyKGVudHJ5LCB0cmFuc2l0aW9uKTtcbiAgICBlbnRyeS5yZXR1cm5UcmFuc2l0aW9uTGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB2YXIgZnJhZ21lbnQgPSBlbnRyeS5mcmFnbWVudDtcbiAgICBmcmFnbWVudC5zZXRSZXR1cm5UcmFuc2l0aW9uKHRyYW5zaXRpb24pO1xufVxuZnVuY3Rpb24gc2V0dXBOZXdGcmFnbWVudFNsaWRlVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmFtZSkge1xuICAgIHNldHVwQ3VycmVudEZyYWdtZW50U2xpZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuYW1lKTtcbiAgICB2YXIgZGlyZWN0aW9uID0gbmFtZS5zdWJzdHIoXCJzbGlkZVwiLmxlbmd0aCkgfHwgXCJsZWZ0XCI7XG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgIHNldEVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5SSUdIVCkpO1xuICAgICAgICAgICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5SSUdIVCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LkxFRlQpKTtcbiAgICAgICAgICAgIHNldFJldHVyblRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuTEVGVCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgIHNldEVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5CT1RUT00pKTtcbiAgICAgICAgICAgIHNldFJldHVyblRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuQk9UVE9NKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgc2V0RW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCkpO1xuICAgICAgICAgICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5UT1ApKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldHVwQ3VycmVudEZyYWdtZW50U2xpZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuYW1lKSB7XG4gICAgdmFyIGRpcmVjdGlvbiA9IG5hbWUuc3Vic3RyKFwic2xpZGVcIi5sZW5ndGgpIHx8IFwibGVmdFwiO1xuICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICBzZXRFeGl0VHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5MRUZUKSk7XG4gICAgICAgICAgICBzZXRSZWVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5MRUZUKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICBzZXRFeGl0VHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5SSUdIVCkpO1xuICAgICAgICAgICAgc2V0UmVlbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuUklHSFQpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICBzZXRFeGl0VHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5TbGlkZShhbmRyb2lkLnZpZXcuR3Jhdml0eS5UT1ApKTtcbiAgICAgICAgICAgIHNldFJlZW50ZXJUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCkpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgIHNldEV4aXRUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLlNsaWRlKGFuZHJvaWQudmlldy5HcmF2aXR5LkJPVFRPTSkpO1xuICAgICAgICAgICAgc2V0UmVlbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uU2xpZGUoYW5kcm9pZC52aWV3LkdyYXZpdHkuQk9UVE9NKSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59XG5mdW5jdGlvbiBzZXR1cE5ld0ZyYWdtZW50RmFkZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnkpIHtcbiAgICBzZXR1cEN1cnJlbnRGcmFnbWVudEZhZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5KTtcbiAgICB2YXIgZmFkZUluRW50ZXIgPSBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUoYW5kcm9pZC50cmFuc2l0aW9uLkZhZGUuSU4pO1xuICAgIHNldEVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgZmFkZUluRW50ZXIpO1xuICAgIHZhciBmYWRlT3V0UmV0dXJuID0gbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlKGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlLk9VVCk7XG4gICAgc2V0UmV0dXJuVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgZmFkZU91dFJldHVybik7XG59XG5mdW5jdGlvbiBzZXR1cEN1cnJlbnRGcmFnbWVudEZhZGVUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5KSB7XG4gICAgdmFyIGZhZGVPdXRFeGl0ID0gbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlKGFuZHJvaWQudHJhbnNpdGlvbi5GYWRlLk9VVCk7XG4gICAgc2V0RXhpdFRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIGZhZGVPdXRFeGl0KTtcbiAgICB2YXIgZmFkZUluUmVlbnRlciA9IG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uRmFkZShhbmRyb2lkLnRyYW5zaXRpb24uRmFkZS5JTik7XG4gICAgc2V0UmVlbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIGZhZGVJblJlZW50ZXIpO1xufVxuZnVuY3Rpb24gc2V0dXBDdXJyZW50RnJhZ21lbnRFeHBsb2RlVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSkge1xuICAgIHNldEV4aXRUcmFuc2l0aW9uKG5hdlRyYW5zaXRpb24sIGVudHJ5LCBuZXcgYW5kcm9pZC50cmFuc2l0aW9uLkV4cGxvZGUoKSk7XG4gICAgc2V0UmVlbnRlclRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uRXhwbG9kZSgpKTtcbn1cbmZ1bmN0aW9uIHNldHVwTmV3RnJhZ21lbnRFeHBsb2RlVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSkge1xuICAgIHNldHVwQ3VycmVudEZyYWdtZW50RXhwbG9kZVRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnkpO1xuICAgIHNldEVudGVyVHJhbnNpdGlvbihuYXZUcmFuc2l0aW9uLCBlbnRyeSwgbmV3IGFuZHJvaWQudHJhbnNpdGlvbi5FeHBsb2RlKCkpO1xuICAgIHNldFJldHVyblRyYW5zaXRpb24obmF2VHJhbnNpdGlvbiwgZW50cnksIG5ldyBhbmRyb2lkLnRyYW5zaXRpb24uRXhwbG9kZSgpKTtcbn1cbmZ1bmN0aW9uIHNldHVwRXhpdEFuZFBvcEVudGVyQW5pbWF0aW9uKGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgdmFyIGxpc3RlbmVyID0gZ2V0QW5pbWF0aW9uTGlzdGVuZXIoKTtcbiAgICBjbGVhckFuaW1hdGlvbkxpc3RlbmVyKGVudHJ5LmV4aXRBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgIGNsZWFyQW5pbWF0aW9uTGlzdGVuZXIoZW50cnkucG9wRW50ZXJBbmltYXRvciwgbGlzdGVuZXIpO1xuICAgIHZhciBleGl0QW5pbWF0b3IgPSB0cmFuc2l0aW9uLmNyZWF0ZUFuZHJvaWRBbmltYXRvcih0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQpO1xuICAgIGV4aXRBbmltYXRvci50cmFuc2l0aW9uVHlwZSA9IHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDtcbiAgICBleGl0QW5pbWF0b3IuZW50cnkgPSBlbnRyeTtcbiAgICBleGl0QW5pbWF0b3IuYWRkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGVudHJ5LmV4aXRBbmltYXRvciA9IGV4aXRBbmltYXRvcjtcbiAgICB2YXIgcG9wRW50ZXJBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXIpO1xuICAgIHBvcEVudGVyQW5pbWF0b3IudHJhbnNpdGlvblR5cGUgPSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEVudGVyO1xuICAgIHBvcEVudGVyQW5pbWF0b3IuZW50cnkgPSBlbnRyeTtcbiAgICBwb3BFbnRlckFuaW1hdG9yLmFkZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICBlbnRyeS5wb3BFbnRlckFuaW1hdG9yID0gcG9wRW50ZXJBbmltYXRvcjtcbn1cbmZ1bmN0aW9uIHNldHVwQWxsQW5pbWF0aW9uKGVudHJ5LCB0cmFuc2l0aW9uKSB7XG4gICAgc2V0dXBFeGl0QW5kUG9wRW50ZXJBbmltYXRpb24oZW50cnksIHRyYW5zaXRpb24pO1xuICAgIHZhciBsaXN0ZW5lciA9IGdldEFuaW1hdGlvbkxpc3RlbmVyKCk7XG4gICAgdmFyIGVudGVyQW5pbWF0b3IgPSB0cmFuc2l0aW9uLmNyZWF0ZUFuZHJvaWRBbmltYXRvcih0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyKTtcbiAgICBlbnRlckFuaW1hdG9yLnRyYW5zaXRpb25UeXBlID0gdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjtcbiAgICBlbnRlckFuaW1hdG9yLmVudHJ5ID0gZW50cnk7XG4gICAgZW50ZXJBbmltYXRvci5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZW50cnkuZW50ZXJBbmltYXRvciA9IGVudGVyQW5pbWF0b3I7XG4gICAgdmFyIHBvcEV4aXRBbmltYXRvciA9IHRyYW5zaXRpb24uY3JlYXRlQW5kcm9pZEFuaW1hdG9yKHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRXhpdCk7XG4gICAgcG9wRXhpdEFuaW1hdG9yLnRyYW5zaXRpb25UeXBlID0gdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0O1xuICAgIHBvcEV4aXRBbmltYXRvci5lbnRyeSA9IGVudHJ5O1xuICAgIHBvcEV4aXRBbmltYXRvci5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZW50cnkucG9wRXhpdEFuaW1hdG9yID0gcG9wRXhpdEFuaW1hdG9yO1xufVxuZnVuY3Rpb24gc2V0dXBEZWZhdWx0QW5pbWF0aW9ucyhlbnRyeSwgdHJhbnNpdGlvbikge1xuICAgIHZhciBsaXN0ZW5lciA9IGdldEFuaW1hdGlvbkxpc3RlbmVyKCk7XG4gICAgdmFyIGVudGVyQW5pbWF0b3IgPSB0cmFuc2l0aW9uLmNyZWF0ZUFuZHJvaWRBbmltYXRvcih0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyKTtcbiAgICBlbnRlckFuaW1hdG9yLnRyYW5zaXRpb25UeXBlID0gdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjtcbiAgICBlbnRlckFuaW1hdG9yLmVudHJ5ID0gZW50cnk7XG4gICAgZW50ZXJBbmltYXRvci5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgZW50cnkuZGVmYXVsdEVudGVyQW5pbWF0b3IgPSBlbnRlckFuaW1hdG9yO1xuICAgIHZhciBleGl0QW5pbWF0b3IgPSB0cmFuc2l0aW9uLmNyZWF0ZUFuZHJvaWRBbmltYXRvcih0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQpO1xuICAgIGV4aXRBbmltYXRvci50cmFuc2l0aW9uVHlwZSA9IHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDtcbiAgICBleGl0QW5pbWF0b3IuZW50cnkgPSBlbnRyeTtcbiAgICBleGl0QW5pbWF0b3IuYWRkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIGVudHJ5LmRlZmF1bHRFeGl0QW5pbWF0b3IgPSBleGl0QW5pbWF0b3I7XG59XG5mdW5jdGlvbiBzZXRVcE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICBpZiAobmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24pIHtcbiAgICAgICAgbmF0aXZlVHJhbnNpdGlvbi5zZXREdXJhdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbik7XG4gICAgfVxuICAgIHZhciBpbnRlcnBvbGF0b3IgPSBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5jdXJ2ZSA/IGFuaW1hdGlvbl8xLl9yZXNvbHZlQW5pbWF0aW9uQ3VydmUobmF2aWdhdGlvblRyYW5zaXRpb24uY3VydmUpIDogZGVmYXVsdEludGVycG9sYXRvcigpO1xuICAgIG5hdGl2ZVRyYW5zaXRpb24uc2V0SW50ZXJwb2xhdG9yKGludGVycG9sYXRvcik7XG59XG5mdW5jdGlvbiBhZGROYXRpdmVUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIG5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICB2YXIgbGlzdGVuZXIgPSBnZXRUcmFuc2l0aW9uTGlzdGVuZXIoZW50cnksIG5hdGl2ZVRyYW5zaXRpb24pO1xuICAgIG5hdGl2ZVRyYW5zaXRpb24uYWRkTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIHJldHVybiBsaXN0ZW5lcjtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25PckFuaW1hdGlvbkNvbXBsZXRlZChlbnRyeSkge1xuICAgIHZhciBmcmFtZUlkID0gZW50cnkuZnJhbWVJZDtcbiAgICB2YXIgZW50cmllcyA9IGV4cG9ydHMud2FpdGluZ1F1ZXVlLmdldChmcmFtZUlkKTtcbiAgICBpZiAoIWVudHJpZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbnRyaWVzLmRlbGV0ZShlbnRyeSk7XG4gICAgaWYgKGVudHJpZXMuc2l6ZSA9PT0gMCkge1xuICAgICAgICB2YXIgZnJhbWVfMSA9IGVudHJ5LnJlc29sdmVkUGFnZS5mcmFtZTtcbiAgICAgICAgdmFyIHByZXZpb3VzQ29tcGxldGVkQW5pbWF0aW9uRW50cnkgPSBleHBvcnRzLmNvbXBsZXRlZEVudHJpZXMuZ2V0KGZyYW1lSWQpO1xuICAgICAgICBleHBvcnRzLmNvbXBsZXRlZEVudHJpZXMuZGVsZXRlKGZyYW1lSWQpO1xuICAgICAgICBleHBvcnRzLndhaXRpbmdRdWV1ZS5kZWxldGUoZnJhbWVJZCk7XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dF8xID0gZnJhbWVfMS5fZXhlY3V0aW5nQ29udGV4dCB8fCB7IG5hdmlnYXRpb25UeXBlOiBmcmFtZV9jb21tb25fMS5OYXZpZ2F0aW9uVHlwZS5iYWNrIH07XG4gICAgICAgIHZhciBjdXJyZW50XzEgPSBmcmFtZV8xLmlzQ3VycmVudChlbnRyeSkgPyBwcmV2aW91c0NvbXBsZXRlZEFuaW1hdGlvbkVudHJ5IDogZW50cnk7XG4gICAgICAgIGN1cnJlbnRfMSA9IGN1cnJlbnRfMSB8fCBlbnRyeTtcbiAgICAgICAgaWYgKGN1cnJlbnRfMSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBmcmFtZV8xLnNldEN1cnJlbnQoY3VycmVudF8xLCBuYXZpZ2F0aW9uQ29udGV4dF8xLm5hdmlnYXRpb25UeXBlKTsgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGV4cG9ydHMuY29tcGxldGVkRW50cmllcy5zZXQoZnJhbWVJZCwgZW50cnkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRvU2hvcnRTdHJpbmcobmF0aXZlVHJhbnNpdGlvbikge1xuICAgIHJldHVybiBuYXRpdmVUcmFuc2l0aW9uLmdldENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpICsgXCJAXCIgKyBuYXRpdmVUcmFuc2l0aW9uLmhhc2hDb2RlKCkudG9TdHJpbmcoMTYpO1xufVxuZnVuY3Rpb24gcHJpbnRUcmFuc2l0aW9ucyhlbnRyeSkge1xuICAgIGlmIChlbnRyeSAmJiB0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBlbnRyeS5mcmFnbWVudFRhZyArIFwiIFRyYW5zaXRpb25zOlwiO1xuICAgICAgICBpZiAoZW50cnkudHJhbnNpdGlvbk5hbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcInRyYW5zaXRpb25OYW1lPVwiICsgZW50cnkudHJhbnNpdGlvbk5hbWUgKyBcIiwgXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVudHJ5LnRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcImVudGVyQW5pbWF0b3I9XCIgKyBlbnRyeS5lbnRlckFuaW1hdG9yICsgXCIsIFwiO1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiZXhpdEFuaW1hdG9yPVwiICsgZW50cnkuZXhpdEFuaW1hdG9yICsgXCIsIFwiO1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwicG9wRW50ZXJBbmltYXRvcj1cIiArIGVudHJ5LnBvcEVudGVyQW5pbWF0b3IgKyBcIiwgXCI7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJwb3BFeGl0QW5pbWF0b3I9XCIgKyBlbnRyeS5wb3BFeGl0QW5pbWF0b3IgKyBcIiwgXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNka1ZlcnNpb24oKSA+PSAyMSkge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gZW50cnkuZnJhZ21lbnQ7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJcIiArIChmcmFnbWVudC5nZXRFbnRlclRyYW5zaXRpb24oKSA/IFwiIGVudGVyPVwiICsgdG9TaG9ydFN0cmluZyhmcmFnbWVudC5nZXRFbnRlclRyYW5zaXRpb24oKSkgOiBcIlwiKTtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIlwiICsgKGZyYWdtZW50LmdldEV4aXRUcmFuc2l0aW9uKCkgPyBcIiBleGl0PVwiICsgdG9TaG9ydFN0cmluZyhmcmFnbWVudC5nZXRFeGl0VHJhbnNpdGlvbigpKSA6IFwiXCIpO1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiXCIgKyAoZnJhZ21lbnQuZ2V0UmVlbnRlclRyYW5zaXRpb24oKSA/IFwiIHBvcEVudGVyPVwiICsgdG9TaG9ydFN0cmluZyhmcmFnbWVudC5nZXRSZWVudGVyVHJhbnNpdGlvbigpKSA6IFwiXCIpO1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiXCIgKyAoZnJhZ21lbnQuZ2V0UmV0dXJuVHJhbnNpdGlvbigpID8gXCIgcG9wRXhpdD1cIiArIHRvU2hvcnRTdHJpbmcoZnJhZ21lbnQuZ2V0UmV0dXJuVHJhbnNpdGlvbigpKSA6IFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRyYWNlXzEud3JpdGUocmVzdWx0LCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgfVxufVxuZnVuY3Rpb24gamF2YU9iamVjdEFycmF5KCkge1xuICAgIHZhciBwYXJhbXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBwYXJhbXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIG5hdGl2ZUFycmF5ID0gQXJyYXkuY3JlYXRlKGphdmEubGFuZy5PYmplY3QsIHBhcmFtcy5sZW5ndGgpO1xuICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaSkgeyByZXR1cm4gbmF0aXZlQXJyYXlbaV0gPSB2YWx1ZTsgfSk7XG4gICAgcmV0dXJuIG5hdGl2ZUFycmF5O1xufVxuZnVuY3Rpb24gY3JlYXRlRHVtbXlaZXJvRHVyYXRpb25BbmltYXRvcigpIHtcbiAgICB2YXIgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5WYWx1ZUFuaW1hdG9yLm9mT2JqZWN0KGludEV2YWx1YXRvcigpLCBqYXZhT2JqZWN0QXJyYXkoamF2YS5sYW5nLkludGVnZXIudmFsdWVPZigwKSwgamF2YS5sYW5nLkludGVnZXIudmFsdWVPZigxKSkpO1xuICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKDEpO1xuICAgIHJldHVybiBhbmltYXRvcjtcbn1cbnZhciBOb1RyYW5zaXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOb1RyYW5zaXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTm9UcmFuc2l0aW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE5vVHJhbnNpdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5kcm9pZEFuaW1hdG9yID0gZnVuY3Rpb24gKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVEdW1teVplcm9EdXJhdGlvbkFuaW1hdG9yKCk7XG4gICAgfTtcbiAgICByZXR1cm4gTm9UcmFuc2l0aW9uO1xufSh0cmFuc2l0aW9uXzEuVHJhbnNpdGlvbikpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhZ21lbnQudHJhbnNpdGlvbnMuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3L3ZpZXctY29tbW9uXCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIGZyYW1lX3N0YWNrXzEgPSByZXF1aXJlKFwiLi9mcmFtZS1zdGFja1wiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuLi9idWlsZGVyL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIE5hdmlnYXRpb25UeXBlO1xuKGZ1bmN0aW9uIChOYXZpZ2F0aW9uVHlwZSkge1xuICAgIE5hdmlnYXRpb25UeXBlW05hdmlnYXRpb25UeXBlW1wiYmFja1wiXSA9IDBdID0gXCJiYWNrXCI7XG4gICAgTmF2aWdhdGlvblR5cGVbTmF2aWdhdGlvblR5cGVbXCJmb3J3YXJkXCJdID0gMV0gPSBcImZvcndhcmRcIjtcbiAgICBOYXZpZ2F0aW9uVHlwZVtOYXZpZ2F0aW9uVHlwZVtcInJlcGxhY2VcIl0gPSAyXSA9IFwicmVwbGFjZVwiO1xufSkoTmF2aWdhdGlvblR5cGUgPSBleHBvcnRzLk5hdmlnYXRpb25UeXBlIHx8IChleHBvcnRzLk5hdmlnYXRpb25UeXBlID0ge30pKTtcbmZ1bmN0aW9uIGJ1aWxkRW50cnlGcm9tQXJncyhhcmcpIHtcbiAgICB2YXIgZW50cnk7XG4gICAgaWYgKHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgZW50cnkgPSB7XG4gICAgICAgICAgICBtb2R1bGVOYW1lOiBhcmdcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGVudHJ5ID0ge1xuICAgICAgICAgICAgY3JlYXRlOiBhcmdcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGVudHJ5ID0gYXJnO1xuICAgIH1cbiAgICByZXR1cm4gZW50cnk7XG59XG52YXIgRnJhbWVCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRnJhbWVCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZyYW1lQmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9iYWNrU3RhY2sgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgX3RoaXMuX25hdmlnYXRpb25RdWV1ZSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5faXNJbkZyYW1lU3RhY2sgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGcmFtZUJhc2VfMSA9IEZyYW1lQmFzZTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZyYW1lIHNob3VsZCBub3QgaGF2ZSBhIHZpZXcuIFVzZSAnZGVmYXVsdFBhZ2UnIHByb3BlcnR5IGluc3RlYWQuXCIpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5jYW5Hb0JhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBiYWNrc3RhY2sgPSB0aGlzLl9iYWNrU3RhY2subGVuZ3RoO1xuICAgICAgICB2YXIgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IGl0ZW0uZW50cnk7XG4gICAgICAgICAgICB2YXIgaXNCYWNrTmF2aWdhdGlvbiA9IGl0ZW0ubmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgICAgICBpZiAoaXNCYWNrTmF2aWdhdGlvbikge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYWNrc3RhY2tJbmRleCA9IF90aGlzLl9iYWNrU3RhY2suaW5kZXhPZihlbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiYWNrc3RhY2tJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tzdGFjayA9IGJhY2tzdGFja0luZGV4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja3N0YWNrLS07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChlbnRyeS5lbnRyeS5jbGVhckhpc3RvcnkpIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJhY2tzdGFjayA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBiYWNrc3RhY2srKztcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja3N0YWNrLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrID0gZW50cnkuZW50cnkuYmFja3N0YWNrVmlzaWJsZSA9PT0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5fbmF2aWdhdGlvblF1ZXVlLmxlbmd0aCA+IDAgJiYgIXRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgYmFja3N0YWNrLS07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJhY2tzdGFjayA+IDA7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmdvQmFjayA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIkdPIEJBQ0tcIiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuY2FuR29CYWNrKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgICAgIHZhciBpbmRleF8xID0gdGhpcy5fYmFja1N0YWNrLmluZGV4T2YoYmFja3N0YWNrRW50cnkpO1xuICAgICAgICAgICAgaWYgKGluZGV4XzEgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dCA9IHtcbiAgICAgICAgICAgIGVudHJ5OiBiYWNrc3RhY2tFbnRyeSxcbiAgICAgICAgICAgIGlzQmFja05hdmlnYXRpb246IHRydWUsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHlwZTogTmF2aWdhdGlvblR5cGUuYmFja1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUucHVzaChuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9yZW1vdmVFbnRyeSA9IGZ1bmN0aW9uIChyZW1vdmVkKSB7XG4gICAgICAgIHZhciBwYWdlID0gcmVtb3ZlZC5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIHZhciBmcmFtZSA9IHBhZ2UuZnJhbWU7XG4gICAgICAgIHBhZ2UuX2ZyYW1lID0gbnVsbDtcbiAgICAgICAgaWYgKGZyYW1lKSB7XG4gICAgICAgICAgICBmcmFtZS5fcmVtb3ZlVmlldyhwYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhZ2UuX3RlYXJEb3duVUkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlZC5yZXNvbHZlZFBhZ2UgPSBudWxsO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5uYXZpZ2F0ZSA9IGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIk5BVklHQVRFXCIsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVudHJ5ID0gYnVpbGRFbnRyeUZyb21BcmdzKHBhcmFtKTtcbiAgICAgICAgdmFyIHBhZ2UgPSBidWlsZGVyXzEuY3JlYXRlVmlld0Zyb21FbnRyeShlbnRyeSk7XG4gICAgICAgIHRoaXMuX3B1c2hJbkZyYW1lU3RhY2soKTtcbiAgICAgICAgdmFyIGJhY2tzdGFja0VudHJ5ID0ge1xuICAgICAgICAgICAgZW50cnk6IGVudHJ5LFxuICAgICAgICAgICAgcmVzb2x2ZWRQYWdlOiBwYWdlLFxuICAgICAgICAgICAgbmF2RGVwdGg6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGZyYWdtZW50VGFnOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgZW50cnk6IGJhY2tzdGFja0VudHJ5LFxuICAgICAgICAgICAgaXNCYWNrTmF2aWdhdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHlwZTogTmF2aWdhdGlvblR5cGUuZm9yd2FyZFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUucHVzaChuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmlzQ3VycmVudCA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudEVudHJ5ID09PSBlbnRyeTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuc2V0Q3VycmVudCA9IGZ1bmN0aW9uIChlbnRyeSwgbmF2aWdhdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIG5ld1BhZ2UgPSBlbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIGlmICghbmV3UGFnZS5mcmFtZSkge1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyhuZXdQYWdlKTtcbiAgICAgICAgICAgIG5ld1BhZ2UuX2ZyYW1lID0gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jdXJyZW50RW50cnkgPSBlbnRyeTtcbiAgICAgICAgdmFyIGlzQmFjayA9IG5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICBpZiAoaXNCYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9wdXNoSW5GcmFtZVN0YWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3UGFnZS5vbk5hdmlnYXRlZFRvKGlzQmFjayk7XG4gICAgICAgIHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgPSBudWxsO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fdXBkYXRlQmFja3N0YWNrID0gZnVuY3Rpb24gKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXNCYWNrID0gbmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgIHZhciBpc1JlcGxhY2UgPSBuYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUucmVwbGFjZTtcbiAgICAgICAgdGhpcy5yYWlzZUN1cnJlbnRQYWdlTmF2aWdhdGVkRXZlbnRzKGlzQmFjayk7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICBpZiAoaXNCYWNrKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhfMiA9IHRoaXMuX2JhY2tTdGFjay5pbmRleE9mKGVudHJ5KTtcbiAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5zcGxpY2UoaW5kZXhfMiArIDEpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVFbnRyeShlKTsgfSk7XG4gICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2sucG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWlzUmVwbGFjZSkge1xuICAgICAgICAgICAgaWYgKGVudHJ5LmVudHJ5LmNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5fcmVtb3ZlRW50cnkoZSk7IH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5sZW5ndGggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoRnJhbWVCYXNlXzEuX2lzRW50cnlCYWNrc3RhY2tWaXNpYmxlKGN1cnJlbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLnB1c2goY3VycmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGN1cnJlbnQgJiYgdGhpcy5fYmFja1N0YWNrLmluZGV4T2YoY3VycmVudCkgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVFbnRyeShjdXJyZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5pc05lc3RlZFdpdGhpbiA9IGZ1bmN0aW9uIChwYXJlbnRGcmFtZUNhbmRpZGF0ZSkge1xuICAgICAgICB2YXIgZnJhbWVBbmNlc3RvciA9IHRoaXM7XG4gICAgICAgIHdoaWxlIChmcmFtZUFuY2VzdG9yKSB7XG4gICAgICAgICAgICBmcmFtZUFuY2VzdG9yID0gdmlld19jb21tb25fMS5nZXRBbmNlc3RvcihmcmFtZUFuY2VzdG9yLCBGcmFtZUJhc2VfMSk7XG4gICAgICAgICAgICBpZiAoZnJhbWVBbmNlc3RvciA9PT0gcGFyZW50RnJhbWVDYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLnJhaXNlQ3VycmVudFBhZ2VOYXZpZ2F0ZWRFdmVudHMgPSBmdW5jdGlvbiAoaXNCYWNrKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKHBhZ2UpIHtcbiAgICAgICAgICAgIGlmIChwYWdlLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgcGFnZS5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhZ2Uub25OYXZpZ2F0ZWRGcm9tKGlzQmFjayk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3Byb2Nlc3NOYXZpZ2F0aW9uUXVldWUgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICBpZiAodGhpcy5fbmF2aWdhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuX25hdmlnYXRpb25RdWV1ZVswXS5lbnRyeTtcbiAgICAgICAgdmFyIGN1cnJlbnROYXZpZ2F0aW9uUGFnZSA9IGVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICAgICAgaWYgKHBhZ2UgIT09IGN1cnJlbnROYXZpZ2F0aW9uUGFnZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5zaGlmdCgpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgICAgICB0aGlzLl91cGRhdGVBY3Rpb25CYXIoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2ZpbmRFbnRyeUZvclRhZyA9IGZ1bmN0aW9uIChmcmFnbWVudFRhZykge1xuICAgICAgICB2YXIgZW50cnk7XG4gICAgICAgIGlmICh0aGlzLl9jdXJyZW50RW50cnkgJiYgdGhpcy5fY3VycmVudEVudHJ5LmZyYWdtZW50VGFnID09PSBmcmFnbWVudFRhZykge1xuICAgICAgICAgICAgZW50cnkgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBlbnRyeSA9IHRoaXMuX2JhY2tTdGFjay5maW5kKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnOyB9KTtcbiAgICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmF2aWdhdGlvbkl0ZW0gPSB0aGlzLl9uYXZpZ2F0aW9uUXVldWUuZmluZChmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlLmVudHJ5LmZyYWdtZW50VGFnID09PSBmcmFnbWVudFRhZzsgfSk7XG4gICAgICAgICAgICAgICAgZW50cnkgPSBuYXZpZ2F0aW9uSXRlbSA/IG5hdmlnYXRpb25JdGVtLmVudHJ5IDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlbnRyeTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUubmF2aWdhdGlvblF1ZXVlSXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5sZW5ndGggPT09IDA7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UuX2lzRW50cnlCYWNrc3RhY2tWaXNpYmxlID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja3N0YWNrVmlzaWJsZVZhbHVlID0gZW50cnkuZW50cnkuYmFja3N0YWNrVmlzaWJsZTtcbiAgICAgICAgdmFyIGJhY2tzdGFja0hpZGRlbiA9IGJhY2tzdGFja1Zpc2libGVWYWx1ZSAhPT0gdW5kZWZpbmVkICYmICFiYWNrc3RhY2tWaXNpYmxlVmFsdWU7XG4gICAgICAgIHJldHVybiAhYmFja3N0YWNrSGlkZGVuO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fdXBkYXRlQWN0aW9uQmFyID0gZnVuY3Rpb24gKHBhZ2UsIGRpc2FibGVOYXZCYXJBbmltYXRpb24pIHtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNMb2FkZWQgfHwgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0gdGhpcy5fbmF2aWdhdGlvblF1ZXVlWzBdO1xuICAgICAgICAgICAgdmFyIGlzQmFja05hdmlnYXRpb24gPSBuYXZpZ2F0aW9uQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgICAgIGlmIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtR29CYWNrKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybU5hdmlnYXRpb24obmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLnBlcmZvcm1OYXZpZ2F0aW9uID0gZnVuY3Rpb24gKG5hdmlnYXRpb25Db250ZXh0KSB7XG4gICAgICAgIHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgPSBuYXZpZ2F0aW9uQ29udGV4dDtcbiAgICAgICAgdmFyIGJhY2tzdGFja0VudHJ5ID0gbmF2aWdhdGlvbkNvbnRleHQuZW50cnk7XG4gICAgICAgIHZhciBpc0JhY2tOYXZpZ2F0aW9uID0gbmF2aWdhdGlvbkNvbnRleHQubmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgIHRoaXMuX29uTmF2aWdhdGluZ1RvKGJhY2tzdGFja0VudHJ5LCBpc0JhY2tOYXZpZ2F0aW9uKTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGVDb3JlKGJhY2tzdGFja0VudHJ5KTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucGVyZm9ybUdvQmFjayA9IGZ1bmN0aW9uIChuYXZpZ2F0aW9uQ29udGV4dCkge1xuICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSBuYXZpZ2F0aW9uQ29udGV4dC5lbnRyeTtcbiAgICAgICAgdmFyIGJhY2tzdGFjayA9IHRoaXMuX2JhY2tTdGFjaztcbiAgICAgICAgaWYgKCFiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICAgICAgYmFja3N0YWNrRW50cnkgPSBiYWNrc3RhY2tbYmFja3N0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgbmF2aWdhdGlvbkNvbnRleHQuZW50cnkgPSBiYWNrc3RhY2tFbnRyeTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9leGVjdXRpbmdDb250ZXh0ID0gbmF2aWdhdGlvbkNvbnRleHQ7XG4gICAgICAgIHRoaXMuX29uTmF2aWdhdGluZ1RvKGJhY2tzdGFja0VudHJ5LCB0cnVlKTtcbiAgICAgICAgdGhpcy5fZ29CYWNrQ29yZShiYWNrc3RhY2tFbnRyeSk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9nb0JhY2tDb3JlID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiR08gQkFDSyBDT1JFKFwiICsgdGhpcy5fYmFja3N0YWNrRW50cnlUcmFjZShiYWNrc3RhY2tFbnRyeSkgKyBcIik7IGN1cnJlbnRQYWdlOiBcIiArIHRoaXMuY3VycmVudFBhZ2UsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX25hdmlnYXRlQ29yZSA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIk5BVklHQVRFIENPUkUoXCIgKyB0aGlzLl9iYWNrc3RhY2tFbnRyeVRyYWNlKGJhY2tzdGFja0VudHJ5KSArIFwiKTsgY3VycmVudFBhZ2U6IFwiICsgdGhpcy5jdXJyZW50UGFnZSwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fb25OYXZpZ2F0aW5nVG8gPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnksIGlzQmFjaykge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZS5vbk5hdmlnYXRpbmdGcm9tKGlzQmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgYmFja3N0YWNrRW50cnkucmVzb2x2ZWRQYWdlLm9uTmF2aWdhdGluZ1RvKGJhY2tzdGFja0VudHJ5LmVudHJ5LmNvbnRleHQsIGlzQmFjaywgYmFja3N0YWNrRW50cnkuZW50cnkuYmluZGluZ0NvbnRleHQpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiYW5pbWF0ZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmltYXRlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FuaW1hdGVkID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcInRyYW5zaXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90cmFuc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJiYWNrU3RhY2tcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWNrU3RhY2suc2xpY2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiY3VycmVudFBhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50RW50cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudEVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJjdXJyZW50RW50cnlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50RW50cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudEVudHJ5LmVudHJ5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3B1c2hJbkZyYW1lU3RhY2soKTtcbiAgICAgICAgdmFyIGZyYW1lc1RvUHVzaCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGZyYW1lU3RhY2tfMSA9IGZyYW1lX3N0YWNrXzEuZnJhbWVTdGFjazsgX2kgPCBmcmFtZVN0YWNrXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBmcmFtZVN0YWNrXzFbX2ldO1xuICAgICAgICAgICAgaWYgKGZyYW1lLmlzTmVzdGVkV2l0aGluKHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVzVG9QdXNoLnB1c2goZnJhbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9hID0gMCwgZnJhbWVzVG9QdXNoXzEgPSBmcmFtZXNUb1B1c2g7IF9hIDwgZnJhbWVzVG9QdXNoXzEubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBmcmFtZXNUb1B1c2hfMVtfYV07XG4gICAgICAgICAgICBmcmFtZS5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wdXNoSW5GcmFtZVN0YWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmcmFtZV9zdGFja18xLl9wdXNoSW5GcmFtZVN0YWNrKHRoaXMpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcG9wRnJvbUZyYW1lU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyYW1lX3N0YWNrXzEuX3BvcEZyb21GcmFtZVN0YWNrKHRoaXMpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcmVtb3ZlRnJvbUZyYW1lU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyYW1lX3N0YWNrXzEuX3JlbW92ZUZyb21GcmFtZVN0YWNrKHRoaXMpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZGlhbG9nQ2xvc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9yZW1vdmVGcm9tRnJhbWVTdGFjaygpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2soKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgcGFnZSA9IHRoaXMuY3VycmVudFBhZ2U7XG4gICAgICAgIGlmIChwYWdlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhwYWdlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24gPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgaWYgKGVudHJ5ICYmIGVudHJ5LmFuaW1hdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeS5hbmltYXRlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5hbmltYXRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRnJhbWVCYXNlXzEuZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvbjtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIGlmIChlbnRyeSkge1xuICAgICAgICAgICAgaWYgKHZpZXdfMS5pc0lPUyAmJiBlbnRyeS50cmFuc2l0aW9uaU9TICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cnkudHJhbnNpdGlvbmlPUztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2aWV3XzEuaXNBbmRyb2lkICYmIGVudHJ5LnRyYW5zaXRpb25BbmRyb2lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cnkudHJhbnNpdGlvbkFuZHJvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW50cnkudHJhbnNpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5LnRyYW5zaXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudHJhbnNpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50cmFuc2l0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBGcmFtZUJhc2VfMS5kZWZhdWx0VHJhbnNpdGlvbjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcIm5hdmlnYXRpb25CYXJIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9nZXROYXZCYXJWaXNpYmxlID0gZnVuY3Rpb24gKHBhZ2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGNoaWxkLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gZmFsc2U7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wcmludEZyYW1lQmFja1N0YWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5iYWNrU3RhY2subGVuZ3RoO1xuICAgICAgICB2YXIgaSA9IGxlbmd0aCAtIDE7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRnJhbWUgQmFjayBTdGFjazogXCIpO1xuICAgICAgICB3aGlsZSAoaSA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSB0aGlzLmJhY2tTdGFja1tpLS1dO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJcXHRcIiArIGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2JhY2tzdGFja0VudHJ5VHJhY2UgPSBmdW5jdGlvbiAoYikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gXCJcIiArIGIucmVzb2x2ZWRQYWdlO1xuICAgICAgICB2YXIgYmFja3N0YWNrVmlzaWJsZSA9IEZyYW1lQmFzZV8xLl9pc0VudHJ5QmFja3N0YWNrVmlzaWJsZShiKTtcbiAgICAgICAgaWYgKCFiYWNrc3RhY2tWaXNpYmxlKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCIgfCBJTlZJU0lCTEVcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYi5lbnRyeS5jbGVhckhpc3RvcnkpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIiB8IENMRUFSIEhJU1RPUllcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0ZWQgPSB0aGlzLl9nZXRJc0FuaW1hdGVkTmF2aWdhdGlvbihiLmVudHJ5KTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgTk9UIEFOSU1BVEVEXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHQgPSB0aGlzLl9nZXROYXZpZ2F0aW9uVHJhbnNpdGlvbihiLmVudHJ5KTtcbiAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIiB8IFRyYW5zaXRpb25bXCIgKyBKU09OLnN0cmluZ2lmeSh0KSArIFwiXVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9vbkxpdmVzeW5jID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKF9zdXBlci5wcm90b3R5cGUuX29uTGl2ZXN5bmMuY2FsbCh0aGlzLCBjb250ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sZWdhY3lMaXZlc3luYygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2hhbmRsZUxpdmVzeW5jID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKF9zdXBlci5wcm90b3R5cGUuX2hhbmRsZUxpdmVzeW5jLmNhbGwodGhpcywgY29udGV4dCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlICYmXG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCh0aGlzLmN1cnJlbnRQYWdlLCBjb250ZXh0LCBbXCJtYXJrdXBcIiwgXCJzY3JpcHRcIl0pKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIkNoYW5nZSBIYW5kbGVkOiBSZXBsYWNpbmcgcGFnZSBcIiArIGNvbnRleHQucGF0aCwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgICAgICB0aGlzLnJlcGxhY2VQYWdlKGNvbnRleHQucGF0aCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmxlZ2FjeUxpdmVzeW5jID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZSh0aGlzICsgXCIuX29uTGl2ZXN5bmMoKVwiLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2N1cnJlbnRFbnRyeSB8fCAhdGhpcy5fY3VycmVudEVudHJ5LmVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnRFbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeS5lbnRyeTtcbiAgICAgICAgdmFyIG5ld0VudHJ5ID0ge1xuICAgICAgICAgICAgYW5pbWF0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgY2xlYXJIaXN0b3J5OiB0cnVlLFxuICAgICAgICAgICAgY29udGV4dDogY3VycmVudEVudHJ5LmNvbnRleHQsXG4gICAgICAgICAgICBjcmVhdGU6IGN1cnJlbnRFbnRyeS5jcmVhdGUsXG4gICAgICAgICAgICBtb2R1bGVOYW1lOiBjdXJyZW50RW50cnkubW9kdWxlTmFtZSxcbiAgICAgICAgICAgIGJhY2tzdGFja1Zpc2libGU6IGN1cnJlbnRFbnRyeS5iYWNrc3RhY2tWaXNpYmxlXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuZXdFbnRyeS5jcmVhdGUpIHtcbiAgICAgICAgICAgIHZhciBwYWdlID0gbmV3RW50cnkuY3JlYXRlKCk7XG4gICAgICAgICAgICBpZiAocGFnZSA9PT0gdGhpcy5jdXJyZW50UGFnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdmlnYXRlKG5ld0VudHJ5KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLnJlcGxhY2VQYWdlID0gZnVuY3Rpb24gKHBhZ2VQYXRoKSB7XG4gICAgICAgIHZhciBjdXJyZW50QmFja3N0YWNrRW50cnkgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIHZhciBjb250ZXh0TW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShwYWdlUGF0aCk7XG4gICAgICAgIHZhciBuZXdQYWdlID0gYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkoeyBtb2R1bGVOYW1lOiBjb250ZXh0TW9kdWxlTmFtZSB9KTtcbiAgICAgICAgdmFyIG5ld0JhY2tzdGFja0VudHJ5ID0ge1xuICAgICAgICAgICAgZW50cnk6IGN1cnJlbnRCYWNrc3RhY2tFbnRyeS5lbnRyeSxcbiAgICAgICAgICAgIHJlc29sdmVkUGFnZTogbmV3UGFnZSxcbiAgICAgICAgICAgIG5hdkRlcHRoOiBjdXJyZW50QmFja3N0YWNrRW50cnkubmF2RGVwdGgsXG4gICAgICAgICAgICBmcmFnbWVudFRhZzogY3VycmVudEJhY2tzdGFja0VudHJ5LmZyYWdtZW50VGFnLFxuICAgICAgICAgICAgZnJhbWVJZDogY3VycmVudEJhY2tzdGFja0VudHJ5LmZyYW1lSWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgZW50cnk6IG5ld0JhY2tzdGFja0VudHJ5LFxuICAgICAgICAgICAgaXNCYWNrTmF2aWdhdGlvbjogZmFsc2UsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHlwZTogTmF2aWdhdGlvblR5cGUucmVwbGFjZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUucHVzaChuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgfTtcbiAgICB2YXIgRnJhbWVCYXNlXzE7XG4gICAgRnJhbWVCYXNlLmFuZHJvaWRPcHRpb25TZWxlY3RlZEV2ZW50ID0gXCJvcHRpb25TZWxlY3RlZFwiO1xuICAgIEZyYW1lQmFzZS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uID0gdHJ1ZTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lQmFzZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFtZUJhc2UucHJvdG90eXBlLCBcInBlcmZvcm1OYXZpZ2F0aW9uXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJwZXJmb3JtR29CYWNrXCIsIG51bGwpO1xuICAgIEZyYW1lQmFzZSA9IEZyYW1lQmFzZV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiRnJhbWVcIilcbiAgICBdLCBGcmFtZUJhc2UpO1xuICAgIHJldHVybiBGcmFtZUJhc2U7XG59KHZpZXdfMS5DdXN0b21MYXlvdXRWaWV3KSk7XG5leHBvcnRzLkZyYW1lQmFzZSA9IEZyYW1lQmFzZTtcbmZ1bmN0aW9uIGdldEZyYW1lQnlJZChpZCkge1xuICAgIHJldHVybiBmcmFtZV9zdGFja18xLmZyYW1lU3RhY2suZmluZChmdW5jdGlvbiAoZnJhbWUpIHsgcmV0dXJuIGZyYW1lLmlkICYmIGZyYW1lLmlkID09PSBpZDsgfSk7XG59XG5leHBvcnRzLmdldEZyYW1lQnlJZCA9IGdldEZyYW1lQnlJZDtcbmZ1bmN0aW9uIHRvcG1vc3QoKSB7XG4gICAgcmV0dXJuIGZyYW1lX3N0YWNrXzEudG9wbW9zdCgpO1xufVxuZXhwb3J0cy50b3Btb3N0ID0gdG9wbW9zdDtcbmZ1bmN0aW9uIGdvQmFjaygpIHtcbiAgICB2YXIgdG9wID0gdG9wbW9zdCgpO1xuICAgIGlmICh0b3AgJiYgdG9wLmNhbkdvQmFjaygpKSB7XG4gICAgICAgIHRvcC5nb0JhY2soKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHRvcCkge1xuICAgICAgICB2YXIgcGFyZW50RnJhbWVDYW5Hb0JhY2sgPSBmYWxzZTtcbiAgICAgICAgdmFyIHBhcmVudEZyYW1lID0gdmlld19jb21tb25fMS5nZXRBbmNlc3Rvcih0b3AsIFwiRnJhbWVcIik7XG4gICAgICAgIHdoaWxlIChwYXJlbnRGcmFtZSAmJiAhcGFyZW50RnJhbWVDYW5Hb0JhY2spIHtcbiAgICAgICAgICAgIGlmIChwYXJlbnRGcmFtZSAmJiBwYXJlbnRGcmFtZS5jYW5Hb0JhY2soKSkge1xuICAgICAgICAgICAgICAgIHBhcmVudEZyYW1lQ2FuR29CYWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcmVudEZyYW1lID0gdmlld19jb21tb25fMS5nZXRBbmNlc3RvcihwYXJlbnRGcmFtZSwgXCJGcmFtZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocGFyZW50RnJhbWUgJiYgcGFyZW50RnJhbWVDYW5Hb0JhY2spIHtcbiAgICAgICAgICAgIHBhcmVudEZyYW1lLmdvQmFjaygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGZyYW1lX3N0YWNrXzEuZnJhbWVTdGFjay5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRvcC5fcG9wRnJvbUZyYW1lU3RhY2soKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZXhwb3J0cy5nb0JhY2sgPSBnb0JhY2s7XG5mdW5jdGlvbiBfc3RhY2soKSB7XG4gICAgcmV0dXJuIGZyYW1lX3N0YWNrXzEuZnJhbWVTdGFjaztcbn1cbmV4cG9ydHMuX3N0YWNrID0gX3N0YWNrO1xuZXhwb3J0cy5kZWZhdWx0UGFnZSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZGVmYXVsdFBhZ2VcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAoZnJhbWUsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBmcmFtZS5uYXZpZ2F0ZSh7IG1vZHVsZU5hbWU6IG5ld1ZhbHVlIH0pO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5kZWZhdWx0UGFnZS5yZWdpc3RlcihGcmFtZUJhc2UpO1xuZXhwb3J0cy5hY3Rpb25CYXJWaXNpYmlsaXR5UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJhY3Rpb25CYXJWaXNpYmlsaXR5XCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyB9KTtcbmV4cG9ydHMuYWN0aW9uQmFyVmlzaWJpbGl0eVByb3BlcnR5LnJlZ2lzdGVyKEZyYW1lQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFtZS1jb21tb24uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5mcmFtZVN0YWNrID0gW107XG5mdW5jdGlvbiB0b3Btb3N0KCkge1xuICAgIGlmIChleHBvcnRzLmZyYW1lU3RhY2subGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gZXhwb3J0cy5mcmFtZVN0YWNrW2V4cG9ydHMuZnJhbWVTdGFjay5sZW5ndGggLSAxXTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMudG9wbW9zdCA9IHRvcG1vc3Q7XG5mdW5jdGlvbiBfcHVzaEluRnJhbWVTdGFjayhmcmFtZSkge1xuICAgIGlmIChmcmFtZS5faXNJbkZyYW1lU3RhY2sgJiYgZXhwb3J0cy5mcmFtZVN0YWNrW2V4cG9ydHMuZnJhbWVTdGFjay5sZW5ndGggLSAxXSA9PT0gZnJhbWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZnJhbWUuX2lzSW5GcmFtZVN0YWNrKSB7XG4gICAgICAgIHZhciBpbmRleE9mRnJhbWUgPSBleHBvcnRzLmZyYW1lU3RhY2suaW5kZXhPZihmcmFtZSk7XG4gICAgICAgIGV4cG9ydHMuZnJhbWVTdGFjay5zcGxpY2UoaW5kZXhPZkZyYW1lLCAxKTtcbiAgICB9XG4gICAgZXhwb3J0cy5mcmFtZVN0YWNrLnB1c2goZnJhbWUpO1xuICAgIGZyYW1lLl9pc0luRnJhbWVTdGFjayA9IHRydWU7XG59XG5leHBvcnRzLl9wdXNoSW5GcmFtZVN0YWNrID0gX3B1c2hJbkZyYW1lU3RhY2s7XG5mdW5jdGlvbiBfcG9wRnJvbUZyYW1lU3RhY2soZnJhbWUpIHtcbiAgICBpZiAoIWZyYW1lLl9pc0luRnJhbWVTdGFjaykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0b3AgPSB0b3Btb3N0KCk7XG4gICAgaWYgKHRvcCAhPT0gZnJhbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IHBvcCBhIEZyYW1lIHdoaWNoIGlzIG5vdCBhdCB0aGUgdG9wIG9mIHRoZSBuYXZpZ2F0aW9uIHN0YWNrLlwiKTtcbiAgICB9XG4gICAgZXhwb3J0cy5mcmFtZVN0YWNrLnBvcCgpO1xuICAgIGZyYW1lLl9pc0luRnJhbWVTdGFjayA9IGZhbHNlO1xufVxuZXhwb3J0cy5fcG9wRnJvbUZyYW1lU3RhY2sgPSBfcG9wRnJvbUZyYW1lU3RhY2s7XG5mdW5jdGlvbiBfcmVtb3ZlRnJvbUZyYW1lU3RhY2soZnJhbWUpIHtcbiAgICBpZiAoIWZyYW1lLl9pc0luRnJhbWVTdGFjaykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBpbmRleCA9IGV4cG9ydHMuZnJhbWVTdGFjay5pbmRleE9mKGZyYW1lKTtcbiAgICBleHBvcnRzLmZyYW1lU3RhY2suc3BsaWNlKGluZGV4LCAxKTtcbiAgICBmcmFtZS5faXNJbkZyYW1lU3RhY2sgPSBmYWxzZTtcbn1cbmV4cG9ydHMuX3JlbW92ZUZyb21GcmFtZVN0YWNrID0gX3JlbW92ZUZyb21GcmFtZVN0YWNrO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhbWUtc3RhY2suanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhcHBsaWNhdGlvbiA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbnZhciBmcmFtZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZyYW1lLWNvbW1vblwiKTtcbnZhciBmcmFnbWVudF90cmFuc2l0aW9uc18xID0gcmVxdWlyZShcIi4vZnJhZ21lbnQudHJhbnNpdGlvbnNcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXJcIik7XG52YXIgc3lzdGVtX2NsYXNzZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9jc3Mvc3lzdGVtLWNsYXNzZXNcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybS9wbGF0Zm9ybVwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9mcmFtZS1jb21tb25cIikpO1xudmFyIEFORFJPSURfUExBVEZPUk0gPSBcImFuZHJvaWRcIjtcbnZhciBJTlRFTlRfRVhUUkEgPSBcImNvbS50bnMuYWN0aXZpdHlcIjtcbnZhciBST09UX1ZJRVdfSURfRVhUUkEgPSBcImNvbS50bnMuYWN0aXZpdHkucm9vdFZpZXdJZFwiO1xudmFyIEZSQU1FSUQgPSBcIl9mcmFtZUlkXCI7XG52YXIgQ0FMTEJBQ0tTID0gXCJfY2FsbGJhY2tzXCI7XG52YXIgSE1SX1JFUExBQ0VfVFJBTlNJVElPTiA9IFwiZmFkZVwiO1xudmFyIG93bmVyU3ltYm9sID0gU3ltYm9sKFwiX293bmVyXCIpO1xudmFyIGFjdGl2aXR5Um9vdFZpZXdzTWFwID0gbmV3IE1hcCgpO1xudmFyIG5hdkRlcHRoID0gLTE7XG52YXIgZnJhZ21lbnRJZCA9IC0xO1xuaWYgKGdsb2JhbCAmJiBnbG9iYWwuX19pbnNwZWN0b3IpIHtcbiAgICB2YXIgZGV2dG9vbHMgPSByZXF1aXJlKFwiLi4vLi4vZGVidWdnZXIvZGV2dG9vbHMtZWxlbWVudHNcIik7XG4gICAgZGV2dG9vbHMuYXR0YWNoRE9NSW5zcGVjdG9yRXZlbnRDYWxsYmFja3MoZ2xvYmFsLl9faW5zcGVjdG9yKTtcbiAgICBkZXZ0b29scy5hdHRhY2hET01JbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzKGdsb2JhbC5fX2luc3BlY3Rvcik7XG59XG5mdW5jdGlvbiBnZXRBdHRhY2hMaXN0ZW5lcigpIHtcbiAgICBpZiAoIWV4cG9ydHMuYXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lcikge1xuICAgICAgICB2YXIgQXR0YWNoTGlzdGVuZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKEF0dGFjaExpc3RlbmVyLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gQXR0YWNoTGlzdGVuZXIoKSB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEF0dGFjaExpc3RlbmVyLnByb3RvdHlwZS5vblZpZXdBdHRhY2hlZFRvV2luZG93ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3duZXIgPSB2aWV3W293bmVyU3ltYm9sXTtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX29uQXR0YWNoZWRUb1dpbmRvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBBdHRhY2hMaXN0ZW5lci5wcm90b3R5cGUub25WaWV3RGV0YWNoZWRGcm9tV2luZG93ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3duZXIgPSB2aWV3W293bmVyU3ltYm9sXTtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX29uRGV0YWNoZWRGcm9tV2luZG93KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEF0dGFjaExpc3RlbmVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC52aWV3LlZpZXcuT25BdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyXSlcbiAgICAgICAgICAgIF0sIEF0dGFjaExpc3RlbmVyKTtcbiAgICAgICAgICAgIHJldHVybiBBdHRhY2hMaXN0ZW5lcjtcbiAgICAgICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgICAgIGV4cG9ydHMuYXR0YWNoU3RhdGVDaGFuZ2VMaXN0ZW5lciA9IG5ldyBBdHRhY2hMaXN0ZW5lcigpO1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3J0cy5hdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyO1xufVxuZnVuY3Rpb24gcmVsb2FkUGFnZShjb250ZXh0KSB7XG4gICAgdmFyIGFjdGl2aXR5ID0gYXBwbGljYXRpb24uYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHk7XG4gICAgdmFyIGNhbGxiYWNrcyA9IGFjdGl2aXR5W0NBTExCQUNLU107XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSBjYWxsYmFja3MuZ2V0Um9vdFZpZXcoKTtcbiAgICAgICAgdmFyIGlzQXBwUm9vdE1vZHVsZUNoYW5nZWQgPSBjb250ZXh0ICYmIGNvbnRleHQucGF0aCAmJiBjb250ZXh0LnBhdGguaW5jbHVkZXMoYXBwbGljYXRpb24uZ2V0TWFpbkVudHJ5KCkubW9kdWxlTmFtZSkgJiYgY29udGV4dC50eXBlICE9PSBcInN0eWxlXCI7XG4gICAgICAgIGlmIChpc0FwcFJvb3RNb2R1bGVDaGFuZ2VkIHx8ICFyb290VmlldyB8fCAhcm9vdFZpZXcuX29uTGl2ZXN5bmMoY29udGV4dCkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5yZXNldEFjdGl2aXR5Q29udGVudChhY3Rpdml0eSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoYWN0aXZpdHkgKyBcIltDQUxMQkFDS1NdIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVsb2FkUGFnZSA9IHJlbG9hZFBhZ2U7XG5nbG9iYWwuX19vbkxpdmVTeW5jQ29yZSA9IHJlbG9hZFBhZ2U7XG52YXIgRnJhbWUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGcmFtZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGcmFtZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2NvbnRhaW5lclZpZXdJZCA9IC0xO1xuICAgICAgICBfdGhpcy5fdGVhckRvd25QZW5kaW5nID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9hdHRhY2hlZFRvV2luZG93ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9hbmRyb2lkID0gbmV3IEFuZHJvaWRGcmFtZShfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLCBcImRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UuZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZSwgXCJkZWZhdWx0VHJhbnNpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0VHJhbnNpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0VHJhbnNpdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUucHJvdG90eXBlLCBcImNvbnRhaW5lclZpZXdJZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRhaW5lclZpZXdJZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5kcm9pZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWUucHJvdG90eXBlLl9vbkF0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9hdHRhY2hlZFRvV2luZG93ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fb25EZXRhY2hlZEZyb21XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX29uRGV0YWNoZWRGcm9tV2luZG93LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX2F0dGFjaGVkVG9XaW5kb3cgPSBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCB8fCB0aGlzLl9leGVjdXRpbmdDb250ZXh0IHx8ICF0aGlzLl9hdHRhY2hlZFRvV2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdGVkRW50cmllcyA9IGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX2dldEFuaW1hdGVkRW50cmllcyh0aGlzLl9hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICBpZiAoYW5pbWF0ZWRFbnRyaWVzKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0ZWRFbnRyaWVzLnNpemUgPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgaWYgKGVudHJ5ICYmIG1hbmFnZXIgJiYgIW1hbmFnZXIuZmluZEZyYWdtZW50QnlUYWcoZW50cnkuZnJhZ21lbnRUYWcpKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZWRBbmltYXRvclN0YXRlID0gZ2V0QW5pbWF0b3JTdGF0ZSh0aGlzLl9jdXJyZW50RW50cnkpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudEVudHJ5ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX25hdmlnYXRlQ29yZShlbnRyeSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50RW50cnkgPSBlbnRyeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5LmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeTtcbiAgICAgICAgaWYgKHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgJiYgdGhpcy5fZXhlY3V0aW5nQ29udGV4dC5lbnRyeSkge1xuICAgICAgICAgICAgYmFja3N0YWNrRW50cnkgPSB0aGlzLl9leGVjdXRpbmdDb250ZXh0LmVudHJ5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmFja3N0YWNrRW50cnkgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJhY2tzdGFja0VudHJ5ICYmIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50ICYmIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50LmlzQWRkZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50LmdldENoaWxkRnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRGcmFnbWVudCgpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25VbmxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50RnJhZ21lbnQoKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5kaXNwb3NlQ3VycmVudEZyYWdtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2N1cnJlbnRFbnRyeSB8fFxuICAgICAgICAgICAgIXRoaXMuX2N1cnJlbnRFbnRyeS5mcmFnbWVudCB8fFxuICAgICAgICAgICAgIXRoaXMuX2N1cnJlbnRFbnRyeS5mcmFnbWVudC5pc0FkZGVkKCkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWFuYWdlciA9IHRoaXMuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBtYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdHJhbnNhY3Rpb24ucmVtb3ZlKHRoaXMuX2N1cnJlbnRFbnRyeS5mcmFnbWVudCk7XG4gICAgICAgIHRyYW5zYWN0aW9uLmNvbW1pdE5vd0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuY3JlYXRlRnJhZ21lbnQgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnksIGZyYWdtZW50VGFnKSB7XG4gICAgICAgIGVuc3VyZUZyYWdtZW50Q2xhc3MoKTtcbiAgICAgICAgdmFyIG5ld0ZyYWdtZW50ID0gbmV3IGZyYWdtZW50Q2xhc3MoKTtcbiAgICAgICAgdmFyIGFyZ3MgPSBuZXcgYW5kcm9pZC5vcy5CdW5kbGUoKTtcbiAgICAgICAgYXJncy5wdXRJbnQoRlJBTUVJRCwgdGhpcy5fYW5kcm9pZC5mcmFtZUlkKTtcbiAgICAgICAgbmV3RnJhZ21lbnQuc2V0QXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICBzZXRGcmFnbWVudENhbGxiYWNrcyhuZXdGcmFnbWVudCk7XG4gICAgICAgIHZhciBjYWxsYmFja3MgPSBuZXdGcmFnbWVudFtDQUxMQkFDS1NdO1xuICAgICAgICBjYWxsYmFja3MuZnJhbWUgPSB0aGlzO1xuICAgICAgICBjYWxsYmFja3MuZW50cnkgPSBiYWNrc3RhY2tFbnRyeTtcbiAgICAgICAgYmFja3N0YWNrRW50cnkuZnJhZ21lbnQgPSBuZXdGcmFnbWVudDtcbiAgICAgICAgYmFja3N0YWNrRW50cnkuZnJhZ21lbnRUYWcgPSBmcmFnbWVudFRhZztcbiAgICAgICAgYmFja3N0YWNrRW50cnkubmF2RGVwdGggPSBuYXZEZXB0aDtcbiAgICAgICAgcmV0dXJuIG5ld0ZyYWdtZW50O1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLnNldEN1cnJlbnQgPSBmdW5jdGlvbiAoZW50cnksIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICB2YXIgY3VycmVudEVudHJ5Q2hhbmdlZCA9IGN1cnJlbnQgIT09IGVudHJ5O1xuICAgICAgICBpZiAoY3VycmVudEVudHJ5Q2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQmFja3N0YWNrKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5fdGVhckRvd25QZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGVhckRvd25QZW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFlbnRyeS5yZWNyZWF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJFbnRyeShlbnRyeSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ICYmICFjdXJyZW50LnJlY3JlYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckVudHJ5KGN1cnJlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dF8xID0gdGhpcy5fY29udGV4dDtcbiAgICAgICAgICAgICAgICBpZiAoY29udGV4dF8xICYmICFlbnRyeS5yZWNyZWF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZW50cnkuZnJhZ21lbnQgPSB0aGlzLmNyZWF0ZUZyYWdtZW50KGVudHJ5LCBlbnRyeS5mcmFnbWVudFRhZyk7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LnJlc29sdmVkUGFnZS5fc2V0dXBVSShjb250ZXh0XzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbnRyeS5yZWNyZWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnJlY3JlYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0Q3VycmVudC5jYWxsKHRoaXMsIGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSk7XG4gICAgICAgICAgICB0aGlzLl9wcm9jZXNzTmF2aWdhdGlvblF1ZXVlKGVudHJ5LnJlc29sdmVkUGFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9jYWNoZWRBbmltYXRvclN0YXRlKSB7XG4gICAgICAgICAgICByZXN0b3JlQW5pbWF0b3JTdGF0ZSh0aGlzLl9jdXJyZW50RW50cnksIHRoaXMuX2NhY2hlZEFuaW1hdG9yU3RhdGUpO1xuICAgICAgICAgICAgdGhpcy5fY2FjaGVkQW5pbWF0b3JTdGF0ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdmlnYXRpb25UeXBlID09PSBmcmFtZV9jb21tb25fMS5OYXZpZ2F0aW9uVHlwZS5yZXBsYWNlKSB7XG4gICAgICAgICAgICBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9jbGVhckVudHJ5KGVudHJ5KTtcbiAgICAgICAgICAgIHZhciBhbmltYXRlZCA9IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKGVudHJ5LmVudHJ5KTtcbiAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHRoaXMuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uKGVudHJ5LmVudHJ5KTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50RW50cnkgPSBudWxsO1xuICAgICAgICAgICAgdmFyIG5ld0VudHJ5ID0gZW50cnk7XG4gICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fc2V0QW5kcm9pZEZyYWdtZW50VHJhbnNpdGlvbnMoYW5pbWF0ZWQsIG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJyZW50RW50cnksIG5ld0VudHJ5LCB0cmFuc2FjdGlvbiwgdGhpcy5fYW5kcm9pZC5mcmFtZUlkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbkdvQmFjaygpKSB7XG4gICAgICAgICAgICB0aGlzLmdvQmFjaygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLm5hdmlnYXRpb25RdWV1ZUlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdmFyIG1hbmFnZXIgPSB0aGlzLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgbWFuYWdlci5leGVjdXRlUGVuZGluZ1RyYW5zYWN0aW9ucygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fbmF2aWdhdGVDb3JlID0gZnVuY3Rpb24gKG5ld0VudHJ5KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX25hdmlnYXRlQ29yZS5jYWxsKHRoaXMsIG5ld0VudHJ5KTtcbiAgICAgICAgbmV3RW50cnkuZnJhbWVJZCA9IHRoaXMuX2FuZHJvaWQuZnJhbWVJZDtcbiAgICAgICAgdmFyIGFjdGl2aXR5ID0gdGhpcy5fYW5kcm9pZC5hY3Rpdml0eTtcbiAgICAgICAgaWYgKCFhY3Rpdml0eSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRBY3Rpdml0eSA9IHRoaXMuX2FuZHJvaWQuY3VycmVudEFjdGl2aXR5O1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRBY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0QWN0aXZpdHkoY3VycmVudEFjdGl2aXR5LCB0aGlzLl9hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciBjbGVhckhpc3RvcnkgPSBuZXdFbnRyeS5lbnRyeS5jbGVhckhpc3Rvcnk7XG4gICAgICAgIHZhciBjdXJyZW50RW50cnkgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIGlmIChjbGVhckhpc3RvcnkpIHtcbiAgICAgICAgICAgIG5hdkRlcHRoID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzUmVwbGFjZSA9IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgJiYgdGhpcy5fZXhlY3V0aW5nQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gZnJhbWVfY29tbW9uXzEuTmF2aWdhdGlvblR5cGUucmVwbGFjZTtcbiAgICAgICAgaWYgKCFpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIG5hdkRlcHRoKys7XG4gICAgICAgIH1cbiAgICAgICAgZnJhZ21lbnRJZCsrO1xuICAgICAgICB2YXIgbmV3RnJhZ21lbnRUYWcgPSBcImZyYWdtZW50XCIgKyBmcmFnbWVudElkICsgXCJbXCIgKyBuYXZEZXB0aCArIFwiXVwiO1xuICAgICAgICB2YXIgbmV3RnJhZ21lbnQgPSB0aGlzLmNyZWF0ZUZyYWdtZW50KG5ld0VudHJ5LCBuZXdGcmFnbWVudFRhZyk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IG1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICB2YXIgYW5pbWF0ZWQgPSBjdXJyZW50RW50cnkgPyB0aGlzLl9nZXRJc0FuaW1hdGVkTmF2aWdhdGlvbihuZXdFbnRyeS5lbnRyeSkgOiBmYWxzZTtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uO1xuICAgICAgICBpZiAoaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICBhbmltYXRlZCA9IHRydWU7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHsgbmFtZTogSE1SX1JFUExBQ0VfVFJBTlNJVElPTiwgZHVyYXRpb246IDEwMCB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgbmF2aWdhdGlvblRyYW5zaXRpb24gPSB0aGlzLl9nZXROYXZpZ2F0aW9uVHJhbnNpdGlvbihuZXdFbnRyeS5lbnRyeSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fc2V0QW5kcm9pZEZyYWdtZW50VHJhbnNpdGlvbnMoYW5pbWF0ZWQsIG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJyZW50RW50cnksIG5ld0VudHJ5LCB0cmFuc2FjdGlvbiwgdGhpcy5fYW5kcm9pZC5mcmFtZUlkKTtcbiAgICAgICAgaWYgKGN1cnJlbnRFbnRyeSAmJiBhbmltYXRlZCAmJiAhbmF2aWdhdGlvblRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHRyYW5zYWN0aW9uLnNldFRyYW5zaXRpb24oYW5kcm9pZHguZnJhZ21lbnQuYXBwLkZyYWdtZW50VHJhbnNhY3Rpb24uVFJBTlNJVF9GUkFHTUVOVF9PUEVOKTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2FjdGlvbi5yZXBsYWNlKHRoaXMuY29udGFpbmVyVmlld0lkLCBuZXdGcmFnbWVudCwgbmV3RnJhZ21lbnRUYWcpO1xuICAgICAgICB0cmFuc2FjdGlvbi5jb21taXRBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9nb0JhY2tDb3JlID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2dvQmFja0NvcmUuY2FsbCh0aGlzLCBiYWNrc3RhY2tFbnRyeSk7XG4gICAgICAgIG5hdkRlcHRoID0gYmFja3N0YWNrRW50cnkubmF2RGVwdGg7XG4gICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IG1hbmFnZXIuYmVnaW5UcmFuc2FjdGlvbigpO1xuICAgICAgICBpZiAoIWJhY2tzdGFja0VudHJ5LmZyYWdtZW50KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2tFbnRyeS5mcmFnbWVudCA9IHRoaXMuY3JlYXRlRnJhZ21lbnQoYmFja3N0YWNrRW50cnksIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50VGFnKTtcbiAgICAgICAgICAgIGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX3VwZGF0ZVRyYW5zaXRpb25zKGJhY2tzdGFja0VudHJ5KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdHJhbnNpdGlvblJldmVyc2VkID0gZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fcmV2ZXJzZVRyYW5zaXRpb25zKGJhY2tzdGFja0VudHJ5LCB0aGlzLl9jdXJyZW50RW50cnkpO1xuICAgICAgICBpZiAoIXRyYW5zaXRpb25SZXZlcnNlZCkge1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24uc2V0Q3VzdG9tQW5pbWF0aW9ucygtMzAsIC00MCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJhbnNhY3Rpb24ucmVwbGFjZSh0aGlzLmNvbnRhaW5lclZpZXdJZCwgYmFja3N0YWNrRW50cnkuZnJhZ21lbnQsIGJhY2tzdGFja0VudHJ5LmZyYWdtZW50VGFnKTtcbiAgICAgICAgdHJhbnNhY3Rpb24uY29tbWl0QWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fcmVtb3ZlRW50cnkgPSBmdW5jdGlvbiAocmVtb3ZlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9yZW1vdmVFbnRyeS5jYWxsKHRoaXMsIHJlbW92ZWQpO1xuICAgICAgICBpZiAocmVtb3ZlZC5mcmFnbWVudCkge1xuICAgICAgICAgICAgZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fY2xlYXJFbnRyeShyZW1vdmVkKTtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVkLmZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgcmVtb3ZlZC52aWV3U2F2ZWRTdGF0ZSA9IG51bGw7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29udGVudExheW91dCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbGlzdGVuZXIgPSBnZXRBdHRhY2hMaXN0ZW5lcigpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkT25BdHRhY2hTdGF0ZUNoYW5nZUxpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkW293bmVyU3ltYm9sXSA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2FuZHJvaWQucm9vdFZpZXdHcm91cCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRhaW5lclZpZXdJZCA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRhaW5lclZpZXdJZCA9IGFuZHJvaWQudmlldy5WaWV3LmdlbmVyYXRlVmlld0lkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYW5kcm9pZC5yb290Vmlld0dyb3VwLnNldElkKHRoaXMuX2NvbnRhaW5lclZpZXdJZCk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGdldEF0dGFjaExpc3RlbmVyKCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVPbkF0dGFjaFN0YXRlQ2hhbmdlTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWRbb3duZXJTeW1ib2xdID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdGVhckRvd25QZW5kaW5nID0gISF0aGlzLl9leGVjdXRpbmdDb250ZXh0O1xuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgdmFyIGV4ZWN1dGluZ0VudHJ5ID0gdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA/IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQuZW50cnkgOiBudWxsO1xuICAgICAgICB0aGlzLmJhY2tTdGFjay5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICAgICAgaWYgKGVudHJ5ICE9PSBleGVjdXRpbmdFbnRyeSkge1xuICAgICAgICAgICAgICAgIGNsZWFyRW50cnkoZW50cnkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGN1cnJlbnQgJiYgIWV4ZWN1dGluZ0VudHJ5KSB7XG4gICAgICAgICAgICBjbGVhckVudHJ5KGN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FuZHJvaWQucm9vdFZpZXdHcm91cCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3JlbW92ZUZyb21GcmFtZVN0YWNrKCk7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fcG9wRnJvbUZyYW1lU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5faXNJbkZyYW1lU3RhY2spIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9wb3BGcm9tRnJhbWVTdGFjay5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9nZXROYXZCYXJWaXNpYmxlID0gZnVuY3Rpb24gKHBhZ2UpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLmFjdGlvbkJhclZpc2liaWxpdHkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJuZXZlclwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgXCJhbHdheXNcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgaWYgKHBhZ2UuYWN0aW9uQmFySGlkZGVuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFwYWdlLmFjdGlvbkJhckhpZGRlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FuZHJvaWQgJiYgdGhpcy5fYW5kcm9pZC5zaG93QWN0aW9uQmFyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuZHJvaWQuc2hvd0FjdGlvbkJhcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fc2F2ZUZyYWdtZW50c1N0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJhY2tTdGFjay5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBlbnRyeS5yZXNvbHZlZFBhZ2UubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghZW50cnkudmlld1NhdmVkU3RhdGUgJiYgdmlldykge1xuICAgICAgICAgICAgICAgIHZhciB2aWV3U3RhdGUgPSBuZXcgYW5kcm9pZC51dGlsLlNwYXJzZUFycmF5KCk7XG4gICAgICAgICAgICAgICAgdmlldy5zYXZlSGllcmFyY2h5U3RhdGUodmlld1N0YXRlKTtcbiAgICAgICAgICAgICAgICBlbnRyeS52aWV3U2F2ZWRTdGF0ZSA9IHZpZXdTdGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lLnByb3RvdHlwZSwgXCJfbmF2aWdhdGVDb3JlXCIsIG51bGwpO1xuICAgIHJldHVybiBGcmFtZTtcbn0oZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlKSk7XG5leHBvcnRzLkZyYW1lID0gRnJhbWU7XG5mdW5jdGlvbiBjbG9uZUV4cGFuZGVkQW5pbWF0b3IoZXhwYW5kZWRBbmltYXRvcikge1xuICAgIGlmICghZXhwYW5kZWRBbmltYXRvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGNsb25lID0gZXhwYW5kZWRBbmltYXRvci5jbG9uZSgpO1xuICAgIGNsb25lLmVudHJ5ID0gZXhwYW5kZWRBbmltYXRvci5lbnRyeTtcbiAgICBjbG9uZS50cmFuc2l0aW9uVHlwZSA9IGV4cGFuZGVkQW5pbWF0b3IudHJhbnNpdGlvblR5cGU7XG4gICAgcmV0dXJuIGNsb25lO1xufVxuZnVuY3Rpb24gZ2V0QW5pbWF0b3JTdGF0ZShlbnRyeSkge1xuICAgIHZhciBleHBhbmRlZEVudHJ5ID0gZW50cnk7XG4gICAgdmFyIGFuaW1hdG9yU3RhdGUgPSB7fTtcbiAgICBhbmltYXRvclN0YXRlLmVudGVyQW5pbWF0b3IgPSBjbG9uZUV4cGFuZGVkQW5pbWF0b3IoZXhwYW5kZWRFbnRyeS5lbnRlckFuaW1hdG9yKTtcbiAgICBhbmltYXRvclN0YXRlLmV4aXRBbmltYXRvciA9IGNsb25lRXhwYW5kZWRBbmltYXRvcihleHBhbmRlZEVudHJ5LmV4aXRBbmltYXRvcik7XG4gICAgYW5pbWF0b3JTdGF0ZS5wb3BFbnRlckFuaW1hdG9yID0gY2xvbmVFeHBhbmRlZEFuaW1hdG9yKGV4cGFuZGVkRW50cnkucG9wRW50ZXJBbmltYXRvcik7XG4gICAgYW5pbWF0b3JTdGF0ZS5wb3BFeGl0QW5pbWF0b3IgPSBjbG9uZUV4cGFuZGVkQW5pbWF0b3IoZXhwYW5kZWRFbnRyeS5wb3BFeGl0QW5pbWF0b3IpO1xuICAgIGFuaW1hdG9yU3RhdGUudHJhbnNpdGlvbk5hbWUgPSBleHBhbmRlZEVudHJ5LnRyYW5zaXRpb25OYW1lO1xuICAgIHJldHVybiBhbmltYXRvclN0YXRlO1xufVxuZnVuY3Rpb24gcmVzdG9yZUFuaW1hdG9yU3RhdGUoZW50cnksIHNuYXBzaG90KSB7XG4gICAgdmFyIGV4cGFuZGVkRW50cnkgPSBlbnRyeTtcbiAgICBpZiAoc25hcHNob3QuZW50ZXJBbmltYXRvcikge1xuICAgICAgICBleHBhbmRlZEVudHJ5LmVudGVyQW5pbWF0b3IgPSBzbmFwc2hvdC5lbnRlckFuaW1hdG9yO1xuICAgIH1cbiAgICBpZiAoc25hcHNob3QuZXhpdEFuaW1hdG9yKSB7XG4gICAgICAgIGV4cGFuZGVkRW50cnkuZXhpdEFuaW1hdG9yID0gc25hcHNob3QuZXhpdEFuaW1hdG9yO1xuICAgIH1cbiAgICBpZiAoc25hcHNob3QucG9wRW50ZXJBbmltYXRvcikge1xuICAgICAgICBleHBhbmRlZEVudHJ5LnBvcEVudGVyQW5pbWF0b3IgPSBzbmFwc2hvdC5wb3BFbnRlckFuaW1hdG9yO1xuICAgIH1cbiAgICBpZiAoc25hcHNob3QucG9wRXhpdEFuaW1hdG9yKSB7XG4gICAgICAgIGV4cGFuZGVkRW50cnkucG9wRXhpdEFuaW1hdG9yID0gc25hcHNob3QucG9wRXhpdEFuaW1hdG9yO1xuICAgIH1cbiAgICBleHBhbmRlZEVudHJ5LnRyYW5zaXRpb25OYW1lID0gc25hcHNob3QudHJhbnNpdGlvbk5hbWU7XG59XG5mdW5jdGlvbiBjbGVhckVudHJ5KGVudHJ5KSB7XG4gICAgaWYgKGVudHJ5LmZyYWdtZW50KSB7XG4gICAgICAgIGZyYWdtZW50X3RyYW5zaXRpb25zXzEuX2NsZWFyRnJhZ21lbnQoZW50cnkpO1xuICAgIH1cbiAgICBlbnRyeS5yZWNyZWF0ZWQgPSBmYWxzZTtcbiAgICBlbnRyeS5mcmFnbWVudCA9IG51bGw7XG4gICAgdmFyIHBhZ2UgPSBlbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgaWYgKHBhZ2UuX2NvbnRleHQpIHtcbiAgICAgICAgZW50cnkucmVzb2x2ZWRQYWdlLl90ZWFyRG93blVJKHRydWUpO1xuICAgIH1cbn1cbnZhciBmcmFtZXNDb3VudGVyID0gMDtcbnZhciBmcmFtZXNDYWNoZSA9IG5ldyBBcnJheSgpO1xudmFyIEFuZHJvaWRGcmFtZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFuZHJvaWRGcmFtZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmRyb2lkRnJhbWUob3duZXIpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Nob3dBY3Rpb25CYXIgPSB0cnVlO1xuICAgICAgICBfdGhpcy5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgX3RoaXMuZnJhbWVJZCA9IGZyYW1lc0NvdW50ZXIrKztcbiAgICAgICAgZnJhbWVzQ2FjaGUucHVzaChuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkRnJhbWUucHJvdG90eXBlLCBcInNob3dBY3Rpb25CYXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zaG93QWN0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Nob3dBY3Rpb25CYXIgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd0FjdGlvbkJhciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm93bmVyLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3duZXIuY3VycmVudFBhZ2UuYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFuZHJvaWRGcmFtZS5wcm90b3R5cGUsIFwiYWN0aXZpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IHRoaXMub3duZXIuX2NvbnRleHQ7XG4gICAgICAgICAgICBpZiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZpdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3VyclZpZXcgPSB0aGlzLl9vd25lci5wYXJlbnQ7XG4gICAgICAgICAgICB3aGlsZSAoY3VyclZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VyclZpZXcgaW5zdGFuY2VvZiBGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3VyclZpZXcuYW5kcm9pZC5hY3Rpdml0eTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VyclZpZXcgPSBjdXJyVmlldy5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5kcm9pZEZyYW1lLnByb3RvdHlwZSwgXCJhY3Rpb25CYXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IHRoaXMuY3VycmVudEFjdGl2aXR5O1xuICAgICAgICAgICAgaWYgKCFhY3Rpdml0eSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYmFyID0gYWN0aXZpdHkuZ2V0QWN0aW9uQmFyKCk7XG4gICAgICAgICAgICBpZiAoIWJhcikge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYmFyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5kcm9pZEZyYW1lLnByb3RvdHlwZSwgXCJjdXJyZW50QWN0aXZpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpdml0eSA9IHRoaXMuYWN0aXZpdHk7XG4gICAgICAgICAgICBpZiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYWN0aXZpdHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJhbWVzID0gZnJhbWVfY29tbW9uXzEuX3N0YWNrKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBsZW5ndGhfMSA9IGZyYW1lcy5sZW5ndGgsIGkgPSBsZW5ndGhfMSAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZpdHkgPSBmcmFtZXNbaV0uYW5kcm9pZC5hY3Rpdml0eTtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGl2aXR5O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbmRyb2lkRnJhbWUucHJvdG90eXBlLCBcIm93bmVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3duZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFuZHJvaWRGcmFtZS5wcm90b3R5cGUuY2FuR29CYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuYWN0aXZpdHkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpdml0eS5nZXRJbnRlbnQoKS5nZXRBY3Rpb24oKSAhPT0gYW5kcm9pZC5jb250ZW50LkludGVudC5BQ1RJT05fTUFJTjtcbiAgICB9O1xuICAgIEFuZHJvaWRGcmFtZS5wcm90b3R5cGUuZnJhZ21lbnRGb3JQYWdlID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIHZhciB0YWcgPSBlbnRyeSAmJiBlbnRyeS5mcmFnbWVudFRhZztcbiAgICAgICAgaWYgKHRhZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3duZXIuX2dldEZyYWdtZW50TWFuYWdlcigpLmZpbmRGcmFnbWVudEJ5VGFnKHRhZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIHJldHVybiBBbmRyb2lkRnJhbWU7XG59KGZyYW1lX2NvbW1vbl8xLk9ic2VydmFibGUpKTtcbmZ1bmN0aW9uIGZpbmRQYWdlRm9yRnJhZ21lbnQoZnJhZ21lbnQsIGZyYW1lKSB7XG4gICAgdmFyIGZyYWdtZW50VGFnID0gZnJhZ21lbnQuZ2V0VGFnKCk7XG4gICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJGaW5kaW5nIHBhZ2UgZm9yIFwiICsgZnJhZ21lbnRUYWcgKyBcIi5cIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgfVxuICAgIHZhciBlbnRyeTtcbiAgICB2YXIgY3VycmVudCA9IGZyYW1lLl9jdXJyZW50RW50cnk7XG4gICAgdmFyIGV4ZWN1dGluZ0NvbnRleHQgPSBmcmFtZS5fZXhlY3V0aW5nQ29udGV4dDtcbiAgICBpZiAoY3VycmVudCAmJiBjdXJyZW50LmZyYWdtZW50VGFnID09PSBmcmFnbWVudFRhZykge1xuICAgICAgICBlbnRyeSA9IGN1cnJlbnQ7XG4gICAgfVxuICAgIGVsc2UgaWYgKGV4ZWN1dGluZ0NvbnRleHQgJiYgZXhlY3V0aW5nQ29udGV4dC5lbnRyeSAmJiBleGVjdXRpbmdDb250ZXh0LmVudHJ5LmZyYWdtZW50VGFnID09PSBmcmFnbWVudFRhZykge1xuICAgICAgICBlbnRyeSA9IGV4ZWN1dGluZ0NvbnRleHQuZW50cnk7XG4gICAgfVxuICAgIHZhciBwYWdlO1xuICAgIGlmIChlbnRyeSkge1xuICAgICAgICBlbnRyeS5yZWNyZWF0ZWQgPSB0cnVlO1xuICAgICAgICBwYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgIH1cbiAgICBpZiAocGFnZSkge1xuICAgICAgICB2YXIgY2FsbGJhY2tzID0gZnJhZ21lbnRbQ0FMTEJBQ0tTXTtcbiAgICAgICAgY2FsbGJhY2tzLmZyYW1lID0gZnJhbWU7XG4gICAgICAgIGNhbGxiYWNrcy5lbnRyeSA9IGVudHJ5O1xuICAgICAgICBlbnRyeS5mcmFnbWVudCA9IGZyYWdtZW50O1xuICAgICAgICBmcmFnbWVudF90cmFuc2l0aW9uc18xLl91cGRhdGVUcmFuc2l0aW9ucyhlbnRyeSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBhIHBhZ2UgZm9yIFwiICsgZnJhZ21lbnRUYWcgKyBcIi5cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gc3RhcnRBY3Rpdml0eShhY3Rpdml0eSwgZnJhbWVJZCkge1xuICAgIHZhciBpbnRlbnQgPSBuZXcgYW5kcm9pZC5jb250ZW50LkludGVudChhY3Rpdml0eSwgYWN0aXZpdHkuZ2V0Q2xhc3MoKSk7XG4gICAgaW50ZW50LnNldEFjdGlvbihhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkFDVElPTl9ERUZBVUxUKTtcbiAgICBpbnRlbnQucHV0RXh0cmEoSU5URU5UX0VYVFJBLCBmcmFtZUlkKTtcbiAgICBhY3Rpdml0eS5zdGFydEFjdGl2aXR5KGludGVudCk7XG59XG5mdW5jdGlvbiBnZXRGcmFtZUJ5TnVtYmVySWQoZnJhbWVJZCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnJhbWVzQ2FjaGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGFsaXZlRnJhbWUgPSBmcmFtZXNDYWNoZVtpXS5nZXQoKTtcbiAgICAgICAgaWYgKGFsaXZlRnJhbWUgJiYgYWxpdmVGcmFtZS5mcmFtZUlkID09PSBmcmFtZUlkKSB7XG4gICAgICAgICAgICByZXR1cm4gYWxpdmVGcmFtZS5vd25lcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIGVuc3VyZUZyYWdtZW50Q2xhc3MoKSB7XG4gICAgaWYgKGZyYWdtZW50Q2xhc3MpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXF1aXJlKFwiLi9mcmFnbWVudFwiKTtcbiAgICBpZiAoIWZyYWdtZW50Q2xhc3MpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgdGhlIGV4dGVuZGVkIGFuZHJvaWR4LmZyYWdtZW50LmFwcC5GcmFnbWVudCBjbGFzc1wiKTtcbiAgICB9XG59XG52YXIgZnJhZ21lbnRDbGFzcztcbmZ1bmN0aW9uIHNldEZyYWdtZW50Q2xhc3MoY2xhenopIHtcbiAgICBpZiAoZnJhZ21lbnRDbGFzcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGcmFnbWVudCBjbGFzcyBhbHJlYWR5IGluaXRpYWxpemVkXCIpO1xuICAgIH1cbiAgICBmcmFnbWVudENsYXNzID0gY2xheno7XG59XG5leHBvcnRzLnNldEZyYWdtZW50Q2xhc3MgPSBzZXRGcmFnbWVudENsYXNzO1xudmFyIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24oKSB7XG4gICAgfVxuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uSGlkZGVuQ2hhbmdlZCA9IGZ1bmN0aW9uIChmcmFnbWVudCwgaGlkZGVuLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25IaWRkZW5DaGFuZ2VkKFwiICsgaGlkZGVuICsgXCIpXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50LCBoaWRkZW4pO1xuICAgIH07XG4gICAgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25DcmVhdGVBbmltYXRvciA9IGZ1bmN0aW9uIChmcmFnbWVudCwgdHJhbnNpdCwgZW50ZXIsIG5leHRBbmltLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKCFlbnRlciAmJiBmcmFnbWVudC5nZXRSZW1vdmluZ1BhcmVudEZyYWdtZW50KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCwgdHJhbnNpdCwgZW50ZXIsIG5leHRBbmltKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV4dEFuaW1TdHJpbmc7XG4gICAgICAgIHN3aXRjaCAobmV4dEFuaW0pIHtcbiAgICAgICAgICAgIGNhc2UgLTEwOlxuICAgICAgICAgICAgICAgIG5leHRBbmltU3RyaW5nID0gXCJlbnRlclwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAtMjA6XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1TdHJpbmcgPSBcImV4aXRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgLTMwOlxuICAgICAgICAgICAgICAgIG5leHRBbmltU3RyaW5nID0gXCJwb3BFbnRlclwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAtNDA6XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1TdHJpbmcgPSBcInBvcEV4aXRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0b3IgPSBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9vbkZyYWdtZW50Q3JlYXRlQW5pbWF0b3IodGhpcy5lbnRyeSwgZnJhZ21lbnQsIG5leHRBbmltLCBlbnRlcik7XG4gICAgICAgIGlmICghYW5pbWF0b3IpIHtcbiAgICAgICAgICAgIGFuaW1hdG9yID0gc3VwZXJGdW5jLmNhbGwoZnJhZ21lbnQsIHRyYW5zaXQsIGVudGVyLCBuZXh0QW5pbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25DcmVhdGVBbmltYXRvcihcIiArIHRyYW5zaXQgKyBcIiwgXCIgKyAoZW50ZXIgPyBcImVudGVyXCIgOiBcImV4aXRcIikgKyBcIiwgXCIgKyBuZXh0QW5pbVN0cmluZyArIFwiKTogXCIgKyAoYW5pbWF0b3IgPyBcImFuaW1hdG9yXCIgOiBcIm5vIGFuaW1hdG9yXCIpLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5pbWF0b3I7XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZSA9IGZ1bmN0aW9uIChmcmFnbWVudCwgc2F2ZWRJbnN0YW5jZVN0YXRlLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKGZyYWdtZW50ICsgXCIub25DcmVhdGUoXCIgKyBzYXZlZEluc3RhbmNlU3RhdGUgKyBcIilcIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoZnJhZ21lbnQsIHNhdmVkSW5zdGFuY2VTdGF0ZSk7XG4gICAgICAgIGlmICghdGhpcy5lbnRyeSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBmcmFnbWVudC5nZXRBcmd1bWVudHMoKTtcbiAgICAgICAgICAgIHZhciBmcmFtZUlkID0gYXJncy5nZXRJbnQoRlJBTUVJRCk7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBnZXRGcmFtZUJ5TnVtYmVySWQoZnJhbWVJZCk7XG4gICAgICAgICAgICBpZiAoIWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgRnJhbWUgZm9yIFwiICsgZnJhZ21lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluZFBhZ2VGb3JGcmFnbWVudChmcmFnbWVudCwgZnJhbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZVZpZXcgPSBmdW5jdGlvbiAoZnJhZ21lbnQsIGluZmxhdGVyLCBjb250YWluZXIsIHNhdmVkSW5zdGFuY2VTdGF0ZSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShmcmFnbWVudCArIFwiLm9uQ3JlYXRlVmlldyhpbmZsYXRlciwgY29udGFpbmVyLCBcIiArIHNhdmVkSW5zdGFuY2VTdGF0ZSArIFwiKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLmVudHJ5O1xuICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZUVycm9yKGZyYWdtZW50ICsgXCIub25DcmVhdGVWaWV3OiBlbnRyeSBpcyBudWxsIG9yIHVuZGVmaW5lZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICBpZiAoIXBhZ2UpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoZnJhZ21lbnQgKyBcIi5vbkNyZWF0ZVZpZXc6IGVudHJ5IGhhcyBubyByZXNvbHZlZFBhZ2VcIik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJhbWUgPSB0aGlzLmZyYW1lO1xuICAgICAgICBpZiAoIWZyYW1lKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZUVycm9yKGZyYWdtZW50ICsgXCIub25DcmVhdGVWaWV3OiB0aGlzLmZyYW1lIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhZ2UucGFyZW50ID09PSBmcmFtZSkge1xuICAgICAgICAgICAgaWYgKCFwYWdlLl9jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHRfMiA9IGNvbnRhaW5lciAmJiBjb250YWluZXIuZ2V0Q29udGV4dCgpIHx8IGluZmxhdGVyICYmIGluZmxhdGVyLmdldENvbnRleHQoKTtcbiAgICAgICAgICAgICAgICBwYWdlLl9zZXR1cFVJKGNvbnRleHRfMik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWZyYW1lLl9zdHlsZVNjb3BlKSB7XG4gICAgICAgICAgICAgICAgcGFnZS5fdXBkYXRlU3R5bGVTY29wZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnJhbWUuX2FkZFZpZXcocGFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZyYW1lLmlzTG9hZGVkICYmICFwYWdlLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICBwYWdlLmNhbGxMb2FkZWQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2F2ZWRTdGF0ZSA9IGVudHJ5LnZpZXdTYXZlZFN0YXRlO1xuICAgICAgICBpZiAoc2F2ZWRTdGF0ZSkge1xuICAgICAgICAgICAgcGFnZS5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlc3RvcmVIaWVyYXJjaHlTdGF0ZShzYXZlZFN0YXRlKTtcbiAgICAgICAgICAgIGVudHJ5LnZpZXdTYXZlZFN0YXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHBhZ2UubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcgIT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHBhcmVudFZpZXcgPSBuYXRpdmVWaWV3LmdldFBhcmVudCgpO1xuICAgICAgICAgICAgaWYgKHBhcmVudFZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkLnZpZXcuVmlld0dyb3VwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudFZpZXcuZ2V0Q2hpbGRDb3VudCgpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudFZpZXcuYWRkVmlld0luTGF5b3V0KG5hdGl2ZVZpZXcsIC0xLCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGFyZW50Vmlldy5yZW1vdmVBbGxWaWV3cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYWdlLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vblNhdmVJbnN0YW5jZVN0YXRlID0gZnVuY3Rpb24gKGZyYWdtZW50LCBvdXRTdGF0ZSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShmcmFnbWVudCArIFwiLm9uU2F2ZUluc3RhbmNlU3RhdGUoXCIgKyBvdXRTdGF0ZSArIFwiKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCwgb3V0U3RhdGUpO1xuICAgIH07XG4gICAgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25EZXN0cm95VmlldyA9IGZ1bmN0aW9uIChmcmFnbWVudCwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShmcmFnbWVudCArIFwiLm9uRGVzdHJveVZpZXcoKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCk7XG4gICAgfTtcbiAgICBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoZnJhZ21lbnQsIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoZnJhZ21lbnQgKyBcIi5vbkRlc3Ryb3koKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCk7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZW50cnk7XG4gICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlRXJyb3IoZnJhZ21lbnQgKyBcIi5vbkRlc3Ryb3k6IGVudHJ5IGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZW50cnkuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICB2YXIgcGFnZSA9IGVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICAgICAgaWYgKCFwYWdlKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZUVycm9yKGZyYWdtZW50ICsgXCIub25EZXN0cm95OiBlbnRyeSBoYXMgbm8gcmVzb2x2ZWRQYWdlXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uU3RvcCA9IGZ1bmN0aW9uIChmcmFnbWVudCwgc3VwZXJGdW5jKSB7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGZyYWdtZW50KTtcbiAgICB9O1xuICAgIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLnRvU3RyaW5nT3ZlcnJpZGUgPSBmdW5jdGlvbiAoZnJhZ21lbnQsIHN1cGVyRnVuYykge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLmVudHJ5O1xuICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeS5mcmFnbWVudFRhZyArIFwiPFwiICsgZW50cnkucmVzb2x2ZWRQYWdlICsgXCI+XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJOTyBFTlRSWSwgXCIgKyBzdXBlckZ1bmMuY2FsbChmcmFnbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25IaWRkZW5DaGFuZ2VkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25DcmVhdGVBbmltYXRvclwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uQ3JlYXRlXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25DcmVhdGVWaWV3XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25TYXZlSW5zdGFuY2VTdGF0ZVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYWdtZW50Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uRGVzdHJveVZpZXdcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvbkRlc3Ryb3lcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblN0b3BcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJ0b1N0cmluZ092ZXJyaWRlXCIsIG51bGwpO1xuICAgIHJldHVybiBGcmFnbWVudENhbGxiYWNrc0ltcGxlbWVudGF0aW9uO1xufSgpKTtcbnZhciBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uKCkge1xuICAgIH1cbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5nZXRSb290VmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jvb3RWaWV3O1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25DcmVhdGUgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHNhdmVkSW5zdGFuY2VTdGF0ZSwgaW50ZW50T3JTdXBlckZ1bmMsIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBY3Rpdml0eS5vbkNyZWF0ZShcIiArIHNhdmVkSW5zdGFuY2VTdGF0ZSArIFwiKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW50ZW50ID0gc3VwZXJGdW5jID8gaW50ZW50T3JTdXBlckZ1bmMgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmICghc3VwZXJGdW5jKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFuZHJvaWRBY3Rpdml0eUNhbGxiYWNrcy5vbkNyZWF0ZShhY3Rpdml0eTogYW55LCBzYXZlZEluc3RhbmNlU3RhdGU6IGFueSwgc3VwZXJGdW5jOiBGdW5jdGlvbikgXCIgK1xuICAgICAgICAgICAgICAgIFwiaXMgZGVwcmVjYXRlZC4gVXNlIEFuZHJvaWRBY3Rpdml0eUNhbGxiYWNrcy5vbkNyZWF0ZShhY3Rpdml0eTogYW55LCBzYXZlZEluc3RhbmNlU3RhdGU6IGFueSwgaW50ZW50OiBhbnksIHN1cGVyRnVuYzogRnVuY3Rpb24pIGluc3RlYWQuXCIpO1xuICAgICAgICAgICAgc3VwZXJGdW5jID0gaW50ZW50T3JTdXBlckZ1bmM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzUmVzdGFydCA9ICEhc2F2ZWRJbnN0YW5jZVN0YXRlICYmIGV4cG9ydHMubW9kdWxlTG9hZGVkO1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSwgaXNSZXN0YXJ0ID8gc2F2ZWRJbnN0YW5jZVN0YXRlIDogbnVsbCk7XG4gICAgICAgIGlmIChzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciByb290Vmlld0lkID0gc2F2ZWRJbnN0YW5jZVN0YXRlLmdldEludChST09UX1ZJRVdfSURfRVhUUkEsIC0xKTtcbiAgICAgICAgICAgIGlmIChyb290Vmlld0lkICE9PSAtMSAmJiBhY3Rpdml0eVJvb3RWaWV3c01hcC5oYXMocm9vdFZpZXdJZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yb290VmlldyA9IGFjdGl2aXR5Um9vdFZpZXdzTWFwLmdldChyb290Vmlld0lkKS5nZXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW50ZW50ICYmIGludGVudC5nZXRBY3Rpb24oKSkge1xuICAgICAgICAgICAgYXBwbGljYXRpb24uYW5kcm9pZC5ub3RpZnkoe1xuICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb24uQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5TmV3SW50ZW50RXZlbnQsXG4gICAgICAgICAgICAgICAgb2JqZWN0OiBhcHBsaWNhdGlvbi5hbmRyb2lkLFxuICAgICAgICAgICAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgICBpbnRlbnQ6IGludGVudFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRBY3Rpdml0eUNvbnRlbnQoYWN0aXZpdHksIHNhdmVkSW5zdGFuY2VTdGF0ZSwgdHJ1ZSk7XG4gICAgICAgIGV4cG9ydHMubW9kdWxlTG9hZGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uU2F2ZUluc3RhbmNlU3RhdGUgPSBmdW5jdGlvbiAoYWN0aXZpdHksIG91dFN0YXRlLCBzdXBlckZ1bmMpIHtcbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoYWN0aXZpdHksIG91dFN0YXRlKTtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyBpbnN0YW5jZW9mIEZyYW1lKSB7XG4gICAgICAgICAgICBvdXRTdGF0ZS5wdXRJbnQoSU5URU5UX0VYVFJBLCByb290Vmlldy5hbmRyb2lkLmZyYW1lSWQpO1xuICAgICAgICAgICAgcm9vdFZpZXcuX3NhdmVGcmFnbWVudHNTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIG91dFN0YXRlLnB1dEludChST09UX1ZJRVdfSURfRVhUUkEsIHJvb3RWaWV3Ll9kb21JZCk7XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbk5ld0ludGVudCA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgaW50ZW50LCBzdXBlclNldEludGVudEZ1bmMsIHN1cGVyRnVuYykge1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSwgaW50ZW50KTtcbiAgICAgICAgc3VwZXJTZXRJbnRlbnRGdW5jLmNhbGwoYWN0aXZpdHksIGludGVudCk7XG4gICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb24uQW5kcm9pZEFwcGxpY2F0aW9uLmFjdGl2aXR5TmV3SW50ZW50RXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IGFwcGxpY2F0aW9uLmFuZHJvaWQsXG4gICAgICAgICAgICBhY3Rpdml0eTogYWN0aXZpdHksXG4gICAgICAgICAgICBpbnRlbnQ6IGludGVudFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uU3RhcnQgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHN1cGVyRnVuYykge1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSk7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uU3RhcnQoKTtcIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyAmJiAhcm9vdFZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3LmNhbGxMb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25TdG9wID0gZnVuY3Rpb24gKGFjdGl2aXR5LCBzdXBlckZ1bmMpIHtcbiAgICAgICAgc3VwZXJGdW5jLmNhbGwoYWN0aXZpdHkpO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOYXRpdmVTY3JpcHRBY3Rpdml0eS5vblN0b3AoKTtcIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyAmJiByb290Vmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcm9vdFZpZXcuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uUG9zdFJlc3VtZSA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5KTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiTmF0aXZlU2NyaXB0QWN0aXZpdHkub25Qb3N0UmVzdW1lKCk7XCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpdml0eS5pc05hdGl2ZVNjcmlwdEFjdGl2aXR5KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgICAgICBldmVudE5hbWU6IGFwcGxpY2F0aW9uLnJlc3VtZUV2ZW50LFxuICAgICAgICAgICAgICAgIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCxcbiAgICAgICAgICAgICAgICBhbmRyb2lkOiBhY3Rpdml0eVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uLm5vdGlmeShhcmdzKTtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uLmFuZHJvaWQucGF1c2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uRGVzdHJveSA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uRGVzdHJveSgpO1wiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKHJvb3RWaWV3KSB7XG4gICAgICAgICAgICByb290Vmlldy5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXhpdEFyZ3MgPSB7IGV2ZW50TmFtZTogYXBwbGljYXRpb24uZXhpdEV2ZW50LCBvYmplY3Q6IGFwcGxpY2F0aW9uLmFuZHJvaWQsIGFuZHJvaWQ6IGFjdGl2aXR5IH07XG4gICAgICAgIGFwcGxpY2F0aW9uLm5vdGlmeShleGl0QXJncyk7XG4gICAgICAgIHN1cGVyRnVuYy5jYWxsKGFjdGl2aXR5KTtcbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoYWN0aXZpdHksIHN1cGVyRnVuYykge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOYXRpdmVTY3JpcHRBY3Rpdml0eS5vbkJhY2tQcmVzc2VkO1wiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogXCJhY3Rpdml0eUJhY2tQcmVzc2VkXCIsXG4gICAgICAgICAgICBvYmplY3Q6IGFwcGxpY2F0aW9uLmFuZHJvaWQsXG4gICAgICAgICAgICBhY3Rpdml0eTogYWN0aXZpdHksXG4gICAgICAgICAgICBjYW5jZWw6IGZhbHNlLFxuICAgICAgICB9O1xuICAgICAgICBhcHBsaWNhdGlvbi5hbmRyb2lkLm5vdGlmeShhcmdzKTtcbiAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgdmFyIGNhbGxTdXBlciA9IGZhbHNlO1xuICAgICAgICBpZiAodmlldyBpbnN0YW5jZW9mIEZyYW1lKSB7XG4gICAgICAgICAgICBjYWxsU3VwZXIgPSAhZnJhbWVfY29tbW9uXzEuZ29CYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdmlld0FyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBcImFjdGl2aXR5QmFja1ByZXNzZWRcIixcbiAgICAgICAgICAgICAgICBvYmplY3Q6IHZpZXcsXG4gICAgICAgICAgICAgICAgYWN0aXZpdHk6IGFjdGl2aXR5LFxuICAgICAgICAgICAgICAgIGNhbmNlbDogZmFsc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmlldy5ub3RpZnkodmlld0FyZ3MpO1xuICAgICAgICAgICAgaWYgKCF2aWV3QXJncy5jYW5jZWwgJiYgIXZpZXcub25CYWNrUHJlc3NlZCgpKSB7XG4gICAgICAgICAgICAgICAgY2FsbFN1cGVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbFN1cGVyKSB7XG4gICAgICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uUmVxdWVzdFBlcm1pc3Npb25zUmVzdWx0ID0gZnVuY3Rpb24gKGFjdGl2aXR5LCByZXF1ZXN0Q29kZSwgcGVybWlzc2lvbnMsIGdyYW50UmVzdWx0cywgc3VwZXJGdW5jKSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIk5hdGl2ZVNjcmlwdEFjdGl2aXR5Lm9uUmVxdWVzdFBlcm1pc3Npb25zUmVzdWx0O1wiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBhcHBsaWNhdGlvbi5hbmRyb2lkLm5vdGlmeSh7XG4gICAgICAgICAgICBldmVudE5hbWU6IFwiYWN0aXZpdHlSZXF1ZXN0UGVybWlzc2lvbnNcIixcbiAgICAgICAgICAgIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCxcbiAgICAgICAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eSxcbiAgICAgICAgICAgIHJlcXVlc3RDb2RlOiByZXF1ZXN0Q29kZSxcbiAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwZXJtaXNzaW9ucyxcbiAgICAgICAgICAgIGdyYW50UmVzdWx0czogZ3JhbnRSZXN1bHRzXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUub25BY3Rpdml0eVJlc3VsdCA9IGZ1bmN0aW9uIChhY3Rpdml0eSwgcmVxdWVzdENvZGUsIHJlc3VsdENvZGUsIGRhdGEsIHN1cGVyRnVuYykge1xuICAgICAgICBzdXBlckZ1bmMuY2FsbChhY3Rpdml0eSwgcmVxdWVzdENvZGUsIHJlc3VsdENvZGUsIGRhdGEpO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOYXRpdmVTY3JpcHRBY3Rpdml0eS5vbkFjdGl2aXR5UmVzdWx0KFwiICsgcmVxdWVzdENvZGUgKyBcIiwgXCIgKyByZXN1bHRDb2RlICsgXCIsIFwiICsgZGF0YSArIFwiKVwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBhcHBsaWNhdGlvbi5hbmRyb2lkLm5vdGlmeSh7XG4gICAgICAgICAgICBldmVudE5hbWU6IFwiYWN0aXZpdHlSZXN1bHRcIixcbiAgICAgICAgICAgIG9iamVjdDogYXBwbGljYXRpb24uYW5kcm9pZCxcbiAgICAgICAgICAgIGFjdGl2aXR5OiBhY3Rpdml0eSxcbiAgICAgICAgICAgIHJlcXVlc3RDb2RlOiByZXF1ZXN0Q29kZSxcbiAgICAgICAgICAgIHJlc3VsdENvZGU6IHJlc3VsdENvZGUsXG4gICAgICAgICAgICBpbnRlbnQ6IGRhdGFcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5yZXNldEFjdGl2aXR5Q29udGVudCA9IGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICBpZiAodGhpcy5fcm9vdFZpZXcpIHtcbiAgICAgICAgICAgIHZhciBtYW5hZ2VyID0gdGhpcy5fcm9vdFZpZXcuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgbWFuYWdlci5leGVjdXRlUGVuZGluZ1RyYW5zYWN0aW9ucygpO1xuICAgICAgICAgICAgdGhpcy5fcm9vdFZpZXcuX29uUm9vdFZpZXdSZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jvb3RWaWV3ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zZXRBY3Rpdml0eUNvbnRlbnQoYWN0aXZpdHksIG51bGwsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5fcm9vdFZpZXcuY2FsbExvYWRlZCgpO1xuICAgIH07XG4gICAgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUuc2V0QWN0aXZpdHlDb250ZW50ID0gZnVuY3Rpb24gKGFjdGl2aXR5LCBzYXZlZEluc3RhbmNlU3RhdGUsIGZpcmVMYXVuY2hFdmVudCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc2hvdWxkQ3JlYXRlUm9vdEZyYW1lID0gYXBwbGljYXRpb24uX3Nob3VsZENyZWF0ZVJvb3RGcmFtZSgpO1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiRnJhbWUuc2V0QWN0aXZpdHlDb250ZW50IHJvb3RWaWV3OiBcIiArIHJvb3RWaWV3ICsgXCIgc2hvdWxkQ3JlYXRlUm9vdEZyYW1lOiBcIiArIHNob3VsZENyZWF0ZVJvb3RGcmFtZSArIFwiIGZpcmVMYXVuY2hFdmVudDogXCIgKyBmaXJlTGF1bmNoRXZlbnQsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcm9vdFZpZXcpIHtcbiAgICAgICAgICAgIHZhciBtYWluRW50cnkgPSBhcHBsaWNhdGlvbi5nZXRNYWluRW50cnkoKTtcbiAgICAgICAgICAgIHZhciBpbnRlbnQgPSBhY3Rpdml0eS5nZXRJbnRlbnQoKTtcbiAgICAgICAgICAgIGlmIChmaXJlTGF1bmNoRXZlbnQpIHtcbiAgICAgICAgICAgICAgICByb290VmlldyA9IG5vdGlmeUxhdW5jaChpbnRlbnQsIHNhdmVkSW5zdGFuY2VTdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXJvb3RWaWV3KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFtYWluRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWFpbiBlbnRyeSBpcyBtaXNzaW5nLiBBcHAgY2Fubm90IGJlIHN0YXJ0ZWQuIFZlcmlmeSBhcHAgYm9vdHN0cmFwLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZENyZWF0ZVJvb3RGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0cmFzID0gaW50ZW50LmdldEV4dHJhcygpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWVJZCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0cmFzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZUlkID0gZXh0cmFzLmdldEludChJTlRFTlRfRVhUUkEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2F2ZWRJbnN0YW5jZVN0YXRlICYmIGZyYW1lSWQgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFtZUlkID0gc2F2ZWRJbnN0YW5jZVN0YXRlLmdldEludChJTlRFTlRfRVhUUkEsIC0xKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXJvb3RWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb290VmlldyA9IGdldEZyYW1lQnlOdW1iZXJJZChmcmFtZUlkKSB8fCBuZXcgRnJhbWUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocm9vdFZpZXcgaW5zdGFuY2VvZiBGcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdFZpZXcubmF2aWdhdGUobWFpbkVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkEgRnJhbWUgbXVzdCBiZSB1c2VkIHRvIG5hdmlnYXRlIHRvIGEgUGFnZS5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJvb3RWaWV3ID0gYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkobWFpbkVudHJ5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yb290VmlldyA9IHJvb3RWaWV3O1xuICAgICAgICAgICAgYWN0aXZpdHlSb290Vmlld3NNYXAuc2V0KHJvb3RWaWV3Ll9kb21JZCwgbmV3IFdlYWtSZWYocm9vdFZpZXcpKTtcbiAgICAgICAgICAgIHZhciBkZXZpY2VUeXBlID0gcGxhdGZvcm1fMS5kZXZpY2UuZGV2aWNlVHlwZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgc3lzdGVtX2NsYXNzZXNfMS5wdXNoVG9Sb290Vmlld0Nzc0NsYXNzZXMoXCJcIiArIHN5c3RlbV9jbGFzc2VzXzEuQ0xBU1NfUFJFRklYICsgQU5EUk9JRF9QTEFURk9STSk7XG4gICAgICAgICAgICBzeXN0ZW1fY2xhc3Nlc18xLnB1c2hUb1Jvb3RWaWV3Q3NzQ2xhc3NlcyhcIlwiICsgc3lzdGVtX2NsYXNzZXNfMS5DTEFTU19QUkVGSVggKyBkZXZpY2VUeXBlKTtcbiAgICAgICAgICAgIHN5c3RlbV9jbGFzc2VzXzEucHVzaFRvUm9vdFZpZXdDc3NDbGFzc2VzKFwiXCIgKyBzeXN0ZW1fY2xhc3Nlc18xLkNMQVNTX1BSRUZJWCArIGFwcGxpY2F0aW9uLmFuZHJvaWQub3JpZW50YXRpb24pO1xuICAgICAgICAgICAgdmFyIHJvb3RWaWV3Q3NzQ2xhc3NlcyA9IHN5c3RlbV9jbGFzc2VzXzEuZ2V0Um9vdFZpZXdDc3NDbGFzc2VzKCk7XG4gICAgICAgICAgICByb290Vmlld0Nzc0NsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gX3RoaXMuX3Jvb3RWaWV3LmNzc0NsYXNzZXMuYWRkKGMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvdWxkQ3JlYXRlUm9vdEZyYW1lKSB7XG4gICAgICAgICAgICByb290Vmlldy5fc2V0dXBVSShhY3Rpdml0eSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByb290Vmlldy5fc2V0dXBBc1Jvb3RWaWV3KGFjdGl2aXR5KTtcbiAgICAgICAgfVxuICAgICAgICBhY3Rpdml0eS5zZXRDb250ZW50Vmlldyhyb290Vmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpKTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25DcmVhdGVcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblNhdmVJbnN0YW5jZVN0YXRlXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25OZXdJbnRlbnRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uLnByb3RvdHlwZSwgXCJvblN0YXJ0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25TdG9wXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25Qb3N0UmVzdW1lXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25EZXN0cm95XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25CYWNrUHJlc3NlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEFjdGl2aXR5Q2FsbGJhY2tzSW1wbGVtZW50YXRpb24ucHJvdG90eXBlLCBcIm9uUmVxdWVzdFBlcm1pc3Npb25zUmVzdWx0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbi5wcm90b3R5cGUsIFwib25BY3Rpdml0eVJlc3VsdFwiLCBudWxsKTtcbiAgICByZXR1cm4gQWN0aXZpdHlDYWxsYmFja3NJbXBsZW1lbnRhdGlvbjtcbn0oKSk7XG52YXIgbm90aWZ5TGF1bmNoID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIm5vdGlmeUxhdW5jaFwiLCBmdW5jdGlvbiBub3RpZnlMYXVuY2goaW50ZW50LCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICB2YXIgbGF1bmNoQXJncyA9IHtcbiAgICAgICAgZXZlbnROYW1lOiBhcHBsaWNhdGlvbi5sYXVuY2hFdmVudCxcbiAgICAgICAgb2JqZWN0OiBhcHBsaWNhdGlvbi5hbmRyb2lkLFxuICAgICAgICBhbmRyb2lkOiBpbnRlbnQsIHNhdmVkSW5zdGFuY2VTdGF0ZTogc2F2ZWRJbnN0YW5jZVN0YXRlXG4gICAgfTtcbiAgICBhcHBsaWNhdGlvbi5ub3RpZnkobGF1bmNoQXJncyk7XG4gICAgYXBwbGljYXRpb24ubm90aWZ5KHsgZXZlbnROYW1lOiBcImxvYWRBcHBDc3NcIiwgb2JqZWN0OiB0aGlzLCBjc3NGaWxlOiBhcHBsaWNhdGlvbi5nZXRDc3NGaWxlTmFtZSgpIH0pO1xuICAgIHJldHVybiBsYXVuY2hBcmdzLnJvb3Q7XG59KTtcbmZ1bmN0aW9uIHNldEFjdGl2aXR5Q2FsbGJhY2tzKGFjdGl2aXR5KSB7XG4gICAgYWN0aXZpdHlbQ0FMTEJBQ0tTXSA9IG5ldyBBY3Rpdml0eUNhbGxiYWNrc0ltcGxlbWVudGF0aW9uKCk7XG59XG5leHBvcnRzLnNldEFjdGl2aXR5Q2FsbGJhY2tzID0gc2V0QWN0aXZpdHlDYWxsYmFja3M7XG5mdW5jdGlvbiBzZXRGcmFnbWVudENhbGxiYWNrcyhmcmFnbWVudCkge1xuICAgIGZyYWdtZW50W0NBTExCQUNLU10gPSBuZXcgRnJhZ21lbnRDYWxsYmFja3NJbXBsZW1lbnRhdGlvbigpO1xufVxuZXhwb3J0cy5zZXRGcmFnbWVudENhbGxiYWNrcyA9IHNldEZyYWdtZW50Q2FsbGJhY2tzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhbWUuYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgR2VzdHVyZVR5cGVzO1xuKGZ1bmN0aW9uIChHZXN0dXJlVHlwZXMpIHtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1widGFwXCJdID0gMV0gPSBcInRhcFwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJkb3VibGVUYXBcIl0gPSAyXSA9IFwiZG91YmxlVGFwXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInBpbmNoXCJdID0gNF0gPSBcInBpbmNoXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInBhblwiXSA9IDhdID0gXCJwYW5cIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wic3dpcGVcIl0gPSAxNl0gPSBcInN3aXBlXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInJvdGF0aW9uXCJdID0gMzJdID0gXCJyb3RhdGlvblwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJsb25nUHJlc3NcIl0gPSA2NF0gPSBcImxvbmdQcmVzc1wiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJ0b3VjaFwiXSA9IDEyOF0gPSBcInRvdWNoXCI7XG59KShHZXN0dXJlVHlwZXMgPSBleHBvcnRzLkdlc3R1cmVUeXBlcyB8fCAoZXhwb3J0cy5HZXN0dXJlVHlwZXMgPSB7fSkpO1xudmFyIEdlc3R1cmVTdGF0ZVR5cGVzO1xuKGZ1bmN0aW9uIChHZXN0dXJlU3RhdGVUeXBlcykge1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiY2FuY2VsbGVkXCJdID0gMF0gPSBcImNhbmNlbGxlZFwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiYmVnYW5cIl0gPSAxXSA9IFwiYmVnYW5cIjtcbiAgICBHZXN0dXJlU3RhdGVUeXBlc1tHZXN0dXJlU3RhdGVUeXBlc1tcImNoYW5nZWRcIl0gPSAyXSA9IFwiY2hhbmdlZFwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiZW5kZWRcIl0gPSAzXSA9IFwiZW5kZWRcIjtcbn0pKEdlc3R1cmVTdGF0ZVR5cGVzID0gZXhwb3J0cy5HZXN0dXJlU3RhdGVUeXBlcyB8fCAoZXhwb3J0cy5HZXN0dXJlU3RhdGVUeXBlcyA9IHt9KSk7XG52YXIgU3dpcGVEaXJlY3Rpb247XG4oZnVuY3Rpb24gKFN3aXBlRGlyZWN0aW9uKSB7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJyaWdodFwiXSA9IDFdID0gXCJyaWdodFwiO1xuICAgIFN3aXBlRGlyZWN0aW9uW1N3aXBlRGlyZWN0aW9uW1wibGVmdFwiXSA9IDJdID0gXCJsZWZ0XCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJ1cFwiXSA9IDRdID0gXCJ1cFwiO1xuICAgIFN3aXBlRGlyZWN0aW9uW1N3aXBlRGlyZWN0aW9uW1wiZG93blwiXSA9IDhdID0gXCJkb3duXCI7XG59KShTd2lwZURpcmVjdGlvbiA9IGV4cG9ydHMuU3dpcGVEaXJlY3Rpb24gfHwgKGV4cG9ydHMuU3dpcGVEaXJlY3Rpb24gPSB7fSkpO1xudmFyIFRvdWNoQWN0aW9uO1xuKGZ1bmN0aW9uIChUb3VjaEFjdGlvbikge1xuICAgIFRvdWNoQWN0aW9uLmRvd24gPSBcImRvd25cIjtcbiAgICBUb3VjaEFjdGlvbi51cCA9IFwidXBcIjtcbiAgICBUb3VjaEFjdGlvbi5tb3ZlID0gXCJtb3ZlXCI7XG4gICAgVG91Y2hBY3Rpb24uY2FuY2VsID0gXCJjYW5jZWxcIjtcbn0pKFRvdWNoQWN0aW9uID0gZXhwb3J0cy5Ub3VjaEFjdGlvbiB8fCAoZXhwb3J0cy5Ub3VjaEFjdGlvbiA9IHt9KSk7XG5mdW5jdGlvbiB0b1N0cmluZyh0eXBlLCBzZXBhcmF0b3IpIHtcbiAgICB2YXIgdHlwZXMgPSBuZXcgQXJyYXkoKTtcbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy50YXApIHtcbiAgICAgICAgdHlwZXMucHVzaChcInRhcFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMuZG91YmxlVGFwKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJkb3VibGVUYXBcIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnBpbmNoKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJwaW5jaFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucGFuKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJwYW5cIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnN3aXBlKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJzd2lwZVwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucm90YXRpb24pIHtcbiAgICAgICAgdHlwZXMucHVzaChcInJvdGF0aW9uXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5sb25nUHJlc3MpIHtcbiAgICAgICAgdHlwZXMucHVzaChcImxvbmdQcmVzc1wiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMudG91Y2gpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInRvdWNoXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZXMuam9pbihzZXBhcmF0b3IpO1xufVxuZXhwb3J0cy50b1N0cmluZyA9IHRvU3RyaW5nO1xuZnVuY3Rpb24gZnJvbVN0cmluZyh0eXBlKSB7XG4gICAgdmFyIHQgPSB0eXBlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh0ID09PSBcInRhcFwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMudGFwO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcImRvdWJsZXRhcFwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMuZG91YmxlVGFwO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInBpbmNoXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5waW5jaDtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJwYW5cIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnBhbjtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJzd2lwZVwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMuc3dpcGU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwicm90YXRpb25cIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnJvdGF0aW9uO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcImxvbmdwcmVzc1wiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMubG9uZ1ByZXNzO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInRvdWNoXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy50b3VjaDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZnJvbVN0cmluZyA9IGZyb21TdHJpbmc7XG52YXIgR2VzdHVyZXNPYnNlcnZlckJhc2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdlc3R1cmVzT2JzZXJ2ZXJCYXNlKHRhcmdldCwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlc3R1cmVzT2JzZXJ2ZXJCYXNlLnByb3RvdHlwZSwgXCJjYWxsYmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcInRhcmdldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RhcmdldDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlc3R1cmVzT2JzZXJ2ZXJCYXNlLnByb3RvdHlwZSwgXCJjb250ZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLnRhcmdldC5nZXRHZXN0dXJlT2JzZXJ2ZXJzKHRoaXMudHlwZSk7XG4gICAgICAgICAgICBpZiAobGlzdCAmJiBsaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RbaV0uY2FsbGJhY2sgPT09IHRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldC5fZ2VzdHVyZU9ic2VydmVyc1t0aGlzLnR5cGVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRhcmdldC5fZ2VzdHVyZU9ic2VydmVyc1t0aGlzLnR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RhcmdldCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gR2VzdHVyZXNPYnNlcnZlckJhc2U7XG59KCkpO1xuZXhwb3J0cy5HZXN0dXJlc09ic2VydmVyQmFzZSA9IEdlc3R1cmVzT2JzZXJ2ZXJCYXNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2VzdHVyZXMtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZ2VzdHVyZXNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9nZXN0dXJlcy1jb21tb25cIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciB0aW1lciA9IHJlcXVpcmUoXCIuLi8uLi90aW1lclwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2dlc3R1cmVzLWNvbW1vblwiKSk7XG52YXIgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZVRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lcigpIHtcbiAgICBpZiAoVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbChvYnNlcnZlciwgdGFyZ2V0LCB0eXBlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuX2xhc3RVcFRpbWUgPSAwO1xuICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgICAgICBfdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgX3RoaXMuX3R5cGUgPSB0eXBlO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25TaW5nbGVUYXBVcCA9IGZ1bmN0aW9uIChtb3Rpb25FdmVudCkge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlU2luZ2xlVGFwKG1vdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RVcFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uRG93biA9IGZ1bmN0aW9uIChtb3Rpb25FdmVudCkge1xuICAgICAgICAgICAgdmFyIHRhcFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgaWYgKCh0YXBUaW1lIC0gdGhpcy5fbGFzdFVwVGltZSkgPD0gVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5Eb3VibGVUYXBUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlRG91YmxlVGFwKG1vdGlvbkV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkxvbmdQcmVzcyA9IGZ1bmN0aW9uIChtb3Rpb25FdmVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3R5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBfZ2V0QXJncyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzLCB0aGlzLl90YXJnZXQsIG1vdGlvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUuX2hhbmRsZVNpbmdsZVRhcCA9IGZ1bmN0aW9uIChtb3Rpb25FdmVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmICh0aGlzLl90YXJnZXQuZ2V0R2VzdHVyZU9ic2VydmVycyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RhcFRpbWVvdXRJZCA9IHRpbWVyLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX3R5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudGFwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IF9nZXRBcmdzKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXAsIF90aGlzLl90YXJnZXQsIG1vdGlvbkV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2soX3RoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aW1lci5jbGVhclRpbWVvdXQoX3RoaXMuX3RhcFRpbWVvdXRJZCk7XG4gICAgICAgICAgICAgICAgfSwgVGFwQW5kRG91YmxlVGFwR2VzdHVyZUxpc3RlbmVySW1wbC5Eb3VibGVUYXBUaW1lb3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRhcCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IF9nZXRBcmdzKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXAsIHRoaXMuX3RhcmdldCwgbW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLl9oYW5kbGVEb3VibGVUYXAgPSBmdW5jdGlvbiAobW90aW9uRXZlbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90YXBUaW1lb3V0SWQpIHtcbiAgICAgICAgICAgICAgICB0aW1lci5jbGVhclRpbWVvdXQodGhpcy5fdGFwVGltZW91dElkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl90eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gX2dldEFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCwgdGhpcy5fdGFyZ2V0LCBtb3Rpb25FdmVudCk7XG4gICAgICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLl9vYnNlcnZlciwgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGwuRG91YmxlVGFwVGltZW91dCA9IGFuZHJvaWQudmlldy5WaWV3Q29uZmlndXJhdGlvbi5nZXREb3VibGVUYXBUaW1lb3V0KCk7XG4gICAgICAgIHJldHVybiBUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXJJbXBsO1xuICAgIH0oYW5kcm9pZC52aWV3Lkdlc3R1cmVEZXRlY3Rvci5TaW1wbGVPbkdlc3R1cmVMaXN0ZW5lcikpO1xuICAgIFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lciA9IFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lckltcGw7XG59XG52YXIgUGluY2hHZXN0dXJlTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplUGluY2hHZXN0dXJlTGlzdGVuZXIoKSB7XG4gICAgaWYgKFBpbmNoR2VzdHVyZUxpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFBpbmNoR2VzdHVyZUxpc3RlbmVySW1wbChvYnNlcnZlciwgdGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuX29ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgICAgICBfdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgUGluY2hHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vblNjYWxlQmVnaW4gPSBmdW5jdGlvbiAoZGV0ZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3NjYWxlID0gZGV0ZWN0b3IuZ2V0U2NhbGVGYWN0b3IoKTtcbiAgICAgICAgICAgIHZhciBhcmdzID0gbmV3IFBpbmNoR2VzdHVyZUV2ZW50RGF0YSh0aGlzLl90YXJnZXQsIGRldGVjdG9yLCB0aGlzLl9zY2FsZSwgdGhpcy5fdGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5iZWdhbik7XG4gICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uU2NhbGUgPSBmdW5jdGlvbiAoZGV0ZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3NjYWxlICo9IGRldGVjdG9yLmdldFNjYWxlRmFjdG9yKCk7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBQaW5jaEdlc3R1cmVFdmVudERhdGEodGhpcy5fdGFyZ2V0LCBkZXRlY3RvciwgdGhpcy5fc2NhbGUsIHRoaXMuX3RhcmdldCwgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuY2hhbmdlZCk7XG4gICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uU2NhbGVFbmQgPSBmdW5jdGlvbiAoZGV0ZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3NjYWxlICo9IGRldGVjdG9yLmdldFNjYWxlRmFjdG9yKCk7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBQaW5jaEdlc3R1cmVFdmVudERhdGEodGhpcy5fdGFyZ2V0LCBkZXRlY3RvciwgdGhpcy5fc2NhbGUsIHRoaXMuX3RhcmdldCwgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuZW5kZWQpO1xuICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLl9vYnNlcnZlciwgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBQaW5jaEdlc3R1cmVMaXN0ZW5lckltcGw7XG4gICAgfShhbmRyb2lkLnZpZXcuU2NhbGVHZXN0dXJlRGV0ZWN0b3IuU2ltcGxlT25TY2FsZUdlc3R1cmVMaXN0ZW5lcikpO1xuICAgIFBpbmNoR2VzdHVyZUxpc3RlbmVyID0gUGluY2hHZXN0dXJlTGlzdGVuZXJJbXBsO1xufVxudmFyIFN3aXBlR2VzdHVyZUxpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZVN3aXBlR2VzdHVyZUxpc3RlbmVyKCkge1xuICAgIGlmIChTd2lwZUdlc3R1cmVMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoU3dpcGVHZXN0dXJlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBTd2lwZUdlc3R1cmVMaXN0ZW5lckltcGwob2JzZXJ2ZXIsIHRhcmdldCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgICAgICAgX3RoaXMuX3RhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFN3aXBlR2VzdHVyZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25Eb3duID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgU3dpcGVHZXN0dXJlTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkZsaW5nID0gZnVuY3Rpb24gKGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50LCB2ZWxvY2l0eVgsIHZlbG9jaXR5WSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGFyZ3M7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBkZWx0YVkgPSBjdXJyZW50RXZlbnQuZ2V0WSgpIC0gaW5pdGlhbEV2ZW50LmdldFkoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGVsdGFYID0gY3VycmVudEV2ZW50LmdldFgoKSAtIGluaXRpYWxFdmVudC5nZXRYKCk7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGRlbHRhWCkgPiBNYXRoLmFicyhkZWx0YVkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkZWx0YVgpID4gU1dJUEVfVEhSRVNIT0xEXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBNYXRoLmFicyh2ZWxvY2l0eVgpID4gU1dJUEVfVkVMT0NJVFlfVEhSRVNIT0xEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVsdGFYID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBfZ2V0U3dpcGVBcmdzKGdlc3R1cmVzX2NvbW1vbl8xLlN3aXBlRGlyZWN0aW9uLnJpZ2h0LCB0aGlzLl90YXJnZXQsIGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IF9nZXRTd2lwZUFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24ubGVmdCwgdGhpcy5fdGFyZ2V0LCBpbml0aWFsRXZlbnQsIGN1cnJlbnRFdmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLl9vYnNlcnZlciwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGRlbHRhWSkgPiBTV0lQRV9USFJFU0hPTERcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIE1hdGguYWJzKHZlbG9jaXR5WSkgPiBTV0lQRV9WRUxPQ0lUWV9USFJFU0hPTEQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YVkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncyA9IF9nZXRTd2lwZUFyZ3MoZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24uZG93biwgdGhpcy5fdGFyZ2V0LCBpbml0aWFsRXZlbnQsIGN1cnJlbnRFdmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLl9vYnNlcnZlciwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBfZ2V0U3dpcGVBcmdzKGdlc3R1cmVzX2NvbW1vbl8xLlN3aXBlRGlyZWN0aW9uLnVwLCB0aGlzLl90YXJnZXQsIGluaXRpYWxFdmVudCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX29ic2VydmVyLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU3dpcGVHZXN0dXJlTGlzdGVuZXJJbXBsO1xuICAgIH0oYW5kcm9pZC52aWV3Lkdlc3R1cmVEZXRlY3Rvci5TaW1wbGVPbkdlc3R1cmVMaXN0ZW5lcikpO1xuICAgIFN3aXBlR2VzdHVyZUxpc3RlbmVyID0gU3dpcGVHZXN0dXJlTGlzdGVuZXJJbXBsO1xufVxudmFyIFNXSVBFX1RIUkVTSE9MRCA9IDEwMDtcbnZhciBTV0lQRV9WRUxPQ0lUWV9USFJFU0hPTEQgPSAxMDA7XG52YXIgSU5WQUxJRF9QT0lOVEVSX0lEID0gLTE7XG52YXIgVE9fREVHUkVFUyA9ICgxODAgLyBNYXRoLlBJKTtcbmZ1bmN0aW9uIG9ic2VydmUodGFyZ2V0LCB0eXBlLCBjYWxsYmFjaywgY29udGV4dCkge1xuICAgIHZhciBvYnNlcnZlciA9IG5ldyBHZXN0dXJlc09ic2VydmVyKHRhcmdldCwgY2FsbGJhY2ssIGNvbnRleHQpO1xuICAgIG9ic2VydmVyLm9ic2VydmUodHlwZSk7XG4gICAgcmV0dXJuIG9ic2VydmVyO1xufVxuZXhwb3J0cy5vYnNlcnZlID0gb2JzZXJ2ZTtcbnZhciBHZXN0dXJlc09ic2VydmVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR2VzdHVyZXNPYnNlcnZlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHZXN0dXJlc09ic2VydmVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLm9ic2VydmUgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy50YXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldExvYWRlZCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2F0dGFjaChfdGhpcy50YXJnZXQsIHR5cGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIF90aGlzLl9kZXRhY2goKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vbihcImxvYWRlZFwiLCB0aGlzLl9vblRhcmdldExvYWRlZCk7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vbihcInVubG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoKHRoaXMudGFyZ2V0LCB0eXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub2ZmKFwibG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0TG9hZGVkKTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0Lm9mZihcInVubG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQpO1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRMb2FkZWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNjb25uZWN0LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5fZGV0YWNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9ub3RpZnlUb3VjaCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zaW1wbGVHZXN0dXJlRGV0ZWN0b3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9zY2FsZUdlc3R1cmVEZXRlY3RvciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N3aXBlR2VzdHVyZURldGVjdG9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcGFuR2VzdHVyZURldGVjdG9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcm90YXRlR2VzdHVyZURldGVjdG9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZXZlbnREYXRhID0gbnVsbDtcbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLl9hdHRhY2ggPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlKSB7XG4gICAgICAgIHRoaXMuX2RldGFjaCgpO1xuICAgICAgICBpZiAoKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudGFwKSB8fCAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5kb3VibGVUYXApIHx8ICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmxvbmdQcmVzcykpIHtcbiAgICAgICAgICAgIGluaXRpYWxpemVUYXBBbmREb3VibGVUYXBHZXN0dXJlTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIHRoaXMuX3NpbXBsZUdlc3R1cmVEZXRlY3RvciA9IG5ldyBhbmRyb2lkeC5jb3JlLnZpZXcuR2VzdHVyZURldGVjdG9yQ29tcGF0KHRhcmdldC5fY29udGV4dCwgbmV3IFRhcEFuZERvdWJsZVRhcEdlc3R1cmVMaXN0ZW5lcih0aGlzLCB0aGlzLnRhcmdldCwgdHlwZSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBpbmNoKSB7XG4gICAgICAgICAgICBpbml0aWFsaXplUGluY2hHZXN0dXJlTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIHRoaXMuX3NjYWxlR2VzdHVyZURldGVjdG9yID0gbmV3IGFuZHJvaWQudmlldy5TY2FsZUdlc3R1cmVEZXRlY3Rvcih0YXJnZXQuX2NvbnRleHQsIG5ldyBQaW5jaEdlc3R1cmVMaXN0ZW5lcih0aGlzLCB0aGlzLnRhcmdldCkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnN3aXBlKSB7XG4gICAgICAgICAgICBpbml0aWFsaXplU3dpcGVHZXN0dXJlTGlzdGVuZXIoKTtcbiAgICAgICAgICAgIHRoaXMuX3N3aXBlR2VzdHVyZURldGVjdG9yID0gbmV3IGFuZHJvaWR4LmNvcmUudmlldy5HZXN0dXJlRGV0ZWN0b3JDb21wYXQodGFyZ2V0Ll9jb250ZXh0LCBuZXcgU3dpcGVHZXN0dXJlTGlzdGVuZXIodGhpcywgdGhpcy50YXJnZXQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4pIHtcbiAgICAgICAgICAgIHRoaXMuX3Bhbkdlc3R1cmVEZXRlY3RvciA9IG5ldyBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IodGhpcywgdGhpcy50YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnJvdGF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9yb3RhdGVHZXN0dXJlRGV0ZWN0b3IgPSBuZXcgQ3VzdG9tUm90YXRlR2VzdHVyZURldGVjdG9yKHRoaXMsIHRoaXMudGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50b3VjaCkge1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5VG91Y2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5hbmRyb2lkT25Ub3VjaEV2ZW50ID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLl9ub3RpZnlUb3VjaCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9ldmVudERhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ldmVudERhdGEgPSBuZXcgVG91Y2hHZXN0dXJlRXZlbnREYXRhKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9ldmVudERhdGEucHJlcGFyZSh0aGlzLnRhcmdldCwgbW90aW9uRXZlbnQpO1xuICAgICAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLCB0aGlzLl9ldmVudERhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9zaW1wbGVHZXN0dXJlRGV0ZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3NpbXBsZUdlc3R1cmVEZXRlY3Rvci5vblRvdWNoRXZlbnQobW90aW9uRXZlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9zY2FsZUdlc3R1cmVEZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fc2NhbGVHZXN0dXJlRGV0ZWN0b3Iub25Ub3VjaEV2ZW50KG1vdGlvbkV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fc3dpcGVHZXN0dXJlRGV0ZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3N3aXBlR2VzdHVyZURldGVjdG9yLm9uVG91Y2hFdmVudChtb3Rpb25FdmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3Bhbkdlc3R1cmVEZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fcGFuR2VzdHVyZURldGVjdG9yLm9uVG91Y2hFdmVudChtb3Rpb25FdmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3JvdGF0ZUdlc3R1cmVEZXRlY3Rvcikge1xuICAgICAgICAgICAgdGhpcy5fcm90YXRlR2VzdHVyZURldGVjdG9yLm9uVG91Y2hFdmVudChtb3Rpb25FdmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBHZXN0dXJlc09ic2VydmVyO1xufShnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlc09ic2VydmVyQmFzZSkpO1xuZXhwb3J0cy5HZXN0dXJlc09ic2VydmVyID0gR2VzdHVyZXNPYnNlcnZlcjtcbmZ1bmN0aW9uIF9nZXRBcmdzKHR5cGUsIHZpZXcsIGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICB2aWV3OiB2aWV3LFxuICAgICAgICBhbmRyb2lkOiBlLFxuICAgICAgICBpb3M6IHVuZGVmaW5lZCxcbiAgICAgICAgb2JqZWN0OiB2aWV3LFxuICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKHR5cGUpLFxuICAgIH07XG59XG5mdW5jdGlvbiBfZ2V0U3dpcGVBcmdzKGRpcmVjdGlvbiwgdmlldywgaW5pdGlhbEV2ZW50LCBjdXJyZW50RXZlbnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUsXG4gICAgICAgIHZpZXc6IHZpZXcsXG4gICAgICAgIGFuZHJvaWQ6IHsgaW5pdGlhbDogaW5pdGlhbEV2ZW50LCBjdXJyZW50OiBjdXJyZW50RXZlbnQgfSxcbiAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb24sXG4gICAgICAgIGlvczogdW5kZWZpbmVkLFxuICAgICAgICBvYmplY3Q6IHZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnN3aXBlKSxcbiAgICB9O1xufVxuZnVuY3Rpb24gX2dldFBhbkFyZ3MoZGVsdGFYLCBkZWx0YVksIHZpZXcsIHN0YXRlLCBpbml0aWFsRXZlbnQsIGN1cnJlbnRFdmVudCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4sXG4gICAgICAgIHZpZXc6IHZpZXcsXG4gICAgICAgIGFuZHJvaWQ6IHsgaW5pdGlhbDogaW5pdGlhbEV2ZW50LCBjdXJyZW50OiBjdXJyZW50RXZlbnQgfSxcbiAgICAgICAgZGVsdGFYOiBkZWx0YVgsXG4gICAgICAgIGRlbHRhWTogZGVsdGFZLFxuICAgICAgICBpb3M6IHVuZGVmaW5lZCxcbiAgICAgICAgb2JqZWN0OiB2aWV3LFxuICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4pLFxuICAgICAgICBzdGF0ZTogc3RhdGVcbiAgICB9O1xufVxuZnVuY3Rpb24gX2V4ZWN1dGVDYWxsYmFjayhvYnNlcnZlciwgYXJncykge1xuICAgIGlmIChvYnNlcnZlciAmJiBvYnNlcnZlci5jYWxsYmFjaykge1xuICAgICAgICBvYnNlcnZlci5jYWxsYmFjay5jYWxsKG9ic2VydmVyLl9jb250ZXh0LCBhcmdzKTtcbiAgICB9XG59XG52YXIgUGluY2hHZXN0dXJlRXZlbnREYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQaW5jaEdlc3R1cmVFdmVudERhdGEodmlldywgYW5kcm9pZCwgc2NhbGUsIG9iamVjdCwgc3RhdGUpIHtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgdGhpcy5hbmRyb2lkID0gYW5kcm9pZDtcbiAgICAgICAgdGhpcy5zY2FsZSA9IHNjYWxlO1xuICAgICAgICB0aGlzLm9iamVjdCA9IG9iamVjdDtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLnR5cGUgPSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGluY2g7XG4gICAgICAgIHRoaXMuZXZlbnROYW1lID0gZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBpbmNoKTtcbiAgICB9XG4gICAgUGluY2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRGb2N1c1ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQuZ2V0Rm9jdXNYKCkgLyB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH07XG4gICAgUGluY2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRGb2N1c1kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQuZ2V0Rm9jdXNZKCkgLyB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH07XG4gICAgcmV0dXJuIFBpbmNoR2VzdHVyZUV2ZW50RGF0YTtcbn0oKSk7XG52YXIgQ3VzdG9tUGFuR2VzdHVyZURldGVjdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3Iob2JzZXJ2ZXIsIHRhcmdldCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLmlzVHJhY2tpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5kZW5zaXR5ID0gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICB9XG4gICAgQ3VzdG9tUGFuR2VzdHVyZURldGVjdG9yLnByb3RvdHlwZS5vblRvdWNoRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC5nZXRBY3Rpb25NYXNrZWQoKSkge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX1VQOlxuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX0NBTkNFTDpcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrU3RvcChldmVudCwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX0RPV046XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9ET1dOOlxuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX1BPSU5URVJfVVA6XG4gICAgICAgICAgICAgICAgdGhpcy50cmFja1N0b3AoZXZlbnQsIHRydWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX01PVkU6XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzVHJhY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFja1N0YXJ0KGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy50cmFja0NoYW5nZShldmVudCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLnRyYWNrU3RvcCA9IGZ1bmN0aW9uIChjdXJyZW50RXZlbnQsIGNhY2hlRXZlbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNUcmFja2luZykge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBfZ2V0UGFuQXJncyh0aGlzLmRlbHRhWCwgdGhpcy5kZWx0YVksIHRoaXMudGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5lbmRlZCwgbnVsbCwgY3VycmVudEV2ZW50KTtcbiAgICAgICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5vYnNlcnZlciwgYXJncyk7XG4gICAgICAgICAgICB0aGlzLmRlbHRhWCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuZGVsdGFZID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5pc1RyYWNraW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhY2hlRXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMubGFzdEV2ZW50Q2FjaGUgPSBjdXJyZW50RXZlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RFdmVudENhY2hlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLnRyYWNrU3RhcnQgPSBmdW5jdGlvbiAoY3VycmVudEV2ZW50KSB7XG4gICAgICAgIHZhciBpbml0YWwgPSB0aGlzLmdldEV2ZW50Q29vcmRpbmF0ZXModGhpcy5sYXN0RXZlbnRDYWNoZSA/IHRoaXMubGFzdEV2ZW50Q2FjaGUgOiBjdXJyZW50RXZlbnQpO1xuICAgICAgICB0aGlzLmluaXRpYWxYID0gaW5pdGFsLng7XG4gICAgICAgIHRoaXMuaW5pdGlhbFkgPSBpbml0YWwueTtcbiAgICAgICAgdGhpcy5pc1RyYWNraW5nID0gdHJ1ZTtcbiAgICAgICAgdmFyIGFyZ3MgPSBfZ2V0UGFuQXJncygwLCAwLCB0aGlzLnRhcmdldCwgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuYmVnYW4sIG51bGwsIGN1cnJlbnRFdmVudCk7XG4gICAgICAgIF9leGVjdXRlQ2FsbGJhY2sodGhpcy5vYnNlcnZlciwgYXJncyk7XG4gICAgfTtcbiAgICBDdXN0b21QYW5HZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLnRyYWNrQ2hhbmdlID0gZnVuY3Rpb24gKGN1cnJlbnRFdmVudCkge1xuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuZ2V0RXZlbnRDb29yZGluYXRlcyhjdXJyZW50RXZlbnQpO1xuICAgICAgICB0aGlzLmRlbHRhWCA9IGN1cnJlbnQueCAtIHRoaXMuaW5pdGlhbFg7XG4gICAgICAgIHRoaXMuZGVsdGFZID0gY3VycmVudC55IC0gdGhpcy5pbml0aWFsWTtcbiAgICAgICAgdmFyIGFyZ3MgPSBfZ2V0UGFuQXJncyh0aGlzLmRlbHRhWCwgdGhpcy5kZWx0YVksIHRoaXMudGFyZ2V0LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5jaGFuZ2VkLCBudWxsLCBjdXJyZW50RXZlbnQpO1xuICAgICAgICBfZXhlY3V0ZUNhbGxiYWNrKHRoaXMub2JzZXJ2ZXIsIGFyZ3MpO1xuICAgIH07XG4gICAgQ3VzdG9tUGFuR2VzdHVyZURldGVjdG9yLnByb3RvdHlwZS5nZXRFdmVudENvb3JkaW5hdGVzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBjb3VudCA9IGV2ZW50LmdldFBvaW50ZXJDb3VudCgpO1xuICAgICAgICBpZiAoY291bnQgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgeDogZXZlbnQuZ2V0UmF3WCgpIC8gdGhpcy5kZW5zaXR5LFxuICAgICAgICAgICAgICAgIHk6IGV2ZW50LmdldFJhd1koKSAvIHRoaXMuZGVuc2l0eVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBvZmZYID0gZXZlbnQuZ2V0UmF3WCgpIC0gZXZlbnQuZ2V0WCgpO1xuICAgICAgICAgICAgdmFyIG9mZlkgPSBldmVudC5nZXRSYXdZKCkgLSBldmVudC5nZXRZKCk7XG4gICAgICAgICAgICB2YXIgcmVzID0geyB4OiAwLCB5OiAwIH07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICByZXMueCArPSBldmVudC5nZXRYKGkpICsgb2ZmWDtcbiAgICAgICAgICAgICAgICByZXMueSArPSBldmVudC5nZXRZKGkpICsgb2ZmWTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlcy54IC89IChjb3VudCAqIHRoaXMuZGVuc2l0eSk7XG4gICAgICAgICAgICByZXMueSAvPSAoY291bnQgKiB0aGlzLmRlbnNpdHkpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEN1c3RvbVBhbkdlc3R1cmVEZXRlY3Rvcjtcbn0oKSk7XG52YXIgQ3VzdG9tUm90YXRlR2VzdHVyZURldGVjdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3Iob2JzZXJ2ZXIsIHRhcmdldCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDEgPSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgIHRoaXMudHJhY2tlZFB0cklkMiA9IElOVkFMSURfUE9JTlRFUl9JRDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUsIFwiaXNUcmFja2luZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhY2tlZFB0cklkMSAhPT0gSU5WQUxJRF9QT0lOVEVSX0lEICYmIHRoaXMudHJhY2tlZFB0cklkMiAhPT0gSU5WQUxJRF9QT0lOVEVSX0lEO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLm9uVG91Y2hFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgcG9pbnRlcklEID0gZXZlbnQuZ2V0UG9pbnRlcklkKGV2ZW50LmdldEFjdGlvbkluZGV4KCkpO1xuICAgICAgICB2YXIgd2FzVHJhY2tpbmcgPSB0aGlzLmlzVHJhY2tpbmc7XG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZ2V0QWN0aW9uTWFza2VkKCkpIHtcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9ET1dOOlxuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX1BPSU5URVJfRE9XTjpcbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFja2VkUHRySWQxID09PSBJTlZBTElEX1BPSU5URVJfSUQgJiYgcG9pbnRlcklEICE9PSB0aGlzLnRyYWNrZWRQdHJJZDIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFja2VkUHRySWQxID0gcG9pbnRlcklEO1xuICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMudHJhY2tlZFB0cklkMiA9PT0gSU5WQUxJRF9QT0lOVEVSX0lEICYmIHBvaW50ZXJJRCAhPT0gdGhpcy50cmFja2VkUHRySWQxKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHJhY2tlZFB0cklkMiA9IHBvaW50ZXJJRDtcbiAgICAgICAgICAgICAgICAgICAgYXNzaWduZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWQgJiYgdGhpcy5pc1RyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYW5nbGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRhbFBvaW50ZXJzQW5nbGUgPSB0aGlzLmdldFBvaW50ZXJzQW5nbGUoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhldmVudCwgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuYmVnYW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5kcm9pZC52aWV3Lk1vdGlvbkV2ZW50LkFDVElPTl9NT1ZFOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVHJhY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBbmdsZShldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGV2ZW50LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5jaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fVVA6XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9VUDpcbiAgICAgICAgICAgICAgICBpZiAocG9pbnRlcklEID09PSB0aGlzLnRyYWNrZWRQdHJJZDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFja2VkUHRySWQxID0gSU5WQUxJRF9QT0lOVEVSX0lEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwb2ludGVySUQgPT09IHRoaXMudHJhY2tlZFB0cklkMikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDIgPSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh3YXNUcmFja2luZyAmJiAhdGhpcy5pc1RyYWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGV2ZW50LCBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5lbmRlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX0NBTkNFTDpcbiAgICAgICAgICAgICAgICB0aGlzLnRyYWNrZWRQdHJJZDEgPSBJTlZBTElEX1BPSU5URVJfSUQ7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFja2VkUHRySWQyID0gSU5WQUxJRF9QT0lOVEVSX0lEO1xuICAgICAgICAgICAgICAgIGlmICh3YXNUcmFja2luZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhldmVudCwgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuY2FuY2VsbGVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLmV4ZWN1dGVDYWxsYmFjayA9IGZ1bmN0aW9uIChldmVudCwgc3RhdGUpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICB0eXBlOiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucm90YXRpb24sXG4gICAgICAgICAgICB2aWV3OiB0aGlzLnRhcmdldCxcbiAgICAgICAgICAgIGFuZHJvaWQ6IGV2ZW50LFxuICAgICAgICAgICAgcm90YXRpb246IHRoaXMuYW5nbGUsXG4gICAgICAgICAgICBpb3M6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcy50YXJnZXQsXG4gICAgICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5yb3RhdGlvbiksXG4gICAgICAgICAgICBzdGF0ZTogc3RhdGVcbiAgICAgICAgfTtcbiAgICAgICAgX2V4ZWN1dGVDYWxsYmFjayh0aGlzLm9ic2VydmVyLCBhcmdzKTtcbiAgICB9O1xuICAgIEN1c3RvbVJvdGF0ZUdlc3R1cmVEZXRlY3Rvci5wcm90b3R5cGUudXBkYXRlQW5nbGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIG5ld1BvaW50ZXJzQW5nbGUgPSB0aGlzLmdldFBvaW50ZXJzQW5nbGUoZXZlbnQpO1xuICAgICAgICB2YXIgcmVzdWx0ID0gKChuZXdQb2ludGVyc0FuZ2xlIC0gdGhpcy5pbml0YWxQb2ludGVyc0FuZ2xlKSAqIFRPX0RFR1JFRVMpICUgMzYwO1xuICAgICAgICBpZiAocmVzdWx0IDwgLTE4MCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IDM2MDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0ID4gMTgwKSB7XG4gICAgICAgICAgICByZXN1bHQgLT0gMzYwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5nbGUgPSByZXN1bHQ7XG4gICAgfTtcbiAgICBDdXN0b21Sb3RhdGVHZXN0dXJlRGV0ZWN0b3IucHJvdG90eXBlLmdldFBvaW50ZXJzQW5nbGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGZpcnN0WCA9IGV2ZW50LmdldFgoZXZlbnQuZmluZFBvaW50ZXJJbmRleCh0aGlzLnRyYWNrZWRQdHJJZDEpKTtcbiAgICAgICAgdmFyIGZpcnN0WSA9IGV2ZW50LmdldFkoZXZlbnQuZmluZFBvaW50ZXJJbmRleCh0aGlzLnRyYWNrZWRQdHJJZDEpKTtcbiAgICAgICAgdmFyIHNlY29uZFggPSBldmVudC5nZXRYKGV2ZW50LmZpbmRQb2ludGVySW5kZXgodGhpcy50cmFja2VkUHRySWQyKSk7XG4gICAgICAgIHZhciBzZWNvbmRZID0gZXZlbnQuZ2V0WShldmVudC5maW5kUG9pbnRlckluZGV4KHRoaXMudHJhY2tlZFB0cklkMikpO1xuICAgICAgICByZXR1cm4gTWF0aC5hdGFuMigoc2Vjb25kWSAtIGZpcnN0WSksIChzZWNvbmRYIC0gZmlyc3RYKSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ3VzdG9tUm90YXRlR2VzdHVyZURldGVjdG9yO1xufSgpKTtcbnZhciBQb2ludGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQb2ludGVyKGlkLCBldmVudCkge1xuICAgICAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7XG4gICAgICAgIHRoaXMuaW9zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSBpZDtcbiAgICB9XG4gICAgUG9pbnRlci5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnQuZ2V0WCh0aGlzLmFuZHJvaWQpIC8gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICB9O1xuICAgIFBvaW50ZXIucHJvdG90eXBlLmdldFkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50LmdldFkodGhpcy5hbmRyb2lkKSAvIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfTtcbiAgICByZXR1cm4gUG9pbnRlcjtcbn0oKSk7XG52YXIgVG91Y2hHZXN0dXJlRXZlbnREYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUb3VjaEdlc3R1cmVFdmVudERhdGEoKSB7XG4gICAgICAgIHRoaXMuZXZlbnROYW1lID0gZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoKTtcbiAgICAgICAgdGhpcy50eXBlID0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoO1xuICAgICAgICB0aGlzLmlvcyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5wcmVwYXJlID0gZnVuY3Rpb24gKHZpZXcsIGUpIHtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgdGhpcy5vYmplY3QgPSB2aWV3O1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSBlO1xuICAgICAgICB0aGlzLmFjdGlvbiA9IHRoaXMuZ2V0QWN0aW9uVHlwZShlKTtcbiAgICAgICAgdGhpcy5fYWN0aXZlUG9pbnRlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2FsbFBvaW50ZXJzID0gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRQb2ludGVyQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuZHJvaWQuZ2V0UG9pbnRlckNvdW50KCk7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEFjdGl2ZVBvaW50ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FjdGl2ZVBvaW50ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLl9hY3RpdmVQb2ludGVycyA9IFtuZXcgUG9pbnRlcih0aGlzLmFuZHJvaWQuZ2V0QWN0aW9uSW5kZXgoKSwgdGhpcy5hbmRyb2lkKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGl2ZVBvaW50ZXJzO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRBbGxQb2ludGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9hbGxQb2ludGVycykge1xuICAgICAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5nZXRQb2ludGVyQ291bnQoKTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMucHVzaChuZXcgUG9pbnRlcihpLCB0aGlzLmFuZHJvaWQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWxsUG9pbnRlcnM7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFjdGl2ZVBvaW50ZXJzKClbMF0uZ2V0WCgpO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBY3RpdmVQb2ludGVycygpWzBdLmdldFkoKTtcbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZUV2ZW50RGF0YS5wcm90b3R5cGUuZ2V0QWN0aW9uVHlwZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHN3aXRjaCAoZS5nZXRBY3Rpb25NYXNrZWQoKSkge1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX0RPV046XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9ET1dOOlxuICAgICAgICAgICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi5kb3duO1xuICAgICAgICAgICAgY2FzZSBhbmRyb2lkLnZpZXcuTW90aW9uRXZlbnQuQUNUSU9OX01PVkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLm1vdmU7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fVVA6XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fUE9JTlRFUl9VUDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuVG91Y2hBY3Rpb24udXA7XG4gICAgICAgICAgICBjYXNlIGFuZHJvaWQudmlldy5Nb3Rpb25FdmVudC5BQ1RJT05fQ0FOQ0VMOlxuICAgICAgICAgICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi5jYW5jZWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICByZXR1cm4gVG91Y2hHZXN0dXJlRXZlbnREYXRhO1xufSgpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdlc3R1cmVzLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgSHRtbFZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSHRtbFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEh0bWxWaWV3QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBIdG1sVmlld0Jhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJIdG1sVmlld1wiKVxuICAgIF0sIEh0bWxWaWV3QmFzZSk7XG4gICAgcmV0dXJuIEh0bWxWaWV3QmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuSHRtbFZpZXdCYXNlID0gSHRtbFZpZXdCYXNlO1xuSHRtbFZpZXdCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5odG1sUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJodG1sXCIsIGRlZmF1bHRWYWx1ZTogXCJcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSB9KTtcbmV4cG9ydHMuaHRtbFByb3BlcnR5LnJlZ2lzdGVyKEh0bWxWaWV3QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odG1sLXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaHRtbF92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaHRtbC12aWV3LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2h0bWwtdmlldy1jb21tb25cIikpO1xudmFyIEh0bWxWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSHRtbFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSHRtbFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgSHRtbFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBIdG1sVmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0TGlua3NDbGlja2FibGUodHJ1ZSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0TW92ZW1lbnRNZXRob2QoYW5kcm9pZC50ZXh0Lm1ldGhvZC5MaW5rTW92ZW1lbnRNZXRob2QuZ2V0SW5zdGFuY2UoKSk7XG4gICAgfTtcbiAgICBIdG1sVmlldy5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0QXV0b0xpbmtNYXNrKDApO1xuICAgIH07XG4gICAgSHRtbFZpZXcucHJvdG90eXBlW2h0bWxfdmlld19jb21tb25fMS5odG1sUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgSHRtbFZpZXcucHJvdG90eXBlW2h0bWxfdmlld19jb21tb25fMS5odG1sUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbWFzayA9IDE1O1xuICAgICAgICBpZiAodmFsdWUuc2VhcmNoKC88YVxccy9pKSA+PSAwKSB7XG4gICAgICAgICAgICBtYXNrID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0QXV0b0xpbmtNYXNrKG1hc2spO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dChhbmRyb2lkLnRleHQuSHRtbC5mcm9tSHRtbCh2YWx1ZSkpO1xuICAgIH07XG4gICAgcmV0dXJuIEh0bWxWaWV3O1xufShodG1sX3ZpZXdfY29tbW9uXzEuSHRtbFZpZXdCYXNlKSk7XG5leHBvcnRzLkh0bWxWaWV3ID0gSHRtbFZpZXc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odG1sLXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgaW1hZ2VfYXNzZXRfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1hc3NldFwiKTtcbmV4cG9ydHMuSW1hZ2VBc3NldCA9IGltYWdlX2Fzc2V0XzEuSW1hZ2VBc3NldDtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG5leHBvcnRzLkltYWdlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuSW1hZ2VTb3VyY2U7XG5leHBvcnRzLmZyb21Bc3NldCA9IGltYWdlX3NvdXJjZV8xLmZyb21Bc3NldDtcbmV4cG9ydHMuZnJvbU5hdGl2ZVNvdXJjZSA9IGltYWdlX3NvdXJjZV8xLmZyb21OYXRpdmVTb3VyY2U7XG5leHBvcnRzLmZyb21VcmwgPSBpbWFnZV9zb3VyY2VfMS5mcm9tVXJsO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5leHBvcnRzLmlzRGF0YVVSSSA9IHV0aWxzXzEuaXNEYXRhVVJJO1xuZXhwb3J0cy5pc0ZvbnRJY29uVVJJID0gdXRpbHNfMS5pc0ZvbnRJY29uVVJJO1xuZXhwb3J0cy5pc0ZpbGVPclJlc291cmNlUGF0aCA9IHV0aWxzXzEuaXNGaWxlT3JSZXNvdXJjZVBhdGg7XG5leHBvcnRzLlJFU09VUkNFX1BSRUZJWCA9IHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgSW1hZ2VCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW1hZ2VCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEltYWdlQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VCYXNlLnByb3RvdHlwZSwgXCJ0aW50Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRpbnRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGludENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEltYWdlQmFzZS5wcm90b3R5cGUuX2NyZWF0ZUltYWdlU291cmNlRnJvbVNyYyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgb3JpZ2luYWxWYWx1ZSA9IHZhbHVlO1xuICAgICAgICB2YXIgc3luYyA9IHRoaXMubG9hZE1vZGUgPT09IFwic3luY1wiO1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiIHx8IHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgdGhpc1tcIl91cmxcIl0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VfMSA9IG5ldyBpbWFnZV9zb3VyY2VfMS5JbWFnZVNvdXJjZSgpO1xuICAgICAgICAgICAgdmFyIGltYWdlTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBfdGhpcy5zcmM7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSAhPT0gb3JpZ2luYWxWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLmltYWdlU291cmNlID0gc291cmNlXzE7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHV0aWxzXzEuaXNGb250SWNvblVSSSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9udEljb25Db2RlID0gdmFsdWUuc3BsaXQoXCIvL1wiKVsxXTtcbiAgICAgICAgICAgICAgICBpZiAoZm9udEljb25Db2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbnQgPSB0aGlzLnN0eWxlLmZvbnRJbnRlcm5hbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gdGhpcy5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlXzEubG9hZEZyb21Gb250SWNvbkNvZGUoZm9udEljb25Db2RlLCBmb250LCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIGltYWdlTG9hZGVkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodXRpbHNfMS5pc0RhdGFVUkkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhc2U2NERhdGEgPSB2YWx1ZS5zcGxpdChcIixcIilbMV07XG4gICAgICAgICAgICAgICAgaWYgKGJhc2U2NERhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3luYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEubG9hZEZyb21CYXNlNjQoYmFzZTY0RGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUxvYWRlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEuZnJvbUJhc2U2NChiYXNlNjREYXRhKS50aGVuKGltYWdlTG9hZGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHV0aWxzXzEuaXNGaWxlT3JSZXNvdXJjZVBhdGgodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmluZGV4T2YodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNQYXRoID0gdmFsdWUuc3Vic3RyKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbVJlc291cmNlKHJlc1BhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VMb2FkZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEuZnJvbVJlc291cmNlKHJlc1BhdGgpLnRoZW4oaW1hZ2VMb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3luYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEubG9hZEZyb21GaWxlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlTG9hZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlU291cmNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV8xLmZyb21GaWxlKHZhbHVlKS50aGVuKGltYWdlTG9hZGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIGltYWdlX3NvdXJjZV8xLmZyb21VcmwodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzW1wiX3VybFwiXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmltYWdlU291cmNlID0gcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnIgPT09IFwib2JqZWN0XCIgJiYgZXJyLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBlcnIubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKGVyciwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGltYWdlX3NvdXJjZV8xLkltYWdlU291cmNlKSB7XG4gICAgICAgICAgICB0aGlzLmltYWdlU291cmNlID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgaW1hZ2VfYXNzZXRfMS5JbWFnZUFzc2V0KSB7XG4gICAgICAgICAgICBpbWFnZV9zb3VyY2VfMS5mcm9tQXNzZXQodmFsdWUpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmltYWdlU291cmNlID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmltYWdlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuZnJvbU5hdGl2ZVNvdXJjZSh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZUJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJJbWFnZVwiKVxuICAgIF0sIEltYWdlQmFzZSk7XG4gICAgcmV0dXJuIEltYWdlQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuSW1hZ2VCYXNlID0gSW1hZ2VCYXNlO1xuSW1hZ2VCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5pbWFnZVNvdXJjZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaW1hZ2VTb3VyY2VcIiB9KTtcbmV4cG9ydHMuaW1hZ2VTb3VyY2VQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInNyY1wiIH0pO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy5sb2FkTW9kZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwibG9hZE1vZGVcIiwgZGVmYXVsdFZhbHVlOiBcInN5bmNcIiB9KTtcbmV4cG9ydHMubG9hZE1vZGVQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy5pc0xvYWRpbmdQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlzTG9hZGluZ1wiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlzTG9hZGluZ1Byb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLnN0cmV0Y2hQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInN0cmV0Y2hcIiwgZGVmYXVsdFZhbHVlOiBcImFzcGVjdEZpdFwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MgfSk7XG5leHBvcnRzLnN0cmV0Y2hQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy50aW50Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRpbnRDb2xvclwiLCBjc3NOYW1lOiBcInRpbnQtY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2YWx1ZSk7IH0gfSk7XG5leHBvcnRzLnRpbnRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmRlY29kZUhlaWdodFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZGVjb2RlSGVpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogeyB2YWx1ZTogMCwgdW5pdDogXCJkaXBcIiB9LCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLkxlbmd0aC5wYXJzZSB9KTtcbmV4cG9ydHMuZGVjb2RlSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIoSW1hZ2VCYXNlKTtcbmV4cG9ydHMuZGVjb2RlV2lkdGhQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImRlY29kZVdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogeyB2YWx1ZTogMCwgdW5pdDogXCJkaXBcIiB9LCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLkxlbmd0aC5wYXJzZSB9KTtcbmV4cG9ydHMuZGVjb2RlV2lkdGhQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaW1hZ2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9pbWFnZS1jb21tb25cIik7XG52YXIgZmlsZV9zeXN0ZW1fMSA9IHJlcXVpcmUoXCIuLi8uLi9maWxlLXN5c3RlbVwiKTtcbnZhciBwbGF0Zm9ybSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ltYWdlLWNvbW1vblwiKSk7XG52YXIgRklMRV9QUkVGSVggPSBcImZpbGU6Ly8vXCI7XG52YXIgQVNZTkMgPSBcImFzeW5jXCI7XG52YXIgQW5kcm9pZEltYWdlVmlldztcbnZhciBJbWFnZUxvYWRlZExpc3RlbmVyO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUltYWdlTG9hZGVkTGlzdGVuZXIoKSB7XG4gICAgaWYgKEltYWdlTG9hZGVkTGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEltYWdlTG9hZGVkTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEltYWdlTG9hZGVkTGlzdGVuZXJJbXBsLnByb3RvdHlwZS5vbkltYWdlTG9hZGVkID0gZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBvd25lci5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW29yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5pbWFnZS5Xb3JrZXIuT25JbWFnZUxvYWRlZExpc3RlbmVyXSlcbiAgICAgICAgXSwgSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gSW1hZ2VMb2FkZWRMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgSW1hZ2VMb2FkZWRMaXN0ZW5lciA9IEltYWdlTG9hZGVkTGlzdGVuZXJJbXBsO1xufVxudmFyIEltYWdlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW1hZ2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW1hZ2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy51c2VDYWNoZSA9IHRydWU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgSW1hZ2UucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghQW5kcm9pZEltYWdlVmlldykge1xuICAgICAgICAgICAgQW5kcm9pZEltYWdlVmlldyA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JbWFnZVZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBBbmRyb2lkSW1hZ2VWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGluaXRpYWxpemVJbWFnZUxvYWRlZExpc3RlbmVyKCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbGlzdGVuZXIgPSBuZXcgSW1hZ2VMb2FkZWRMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRJbWFnZUxvYWRlZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubGlzdGVuZXIub3duZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0SW1hZ2VNYXRyaXgobmV3IGFuZHJvaWQuZ3JhcGhpY3MuTWF0cml4KCkpO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLl9jcmVhdGVJbWFnZVNvdXJjZUZyb21TcmMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGltYWdlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFpbWFnZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICBpbWFnZVZpZXcuc2V0VXJpKG51bGwsIDAsIDAsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNjcmVlbiA9IHBsYXRmb3JtLnNjcmVlbi5tYWluU2NyZWVuO1xuICAgICAgICB2YXIgZGVjb2RlV2lkdGggPSBNYXRoLm1pbihpbWFnZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5kZWNvZGVXaWR0aCwgMCksIHNjcmVlbi53aWR0aFBpeGVscyk7XG4gICAgICAgIHZhciBkZWNvZGVIZWlnaHQgPSBNYXRoLm1pbihpbWFnZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5kZWNvZGVIZWlnaHQsIDApLCBzY3JlZW4uaGVpZ2h0UGl4ZWxzKTtcbiAgICAgICAgdmFyIGtlZXBBc3BlY3RSYXRpbyA9IHRoaXMuX2NhbGN1bGF0ZUtlZXBBc3BlY3RSYXRpbygpO1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBpbWFnZV9jb21tb25fMS5JbWFnZUFzc2V0KSB7XG4gICAgICAgICAgICBpZiAodmFsdWUub3B0aW9ucykge1xuICAgICAgICAgICAgICAgIGRlY29kZVdpZHRoID0gdmFsdWUub3B0aW9ucy53aWR0aCB8fCBkZWNvZGVXaWR0aDtcbiAgICAgICAgICAgICAgICBkZWNvZGVIZWlnaHQgPSB2YWx1ZS5vcHRpb25zLmhlaWdodCB8fCBkZWNvZGVIZWlnaHQ7XG4gICAgICAgICAgICAgICAga2VlcEFzcGVjdFJhdGlvID0gISF2YWx1ZS5vcHRpb25zLmtlZXBBc3BlY3RSYXRpbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuYW5kcm9pZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXN5bmMgPSB0aGlzLmxvYWRNb2RlID09PSBBU1lOQztcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZykge1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICBpZiAoaW1hZ2VfY29tbW9uXzEuaXNGb250SWNvblVSSSh2YWx1ZSkgfHwgaW1hZ2VfY29tbW9uXzEuaXNEYXRhVVJJKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2NyZWF0ZUltYWdlU291cmNlRnJvbVNyYy5jYWxsKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGltYWdlX2NvbW1vbl8xLmlzRmlsZU9yUmVzb3VyY2VQYXRoKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5pbmRleE9mKGltYWdlX2NvbW1vbl8xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VWaWV3LnNldFVyaSh2YWx1ZSwgZGVjb2RlV2lkdGgsIGRlY29kZUhlaWdodCwga2VlcEFzcGVjdFJhdGlvLCB0aGlzLnVzZUNhY2hlLCBhc3luYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVOYW1lLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCArIFwiL1wiICsgZmlsZU5hbWUucmVwbGFjZShcIn4vXCIsIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGltYWdlVmlldy5zZXRVcmkoRklMRV9QUkVGSVggKyBmaWxlTmFtZSwgZGVjb2RlV2lkdGgsIGRlY29kZUhlaWdodCwga2VlcEFzcGVjdFJhdGlvLCB0aGlzLnVzZUNhY2hlLCBhc3luYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VWaWV3LnNldFVyaSh2YWx1ZSwgZGVjb2RlV2lkdGgsIGRlY29kZUhlaWdodCwga2VlcEFzcGVjdFJhdGlvLCB0aGlzLnVzZUNhY2hlLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2NyZWF0ZUltYWdlU291cmNlRnJvbVNyYy5jYWxsKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLl9jYWxjdWxhdGVLZWVwQXNwZWN0UmF0aW8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmV0Y2ggPT09IFwiZmlsbFwiID8gZmFsc2UgOiB0cnVlO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLnN0cmV0Y2hQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiYXNwZWN0Rml0XCI7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3RyZXRjaFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImFzcGVjdEZpdFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRTY2FsZVR5cGUoYW5kcm9pZC53aWRnZXQuSW1hZ2VWaWV3LlNjYWxlVHlwZS5GSVRfQ0VOVEVSKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJhc3BlY3RGaWxsXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFNjYWxlVHlwZShhbmRyb2lkLndpZGdldC5JbWFnZVZpZXcuU2NhbGVUeXBlLkNFTlRFUl9DUk9QKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmaWxsXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFNjYWxlVHlwZShhbmRyb2lkLndpZGdldC5JbWFnZVZpZXcuU2NhbGVUeXBlLkZJVF9YWSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U2NhbGVUeXBlKGFuZHJvaWQud2lkZ2V0LkltYWdlVmlldy5TY2FsZVR5cGUuTUFUUklYKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLnRpbnRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLnRpbnRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jbGVhckNvbG9yRmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZVtpbWFnZV9jb21tb25fMS5pbWFnZVNvdXJjZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLmltYWdlU291cmNlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLmFuZHJvaWQpIHtcbiAgICAgICAgICAgIHZhciByb3RhdGlvbiA9IHZhbHVlLnJvdGF0aW9uQW5nbGUgPyB2YWx1ZS5yb3RhdGlvbkFuZ2xlIDogMDtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0Um90YXRpb25BbmdsZShyb3RhdGlvbik7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldEltYWdlQml0bWFwKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRSb3RhdGlvbkFuZ2xlKDApO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRJbWFnZUJpdG1hcChudWxsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLnNyY1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlW2ltYWdlX2NvbW1vbl8xLnNyY1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlSW1hZ2VTb3VyY2VGcm9tU3JjKHZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBJbWFnZTtcbn0oaW1hZ2VfY29tbW9uXzEuSW1hZ2VCYXNlKSk7XG5leHBvcnRzLkltYWdlID0gSW1hZ2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIikpO1xudmFyIFRleHRWaWV3O1xudmFyIExhYmVsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGFiZWwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGFiZWwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExhYmVsLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9PT0gXCJub3JtYWxcIjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWUgPyBcIm5vcm1hbFwiIDogXCJub3dyYXBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGFiZWwucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghVGV4dFZpZXcpIHtcbiAgICAgICAgICAgIFRleHRWaWV3ID0gYW5kcm9pZC53aWRnZXQuVGV4dFZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0Vmlldyh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgdGV4dFZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0ZXh0Vmlldy5zZXRTaW5nbGVMaW5lKHRydWUpO1xuICAgICAgICB0ZXh0Vmlldy5zZXRFbGxpcHNpemUoYW5kcm9pZC50ZXh0LlRleHRVdGlscy5UcnVuY2F0ZUF0LkVORCk7XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGVbdGV4dF9iYXNlXzEud2hpdGVTcGFjZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdmFsdWUgPT09IFwiaW5pdGlhbFwiID8gXCJub3dyYXBcIiA6IHZhbHVlO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlW3RleHRfYmFzZV8xLndoaXRlU3BhY2VQcm9wZXJ0eS5zZXROYXRpdmVdLmNhbGwodGhpcywgbmV3VmFsdWUpO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBMYWJlbC5wcm90b3R5cGUsIFwiY3JlYXRlTmF0aXZlVmlld1wiLCBudWxsKTtcbiAgICBMYWJlbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB0ZXh0X2Jhc2VfMS5DU1NUeXBlKFwiTGFiZWxcIilcbiAgICBdLCBMYWJlbCk7XG4gICAgcmV0dXJuIExhYmVsO1xufSh0ZXh0X2Jhc2VfMS5UZXh0QmFzZSkpO1xuZXhwb3J0cy5MYWJlbCA9IExhYmVsO1xuTGFiZWwucHJvdG90eXBlLl9pc1NpbmdsZUxpbmUgPSB0cnVlO1xuTGFiZWwucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sYWJlbC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLmVmZmVjdGl2ZUxlZnQgPSAwO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5lZmZlY3RpdmVUb3AgPSAwO1xuZnVuY3Rpb24gdmFsaWRhdGVBcmdzKGVsZW1lbnQpIHtcbiAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZWxlbWVudCBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluaWVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59XG52YXIgQWJzb2x1dGVMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWJzb2x1dGVMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFic29sdXRlTGF5b3V0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBYnNvbHV0ZUxheW91dEJhc2UuZ2V0TGVmdCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkubGVmdDtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZS5zZXRMZWZ0ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS5sZWZ0ID0gdmFsdWU7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2UuZ2V0VG9wID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS50b3A7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2Uuc2V0VG9wID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS50b3AgPSB2YWx1ZTtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZS5wcm90b3R5cGUub25MZWZ0Q2hhbmdlZCA9IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZS5wcm90b3R5cGUub25Ub3BDaGFuZ2VkID0gZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIkFic29sdXRlTGF5b3V0XCIpXG4gICAgXSwgQWJzb2x1dGVMYXlvdXRCYXNlKTtcbiAgICByZXR1cm4gQWJzb2x1dGVMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuQWJzb2x1dGVMYXlvdXRCYXNlID0gQWJzb2x1dGVMYXlvdXRCYXNlO1xuQWJzb2x1dGVMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5sZWZ0UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJsZWZ0XCIsIGRlZmF1bHRWYWx1ZTogbGF5b3V0X2Jhc2VfMS56ZXJvTGVuZ3RoLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5lZmZlY3RpdmVMZWZ0ID0gbGF5b3V0X2Jhc2VfMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB2YXIgbGF5b3V0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGxheW91dCBpbnN0YW5jZW9mIEFic29sdXRlTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgbGF5b3V0Lm9uTGVmdENoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBsYXlvdXRfYmFzZV8xLkxlbmd0aC5wYXJzZSh2KTsgfVxufSk7XG5leHBvcnRzLmxlZnRQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlZpZXcpO1xuZXhwb3J0cy50b3BQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRvcFwiLCBkZWZhdWx0VmFsdWU6IGxheW91dF9iYXNlXzEuemVyb0xlbmd0aCxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQuZWZmZWN0aXZlVG9wID0gbGF5b3V0X2Jhc2VfMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB2YXIgbGF5b3V0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGxheW91dCBpbnN0YW5jZW9mIEFic29sdXRlTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgbGF5b3V0Lm9uVG9wQ2hhbmdlZCh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIGxheW91dF9iYXNlXzEuTGVuZ3RoLnBhcnNlKHYpOyB9XG59KTtcbmV4cG9ydHMudG9wUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFic29sdXRlLWxheW91dC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9hYnNvbHV0ZS1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYWJzb2x1dGUtbGF5b3V0LWNvbW1vblwiKSk7XG5mdW5jdGlvbiBtYWtlTmF0aXZlU2V0dGVyKHNldHRlcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCkgfHwgbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgaWYgKGxwIGluc3RhbmNlb2Ygb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcykge1xuICAgICAgICAgICAgc2V0dGVyLmNhbGwodGhpcywgbHAsIHZhbHVlKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5hYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLnRvcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgbHAudG9wID0gYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCk7IH0pO1xuYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2Fic29sdXRlX2xheW91dF9jb21tb25fMS5sZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IG1ha2VOYXRpdmVTZXR0ZXIoZnVuY3Rpb24gKGxwLCB2YWx1ZSkgeyBscC5sZWZ0ID0gYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCk7IH0pO1xudmFyIEFic29sdXRlTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWJzb2x1dGVMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWJzb2x1dGVMYXlvdXQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWJzb2x1dGVMYXlvdXQucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkFic29sdXRlTGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgcmV0dXJuIEFic29sdXRlTGF5b3V0O1xufShhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuQWJzb2x1dGVMYXlvdXRCYXNlKSk7XG5leHBvcnRzLkFic29sdXRlTGF5b3V0ID0gQWJzb2x1dGVMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hYnNvbHV0ZS1sYXlvdXQuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIik7XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkge1xuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJlbGVtZW50IGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5pZWQuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn1cbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG52YXIgRG9ja0xheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEb2NrTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBEb2NrTGF5b3V0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBEb2NrTGF5b3V0QmFzZS5nZXREb2NrID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5kb2NrO1xuICAgIH07XG4gICAgRG9ja0xheW91dEJhc2Uuc2V0RG9jayA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuZG9jayA9IHZhbHVlO1xuICAgIH07XG4gICAgRG9ja0xheW91dEJhc2UucHJvdG90eXBlLm9uRG9ja0NoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJEb2NrTGF5b3V0XCIpXG4gICAgXSwgRG9ja0xheW91dEJhc2UpO1xuICAgIHJldHVybiBEb2NrTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLkRvY2tMYXlvdXRCYXNlID0gRG9ja0xheW91dEJhc2U7XG5Eb2NrTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbnZhciBkb2NrQ29udmVydGVyID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImxlZnRcIiwgXCJ0b3BcIiwgXCJyaWdodFwiLCBcImJvdHRvbVwiKSk7XG5leHBvcnRzLmRvY2tQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRvY2tcIiwgZGVmYXVsdFZhbHVlOiBcImxlZnRcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuVmlldykge1xuICAgICAgICAgICAgdmFyIGxheW91dCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAobGF5b3V0IGluc3RhbmNlb2YgRG9ja0xheW91dEJhc2UpIHtcbiAgICAgICAgICAgICAgICBsYXlvdXQub25Eb2NrQ2hhbmdlZCh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZG9ja0NvbnZlcnRlclxufSk7XG5leHBvcnRzLmRvY2tQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlZpZXcpO1xuZXhwb3J0cy5zdHJldGNoTGFzdENoaWxkUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzdHJldGNoTGFzdENoaWxkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGxheW91dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlclxufSk7XG5leHBvcnRzLnN0cmV0Y2hMYXN0Q2hpbGRQcm9wZXJ0eS5yZWdpc3RlcihEb2NrTGF5b3V0QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kb2NrLWxheW91dC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkb2NrX2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2RvY2stbGF5b3V0LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2RvY2stbGF5b3V0LWNvbW1vblwiKSk7XG5kb2NrX2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtkb2NrX2xheW91dF9jb21tb25fMS5kb2NrUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCkgfHwgbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Db21tb25MYXlvdXRQYXJhbXMoKTtcbiAgICBpZiAobHAgaW5zdGFuY2VvZiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKSB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgbHAuZG9jayA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Eb2NrLmxlZnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgbHAuZG9jayA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Eb2NrLnRvcDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIGxwLmRvY2sgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuRG9jay5yaWdodDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgICAgICBscC5kb2NrID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkRvY2suYm90dG9tO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlIGZvciBkb2NrIHByb3BlcnR5OiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LnNldExheW91dFBhcmFtcyhscCk7XG4gICAgfVxufTtcbnZhciBEb2NrTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRG9ja0xheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBEb2NrTGF5b3V0KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIERvY2tMYXlvdXQucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkRvY2tMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0LnByb3RvdHlwZVtkb2NrX2xheW91dF9jb21tb25fMS5zdHJldGNoTGFzdENoaWxkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgRG9ja0xheW91dC5wcm90b3R5cGVbZG9ja19sYXlvdXRfY29tbW9uXzEuc3RyZXRjaExhc3RDaGlsZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFN0cmV0Y2hMYXN0Q2hpbGQodmFsdWUpO1xuICAgIH07XG4gICAgcmV0dXJuIERvY2tMYXlvdXQ7XG59KGRvY2tfbGF5b3V0X2NvbW1vbl8xLkRvY2tMYXlvdXRCYXNlKSk7XG5leHBvcnRzLkRvY2tMYXlvdXQgPSBEb2NrTGF5b3V0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZG9jay1sYXlvdXQuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIikpO1xuZXhwb3J0cy5PUkRFUl9ERUZBVUxUID0gMTtcbmV4cG9ydHMuRkxFWF9HUk9XX0RFRkFVTFQgPSAwLjA7XG5leHBvcnRzLkZMRVhfU0hSSU5LX0RFRkFVTFQgPSAxLjA7XG52YXIgRmxleERpcmVjdGlvbjtcbihmdW5jdGlvbiAoRmxleERpcmVjdGlvbikge1xuICAgIEZsZXhEaXJlY3Rpb24uUk9XID0gXCJyb3dcIjtcbiAgICBGbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFID0gXCJyb3ctcmV2ZXJzZVwiO1xuICAgIEZsZXhEaXJlY3Rpb24uQ09MVU1OID0gXCJjb2x1bW5cIjtcbiAgICBGbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFID0gXCJjb2x1bW4tcmV2ZXJzZVwiO1xuICAgIEZsZXhEaXJlY3Rpb24uaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihGbGV4RGlyZWN0aW9uLlJPVywgRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRSwgRmxleERpcmVjdGlvbi5DT0xVTU4sIEZsZXhEaXJlY3Rpb24uQ09MVU1OX1JFVkVSU0UpO1xuICAgIEZsZXhEaXJlY3Rpb24ucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoRmxleERpcmVjdGlvbi5pc1ZhbGlkKTtcbn0pKEZsZXhEaXJlY3Rpb24gPSBleHBvcnRzLkZsZXhEaXJlY3Rpb24gfHwgKGV4cG9ydHMuRmxleERpcmVjdGlvbiA9IHt9KSk7XG52YXIgRmxleFdyYXA7XG4oZnVuY3Rpb24gKEZsZXhXcmFwKSB7XG4gICAgRmxleFdyYXAuTk9XUkFQID0gXCJub3dyYXBcIjtcbiAgICBGbGV4V3JhcC5XUkFQID0gXCJ3cmFwXCI7XG4gICAgRmxleFdyYXAuV1JBUF9SRVZFUlNFID0gXCJ3cmFwLXJldmVyc2VcIjtcbiAgICBGbGV4V3JhcC5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEZsZXhXcmFwLk5PV1JBUCwgRmxleFdyYXAuV1JBUCwgRmxleFdyYXAuV1JBUF9SRVZFUlNFKTtcbiAgICBGbGV4V3JhcC5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihGbGV4V3JhcC5pc1ZhbGlkKTtcbn0pKEZsZXhXcmFwID0gZXhwb3J0cy5GbGV4V3JhcCB8fCAoZXhwb3J0cy5GbGV4V3JhcCA9IHt9KSk7XG52YXIgSnVzdGlmeUNvbnRlbnQ7XG4oZnVuY3Rpb24gKEp1c3RpZnlDb250ZW50KSB7XG4gICAgSnVzdGlmeUNvbnRlbnQuRkxFWF9TVEFSVCA9IFwiZmxleC1zdGFydFwiO1xuICAgIEp1c3RpZnlDb250ZW50LkZMRVhfRU5EID0gXCJmbGV4LWVuZFwiO1xuICAgIEp1c3RpZnlDb250ZW50LkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQkVUV0VFTiA9IFwic3BhY2UtYmV0d2VlblwiO1xuICAgIEp1c3RpZnlDb250ZW50LlNQQUNFX0FST1VORCA9IFwic3BhY2UtYXJvdW5kXCI7XG4gICAgSnVzdGlmeUNvbnRlbnQuaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihKdXN0aWZ5Q29udGVudC5GTEVYX1NUQVJULCBKdXN0aWZ5Q29udGVudC5GTEVYX0VORCwgSnVzdGlmeUNvbnRlbnQuQ0VOVEVSLCBKdXN0aWZ5Q29udGVudC5TUEFDRV9CRVRXRUVOLCBKdXN0aWZ5Q29udGVudC5TUEFDRV9BUk9VTkQpO1xuICAgIEp1c3RpZnlDb250ZW50LnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEp1c3RpZnlDb250ZW50LmlzVmFsaWQpO1xufSkoSnVzdGlmeUNvbnRlbnQgPSBleHBvcnRzLkp1c3RpZnlDb250ZW50IHx8IChleHBvcnRzLkp1c3RpZnlDb250ZW50ID0ge30pKTtcbnZhciBGbGV4QmFzaXNQZXJjZW50O1xuKGZ1bmN0aW9uIChGbGV4QmFzaXNQZXJjZW50KSB7XG4gICAgRmxleEJhc2lzUGVyY2VudC5ERUZBVUxUID0gLTE7XG59KShGbGV4QmFzaXNQZXJjZW50ID0gZXhwb3J0cy5GbGV4QmFzaXNQZXJjZW50IHx8IChleHBvcnRzLkZsZXhCYXNpc1BlcmNlbnQgPSB7fSkpO1xudmFyIEFsaWduSXRlbXM7XG4oZnVuY3Rpb24gKEFsaWduSXRlbXMpIHtcbiAgICBBbGlnbkl0ZW1zLkZMRVhfU1RBUlQgPSBcImZsZXgtc3RhcnRcIjtcbiAgICBBbGlnbkl0ZW1zLkZMRVhfRU5EID0gXCJmbGV4LWVuZFwiO1xuICAgIEFsaWduSXRlbXMuQ0VOVEVSID0gXCJjZW50ZXJcIjtcbiAgICBBbGlnbkl0ZW1zLkJBU0VMSU5FID0gXCJiYXNlbGluZVwiO1xuICAgIEFsaWduSXRlbXMuU1RSRVRDSCA9IFwic3RyZXRjaFwiO1xuICAgIEFsaWduSXRlbXMuaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihBbGlnbkl0ZW1zLkZMRVhfU1RBUlQsIEFsaWduSXRlbXMuRkxFWF9FTkQsIEFsaWduSXRlbXMuQ0VOVEVSLCBBbGlnbkl0ZW1zLkJBU0VMSU5FLCBBbGlnbkl0ZW1zLlNUUkVUQ0gpO1xuICAgIEFsaWduSXRlbXMucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoQWxpZ25JdGVtcy5pc1ZhbGlkKTtcbn0pKEFsaWduSXRlbXMgPSBleHBvcnRzLkFsaWduSXRlbXMgfHwgKGV4cG9ydHMuQWxpZ25JdGVtcyA9IHt9KSk7XG52YXIgQWxpZ25Db250ZW50O1xuKGZ1bmN0aW9uIChBbGlnbkNvbnRlbnQpIHtcbiAgICBBbGlnbkNvbnRlbnQuRkxFWF9TVEFSVCA9IFwiZmxleC1zdGFydFwiO1xuICAgIEFsaWduQ29udGVudC5GTEVYX0VORCA9IFwiZmxleC1lbmRcIjtcbiAgICBBbGlnbkNvbnRlbnQuQ0VOVEVSID0gXCJjZW50ZXJcIjtcbiAgICBBbGlnbkNvbnRlbnQuU1BBQ0VfQkVUV0VFTiA9IFwic3BhY2UtYmV0d2VlblwiO1xuICAgIEFsaWduQ29udGVudC5TUEFDRV9BUk9VTkQgPSBcInNwYWNlLWFyb3VuZFwiO1xuICAgIEFsaWduQ29udGVudC5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgQWxpZ25Db250ZW50LmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoQWxpZ25Db250ZW50LkZMRVhfU1RBUlQsIEFsaWduQ29udGVudC5GTEVYX0VORCwgQWxpZ25Db250ZW50LkNFTlRFUiwgQWxpZ25Db250ZW50LlNQQUNFX0JFVFdFRU4sIEFsaWduQ29udGVudC5TUEFDRV9BUk9VTkQsIEFsaWduQ29udGVudC5TVFJFVENIKTtcbiAgICBBbGlnbkNvbnRlbnQucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoQWxpZ25Db250ZW50LmlzVmFsaWQpO1xufSkoQWxpZ25Db250ZW50ID0gZXhwb3J0cy5BbGlnbkNvbnRlbnQgfHwgKGV4cG9ydHMuQWxpZ25Db250ZW50ID0ge30pKTtcbnZhciBPcmRlcjtcbihmdW5jdGlvbiAoT3JkZXIpIHtcbiAgICBmdW5jdGlvbiBpc1ZhbGlkKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpc0Zpbml0ZShwYXJzZUludCh2YWx1ZSkpO1xuICAgIH1cbiAgICBPcmRlci5pc1ZhbGlkID0gaXNWYWxpZDtcbiAgICBPcmRlci5wYXJzZSA9IHBhcnNlSW50O1xufSkoT3JkZXIgPSBleHBvcnRzLk9yZGVyIHx8IChleHBvcnRzLk9yZGVyID0ge30pKTtcbnZhciBGbGV4R3JvdztcbihmdW5jdGlvbiAoRmxleEdyb3cpIHtcbiAgICBmdW5jdGlvbiBpc1ZhbGlkKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJzZWQgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBpc0Zpbml0ZShwYXJzZWQpICYmIHZhbHVlID49IDA7XG4gICAgfVxuICAgIEZsZXhHcm93LmlzVmFsaWQgPSBpc1ZhbGlkO1xuICAgIEZsZXhHcm93LnBhcnNlID0gcGFyc2VGbG9hdDtcbn0pKEZsZXhHcm93ID0gZXhwb3J0cy5GbGV4R3JvdyB8fCAoZXhwb3J0cy5GbGV4R3JvdyA9IHt9KSk7XG52YXIgRmxleFNocmluaztcbihmdW5jdGlvbiAoRmxleFNocmluaykge1xuICAgIGZ1bmN0aW9uIGlzVmFsaWQodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcnNlZCA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIGlzRmluaXRlKHBhcnNlZCkgJiYgdmFsdWUgPj0gMDtcbiAgICB9XG4gICAgRmxleFNocmluay5pc1ZhbGlkID0gaXNWYWxpZDtcbiAgICBGbGV4U2hyaW5rLnBhcnNlID0gcGFyc2VGbG9hdDtcbn0pKEZsZXhTaHJpbmsgPSBleHBvcnRzLkZsZXhTaHJpbmsgfHwgKGV4cG9ydHMuRmxleFNocmluayA9IHt9KSk7XG52YXIgRmxleFdyYXBCZWZvcmU7XG4oZnVuY3Rpb24gKEZsZXhXcmFwQmVmb3JlKSB7XG4gICAgZnVuY3Rpb24gaXNWYWxpZCh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIHN0ciA9IHZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHN0ciA9PT0gXCJ0cnVlXCIgfHwgc3RyID09PSBcImZhbHNlXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBGbGV4V3JhcEJlZm9yZS5pc1ZhbGlkID0gaXNWYWxpZDtcbiAgICBmdW5jdGlvbiBwYXJzZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgJiYgdmFsdWUudG9TdHJpbmcoKS50cmltKCkudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCI7XG4gICAgfVxuICAgIEZsZXhXcmFwQmVmb3JlLnBhcnNlID0gcGFyc2U7XG59KShGbGV4V3JhcEJlZm9yZSA9IGV4cG9ydHMuRmxleFdyYXBCZWZvcmUgfHwgKGV4cG9ydHMuRmxleFdyYXBCZWZvcmUgPSB7fSkpO1xudmFyIEFsaWduU2VsZjtcbihmdW5jdGlvbiAoQWxpZ25TZWxmKSB7XG4gICAgQWxpZ25TZWxmLkFVVE8gPSBcImF1dG9cIjtcbiAgICBBbGlnblNlbGYuRkxFWF9TVEFSVCA9IFwiZmxleC1zdGFydFwiO1xuICAgIEFsaWduU2VsZi5GTEVYX0VORCA9IFwiZmxleC1lbmRcIjtcbiAgICBBbGlnblNlbGYuQ0VOVEVSID0gXCJjZW50ZXJcIjtcbiAgICBBbGlnblNlbGYuQkFTRUxJTkUgPSBcImJhc2VsaW5lXCI7XG4gICAgQWxpZ25TZWxmLlNUUkVUQ0ggPSBcInN0cmV0Y2hcIjtcbiAgICBBbGlnblNlbGYuaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihBbGlnblNlbGYuQVVUTywgQWxpZ25TZWxmLkZMRVhfU1RBUlQsIEFsaWduU2VsZi5GTEVYX0VORCwgQWxpZ25TZWxmLkNFTlRFUiwgQWxpZ25TZWxmLkJBU0VMSU5FLCBBbGlnblNlbGYuU1RSRVRDSCk7XG4gICAgQWxpZ25TZWxmLnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEFsaWduU2VsZi5pc1ZhbGlkKTtcbn0pKEFsaWduU2VsZiA9IGV4cG9ydHMuQWxpZ25TZWxmIHx8IChleHBvcnRzLkFsaWduU2VsZiA9IHt9KSk7XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkge1xuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJlbGVtZW50IGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5pZWQuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn1cbnZhciBGbGV4Ym94TGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZsZXhib3hMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZsZXhib3hMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiZmxleERpcmVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZmxleERpcmVjdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZmxleERpcmVjdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLCBcImZsZXhXcmFwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mbGV4V3JhcDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZmxleFdyYXAgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJqdXN0aWZ5Q29udGVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuanVzdGlmeUNvbnRlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiYWxpZ25JdGVtc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYWxpZ25JdGVtcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYWxpZ25JdGVtcyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLCBcImFsaWduQ29udGVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYWxpZ25Db250ZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbGlnbkNvbnRlbnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRmxleGJveExheW91dEJhc2Uuc2V0T3JkZXIgPSBmdW5jdGlvbiAodmlldywgb3JkZXIpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLm9yZGVyID0gb3JkZXI7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5nZXRPcmRlciA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUub3JkZXI7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5zZXRGbGV4R3JvdyA9IGZ1bmN0aW9uICh2aWV3LCBncm93KSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4R3JvdyA9IGdyb3c7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5nZXRGbGV4R3JvdyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleEdyb3c7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5zZXRGbGV4U2hyaW5rID0gZnVuY3Rpb24gKHZpZXcsIHNocmluaykge1xuICAgICAgICB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleFNocmluayA9IHNocmluaztcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLmdldEZsZXhTaHJpbmsgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhTaHJpbms7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5zZXRBbGlnblNlbGYgPSBmdW5jdGlvbiAodmlldywgYWxpZ24pIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmFsaWduU2VsZiA9IGFsaWduO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UuZ2V0QWxpZ25TZWxmID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5hbGlnblNlbGY7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5zZXRGbGV4V3JhcEJlZm9yZSA9IGZ1bmN0aW9uICh2aWV3LCB3cmFwKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4V3JhcEJlZm9yZSA9IHdyYXA7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5nZXRGbGV4V3JhcEJlZm9yZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleFdyYXBCZWZvcmU7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJGbGV4Ym94TGF5b3V0XCIpXG4gICAgXSwgRmxleGJveExheW91dEJhc2UpO1xuICAgIHJldHVybiBGbGV4Ym94TGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLkZsZXhib3hMYXlvdXRCYXNlID0gRmxleGJveExheW91dEJhc2U7XG5GbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuZmxleERpcmVjdGlvblByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZsZXhEaXJlY3Rpb25cIiwgY3NzTmFtZTogXCJmbGV4LWRpcmVjdGlvblwiLCBkZWZhdWx0VmFsdWU6IEZsZXhEaXJlY3Rpb24uUk9XLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogRmxleERpcmVjdGlvbi5wYXJzZSB9KTtcbmV4cG9ydHMuZmxleERpcmVjdGlvblByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuZXhwb3J0cy5mbGV4V3JhcFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZsZXhXcmFwXCIsIGNzc05hbWU6IFwiZmxleC13cmFwXCIsIGRlZmF1bHRWYWx1ZTogXCJub3dyYXBcIiwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IEZsZXhXcmFwLnBhcnNlIH0pO1xuZXhwb3J0cy5mbGV4V3JhcFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuZXhwb3J0cy5qdXN0aWZ5Q29udGVudFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImp1c3RpZnlDb250ZW50XCIsIGNzc05hbWU6IFwianVzdGlmeS1jb250ZW50XCIsIGRlZmF1bHRWYWx1ZTogSnVzdGlmeUNvbnRlbnQuRkxFWF9TVEFSVCwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IEp1c3RpZnlDb250ZW50LnBhcnNlIH0pO1xuZXhwb3J0cy5qdXN0aWZ5Q29udGVudFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuZXhwb3J0cy5hbGlnbkl0ZW1zUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYWxpZ25JdGVtc1wiLCBjc3NOYW1lOiBcImFsaWduLWl0ZW1zXCIsIGRlZmF1bHRWYWx1ZTogQWxpZ25JdGVtcy5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogQWxpZ25JdGVtcy5wYXJzZSB9KTtcbmV4cG9ydHMuYWxpZ25JdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuZXhwb3J0cy5hbGlnbkNvbnRlbnRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbGlnbkNvbnRlbnRcIiwgY3NzTmFtZTogXCJhbGlnbi1jb250ZW50XCIsIGRlZmF1bHRWYWx1ZTogQWxpZ25Db250ZW50LlNUUkVUQ0gsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBBbGlnbkNvbnRlbnQucGFyc2UgfSk7XG5leHBvcnRzLmFsaWduQ29udGVudFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuZXhwb3J0cy5vcmRlclByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm9yZGVyXCIsIGNzc05hbWU6IFwib3JkZXJcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLk9SREVSX0RFRkFVTFQsIHZhbHVlQ29udmVydGVyOiBPcmRlci5wYXJzZSB9KTtcbmV4cG9ydHMub3JkZXJQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcIm9yZGVyXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUub3JkZXI7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0eWxlLm9yZGVyID0gdmFsdWU7XG4gICAgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5leHBvcnRzLmZsZXhHcm93UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZmxleEdyb3dcIiwgY3NzTmFtZTogXCJmbGV4LWdyb3dcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLkZMRVhfR1JPV19ERUZBVUxULCB2YWx1ZUNvbnZlcnRlcjogRmxleEdyb3cucGFyc2UgfSk7XG5leHBvcnRzLmZsZXhHcm93UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJmbGV4R3Jvd1wiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZsZXhHcm93O1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdHlsZS5mbGV4R3JvdyA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbn0pO1xuZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZmxleFNocmlua1wiLCBjc3NOYW1lOiBcImZsZXgtc2hyaW5rXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy5GTEVYX1NIUklOS19ERUZBVUxULCB2YWx1ZUNvbnZlcnRlcjogRmxleFNocmluay5wYXJzZSB9KTtcbmV4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUsIFwiZmxleFNocmlua1wiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZsZXhTaHJpbms7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0eWxlLmZsZXhTaHJpbmsgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbmV4cG9ydHMuZmxleFdyYXBCZWZvcmVQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJmbGV4V3JhcEJlZm9yZVwiLCBjc3NOYW1lOiBcImZsZXgtd3JhcC1iZWZvcmVcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IEZsZXhXcmFwQmVmb3JlLnBhcnNlIH0pO1xuZXhwb3J0cy5mbGV4V3JhcEJlZm9yZVByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUsIFwiZmxleFdyYXBCZWZvcmVcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mbGV4V3JhcEJlZm9yZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUuZmxleFdyYXBCZWZvcmUgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbmV4cG9ydHMuYWxpZ25TZWxmUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYWxpZ25TZWxmXCIsIGNzc05hbWU6IFwiYWxpZ24tc2VsZlwiLCBkZWZhdWx0VmFsdWU6IEFsaWduU2VsZi5BVVRPLCB2YWx1ZUNvbnZlcnRlcjogQWxpZ25TZWxmLnBhcnNlIH0pO1xuZXhwb3J0cy5hbGlnblNlbGZQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImFsaWduU2VsZlwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFsaWduU2VsZjtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUuYWxpZ25TZWxmID0gdmFsdWU7XG4gICAgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG52YXIgZmxleEZsb3dQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImZsZXhGbG93XCIsIGNzc05hbWU6IFwiZmxleC1mbG93XCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZsZXhEaXJlY3Rpb24gKyBcIiBcIiArIHRoaXMuZmxleFdyYXA7XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IFtdO1xuICAgICAgICBpZiAodmFsdWUgPT09IGxheW91dF9iYXNlXzEudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eSwgdmFsdWVdKTtcbiAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4V3JhcFByb3BlcnR5LCB2YWx1ZV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRyaW1tZWQgPSB2YWx1ZSAmJiB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAodHJpbW1lZCkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0cmltbWVkLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPj0gMSAmJiBGbGV4RGlyZWN0aW9uLmlzVmFsaWQodmFsdWVzWzBdKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleERpcmVjdGlvblByb3BlcnR5LCBGbGV4RGlyZWN0aW9uLnBhcnNlKHZhbHVlc1swXSldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+PSAyICYmIEZsZXhXcmFwLmlzVmFsaWQodmFsdWVzWzFdKSkge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFdyYXBQcm9wZXJ0eSwgRmxleFdyYXAucGFyc2UodmFsdWVzWzFdKV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcGVydGllcztcbiAgICB9XG59KTtcbmZsZXhGbG93UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG52YXIgZmxleFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZmxleFwiLCBjc3NOYW1lOiBcImZsZXhcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmxleEdyb3cgKyBcIiBcIiArIHRoaXMuZmxleFNocmluaztcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0gW107XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbGF5b3V0X2Jhc2VfMS51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgdmFsdWVdKTtcbiAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIHZhbHVlXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdHJpbW1lZCA9IHZhbHVlICYmIHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGlmICh0cmltbWVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHRyaW1tZWQuc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHZhbHVlc1swXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImluaXRhbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCAwXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImF1dG9cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIDBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCAwXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChGbGV4R3Jvdy5pc1ZhbGlkKHZhbHVlc1swXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIEZsZXhHcm93LnBhcnNlKHZhbHVlc1swXSldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA+PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChGbGV4R3Jvdy5pc1ZhbGlkKHZhbHVlc1swXSkgJiYgRmxleFNocmluay5pc1ZhbGlkKHZhbHVlc1sxXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCBGbGV4R3Jvdy5wYXJzZSh2YWx1ZXNbMF0pXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCBGbGV4U2hyaW5rLnBhcnNlKHZhbHVlc1sxXSldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcGVydGllcztcbiAgICB9XG59KTtcbmZsZXhQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZsZXhib3gtbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxudmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZmxleGJveF9sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9mbGV4Ym94LWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9mbGV4Ym94LWxheW91dC1jb21tb25cIikpO1xudmFyIHdpZGdldEZsZXhib3hMYXlvdXQ7XG52YXIgd2lkZ2V0TGF5b3V0UGFyYW1zO1xuZnVuY3Rpb24gbWFrZU5hdGl2ZVNldHRlcihzZXR0ZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbHAgPSBuYXRpdmVWaWV3LmdldExheW91dFBhcmFtcygpIHx8IG5ldyB3aWRnZXRMYXlvdXRQYXJhbXMoKTtcbiAgICAgICAgaWYgKGxwIGluc3RhbmNlb2Ygd2lkZ2V0TGF5b3V0UGFyYW1zKSB7XG4gICAgICAgICAgICBzZXR0ZXIobHAsIHZhbHVlKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5vcmRlclByb3BlcnR5LnNldE5hdGl2ZV0gPSBtYWtlTmF0aXZlU2V0dGVyKGZ1bmN0aW9uIChscCwgdmFsdWUpIHsgcmV0dXJuIGxwLm9yZGVyID0gdmFsdWU7IH0pO1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleEdyb3dQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5mbGV4R3JvdyA9IHZhbHVlOyB9KTtcbmZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhTaHJpbmtQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5mbGV4U2hyaW5rID0gdmFsdWU7IH0pO1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFdyYXBCZWZvcmVQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC53cmFwQmVmb3JlID0gdmFsdWU7IH0pO1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25TZWxmUHJvcGVydHkuc2V0TmF0aXZlXSA9IG1ha2VOYXRpdmVTZXR0ZXIoZnVuY3Rpb24gKGxwLCB2YWx1ZSkgeyByZXR1cm4gbHAuYWxpZ25TZWxmID0gYWxpZ25TZWxmTWFwW3ZhbHVlXTsgfSk7XG52YXIgZmxleERpcmVjdGlvbk1hcCA9IChfYSA9IHt9LFxuICAgIF9hW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XXSA9IDAsXG4gICAgX2FbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRV0gPSAxLFxuICAgIF9hW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OXSA9IDIsXG4gICAgX2FbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5DT0xVTU5fUkVWRVJTRV0gPSAzLFxuICAgIF9hKTtcbnZhciBmbGV4V3JhcE1hcCA9IChfYiA9IHt9LFxuICAgIF9iW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLk5PV1JBUF0gPSAwLFxuICAgIF9iW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBdID0gMSxcbiAgICBfYltmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4V3JhcC5XUkFQX1JFVkVSU0VdID0gMixcbiAgICBfYik7XG52YXIganVzdGlmeUNvbnRlbnRNYXAgPSAoX2MgPSB7fSxcbiAgICBfY1tmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5GTEVYX1NUQVJUXSA9IDAsXG4gICAgX2NbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuSnVzdGlmeUNvbnRlbnQuRkxFWF9FTkRdID0gMSxcbiAgICBfY1tmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5DRU5URVJdID0gMixcbiAgICBfY1tmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5TUEFDRV9CRVRXRUVOXSA9IDMsXG4gICAgX2NbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQVJPVU5EXSA9IDQsXG4gICAgX2MpO1xudmFyIGFsaWduSXRlbXNNYXAgPSAoX2QgPSB7fSxcbiAgICBfZFtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkZMRVhfU1RBUlRdID0gMCxcbiAgICBfZFtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkZMRVhfRU5EXSA9IDEsXG4gICAgX2RbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25JdGVtcy5DRU5URVJdID0gMixcbiAgICBfZFtmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkJBU0VMSU5FXSA9IDMsXG4gICAgX2RbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25JdGVtcy5TVFJFVENIXSA9IDQsXG4gICAgX2QpO1xudmFyIGFsaWduQ29udGVudE1hcCA9IChfZSA9IHt9LFxuICAgIF9lW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5GTEVYX1NUQVJUXSA9IDAsXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LkZMRVhfRU5EXSA9IDEsXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LkNFTlRFUl0gPSAyLFxuICAgIF9lW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5TUEFDRV9CRVRXRUVOXSA9IDMsXG4gICAgX2VbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25Db250ZW50LlNQQUNFX0FST1VORF0gPSA0LFxuICAgIF9lW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5TVFJFVENIXSA9IDUsXG4gICAgX2UpO1xudmFyIGFsaWduU2VsZk1hcCA9IChfZiA9IHt9LFxuICAgIF9mW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduU2VsZi5BVVRPXSA9IC0xLFxuICAgIF9mW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduU2VsZi5GTEVYX1NUQVJUXSA9IDAsXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLkZMRVhfRU5EXSA9IDEsXG4gICAgX2ZbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25TZWxmLkNFTlRFUl0gPSAyLFxuICAgIF9mW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduU2VsZi5CQVNFTElORV0gPSAzLFxuICAgIF9mW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduU2VsZi5TVFJFVENIXSA9IDQsXG4gICAgX2YpO1xudmFyIEZsZXhib3hMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGbGV4Ym94TGF5b3V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZsZXhib3hMYXlvdXQoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmICghd2lkZ2V0RmxleGJveExheW91dCkge1xuICAgICAgICAgICAgd2lkZ2V0RmxleGJveExheW91dCA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5GbGV4Ym94TGF5b3V0O1xuICAgICAgICAgICAgd2lkZ2V0TGF5b3V0UGFyYW1zID0gd2lkZ2V0RmxleGJveExheW91dC5MYXlvdXRQYXJhbXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IHdpZGdldEZsZXhib3hMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pbnZhbGlkYXRlT3JkZXJzQ2FjaGUoKTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5mbGV4RGlyZWN0aW9uUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uIChmbGV4RGlyZWN0aW9uKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRGbGV4RGlyZWN0aW9uKGZsZXhEaXJlY3Rpb25NYXBbZmxleERpcmVjdGlvbl0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFdyYXBQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhXcmFwUHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFdyYXBQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKGZsZXhXcmFwKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRGbGV4V3JhcChmbGV4V3JhcE1hcFtmbGV4V3JhcF0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuanVzdGlmeUNvbnRlbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmp1c3RpZnlDb250ZW50UHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuanVzdGlmeUNvbnRlbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKGp1c3RpZnlDb250ZW50KSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRKdXN0aWZ5Q29udGVudChqdXN0aWZ5Q29udGVudE1hcFtqdXN0aWZ5Q29udGVudF0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25JdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25JdGVtc1Byb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmFsaWduSXRlbXNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKGFsaWduSXRlbXMpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEFsaWduSXRlbXMoYWxpZ25JdGVtc01hcFthbGlnbkl0ZW1zXSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5hbGlnbkNvbnRlbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmFsaWduQ29udGVudFByb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmFsaWduQ29udGVudFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAoYWxpZ25Db250ZW50KSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRBbGlnbkNvbnRlbnQoYWxpZ25Db250ZW50TWFwW2FsaWduQ29udGVudF0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX3VwZGF0ZU5hdGl2ZUxheW91dFBhcmFtcyA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl91cGRhdGVOYXRpdmVMYXlvdXRQYXJhbXMuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgICAgIHZhciBscCA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0TGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIHZhciBzdHlsZSA9IGNoaWxkLnN0eWxlO1xuICAgICAgICBscC5vcmRlciA9IHN0eWxlLm9yZGVyO1xuICAgICAgICBscC5mbGV4R3JvdyA9IHN0eWxlLmZsZXhHcm93O1xuICAgICAgICBscC5mbGV4U2hyaW5rID0gc3R5bGUuZmxleFNocmluaztcbiAgICAgICAgbHAud3JhcEJlZm9yZSA9IHN0eWxlLmZsZXhXcmFwQmVmb3JlO1xuICAgICAgICBscC5hbGlnblNlbGYgPSBhbGlnblNlbGZNYXBbc3R5bGUuYWxpZ25TZWxmXTtcbiAgICAgICAgY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX3NldENoaWxkTWluV2lkdGhOYXRpdmUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY2hpbGQuX3NldE1pbldpZHRoTmF0aXZlKDApO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBscCA9IG5hdGl2ZVZpZXcuZ2V0TGF5b3V0UGFyYW1zKCk7XG4gICAgICAgIGlmIChscCBpbnN0YW5jZW9mIHdpZGdldExheW91dFBhcmFtcykge1xuICAgICAgICAgICAgbHAubWluV2lkdGggPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMoY2hpbGQuc3R5bGUubWluV2lkdGgsIDApO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fc2V0Q2hpbGRNaW5IZWlnaHROYXRpdmUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY2hpbGQuX3NldE1pbkhlaWdodE5hdGl2ZSgwKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbHAgPSBuYXRpdmVWaWV3LmdldExheW91dFBhcmFtcygpO1xuICAgICAgICBpZiAobHAgaW5zdGFuY2VvZiB3aWRnZXRMYXlvdXRQYXJhbXMpIHtcbiAgICAgICAgICAgIGxwLm1pbkhlaWdodCA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyhjaGlsZC5zdHlsZS5taW5IZWlnaHQsIDApO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gRmxleGJveExheW91dDtcbn0oZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleGJveExheW91dEJhc2UpKTtcbmV4cG9ydHMuRmxleGJveExheW91dCA9IEZsZXhib3hMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mbGV4Ym94LWxheW91dC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkge1xuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJlbGVtZW50IGNhbm5vdCBiZSBudWxsIG9yIHVuZGVmaW5lZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xufVxubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5yb3cgPSAwO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5jb2wgPSAwO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5yb3dTcGFuID0gMTtcbmxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUuY29sU3BhbiA9IDE7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJjb2x1bW5cIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5jb2w7IH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHsgdGhpcy5jb2wgPSB2YWx1ZTsgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJjb2x1bW5TcGFuXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuY29sU3BhbjsgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLmNvbFNwYW4gPSB2YWx1ZTsgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5mdW5jdGlvbiB2YWxpZGF0ZUl0ZW1TcGVjKGl0ZW1TcGVjKSB7XG4gICAgaWYgKCFpdGVtU3BlYykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBjYW5ub3QgYmUgdW5kZWZpbmVkLlwiKTtcbiAgICB9XG4gICAgaWYgKGl0ZW1TcGVjLm93bmVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIml0ZW1TcGVjIGlzIGFscmVhZHkgYWRkZWQgdG8gR3JpZExheW91dC5cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gY29udmVydEdyaWRMZW5ndGgodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IEdyaWRVbml0VHlwZS5BVVRPKSB7XG4gICAgICAgIHJldHVybiBJdGVtU3BlYy5jcmVhdGUoMSwgR3JpZFVuaXRUeXBlLkFVVE8pO1xuICAgIH1cbiAgICBlbHNlIGlmICh2YWx1ZS5pbmRleE9mKFwiKlwiKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHN0YXJDb3VudCA9IHBhcnNlSW50KHZhbHVlLnJlcGxhY2UoXCIqXCIsIFwiXCIpIHx8IFwiMVwiKTtcbiAgICAgICAgcmV0dXJuIEl0ZW1TcGVjLmNyZWF0ZShzdGFyQ291bnQsIEdyaWRVbml0VHlwZS5TVEFSKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoIWlzTmFOKHBhcnNlSW50KHZhbHVlKSkpIHtcbiAgICAgICAgcmV0dXJuIEl0ZW1TcGVjLmNyZWF0ZShwYXJzZUludCh2YWx1ZSksIEdyaWRVbml0VHlwZS5QSVhFTCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcGFyc2UgaXRlbSBzcGVjIGZyb20gc3RyaW5nOiBcIiArIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUFuZEFkZEl0ZW1TcGVjcyh2YWx1ZSwgZnVuYykge1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvW1xccyxdKy8pO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGFyci5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgIHZhciBzdHIgPSBhcnJbaV0udHJpbSgpO1xuICAgICAgICBpZiAoc3RyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZ1bmMoY29udmVydEdyaWRMZW5ndGgoYXJyW2ldLnRyaW0oKSkpO1xuICAgICAgICB9XG4gICAgfVxufVxudmFyIEl0ZW1TcGVjID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSXRlbVNwZWMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSXRlbVNwZWMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9hY3R1YWxMZW5ndGggPSAwO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgX3RoaXMuX3ZhbHVlID0gMTtcbiAgICAgICAgICAgIF90aGlzLl91bml0VHlwZSA9IEdyaWRVbml0VHlwZS5TVEFSO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIHZhciB0eXBlID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiB0eXBlb2YgdHlwZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDAgfHwgaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgc2hvdWxkIG5vdCBiZSBuZWdhdGl2ZSwgTmFOIG9yIEluZmluaXR5OiBcIiArIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuX3ZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgX3RoaXMuX3VuaXRUeXBlID0gR3JpZFVuaXRUeXBlLnBhcnNlKHR5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmlyc3QgYXJndW1lbnQgc2hvdWxkIGJlIG51bWJlciwgc2Vjb25kIGFyZ3VtZW50IHNob3VsZCBiZSBzdHJpbmcuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSXRlbVNwZWMgZXhwZWN0cyAwIG9yIDIgYXJndW1lbnRzXCIpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLmluZGV4ID0gLTE7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgSXRlbVNwZWMuY3JlYXRlID0gZnVuY3Rpb24gKHZhbHVlLCB0eXBlKSB7XG4gICAgICAgIHZhciBzcGVjID0gbmV3IEl0ZW1TcGVjKCk7XG4gICAgICAgIHNwZWMuX3ZhbHVlID0gdmFsdWU7XG4gICAgICAgIHNwZWMuX3VuaXRUeXBlID0gdHlwZTtcbiAgICAgICAgcmV0dXJuIHNwZWM7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImFjdHVhbExlbmd0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdHVhbExlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSXRlbVNwZWMuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgICAgIHJldHVybiAodmFsdWUxLmdyaWRVbml0VHlwZSA9PT0gdmFsdWUyLmdyaWRVbml0VHlwZSkgJiYgKHZhbHVlMS52YWx1ZSA9PT0gdmFsdWUyLnZhbHVlKSAmJiAodmFsdWUxLm93bmVyID09PSB2YWx1ZTIub3duZXIpICYmICh2YWx1ZTEuaW5kZXggPT09IHZhbHVlMi5pbmRleCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImdyaWRVbml0VHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImlzQWJzb2x1dGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91bml0VHlwZSA9PT0gR3JpZFVuaXRUeXBlLlBJWEVMO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImlzQXV0b1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlID09PSBHcmlkVW5pdFR5cGUuQVVUTztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZW1TcGVjLnByb3RvdHlwZSwgXCJpc1N0YXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91bml0VHlwZSA9PT0gR3JpZFVuaXRUeXBlLlNUQVI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEl0ZW1TcGVjO1xufShsYXlvdXRfYmFzZV8xLk9ic2VydmFibGUpKTtcbmV4cG9ydHMuSXRlbVNwZWMgPSBJdGVtU3BlYztcbnZhciBHcmlkTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEdyaWRMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEdyaWRMYXlvdXRCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Jvd3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgX3RoaXMuX2NvbHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBHcmlkTGF5b3V0QmFzZV8xID0gR3JpZExheW91dEJhc2U7XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Q29sdW1uID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5jb2w7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5zZXRDb2x1bW4gPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmNvbCA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Q29sdW1uU3BhbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuY29sU3BhbjtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnNldENvbHVtblNwYW4gPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmNvbFNwYW4gPSB2YWx1ZTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLmdldFJvdyA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkucm93O1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2Uuc2V0Um93ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS5yb3cgPSB2YWx1ZTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLmdldFJvd1NwYW4gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnJvd1NwYW47XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5zZXRSb3dTcGFuID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS5yb3dTcGFuID0gdmFsdWU7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuYWRkUm93ID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgICAgIHZhbGlkYXRlSXRlbVNwZWMoaXRlbVNwZWMpO1xuICAgICAgICBpdGVtU3BlYy5vd25lciA9IHRoaXM7XG4gICAgICAgIHRoaXMuX3Jvd3MucHVzaChpdGVtU3BlYyk7XG4gICAgICAgIHRoaXMuX29uUm93QWRkZWQoaXRlbVNwZWMpO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5hZGRDb2x1bW4gPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgdmFsaWRhdGVJdGVtU3BlYyhpdGVtU3BlYyk7XG4gICAgICAgIGl0ZW1TcGVjLm93bmVyID0gdGhpcztcbiAgICAgICAgdGhpcy5fY29scy5wdXNoKGl0ZW1TcGVjKTtcbiAgICAgICAgdGhpcy5fb25Db2x1bW5BZGRlZChpdGVtU3BlYyk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmFkZENoaWxkQXRDZWxsID0gZnVuY3Rpb24gKHZpZXcsIHJvdywgY29sdW1uLCByb3dTcGFuLCBjb2x1bW5TcGFuKSB7XG4gICAgICAgIHRoaXMuYWRkQ2hpbGQodmlldyk7XG4gICAgICAgIEdyaWRMYXlvdXRCYXNlXzEuc2V0Um93KHZpZXcsIHJvdyk7XG4gICAgICAgIEdyaWRMYXlvdXRCYXNlXzEuc2V0Q29sdW1uKHZpZXcsIGNvbHVtbik7XG4gICAgICAgIGlmIChyb3dTcGFuKSB7XG4gICAgICAgICAgICBHcmlkTGF5b3V0QmFzZV8xLnNldFJvd1NwYW4odmlldywgcm93U3Bhbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtblNwYW4pIHtcbiAgICAgICAgICAgIEdyaWRMYXlvdXRCYXNlXzEuc2V0Q29sdW1uU3Bhbih2aWV3LCBjb2x1bW5TcGFuKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLnJlbW92ZVJvdyA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICBpZiAoIWl0ZW1TcGVjKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBpcyBudWxsLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9yb3dzLmluZGV4T2YoaXRlbVNwZWMpO1xuICAgICAgICBpZiAoaXRlbVNwZWMub3duZXIgIT09IHRoaXMgfHwgaW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSb3cgaXMgbm90IGNoaWxkIG9mIHRoaXMgR3JpZExheW91dFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtU3BlYy5pbmRleCA9IC0xO1xuICAgICAgICB0aGlzLl9yb3dzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMuX29uUm93UmVtb3ZlZChpdGVtU3BlYywgaW5kZXgpO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5yZW1vdmVDb2x1bW4gPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgaWYgKCFpdGVtU3BlYykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgaXMgbnVsbC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fY29scy5pbmRleE9mKGl0ZW1TcGVjKTtcbiAgICAgICAgaWYgKGl0ZW1TcGVjLm93bmVyICE9PSB0aGlzIHx8IGluZGV4IDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29sdW1uIGlzIG5vdCBjaGlsZCBvZiB0aGlzIEdyaWRMYXlvdXRcIik7XG4gICAgICAgIH1cbiAgICAgICAgaXRlbVNwZWMuaW5kZXggPSAtMTtcbiAgICAgICAgdGhpcy5fY29scy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB0aGlzLl9vbkNvbHVtblJlbW92ZWQoaXRlbVNwZWMsIGluZGV4KTtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVtb3ZlQ29sdW1ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX2NvbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBjb2xTcGVjID0gdGhpcy5fY29sc1tpXTtcbiAgICAgICAgICAgIHRoaXMuX29uQ29sdW1uUmVtb3ZlZChjb2xTcGVjLCBpKTtcbiAgICAgICAgICAgIGNvbFNwZWMuaW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jb2xzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLnJlbW92ZVJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9yb3dzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgcm93U3BlYyA9IHRoaXMuX3Jvd3NbaV07XG4gICAgICAgICAgICB0aGlzLl9vblJvd1JlbW92ZWQocm93U3BlYywgaSk7XG4gICAgICAgICAgICByb3dTcGVjLmluZGV4ID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcm93cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5vblJvd0NoYW5nZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLm9uUm93U3BhbkNoYW5nZWQgPSBmdW5jdGlvbiAoZWxlbWVudCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLm9uQ29sdW1uQ2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUub25Db2x1bW5TcGFuQ2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuX29uUm93QWRkZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5fb25Db2x1bW5BZGRlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLl9vblJvd1JlbW92ZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4KSB7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuX29uQ29sdW1uUmVtb3ZlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYywgaW5kZXgpIHtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5nZXRDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29scy5zbGljZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yb3dzLnNsaWNlKCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR3JpZExheW91dEJhc2UucHJvdG90eXBlLCBcImNvbHVtbnNJbnRlcm5hbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbHM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwicm93c0ludGVybmFsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcm93cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmludmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR3JpZExheW91dEJhc2UucHJvdG90eXBlLCBcInJvd3NcIiwge1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlUm93cygpO1xuICAgICAgICAgICAgcGFyc2VBbmRBZGRJdGVtU3BlY3ModmFsdWUsIGZ1bmN0aW9uIChzcGVjKSB7IHJldHVybiBfdGhpcy5hZGRSb3coc3BlYyk7IH0pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR3JpZExheW91dEJhc2UucHJvdG90eXBlLCBcImNvbHVtbnNcIiwge1xuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ29sdW1ucygpO1xuICAgICAgICAgICAgcGFyc2VBbmRBZGRJdGVtU3BlY3ModmFsdWUsIGZ1bmN0aW9uIChzcGVjKSB7IHJldHVybiBfdGhpcy5hZGRDb2x1bW4oc3BlYyk7IH0pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICB2YXIgR3JpZExheW91dEJhc2VfMTtcbiAgICBHcmlkTGF5b3V0QmFzZSA9IEdyaWRMYXlvdXRCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiR3JpZExheW91dFwiKVxuICAgIF0sIEdyaWRMYXlvdXRCYXNlKTtcbiAgICByZXR1cm4gR3JpZExheW91dEJhc2U7XG59KGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5HcmlkTGF5b3V0QmFzZSA9IEdyaWRMYXlvdXRCYXNlO1xuR3JpZExheW91dEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmNvbHVtblByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiY29sXCIsIGRlZmF1bHRWYWx1ZTogMCxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgZ3JpZCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChncmlkIGluc3RhbmNlb2YgR3JpZExheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGdyaWQub25Db2x1bW5DaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgwLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5jb2x1bW5Qcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlZpZXcpO1xuZXhwb3J0cy5jb2x1bW5TcGFuUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJjb2xTcGFuXCIsIGRlZmF1bHRWYWx1ZTogMSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgZ3JpZCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChncmlkIGluc3RhbmNlb2YgR3JpZExheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGdyaWQub25Db2x1bW5TcGFuQ2hhbmdlZCh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gTWF0aC5tYXgoMSwgcGFyc2VJbnQodikpOyB9XG59KTtcbmV4cG9ydHMuY29sdW1uU3BhblByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnJvd1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicm93XCIsIGRlZmF1bHRWYWx1ZTogMCxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgZ3JpZCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChncmlkIGluc3RhbmNlb2YgR3JpZExheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGdyaWQub25Sb3dDaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgwLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5yb3dQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlZpZXcpO1xuZXhwb3J0cy5yb3dTcGFuUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJyb3dTcGFuXCIsIGRlZmF1bHRWYWx1ZTogMSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgZ3JpZCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChncmlkIGluc3RhbmNlb2YgR3JpZExheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGdyaWQub25Sb3dTcGFuQ2hhbmdlZCh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gTWF0aC5tYXgoMSwgcGFyc2VJbnQodikpOyB9XG59KTtcbmV4cG9ydHMucm93U3BhblByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG52YXIgR3JpZFVuaXRUeXBlO1xuKGZ1bmN0aW9uIChHcmlkVW5pdFR5cGUpIHtcbiAgICBHcmlkVW5pdFR5cGUuUElYRUwgPSBcInBpeGVsXCI7XG4gICAgR3JpZFVuaXRUeXBlLlNUQVIgPSBcInN0YXJcIjtcbiAgICBHcmlkVW5pdFR5cGUuQVVUTyA9IFwiYXV0b1wiO1xuICAgIEdyaWRVbml0VHlwZS5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEdyaWRVbml0VHlwZS5QSVhFTCwgR3JpZFVuaXRUeXBlLlNUQVIsIEdyaWRVbml0VHlwZS5BVVRPKTtcbiAgICBHcmlkVW5pdFR5cGUucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoR3JpZFVuaXRUeXBlLmlzVmFsaWQpO1xufSkoR3JpZFVuaXRUeXBlID0gZXhwb3J0cy5HcmlkVW5pdFR5cGUgfHwgKGV4cG9ydHMuR3JpZFVuaXRUeXBlID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdyaWQtbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGdyaWRfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZ3JpZC1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZ3JpZC1sYXlvdXQtY29tbW9uXCIpKTtcbmZ1bmN0aW9uIG1ha2VOYXRpdmVTZXR0ZXIoc2V0dGVyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxwID0gbmF0aXZlVmlldy5nZXRMYXlvdXRQYXJhbXMoKSB8fCBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICBpZiAobHAgaW5zdGFuY2VvZiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ29tbW9uTGF5b3V0UGFyYW1zKSB7XG4gICAgICAgICAgICBzZXR0ZXIobHAsIHZhbHVlKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5ncmlkX2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtncmlkX2xheW91dF9jb21tb25fMS5yb3dQcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5yb3cgPSB2YWx1ZTsgfSk7XG5ncmlkX2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtncmlkX2xheW91dF9jb21tb25fMS5jb2x1bW5Qcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5jb2x1bW4gPSB2YWx1ZTsgfSk7XG5ncmlkX2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtncmlkX2xheW91dF9jb21tb25fMS5yb3dTcGFuUHJvcGVydHkuc2V0TmF0aXZlXSA9IG1ha2VOYXRpdmVTZXR0ZXIoZnVuY3Rpb24gKGxwLCB2YWx1ZSkgeyByZXR1cm4gbHAucm93U3BhbiA9IHZhbHVlOyB9KTtcbmdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2dyaWRfbGF5b3V0X2NvbW1vbl8xLmNvbHVtblNwYW5Qcm9wZXJ0eS5zZXROYXRpdmVdID0gbWFrZU5hdGl2ZVNldHRlcihmdW5jdGlvbiAobHAsIHZhbHVlKSB7IHJldHVybiBscC5jb2x1bW5TcGFuID0gdmFsdWU7IH0pO1xuZnVuY3Rpb24gY3JlYXRlTmF0aXZlU3BlYyhpdGVtU3BlYykge1xuICAgIHN3aXRjaCAoaXRlbVNwZWMuZ3JpZFVuaXRUeXBlKSB7XG4gICAgICAgIGNhc2UgZ3JpZF9sYXlvdXRfY29tbW9uXzEuR3JpZFVuaXRUeXBlLkFVVE86XG4gICAgICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYyhpdGVtU3BlYy52YWx1ZSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5hdXRvKTtcbiAgICAgICAgY2FzZSBncmlkX2xheW91dF9jb21tb25fMS5HcmlkVW5pdFR5cGUuU1RBUjpcbiAgICAgICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKGl0ZW1TcGVjLnZhbHVlLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpO1xuICAgICAgICBjYXNlIGdyaWRfbGF5b3V0X2NvbW1vbl8xLkdyaWRVbml0VHlwZS5QSVhFTDpcbiAgICAgICAgICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKGl0ZW1TcGVjLnZhbHVlICogZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCksIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUucGl4ZWwpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBncmlkVW5pdFR5cGU6IFwiICsgaXRlbVNwZWMuZ3JpZFVuaXRUeXBlKTtcbiAgICB9XG59XG52YXIgSXRlbVNwZWMgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJdGVtU3BlYywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJdGVtU3BlYygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImFjdHVhbExlbmd0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubmF0aXZlU3BlYykge1xuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRoaXMubmF0aXZlU3BlYy5nZXRBY3R1YWxMZW5ndGgoKSAvIGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gSXRlbVNwZWM7XG59KGdyaWRfbGF5b3V0X2NvbW1vbl8xLkl0ZW1TcGVjKSk7XG5leHBvcnRzLkl0ZW1TcGVjID0gSXRlbVNwZWM7XG52YXIgR3JpZExheW91dCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEdyaWRMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR3JpZExheW91dCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkTGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5yb3dzSW50ZXJuYWwuZm9yRWFjaChmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4LCByb3dzKSB7IF90aGlzLl9vblJvd0FkZGVkKGl0ZW1TcGVjKTsgfSwgdGhpcyk7XG4gICAgICAgIHRoaXMuY29sdW1uc0ludGVybmFsLmZvckVhY2goZnVuY3Rpb24gKGl0ZW1TcGVjLCBpbmRleCwgcm93cykgeyBfdGhpcy5fb25Db2x1bW5BZGRlZChpdGVtU3BlYyk7IH0sIHRoaXMpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5yb3dzSW50ZXJuYWwubGVuZ3RoOyBpLS07IGkgPj0gMCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1TcGVjID0gdGhpcy5yb3dzSW50ZXJuYWxbaV07XG4gICAgICAgICAgICB0aGlzLl9vblJvd1JlbW92ZWQoaXRlbVNwZWMsIGkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmNvbHVtbnNJbnRlcm5hbC5sZW5ndGg7IGktLTsgaSA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgaXRlbVNwZWMgPSB0aGlzLmNvbHVtbnNJbnRlcm5hbFtpXTtcbiAgICAgICAgICAgIHRoaXMuX29uQ29sdW1uUmVtb3ZlZChpdGVtU3BlYywgaSk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vblJvd0FkZGVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVTcGVjID0gY3JlYXRlTmF0aXZlU3BlYyhpdGVtU3BlYyk7XG4gICAgICAgICAgICBpdGVtU3BlYy5uYXRpdmVTcGVjID0gbmF0aXZlU3BlYztcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRSb3cobmF0aXZlU3BlYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vbkNvbHVtbkFkZGVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVTcGVjID0gY3JlYXRlTmF0aXZlU3BlYyhpdGVtU3BlYyk7XG4gICAgICAgICAgICBpdGVtU3BlYy5uYXRpdmVTcGVjID0gbmF0aXZlU3BlYztcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hZGRDb2x1bW4obmF0aXZlU3BlYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vblJvd1JlbW92ZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4KSB7XG4gICAgICAgIGl0ZW1TcGVjLm5hdGl2ZVNwZWMgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQucmVtb3ZlUm93QXQoaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5fb25Db2x1bW5SZW1vdmVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjLCBpbmRleCkge1xuICAgICAgICBpdGVtU3BlYy5uYXRpdmVTcGVjID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZUNvbHVtbkF0KGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIHJldHVybiBHcmlkTGF5b3V0O1xufShncmlkX2xheW91dF9jb21tb25fMS5HcmlkTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5HcmlkTGF5b3V0ID0gR3JpZExheW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdyaWQtbGF5b3V0LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTGF5b3V0QmFzZUNvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExheW91dEJhc2VDb21tb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGF5b3V0QmFzZUNvbW1vbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9zdWJWaWV3cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRyZW5Db3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1YlZpZXdzLmxlbmd0aDtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YlZpZXdzLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRBdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3NbaW5kZXhdO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRJbmRleCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3MuaW5kZXhPZihjaGlsZCk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5nZXRDaGlsZEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHZpZXdfMS5nZXRWaWV3QnlJZCh0aGlzLCBpZCk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5fcmVnaXN0ZXJMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdGhpcy5fc3ViVmlld3MucHVzaChjaGlsZCk7XG4gICAgICAgIHRoaXMuX2FkZFZpZXcoY2hpbGQpO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmluc2VydENoaWxkID0gZnVuY3Rpb24gKGNoaWxkLCBhdEluZGV4KSB7XG4gICAgICAgIHRoaXMuX3N1YlZpZXdzLnNwbGljZShhdEluZGV4LCAwLCBjaGlsZCk7XG4gICAgICAgIHRoaXMuX2FkZFZpZXcoY2hpbGQsIGF0SW5kZXgpO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZVZpZXcoY2hpbGQpO1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9zdWJWaWV3cy5pbmRleE9mKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fc3ViVmlld3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fdW5yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLnJlbW92ZUNoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3aGlsZSAodGhpcy5nZXRDaGlsZHJlbkNvdW50KCkgIT09IDApIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5fc3ViVmlld3NbdGhpcy5nZXRDaGlsZHJlbkNvdW50KCkgLSAxXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nVG9wO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nUmlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdSaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nQm90dG9tXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nTGVmdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdMZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLl9jaGlsZEluZGV4VG9OYXRpdmVDaGlsZEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGV4ICYmIGkgPCB0aGlzLl9zdWJWaWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IHRoaXMuX3N1YlZpZXdzW2ldLl9nZXROYXRpdmVWaWV3c0NvdW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdGhpcy5fc3ViVmlld3MubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJldFZhbCA9IGNhbGxiYWNrKHRoaXMuX3N1YlZpZXdzW2ldKTtcbiAgICAgICAgICAgIGlmIChyZXRWYWwgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmVhY2hMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgbGFzdENoaWxkID0gbnVsbDtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjdikge1xuICAgICAgICAgICAgY3YuX2VhY2hMYXlvdXRWaWV3KGZ1bmN0aW9uIChsdikge1xuICAgICAgICAgICAgICAgIGlmIChsYXN0Q2hpbGQgJiYgIWxhc3RDaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhsYXN0Q2hpbGQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdENoaWxkID0gbHY7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxhc3RDaGlsZCAmJiAhbGFzdENoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhsYXN0Q2hpbGQsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gTGF5b3V0QmFzZUNvbW1vbjtcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuTGF5b3V0QmFzZUNvbW1vbiA9IExheW91dEJhc2VDb21tb247XG5leHBvcnRzLmNsaXBUb0JvdW5kc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiY2xpcFRvQm91bmRzXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5jbGlwVG9Cb3VuZHNQcm9wZXJ0eS5yZWdpc3RlcihMYXlvdXRCYXNlQ29tbW9uKTtcbmV4cG9ydHMuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlzUGFzc1Rocm91Z2hQYXJlbnRFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihMYXlvdXRCYXNlQ29tbW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxheW91dC1iYXNlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vbGF5b3V0LWJhc2UtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbGF5b3V0LWJhc2UtY29tbW9uXCIpKTtcbnZhciBMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLmNsaXBUb0JvdW5kc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLmNsaXBUb0JvdW5kc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiY2xpcFRvQm91bmRzIHdpdGggdmFsdWUgZmFsc2UgaXMgbm90IHN1cHBvcnRlZCBvbiBBbmRyb2lkLiBZb3UgY2FuIHVzZSB0aGlzLmFuZHJvaWQuZ2V0UGFyZW50KCkuc2V0Q2xpcENoaWxkcmVuKGZhbHNlKSBhcyBhbiBhbHRlcm5hdGl2ZVwiKTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLmlzUGFzc1Rocm91Z2hQYXJlbnRFbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0UGFzc1Rocm91Z2hQYXJlbnQodmFsdWUpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3AsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ1RvcCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIGxheW91dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyBsYXlvdXRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModGhpcy5zdHlsZS5ib3JkZXJUb3BXaWR0aCwgMCkpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ1JpZ2h0LCB1bml0OiBcInB4XCIgfTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ1JpZ2h0KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGxheW91dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGgsIDApKTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHRoaXMuX2RlZmF1bHRQYWRkaW5nQm90dG9tLCB1bml0OiBcInB4XCIgfTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdCb3R0b20odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBsYXlvdXRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGgsIDApKTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5WaWV3SGVscGVyLnNldFBhZGRpbmdMZWZ0KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgbGF5b3V0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHZhbHVlLCAwKSArIGxheW91dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlckxlZnRXaWR0aCwgMCkpO1xuICAgIH07XG4gICAgcmV0dXJuIExheW91dEJhc2U7XG59KGxheW91dF9iYXNlX2NvbW1vbl8xLkxheW91dEJhc2VDb21tb24pKTtcbmV4cG9ydHMuTGF5b3V0QmFzZSA9IExheW91dEJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sYXlvdXQtYmFzZS5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG52YXIgU3RhY2tMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3RhY2tMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0YWNrTGF5b3V0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdGFja0xheW91dEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiU3RhY2tMYXlvdXRcIilcbiAgICBdLCBTdGFja0xheW91dEJhc2UpO1xuICAgIHJldHVybiBTdGFja0xheW91dEJhc2U7XG59KGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5TdGFja0xheW91dEJhc2UgPSBTdGFja0xheW91dEJhc2U7XG5TdGFja0xheW91dEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG52YXIgY29udmVydGVyID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiKSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwib3JpZW50YXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcInZlcnRpY2FsXCIsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBjb252ZXJ0ZXIgfSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkucmVnaXN0ZXIoU3RhY2tMYXlvdXRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0YWNrLWxheW91dC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzdGFja19sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zdGFjay1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc3RhY2stbGF5b3V0LWNvbW1vblwiKSk7XG52YXIgU3RhY2tMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdGFja0xheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdGFja0xheW91dCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdGFja0xheW91dC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuU3RhY2tMYXlvdXQodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBTdGFja0xheW91dC5wcm90b3R5cGVbc3RhY2tfbGF5b3V0X2NvbW1vbl8xLm9yaWVudGF0aW9uUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0T3JpZW50YXRpb24odmFsdWUgPT09IFwidmVydGljYWxcIiA/IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5PcmllbnRhdGlvbi52ZXJ0aWNhbCA6IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5PcmllbnRhdGlvbi5ob3Jpem9udGFsKTtcbiAgICB9O1xuICAgIHJldHVybiBTdGFja0xheW91dDtcbn0oc3RhY2tfbGF5b3V0X2NvbW1vbl8xLlN0YWNrTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5TdGFja0xheW91dCA9IFN0YWNrTGF5b3V0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RhY2stbGF5b3V0LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbnZhciBXcmFwTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdyYXBMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdyYXBMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFdyYXBMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIldyYXBMYXlvdXRcIilcbiAgICBdLCBXcmFwTGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIFdyYXBMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuV3JhcExheW91dEJhc2UgPSBXcmFwTGF5b3V0QmFzZTtcbldyYXBMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5pdGVtV2lkdGhQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1XaWR0aFwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b1wiLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIGxheW91dF9iYXNlXzEuTGVuZ3RoLnBhcnNlKHYpOyB9LFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7IHJldHVybiB0YXJnZXQuZWZmZWN0aXZlSXRlbVdpZHRoID0gbGF5b3V0X2Jhc2VfMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIC0xKTsgfVxufSk7XG5leHBvcnRzLml0ZW1XaWR0aFByb3BlcnR5LnJlZ2lzdGVyKFdyYXBMYXlvdXRCYXNlKTtcbmV4cG9ydHMuaXRlbUhlaWdodFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbUhlaWdodFwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b1wiLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIGxheW91dF9iYXNlXzEuTGVuZ3RoLnBhcnNlKHYpOyB9LFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7IHJldHVybiB0YXJnZXQuZWZmZWN0aXZlSXRlbUhlaWdodCA9IGxheW91dF9iYXNlXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAtMSk7IH1cbn0pO1xuZXhwb3J0cy5pdGVtSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIoV3JhcExheW91dEJhc2UpO1xudmFyIGNvbnZlcnRlciA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIikpO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm9yaWVudGF0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJob3Jpem9udGFsXCIsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBjb252ZXJ0ZXIgfSk7XG5leHBvcnRzLm9yaWVudGF0aW9uUHJvcGVydHkucmVnaXN0ZXIoV3JhcExheW91dEJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d3JhcC1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgd3JhcF9sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi93cmFwLWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi93cmFwLWxheW91dC1jb21tb25cIikpO1xudmFyIFdyYXBMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXcmFwTGF5b3V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdyYXBMYXlvdXQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV3JhcExheW91dC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuV3JhcExheW91dCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIFdyYXBMYXlvdXQucHJvdG90eXBlW3dyYXBfbGF5b3V0X2NvbW1vbl8xLm9yaWVudGF0aW9uUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0T3JpZW50YXRpb24odmFsdWUgPT09IFwidmVydGljYWxcIiA/IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5PcmllbnRhdGlvbi52ZXJ0aWNhbCA6IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5PcmllbnRhdGlvbi5ob3Jpem9udGFsKTtcbiAgICB9O1xuICAgIFdyYXBMYXlvdXQucHJvdG90eXBlW3dyYXBfbGF5b3V0X2NvbW1vbl8xLml0ZW1XaWR0aFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEl0ZW1XaWR0aCh3cmFwX2xheW91dF9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIC0xKSk7XG4gICAgfTtcbiAgICBXcmFwTGF5b3V0LnByb3RvdHlwZVt3cmFwX2xheW91dF9jb21tb25fMS5pdGVtSGVpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0SXRlbUhlaWdodCh3cmFwX2xheW91dF9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIC0xKSk7XG4gICAgfTtcbiAgICByZXR1cm4gV3JhcExheW91dDtcbn0od3JhcF9sYXlvdXRfY29tbW9uXzEuV3JhcExheW91dEJhc2UpKTtcbmV4cG9ydHMuV3JhcExheW91dCA9IFdyYXBMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13cmFwLWxheW91dC5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIExpc3RQaWNrZXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFBpY2tlckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdFBpY2tlckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTGlzdFBpY2tlckJhc2UucHJvdG90eXBlLl9nZXRJdGVtQXNTdHJpbmcgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKCFpdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuIFwiIFwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpdGVtID0gdGhpcy5pc0l0ZW1zU291cmNlID8gdGhpcy5pdGVtcy5nZXRJdGVtKGluZGV4KSA6IHRoaXMuaXRlbXNbaW5kZXhdO1xuICAgICAgICByZXR1cm4gKGl0ZW0gPT09IHVuZGVmaW5lZCB8fCBpdGVtID09PSBudWxsKSA/IGluZGV4ICsgXCJcIiA6IHRoaXMucGFyc2VJdGVtKGl0ZW0pO1xuICAgIH07XG4gICAgTGlzdFBpY2tlckJhc2UucHJvdG90eXBlLnBhcnNlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHRGaWVsZCA/IGl0ZW1bdGhpcy50ZXh0RmllbGRdICsgXCJcIiA6IGl0ZW0gKyBcIlwiO1xuICAgIH07XG4gICAgTGlzdFBpY2tlckJhc2UucHJvdG90eXBlLnVwZGF0ZVNlbGVjdGVkVmFsdWUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG51bGw7XG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbXNbaW5kZXhdO1xuICAgICAgICAgICAgbmV3VmFsID0gdGhpcy52YWx1ZUZpZWxkID8gaXRlbVt0aGlzLnZhbHVlRmllbGRdIDogaXRlbTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFZhbHVlICE9PSBuZXdWYWwpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCBuZXdWYWwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0UGlja2VyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkxpc3RQaWNrZXJcIilcbiAgICBdLCBMaXN0UGlja2VyQmFzZSk7XG4gICAgcmV0dXJuIExpc3RQaWNrZXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5MaXN0UGlja2VyQmFzZSA9IExpc3RQaWNrZXJCYXNlO1xuTGlzdFBpY2tlckJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwic2VsZWN0ZWRJbmRleFwiLCBkZWZhdWx0VmFsdWU6IC0xLFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH0sXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRhcmdldC5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0LnVwZGF0ZVNlbGVjdGVkVmFsdWUodmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufSk7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5yZWdpc3RlcihMaXN0UGlja2VyQmFzZSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBnZXRJdGVtID0gbmV3VmFsdWUgJiYgbmV3VmFsdWUuZ2V0SXRlbTtcbiAgICAgICAgdGFyZ2V0LmlzSXRlbXNTb3VyY2UgPSB0eXBlb2YgZ2V0SXRlbSA9PT0gXCJmdW5jdGlvblwiO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbmV4cG9ydHMudGV4dEZpZWxkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRleHRGaWVsZFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogXCJcIlxufSk7XG5leHBvcnRzLnRleHRGaWVsZFByb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbmV4cG9ydHMudmFsdWVGaWVsZFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ2YWx1ZUZpZWxkXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBcIlwiXG59KTtcbmV4cG9ydHMudmFsdWVGaWVsZFByb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbmV4cG9ydHMuc2VsZWN0ZWRWYWx1ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZFZhbHVlXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBudWxsXG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRWYWx1ZVByb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpc3QtcGlja2VyLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpc3RfcGlja2VyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vbGlzdC1waWNrZXItY29tbW9uXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbGF6eV8xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2xhenlcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9saXN0LXBpY2tlci1jb21tb25cIikpO1xudmFyIHNka1ZlcnNpb24gPSBsYXp5XzEuZGVmYXVsdChmdW5jdGlvbiAoKSB7IHJldHVybiBwYXJzZUludChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uKTsgfSk7XG52YXIgRm9ybWF0dGVyO1xudmFyIFZhbHVlQ2hhbmdlTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpIHtcbiAgICBpZiAoRm9ybWF0dGVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIEZvcm1hdHRlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRm9ybWF0dGVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRm9ybWF0dGVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBGb3JtYXR0ZXJJbXBsLnByb3RvdHlwZS5mb3JtYXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm93bmVyLl9nZXRJdGVtQXNTdHJpbmcoaW5kZXgpO1xuICAgICAgICB9O1xuICAgICAgICBGb3JtYXR0ZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5OdW1iZXJQaWNrZXIuRm9ybWF0dGVyXSlcbiAgICAgICAgXSwgRm9ybWF0dGVySW1wbCk7XG4gICAgICAgIHJldHVybiBGb3JtYXR0ZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIHZhciBWYWx1ZUNoYW5nZUxpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhWYWx1ZUNoYW5nZUxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVmFsdWVDaGFuZ2VMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVmFsdWVDaGFuZ2VMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIGxpc3RfcGlja2VyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZSh0aGlzLm93bmVyLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnVwZGF0ZVNlbGVjdGVkVmFsdWUobmV3VmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICBWYWx1ZUNoYW5nZUxpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC53aWRnZXQuTnVtYmVyUGlja2VyLk9uVmFsdWVDaGFuZ2VMaXN0ZW5lcl0pXG4gICAgICAgIF0sIFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsO1xuICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgIEZvcm1hdHRlciA9IEZvcm1hdHRlckltcGw7XG4gICAgVmFsdWVDaGFuZ2VMaXN0ZW5lciA9IFZhbHVlQ2hhbmdlTGlzdGVuZXJJbXBsO1xufVxuZnVuY3Rpb24gZ2V0RWRpdFRleHQocGlja2VyKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGNvdW50ID0gcGlja2VyLmdldENoaWxkQ291bnQoKTsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgdmFyIGNoaWxkID0gcGlja2VyLmdldENoaWxkQXQoaSk7XG4gICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIGFuZHJvaWQud2lkZ2V0LkVkaXRUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG52YXIgc2VsZWN0b3JXaGVlbFBhaW50RmllbGQ7XG5mdW5jdGlvbiBnZXRTZWxlY3RvcldoZWVsUGFpbnQocGlja2VyKSB7XG4gICAgaWYgKCFzZWxlY3RvcldoZWVsUGFpbnRGaWVsZCkge1xuICAgICAgICBzZWxlY3RvcldoZWVsUGFpbnRGaWVsZCA9IHBpY2tlci5nZXRDbGFzcygpLmdldERlY2xhcmVkRmllbGQoXCJtU2VsZWN0b3JXaGVlbFBhaW50XCIpO1xuICAgICAgICBzZWxlY3RvcldoZWVsUGFpbnRGaWVsZC5zZXRBY2Nlc3NpYmxlKHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gc2VsZWN0b3JXaGVlbFBhaW50RmllbGQuZ2V0KHBpY2tlcik7XG59XG52YXIgTGlzdFBpY2tlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpc3RQaWNrZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdFBpY2tlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGlja2VyID0gbmV3IGFuZHJvaWQud2lkZ2V0Lk51bWJlclBpY2tlcih0aGlzLl9jb250ZXh0KTtcbiAgICAgICAgcGlja2VyLnNldERlc2NlbmRhbnRGb2N1c2FiaWxpdHkoYW5kcm9pZC53aWRnZXQuTnVtYmVyUGlja2VyLkZPQ1VTX0JMT0NLX0RFU0NFTkRBTlRTKTtcbiAgICAgICAgcGlja2VyLnNldE1pblZhbHVlKDApO1xuICAgICAgICBwaWNrZXIuc2V0TWF4VmFsdWUoMCk7XG4gICAgICAgIHBpY2tlci5zZXRWYWx1ZSgwKTtcbiAgICAgICAgcGlja2VyLnNldFdyYXBTZWxlY3RvcldoZWVsKGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHBpY2tlcjtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoc2RrVmVyc2lvbigpIDwgMjkpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9yV2hlZWxQYWludCA9IGdldFNlbGVjdG9yV2hlZWxQYWludChuYXRpdmVWaWV3KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9ybWF0dGVyID0gbmV3IEZvcm1hdHRlcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRGb3JtYXR0ZXIoZm9ybWF0dGVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5mb3JtYXR0ZXIgPSBmb3JtYXR0ZXI7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWRMaXN0ZW5lciA9IG5ldyBWYWx1ZUNoYW5nZUxpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uVmFsdWVDaGFuZ2VkTGlzdGVuZXIodmFsdWVDaGFuZ2VkTGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LnZhbHVlQ2hhbmdlZExpc3RlbmVyID0gdmFsdWVDaGFuZ2VkTGlzdGVuZXI7XG4gICAgICAgIHZhciBlZGl0VGV4dCA9IGdldEVkaXRUZXh0KG5hdGl2ZVZpZXcpO1xuICAgICAgICBpZiAoZWRpdFRleHQpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuZWRpdFRleHQgPSBlZGl0VGV4dDtcbiAgICAgICAgICAgIGVkaXRUZXh0LnNldEZpbHRlcnMoW10pO1xuICAgICAgICAgICAgZWRpdFRleHQuc2V0VGV4dChcIiBcIiwgYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcuQnVmZmVyVHlwZS5OT1JNQUwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuZm9ybWF0dGVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgbmF0aXZlVmlldy52YWx1ZUNoYW5nZWRMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLl9maXhOdW1iZXJQaWNrZXJSZW5kZXJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEZvcm1hdHRlcihudWxsKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRGb3JtYXR0ZXIobmF0aXZlVmlldy5mb3JtYXR0ZXIpO1xuICAgICAgICB2YXIgZWRpdFRleHQgPSBuYXRpdmVWaWV3LmVkaXRUZXh0O1xuICAgICAgICBpZiAoZWRpdFRleHQpIHtcbiAgICAgICAgICAgIGVkaXRUZXh0LnNldEZpbHRlcnMoW10pO1xuICAgICAgICAgICAgZWRpdFRleHQuaW52YWxpZGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIG5hdGl2ZVZpZXcuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZhbHVlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuaXRlbXNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG1heFZhbHVlID0gdmFsdWUgJiYgdmFsdWUubGVuZ3RoID4gMCA/IHZhbHVlLmxlbmd0aCAtIDEgOiAwO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TWF4VmFsdWUobWF4VmFsdWUpO1xuICAgICAgICB0aGlzLl9maXhOdW1iZXJQaWNrZXJSZW5kZXJpbmcoKTtcbiAgICAgICAgbGlzdF9waWNrZXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9zZWxlY3RvcldoZWVsUGFpbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3RvcldoZWVsUGFpbnQuZ2V0Q29sb3IoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3LmdldFRleHRDb2xvcigpO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgbGlzdF9waWNrZXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLl9zZWxlY3RvcldoZWVsUGFpbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9yV2hlZWxQYWludC5zZXRDb2xvcihjb2xvcik7XG4gICAgICAgICAgICB2YXIgZWRpdFRleHQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZWRpdFRleHQ7XG4gICAgICAgICAgICBpZiAoZWRpdFRleHQpIHtcbiAgICAgICAgICAgICAgICBlZGl0VGV4dC5zZXRUZXh0Q29sb3IoY29sb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3LnNldFRleHRDb2xvcihjb2xvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBMaXN0UGlja2VyO1xufShsaXN0X3BpY2tlcl9jb21tb25fMS5MaXN0UGlja2VyQmFzZSkpO1xuZXhwb3J0cy5MaXN0UGlja2VyID0gTGlzdFBpY2tlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpc3QtcGlja2VyLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9idWlsZGVyXCIpO1xudmFyIGxhYmVsXzEgPSByZXF1aXJlKFwiLi4vbGFiZWxcIik7XG52YXIgb2JzZXJ2YWJsZV9hcnJheV8xID0gcmVxdWlyZShcIi4uLy4uL2RhdGEvb2JzZXJ2YWJsZS1hcnJheVwiKTtcbnZhciB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEgPSByZXF1aXJlKFwiLi4vY29yZS93ZWFrLWV2ZW50LWxpc3RlbmVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIga25vd25UZW1wbGF0ZXM7XG4oZnVuY3Rpb24gKGtub3duVGVtcGxhdGVzKSB7XG4gICAga25vd25UZW1wbGF0ZXMuaXRlbVRlbXBsYXRlID0gXCJpdGVtVGVtcGxhdGVcIjtcbn0pKGtub3duVGVtcGxhdGVzID0gZXhwb3J0cy5rbm93blRlbXBsYXRlcyB8fCAoZXhwb3J0cy5rbm93blRlbXBsYXRlcyA9IHt9KSk7XG52YXIga25vd25NdWx0aVRlbXBsYXRlcztcbihmdW5jdGlvbiAoa25vd25NdWx0aVRlbXBsYXRlcykge1xuICAgIGtub3duTXVsdGlUZW1wbGF0ZXMuaXRlbVRlbXBsYXRlcyA9IFwiaXRlbVRlbXBsYXRlc1wiO1xufSkoa25vd25NdWx0aVRlbXBsYXRlcyA9IGV4cG9ydHMua25vd25NdWx0aVRlbXBsYXRlcyB8fCAoZXhwb3J0cy5rbm93bk11bHRpVGVtcGxhdGVzID0ge30pKTtcbnZhciBhdXRvRWZmZWN0aXZlUm93SGVpZ2h0ID0gLTE7XG52YXIgTGlzdFZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExpc3RWaWV3QmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pdGVtSWRHZW5lcmF0b3IgPSBmdW5jdGlvbiAoX2l0ZW0sIGluZGV4KSB7IHJldHVybiBpbmRleDsgfTtcbiAgICAgICAgX3RoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUgPSBuZXcgbGFiZWxfMS5MYWJlbCgpO1xuICAgICAgICBfdGhpcy5fZGVmYXVsdFRlbXBsYXRlID0ge1xuICAgICAgICAgICAga2V5OiBcImRlZmF1bHRcIixcbiAgICAgICAgICAgIGNyZWF0ZVZpZXc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXRlbVRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBidWlsZGVyXzEucGFyc2UoX3RoaXMuaXRlbVRlbXBsYXRlLCBfdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwgPSBuZXcgQXJyYXkoX3RoaXMuX2RlZmF1bHRUZW1wbGF0ZSk7XG4gICAgICAgIF90aGlzLl9lZmZlY3RpdmVSb3dIZWlnaHQgPSBhdXRvRWZmZWN0aXZlUm93SGVpZ2h0O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0Vmlld0Jhc2UucHJvdG90eXBlLCBcInNlcGFyYXRvckNvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zZXBhcmF0b3JDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2VwYXJhdG9yQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RWaWV3QmFzZS5wcm90b3R5cGUsIFwiaXRlbVRlbXBsYXRlU2VsZWN0b3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZS5iaW5kKHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlUHJvcGVydHk6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFByb3BlcnR5OiBcInRlbXBsYXRlS2V5XCIsXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IHZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3IgPSBmdW5jdGlvbiAoaXRlbSwgaW5kZXgsIGl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1bXCIkaW5kZXhcIl0gPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlLmJpbmRpbmdDb250ZXh0ID09PSBpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZS5iaW5kaW5nQ29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUuYmluZGluZ0NvbnRleHQgPSBpdGVtO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUuZ2V0KFwidGVtcGxhdGVLZXlcIik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3IgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RWaWV3QmFzZS5wcm90b3R5cGUsIFwiaXRlbUlkR2VuZXJhdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbUlkR2VuZXJhdG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChnZW5lcmF0b3JGbikge1xuICAgICAgICAgICAgdGhpcy5faXRlbUlkR2VuZXJhdG9yID0gZ2VuZXJhdG9yRm47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuc2Nyb2xsVG9JbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5zY3JvbGxUb0luZGV4QW5pbWF0ZWQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX2dldEl0ZW1UZW1wbGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgdGVtcGxhdGVLZXkgPSBcImRlZmF1bHRcIjtcbiAgICAgICAgaWYgKHRoaXMuaXRlbVRlbXBsYXRlU2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuX2dldERhdGFJdGVtKGluZGV4KTtcbiAgICAgICAgICAgIHRlbXBsYXRlS2V5ID0gdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3IoZGF0YUl0ZW0sIGluZGV4LCB0aGlzLml0ZW1zKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbFtpXS5rZXkgPT09IHRlbXBsYXRlS2V5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbFtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsWzBdO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fcHJlcGFyZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgICAgIGl0ZW0uYmluZGluZ0NvbnRleHQgPSB0aGlzLl9nZXREYXRhSXRlbShpbmRleCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX2dldERhdGFJdGVtID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciB0aGlzSXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICByZXR1cm4gdGhpc0l0ZW1zLmdldEl0ZW0gPyB0aGlzSXRlbXMuZ2V0SXRlbShpbmRleCkgOiB0aGlzSXRlbXNbaW5kZXhdO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fZ2V0RGVmYXVsdEl0ZW1Db250ZW50ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBsYmwgPSBuZXcgbGFiZWxfMS5MYWJlbCgpO1xuICAgICAgICBsYmwuYmluZCh7XG4gICAgICAgICAgICB0YXJnZXRQcm9wZXJ0eTogXCJ0ZXh0XCIsXG4gICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eTogXCIkdmFsdWVcIlxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGxibDtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX29uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9vblJvd0hlaWdodFByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLmlzSXRlbUF0SW5kZXhWaXNpYmxlID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUudXBkYXRlRWZmZWN0aXZlUm93SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBleHBvcnRzLnJvd0hlaWdodFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5pdGVtTG9hZGluZ0V2ZW50ID0gXCJpdGVtTG9hZGluZ1wiO1xuICAgIExpc3RWaWV3QmFzZS5pdGVtVGFwRXZlbnQgPSBcIml0ZW1UYXBcIjtcbiAgICBMaXN0Vmlld0Jhc2UubG9hZE1vcmVJdGVtc0V2ZW50ID0gXCJsb2FkTW9yZUl0ZW1zXCI7XG4gICAgTGlzdFZpZXdCYXNlLmtub3duRnVuY3Rpb25zID0gW1wiaXRlbVRlbXBsYXRlU2VsZWN0b3JcIiwgXCJpdGVtSWRHZW5lcmF0b3JcIl07XG4gICAgTGlzdFZpZXdCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiTGlzdFZpZXdcIilcbiAgICBdLCBMaXN0Vmlld0Jhc2UpO1xuICAgIHJldHVybiBMaXN0Vmlld0Jhc2U7XG59KHZpZXdfMS5Db250YWluZXJWaWV3KSk7XG5leHBvcnRzLkxpc3RWaWV3QmFzZSA9IExpc3RWaWV3QmFzZTtcbkxpc3RWaWV3QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG9sZFZhbHVlIGluc3RhbmNlb2Ygdmlld18xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5yZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihvbGRWYWx1ZSwgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgdGFyZ2V0Ll9vbkl0ZW1zQ2hhbmdlZCwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLmFkZFdlYWtFdmVudExpc3RlbmVyKG5ld1ZhbHVlLCBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5LmNoYW5nZUV2ZW50LCB0YXJnZXQuX29uSXRlbXNDaGFuZ2VkLCB0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldC5yZWZyZXNoKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoTGlzdFZpZXdCYXNlKTtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1UZW1wbGF0ZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgdGFyZ2V0LnJlZnJlc2goKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlUHJvcGVydHkucmVnaXN0ZXIoTGlzdFZpZXdCYXNlKTtcbmV4cG9ydHMuaXRlbVRlbXBsYXRlc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtVGVtcGxhdGVzXCIsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXJfMS5wYXJzZU11bHRpcGxlVGVtcGxhdGVzKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZXNQcm9wZXJ0eS5yZWdpc3RlcihMaXN0Vmlld0Jhc2UpO1xudmFyIGRlZmF1bHRSb3dIZWlnaHQgPSBcImF1dG9cIjtcbmV4cG9ydHMucm93SGVpZ2h0UHJvcGVydHkgPSBuZXcgdmlld18xLkNvZXJjaWJsZVByb3BlcnR5KHtcbiAgICBuYW1lOiBcInJvd0hlaWdodFwiLCBkZWZhdWx0VmFsdWU6IGRlZmF1bHRSb3dIZWlnaHQsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5MZW5ndGguZXF1YWxzLFxuICAgIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQgPyB2YWx1ZSA6IGRlZmF1bHRSb3dIZWlnaHQ7XG4gICAgfSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQuX2VmZmVjdGl2ZVJvd0hlaWdodCA9IHZpZXdfMS5MZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIGF1dG9FZmZlY3RpdmVSb3dIZWlnaHQpO1xuICAgICAgICB0YXJnZXQuX29uUm93SGVpZ2h0UHJvcGVydHlDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5MZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5yb3dIZWlnaHRQcm9wZXJ0eS5yZWdpc3RlcihMaXN0Vmlld0Jhc2UpO1xuZXhwb3J0cy5pb3NFc3RpbWF0ZWRSb3dIZWlnaHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaW9zRXN0aW1hdGVkUm93SGVpZ2h0XCIsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdmlld18xLkxlbmd0aC5wYXJzZSh2KTsgfVxufSk7XG5leHBvcnRzLmlvc0VzdGltYXRlZFJvd0hlaWdodFByb3BlcnR5LnJlZ2lzdGVyKExpc3RWaWV3QmFzZSk7XG5leHBvcnRzLnNlcGFyYXRvckNvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJzZXBhcmF0b3JDb2xvclwiLCBjc3NOYW1lOiBcInNlcGFyYXRvci1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnNlcGFyYXRvckNvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpc3Qtdmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsaXN0X3ZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9saXN0LXZpZXctY29tbW9uXCIpO1xudmFyIHN0YWNrX2xheW91dF8xID0gcmVxdWlyZShcIi4uL2xheW91dHMvc3RhY2stbGF5b3V0XCIpO1xudmFyIHByb3h5X3ZpZXdfY29udGFpbmVyXzEgPSByZXF1aXJlKFwiLi4vcHJveHktdmlldy1jb250YWluZXJcIik7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXRzL2xheW91dC1iYXNlXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2xpc3Qtdmlldy1jb21tb25cIikpO1xudmFyIElURU1MT0FESU5HID0gbGlzdF92aWV3X2NvbW1vbl8xLkxpc3RWaWV3QmFzZS5pdGVtTG9hZGluZ0V2ZW50O1xudmFyIExPQURNT1JFSVRFTVMgPSBsaXN0X3ZpZXdfY29tbW9uXzEuTGlzdFZpZXdCYXNlLmxvYWRNb3JlSXRlbXNFdmVudDtcbnZhciBJVEVNVEFQID0gbGlzdF92aWV3X2NvbW1vbl8xLkxpc3RWaWV3QmFzZS5pdGVtVGFwRXZlbnQ7XG52YXIgSXRlbUNsaWNrTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplSXRlbUNsaWNrTGlzdGVuZXIoKSB7XG4gICAgaWYgKEl0ZW1DbGlja0xpc3RlbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIEl0ZW1DbGlja0xpc3RlbmVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhJdGVtQ2xpY2tMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEl0ZW1DbGlja0xpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBJdGVtQ2xpY2tMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uSXRlbUNsaWNrID0gZnVuY3Rpb24gKHBhcmVudCwgY29udmVydFZpZXcsIGluZGV4LCBpZCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gb3duZXIuX3JlYWxpemVkVGVtcGxhdGVzLmdldChvd25lci5fZ2V0SXRlbVRlbXBsYXRlKGluZGV4KS5rZXkpLmdldChjb252ZXJ0Vmlldyk7XG4gICAgICAgICAgICBvd25lci5ub3RpZnkoeyBldmVudE5hbWU6IElURU1UQVAsIG9iamVjdDogb3duZXIsIGluZGV4OiBpbmRleCwgdmlldzogdmlldyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgSXRlbUNsaWNrTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5BZGFwdGVyVmlldy5Pbkl0ZW1DbGlja0xpc3RlbmVyXSlcbiAgICAgICAgXSwgSXRlbUNsaWNrTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIEl0ZW1DbGlja0xpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBJdGVtQ2xpY2tMaXN0ZW5lciA9IEl0ZW1DbGlja0xpc3RlbmVySW1wbDtcbn1cbnZhciBMaXN0VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpc3RWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExpc3RWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuZHJvaWRWaWV3SWQgPSAtMTtcbiAgICAgICAgX3RoaXMuX3JlYWxpemVkSXRlbXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLl9yZWFsaXplZFRlbXBsYXRlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxpc3RWaWV3ID0gbmV3IGFuZHJvaWQud2lkZ2V0Lkxpc3RWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBsaXN0Vmlldy5zZXREZXNjZW5kYW50Rm9jdXNhYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3R3JvdXAuRk9DVVNfQUZURVJfREVTQ0VOREFOVFMpO1xuICAgICAgICBsaXN0Vmlldy5zZXRDYWNoZUNvbG9ySGludChhbmRyb2lkLmdyYXBoaWNzLkNvbG9yLlRSQU5TUEFSRU5UKTtcbiAgICAgICAgcmV0dXJuIGxpc3RWaWV3O1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMudXBkYXRlRWZmZWN0aXZlUm93SGVpZ2h0KCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpbml0aWFsaXplSXRlbUNsaWNrTGlzdGVuZXIoKTtcbiAgICAgICAgZW5zdXJlTGlzdFZpZXdBZGFwdGVyQ2xhc3MoKTtcbiAgICAgICAgdmFyIGFkYXB0ZXIgPSBuZXcgTGlzdFZpZXdBZGFwdGVyQ2xhc3ModGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0QWRhcHRlcihhZGFwdGVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGFwdGVyID0gYWRhcHRlcjtcbiAgICAgICAgdmFyIGl0ZW1DbGlja0xpc3RlbmVyID0gbmV3IEl0ZW1DbGlja0xpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uSXRlbUNsaWNrTGlzdGVuZXIoaXRlbUNsaWNrTGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3Lml0ZW1DbGlja0xpc3RlbmVyID0gaXRlbUNsaWNrTGlzdGVuZXI7XG4gICAgICAgIGlmICh0aGlzLl9hbmRyb2lkVmlld0lkIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXdJZCA9IGFuZHJvaWQudmlldy5WaWV3LmdlbmVyYXRlVmlld0lkKCk7XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5zZXRJZCh0aGlzLl9hbmRyb2lkVmlld0lkKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0QWRhcHRlcihudWxsKTtcbiAgICAgICAgbmF0aXZlVmlldy5pdGVtQ2xpY2tMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRhcHRlci5vd25lciA9IG51bGw7XG4gICAgICAgIHRoaXMuY2xlYXJSZWFsaXplZENlbGxzKCk7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3IHx8ICFuYXRpdmVWaWV3LmdldEFkYXB0ZXIoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlYWxpemVkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAodmlldywgbmF0aXZlVmlldykge1xuICAgICAgICAgICAgaWYgKCEodmlldy5iaW5kaW5nQ29udGV4dCBpbnN0YW5jZW9mIGxpc3Rfdmlld19jb21tb25fMS5PYnNlcnZhYmxlKSkge1xuICAgICAgICAgICAgICAgIHZpZXcuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbmF0aXZlVmlldy5nZXRBZGFwdGVyKCkubm90aWZ5RGF0YVNldENoYW5nZWQoKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5zY3JvbGxUb0luZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRTZWxlY3Rpb24oaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuc2Nyb2xsVG9JbmRleEFuaW1hdGVkID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zbW9vdGhTY3JvbGxUb1Bvc2l0aW9uKGluZGV4KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RWaWV3LnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWxpemVkSXRlbXMuc2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fcmVhbGl6ZWRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICh2aWV3LCBuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBpZiAodmlldy5wYXJlbnQgaW5zdGFuY2VvZiBMaXN0Vmlldykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHZpZXcucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHZpZXcucGFyZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLl9kdW1wUmVhbGl6ZWRUZW1wbGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUmVhbGl6ZWQgVGVtcGxhdGVzOlwiKTtcbiAgICAgICAgdGhpcy5fcmVhbGl6ZWRUZW1wbGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlxcdFwiICsgaW5kZXggKyBcIjpcIik7XG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlxcdFxcdFwiICsgaW5kZXguaGFzaENvZGUoKSArIFwiOiBcIiArIHZhbHVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coXCJSZWFsaXplZCBJdGVtcyBTaXplOiBcIiArIHRoaXMuX3JlYWxpemVkSXRlbXMuc2l6ZSk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuY2xlYXJSZWFsaXplZENlbGxzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9yZWFsaXplZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKHZpZXcsIG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIGlmICh2aWV3LnBhcmVudCkge1xuICAgICAgICAgICAgICAgIGlmICghKHZpZXcucGFyZW50IGluc3RhbmNlb2YgTGlzdFZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9yZW1vdmVWaWV3KHZpZXcucGFyZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlldy5wYXJlbnQuX3JlbW92ZVZpZXcodmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9yZWFsaXplZEl0ZW1zLmNsZWFyKCk7XG4gICAgICAgIHRoaXMuX3JlYWxpemVkVGVtcGxhdGVzLmNsZWFyKCk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuaXNJdGVtQXRJbmRleFZpc2libGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBzdGFydCA9IG5hdGl2ZVZpZXcuZ2V0Rmlyc3RWaXNpYmxlUG9zaXRpb24oKTtcbiAgICAgICAgdmFyIGVuZCA9IG5hdGl2ZVZpZXcuZ2V0TGFzdFZpc2libGVQb3NpdGlvbigpO1xuICAgICAgICByZXR1cm4gKGluZGV4ID49IHN0YXJ0ICYmIGluZGV4IDw9IGVuZCk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGVbbGlzdF92aWV3X2NvbW1vbl8xLnNlcGFyYXRvckNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGl2aWRlckhlaWdodDogbmF0aXZlVmlldy5nZXREaXZpZGVySGVpZ2h0KCksXG4gICAgICAgICAgICBkaXZpZGVyOiBuYXRpdmVWaWV3LmdldERpdmlkZXIoKVxuICAgICAgICB9O1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlW2xpc3Rfdmlld19jb21tb25fMS5zZXBhcmF0b3JDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGxpc3Rfdmlld19jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXREaXZpZGVyKG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkNvbG9yRHJhd2FibGUodmFsdWUuYW5kcm9pZCkpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXREaXZpZGVySGVpZ2h0KDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXREaXZpZGVyKHZhbHVlLmRpdmlkZXIpO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXREaXZpZGVySGVpZ2h0KHZhbHVlLmRpdmlkZXJIZWlnaHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGVbbGlzdF92aWV3X2NvbW1vbl8xLml0ZW1UZW1wbGF0ZXNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGVbbGlzdF92aWV3X2NvbW1vbl8xLml0ZW1UZW1wbGF0ZXNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbCA9IG5ldyBBcnJheSh0aGlzLl9kZWZhdWx0VGVtcGxhdGUpO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbCA9IHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbC5jb25jYXQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRBZGFwdGVyKG5ldyBMaXN0Vmlld0FkYXB0ZXJDbGFzcyh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBMaXN0Vmlldy5wcm90b3R5cGUsIFwiY3JlYXRlTmF0aXZlVmlld1wiLCBudWxsKTtcbiAgICByZXR1cm4gTGlzdFZpZXc7XG59KGxpc3Rfdmlld19jb21tb25fMS5MaXN0Vmlld0Jhc2UpKTtcbmV4cG9ydHMuTGlzdFZpZXcgPSBMaXN0VmlldztcbnZhciBMaXN0Vmlld0FkYXB0ZXJDbGFzcztcbmZ1bmN0aW9uIGVuc3VyZUxpc3RWaWV3QWRhcHRlckNsYXNzKCkge1xuICAgIGlmIChMaXN0Vmlld0FkYXB0ZXJDbGFzcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBMaXN0Vmlld0FkYXB0ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTGlzdFZpZXdBZGFwdGVyLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBMaXN0Vmlld0FkYXB0ZXIob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgTGlzdFZpZXdBZGFwdGVyLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm93bmVyICYmIHRoaXMub3duZXIuaXRlbXMgJiYgdGhpcy5vd25lci5pdGVtcy5sZW5ndGggPyB0aGlzLm93bmVyLml0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH07XG4gICAgICAgIExpc3RWaWV3QWRhcHRlci5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5vd25lciAmJiB0aGlzLm93bmVyLml0ZW1zICYmIGkgPCB0aGlzLm93bmVyLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBnZXRJdGVtID0gdGhpcy5vd25lci5pdGVtcy5nZXRJdGVtO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRJdGVtID8gZ2V0SXRlbS5jYWxsKHRoaXMub3duZXIuaXRlbXMsIGkpIDogdGhpcy5vd25lci5pdGVtc1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmdldEl0ZW1JZCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuZ2V0SXRlbShpKTtcbiAgICAgICAgICAgIHZhciBpZCA9IGk7XG4gICAgICAgICAgICBpZiAodGhpcy5vd25lciAmJiBpdGVtICYmIHRoaXMub3duZXIuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICBpZCA9IHRoaXMub3duZXIuaXRlbUlkR2VuZXJhdG9yKGl0ZW0sIGksIHRoaXMub3duZXIuaXRlbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGxvbmcoaWQpO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmhhc1N0YWJsZUlkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Vmlld0FkYXB0ZXIucHJvdG90eXBlLmdldFZpZXdUeXBlQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vd25lci5faXRlbVRlbXBsYXRlc0ludGVybmFsLmxlbmd0aDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlzdFZpZXdBZGFwdGVyLnByb3RvdHlwZS5nZXRJdGVtVmlld1R5cGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMub3duZXIuX2dldEl0ZW1UZW1wbGF0ZShpbmRleCk7XG4gICAgICAgICAgICB2YXIgaXRlbVZpZXdUeXBlID0gdGhpcy5vd25lci5faXRlbVRlbXBsYXRlc0ludGVybmFsLmluZGV4T2YodGVtcGxhdGUpO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1WaWV3VHlwZTtcbiAgICAgICAgfTtcbiAgICAgICAgTGlzdFZpZXdBZGFwdGVyLnByb3RvdHlwZS5nZXRWaWV3ID0gZnVuY3Rpb24gKGluZGV4LCBjb252ZXJ0VmlldywgcGFyZW50KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0b3RhbEl0ZW1Db3VudCA9IHRoaXMub3duZXIuaXRlbXMgPyB0aGlzLm93bmVyLml0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT09ICh0b3RhbEl0ZW1Db3VudCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci5ub3RpZnkoeyBldmVudE5hbWU6IExPQURNT1JFSVRFTVMsIG9iamVjdDogdGhpcy5vd25lciB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMub3duZXIuX2dldEl0ZW1UZW1wbGF0ZShpbmRleCk7XG4gICAgICAgICAgICB2YXIgdmlldztcbiAgICAgICAgICAgIGlmIChjb252ZXJ0Vmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcgPSB0aGlzLm93bmVyLl9yZWFsaXplZFRlbXBsYXRlcy5nZXQodGVtcGxhdGUua2V5KS5nZXQoY29udmVydFZpZXcpO1xuICAgICAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGVyZSBpcyBubyBlbnRyeSB3aXRoIGtleSAnXCIgKyBjb252ZXJ0VmlldyArIFwiJyBpbiB0aGUgcmVhbGl6ZWQgdmlld3MgY2FjaGUgZm9yIHRlbXBsYXRlIHdpdGgga2V5J1wiICsgdGVtcGxhdGUua2V5ICsgXCInLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2aWV3ID0gdGVtcGxhdGUuY3JlYXRlVmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBJVEVNTE9BRElORywgb2JqZWN0OiB0aGlzLm93bmVyLCBpbmRleDogaW5kZXgsIHZpZXc6IHZpZXcsXG4gICAgICAgICAgICAgICAgYW5kcm9pZDogcGFyZW50LFxuICAgICAgICAgICAgICAgIGlvczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5vd25lci5ub3RpZnkoYXJncyk7XG4gICAgICAgICAgICBpZiAoIWFyZ3Mudmlldykge1xuICAgICAgICAgICAgICAgIGFyZ3MudmlldyA9IHRoaXMub3duZXIuX2dldERlZmF1bHRJdGVtQ29udGVudChpbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy52aWV3KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3duZXIuX2VmZmVjdGl2ZVJvd0hlaWdodCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3Mudmlldy5oZWlnaHQgPSB0aGlzLm93bmVyLnJvd0hlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3Mudmlldy5oZWlnaHQgPSBsaXN0X3ZpZXdfY29tbW9uXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci5fcHJlcGFyZUl0ZW0oYXJncy52aWV3LCBpbmRleCk7XG4gICAgICAgICAgICAgICAgaWYgKCFhcmdzLnZpZXcucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLnZpZXcgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICEoYXJncy52aWV3IGluc3RhbmNlb2YgcHJveHlfdmlld19jb250YWluZXJfMS5Qcm94eVZpZXdDb250YWluZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm93bmVyLl9hZGRWaWV3KGFyZ3Mudmlldyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb252ZXJ0VmlldyA9IGFyZ3Mudmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwID0gbmV3IHN0YWNrX2xheW91dF8xLlN0YWNrTGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcC5hZGRDaGlsZChhcmdzLnZpZXcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25lci5fYWRkVmlldyhzcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb252ZXJ0VmlldyA9IHNwLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlYWxpemVkSXRlbXNGb3JUZW1wbGF0ZUtleSA9IHRoaXMub3duZXIuX3JlYWxpemVkVGVtcGxhdGVzLmdldCh0ZW1wbGF0ZS5rZXkpO1xuICAgICAgICAgICAgICAgIGlmICghcmVhbGl6ZWRJdGVtc0ZvclRlbXBsYXRlS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWxpemVkSXRlbXNGb3JUZW1wbGF0ZUtleSA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vd25lci5fcmVhbGl6ZWRUZW1wbGF0ZXMuc2V0KHRlbXBsYXRlLmtleSwgcmVhbGl6ZWRJdGVtc0ZvclRlbXBsYXRlS2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVhbGl6ZWRJdGVtc0ZvclRlbXBsYXRlS2V5LnNldChjb252ZXJ0VmlldywgYXJncy52aWV3KTtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLl9yZWFsaXplZEl0ZW1zLnNldChjb252ZXJ0VmlldywgYXJncy52aWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb252ZXJ0VmlldztcbiAgICAgICAgfTtcbiAgICAgICAgX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgICAgIF0sIExpc3RWaWV3QWRhcHRlci5wcm90b3R5cGUsIFwiZ2V0Vmlld1wiLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIExpc3RWaWV3QWRhcHRlcjtcbiAgICB9KGFuZHJvaWQud2lkZ2V0LkJhc2VBZGFwdGVyKSk7XG4gICAgTGlzdFZpZXdBZGFwdGVyQ2xhc3MgPSBMaXN0Vmlld0FkYXB0ZXI7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1saXN0LXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbnRlbnRfdmlld18xID0gcmVxdWlyZShcIi4uL2NvbnRlbnQtdmlld1wiKTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4uL2ZyYW1lXCIpO1xudmFyIGFjdGlvbl9iYXJfMSA9IHJlcXVpcmUoXCIuLi9hY3Rpb24tYmFyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb250ZW50LXZpZXdcIikpO1xudmFyIFBhZ2VCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGFnZUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUGFnZUJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUGFnZUJhc2VfMSA9IFBhZ2VCYXNlO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwibmF2aWdhdGlvbkNvbnRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYXZpZ2F0aW9uQ29udGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25CYXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNBY3Rpb25CYXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IG5ldyBhY3Rpb25fYmFyXzEuQWN0aW9uQmFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh0aGlzLl9hY3Rpb25CYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvbkJhcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBY3Rpb25CYXIgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmVkLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25CYXIgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGlvbkJhcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHRoaXMuX2FjdGlvbkJhcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaGFzQWN0aW9uQmFyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2FjdGlvbkJhcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwic3RhdHVzQmFyU3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnN0YXR1c0JhclN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5zdGF0dXNCYXJTdHlsZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcImFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJwYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUGFnZUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGFjdGlvbl9iYXJfMS5BY3Rpb25CYXIpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uQmFyID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyLmNhbGwodGhpcywgbmFtZSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuZ2V0S2V5ZnJhbWVBbmltYXRpb25XaXRoTmFtZSA9IGZ1bmN0aW9uIChhbmltYXRpb25OYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdHlsZVNjb3BlLmdldEtleWZyYW1lQW5pbWF0aW9uV2l0aE5hbWUoYW5pbWF0aW9uTmFtZSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcImZyYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHJldHVybiBmcmFtZSBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUgPyBmcmFtZSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUGFnZUJhc2UucHJvdG90eXBlLmNyZWF0ZU5hdmlnYXRlZERhdGEgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBldmVudE5hbWU6IGV2ZW50TmFtZSxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMubmF2aWdhdGlvbkNvbnRleHQsXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiBpc0JhY2tOYXZpZ2F0aW9uXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUub25OYXZpZ2F0aW5nVG8gPSBmdW5jdGlvbiAoY29udGV4dCwgaXNCYWNrTmF2aWdhdGlvbiwgYmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICBpZiAoaXNCYWNrTmF2aWdhdGlvbiAmJiB0aGlzLl9zdHlsZVNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZVNjb3BlLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jc3NTdGF0ZS5pc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpc0JhY2tOYXZpZ2F0aW9uICYmIGJpbmRpbmdDb250ZXh0ICE9PSB1bmRlZmluZWQgJiYgYmluZGluZ0NvbnRleHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuYmluZGluZ0NvbnRleHQgPSBiaW5kaW5nQ29udGV4dDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLmNyZWF0ZU5hdmlnYXRlZERhdGEoUGFnZUJhc2VfMS5uYXZpZ2F0aW5nVG9FdmVudCwgaXNCYWNrTmF2aWdhdGlvbikpO1xuICAgIH07XG4gICAgUGFnZUJhc2UucHJvdG90eXBlLm9uTmF2aWdhdGVkVG8gPSBmdW5jdGlvbiAoaXNCYWNrTmF2aWdhdGlvbikge1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLmNyZWF0ZU5hdmlnYXRlZERhdGEoUGFnZUJhc2VfMS5uYXZpZ2F0ZWRUb0V2ZW50LCBpc0JhY2tOYXZpZ2F0aW9uKSk7XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUub25OYXZpZ2F0aW5nRnJvbSA9IGZ1bmN0aW9uIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRpbmdGcm9tRXZlbnQsIGlzQmFja05hdmlnYXRpb24pKTtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5vbk5hdmlnYXRlZEZyb20gPSBmdW5jdGlvbiAoaXNCYWNrTmF2aWdhdGlvbikge1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLmNyZWF0ZU5hdmlnYXRlZERhdGEoUGFnZUJhc2VfMS5uYXZpZ2F0ZWRGcm9tRXZlbnQsIGlzQmFja05hdmlnYXRpb24pKTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkNvbnRleHQgPSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcuY2FsbCh0aGlzLCBjYWxsYmFjayk7XG4gICAgICAgIGlmICh0aGlzLmFjdGlvbkJhcikge1xuICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5hY3Rpb25CYXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuY29udGVudCA/IDEgOiAwKSArICh0aGlzLl9hY3Rpb25CYXIgPyAxIDogMCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHZhciBQYWdlQmFzZV8xO1xuICAgIFBhZ2VCYXNlLm5hdmlnYXRpbmdUb0V2ZW50ID0gXCJuYXZpZ2F0aW5nVG9cIjtcbiAgICBQYWdlQmFzZS5uYXZpZ2F0ZWRUb0V2ZW50ID0gXCJuYXZpZ2F0ZWRUb1wiO1xuICAgIFBhZ2VCYXNlLm5hdmlnYXRpbmdGcm9tRXZlbnQgPSBcIm5hdmlnYXRpbmdGcm9tXCI7XG4gICAgUGFnZUJhc2UubmF2aWdhdGVkRnJvbUV2ZW50ID0gXCJuYXZpZ2F0ZWRGcm9tXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBQYWdlQmFzZS5wcm90b3R5cGUsIFwib25OYXZpZ2F0aW5nVG9cIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBQYWdlQmFzZS5wcm90b3R5cGUsIFwib25OYXZpZ2F0ZWRUb1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJvbk5hdmlnYXRpbmdGcm9tXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgUGFnZUJhc2UucHJvdG90eXBlLCBcIm9uTmF2aWdhdGVkRnJvbVwiLCBudWxsKTtcbiAgICBQYWdlQmFzZSA9IFBhZ2VCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgY29udGVudF92aWV3XzEuQ1NTVHlwZShcIlBhZ2VcIilcbiAgICBdLCBQYWdlQmFzZSk7XG4gICAgcmV0dXJuIFBhZ2VCYXNlO1xufShjb250ZW50X3ZpZXdfMS5Db250ZW50VmlldykpO1xuZXhwb3J0cy5QYWdlQmFzZSA9IFBhZ2VCYXNlO1xuUGFnZUJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJuZXZlclwiO1xuZXhwb3J0cy5hY3Rpb25CYXJIaWRkZW5Qcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYWN0aW9uQmFySGlkZGVuXCIsIGFmZmVjdHNMYXlvdXQ6IGNvbnRlbnRfdmlld18xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogY29udGVudF92aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuYWN0aW9uQmFySGlkZGVuUHJvcGVydHkucmVnaXN0ZXIoUGFnZUJhc2UpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU3BhblVuZGVyU3RhdHVzQmFyUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImJhY2tncm91bmRTcGFuVW5kZXJTdGF0dXNCYXJcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgYWZmZWN0c0xheW91dDogY29udGVudF92aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU3BhblVuZGVyU3RhdHVzQmFyUHJvcGVydHkucmVnaXN0ZXIoUGFnZUJhc2UpO1xuZXhwb3J0cy5lbmFibGVTd2lwZUJhY2tOYXZpZ2F0aW9uUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImVuYWJsZVN3aXBlQmFja05hdmlnYXRpb25cIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogY29udGVudF92aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuZW5hYmxlU3dpcGVCYWNrTmF2aWdhdGlvblByb3BlcnR5LnJlZ2lzdGVyKFBhZ2VCYXNlKTtcbmV4cG9ydHMuc3RhdHVzQmFyU3R5bGVQcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwic3RhdHVzQmFyU3R5bGVcIiwgY3NzTmFtZTogXCJzdGF0dXMtYmFyLXN0eWxlXCIgfSk7XG5leHBvcnRzLnN0YXR1c0JhclN0eWxlUHJvcGVydHkucmVnaXN0ZXIoY29udGVudF92aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZFByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kXCIsIGNzc05hbWU6IFwiYW5kcm9pZC1zdGF0dXMtYmFyLWJhY2tncm91bmRcIixcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBjb250ZW50X3ZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IGNvbnRlbnRfdmlld18xLkNvbG9yKHYpOyB9XG59KTtcbmV4cG9ydHMuYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRQcm9wZXJ0eS5yZWdpc3Rlcihjb250ZW50X3ZpZXdfMS5TdHlsZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBhZ2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9wYWdlLWNvbW1vblwiKTtcbnZhciBhY3Rpb25fYmFyXzEgPSByZXF1aXJlKFwiLi4vYWN0aW9uLWJhclwiKTtcbnZhciBncmlkX2xheW91dF8xID0gcmVxdWlyZShcIi4uL2xheW91dHMvZ3JpZC1sYXlvdXRcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9wYWdlLWNvbW1vblwiKSk7XG52YXIgU1lTVEVNX1VJX0ZMQUdfTElHSFRfU1RBVFVTX0JBUiA9IDB4MDAwMDIwMDA7XG52YXIgU1RBVFVTX0JBUl9MSUdIVF9CQ0tHID0gLTY1NzkzMTtcbnZhciBTVEFUVVNfQkFSX0RBUktfQkNLRyA9IDE3MTEyNzYwMzI7XG52YXIgUGFnZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFBhZ2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQYWdlLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGF5b3V0ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkTGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBsYXlvdXQuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5hdXRvKSk7XG4gICAgICAgIGxheW91dC5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLnN0YXIpKTtcbiAgICAgICAgcmV0dXJuIGxheW91dDtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRCYWNrZ3JvdW5kQ29sb3IoLTEpO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBhY3Rpb25fYmFyXzEuQWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgZ3JpZF9sYXlvdXRfMS5HcmlkTGF5b3V0LnNldFJvdyhjaGlsZCwgMCk7XG4gICAgICAgICAgICAgICAgY2hpbGQuaG9yaXpvbnRhbEFsaWdubWVudCA9IFwic3RyZXRjaFwiO1xuICAgICAgICAgICAgICAgIGNoaWxkLnZlcnRpY2FsQWxpZ25tZW50ID0gXCJ0b3BcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyaWRfbGF5b3V0XzEuR3JpZExheW91dC5zZXRSb3coY2hpbGQsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQsIGF0SW5kZXgpO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uQmFySGlkZGVuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQWN0aW9uQmFyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlLnVwZGF0ZUFjdGlvbkJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5hY3Rpb25CYXIudXBkYXRlKCk7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZVtwYWdlX2NvbW1vbl8xLmFjdGlvbkJhckhpZGRlblByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVBY3Rpb25CYXIoKTtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlW3BhZ2VfY29tbW9uXzEuc3RhdHVzQmFyU3R5bGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24gPj0gXCIyMVwiKSB7XG4gICAgICAgICAgICB2YXIgd2luZG93XzEgPSB0aGlzLl9jb250ZXh0LmdldFdpbmRvdygpO1xuICAgICAgICAgICAgdmFyIGRlY29yVmlldyA9IHdpbmRvd18xLmdldERlY29yVmlldygpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb2xvcjogd2luZG93XzEuZ2V0U3RhdHVzQmFyQ29sb3IoKSxcbiAgICAgICAgICAgICAgICBzeXN0ZW1VaVZpc2liaWxpdHk6IGRlY29yVmlldy5nZXRTeXN0ZW1VaVZpc2liaWxpdHkoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlW3BhZ2VfY29tbW9uXzEuc3RhdHVzQmFyU3R5bGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uID49IFwiMjFcIikge1xuICAgICAgICAgICAgdmFyIHdpbmRvd18yID0gdGhpcy5fY29udGV4dC5nZXRXaW5kb3coKTtcbiAgICAgICAgICAgIHZhciBkZWNvclZpZXcgPSB3aW5kb3dfMi5nZXREZWNvclZpZXcoKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCJsaWdodFwiKSB7XG4gICAgICAgICAgICAgICAgd2luZG93XzIuc2V0U3RhdHVzQmFyQ29sb3IoU1RBVFVTX0JBUl9MSUdIVF9CQ0tHKTtcbiAgICAgICAgICAgICAgICBkZWNvclZpZXcuc2V0U3lzdGVtVWlWaXNpYmlsaXR5KFNZU1RFTV9VSV9GTEFHX0xJR0hUX1NUQVRVU19CQVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IFwiZGFya1wiKSB7XG4gICAgICAgICAgICAgICAgd2luZG93XzIuc2V0U3RhdHVzQmFyQ29sb3IoU1RBVFVTX0JBUl9EQVJLX0JDS0cpO1xuICAgICAgICAgICAgICAgIGRlY29yVmlldy5zZXRTeXN0ZW1VaVZpc2liaWxpdHkoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aW5kb3dfMi5zZXRTdGF0dXNCYXJDb2xvcih2YWx1ZS5jb2xvcik7XG4gICAgICAgICAgICAgICAgZGVjb3JWaWV3LnNldFN5c3RlbVVpVmlzaWJpbGl0eSh2YWx1ZS5zeXN0ZW1VaVZpc2liaWxpdHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZVtwYWdlX2NvbW1vbl8xLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uID49IFwiMjFcIikge1xuICAgICAgICAgICAgdmFyIHdpbmRvd18zID0gdGhpcy5fY29udGV4dC5nZXRXaW5kb3coKTtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3dfMy5nZXRTdGF0dXNCYXJDb2xvcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGVbcGFnZV9jb21tb25fMS5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuZGV2aWNlLnNka1ZlcnNpb24gPj0gXCIyMVwiKSB7XG4gICAgICAgICAgICB2YXIgd2luZG93XzQgPSB0aGlzLl9jb250ZXh0LmdldFdpbmRvdygpO1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBwYWdlX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuYW5kcm9pZCA6IHZhbHVlO1xuICAgICAgICAgICAgd2luZG93XzQuc2V0U3RhdHVzQmFyQ29sb3IoY29sb3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2UucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIHJldHVybiBQYWdlO1xufShwYWdlX2NvbW1vbl8xLlBhZ2VCYXNlKSk7XG5leHBvcnRzLlBhZ2UgPSBQYWdlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZS5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIFBsYWNlaG9sZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUGxhY2Vob2xkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUGxhY2Vob2xkZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUGxhY2Vob2xkZXJfMSA9IFBsYWNlaG9sZGVyO1xuICAgIFBsYWNlaG9sZGVyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHsgZXZlbnROYW1lOiBQbGFjZWhvbGRlcl8xLmNyZWF0aW5nVmlld0V2ZW50LCBvYmplY3Q6IHRoaXMsIHZpZXc6IHVuZGVmaW5lZCwgY29udGV4dDogdGhpcy5fY29udGV4dCB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICAgICAgcmV0dXJuIGFyZ3MudmlldztcbiAgICB9O1xuICAgIHZhciBQbGFjZWhvbGRlcl8xO1xuICAgIFBsYWNlaG9sZGVyLmNyZWF0aW5nVmlld0V2ZW50ID0gXCJjcmVhdGluZ1ZpZXdcIjtcbiAgICBQbGFjZWhvbGRlciA9IFBsYWNlaG9sZGVyXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJQbGFjZWhvbGRlclwiKVxuICAgIF0sIFBsYWNlaG9sZGVyKTtcbiAgICByZXR1cm4gUGxhY2Vob2xkZXI7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlBsYWNlaG9sZGVyID0gUGxhY2Vob2xkZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wbGFjZWhvbGRlci5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIFByb2dyZXNzQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByb2dyZXNzQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQcm9ncmVzc0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUHJvZ3Jlc3NCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiUHJvZ3Jlc3NcIilcbiAgICBdLCBQcm9ncmVzc0Jhc2UpO1xuICAgIHJldHVybiBQcm9ncmVzc0Jhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlByb2dyZXNzQmFzZSA9IFByb2dyZXNzQmFzZTtcblByb2dyZXNzQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMudmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidmFsdWVcIixcbiAgICBkZWZhdWx0VmFsdWU6IDAsXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0LCB2KSB7XG4gICAgICAgIHJldHVybiB2IDwgMCA/IDAgOiBNYXRoLm1pbih2LCB0Lm1heFZhbHVlKTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy52YWx1ZVByb3BlcnR5LnJlZ2lzdGVyKFByb2dyZXNzQmFzZSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heFZhbHVlXCIsXG4gICAgZGVmYXVsdFZhbHVlOiAxMDAsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgZXhwb3J0cy52YWx1ZVByb3BlcnR5LmNvZXJjZSh0YXJnZXQpO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkucmVnaXN0ZXIoUHJvZ3Jlc3NCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb2dyZXNzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb2dyZXNzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vcHJvZ3Jlc3MtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vcHJvZ3Jlc3MtY29tbW9uXCIpKTtcbnZhciBSX0FUVFJfUFJPR1JFU1NfQkFSX1NUWUxFX0hPUklaT05UQUwgPSAweDAxMDEwMDc4O1xudmFyIFByb2dyZXNzID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHJvZ3Jlc3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHJvZ3Jlc3MoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW5kcm9pZC53aWRnZXQuUHJvZ3Jlc3NCYXIodGhpcy5fY29udGV4dCwgbnVsbCwgUl9BVFRSX1BST0dSRVNTX0JBUl9TVFlMRV9IT1JJWk9OVEFMKTtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS52YWx1ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS52YWx1ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFByb2dyZXNzKHZhbHVlKTtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5tYXhWYWx1ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTAwO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0TWF4KHZhbHVlKTtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHByb2dyZXNzRHJhd2FibGUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UHJvZ3Jlc3NEcmF3YWJsZSgpO1xuICAgICAgICBpZiAoIXByb2dyZXNzRHJhd2FibGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBwcm9ncmVzc19jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgcHJvZ3Jlc3NEcmF3YWJsZS5zZXRDb2xvckZpbHRlcih2YWx1ZS5hbmRyb2lkLCBhbmRyb2lkLmdyYXBoaWNzLlBvcnRlckR1ZmYuTW9kZS5TUkNfSU4pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvZ3Jlc3NEcmF3YWJsZS5jbGVhckNvbG9yRmlsdGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcHJvZ3Jlc3NEcmF3YWJsZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRQcm9ncmVzc0RyYXdhYmxlKCk7XG4gICAgICAgIGlmICghcHJvZ3Jlc3NEcmF3YWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcm9ncmVzc0RyYXdhYmxlIGluc3RhbmNlb2YgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5MYXllckRyYXdhYmxlICYmIHByb2dyZXNzRHJhd2FibGUuZ2V0TnVtYmVyT2ZMYXllcnMoKSA+IDApIHtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kRHJhd2FibGUgPSBwcm9ncmVzc0RyYXdhYmxlLmdldERyYXdhYmxlKDApO1xuICAgICAgICAgICAgaWYgKGJhY2tncm91bmREcmF3YWJsZSkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHByb2dyZXNzX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmREcmF3YWJsZS5zZXRDb2xvckZpbHRlcih2YWx1ZS5hbmRyb2lkLCBhbmRyb2lkLmdyYXBoaWNzLlBvcnRlckR1ZmYuTW9kZS5TUkNfSU4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZERyYXdhYmxlLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgcmV0dXJuIFByb2dyZXNzO1xufShwcm9ncmVzc19jb21tb25fMS5Qcm9ncmVzc0Jhc2UpKTtcbmV4cG9ydHMuUHJvZ3Jlc3MgPSBQcm9ncmVzcztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb2dyZXNzLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9sYXlvdXQtYmFzZVwiKTtcbnZhciBQcm94eVZpZXdDb250YWluZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQcm94eVZpZXdDb250YWluZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHJveHlWaWV3Q29udGFpbmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVlc3RlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9nZXROYXRpdmVWaWV3c0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjdikge1xuICAgICAgICAgICAgcmVzdWx0ICs9IGN2Ll9nZXROYXRpdmVWaWV3c0NvdW50KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9lYWNoTGF5b3V0VmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoZnVuY3Rpb24gKGN2KSB7XG4gICAgICAgICAgICBpZiAoIWN2LmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgY3YuX2VhY2hMYXlvdXRWaWV3KGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKGxheW91dF9iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGxheW91dF9iYXNlXzEudHJhY2VXcml0ZShcIlZpZXdDb250YWluZXIuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgZm9yIGEgY2hpbGQgXCIgKyBjaGlsZCArIFwiIFZpZXdDb250YWluZXIucGFyZW50OiBcIiArIHRoaXMucGFyZW50LCBsYXlvdXRfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLlZpZXcpIHtcbiAgICAgICAgICAgIHZhciBiYXNlSW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIGluc2lkZUluZGV4ID0gMDtcbiAgICAgICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpIHtcbiAgICAgICAgICAgICAgICBiYXNlSW5kZXggPSBwYXJlbnQuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXgocGFyZW50LmdldENoaWxkSW5kZXgodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc2lkZUluZGV4ID0gdGhpcy5fY2hpbGRJbmRleFRvTmF0aXZlQ2hpbGRJbmRleChhdEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluc2lkZUluZGV4ID0gdGhpcy5fZ2V0TmF0aXZlVmlld3NDb3VudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxheW91dF9iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBsYXlvdXRfYmFzZV8xLnRyYWNlV3JpdGUoXCJQcm94eVZpZXdDb250YWluZXIuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgYXQ6IFwiICsgYXRJbmRleCArIFwiIGJhc2U6IFwiICsgYmFzZUluZGV4ICsgXCIgYWRkaXRpb25hbDogXCIgKyBpbnNpZGVJbmRleCwgbGF5b3V0X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50Ll9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlKGNoaWxkLCBiYXNlSW5kZXggKyBpbnNpZGVJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGlmIChsYXlvdXRfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBsYXlvdXRfYmFzZV8xLnRyYWNlV3JpdGUoXCJQcm94eVZpZXdDb250YWluZXIuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSBmb3IgYSBjaGlsZCBcIiArIGNoaWxkICsgXCIgVmlld0NvbnRhaW5lci5wYXJlbnQ6IFwiICsgdGhpcy5wYXJlbnQsIGxheW91dF9iYXNlXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5WaWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50Ll9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUoY2hpbGQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgcGFyZW50Ll9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZS5fdW5yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgcGFyZW50Ll91bnJlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9wYXJlbnRDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFBhcmVudCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9wYXJlbnRDaGFuZ2VkLmNhbGwodGhpcywgb2xkUGFyZW50KTtcbiAgICAgICAgdmFyIGFkZGluZ1RvUGFyZW50ID0gdGhpcy5wYXJlbnQgJiYgIW9sZFBhcmVudDtcbiAgICAgICAgdmFyIG5ld0xheW91dCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgb2xkTGF5b3V0ID0gb2xkUGFyZW50O1xuICAgICAgICBpZiAoYWRkaW5nVG9QYXJlbnQgJiYgbmV3TGF5b3V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBuZXdMYXlvdXQuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob2xkTGF5b3V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBvbGRMYXlvdXQuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIlByb3h5Vmlld0NvbnRhaW5lclwiKVxuICAgIF0sIFByb3h5Vmlld0NvbnRhaW5lcik7XG4gICAgcmV0dXJuIFByb3h5Vmlld0NvbnRhaW5lcjtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLlByb3h5Vmlld0NvbnRhaW5lciA9IFByb3h5Vmlld0NvbnRhaW5lcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb3h5LXZpZXctY29udGFpbmVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGFiZWxfMSA9IHJlcXVpcmUoXCIuLi9sYWJlbFwiKTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dHMvbGF5b3V0LWJhc2VcIik7XG52YXIgc3RhY2tfbGF5b3V0XzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9zdGFjay1sYXlvdXRcIik7XG52YXIgb2JzZXJ2YWJsZV9hcnJheV8xID0gcmVxdWlyZShcIi4uLy4uL2RhdGEvb2JzZXJ2YWJsZS1hcnJheVwiKTtcbnZhciB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEgPSByZXF1aXJlKFwiLi4vY29yZS93ZWFrLWV2ZW50LWxpc3RlbmVyXCIpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9idWlsZGVyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXRzL2xheW91dC1iYXNlXCIpKTtcbnZhciBrbm93blRlbXBsYXRlcztcbihmdW5jdGlvbiAoa25vd25UZW1wbGF0ZXMpIHtcbiAgICBrbm93blRlbXBsYXRlcy5pdGVtVGVtcGxhdGUgPSBcIml0ZW1UZW1wbGF0ZVwiO1xufSkoa25vd25UZW1wbGF0ZXMgPSBleHBvcnRzLmtub3duVGVtcGxhdGVzIHx8IChleHBvcnRzLmtub3duVGVtcGxhdGVzID0ge30pKTtcbnZhciBSZXBlYXRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFJlcGVhdGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJlcGVhdGVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5faXNEaXJ0eSA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5pdGVtc0xheW91dCA9IG5ldyBzdGFja19sYXlvdXRfMS5TdGFja0xheW91dCgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzRGlydHkpIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5fcmVxdWVzdFJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzRGlydHkgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pdGVtc0xheW91dCkge1xuICAgICAgICAgICAgdGhpcy5pdGVtc0xheW91dC5yZW1vdmVDaGlsZHJlbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHZpZXdUb0FkZCA9IHRoaXMuaXRlbVRlbXBsYXRlID8gYnVpbGRlcl8xLnBhcnNlKHRoaXMuaXRlbVRlbXBsYXRlLCB0aGlzKSA6IHRoaXMuX2dldERlZmF1bHRJdGVtQ29udGVudChpKTtcbiAgICAgICAgICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuX2dldERhdGFJdGVtKGkpO1xuICAgICAgICAgICAgdmlld1RvQWRkLmJpbmRpbmdDb250ZXh0ID0gZGF0YUl0ZW07XG4gICAgICAgICAgICB0aGlzLml0ZW1zTGF5b3V0LmFkZENoaWxkKHZpZXdUb0FkZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNEaXJ0eSA9IGZhbHNlO1xuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLl9vbkl0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RSZWZyZXNoKCk7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUuX2dldERlZmF1bHRJdGVtQ29udGVudCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbGJsID0gbmV3IGxhYmVsXzEuTGFiZWwoKTtcbiAgICAgICAgbGJsLmJpbmQoe1xuICAgICAgICAgICAgdGFyZ2V0UHJvcGVydHk6IFwidGV4dFwiLFxuICAgICAgICAgICAgc291cmNlUHJvcGVydHk6IFwiJHZhbHVlXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsYmw7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUuX2dldERhdGFJdGVtID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIHJldHVybiBpdGVtcy5nZXRJdGVtID8gaXRlbXMuZ2V0SXRlbShpbmRleCkgOiB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXBlYXRlci5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zTGF5b3V0ID8gMSA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zTGF5b3V0KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLml0ZW1zTGF5b3V0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2YXIgaW5zZXRzID0gdGhpcy5nZXRTYWZlQXJlYUluc2V0cygpO1xuICAgICAgICB2YXIgcGFkZGluZ0xlZnQgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyBpbnNldHMubGVmdDtcbiAgICAgICAgdmFyIHBhZGRpbmdUb3AgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgaW5zZXRzLnRvcDtcbiAgICAgICAgdmFyIHBhZGRpbmdSaWdodCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgaW5zZXRzLnJpZ2h0O1xuICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBpbnNldHMuYm90dG9tO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0ID0gcGFkZGluZ0xlZnQ7XG4gICAgICAgIHZhciBjaGlsZFRvcCA9IHBhZGRpbmdUb3A7XG4gICAgICAgIHZhciBjaGlsZFJpZ2h0ID0gcmlnaHQgLSBsZWZ0IC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICB2YXIgY2hpbGRCb3R0b20gPSBib3R0b20gLSB0b3AgLSBwYWRkaW5nQm90dG9tO1xuICAgICAgICBsYXlvdXRfYmFzZV8xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgdGhpcy5pdGVtc0xheW91dCwgY2hpbGRMZWZ0LCBjaGlsZFRvcCwgY2hpbGRSaWdodCwgY2hpbGRCb3R0b20pO1xuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbGF5b3V0X2Jhc2VfMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCB0aGlzLml0ZW1zTGF5b3V0LCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aCA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gbGF5b3V0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBsYXlvdXRfYmFzZV8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShyZXN1bHQubWVhc3VyZWRXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IGxheW91dF9iYXNlXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHJlc3VsdC5tZWFzdXJlZEhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFJlcGVhdGVyLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBSZXBlYXRlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJSZXBlYXRlclwiKVxuICAgIF0sIFJlcGVhdGVyKTtcbiAgICByZXR1cm4gUmVwZWF0ZXI7XG59KGxheW91dF9iYXNlXzEuQ3VzdG9tTGF5b3V0VmlldykpO1xuZXhwb3J0cy5SZXBlYXRlciA9IFJlcGVhdGVyO1xuUmVwZWF0ZXIucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbVRlbXBsYXRlXCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICB0YXJnZXQuX3JlcXVlc3RSZWZyZXNoKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5LnJlZ2lzdGVyKFJlcGVhdGVyKTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChvbGRWYWx1ZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkpIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5yZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihvbGRWYWx1ZSwgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgdGFyZ2V0Ll9vbkl0ZW1zQ2hhbmdlZCwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VmFsdWUgaW5zdGFuY2VvZiBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KSB7XG4gICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIobmV3VmFsdWUsIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIHRhcmdldC5fb25JdGVtc0NoYW5nZWQsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0Ll9yZXF1ZXN0UmVmcmVzaCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFJlcGVhdGVyKTtcbmV4cG9ydHMuaXRlbXNMYXlvdXRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zTGF5b3V0XCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChvbGRWYWx1ZSkge1xuICAgICAgICAgICAgdGFyZ2V0Ll9yZW1vdmVWaWV3KG9sZFZhbHVlKTtcbiAgICAgICAgICAgIG9sZFZhbHVlLnJlbW92ZUNoaWxkcmVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0YXJnZXQuX2FkZFZpZXcobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldC5fcmVxdWVzdFJlZnJlc2goKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNMYXlvdXRQcm9wZXJ0eS5yZWdpc3RlcihSZXBlYXRlcik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXBlYXRlci5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbnRlbnRfdmlld18xID0gcmVxdWlyZShcIi4uL2NvbnRlbnQtdmlld1wiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpKTtcbnZhciBTY3JvbGxWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNjcm9sbFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNjcm9sbFZpZXdCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Njcm9sbENoYW5nZUNvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTY3JvbGxWaWV3QmFzZV8xID0gU2Nyb2xsVmlld0Jhc2U7XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYXJnLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgaWYgKGFyZyA9PT0gU2Nyb2xsVmlld0Jhc2VfMS5zY3JvbGxFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQrKztcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwodGhpcywgYXJnLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgIGlmIChhcmcgPT09IFNjcm9sbFZpZXdCYXNlXzEuc2Nyb2xsRXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njcm9sbENoYW5nZUNvdW50LS07XG4gICAgICAgICAgICB0aGlzLmRldHRhY2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0YWNoKCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGV0dGFjaCgpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmF0dGFjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbENoYW5nZUNvdW50ID4gMCAmJiB0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaE5hdGl2ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuZGV0dGFjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbENoYW5nZUNvdW50ID09PSAwICYmIHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGV0dGFjaE5hdGl2ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuYXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmRldHRhY2hOYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcImhvcml6b250YWxPZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcInZlcnRpY2FsT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZSwgXCJzY3JvbGxhYmxlV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcInNjcm9sbGFibGVIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICB2YXIgU2Nyb2xsVmlld0Jhc2VfMTtcbiAgICBTY3JvbGxWaWV3QmFzZS5zY3JvbGxFdmVudCA9IFwic2Nyb2xsXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgU2Nyb2xsVmlld0Jhc2UgPSBTY3JvbGxWaWV3QmFzZV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvbnRlbnRfdmlld18xLkNTU1R5cGUoXCJTY3JvbGxWaWV3XCIpXG4gICAgXSwgU2Nyb2xsVmlld0Jhc2UpO1xuICAgIHJldHVybiBTY3JvbGxWaWV3QmFzZTtcbn0oY29udGVudF92aWV3XzEuQ29udGVudFZpZXcpKTtcbmV4cG9ydHMuU2Nyb2xsVmlld0Jhc2UgPSBTY3JvbGxWaWV3QmFzZTtcbnZhciBjb252ZXJ0ZXIgPSBjb250ZW50X3ZpZXdfMS5tYWtlUGFyc2VyKGNvbnRlbnRfdmlld18xLm1ha2VWYWxpZGF0b3IoXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIikpO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm9yaWVudGF0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJ2ZXJ0aWNhbFwiLCBhZmZlY3RzTGF5b3V0OiB0cnVlLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5fb25PcmllbnRhdGlvbkNoYW5nZWQoKTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBjb252ZXJ0ZXJcbn0pO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbmV4cG9ydHMuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNjcm9sbEJhckluZGljYXRvclZpc2libGVcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbmV4cG9ydHMuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXNTY3JvbGxFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogY29udGVudF92aWV3XzEuYm9vbGVhbkNvbnZlcnRlclxufSk7XG5leHBvcnRzLmlzU2Nyb2xsRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNjcm9sbC12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNjcm9sbF92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc2Nyb2xsLXZpZXctY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc2Nyb2xsLXZpZXctY29tbW9uXCIpKTtcbnZhciBTY3JvbGxWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2Nyb2xsVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTY3JvbGxWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuZHJvaWRWaWV3SWQgPSAtMTtcbiAgICAgICAgX3RoaXMuX2xhc3RTY3JvbGxYID0gLTE7XG4gICAgICAgIF90aGlzLl9sYXN0U2Nyb2xsWSA9IC0xO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3LnByb3RvdHlwZSwgXCJob3Jpem9udGFsT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZ2V0U2Nyb2xsWCgpIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3LnByb3RvdHlwZSwgXCJ2ZXJ0aWNhbE9mZnNldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVWaWV3LmdldFNjcm9sbFkoKSAvIHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlldy5wcm90b3R5cGUsIFwic2Nyb2xsYWJsZVdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghbmF0aXZlVmlldyB8fCB0aGlzLm9yaWVudGF0aW9uICE9PSBcImhvcml6b250YWxcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZ2V0U2Nyb2xsYWJsZUxlbmd0aCgpIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3LnByb3RvdHlwZSwgXCJzY3JvbGxhYmxlSGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmICghbmF0aXZlVmlldyB8fCB0aGlzLm9yaWVudGF0aW9uICE9PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVWaWV3LmdldFNjcm9sbGFibGVMZW5ndGgoKSAvIHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDbGlja2FibGUodmFsdWUpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Rm9jdXNhYmxlKHZhbHVlKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFNjcm9sbEVuYWJsZWQodmFsdWUpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGVbc2Nyb2xsX3ZpZXdfY29tbW9uXzEuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0U2Nyb2xsRW5hYmxlZCgpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGVbc2Nyb2xsX3ZpZXdfY29tbW9uXzEuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0U2Nyb2xsRW5hYmxlZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5zY3JvbGxCYXJJbmRpY2F0b3JWaXNpYmxlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGVbc2Nyb2xsX3ZpZXdfY29tbW9uXzEuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0SG9yaXpvbnRhbFNjcm9sbEJhckVuYWJsZWQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZlcnRpY2FsU2Nyb2xsQmFyRW5hYmxlZCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLnNjcm9sbFRvVmVydGljYWxPZmZzZXQgPSBmdW5jdGlvbiAodmFsdWUsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyAmJiB0aGlzLm9yaWVudGF0aW9uID09PSBcInZlcnRpY2FsXCIgJiYgdGhpcy5pc1Njcm9sbEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHZhbHVlICo9IHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGVkKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zbW9vdGhTY3JvbGxUbygwLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNjcm9sbFRvKDAsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuc2Nyb2xsVG9Ib3Jpem9udGFsT2Zmc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBhbmltYXRlZCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcgJiYgdGhpcy5vcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIgJiYgdGhpcy5pc1Njcm9sbEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHZhbHVlICo9IHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGVkKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zbW9vdGhTY3JvbGxUbyh2YWx1ZSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNjcm9sbFRvKHZhbHVlLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiID8gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Ib3Jpem9udGFsU2Nyb2xsVmlldyh0aGlzLl9jb250ZXh0KSA6IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmVydGljYWxTY3JvbGxWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuX2FuZHJvaWRWaWV3SWQgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlld0lkID0gYW5kcm9pZC52aWV3LlZpZXcuZ2VuZXJhdGVWaWV3SWQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0SWQodGhpcy5fYW5kcm9pZFZpZXdJZCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5fb25PcmllbnRhdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgaWYgKHBhcmVudF8xKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50XzEuX3JlbW92ZVZpZXcodGhpcyk7XG4gICAgICAgICAgICAgICAgcGFyZW50XzEuX2FkZFZpZXcodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLmF0dGFjaE5hdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSBuZXcgV2Vha1JlZih0aGlzKTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gbmV3IGFuZHJvaWQudmlldy5WaWV3VHJlZU9ic2VydmVyLk9uU2Nyb2xsQ2hhbmdlZExpc3RlbmVyKHtcbiAgICAgICAgICAgIG9uU2Nyb2xsQ2hhbmdlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvd25lciA9IHRoYXQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLl9vblNjcm9sbENoYW5nZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Vmlld1RyZWVPYnNlcnZlcigpLmFkZE9uU2Nyb2xsQ2hhbmdlZExpc3RlbmVyKHRoaXMuaGFuZGxlcik7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5fb25TY3JvbGxDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHZhciBuZXdTY3JvbGxYID0gbmF0aXZlVmlldy5nZXRTY3JvbGxYKCk7XG4gICAgICAgICAgICB2YXIgbmV3U2Nyb2xsWSA9IG5hdGl2ZVZpZXcuZ2V0U2Nyb2xsWSgpO1xuICAgICAgICAgICAgaWYgKG5ld1Njcm9sbFggIT09IHRoaXMuX2xhc3RTY3JvbGxYIHx8IG5ld1Njcm9sbFkgIT09IHRoaXMuX2xhc3RTY3JvbGxZKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoe1xuICAgICAgICAgICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogU2Nyb2xsVmlldy5zY3JvbGxFdmVudCxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsWDogbmV3U2Nyb2xsWCAvIHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpLFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxZOiBuZXdTY3JvbGxZIC8gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0U2Nyb2xsWCA9IG5ld1Njcm9sbFg7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFNjcm9sbFkgPSBuZXdTY3JvbGxZO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5kZXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Vmlld1RyZWVPYnNlcnZlcigpLnJlbW92ZU9uU2Nyb2xsQ2hhbmdlZExpc3RlbmVyKHRoaXMuaGFuZGxlcik7XG4gICAgICAgIHRoaXMuaGFuZGxlciA9IG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gU2Nyb2xsVmlldztcbn0oc2Nyb2xsX3ZpZXdfY29tbW9uXzEuU2Nyb2xsVmlld0Jhc2UpKTtcbmV4cG9ydHMuU2Nyb2xsVmlldyA9IFNjcm9sbFZpZXc7XG5TY3JvbGxWaWV3LnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwibmV2ZXJcIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNjcm9sbC12aWV3LmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgU2VhcmNoQmFyQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlYXJjaEJhckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VhcmNoQmFyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTZWFyY2hCYXJCYXNlLnN1Ym1pdEV2ZW50ID0gXCJzdWJtaXRcIjtcbiAgICBTZWFyY2hCYXJCYXNlLmNsZWFyRXZlbnQgPSBcImNsZWFyXCI7XG4gICAgU2VhcmNoQmFyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlNlYXJjaEJhclwiKVxuICAgIF0sIFNlYXJjaEJhckJhc2UpO1xuICAgIHJldHVybiBTZWFyY2hCYXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5TZWFyY2hCYXJCYXNlID0gU2VhcmNoQmFyQmFzZTtcblNlYXJjaEJhckJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLnRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRcIiwgZGVmYXVsdFZhbHVlOiBcIlwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MgfSk7XG5leHBvcnRzLnRleHRQcm9wZXJ0eS5yZWdpc3RlcihTZWFyY2hCYXJCYXNlKTtcbmV4cG9ydHMuaGludFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaGludFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIgfSk7XG5leHBvcnRzLmhpbnRQcm9wZXJ0eS5yZWdpc3RlcihTZWFyY2hCYXJCYXNlKTtcbmV4cG9ydHMudGV4dEZpZWxkSGludENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJ0ZXh0RmllbGRIaW50Q29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eS5yZWdpc3RlcihTZWFyY2hCYXJCYXNlKTtcbmV4cG9ydHMudGV4dEZpZWxkQmFja2dyb3VuZENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJ0ZXh0RmllbGRCYWNrZ3JvdW5kQ29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy50ZXh0RmllbGRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3RlcihTZWFyY2hCYXJCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlYXJjaC1iYXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvZm9udFwiKTtcbnZhciBzZWFyY2hfYmFyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc2VhcmNoLWJhci1jb21tb25cIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3NlYXJjaC1iYXItY29tbW9uXCIpKTtcbnZhciBTRUFSQ0hURVhUID0gU3ltYm9sKFwic2VhcmNoVGV4dFwiKTtcbnZhciBRVUVSWSA9IFN5bWJvbChcInF1ZXJ5XCIpO1xudmFyIFF1ZXJ5VGV4dExpc3RlbmVyO1xudmFyIENsb3NlTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpIHtcbiAgICBpZiAoUXVlcnlUZXh0TGlzdGVuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbC5wcm90b3R5cGUub25RdWVyeVRleHRDaGFuZ2UgPSBmdW5jdGlvbiAobmV3VGV4dCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIHNlYXJjaF9iYXJfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBuZXdUZXh0KTtcbiAgICAgICAgICAgIGlmIChuZXdUZXh0ID09PSBcIlwiICYmIHRoaXNbU0VBUkNIVEVYVF0gIT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICBvd25lci5fZW1pdChzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzW1NFQVJDSFRFWFRdID0gbmV3VGV4dDtcbiAgICAgICAgICAgIHRoaXNbUVVFUlldID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbC5wcm90b3R5cGUub25RdWVyeVRleHRTdWJtaXQgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBpZiAocXVlcnkgIT09IFwiXCIgJiYgdGhpc1tRVUVSWV0gIT09IHF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX2VtaXQoc2VhcmNoX2Jhcl9jb21tb25fMS5TZWFyY2hCYXJCYXNlLnN1Ym1pdEV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXNbUVVFUlldID0gcXVlcnk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcGF0UXVlcnlUZXh0TGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlNlYXJjaFZpZXcuT25RdWVyeVRleHRMaXN0ZW5lcl0pXG4gICAgICAgIF0sIENvbXBhdFF1ZXJ5VGV4dExpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBDb21wYXRRdWVyeVRleHRMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgdmFyIENvbXBhdENsb3NlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENvbXBhdENsb3NlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBDb21wYXRDbG9zZUxpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBDb21wYXRDbG9zZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25DbG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMub3duZXIuX2VtaXQoc2VhcmNoX2Jhcl9jb21tb25fMS5TZWFyY2hCYXJCYXNlLmNsZWFyRXZlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBhdENsb3NlTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkeC5hcHBjb21wYXQud2lkZ2V0LlNlYXJjaFZpZXcuT25DbG9zZUxpc3RlbmVyXSlcbiAgICAgICAgXSwgQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gQ29tcGF0Q2xvc2VMaXN0ZW5lckltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgUXVlcnlUZXh0TGlzdGVuZXIgPSBDb21wYXRRdWVyeVRleHRMaXN0ZW5lckltcGw7XG4gICAgQ2xvc2VMaXN0ZW5lciA9IENvbXBhdENsb3NlTGlzdGVuZXJJbXBsO1xufVxuZnVuY3Rpb24gZW5hYmxlU2VhcmNoVmlldyhuYXRpdmVWaWV3LCB2YWx1ZSkge1xuICAgIG5hdGl2ZVZpZXcuc2V0RW5hYmxlZCh2YWx1ZSk7XG4gICAgaWYgKCEobmF0aXZlVmlldyBpbnN0YW5jZW9mIGFuZHJvaWQudmlldy5WaWV3R3JvdXApKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYXRpdmVWaWV3LmdldENoaWxkQ291bnQoKTsgaSsrKSB7XG4gICAgICAgIHZhciBjaGlsZCA9IG5hdGl2ZVZpZXcuZ2V0Q2hpbGRBdChpKTtcbiAgICAgICAgZW5hYmxlU2VhcmNoVmlldyhjaGlsZCwgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGVuYWJsZVVzZXJJbnRlcmFjdGlvblNlYXJjaFZpZXcobmF0aXZlVmlldywgdmFsdWUpIHtcbiAgICBuYXRpdmVWaWV3LnNldENsaWNrYWJsZSh2YWx1ZSk7XG4gICAgbmF0aXZlVmlldy5zZXRGb2N1c2FibGUodmFsdWUpO1xuICAgIGlmICghKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkLnZpZXcuVmlld0dyb3VwKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmF0aXZlVmlldy5nZXRDaGlsZENvdW50KCk7IGkrKykge1xuICAgICAgICB2YXIgY2hpbGQgPSBuYXRpdmVWaWV3LmdldENoaWxkQXQoaSk7XG4gICAgICAgIGVuYWJsZVVzZXJJbnRlcmFjdGlvblNlYXJjaFZpZXcoY2hpbGQsIHZhbHVlKTtcbiAgICB9XG59XG52YXIgU2VhcmNoQmFyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VhcmNoQmFyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlYXJjaEJhcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLmRpc21pc3NTb2Z0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHV0aWxzXzEuYWQuZGlzbWlzc1NvZnRJbnB1dCh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IF9zdXBlci5wcm90b3R5cGUuZm9jdXMuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdXRpbHNfMS5hZC5zaG93U29mdElucHV0KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBuZXcgYW5kcm9pZHguYXBwY29tcGF0LndpZGdldC5TZWFyY2hWaWV3KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEljb25pZmllZChmYWxzZSk7XG4gICAgICAgIHJldHVybiBuYXRpdmVWaWV3O1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKTtcbiAgICAgICAgdmFyIHF1ZXJ5VGV4dExpc3RlbmVyID0gbmV3IFF1ZXJ5VGV4dExpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uUXVlcnlUZXh0TGlzdGVuZXIocXVlcnlUZXh0TGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LnF1ZXJ5VGV4dExpc3RlbmVyID0gcXVlcnlUZXh0TGlzdGVuZXI7XG4gICAgICAgIHZhciBjbG9zZUxpc3RlbmVyID0gbmV3IENsb3NlTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25DbG9zZUxpc3RlbmVyKGNsb3NlTGlzdGVuZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LmNsb3NlTGlzdGVuZXIgPSBjbG9zZUxpc3RlbmVyO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuY2xvc2VMaXN0ZW5lci5vd25lciA9IG51bGw7XG4gICAgICAgIG5hdGl2ZVZpZXcucXVlcnlUZXh0TGlzdGVuZXIub3duZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9zZWFyY2hQbGF0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NlYXJjaFRleHRWaWV3ID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmlzRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgZW5hYmxlU2VhcmNoVmlldyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGVuYWJsZVVzZXJJbnRlcmFjdGlvblNlYXJjaFZpZXcodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0RHJhd2luZ0NhY2hlQmFja2dyb3VuZENvbG9yKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3I7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIGNvbG9yID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb2xvciA9IHZhbHVlLmFuZHJvaWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEJhY2tncm91bmRDb2xvcihjb2xvcik7XG4gICAgICAgIHZhciBzZWFyY2hQbGF0ZSA9IHRoaXMuX2dldFNlYXJjaFBsYXRlKCk7XG4gICAgICAgIHNlYXJjaFBsYXRlLnNldEJhY2tncm91bmRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRleHRWaWV3ID0gdGhpcy5fZ2V0VGV4dFZpZXcoKTtcbiAgICAgICAgcmV0dXJuIHRleHRWaWV3LmdldEN1cnJlbnRUZXh0Q29sb3IoKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikgPyB2YWx1ZSA6IHZhbHVlLmFuZHJvaWQ7XG4gICAgICAgIHZhciB0ZXh0VmlldyA9IHRoaXMuX2dldFRleHRWaWV3KCk7XG4gICAgICAgIHRleHRWaWV3LnNldFRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbmF0aXZlU2l6ZTogdGhpcy5fZ2V0VGV4dFZpZXcoKS5nZXRUZXh0U2l6ZSgpIH07XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX2dldFRleHRWaWV3KCkuc2V0VGV4dFNpemUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZ2V0VGV4dFZpZXcoKS5zZXRUZXh0U2l6ZShhbmRyb2lkLnV0aWwuVHlwZWRWYWx1ZS5DT01QTEVYX1VOSVRfUFgsIHZhbHVlLm5hdGl2ZVNpemUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRUZXh0VmlldygpLmdldFR5cGVmYWNlKCk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9nZXRUZXh0VmlldygpLnNldFR5cGVmYWNlKHZhbHVlIGluc3RhbmNlb2YgZm9udF8xLkZvbnQgPyB2YWx1ZS5nZXRBbmRyb2lkVHlwZWZhY2UoKSA6IHZhbHVlKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEudGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHRleHQgPSAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFF1ZXJ5KHRleHQsIGZhbHNlKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5oaW50UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0UXVlcnlIaW50KG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFF1ZXJ5SGludCh2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGV4dFZpZXcgPSB0aGlzLl9nZXRUZXh0VmlldygpO1xuICAgICAgICByZXR1cm4gdGV4dFZpZXcuZ2V0QmFja2dyb3VuZCgpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHRleHRWaWV3ID0gdGhpcy5fZ2V0VGV4dFZpZXcoKTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc2VhcmNoX2Jhcl9jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgdGV4dFZpZXcuc2V0QmFja2dyb3VuZENvbG9yKHZhbHVlLmFuZHJvaWQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGV4dFZpZXcuc2V0QmFja2dyb3VuZCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRleHRWaWV3ID0gdGhpcy5fZ2V0VGV4dFZpZXcoKTtcbiAgICAgICAgcmV0dXJuIHRleHRWaWV3LmdldEN1cnJlbnRUZXh0Q29sb3IoKTtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB0ZXh0VmlldyA9IHRoaXMuX2dldFRleHRWaWV3KCk7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2Ygc2VhcmNoX2Jhcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGV4dFZpZXcuc2V0SGludFRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLl9nZXRUZXh0VmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9zZWFyY2hUZXh0Vmlldykge1xuICAgICAgICAgICAgdmFyIHBrZ05hbWUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q29udGV4dCgpLmdldFBhY2thZ2VOYW1lKCk7XG4gICAgICAgICAgICB2YXIgaWQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0Q29udGV4dCgpLmdldFJlc291cmNlcygpLmdldElkZW50aWZpZXIoXCJzZWFyY2hfc3JjX3RleHRcIiwgXCJpZFwiLCBwa2dOYW1lKTtcbiAgICAgICAgICAgIHRoaXMuX3NlYXJjaFRleHRWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmZpbmRWaWV3QnlJZChpZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlYXJjaFRleHRWaWV3O1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5fZ2V0U2VhcmNoUGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fc2VhcmNoUGxhdGUpIHtcbiAgICAgICAgICAgIHZhciBwa2dOYW1lID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldENvbnRleHQoKS5nZXRQYWNrYWdlTmFtZSgpO1xuICAgICAgICAgICAgdmFyIGlkID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldENvbnRleHQoKS5nZXRSZXNvdXJjZXMoKS5nZXRJZGVudGlmaWVyKFwic2VhcmNoX3BsYXRlXCIsIFwiaWRcIiwgcGtnTmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9zZWFyY2hQbGF0ZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5maW5kVmlld0J5SWQoaWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9zZWFyY2hQbGF0ZTtcbiAgICB9O1xuICAgIHJldHVybiBTZWFyY2hCYXI7XG59KHNlYXJjaF9iYXJfY29tbW9uXzEuU2VhcmNoQmFyQmFzZSkpO1xuZXhwb3J0cy5TZWFyY2hCYXIgPSBTZWFyY2hCYXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZWFyY2gtYmFyLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuaXRlbXMgPSBcIml0ZW1zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIFNlZ21lbnRlZEJhckl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VnbWVudGVkQmFySXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VnbWVudGVkQmFySXRlbUJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fdGl0bGUgPSBcIlwiO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWdtZW50ZWRCYXJJdGVtQmFzZS5wcm90b3R5cGUsIFwidGl0bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aXRsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBzdHJWYWx1ZSA9ICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiBcIlwiO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlICE9PSBzdHJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlID0gc3RyVmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNlZ21lbnRlZEJhckl0ZW1CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VnbWVudGVkQmFySXRlbVwiKVxuICAgIF0sIFNlZ21lbnRlZEJhckl0ZW1CYXNlKTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFySXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5TZWdtZW50ZWRCYXJJdGVtQmFzZSA9IFNlZ21lbnRlZEJhckl0ZW1CYXNlO1xudmFyIFNlZ21lbnRlZEJhckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWdtZW50ZWRCYXJCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlZ21lbnRlZEJhckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlZ21lbnRlZEJhckJhc2UucHJvdG90eXBlLCBcInNlbGVjdGVkQmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zZWxlY3RlZEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJCYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJTZWdtZW50ZWRCYXJJdGVtXCIpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdmFsdWU7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgaWYgKCFpdGVtcykge1xuICAgICAgICAgICAgICAgIGl0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tleHBvcnRzLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXShpdGVtcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckJhc2UucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IG9sZEl0ZW1zLmxlbmd0aDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KG9sZEl0ZW1zW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IG5ld0l0ZW1zLmxlbmd0aDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KG5ld0l0ZW1zW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckJhc2Uuc2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudCA9IFwic2VsZWN0ZWRJbmRleENoYW5nZWRcIjtcbiAgICBTZWdtZW50ZWRCYXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VnbWVudGVkQmFyXCIpXG4gICAgXSwgU2VnbWVudGVkQmFyQmFzZSk7XG4gICAgcmV0dXJuIFNlZ21lbnRlZEJhckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlNlZ21lbnRlZEJhckJhc2UgPSBTZWdtZW50ZWRCYXJCYXNlO1xuU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm5vdGlmeSh7IGV2ZW50TmFtZTogU2VnbWVudGVkQmFyQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50LCBvYmplY3Q6IHRhcmdldCwgb2xkSW5kZXg6IG9sZFZhbHVlLCBuZXdJbmRleDogbmV3VmFsdWUgfSk7XG4gICAgfSxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGFyZ2V0Lml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSBpdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnJlZ2lzdGVyKFNlZ21lbnRlZEJhckJhc2UpO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtc1wiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25JdGVtc0NoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihTZWdtZW50ZWRCYXJCYXNlKTtcbmV4cG9ydHMuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoeyBuYW1lOiBcInNlbGVjdGVkQmFja2dyb3VuZENvbG9yXCIsIGNzc05hbWU6IFwic2VsZWN0ZWQtYmFja2dyb3VuZC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnNlbGVjdGVkQmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlZ21lbnRlZC1iYXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvZm9udFwiKTtcbnZhciBzZWdtZW50ZWRfYmFyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc2VnbWVudGVkLWJhci1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zZWdtZW50ZWQtYmFyLWNvbW1vblwiKSk7XG52YXIgUl9JRF9UQUJTID0gMHgwMTAyMDAxMztcbnZhciBSX0lEX1RBQkNPTlRFTlQgPSAweDAxMDIwMDExO1xudmFyIFJfQVRUUl9TVEFURV9TRUxFQ1RFRCA9IDB4MDEwMTAwYTE7XG52YXIgVElUTEVfVEVYVF9WSUVXX0lEID0gMTY5MDgzMTA7XG52YXIgYXBpTGV2ZWw7XG52YXIgc2VsZWN0ZWRJbmRpY2F0b3JUaGlja25lc3M7XG52YXIgVGFiSG9zdDtcbnZhciBUYWJDaGFuZ2VMaXN0ZW5lcjtcbnZhciBUYWJDb250ZW50RmFjdG9yeTtcbmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCkge1xuICAgIGlmIChUYWJDaGFuZ2VMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGFwaUxldmVsID0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQ7XG4gICAgc2VsZWN0ZWRJbmRpY2F0b3JUaGlja25lc3MgPSBzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhhcGlMZXZlbCA+PSAyMSA/IDIgOiA1KTtcbiAgICB2YXIgVGFiQ2hhbmdlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYkNoYW5nZUxpc3RlbmVySW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVGFiQ2hhbmdlTGlzdGVuZXJJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkNoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25UYWJDaGFuZ2VkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyLnNob3VsZENoYW5nZVNlbGVjdGVkSW5kZXgoKSkge1xuICAgICAgICAgICAgICAgIG93bmVyLnNlbGVjdGVkSW5kZXggPSBwYXJzZUludChpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhYkNoYW5nZUxpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC53aWRnZXQuVGFiSG9zdC5PblRhYkNoYW5nZUxpc3RlbmVyXSlcbiAgICAgICAgXSwgVGFiQ2hhbmdlTGlzdGVuZXJJbXBsKTtcbiAgICAgICAgcmV0dXJuIFRhYkNoYW5nZUxpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICB2YXIgVGFiQ29udGVudEZhY3RvcnlJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRhYkNvbnRlbnRGYWN0b3J5SW1wbCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVGFiQ29udGVudEZhY3RvcnlJbXBsKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkNvbnRlbnRGYWN0b3J5SW1wbC5wcm90b3R5cGUuY3JlYXRlVGFiQ29udGVudCA9IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgICAgIHZhciB0diA9IG5ldyBhbmRyb2lkLndpZGdldC5UZXh0Vmlldyh0aGlzLm93bmVyLl9jb250ZXh0KTtcbiAgICAgICAgICAgIHR2LnNldFZpc2liaWxpdHkoYW5kcm9pZC52aWV3LlZpZXcuR09ORSk7XG4gICAgICAgICAgICB0di5zZXRNYXhMaW5lcygxKTtcbiAgICAgICAgICAgIHR2LnNldEVsbGlwc2l6ZShhbmRyb2lkLnRleHQuVGV4dFV0aWxzLlRydW5jYXRlQXQuRU5EKTtcbiAgICAgICAgICAgIHJldHVybiB0djtcbiAgICAgICAgfTtcbiAgICAgICAgVGFiQ29udGVudEZhY3RvcnlJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5UYWJIb3N0LlRhYkNvbnRlbnRGYWN0b3J5XSlcbiAgICAgICAgXSwgVGFiQ29udGVudEZhY3RvcnlJbXBsKTtcbiAgICAgICAgcmV0dXJuIFRhYkNvbnRlbnRGYWN0b3J5SW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICB2YXIgVGFiSG9zdEltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVGFiSG9zdEltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRhYkhvc3RJbXBsKGNvbnRleHQsIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjb250ZXh0LCBhdHRycykgfHwgdGhpcztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkhvc3RJbXBsLnByb3RvdHlwZS5vbkF0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUYWJIb3N0SW1wbDtcbiAgICB9KGFuZHJvaWQud2lkZ2V0LlRhYkhvc3QpKTtcbiAgICBUYWJIb3N0ID0gVGFiSG9zdEltcGw7XG4gICAgVGFiQ2hhbmdlTGlzdGVuZXIgPSBUYWJDaGFuZ2VMaXN0ZW5lckltcGw7XG4gICAgVGFiQ29udGVudEZhY3RvcnkgPSBUYWJDb250ZW50RmFjdG9yeUltcGw7XG59XG52YXIgU2VnbWVudGVkQmFySXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlZ21lbnRlZEJhckl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VnbWVudGVkQmFySXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTZWdtZW50ZWRCYXJJdGVtLnByb3RvdHlwZS5zZXR1cE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAodGFiSW5kZXgpIHtcbiAgICAgICAgdmFyIHRpdGxlVGV4dFZpZXcgPSB0aGlzLnBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRhYldpZGdldCgpLmdldENoaWxkQXQodGFiSW5kZXgpLmZpbmRWaWV3QnlJZChUSVRMRV9URVhUX1ZJRVdfSUQpO1xuICAgICAgICB0aGlzLnNldE5hdGl2ZVZpZXcodGl0bGVUZXh0Vmlldyk7XG4gICAgICAgIGlmICh0aXRsZVRleHRWaWV3KSB7XG4gICAgICAgICAgICBpZiAodGhpcy50aXRsZURpcnR5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlLl91cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0diA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHR2KSB7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSB0aGlzLnRpdGxlO1xuICAgICAgICAgICAgdGl0bGUgPSAodGl0bGUgPT09IG51bGwgfHwgdGl0bGUgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdGl0bGU7XG4gICAgICAgICAgICB0di5zZXRUZXh0KHRpdGxlKTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVEaXJ0eSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZURpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldEN1cnJlbnRUZXh0Q29sb3IoKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2Ygc2VnbWVudGVkX2Jhcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmFuZHJvaWQgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJJdGVtLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLmZvbnRTaXplUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IG5hdGl2ZVNpemU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUZXh0U2l6ZSgpIH07XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJJdGVtLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLmZvbnRTaXplUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dFNpemUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRTaXplKGFuZHJvaWQudXRpbC5UeXBlZFZhbHVlLkNPTVBMRVhfVU5JVF9QWCwgdmFsdWUubmF0aXZlU2l6ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VHlwZWZhY2UoKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VHlwZWZhY2UodmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCA/IHZhbHVlLmdldEFuZHJvaWRUeXBlZmFjZSgpIDogdmFsdWUpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5zZWxlY3RlZEJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlld0dyb3VwID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFBhcmVudCgpO1xuICAgICAgICByZXR1cm4gdmlld0dyb3VwLmdldEJhY2tncm91bmQoKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckl0ZW0ucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgdmlld0dyb3VwID0gbmF0aXZlVmlldy5nZXRQYXJlbnQoKTtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc2VnbWVudGVkX2Jhcl9jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUuYW5kcm9pZDtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kRHJhd2FibGUgPSB2aWV3R3JvdXAuZ2V0QmFja2dyb3VuZCgpO1xuICAgICAgICAgICAgaWYgKGFwaUxldmVsID4gMjEgJiYgYmFja2dyb3VuZERyYXdhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld0RyYXdhYmxlID0gdHJ5Q2xvbmVEcmF3YWJsZShiYWNrZ3JvdW5kRHJhd2FibGUsIG5hdGl2ZVZpZXcuZ2V0UmVzb3VyY2VzKCkpO1xuICAgICAgICAgICAgICAgIG5ld0RyYXdhYmxlLnNldENvbG9yRmlsdGVyKGNvbG9yLCBhbmRyb2lkLmdyYXBoaWNzLlBvcnRlckR1ZmYuTW9kZS5TUkNfSU4pO1xuICAgICAgICAgICAgICAgIHZpZXdHcm91cC5zZXRCYWNrZ3JvdW5kKG5ld0RyYXdhYmxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZURyYXdhYmxlID0gbmV3IGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuU3RhdGVMaXN0RHJhd2FibGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgY29sb3JEcmF3YWJsZSA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuU2VnbWVudGVkQmFyQ29sb3JEcmF3YWJsZShjb2xvciwgc2VsZWN0ZWRJbmRpY2F0b3JUaGlja25lc3MpO1xuICAgICAgICAgICAgICAgIHZhciBhcnIgPSBBcnJheS5jcmVhdGUoXCJpbnRcIiwgMSk7XG4gICAgICAgICAgICAgICAgYXJyWzBdID0gUl9BVFRSX1NUQVRFX1NFTEVDVEVEO1xuICAgICAgICAgICAgICAgIHN0YXRlRHJhd2FibGUuYWRkU3RhdGUoYXJyLCBjb2xvckRyYXdhYmxlKTtcbiAgICAgICAgICAgICAgICBzdGF0ZURyYXdhYmxlLnNldEJvdW5kcygwLCAxNSwgdmlld0dyb3VwLmdldFJpZ2h0KCksIHZpZXdHcm91cC5nZXRCb3R0b20oKSk7XG4gICAgICAgICAgICAgICAgdmlld0dyb3VwLnNldEJhY2tncm91bmQoc3RhdGVEcmF3YWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgYmFja2dyb3VuZERyYXdhYmxlID0gdHJ5Q2xvbmVEcmF3YWJsZSh2YWx1ZSwgbmF0aXZlVmlldy5nZXRSZXNvdXJjZXMoKSk7XG4gICAgICAgICAgICB2aWV3R3JvdXAuc2V0QmFja2dyb3VuZChiYWNrZ3JvdW5kRHJhd2FibGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFySXRlbTtcbn0oc2VnbWVudGVkX2Jhcl9jb21tb25fMS5TZWdtZW50ZWRCYXJJdGVtQmFzZSkpO1xuZXhwb3J0cy5TZWdtZW50ZWRCYXJJdGVtID0gU2VnbWVudGVkQmFySXRlbTtcbmZ1bmN0aW9uIHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHJlc291cmNlcykge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29uc3RhbnRTdGF0ZSA9IHZhbHVlLmdldENvbnN0YW50U3RhdGUoKTtcbiAgICAgICAgaWYgKGNvbnN0YW50U3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25zdGFudFN0YXRlLm5ld0RyYXdhYmxlKHJlc291cmNlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxudmFyIFNlZ21lbnRlZEJhciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlZ21lbnRlZEJhciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWdtZW50ZWRCYXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZS5zaG91bGRDaGFuZ2VTZWxlY3RlZEluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuX2FkZGluZ1RhYjtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKTtcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBUYWJIb3N0KGNvbnRleHQsIG51bGwpO1xuICAgICAgICB2YXIgdGFiSG9zdExheW91dCA9IG5ldyBhbmRyb2lkLndpZGdldC5MaW5lYXJMYXlvdXQoY29udGV4dCk7XG4gICAgICAgIHRhYkhvc3RMYXlvdXQuc2V0T3JpZW50YXRpb24oYW5kcm9pZC53aWRnZXQuTGluZWFyTGF5b3V0LlZFUlRJQ0FMKTtcbiAgICAgICAgdmFyIHRhYldpZGdldCA9IG5ldyBhbmRyb2lkLndpZGdldC5UYWJXaWRnZXQoY29udGV4dCk7XG4gICAgICAgIHRhYldpZGdldC5zZXRJZChSX0lEX1RBQlMpO1xuICAgICAgICB0YWJIb3N0TGF5b3V0LmFkZFZpZXcodGFiV2lkZ2V0KTtcbiAgICAgICAgdmFyIGZyYW1lID0gbmV3IGFuZHJvaWQud2lkZ2V0LkZyYW1lTGF5b3V0KGNvbnRleHQpO1xuICAgICAgICBmcmFtZS5zZXRJZChSX0lEX1RBQkNPTlRFTlQpO1xuICAgICAgICBmcmFtZS5zZXRWaXNpYmlsaXR5KGFuZHJvaWQudmlldy5WaWV3LkdPTkUpO1xuICAgICAgICB0YWJIb3N0TGF5b3V0LmFkZFZpZXcoZnJhbWUpO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFZpZXcodGFiSG9zdExheW91dCk7XG4gICAgICAgIHJldHVybiBuYXRpdmVWaWV3O1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmV3IFRhYkNoYW5nZUxpc3RlbmVyKHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE9uVGFiQ2hhbmdlZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgICAgICBuYXRpdmVWaWV3LnNldHVwKCk7XG4gICAgICAgIHRoaXMuX3RhYkNvbnRlbnRGYWN0b3J5ID0gdGhpcy5fdGFiQ29udGVudEZhY3RvcnkgfHwgbmV3IFRhYkNvbnRlbnRGYWN0b3J5KHRoaXMpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcubGlzdGVuZXIub3duZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlLmluc2VydFRhYiA9IGZ1bmN0aW9uICh0YWJJdGVtLCBpbmRleCkge1xuICAgICAgICB2YXIgdGFiSG9zdCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHRhYiA9IHRhYkhvc3QubmV3VGFiU3BlYyhpbmRleCArIFwiXCIpO1xuICAgICAgICB0YWIuc2V0SW5kaWNhdG9yKHRhYkl0ZW0udGl0bGUgKyBcIlwiKTtcbiAgICAgICAgdGFiLnNldENvbnRlbnQodGhpcy5fdGFiQ29udGVudEZhY3RvcnkpO1xuICAgICAgICB0aGlzLl9hZGRpbmdUYWIgPSB0cnVlO1xuICAgICAgICB0YWJIb3N0LmFkZFRhYih0YWIpO1xuICAgICAgICB0YWJJdGVtLnNldHVwTmF0aXZlVmlldyhpbmRleCk7XG4gICAgICAgIHRoaXMuX2FkZGluZ1RhYiA9IGZhbHNlO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDdXJyZW50VGFiKHZhbHVlKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNsZWFyQWxsVGFicygpO1xuICAgICAgICB2YXIgbmV3SXRlbXMgPSB2YWx1ZTtcbiAgICAgICAgaWYgKG5ld0l0ZW1zKSB7XG4gICAgICAgICAgICBuZXdJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHsgcmV0dXJuIF90aGlzLmluc2VydFRhYihpdGVtLCBpKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VnbWVudGVkX2Jhcl9jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIFNlZ21lbnRlZEJhcjtcbn0oc2VnbWVudGVkX2Jhcl9jb21tb25fMS5TZWdtZW50ZWRCYXJCYXNlKSk7XG5leHBvcnRzLlNlZ21lbnRlZEJhciA9IFNlZ21lbnRlZEJhcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlZ21lbnRlZC1iYXIuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBTbGlkZXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2xpZGVyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTbGlkZXJCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNsaWRlckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJTbGlkZXJcIilcbiAgICBdLCBTbGlkZXJCYXNlKTtcbiAgICByZXR1cm4gU2xpZGVyQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuU2xpZGVyQmFzZSA9IFNsaWRlckJhc2U7XG5TbGlkZXJCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy52YWx1ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ2YWx1ZVwiLCBkZWZhdWx0VmFsdWU6IDAsIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICB2YWx1ZSA9IE1hdGgubWF4KHZhbHVlLCB0YXJnZXQubWluVmFsdWUpO1xuICAgICAgICB2YWx1ZSA9IE1hdGgubWluKHZhbHVlLCB0YXJnZXQubWF4VmFsdWUpO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiB2aWV3XzEuaXNJT1MgPyBwYXJzZUZsb2F0KHYpIDogcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy52YWx1ZVByb3BlcnR5LnJlZ2lzdGVyKFNsaWRlckJhc2UpO1xuZXhwb3J0cy5taW5WYWx1ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW5WYWx1ZVwiLCBkZWZhdWx0VmFsdWU6IDAsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGV4cG9ydHMubWF4VmFsdWVQcm9wZXJ0eS5jb2VyY2UodGFyZ2V0KTtcbiAgICAgICAgZXhwb3J0cy52YWx1ZVByb3BlcnR5LmNvZXJjZSh0YXJnZXQpO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdmlld18xLmlzSU9TID8gcGFyc2VGbG9hdCh2KSA6IHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWluVmFsdWVQcm9wZXJ0eS5yZWdpc3RlcihTbGlkZXJCYXNlKTtcbmV4cG9ydHMubWF4VmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWF4VmFsdWVcIiwgZGVmYXVsdFZhbHVlOiAxMDAsIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICB2YXIgbWluVmFsdWUgPSB0YXJnZXQubWluVmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSA8IG1pblZhbHVlKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG1pblZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7IHJldHVybiBleHBvcnRzLnZhbHVlUHJvcGVydHkuY29lcmNlKHRhcmdldCk7IH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiB2aWV3XzEuaXNJT1MgPyBwYXJzZUZsb2F0KHYpIDogcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5tYXhWYWx1ZVByb3BlcnR5LnJlZ2lzdGVyKFNsaWRlckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2xpZGVyLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNsaWRlcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3NsaWRlci1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zbGlkZXItY29tbW9uXCIpKTtcbnZhciBTZWVrQmFyO1xudmFyIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVMaXN0ZW5lckNsYXNzKCkge1xuICAgIGlmICghU2Vla0JhckNoYW5nZUxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhTZWVrQmFyQ2hhbmdlTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbCgpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25Qcm9ncmVzc0NoYW5nZWQgPSBmdW5jdGlvbiAoc2Vla0JhciwgcHJvZ3Jlc3MsIGZyb21Vc2VyKSB7XG4gICAgICAgICAgICAgICAgdmFyIG93bmVyID0gc2Vla0Jhci5vd25lcjtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIgJiYgIW93bmVyLl9zdXByZXNzTmF0aXZlVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gcHJvZ3Jlc3MgKyBvd25lci5taW5WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVyX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25TdGFydFRyYWNraW5nVG91Y2ggPSBmdW5jdGlvbiAoc2Vla0Jhcikge1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGwucHJvdG90eXBlLm9uU3RvcFRyYWNraW5nVG91Y2ggPSBmdW5jdGlvbiAoc2Vla0Jhcikge1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5TZWVrQmFyLk9uU2Vla0JhckNoYW5nZUxpc3RlbmVyXSlcbiAgICAgICAgICAgIF0sIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGwpO1xuICAgICAgICAgICAgcmV0dXJuIFNlZWtCYXJDaGFuZ2VMaXN0ZW5lckltcGw7XG4gICAgICAgIH0oamF2YS5sYW5nLk9iamVjdCkpO1xuICAgICAgICBTZWVrQmFyQ2hhbmdlTGlzdGVuZXIgPSBuZXcgU2Vla0JhckNoYW5nZUxpc3RlbmVySW1wbCgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldExpc3RlbmVyKCkge1xuICAgIHJldHVybiBTZWVrQmFyQ2hhbmdlTGlzdGVuZXI7XG59XG52YXIgU2xpZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2xpZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNsaWRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTbGlkZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghU2Vla0Jhcikge1xuICAgICAgICAgICAgU2Vla0JhciA9IGFuZHJvaWQud2lkZ2V0LlNlZWtCYXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTZWVrQmFyKHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5vd25lciA9IHRoaXM7XG4gICAgICAgIGluaXRpYWxpemVMaXN0ZW5lckNsYXNzKCk7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGdldExpc3RlbmVyKCk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25TZWVrQmFyQ2hhbmdlTGlzdGVuZXIobGlzdGVuZXIpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3LnNldE1heCgxMDApO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFByb2dyZXNzKDApO1xuICAgICAgICBuYXRpdmVWaWV3LnNldEtleVByb2dyZXNzSW5jcmVtZW50KDEpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZS5zZXROYXRpdmVWYWx1ZXNTaWxlbnRseSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3VwcmVzc05hdGl2ZVZhbHVlID0gdHJ1ZTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldE1heCh0aGlzLm1heFZhbHVlIC0gdGhpcy5taW5WYWx1ZSk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldFByb2dyZXNzKHRoaXMudmFsdWUgLSB0aGlzLm1pblZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX3N1cHJlc3NOYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS52YWx1ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXROYXRpdmVWYWx1ZXNTaWxlbnRseSgpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEubWluVmFsdWVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlVmFsdWVzU2lsZW50bHkoKTtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxMDA7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5tYXhWYWx1ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXROYXRpdmVWYWx1ZXNTaWxlbnRseSgpO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHNsaWRlcl9jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFRodW1iKCkuc2V0Q29sb3JGaWx0ZXIodmFsdWUuYW5kcm9pZCwgYW5kcm9pZC5ncmFwaGljcy5Qb3J0ZXJEdWZmLk1vZGUuU1JDX0lOKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUaHVtYigpLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc2xpZGVyX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UHJvZ3Jlc3NEcmF3YWJsZSgpLnNldENvbG9yRmlsdGVyKHZhbHVlLmFuZHJvaWQsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UHJvZ3Jlc3NEcmF3YWJsZSgpLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgcmV0dXJuIFNsaWRlcjtcbn0oc2xpZGVyX2NvbW1vbl8xLlNsaWRlckJhc2UpKTtcbmV4cG9ydHMuU2xpZGVyID0gU2xpZGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2xpZGVyLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgQmFja2dyb3VuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmFja2dyb3VuZCgpIHtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyUmlnaHRXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tV2lkdGggPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckxlZnRXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gMDtcbiAgICB9XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBCYWNrZ3JvdW5kKCk7XG4gICAgICAgIGNsb25lLmNvbG9yID0gdGhpcy5jb2xvcjtcbiAgICAgICAgY2xvbmUuaW1hZ2UgPSB0aGlzLmltYWdlO1xuICAgICAgICBjbG9uZS5yZXBlYXQgPSB0aGlzLnJlcGVhdDtcbiAgICAgICAgY2xvbmUucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgICAgICBjbG9uZS5zaXplID0gdGhpcy5zaXplO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BDb2xvciA9IHRoaXMuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0Q29sb3IgPSB0aGlzLmJvcmRlclJpZ2h0Q29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUNvbG9yID0gdGhpcy5ib3JkZXJCb3R0b21Db2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyTGVmdENvbG9yID0gdGhpcy5ib3JkZXJMZWZ0Q29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcFdpZHRoID0gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyUmlnaHRXaWR0aCA9IHRoaXMuYm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tV2lkdGggPSB0aGlzLmJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0V2lkdGggPSB0aGlzLmJvcmRlckxlZnRXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wTGVmdFJhZGl1cyA9IHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cztcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSB0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyA9IHRoaXMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgICAgIGNsb25lLmNsaXBQYXRoID0gdGhpcy5jbGlwUGF0aDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEltYWdlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuaW1hZ2UgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aFJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnJlcGVhdCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoUG9zaXRpb24gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5wb3NpdGlvbiA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoU2l6ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnNpemUgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclJpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodENvbG9yID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21Db2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUNvbG9yID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJMZWZ0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcFdpZHRoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclJpZ2h0V2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21XaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVdpZHRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJMZWZ0V2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcExlZnRSYWRpdXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJUb3BSaWdodFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21SaWdodFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQ2xpcFBhdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5jbGlwUGF0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuY29sb3JcbiAgICAgICAgICAgICYmICF0aGlzLmltYWdlXG4gICAgICAgICAgICAmJiAhdGhpcy5oYXNCb3JkZXJXaWR0aCgpXG4gICAgICAgICAgICAmJiAhdGhpcy5oYXNCb3JkZXJSYWRpdXMoKVxuICAgICAgICAgICAgJiYgIXRoaXMuY2xpcFBhdGg7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLmVxdWFscyA9IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAoIXZhbHVlMSAmJiAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlc0VxdWFsID0gZmFsc2U7XG4gICAgICAgIGlmICh2YWx1ZTEgaW5zdGFuY2VvZiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudCAmJiB2YWx1ZTIgaW5zdGFuY2VvZiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgaW1hZ2VzRXF1YWwgPSBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5lcXVhbHModmFsdWUxLCB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW1hZ2VzRXF1YWwgPSB2YWx1ZTEuaW1hZ2UgPT09IHZhbHVlMi5pbWFnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmNvbG9yLCB2YWx1ZTIuY29sb3IpXG4gICAgICAgICAgICAmJiBpbWFnZXNFcXVhbFxuICAgICAgICAgICAgJiYgdmFsdWUxLnBvc2l0aW9uID09PSB2YWx1ZTIucG9zaXRpb25cbiAgICAgICAgICAgICYmIHZhbHVlMS5yZXBlYXQgPT09IHZhbHVlMi5yZXBlYXRcbiAgICAgICAgICAgICYmIHZhbHVlMS5zaXplID09PSB2YWx1ZTIuc2l6ZVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmJvcmRlclRvcENvbG9yLCB2YWx1ZTIuYm9yZGVyVG9wQ29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyUmlnaHRDb2xvciwgdmFsdWUyLmJvcmRlclJpZ2h0Q29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyQm90dG9tQ29sb3IsIHZhbHVlMi5ib3JkZXJCb3R0b21Db2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJMZWZ0Q29sb3IsIHZhbHVlMi5ib3JkZXJMZWZ0Q29sb3IpXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wV2lkdGggPT09IHZhbHVlMi5ib3JkZXJUb3BXaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlclJpZ2h0V2lkdGggPT09IHZhbHVlMi5ib3JkZXJSaWdodFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyQm90dG9tV2lkdGggPT09IHZhbHVlMi5ib3JkZXJCb3R0b21XaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckxlZnRXaWR0aCA9PT0gdmFsdWUyLmJvcmRlckxlZnRXaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJUb3BMZWZ0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJUb3BSaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID09PSB2YWx1ZTIuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID09PSB2YWx1ZTIuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmNsaXBQYXRoID09PSB2YWx1ZTIuY2xpcFBhdGg7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNCb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5ib3JkZXJUb3BDb2xvciB8fCAhIXRoaXMuYm9yZGVyUmlnaHRDb2xvciB8fCAhIXRoaXMuYm9yZGVyQm90dG9tQ29sb3IgfHwgISF0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyUmlnaHRXaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyQm90dG9tV2lkdGggPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlckxlZnRXaWR0aCA+IDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNCb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA+IDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlclJpZ2h0Q29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckJvdHRvbUNvbG9yKVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJMZWZ0Q29sb3IpO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzVW5pZm9ybUJvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aCA9PT0gdGhpcy5ib3JkZXJSaWdodFdpZHRoXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlckJvdHRvbVdpZHRoXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlckxlZnRXaWR0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXNcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID09PSB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNVbmlmb3JtQm9yZGVyQ29sb3IoKVxuICAgICAgICAgICAgJiYgdGhpcy5oYXNVbmlmb3JtQm9yZGVyV2lkdGgoKVxuICAgICAgICAgICAgJiYgdGhpcy5oYXNVbmlmb3JtQm9yZGVyUmFkaXVzKCk7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJDb2xvcigpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuZ2V0VW5pZm9ybUJvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNVbmlmb3JtQm9yZGVyV2lkdGgoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyUmFkaXVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNVbmlmb3JtQm9yZGVyUmFkaXVzKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiaXNFbXB0eTogXCIgKyB0aGlzLmlzRW1wdHkoKSArIFwiOyBjb2xvcjogXCIgKyB0aGlzLmNvbG9yICsgXCI7IGltYWdlOiBcIiArIHRoaXMuaW1hZ2UgKyBcIjsgcmVwZWF0OiBcIiArIHRoaXMucmVwZWF0ICsgXCI7IHBvc2l0aW9uOiBcIiArIHRoaXMucG9zaXRpb24gKyBcIjsgc2l6ZTogXCIgKyB0aGlzLnNpemUgKyBcIjsgYm9yZGVyVG9wQ29sb3I6IFwiICsgdGhpcy5ib3JkZXJUb3BDb2xvciArIFwiOyBib3JkZXJSaWdodENvbG9yOiBcIiArIHRoaXMuYm9yZGVyUmlnaHRDb2xvciArIFwiOyBib3JkZXJCb3R0b21Db2xvcjogXCIgKyB0aGlzLmJvcmRlckJvdHRvbUNvbG9yICsgXCI7IGJvcmRlckxlZnRDb2xvcjogXCIgKyB0aGlzLmJvcmRlckxlZnRDb2xvciArIFwiOyBib3JkZXJUb3BXaWR0aDogXCIgKyB0aGlzLmJvcmRlclRvcFdpZHRoICsgXCI7IGJvcmRlclJpZ2h0V2lkdGg6IFwiICsgdGhpcy5ib3JkZXJSaWdodFdpZHRoICsgXCI7IGJvcmRlckJvdHRvbVdpZHRoOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tV2lkdGggKyBcIjsgYm9yZGVyTGVmdFdpZHRoOiBcIiArIHRoaXMuYm9yZGVyTGVmdFdpZHRoICsgXCI7IGJvcmRlclRvcExlZnRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzICsgXCI7IGJvcmRlclRvcFJpZ2h0UmFkaXVzOiBcIiArIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgKyBcIjsgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyArIFwiOyBib3JkZXJCb3R0b21MZWZ0UmFkaXVzOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyArIFwiOyBjbGlwUGF0aDogXCIgKyB0aGlzLmNsaXBQYXRoICsgXCI7XCI7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLmRlZmF1bHQgPSBuZXcgQmFja2dyb3VuZCgpO1xuICAgIHJldHVybiBCYWNrZ3JvdW5kO1xufSgpKTtcbmV4cG9ydHMuQmFja2dyb3VuZCA9IEJhY2tncm91bmQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYWNrZ3JvdW5kLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgY3NzX3ZhbHVlXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzLXZhbHVlXCIpO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYmFja2dyb3VuZC1jb21tb25cIikpO1xudmFyIGFkO1xuKGZ1bmN0aW9uIChhZCkge1xuICAgIHZhciBTREs7XG4gICAgZnVuY3Rpb24gZ2V0U0RLKCkge1xuICAgICAgICBpZiAoIVNESykge1xuICAgICAgICAgICAgU0RLID0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFNESztcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNTZXRDb2xvckZpbHRlck9ubHlXaWRnZXQobmF0aXZlVmlldykge1xuICAgICAgICByZXR1cm4gKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBhbmRyb2lkLndpZGdldC5CdXR0b24gfHxcbiAgICAgICAgICAgIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZHguYXBwY29tcGF0LndpZGdldC5Ub29sYmFyXG4gICAgICAgICAgICAgICAgJiYgZ2V0U0RLKCkgPj0gMjEpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25CYWNrZ3JvdW5kT3JCb3JkZXJQcm9wZXJ0eUNoYW5nZWQodmlldykge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB2aWV3LnN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICAgICAgdmFyIGRyYXdhYmxlID0gbmF0aXZlVmlldy5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgICAgIHZhciBhbmRyb2lkVmlldyA9IHZpZXc7XG4gICAgICAgIGlmIChhbmRyb2lkVmlldy5fY2FjaGVkRHJhd2FibGUgPT09IHVuZGVmaW5lZCAmJiBkcmF3YWJsZSkge1xuICAgICAgICAgICAgdmFyIGNvbnN0YW50U3RhdGUgPSBkcmF3YWJsZS5nZXRDb25zdGFudFN0YXRlKCk7XG4gICAgICAgICAgICBhbmRyb2lkVmlldy5fY2FjaGVkRHJhd2FibGUgPSBjb25zdGFudFN0YXRlIHx8IGRyYXdhYmxlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1NldENvbG9yRmlsdGVyT25seVdpZGdldChuYXRpdmVWaWV3KVxuICAgICAgICAgICAgJiYgZHJhd2FibGVcbiAgICAgICAgICAgICYmICEoZHJhd2FibGUgaW5zdGFuY2VvZiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQm9yZGVyRHJhd2FibGUpXG4gICAgICAgICAgICAmJiAhYmFja2dyb3VuZC5oYXNCb3JkZXJXaWR0aCgpXG4gICAgICAgICAgICAmJiAhYmFja2dyb3VuZC5oYXNCb3JkZXJSYWRpdXMoKVxuICAgICAgICAgICAgJiYgIWJhY2tncm91bmQuY2xpcFBhdGhcbiAgICAgICAgICAgICYmICFiYWNrZ3JvdW5kLmltYWdlXG4gICAgICAgICAgICAmJiBiYWNrZ3JvdW5kLmNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgYmFja2dyb3VuZENvbG9yID0gZHJhd2FibGUuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZC5jb2xvci5hbmRyb2lkO1xuICAgICAgICAgICAgZHJhd2FibGUubXV0YXRlKCk7XG4gICAgICAgICAgICBkcmF3YWJsZS5zZXRDb2xvckZpbHRlcihiYWNrZ3JvdW5kQ29sb3IsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgICAgICBkcmF3YWJsZS5pbnZhbGlkYXRlU2VsZigpO1xuICAgICAgICAgICAgZHJhd2FibGUuYmFja2dyb3VuZENvbG9yID0gYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFiYWNrZ3JvdW5kLmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmREcmF3YWJsZSA9IGRyYXdhYmxlO1xuICAgICAgICAgICAgaWYgKCEoZHJhd2FibGUgaW5zdGFuY2VvZiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQm9yZGVyRHJhd2FibGUpKSB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZERyYXdhYmxlID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5Cb3JkZXJEcmF3YWJsZSh1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpLCB2aWV3LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgIHJlZnJlc2hCb3JkZXJEcmF3YWJsZSh2aWV3LCBiYWNrZ3JvdW5kRHJhd2FibGUpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0QmFja2dyb3VuZChiYWNrZ3JvdW5kRHJhd2FibGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVmcmVzaEJvcmRlckRyYXdhYmxlKHZpZXcsIGJhY2tncm91bmREcmF3YWJsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2FjaGVkRHJhd2FibGUgPSBhbmRyb2lkVmlldy5fY2FjaGVkRHJhd2FibGU7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdERyYXdhYmxlID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGNhY2hlZERyYXdhYmxlIGluc3RhbmNlb2YgYW5kcm9pZC5ncmFwaGljcy5kcmF3YWJsZS5EcmF3YWJsZS5Db25zdGFudFN0YXRlKSB7XG4gICAgICAgICAgICAgICAgZGVmYXVsdERyYXdhYmxlID0gY2FjaGVkRHJhd2FibGUubmV3RHJhd2FibGUobmF0aXZlVmlldy5nZXRSZXNvdXJjZXMoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjYWNoZWREcmF3YWJsZSBpbnN0YW5jZW9mIGFuZHJvaWQuZ3JhcGhpY3MuZHJhd2FibGUuRHJhd2FibGUpIHtcbiAgICAgICAgICAgICAgICBkZWZhdWx0RHJhd2FibGUgPSBjYWNoZWREcmF3YWJsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlZmF1bHREcmF3YWJsZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldEJhY2tncm91bmQoZGVmYXVsdERyYXdhYmxlKTtcbiAgICAgICAgICAgIGFuZHJvaWRWaWV3Ll9jYWNoZWREcmF3YWJsZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVmdFBhZGRpbmcgPSBNYXRoLmNlaWwodmlldy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdMZWZ0KTtcbiAgICAgICAgdmFyIHRvcFBhZGRpbmcgPSBNYXRoLmNlaWwodmlldy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHZpZXcuZWZmZWN0aXZlUGFkZGluZ1RvcCk7XG4gICAgICAgIHZhciByaWdodFBhZGRpbmcgPSBNYXRoLmNlaWwodmlldy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoICsgdmlldy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQpO1xuICAgICAgICB2YXIgYm90dG9tUGFkZGluZyA9IE1hdGguY2VpbCh2aWV3LmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoICsgdmlldy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRQYWRkaW5nKGxlZnRQYWRkaW5nLCB0b3BQYWRkaW5nLCByaWdodFBhZGRpbmcsIGJvdHRvbVBhZGRpbmcpO1xuICAgIH1cbiAgICBhZC5vbkJhY2tncm91bmRPckJvcmRlclByb3BlcnR5Q2hhbmdlZCA9IG9uQmFja2dyb3VuZE9yQm9yZGVyUHJvcGVydHlDaGFuZ2VkO1xufSkoYWQgPSBleHBvcnRzLmFkIHx8IChleHBvcnRzLmFkID0ge30pKTtcbmZ1bmN0aW9uIGZyb21CYXNlNjQoc291cmNlKSB7XG4gICAgdmFyIGJ5dGVzID0gYW5kcm9pZC51dGlsLkJhc2U2NC5kZWNvZGUoc291cmNlLCBhbmRyb2lkLnV0aWwuQmFzZTY0LkRFRkFVTFQpO1xuICAgIHJldHVybiBhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcEZhY3RvcnkuZGVjb2RlQnl0ZUFycmF5KGJ5dGVzLCAwLCBieXRlcy5sZW5ndGgpO1xufVxuZnVuY3Rpb24gZnJvbUdyYWRpZW50KGdyYWRpZW50KSB7XG4gICAgdmFyIGNvbG9ycyA9IEFycmF5LmNyZWF0ZShcImludFwiLCBncmFkaWVudC5jb2xvclN0b3BzLmxlbmd0aCk7XG4gICAgdmFyIHN0b3BzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgZ3JhZGllbnQuY29sb3JTdG9wcy5sZW5ndGgpO1xuICAgIHZhciBoYXNTdG9wcyA9IGZhbHNlO1xuICAgIGdyYWRpZW50LmNvbG9yU3RvcHMuZm9yRWFjaChmdW5jdGlvbiAoc3RvcCwgaW5kZXgpIHtcbiAgICAgICAgY29sb3JzW2luZGV4XSA9IHN0b3AuY29sb3IuYW5kcm9pZDtcbiAgICAgICAgaWYgKHN0b3Aub2Zmc2V0KSB7XG4gICAgICAgICAgICBzdG9wc1tpbmRleF0gPSBzdG9wLm9mZnNldC52YWx1ZTtcbiAgICAgICAgICAgIGhhc1N0b3BzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHZhciBhbHBoYSA9IGdyYWRpZW50LmFuZ2xlIC8gKE1hdGguUEkgKiAyKTtcbiAgICB2YXIgc3RhcnRYID0gTWF0aC5wb3coTWF0aC5zaW4oTWF0aC5QSSAqIChhbHBoYSArIDAuNzUpKSwgMik7XG4gICAgdmFyIHN0YXJ0WSA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiAoYWxwaGEgKyAwLjUpKSwgMik7XG4gICAgdmFyIGVuZFggPSBNYXRoLnBvdyhNYXRoLnNpbihNYXRoLlBJICogKGFscGhhICsgMC4yNSkpLCAyKTtcbiAgICB2YXIgZW5kWSA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiBhbHBoYSksIDIpO1xuICAgIHJldHVybiBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkxpbmVhckdyYWRpZW50RGVmaW5pdGlvbihzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWSwgY29sb3JzLCBoYXNTdG9wcyA/IHN0b3BzIDogbnVsbCk7XG59XG52YXIgcGF0dGVybiA9IC91cmxcXCgoJ3xcIikoLio/KVxcMVxcKS87XG5mdW5jdGlvbiByZWZyZXNoQm9yZGVyRHJhd2FibGUodmlldywgYm9yZGVyRHJhd2FibGUpIHtcbiAgICB2YXIgbmF0aXZlVmlldyA9IHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICB2YXIgY29udGV4dCA9IG5hdGl2ZVZpZXcuZ2V0Q29udGV4dCgpO1xuICAgIHZhciBiYWNrZ3JvdW5kID0gdmlldy5zdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgaWYgKGJhY2tncm91bmQpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmRQb3NpdGlvblBhcnNlZENTU1ZhbHVlcyA9IGNyZWF0ZU5hdGl2ZUNTU1ZhbHVlQXJyYXkoYmFja2dyb3VuZC5wb3NpdGlvbik7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kU2l6ZVBhcnNlZENTU1ZhbHVlcyA9IGNyZWF0ZU5hdGl2ZUNTU1ZhbHVlQXJyYXkoYmFja2dyb3VuZC5zaXplKTtcbiAgICAgICAgdmFyIGJsYWNrQ29sb3IgPSAtMTY3NzcyMTY7XG4gICAgICAgIHZhciBpbWFnZVVyaSA9IHZvaWQgMDtcbiAgICAgICAgaWYgKGJhY2tncm91bmQuaW1hZ2UgJiYgdHlwZW9mIGJhY2tncm91bmQuaW1hZ2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGltYWdlVXJpID0gYmFja2dyb3VuZC5pbWFnZTtcbiAgICAgICAgICAgIHZhciBtYXRjaCA9IGltYWdlVXJpLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VVcmkgPSBtYXRjaFsyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgYml0bWFwID0gbnVsbDtcbiAgICAgICAgaWYgKHV0aWxzXzEuaXNEYXRhVVJJKGltYWdlVXJpKSkge1xuICAgICAgICAgICAgdmFyIGJhc2U2NERhdGEgPSBpbWFnZVVyaS5zcGxpdChcIixcIilbMV07XG4gICAgICAgICAgICBpZiAoYmFzZTY0RGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgYml0bWFwID0gZnJvbUJhc2U2NChiYXNlNjREYXRhKTtcbiAgICAgICAgICAgICAgICBpbWFnZVVyaSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aChpbWFnZVVyaSkpIHtcbiAgICAgICAgICAgIGlmIChpbWFnZVVyaS5pbmRleE9mKHV0aWxzXzEuUkVTT1VSQ0VfUFJFRklYKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBmaWxlTmFtZSA9IGltYWdlVXJpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlTmFtZS5pbmRleE9mKFwifi9cIikgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBmaWxlX3N5c3RlbV8xLnBhdGguam9pbihmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgZmlsZU5hbWUucmVwbGFjZShcIn4vXCIsIFwiXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW1hZ2VVcmkgPSB1dGlsc18xLkZJTEVfUFJFRklYICsgZmlsZU5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGdyYWRpZW50ID0gbnVsbDtcbiAgICAgICAgaWYgKGJhY2tncm91bmQuaW1hZ2UgJiYgYmFja2dyb3VuZC5pbWFnZSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICBncmFkaWVudCA9IGZyb21HcmFkaWVudChiYWNrZ3JvdW5kLmltYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBib3JkZXJEcmF3YWJsZS5yZWZyZXNoKGJhY2tncm91bmQuYm9yZGVyVG9wQ29sb3IgPyBiYWNrZ3JvdW5kLmJvcmRlclRvcENvbG9yLmFuZHJvaWQgOiBibGFja0NvbG9yLCBiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0Q29sb3IgPyBiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0Q29sb3IuYW5kcm9pZCA6IGJsYWNrQ29sb3IsIGJhY2tncm91bmQuYm9yZGVyQm90dG9tQ29sb3IgPyBiYWNrZ3JvdW5kLmJvcmRlckJvdHRvbUNvbG9yLmFuZHJvaWQgOiBibGFja0NvbG9yLCBiYWNrZ3JvdW5kLmJvcmRlckxlZnRDb2xvciA/IGJhY2tncm91bmQuYm9yZGVyTGVmdENvbG9yLmFuZHJvaWQgOiBibGFja0NvbG9yLCBiYWNrZ3JvdW5kLmJvcmRlclRvcFdpZHRoLCBiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0V2lkdGgsIGJhY2tncm91bmQuYm9yZGVyQm90dG9tV2lkdGgsIGJhY2tncm91bmQuYm9yZGVyTGVmdFdpZHRoLCBiYWNrZ3JvdW5kLmJvcmRlclRvcExlZnRSYWRpdXMsIGJhY2tncm91bmQuYm9yZGVyVG9wUmlnaHRSYWRpdXMsIGJhY2tncm91bmQuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMsIGJhY2tncm91bmQuYm9yZGVyQm90dG9tTGVmdFJhZGl1cywgYmFja2dyb3VuZC5jbGlwUGF0aCwgYmFja2dyb3VuZC5jb2xvciA/IGJhY2tncm91bmQuY29sb3IuYW5kcm9pZCA6IDAsIGltYWdlVXJpLCBiaXRtYXAsIGdyYWRpZW50LCBjb250ZXh0LCBiYWNrZ3JvdW5kLnJlcGVhdCwgYmFja2dyb3VuZC5wb3NpdGlvbiwgYmFja2dyb3VuZFBvc2l0aW9uUGFyc2VkQ1NTVmFsdWVzLCBiYWNrZ3JvdW5kLnNpemUsIGJhY2tncm91bmRTaXplUGFyc2VkQ1NTVmFsdWVzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVOYXRpdmVDU1NWYWx1ZUFycmF5KGNzcykge1xuICAgIGlmICghY3NzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgY3NzVmFsdWVzID0gY3NzX3ZhbHVlXzEucGFyc2UoY3NzKTtcbiAgICB2YXIgbmF0aXZlQXJyYXkgPSBBcnJheS5jcmVhdGUob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNTU1ZhbHVlLCBjc3NWYWx1ZXMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBjc3NWYWx1ZXMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICBuYXRpdmVBcnJheVtpXSA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuQ1NTVmFsdWUoY3NzVmFsdWVzW2ldLnR5cGUsIGNzc1ZhbHVlc1tpXS5zdHJpbmcsIGNzc1ZhbHVlc1tpXS51bml0LCBjc3NWYWx1ZXNbaV0udmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbmF0aXZlQXJyYXk7XG59XG52YXIgQ2FjaGVNb2RlO1xuKGZ1bmN0aW9uIChDYWNoZU1vZGUpIHtcbiAgICBDYWNoZU1vZGVbQ2FjaGVNb2RlW1wibm9uZVwiXSA9IDBdID0gXCJub25lXCI7XG4gICAgQ2FjaGVNb2RlW0NhY2hlTW9kZVtcIm1lbW9yeVwiXSA9IDFdID0gXCJtZW1vcnlcIjtcbiAgICBDYWNoZU1vZGVbQ2FjaGVNb2RlW1wiZGlza0FuZE1lbW9yeVwiXSA9IDJdID0gXCJkaXNrQW5kTWVtb3J5XCI7XG59KShDYWNoZU1vZGUgPSBleHBvcnRzLkNhY2hlTW9kZSB8fCAoZXhwb3J0cy5DYWNoZU1vZGUgPSB7fSkpO1xudmFyIGN1cnJlbnRDYWNoZU1vZGU7XG52YXIgaW1hZ2VGZXRjaGVyO1xuZnVuY3Rpb24gaW5pdEltYWdlQ2FjaGUoY29udGV4dCwgbW9kZSwgbWVtb3J5Q2FjaGVTaXplLCBkaXNrQ2FjaGVTaXplKSB7XG4gICAgaWYgKG1vZGUgPT09IHZvaWQgMCkgeyBtb2RlID0gQ2FjaGVNb2RlLmRpc2tBbmRNZW1vcnk7IH1cbiAgICBpZiAobWVtb3J5Q2FjaGVTaXplID09PSB2b2lkIDApIHsgbWVtb3J5Q2FjaGVTaXplID0gMC4yNTsgfVxuICAgIGlmIChkaXNrQ2FjaGVTaXplID09PSB2b2lkIDApIHsgZGlza0NhY2hlU2l6ZSA9IDEwICogMTAyNCAqIDEwMjQ7IH1cbiAgICBpZiAoY3VycmVudENhY2hlTW9kZSA9PT0gbW9kZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGN1cnJlbnRDYWNoZU1vZGUgPSBtb2RlO1xuICAgIGlmICghaW1hZ2VGZXRjaGVyKSB7XG4gICAgICAgIGltYWdlRmV0Y2hlciA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5pbWFnZS5GZXRjaGVyLmdldEluc3RhbmNlKGNvbnRleHQpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW1hZ2VGZXRjaGVyLmNsZWFyQ2FjaGUoKTtcbiAgICB9XG4gICAgdmFyIHBhcmFtcyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuaW1hZ2UuQ2FjaGUuQ2FjaGVQYXJhbXMoKTtcbiAgICBwYXJhbXMubWVtb3J5Q2FjaGVFbmFibGVkID0gbW9kZSAhPT0gQ2FjaGVNb2RlLm5vbmU7XG4gICAgcGFyYW1zLnNldE1lbUNhY2hlU2l6ZVBlcmNlbnQobWVtb3J5Q2FjaGVTaXplKTtcbiAgICBwYXJhbXMuZGlza0NhY2hlRW5hYmxlZCA9IG1vZGUgPT09IENhY2hlTW9kZS5kaXNrQW5kTWVtb3J5O1xuICAgIHBhcmFtcy5kaXNrQ2FjaGVTaXplID0gZGlza0NhY2hlU2l6ZTtcbiAgICB2YXIgaW1hZ2VDYWNoZSA9IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5pbWFnZS5DYWNoZS5nZXRJbnN0YW5jZShwYXJhbXMpO1xuICAgIGltYWdlRmV0Y2hlci5hZGRJbWFnZUNhY2hlKGltYWdlQ2FjaGUpO1xuICAgIGltYWdlRmV0Y2hlci5pbml0Q2FjaGUoKTtcbn1cbmV4cG9ydHMuaW5pdEltYWdlQ2FjaGUgPSBpbml0SW1hZ2VDYWNoZTtcbmZ1bmN0aW9uIG9uTGl2ZXN5bmMoYXJncykge1xuICAgIGlmIChpbWFnZUZldGNoZXIpIHtcbiAgICAgICAgaW1hZ2VGZXRjaGVyLmNsZWFyQ2FjaGUoKTtcbiAgICB9XG59XG5hcHBsaWNhdGlvbi5vbihcImxpdmVzeW5jXCIsIG9uTGl2ZXN5bmMpO1xuYXBwbGljYXRpb24uYW5kcm9pZC5vbihcImFjdGl2aXR5U3RhcnRlZFwiLCBwcm9maWxpbmdfMS5wcm9maWxlKFwiaW5pdEltYWdlQ2FjaGVcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICBpZiAoIWltYWdlRmV0Y2hlcikge1xuICAgICAgICBpbml0SW1hZ2VDYWNoZShhcmdzLmFjdGl2aXR5KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGltYWdlRmV0Y2hlci5pbml0Q2FjaGUoKTtcbiAgICB9XG59KSk7XG5hcHBsaWNhdGlvbi5hbmRyb2lkLm9uKFwiYWN0aXZpdHlTdG9wcGVkXCIsIHByb2ZpbGluZ18xLnByb2ZpbGUoXCJjbG9zZUltYWdlQ2FjaGVcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICBpZiAoaW1hZ2VGZXRjaGVyKSB7XG4gICAgICAgIGltYWdlRmV0Y2hlci5jbG9zZUNhY2hlKCk7XG4gICAgfVxufSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFja2dyb3VuZC5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlbnVtc18xID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIFNUWUxFX0NVUlZFX01BUCA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwiZWFzZVwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2UsXG4gICAgXCJsaW5lYXJcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5saW5lYXIsXG4gICAgXCJlYXNlLWluXCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZUluLFxuICAgIFwiZWFzZS1vdXRcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlT3V0LFxuICAgIFwiZWFzZS1pbi1vdXRcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlSW5PdXQsXG4gICAgXCJzcHJpbmdcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5zcHJpbmcsXG59KTtcbmZ1bmN0aW9uIHRpbWVDb252ZXJ0ZXIodmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKHZhbHVlLmluZGV4T2YoXCJtc1wiKSA9PT0gLTEpIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICogMTAwMDtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWF4KDAuMCwgcmVzdWx0KTtcbn1cbmV4cG9ydHMudGltZUNvbnZlcnRlciA9IHRpbWVDb252ZXJ0ZXI7XG5mdW5jdGlvbiBhbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA/XG4gICAgICAgIFNUWUxFX0NVUlZFX01BUFt2YWx1ZV0gfHwgcGFyc2VDdWJpY0JlemllckN1cnZlKHZhbHVlKSA6XG4gICAgICAgIGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZTtcbn1cbmV4cG9ydHMuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIgPSBhbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcjtcbmZ1bmN0aW9uIHBhcnNlQ3ViaWNCZXppZXJDdXJ2ZSh2YWx1ZSkge1xuICAgIHZhciBjb29yZHNTdHJpbmcgPSAvXFwoKC4qPylcXCkvLmV4ZWModmFsdWUpO1xuICAgIHZhciBjb29yZHMgPSBjb29yZHNTdHJpbmcgJiYgY29vcmRzU3RyaW5nWzFdXG4gICAgICAgIC5zcGxpdChcIixcIilcbiAgICAgICAgLm1hcChzdHJpbmdUb0JlemllQ29vcmRzKTtcbiAgICBpZiAodmFsdWUuc3RhcnRzV2l0aChcImN1YmljLWJlemllclwiKSAmJlxuICAgICAgICBjb29yZHNTdHJpbmcgJiZcbiAgICAgICAgY29vcmRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICB2YXIgX2EgPSBfX3NwcmVhZEFycmF5cyhjb29yZHMpLCB4MSA9IF9hWzBdLCB4MiA9IF9hWzFdLCB5MV8xID0gX2FbMl0sIHkyID0gX2FbM107XG4gICAgICAgIHJldHVybiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmN1YmljQmV6aWVyKHgxLCB4MiwgeTFfMSwgeTIpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZSBmb3IgYW5pbWF0aW9uOiBcIiArIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdHJpbmdUb0JlemllQ29vcmRzKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmIChyZXN1bHQgPCAwKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBlbHNlIGlmIChyZXN1bHQgPiAxKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udmVydGVycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBrZXlmcmFtZV9hbmltYXRpb25fMSA9IHJlcXVpcmUoXCIuLi9hbmltYXRpb24va2V5ZnJhbWUtYW5pbWF0aW9uXCIpO1xudmFyIGNvbnZlcnRlcnNfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2NvbnZlcnRlcnNcIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBBTklNQVRJT05fUFJPUEVSVFlfSEFORExFUlMgPSBPYmplY3QuZnJlZXplKHtcbiAgICBcImFuaW1hdGlvbi1uYW1lXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5uYW1lID0gdmFsdWU7IH0sXG4gICAgXCJhbmltYXRpb24tZHVyYXRpb25cIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmR1cmF0aW9uID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLWRlbGF5XCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5kZWxheSA9IGNvbnZlcnRlcnNfMS50aW1lQ29udmVydGVyKHZhbHVlKTsgfSxcbiAgICBcImFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb25cIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmN1cnZlID0gY29udmVydGVyc18xLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyKHZhbHVlKTsgfSxcbiAgICBcImFuaW1hdGlvbi1pdGVyYXRpb24tY291bnRcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLml0ZXJhdGlvbnMgPSB2YWx1ZSA9PT0gXCJpbmZpbml0ZVwiID8gTnVtYmVyLk1BWF9WQUxVRSA6IHBhcnNlRmxvYXQodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLWRpcmVjdGlvblwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uaXNSZXZlcnNlID0gdmFsdWUgPT09IFwicmV2ZXJzZVwiOyB9LFxuICAgIFwiYW5pbWF0aW9uLWZpbGwtbW9kZVwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uaXNGb3J3YXJkcyA9IHZhbHVlID09PSBcImZvcndhcmRzXCI7IH1cbn0pO1xudmFyIENzc0FuaW1hdGlvblBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3NzQW5pbWF0aW9uUGFyc2VyKCkge1xuICAgIH1cbiAgICBDc3NBbmltYXRpb25QYXJzZXIua2V5ZnJhbWVBbmltYXRpb25zRnJvbUNTU0RlY2xhcmF0aW9ucyA9IGZ1bmN0aW9uIChkZWNsYXJhdGlvbnMpIHtcbiAgICAgICAgaWYgKGRlY2xhcmF0aW9ucyA9PT0gbnVsbCB8fCBkZWNsYXJhdGlvbnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgYW5pbWF0aW9uSW5mbyA9IHVuZGVmaW5lZDtcbiAgICAgICAgZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdmFsdWUgPSBfYS52YWx1ZTtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gXCJhbmltYXRpb25cIikge1xuICAgICAgICAgICAgICAgIGtleWZyYW1lQW5pbWF0aW9uc0Zyb21DU1NQcm9wZXJ0eSh2YWx1ZSwgYW5pbWF0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHlIYW5kbGVyID0gQU5JTUFUSU9OX1BST1BFUlRZX0hBTkRMRVJTW3Byb3BlcnR5XTtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHlIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25JbmZvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8gPSBuZXcga2V5ZnJhbWVfYW5pbWF0aW9uXzEuS2V5ZnJhbWVBbmltYXRpb25JbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlIYW5kbGVyKGFuaW1hdGlvbkluZm8sIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9ucy5sZW5ndGggPT09IDAgPyB1bmRlZmluZWQgOiBhbmltYXRpb25zO1xuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUGFyc2VyLmtleWZyYW1lc0FycmF5RnJvbUNTUyA9IGZ1bmN0aW9uIChrZXlmcmFtZXMpIHtcbiAgICAgICAgdmFyIHBhcnNlZEtleWZyYW1lcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGtleWZyYW1lc18xID0ga2V5ZnJhbWVzOyBfaSA8IGtleWZyYW1lc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGtleWZyYW1lID0ga2V5ZnJhbWVzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGRlY2xhcmF0aW9ucyA9IHBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnMoa2V5ZnJhbWUuZGVjbGFyYXRpb25zKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSBrZXlmcmFtZS52YWx1ZXM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpbWVfMSA9IF9iW19hXTtcbiAgICAgICAgICAgICAgICBpZiAodGltZV8xID09PSBcImZyb21cIikge1xuICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aW1lXzEgPT09IFwidG9cIikge1xuICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZV8xID0gcGFyc2VGbG9hdCh0aW1lXzEpIC8gMTAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGltZV8xIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZV8xID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGltZV8xID4gMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSAxMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSBwYXJzZWRLZXlmcmFtZXNbdGltZV8xXTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5kdXJhdGlvbiA9IHRpbWVfMTtcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VkS2V5ZnJhbWVzW3RpbWVfMV0gPSBjdXJyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYyA9IDAsIF9kID0ga2V5ZnJhbWUuZGVjbGFyYXRpb25zOyBfYyA8IF9kLmxlbmd0aDsgX2MrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVjbGFyYXRpb24gPSBfZFtfY107XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWNsYXJhdGlvbi5wcm9wZXJ0eSA9PT0gXCJhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuY3VydmUgPSBjb252ZXJ0ZXJzXzEuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIoZGVjbGFyYXRpb24udmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnJlbnQuZGVjbGFyYXRpb25zID0gZGVjbGFyYXRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBhcnJheSA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBwYXJzZWRLZXlmcmFtZSBpbiBwYXJzZWRLZXlmcmFtZXMpIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2gocGFyc2VkS2V5ZnJhbWVzW3BhcnNlZEtleWZyYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgYXJyYXkuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5kdXJhdGlvbiAtIGIuZHVyYXRpb247IH0pO1xuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfTtcbiAgICByZXR1cm4gQ3NzQW5pbWF0aW9uUGFyc2VyO1xufSgpKTtcbmV4cG9ydHMuQ3NzQW5pbWF0aW9uUGFyc2VyID0gQ3NzQW5pbWF0aW9uUGFyc2VyO1xuZnVuY3Rpb24ga2V5ZnJhbWVBbmltYXRpb25zRnJvbUNTU1Byb3BlcnR5KHZhbHVlLCBhbmltYXRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgdmFsdWVzID0gdmFsdWUuc3BsaXQoL1ssXSsvKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB2YWx1ZXNfMSA9IHZhbHVlczsgX2kgPCB2YWx1ZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBwYXJzZWRWYWx1ZSA9IHZhbHVlc18xW19pXTtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb25JbmZvID0gbmV3IGtleWZyYW1lX2FuaW1hdGlvbl8xLktleWZyYW1lQW5pbWF0aW9uSW5mbygpO1xuICAgICAgICAgICAgdmFyIGFyciA9IHBhcnNlZFZhbHVlLnRyaW0oKS5zcGxpdCgvWyBdKy8pO1xuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5uYW1lID0gYXJyWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5kdXJhdGlvbiA9IGNvbnZlcnRlcnNfMS50aW1lQ29udmVydGVyKGFyclsxXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmN1cnZlID0gY29udmVydGVyc18xLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyKGFyclsyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmRlbGF5ID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIoYXJyWzNdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNCkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uaXRlcmF0aW9ucyA9IHBhcnNlSW50KGFycls0XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmlzUmV2ZXJzZSA9IGFycls0XSA9PT0gXCJyZXZlcnNlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDYpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmlzRm9yd2FyZHMgPSBhcnJbNV0gPT09IFwiZm9yd2FyZHNcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIGFuaW1hdGlvbjogXCIgKyB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmltYXRpb25zLnB1c2goYW5pbWF0aW9uSW5mbyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUtleWZyYW1lRGVjbGFyYXRpb25zKHVucGFyc2VkS2V5ZnJhbWVEZWNsYXJhdGlvbnMpIHtcbiAgICB2YXIgZGVjbGFyYXRpb25zID0gdW5wYXJzZWRLZXlmcmFtZURlY2xhcmF0aW9uc1xuICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChkZWNsYXJhdGlvbnMsIF9hKSB7XG4gICAgICAgIHZhciB1bnBhcnNlZFByb3BlcnR5ID0gX2EucHJvcGVydHksIHVucGFyc2VkVmFsdWUgPSBfYS52YWx1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5Ll9nZXRCeUNzc05hbWUodW5wYXJzZWRQcm9wZXJ0eSk7XG4gICAgICAgIGlmICh0eXBlb2YgdW5wYXJzZWRQcm9wZXJ0eSA9PT0gXCJzdHJpbmdcIiAmJiBwcm9wZXJ0eSAmJiBwcm9wZXJ0eS5fdmFsdWVDb252ZXJ0ZXIpIHtcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uc1twcm9wZXJ0eS5uYW1lXSA9IHByb3BlcnR5Ll92YWx1ZUNvbnZlcnRlcih1bnBhcnNlZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdW5wYXJzZWRWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB1bnBhcnNlZFByb3BlcnR5ID09PSBcInRyYW5zZm9ybVwiKSB7XG4gICAgICAgICAgICB2YXIgdHJhbnNmb3JtYXRpb25zID0gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zZm9ybUNvbnZlcnRlcih1bnBhcnNlZFZhbHVlKTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGVjbGFyYXRpb25zLCB0cmFuc2Zvcm1hdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWNsYXJhdGlvbnM7XG4gICAgfSwge30pO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhkZWNsYXJhdGlvbnMpLm1hcChmdW5jdGlvbiAocHJvcGVydHkpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBwcm9wZXJ0eSwgdmFsdWU6IGRlY2xhcmF0aW9uc1twcm9wZXJ0eV0gfSk7IH0pO1xufVxuZXhwb3J0cy5wYXJzZUtleWZyYW1lRGVjbGFyYXRpb25zID0gcGFyc2VLZXlmcmFtZURlY2xhcmF0aW9ucztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNzcy1hbmltYXRpb24tcGFyc2VyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIHV0aWxzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3V0aWxzLWNvbW1vblwiKTtcbnZhciBwYXJzZXIgPSByZXF1aXJlKFwiLi4vLi4vLi4vY3NzL3BhcnNlclwiKTtcbnZhciBNYXRjaDtcbihmdW5jdGlvbiAoTWF0Y2gpIHtcbiAgICBNYXRjaC5EeW5hbWljID0gdHJ1ZTtcbiAgICBNYXRjaC5TdGF0aWMgPSBmYWxzZTtcbn0pKE1hdGNoIHx8IChNYXRjaCA9IHt9KSk7XG5mdW5jdGlvbiBnZXROb2RlRGlyZWN0U2libGluZyhub2RlKSB7XG4gICAgaWYgKCFub2RlLnBhcmVudCB8fCAhbm9kZS5wYXJlbnQuZ2V0Q2hpbGRJbmRleCB8fCAhbm9kZS5wYXJlbnQuZ2V0Q2hpbGRBdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIG5vZGVJbmRleCA9IG5vZGUucGFyZW50LmdldENoaWxkSW5kZXgobm9kZSk7XG4gICAgaWYgKG5vZGVJbmRleCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGUucGFyZW50LmdldENoaWxkQXQobm9kZUluZGV4IC0gMSk7XG59XG5mdW5jdGlvbiBTZWxlY3RvclByb3BlcnRpZXMoc3BlY2lmaWNpdHksIHJhcml0eSwgZHluYW1pYykge1xuICAgIGlmIChkeW5hbWljID09PSB2b2lkIDApIHsgZHluYW1pYyA9IGZhbHNlOyB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgY2xzLnByb3RvdHlwZS5zcGVjaWZpY2l0eSA9IHNwZWNpZmljaXR5O1xuICAgICAgICBjbHMucHJvdG90eXBlLnJhcml0eSA9IHJhcml0eTtcbiAgICAgICAgY2xzLnByb3RvdHlwZS5jb21iaW5hdG9yID0gdW5kZWZpbmVkO1xuICAgICAgICBjbHMucHJvdG90eXBlLmR5bmFtaWMgPSBkeW5hbWljO1xuICAgICAgICByZXR1cm4gY2xzO1xuICAgIH07XG59XG52YXIgU2VsZWN0b3JDb3JlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWxlY3RvckNvcmUoKSB7XG4gICAgfVxuICAgIFNlbGVjdG9yQ29yZS5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHsgc29ydGVyLnNvcnRBc1VuaXZlcnNhbChiYXNlIHx8IHRoaXMpOyB9O1xuICAgIFNlbGVjdG9yQ29yZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMCwgMCwgTWF0Y2guU3RhdGljKVxuICAgIF0sIFNlbGVjdG9yQ29yZSk7XG4gICAgcmV0dXJuIFNlbGVjdG9yQ29yZTtcbn0oKSk7XG5leHBvcnRzLlNlbGVjdG9yQ29yZSA9IFNlbGVjdG9yQ29yZTtcbnZhciBTaW1wbGVTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNpbXBsZVNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNpbXBsZVNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNpbXBsZVNlbGVjdG9yLnByb3RvdHlwZS5hY2N1bXVsYXRlQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgaWYgKCF0aGlzLmR5bmFtaWMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMubWF5TWF0Y2gobm9kZSkpIHtcbiAgICAgICAgICAgIHRoaXMudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBTaW1wbGVTZWxlY3Rvci5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdGhpcy5tYXRjaChub2RlKTsgfTtcbiAgICBTaW1wbGVTZWxlY3Rvci5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgIH07XG4gICAgcmV0dXJuIFNpbXBsZVNlbGVjdG9yO1xufShTZWxlY3RvckNvcmUpKTtcbmV4cG9ydHMuU2ltcGxlU2VsZWN0b3IgPSBTaW1wbGVTZWxlY3RvcjtcbmZ1bmN0aW9uIHdyYXAodGV4dCkge1xuICAgIHJldHVybiB0ZXh0ID8gXCIgXCIgKyB0ZXh0ICsgXCIgXCIgOiBcIlwiO1xufVxudmFyIEludmFsaWRTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEludmFsaWRTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbnZhbGlkU2VsZWN0b3IoZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5lID0gZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJbnZhbGlkU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCI8ZXJyb3I6IFwiICsgdGhpcy5lICsgXCI+XCI7IH07XG4gICAgSW52YWxpZFNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICBJbnZhbGlkU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7XG4gICAgfTtcbiAgICBJbnZhbGlkU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDAsIDQsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBJbnZhbGlkU2VsZWN0b3IpO1xuICAgIHJldHVybiBJbnZhbGlkU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLkludmFsaWRTZWxlY3RvciA9IEludmFsaWRTZWxlY3RvcjtcbnZhciBVbml2ZXJzYWxTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVuaXZlcnNhbFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVuaXZlcnNhbFNlbGVjdG9yKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVuaXZlcnNhbFNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiKlwiICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIFVuaXZlcnNhbFNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0cnVlOyB9O1xuICAgIFVuaXZlcnNhbFNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygwLCAwLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgVW5pdmVyc2FsU2VsZWN0b3IpO1xuICAgIHJldHVybiBVbml2ZXJzYWxTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuVW5pdmVyc2FsU2VsZWN0b3IgPSBVbml2ZXJzYWxTZWxlY3RvcjtcbnZhciBJZFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSWRTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJZFNlbGVjdG9yKGlkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmlkID0gaWQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgSWRTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIiNcIiArIHRoaXMuaWQgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgSWRTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5pZCA9PT0gdGhpcy5pZDsgfTtcbiAgICBJZFNlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEJ5SWQodGhpcy5pZCwgYmFzZSB8fCB0aGlzKTsgfTtcbiAgICBJZFNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcyg2NTUzNiwgMywgTWF0Y2guU3RhdGljKVxuICAgIF0sIElkU2VsZWN0b3IpO1xuICAgIHJldHVybiBJZFNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5JZFNlbGVjdG9yID0gSWRTZWxlY3RvcjtcbnZhciBUeXBlU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUeXBlU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVHlwZVNlbGVjdG9yKGNzc1R5cGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY3NzVHlwZSA9IGNzc1R5cGU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgVHlwZVNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiXCIgKyB0aGlzLmNzc1R5cGUgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgVHlwZVNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmNzc1R5cGUgPT09IHRoaXMuY3NzVHlwZTsgfTtcbiAgICBUeXBlU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7IHNvcnRlci5zb3J0QnlUeXBlKHRoaXMuY3NzVHlwZSwgYmFzZSB8fCB0aGlzKTsgfTtcbiAgICBUeXBlU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDEsIDEsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBUeXBlU2VsZWN0b3IpO1xuICAgIHJldHVybiBUeXBlU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlR5cGVTZWxlY3RvciA9IFR5cGVTZWxlY3RvcjtcbnZhciBDbGFzc1NlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2xhc3NTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDbGFzc1NlbGVjdG9yKGNzc0NsYXNzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNzc0NsYXNzID0gY3NzQ2xhc3M7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIi5cIiArIHRoaXMuY3NzQ2xhc3MgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5jc3NDbGFzc2VzICYmIG5vZGUuY3NzQ2xhc3Nlcy5oYXModGhpcy5jc3NDbGFzcyk7IH07XG4gICAgQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHsgc29ydGVyLnNvcnRCeUNsYXNzKHRoaXMuY3NzQ2xhc3MsIGJhc2UgfHwgdGhpcyk7IH07XG4gICAgQ2xhc3NTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMjU2LCAyLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgQ2xhc3NTZWxlY3Rvcik7XG4gICAgcmV0dXJuIENsYXNzU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLkNsYXNzU2VsZWN0b3IgPSBDbGFzc1NlbGVjdG9yO1xudmFyIEF0dHJpYnV0ZVNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQXR0cmlidXRlU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXR0cmlidXRlU2VsZWN0b3IoYXR0cmlidXRlLCB0ZXN0LCB2YWx1ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5hdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7XG4gICAgICAgIF90aGlzLnRlc3QgPSB0ZXN0O1xuICAgICAgICBfdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBpZiAoIXRlc3QpIHtcbiAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuICF0eXBlc18xLmlzTnVsbE9yVW5kZWZpbmVkKG5vZGVbYXR0cmlidXRlXSk7IH07XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVzY2FwZWRWYWx1ZSA9IHV0aWxzX2NvbW1vbl8xLmVzY2FwZVJlZ2V4U3ltYm9scyh2YWx1ZSk7XG4gICAgICAgIHZhciByZWdleHAgPSBudWxsO1xuICAgICAgICBzd2l0Y2ggKHRlc3QpIHtcbiAgICAgICAgICAgIGNhc2UgXCJePVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBlc2NhcGVkVmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIiQ9XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChlc2NhcGVkVmFsdWUgKyBcIiRcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiKj1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKGVzY2FwZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiPVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBlc2NhcGVkVmFsdWUgKyBcIiRcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwifj1cIjpcbiAgICAgICAgICAgICAgICBpZiAoL1xccy8udGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIihefFxcXFxzKVwiICsgZXNjYXBlZFZhbHVlICsgXCIoXFxcXHN8JClcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwifD1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKFwiXlwiICsgZXNjYXBlZFZhbHVlICsgXCIoLXwkKVwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVnZXhwKSB7XG4gICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiByZWdleHAudGVzdChub2RlW2F0dHJpYnV0ZV0gKyBcIlwiKTsgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgfVxuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiW1wiICsgdGhpcy5hdHRyaWJ1dGUgKyB3cmFwKHRoaXMudGVzdCkgKyAoKHRoaXMudGVzdCAmJiB0aGlzLnZhbHVlKSB8fCBcIlwiKSArIFwiXVwiICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICBBdHRyaWJ1dGVTZWxlY3Rvci5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdHJ1ZTsgfTtcbiAgICBBdHRyaWJ1dGVTZWxlY3Rvci5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkgeyBtYXAuYWRkQXR0cmlidXRlKG5vZGUsIHRoaXMuYXR0cmlidXRlKTsgfTtcbiAgICBBdHRyaWJ1dGVTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMjU2LCAwLCBNYXRjaC5EeW5hbWljKVxuICAgIF0sIEF0dHJpYnV0ZVNlbGVjdG9yKTtcbiAgICByZXR1cm4gQXR0cmlidXRlU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLkF0dHJpYnV0ZVNlbGVjdG9yID0gQXR0cmlidXRlU2VsZWN0b3I7XG52YXIgUHNldWRvQ2xhc3NTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFBzZXVkb0NsYXNzU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHNldWRvQ2xhc3NTZWxlY3Rvcihjc3NQc2V1ZG9DbGFzcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jc3NQc2V1ZG9DbGFzcyA9IGNzc1BzZXVkb0NsYXNzO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFBzZXVkb0NsYXNzU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCI6XCIgKyB0aGlzLmNzc1BzZXVkb0NsYXNzICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIFBzZXVkb0NsYXNzU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuY3NzUHNldWRvQ2xhc3NlcyAmJiBub2RlLmNzc1BzZXVkb0NsYXNzZXMuaGFzKHRoaXMuY3NzUHNldWRvQ2xhc3MpOyB9O1xuICAgIFBzZXVkb0NsYXNzU2VsZWN0b3IucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkgeyBtYXAuYWRkUHNldWRvQ2xhc3Mobm9kZSwgdGhpcy5jc3NQc2V1ZG9DbGFzcyk7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMjU2LCAwLCBNYXRjaC5EeW5hbWljKVxuICAgIF0sIFBzZXVkb0NsYXNzU2VsZWN0b3IpO1xuICAgIHJldHVybiBQc2V1ZG9DbGFzc1NlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5Qc2V1ZG9DbGFzc1NlbGVjdG9yID0gUHNldWRvQ2xhc3NTZWxlY3RvcjtcbnZhciBTaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTaW1wbGVTZWxlY3RvclNlcXVlbmNlKHNlbGVjdG9ycykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgIF90aGlzLnNwZWNpZmljaXR5ID0gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAoc3VtLCBzZWwpIHsgcmV0dXJuIHNlbC5zcGVjaWZpY2l0eSArIHN1bTsgfSwgMCk7XG4gICAgICAgIF90aGlzLmhlYWQgPSBfdGhpcy5zZWxlY3RvcnMucmVkdWNlKGZ1bmN0aW9uIChwcmV2LCBjdXJyKSB7IHJldHVybiAhcHJldiB8fCAoY3Vyci5yYXJpdHkgPiBwcmV2LnJhcml0eSkgPyBjdXJyIDogcHJldjsgfSwgbnVsbCk7XG4gICAgICAgIF90aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIlwiICsgdGhpcy5zZWxlY3RvcnMuam9pbihcIlwiKSArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwubWF0Y2gobm9kZSk7IH0pOyB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5tYXlNYXRjaChub2RlKTsgfSk7XG4gICAgfTtcbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLnRyYWNrQ2hhbmdlcyhub2RlLCBtYXApOyB9KTtcbiAgICB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7XG4gICAgICAgIHRoaXMuaGVhZC5sb29rdXBTb3J0KHNvcnRlciwgYmFzZSB8fCB0aGlzKTtcbiAgICB9O1xuICAgIHJldHVybiBTaW1wbGVTZWxlY3RvclNlcXVlbmNlO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5TaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZTtcbnZhciBTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yKHNlbGVjdG9ycykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgIHZhciBzdXBwb3J0ZWRDb21iaW5hdG9yID0gW3VuZGVmaW5lZCwgXCIgXCIsIFwiPlwiLCBcIitcIl07XG4gICAgICAgIHZhciBzaWJsaW5nR3JvdXA7XG4gICAgICAgIHZhciBsYXN0R3JvdXA7XG4gICAgICAgIHZhciBncm91cHMgPSBbXTtcbiAgICAgICAgc2VsZWN0b3JzLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uIChzZWwpIHtcbiAgICAgICAgICAgIGlmIChzdXBwb3J0ZWRDb21iaW5hdG9yLmluZGV4T2Yoc2VsLmNvbWJpbmF0b3IpID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIGNvbWJpbmF0b3IgXFxcIlwiICsgc2VsLmNvbWJpbmF0b3IgKyBcIlxcXCIuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbC5jb21iaW5hdG9yID09PSB1bmRlZmluZWQgfHwgc2VsLmNvbWJpbmF0b3IgPT09IFwiIFwiKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBzLnB1c2gobGFzdEdyb3VwID0gW3NpYmxpbmdHcm91cCA9IFtdXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsLmNvbWJpbmF0b3IgPT09IFwiPlwiKSB7XG4gICAgICAgICAgICAgICAgbGFzdEdyb3VwLnB1c2goc2libGluZ0dyb3VwID0gW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2libGluZ0dyb3VwLnB1c2goc2VsKTtcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzLmdyb3VwcyA9IGdyb3Vwcy5tYXAoZnVuY3Rpb24gKGcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3IuQ2hpbGRHcm91cChnLm1hcChmdW5jdGlvbiAoc2cpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNlbGVjdG9yLlNpYmxpbmdHcm91cChzZyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgICAgICBfdGhpcy5sYXN0ID0gc2VsZWN0b3JzWzBdO1xuICAgICAgICBfdGhpcy5zcGVjaWZpY2l0eSA9IHNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKHN1bSwgc2VsKSB7IHJldHVybiBzZWwuc3BlY2lmaWNpdHkgKyBzdW07IH0sIDApO1xuICAgICAgICBfdGhpcy5keW5hbWljID0gc2VsZWN0b3JzLnNvbWUoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmR5bmFtaWM7IH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmpvaW4oXCJcIik7IH07XG4gICAgU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBzLmV2ZXJ5KGZ1bmN0aW9uIChncm91cCwgaSkge1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBub2RlID0gZ3JvdXAubWF0Y2gobm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvciA9IG5vZGU7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlID0gZ3JvdXAubWF0Y2goYW5jZXN0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7XG4gICAgICAgIHRoaXMubGFzdC5sb29rdXBTb3J0KHNvcnRlciwgdGhpcyk7XG4gICAgfTtcbiAgICBTZWxlY3Rvci5wcm90b3R5cGUuYWNjdW11bGF0ZUNoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgIGlmICghdGhpcy5keW5hbWljKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXRjaChub2RlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYm91bmRzID0gW107XG4gICAgICAgIHZhciBtYXlNYXRjaCA9IHRoaXMuZ3JvdXBzLmV2ZXJ5KGZ1bmN0aW9uIChncm91cCwgaSkge1xuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dE5vZGUgPSBncm91cC5tYXlNYXRjaChub2RlKTtcbiAgICAgICAgICAgICAgICBib3VuZHMucHVzaCh7IGxlZnQ6IG5vZGUsIHJpZ2h0OiBub2RlIH0pO1xuICAgICAgICAgICAgICAgIG5vZGUgPSBuZXh0Tm9kZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yID0gbm9kZTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHROb2RlID0gZ3JvdXAubWF5TWF0Y2goYW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kcy5wdXNoKHsgbGVmdDogYW5jZXN0b3IsIHJpZ2h0OiBudWxsIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5leHROb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFtYXlNYXRjaCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbWFwKSB7XG4gICAgICAgICAgICByZXR1cm4gbWF5TWF0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmdyb3Vwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGdyb3VwXzEgPSB0aGlzLmdyb3Vwc1tpXTtcbiAgICAgICAgICAgIGlmICghZ3JvdXBfMS5keW5hbWljKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYm91bmQgPSBib3VuZHNbaV07XG4gICAgICAgICAgICB2YXIgbm9kZV8xID0gYm91bmQubGVmdDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpZiAoZ3JvdXBfMS5tYXlNYXRjaChub2RlXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyb3VwXzEudHJhY2tDaGFuZ2VzKG5vZGVfMSwgbWFwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICgobm9kZV8xICE9PSBib3VuZC5yaWdodCkgJiYgKG5vZGVfMSA9IG5vZGVfMS5wYXJlbnQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF5TWF0Y2g7XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0b3I7XG59KFNlbGVjdG9yQ29yZSkpO1xuZXhwb3J0cy5TZWxlY3RvciA9IFNlbGVjdG9yO1xuKGZ1bmN0aW9uIChTZWxlY3Rvcikge1xuICAgIHZhciBDaGlsZEdyb3VwID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQ2hpbGRHcm91cChzZWxlY3RvcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICAgICAgdGhpcy5keW5hbWljID0gc2VsZWN0b3JzLnNvbWUoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmR5bmFtaWM7IH0pO1xuICAgICAgICB9XG4gICAgICAgIENoaWxkR3JvdXAucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gbm9kZS5wYXJlbnQpICYmICEhc2VsLm1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBDaGlsZEdyb3VwLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IG5vZGUucGFyZW50KSAmJiAhIXNlbC5tYXlNYXRjaChub2RlKTsgfSkgPyBub2RlIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgQ2hpbGRHcm91cC5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gbm9kZS5wYXJlbnQpICYmIHNlbC50cmFja0NoYW5nZXMobm9kZSwgbWFwKTsgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDaGlsZEdyb3VwO1xuICAgIH0oKSk7XG4gICAgU2VsZWN0b3IuQ2hpbGRHcm91cCA9IENoaWxkR3JvdXA7XG4gICAgdmFyIFNpYmxpbmdHcm91cCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFNpYmxpbmdHcm91cChzZWxlY3RvcnMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICAgICAgdGhpcy5keW5hbWljID0gc2VsZWN0b3JzLnNvbWUoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmR5bmFtaWM7IH0pO1xuICAgICAgICB9XG4gICAgICAgIFNpYmxpbmdHcm91cC5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBnZXROb2RlRGlyZWN0U2libGluZyhub2RlKSkgJiYgc2VsLm1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBTaWJsaW5nR3JvdXAucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gZ2V0Tm9kZURpcmVjdFNpYmxpbmcobm9kZSkpICYmIHNlbC5tYXlNYXRjaChub2RlKTsgfSkgPyBub2RlIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgU2libGluZ0dyb3VwLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBnZXROb2RlRGlyZWN0U2libGluZyhub2RlKSkgJiYgc2VsLnRyYWNrQ2hhbmdlcyhub2RlLCBtYXApOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFNpYmxpbmdHcm91cDtcbiAgICB9KCkpO1xuICAgIFNlbGVjdG9yLlNpYmxpbmdHcm91cCA9IFNpYmxpbmdHcm91cDtcbn0pKFNlbGVjdG9yID0gZXhwb3J0cy5TZWxlY3RvciB8fCAoZXhwb3J0cy5TZWxlY3RvciA9IHt9KSk7XG5leHBvcnRzLlNlbGVjdG9yID0gU2VsZWN0b3I7XG52YXIgUnVsZVNldCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUnVsZVNldChzZWxlY3RvcnMsIGRlY2xhcmF0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgdGhpcy5kZWNsYXJhdGlvbnMgPSBkZWNsYXJhdGlvbnM7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLnJ1bGVzZXQgPSBfdGhpczsgfSk7XG4gICAgfVxuICAgIFJ1bGVTZXQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5zZWxlY3RvcnMuam9pbihcIiwgXCIpICsgXCIge1wiICsgdGhpcy5kZWNsYXJhdGlvbnMubWFwKGZ1bmN0aW9uIChkLCBpKSB7IHJldHVybiBcIlwiICsgKGkgPT09IDAgPyBcIiBcIiA6IFwiXCIpICsgZC5wcm9wZXJ0eSArIFwiOiBcIiArIGQudmFsdWU7IH0pLmpvaW4oXCI7IFwiKSArIFwiIH1cIjsgfTtcbiAgICBSdWxlU2V0LnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlcikgeyB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5sb29rdXBTb3J0KHNvcnRlcik7IH0pOyB9O1xuICAgIHJldHVybiBSdWxlU2V0O1xufSgpKTtcbmV4cG9ydHMuUnVsZVNldCA9IFJ1bGVTZXQ7XG5mdW5jdGlvbiBmcm9tQXN0Tm9kZXMoYXN0UnVsZXMpIHtcbiAgICByZXR1cm4gYXN0UnVsZXMuZmlsdGVyKGlzUnVsZSkubWFwKGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBydWxlLmRlY2xhcmF0aW9ucy5maWx0ZXIoaXNEZWNsYXJhdGlvbikubWFwKGNyZWF0ZURlY2xhcmF0aW9uKTtcbiAgICAgICAgdmFyIHNlbGVjdG9ycyA9IHJ1bGUuc2VsZWN0b3JzLm1hcChjcmVhdGVTZWxlY3Rvcik7XG4gICAgICAgIHZhciBydWxlc2V0ID0gbmV3IFJ1bGVTZXQoc2VsZWN0b3JzLCBkZWNsYXJhdGlvbnMpO1xuICAgICAgICByZXR1cm4gcnVsZXNldDtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZnJvbUFzdE5vZGVzID0gZnJvbUFzdE5vZGVzO1xuZnVuY3Rpb24gY3JlYXRlRGVjbGFyYXRpb24oZGVjbCkge1xuICAgIHJldHVybiB7IHByb3BlcnR5OiBkZWNsLnByb3BlcnR5LnRvTG93ZXJDYXNlKCksIHZhbHVlOiBkZWNsLnZhbHVlIH07XG59XG5mdW5jdGlvbiBjcmVhdGVTaW1wbGVTZWxlY3RvckZyb21Bc3QoYXN0KSB7XG4gICAgc3dpdGNoIChhc3QudHlwZSkge1xuICAgICAgICBjYXNlIFwiKlwiOiByZXR1cm4gbmV3IFVuaXZlcnNhbFNlbGVjdG9yKCk7XG4gICAgICAgIGNhc2UgXCIjXCI6IHJldHVybiBuZXcgSWRTZWxlY3Rvcihhc3QuaWRlbnRpZmllcik7XG4gICAgICAgIGNhc2UgXCJcIjogcmV0dXJuIG5ldyBUeXBlU2VsZWN0b3IoYXN0LmlkZW50aWZpZXIucmVwbGFjZSgvLS8sIFwiXCIpLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBjYXNlIFwiLlwiOiByZXR1cm4gbmV3IENsYXNzU2VsZWN0b3IoYXN0LmlkZW50aWZpZXIpO1xuICAgICAgICBjYXNlIFwiOlwiOiByZXR1cm4gbmV3IFBzZXVkb0NsYXNzU2VsZWN0b3IoYXN0LmlkZW50aWZpZXIpO1xuICAgICAgICBjYXNlIFwiW11cIjogcmV0dXJuIGFzdC50ZXN0ID8gbmV3IEF0dHJpYnV0ZVNlbGVjdG9yKGFzdC5wcm9wZXJ0eSwgYXN0LnRlc3QsIGFzdC52YWx1ZSkgOiBuZXcgQXR0cmlidXRlU2VsZWN0b3IoYXN0LnByb3BlcnR5KTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVTaW1wbGVTZWxlY3RvclNlcXVlbmNlRnJvbUFzdChhc3QpIHtcbiAgICBpZiAoYXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihuZXcgRXJyb3IoXCJFbXB0eSBzaW1wbGUgc2VsZWN0b3Igc2VxdWVuY2UuXCIpKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXN0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlU2ltcGxlU2VsZWN0b3JGcm9tQXN0KGFzdFswXSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UoYXN0Lm1hcChjcmVhdGVTaW1wbGVTZWxlY3RvckZyb21Bc3QpKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVTZWxlY3RvckZyb21Bc3QoYXN0KSB7XG4gICAgaWYgKGFzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnZhbGlkU2VsZWN0b3IobmV3IEVycm9yKFwiRW1wdHkgc2VsZWN0b3IuXCIpKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXN0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZUZyb21Bc3QoYXN0WzBdWzBdKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBzaW1wbGVTZWxlY3RvclNlcXVlbmNlcyA9IFtdO1xuICAgICAgICB2YXIgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGNvbWJpbmF0b3IgPSB2b2lkIDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBzaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gY3JlYXRlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZUZyb21Bc3QoYXN0W2ldWzBdKTtcbiAgICAgICAgICAgIGNvbWJpbmF0b3IgPSBhc3RbaV1bMV07XG4gICAgICAgICAgICBpZiAoY29tYmluYXRvcikge1xuICAgICAgICAgICAgICAgIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UuY29tYmluYXRvciA9IGNvbWJpbmF0b3I7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaW1wbGVTZWxlY3RvclNlcXVlbmNlcy5wdXNoKHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3Ioc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZXMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVNlbGVjdG9yKHNlbCkge1xuICAgIHRyeSB7XG4gICAgICAgIHZhciBwYXJzZWRTZWxlY3RvciA9IHBhcnNlci5wYXJzZVNlbGVjdG9yKHNlbCk7XG4gICAgICAgIGlmICghcGFyc2VkU2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW52YWxpZFNlbGVjdG9yKG5ldyBFcnJvcihcIkVtcHR5IHNlbGVjdG9yXCIpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlU2VsZWN0b3JGcm9tQXN0KHBhcnNlZFNlbGVjdG9yLnZhbHVlKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnZhbGlkU2VsZWN0b3IoZSk7XG4gICAgfVxufVxuZXhwb3J0cy5jcmVhdGVTZWxlY3RvciA9IGNyZWF0ZVNlbGVjdG9yO1xuZnVuY3Rpb24gaXNSdWxlKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50eXBlID09PSBcInJ1bGVcIjtcbn1cbmZ1bmN0aW9uIGlzRGVjbGFyYXRpb24obm9kZSkge1xuICAgIHJldHVybiBub2RlLnR5cGUgPT09IFwiZGVjbGFyYXRpb25cIjtcbn1cbnZhciBTZWxlY3RvcnNNYXAgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yc01hcChydWxlc2V0cykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmlkID0ge307XG4gICAgICAgIHRoaXMuY2xhc3MgPSB7fTtcbiAgICAgICAgdGhpcy50eXBlID0ge307XG4gICAgICAgIHRoaXMudW5pdmVyc2FsID0gW107XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSAwO1xuICAgICAgICBydWxlc2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChydWxlKSB7IHJldHVybiBydWxlLmxvb2t1cFNvcnQoX3RoaXMpOyB9KTtcbiAgICB9XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5xdWVyeSA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzZWxlY3RvckNsYXNzZXMgPSBbXG4gICAgICAgICAgICB0aGlzLnVuaXZlcnNhbCxcbiAgICAgICAgICAgIHRoaXMuaWRbbm9kZS5pZF0sXG4gICAgICAgICAgICB0aGlzLnR5cGVbbm9kZS5jc3NUeXBlXVxuICAgICAgICBdO1xuICAgICAgICBpZiAobm9kZS5jc3NDbGFzc2VzKSB7XG4gICAgICAgICAgICBub2RlLmNzc0NsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gc2VsZWN0b3JDbGFzc2VzLnB1c2goX3RoaXMuY2xhc3NbY10pOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2VsZWN0b3JzID0gc2VsZWN0b3JDbGFzc2VzXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhcnIpIHsgcmV0dXJuICEhYXJyOyB9KVxuICAgICAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAoY3VyLCBuZXh0KSB7IHJldHVybiBjdXIuY29uY2F0KG5leHQpOyB9LCBbXSk7XG4gICAgICAgIHZhciBzZWxlY3RvcnNNYXRjaCA9IG5ldyBTZWxlY3RvcnNNYXRjaCgpO1xuICAgICAgICBzZWxlY3RvcnNNYXRjaC5zZWxlY3RvcnMgPSBzZWxlY3RvcnNcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLnNlbC5hY2N1bXVsYXRlQ2hhbmdlcyhub2RlLCBzZWxlY3RvcnNNYXRjaCk7IH0pXG4gICAgICAgICAgICAuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5zZWwuc3BlY2lmaWNpdHkgLSBiLnNlbC5zcGVjaWZpY2l0eSB8fCBhLnBvcyAtIGIucG9zOyB9KVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZG9jU2VsKSB7IHJldHVybiBkb2NTZWwuc2VsOyB9KTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yc01hdGNoO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5zb3J0QnlJZCA9IGZ1bmN0aW9uIChpZCwgc2VsKSB7IHRoaXMuYWRkVG9NYXAodGhpcy5pZCwgaWQsIHNlbCk7IH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5zb3J0QnlDbGFzcyA9IGZ1bmN0aW9uIChjc3NDbGFzcywgc2VsKSB7XG4gICAgICAgIHRoaXMuYWRkVG9NYXAodGhpcy5jbGFzcywgY3NzQ2xhc3MsIHNlbCk7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRCeVR5cGUgPSBmdW5jdGlvbiAoY3NzVHlwZSwgc2VsKSB7XG4gICAgICAgIHRoaXMuYWRkVG9NYXAodGhpcy50eXBlLCBjc3NUeXBlLCBzZWwpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5zb3J0QXNVbml2ZXJzYWwgPSBmdW5jdGlvbiAoc2VsKSB7IHRoaXMudW5pdmVyc2FsLnB1c2godGhpcy5tYWtlRG9jU2VsZWN0b3Ioc2VsKSk7IH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5hZGRUb01hcCA9IGZ1bmN0aW9uIChtYXAsIGhlYWQsIHNlbCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uKys7XG4gICAgICAgIHZhciBsaXN0ID0gbWFwW2hlYWRdO1xuICAgICAgICBpZiAobGlzdCkge1xuICAgICAgICAgICAgbGlzdC5wdXNoKHRoaXMubWFrZURvY1NlbGVjdG9yKHNlbCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbWFwW2hlYWRdID0gW3RoaXMubWFrZURvY1NlbGVjdG9yKHNlbCldO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLm1ha2VEb2NTZWxlY3RvciA9IGZ1bmN0aW9uIChzZWwpIHtcbiAgICAgICAgcmV0dXJuIHsgc2VsOiBzZWwsIHBvczogdGhpcy5wb3NpdGlvbisrIH07XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0b3JzTWFwO1xufSgpKTtcbmV4cG9ydHMuU2VsZWN0b3JzTWFwID0gU2VsZWN0b3JzTWFwO1xudmFyIFNlbGVjdG9yc01hdGNoID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWxlY3RvcnNNYXRjaCgpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIFNlbGVjdG9yc01hdGNoLnByb3RvdHlwZS5hZGRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobm9kZSwgYXR0cmlidXRlKSB7XG4gICAgICAgIHZhciBkZXBzID0gdGhpcy5wcm9wZXJ0aWVzKG5vZGUpO1xuICAgICAgICBpZiAoIWRlcHMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZGVwcy5hdHRyaWJ1dGVzID0gbmV3IFNldCgpO1xuICAgICAgICB9XG4gICAgICAgIGRlcHMuYXR0cmlidXRlcy5hZGQoYXR0cmlidXRlKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hdGNoLnByb3RvdHlwZS5hZGRQc2V1ZG9DbGFzcyA9IGZ1bmN0aW9uIChub2RlLCBwc2V1ZG9DbGFzcykge1xuICAgICAgICB2YXIgZGVwcyA9IHRoaXMucHJvcGVydGllcyhub2RlKTtcbiAgICAgICAgaWYgKCFkZXBzLnBzZXVkb0NsYXNzZXMpIHtcbiAgICAgICAgICAgIGRlcHMucHNldWRvQ2xhc3NlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXBzLnBzZXVkb0NsYXNzZXMuYWRkKHBzZXVkb0NsYXNzKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hdGNoLnByb3RvdHlwZS5wcm9wZXJ0aWVzID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdmFyIHNldCA9IHRoaXMuY2hhbmdlTWFwLmdldChub2RlKTtcbiAgICAgICAgaWYgKCFzZXQpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwLnNldChub2RlLCBzZXQgPSB7fSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNldDtcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3RvcnNNYXRjaDtcbn0oKSk7XG5leHBvcnRzLlNlbGVjdG9yc01hdGNoID0gU2VsZWN0b3JzTWF0Y2g7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jc3Mtc2VsZWN0b3IuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgRm9udCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRm9udChmb250RmFtaWx5LCBmb250U2l6ZSwgZm9udFN0eWxlLCBmb250V2VpZ2h0KSB7XG4gICAgICAgIHRoaXMuZm9udEZhbWlseSA9IGZvbnRGYW1pbHk7XG4gICAgICAgIHRoaXMuZm9udFNpemUgPSBmb250U2l6ZTtcbiAgICAgICAgdGhpcy5mb250U3R5bGUgPSBmb250U3R5bGU7XG4gICAgICAgIHRoaXMuZm9udFdlaWdodCA9IGZvbnRXZWlnaHQ7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb250LnByb3RvdHlwZSwgXCJpc0l0YWxpY1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9udFN0eWxlID09PSBGb250U3R5bGUuSVRBTElDO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9udC5wcm90b3R5cGUsIFwiaXNCb2xkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb250V2VpZ2h0ID09PSBGb250V2VpZ2h0LlNFTUlfQk9MRCB8fFxuICAgICAgICAgICAgICAgIHRoaXMuZm9udFdlaWdodCA9PT0gRm9udFdlaWdodC5CT0xEIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5mb250V2VpZ2h0ID09PSBcIjcwMFwiIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5mb250V2VpZ2h0ID09PSBGb250V2VpZ2h0LkVYVFJBX0JPTEQgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuQkxBQ0s7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZvbnQuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgICAgIGlmICghdmFsdWUxICYmICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUxIHx8ICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWUxLmZvbnRGYW1pbHkgPT09IHZhbHVlMi5mb250RmFtaWx5ICYmXG4gICAgICAgICAgICB2YWx1ZTEuZm9udFNpemUgPT09IHZhbHVlMi5mb250U2l6ZSAmJlxuICAgICAgICAgICAgdmFsdWUxLmZvbnRTdHlsZSA9PT0gdmFsdWUyLmZvbnRTdHlsZSAmJlxuICAgICAgICAgICAgdmFsdWUxLmZvbnRXZWlnaHQgPT09IHZhbHVlMi5mb250V2VpZ2h0O1xuICAgIH07XG4gICAgRm9udC5kZWZhdWx0ID0gdW5kZWZpbmVkO1xuICAgIHJldHVybiBGb250O1xufSgpKTtcbmV4cG9ydHMuRm9udCA9IEZvbnQ7XG52YXIgRm9udFN0eWxlO1xuKGZ1bmN0aW9uIChGb250U3R5bGUpIHtcbiAgICBGb250U3R5bGUuTk9STUFMID0gXCJub3JtYWxcIjtcbiAgICBGb250U3R5bGUuSVRBTElDID0gXCJpdGFsaWNcIjtcbiAgICBGb250U3R5bGUuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKEZvbnRTdHlsZS5OT1JNQUwsIEZvbnRTdHlsZS5JVEFMSUMpO1xuICAgIEZvbnRTdHlsZS5wYXJzZSA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKEZvbnRTdHlsZS5pc1ZhbGlkKTtcbn0pKEZvbnRTdHlsZSA9IGV4cG9ydHMuRm9udFN0eWxlIHx8IChleHBvcnRzLkZvbnRTdHlsZSA9IHt9KSk7XG52YXIgRm9udFdlaWdodDtcbihmdW5jdGlvbiAoRm9udFdlaWdodCkge1xuICAgIEZvbnRXZWlnaHQuVEhJTiA9IFwiMTAwXCI7XG4gICAgRm9udFdlaWdodC5FWFRSQV9MSUdIVCA9IFwiMjAwXCI7XG4gICAgRm9udFdlaWdodC5MSUdIVCA9IFwiMzAwXCI7XG4gICAgRm9udFdlaWdodC5OT1JNQUwgPSBcIm5vcm1hbFwiO1xuICAgIEZvbnRXZWlnaHQuTUVESVVNID0gXCI1MDBcIjtcbiAgICBGb250V2VpZ2h0LlNFTUlfQk9MRCA9IFwiNjAwXCI7XG4gICAgRm9udFdlaWdodC5CT0xEID0gXCJib2xkXCI7XG4gICAgRm9udFdlaWdodC5FWFRSQV9CT0xEID0gXCI4MDBcIjtcbiAgICBGb250V2VpZ2h0LkJMQUNLID0gXCI5MDBcIjtcbiAgICBGb250V2VpZ2h0LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihGb250V2VpZ2h0LlRISU4sIEZvbnRXZWlnaHQuRVhUUkFfTElHSFQsIEZvbnRXZWlnaHQuTElHSFQsIEZvbnRXZWlnaHQuTk9STUFMLCBcIjQwMFwiLCBGb250V2VpZ2h0Lk1FRElVTSwgRm9udFdlaWdodC5TRU1JX0JPTEQsIEZvbnRXZWlnaHQuQk9MRCwgXCI3MDBcIiwgRm9udFdlaWdodC5FWFRSQV9CT0xELCBGb250V2VpZ2h0LkJMQUNLKTtcbiAgICBGb250V2VpZ2h0LnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoRm9udFdlaWdodC5pc1ZhbGlkKTtcbn0pKEZvbnRXZWlnaHQgPSBleHBvcnRzLkZvbnRXZWlnaHQgfHwgKGV4cG9ydHMuRm9udFdlaWdodCA9IHt9KSk7XG5mdW5jdGlvbiBwYXJzZUZvbnRGYW1pbHkodmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KCk7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgc3BsaXQgPSB2YWx1ZS5zcGxpdChcIixcIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcGxpdC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgc3RyID0gc3BsaXRbaV0udHJpbSgpLnJlcGxhY2UoL1snXCJdKy9nLCBcIlwiKTtcbiAgICAgICAgaWYgKHN0cikge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goc3RyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5wYXJzZUZvbnRGYW1pbHkgPSBwYXJzZUZvbnRGYW1pbHk7XG52YXIgZ2VuZXJpY0ZvbnRGYW1pbGllcztcbihmdW5jdGlvbiAoZ2VuZXJpY0ZvbnRGYW1pbGllcykge1xuICAgIGdlbmVyaWNGb250RmFtaWxpZXMuc2VyaWYgPSBcInNlcmlmXCI7XG4gICAgZ2VuZXJpY0ZvbnRGYW1pbGllcy5zYW5zU2VyaWYgPSBcInNhbnMtc2VyaWZcIjtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLm1vbm9zcGFjZSA9IFwibW9ub3NwYWNlXCI7XG4gICAgZ2VuZXJpY0ZvbnRGYW1pbGllcy5zeXN0ZW0gPSBcInN5c3RlbVwiO1xufSkoZ2VuZXJpY0ZvbnRGYW1pbGllcyA9IGV4cG9ydHMuZ2VuZXJpY0ZvbnRGYW1pbGllcyB8fCAoZXhwb3J0cy5nZW5lcmljRm9udEZhbWlsaWVzID0ge30pKTtcbnZhciBzdHlsZXMgPSBuZXcgU2V0KCk7XG5bXG4gICAgRm9udFN0eWxlLk5PUk1BTCxcbiAgICBGb250U3R5bGUuSVRBTElDXG5dLmZvckVhY2goZnVuY3Rpb24gKHZhbCwgaSwgYSkgeyByZXR1cm4gc3R5bGVzLmFkZCh2YWwpOyB9KTtcbnZhciB3ZWlnaHRzID0gbmV3IFNldCgpO1xuW1xuICAgIEZvbnRXZWlnaHQuVEhJTixcbiAgICBGb250V2VpZ2h0LkVYVFJBX0xJR0hULFxuICAgIEZvbnRXZWlnaHQuTElHSFQsXG4gICAgRm9udFdlaWdodC5OT1JNQUwsXG4gICAgXCI0MDBcIixcbiAgICBGb250V2VpZ2h0Lk1FRElVTSxcbiAgICBGb250V2VpZ2h0LlNFTUlfQk9MRCxcbiAgICBGb250V2VpZ2h0LkJPTEQsXG4gICAgXCI3MDBcIixcbiAgICBGb250V2VpZ2h0LkVYVFJBX0JPTEQsXG4gICAgRm9udFdlaWdodC5CTEFDS1xuXS5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGksIGEpIHsgcmV0dXJuIHdlaWdodHMuYWRkKHZhbCk7IH0pO1xuZnVuY3Rpb24gcGFyc2VGb250KGZvbnRWYWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGZvbnRTdHlsZTogXCJub3JtYWxcIixcbiAgICAgICAgZm9udFZhcmlhbnQ6IFwibm9ybWFsXCIsXG4gICAgICAgIGZvbnRXZWlnaHQ6IFwibm9ybWFsXCJcbiAgICB9O1xuICAgIHZhciBwYXJ0cyA9IGZvbnRWYWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIHZhciBwYXJ0O1xuICAgIHdoaWxlIChwYXJ0ID0gcGFydHMuc2hpZnQoKSkge1xuICAgICAgICBpZiAocGFydCA9PT0gXCJub3JtYWxcIikge1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcnQgPT09IFwic21hbGwtY2Fwc1wiKSB7XG4gICAgICAgICAgICByZXN1bHQuZm9udFZhcmlhbnQgPSBwYXJ0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN0eWxlcy5oYXMocGFydCkpIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250U3R5bGUgPSBwYXJ0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHdlaWdodHMuaGFzKHBhcnQpKSB7XG4gICAgICAgICAgICByZXN1bHQuZm9udFdlaWdodCA9IHBhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXJlc3VsdC5mb250U2l6ZSkge1xuICAgICAgICAgICAgdmFyIHNpemVzID0gcGFydC5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICByZXN1bHQuZm9udFNpemUgPSBzaXplc1swXTtcbiAgICAgICAgICAgIHJlc3VsdC5saW5lSGVpZ2h0ID0gc2l6ZXMubGVuZ3RoID4gMSA/IHNpemVzWzFdIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRGYW1pbHkgPSBwYXJ0O1xuICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5mb250RmFtaWx5ICs9IFwiIFwiICsgcGFydHMuam9pbihcIiBcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5wYXJzZUZvbnQgPSBwYXJzZUZvbnQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mb250LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZvbnRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9mb250LWNvbW1vblwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIGFwcGxpY2F0aW9uID0gcmVxdWlyZShcIi4uLy4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIGZzID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZm9udC1jb21tb25cIikpO1xudmFyIEZPTlRTX0JBU0VfUEFUSCA9IFwiL2ZvbnRzL1wiO1xudmFyIHR5cGVmYWNlQ2FjaGUgPSBuZXcgTWFwKCk7XG52YXIgYXBwQXNzZXRzO1xudmFyIEZvbnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGb250LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZvbnQoZmFtaWx5LCBzaXplLCBzdHlsZSwgd2VpZ2h0KSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBmYW1pbHksIHNpemUsIHN0eWxlLCB3ZWlnaHQpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250RmFtaWx5ID0gZnVuY3Rpb24gKGZhbWlseSkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQoZmFtaWx5LCB0aGlzLmZvbnRTaXplLCB0aGlzLmZvbnRTdHlsZSwgdGhpcy5mb250V2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250U3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KHRoaXMuZm9udEZhbWlseSwgdGhpcy5mb250U2l6ZSwgc3R5bGUsIHRoaXMuZm9udFdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udFdlaWdodCA9IGZ1bmN0aW9uICh3ZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KHRoaXMuZm9udEZhbWlseSwgdGhpcy5mb250U2l6ZSwgdGhpcy5mb250U3R5bGUsIHdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udFNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQodGhpcy5mb250RmFtaWx5LCBzaXplLCB0aGlzLmZvbnRTdHlsZSwgdGhpcy5mb250V2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLmdldEFuZHJvaWRUeXBlZmFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl90eXBlZmFjZSkge1xuICAgICAgICAgICAgdGhpcy5fdHlwZWZhY2UgPSBjcmVhdGVUeXBlZmFjZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZWZhY2U7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS5nZXRVSUZvbnQgPSBmdW5jdGlvbiAoZGVmYXVsdEZvbnQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIEZvbnQuZGVmYXVsdCA9IG5ldyBGb250KHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBcIm5vcm1hbFwiLCBcIm5vcm1hbFwiKTtcbiAgICByZXR1cm4gRm9udDtcbn0oZm9udF9jb21tb25fMS5Gb250KSk7XG5leHBvcnRzLkZvbnQgPSBGb250O1xuZnVuY3Rpb24gbG9hZEZvbnRGcm9tRmlsZShmb250RmFtaWx5KSB7XG4gICAgYXBwQXNzZXRzID0gYXBwQXNzZXRzIHx8IGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dC5nZXRBc3NldHMoKTtcbiAgICBpZiAoIWFwcEFzc2V0cykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IHR5cGVmYWNlQ2FjaGUuZ2V0KGZvbnRGYW1pbHkpO1xuICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXN1bHQgPSBudWxsO1xuICAgICAgICB2YXIgZm9udEFzc2V0UGF0aCA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGJhc2VQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgXCJmb250c1wiLCBmb250RmFtaWx5KTtcbiAgICAgICAgaWYgKGZzLkZpbGUuZXhpc3RzKGJhc2VQYXRoICsgXCIudHRmXCIpKSB7XG4gICAgICAgICAgICBmb250QXNzZXRQYXRoID0gRk9OVFNfQkFTRV9QQVRIICsgZm9udEZhbWlseSArIFwiLnR0ZlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGZzLkZpbGUuZXhpc3RzKGJhc2VQYXRoICsgXCIub3RmXCIpKSB7XG4gICAgICAgICAgICBmb250QXNzZXRQYXRoID0gRk9OVFNfQkFTRV9QQVRIICsgZm9udEZhbWlseSArIFwiLm90ZlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ291bGQgbm90IGZpbmQgZm9udCBmaWxlIGZvciBcIiArIGZvbnRGYW1pbHksIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvbnRBc3NldFBhdGgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZm9udEFzc2V0UGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIGZvbnRBc3NldFBhdGgpO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuY3JlYXRlRnJvbUZpbGUoZm9udEFzc2V0UGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJFcnJvciBsb2FkaW5nIGZvbnQgYXNzZXQ6IFwiICsgZm9udEFzc2V0UGF0aCwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdHlwZWZhY2VDYWNoZS5zZXQoZm9udEZhbWlseSwgcmVzdWx0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVR5cGVmYWNlKGZvbnQpIHtcbiAgICB2YXIgZm9udFN0eWxlID0gMDtcbiAgICBpZiAoZm9udC5pc0JvbGQpIHtcbiAgICAgICAgZm9udFN0eWxlIHw9IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuQk9MRDtcbiAgICB9XG4gICAgaWYgKGZvbnQuaXNJdGFsaWMpIHtcbiAgICAgICAgZm9udFN0eWxlIHw9IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuSVRBTElDO1xuICAgIH1cbiAgICB2YXIgZm9udHMgPSBmb250X2NvbW1vbl8xLnBhcnNlRm9udEZhbWlseShmb250LmZvbnRGYW1pbHkpO1xuICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9udHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3dpdGNoIChmb250c1tpXS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5zZXJpZjpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLmNyZWF0ZShcInNlcmlmXCIgKyBnZXRGb250V2VpZ2h0U3VmZml4KGZvbnQuZm9udFdlaWdodCksIGZvbnRTdHlsZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5zYW5zU2VyaWY6XG4gICAgICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5zeXN0ZW06XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5jcmVhdGUoXCJzYW5zLXNlcmlmXCIgKyBnZXRGb250V2VpZ2h0U3VmZml4KGZvbnQuZm9udFdlaWdodCksIGZvbnRTdHlsZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5tb25vc3BhY2U6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5jcmVhdGUoXCJtb25vc3BhY2VcIiArIGdldEZvbnRXZWlnaHRTdWZmaXgoZm9udC5mb250V2VpZ2h0KSwgZm9udFN0eWxlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbG9hZEZvbnRGcm9tRmlsZShmb250c1tpXSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiBmb250U3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5jcmVhdGUocmVzdWx0LCBmb250U3R5bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXN1bHQgPSBhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLmNyZWF0ZShcInNhbnMtc2VyaWZcIiArIGdldEZvbnRXZWlnaHRTdWZmaXgoZm9udC5mb250V2VpZ2h0KSwgZm9udFN0eWxlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldEZvbnRXZWlnaHRTdWZmaXgoZm9udFdlaWdodCkge1xuICAgIHN3aXRjaCAoZm9udFdlaWdodCkge1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5USElOOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWQub3MuQnVpbGQuVkVSU0lPTi5TREtfSU5UID49IDE2ID8gXCItdGhpblwiIDogXCJcIjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuRVhUUkFfTElHSFQ6XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LkxJR0hUOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWQub3MuQnVpbGQuVkVSU0lPTi5TREtfSU5UID49IDE2ID8gXCItbGlnaHRcIiA6IFwiXCI7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0Lk5PUk1BTDpcbiAgICAgICAgY2FzZSBcIjQwMFwiOlxuICAgICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgY2FzZSBudWxsOlxuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0Lk1FRElVTTpcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuU0VNSV9CT0xEOlxuICAgICAgICAgICAgcmV0dXJuIGFuZHJvaWQub3MuQnVpbGQuVkVSU0lPTi5TREtfSU5UID49IDIxID8gXCItbWVkaXVtXCIgOiBcIlwiO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5CT0xEOlxuICAgICAgICBjYXNlIFwiNzAwXCI6XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LkVYVFJBX0JPTEQ6XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuQkxBQ0s6XG4gICAgICAgICAgICByZXR1cm4gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQgPj0gMjEgPyBcIi1ibGFja1wiIDogXCJcIjtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZm9udCB3ZWlnaHQ6IFxcXCJcIiArIGZvbnRXZWlnaHQgKyBcIlxcXCJcIik7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9udC5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xudmFyIExpbmVhckdyYWRpZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMaW5lYXJHcmFkaWVudCgpIHtcbiAgICB9XG4gICAgTGluZWFyR3JhZGllbnQucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBMaW5lYXJHcmFkaWVudCgpO1xuICAgICAgICByZXN1bHQuYW5nbGUgPSB2YWx1ZS5hbmdsZTtcbiAgICAgICAgcmVzdWx0LmNvbG9yU3RvcHMgPSB2YWx1ZS5jb2xvcnMubWFwKGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbG9yLm9mZnNldCB8fCBudWxsO1xuICAgICAgICAgICAgdmFyIG9mZnNldFVuaXQ7XG4gICAgICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgICAgIG9mZnNldFVuaXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiJVwiLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb2Zmc2V0LnZhbHVlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY29sb3I6IG5ldyBjb2xvcl8xLkNvbG9yKGNvbG9yLmFyZ2IpLFxuICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0VW5pdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBMaW5lYXJHcmFkaWVudC5lcXVhbHMgPSBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoIWZpcnN0ICYmICFzZWNvbmQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFmaXJzdCB8fCAhc2Vjb25kKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpcnN0LmFuZ2xlICE9PSBzZWNvbmQuYW5nbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3QuY29sb3JTdG9wcy5sZW5ndGggIT09IHNlY29uZC5jb2xvclN0b3BzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlyc3QuY29sb3JTdG9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGZpcnN0U3RvcCA9IGZpcnN0LmNvbG9yU3RvcHNbaV07XG4gICAgICAgICAgICB2YXIgc2Vjb25kU3RvcCA9IHNlY29uZC5jb2xvclN0b3BzW2ldO1xuICAgICAgICAgICAgaWYgKGZpcnN0U3RvcC5vZmZzZXQgIT09IHNlY29uZFN0b3Aub2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjb2xvcl8xLkNvbG9yLmVxdWFscyhmaXJzdFN0b3AuY29sb3IsIHNlY29uZFN0b3AuY29sb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIExpbmVhckdyYWRpZW50O1xufSgpKTtcbmV4cG9ydHMuTGluZWFyR3JhZGllbnQgPSBMaW5lYXJHcmFkaWVudDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpbmVhci1ncmFkaWVudC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xudmFyIGZvbnRfMSA9IHJlcXVpcmUoXCIuLi8uLi91aS9zdHlsaW5nL2ZvbnRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBiYWNrZ3JvdW5kXzEgPSByZXF1aXJlKFwiLi4vLi4vdWkvc3R5bGluZy9iYWNrZ3JvdW5kXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbnVtYmVyX3V0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbnVtYmVyLXV0aWxzXCIpO1xudmFyIG1hdHJpeF8xID0gcmVxdWlyZShcIi4uLy4uL21hdHJpeFwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHBhcnNlciA9IHJlcXVpcmUoXCIuLi8uLi9jc3MvcGFyc2VyXCIpO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xuZnVuY3Rpb24gZXF1YWxzQ29tbW9uKGEsIGIpIHtcbiAgICBpZiAoYSA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gYiA9PSBcImF1dG9cIjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGlmIChiID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBiID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gYSA9PSBiO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiLnVuaXQgPT0gXCJkaXBcIiAmJiBhID09IGIudmFsdWU7XG4gICAgfVxuICAgIGlmIChiID09IFwiYXV0b1wiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBiID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiBhID8gKGEudW5pdCA9PSBcImRpcFwiICYmIGEudmFsdWUgPT0gYikgOiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCFhIHx8ICFiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGEudmFsdWUgPT0gYi52YWx1ZSAmJiBhLnVuaXQgPT0gYi51bml0O1xufVxuZnVuY3Rpb24gY29udmVydFRvU3RyaW5nQ29tbW9uKGxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIFwiYXV0b1wiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICByZXR1cm4gbGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHZhciB2YWwgPSBsZW5ndGgudmFsdWU7XG4gICAgaWYgKGxlbmd0aC51bml0ID09PSBcIiVcIikge1xuICAgICAgICB2YWwgKj0gMTAwO1xuICAgIH1cbiAgICByZXR1cm4gdmFsICsgbGVuZ3RoLnVuaXQ7XG59XG5mdW5jdGlvbiB0b0RldmljZVBpeGVsc0NvbW1vbihsZW5ndGgsIGF1dG8sIHBhcmVudEF2YWlsYWJsZVdpZHRoKSB7XG4gICAgaWYgKGF1dG8gPT09IHZvaWQgMCkgeyBhdXRvID0gTnVtYmVyLk5hTjsgfVxuICAgIGlmIChwYXJlbnRBdmFpbGFibGVXaWR0aCA9PT0gdm9pZCAwKSB7IHBhcmVudEF2YWlsYWJsZVdpZHRoID0gTnVtYmVyLk5hTjsgfVxuICAgIGlmIChsZW5ndGggPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIGF1dG87XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZCh1dGlsc18xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgpKTtcbiAgICB9XG4gICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGF1dG87XG4gICAgfVxuICAgIHN3aXRjaCAobGVuZ3RoLnVuaXQpIHtcbiAgICAgICAgY2FzZSBcInB4XCI6XG4gICAgICAgICAgICByZXR1cm4gdXRpbHNfMS5sYXlvdXQucm91bmQobGVuZ3RoLnZhbHVlKTtcbiAgICAgICAgY2FzZSBcIiVcIjpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZChwYXJlbnRBdmFpbGFibGVXaWR0aCAqIGxlbmd0aC52YWx1ZSk7XG4gICAgICAgIGNhc2UgXCJkaXBcIjpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZCh1dGlsc18xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgudmFsdWUpKTtcbiAgICB9XG59XG52YXIgUGVyY2VudExlbmd0aDtcbihmdW5jdGlvbiAoUGVyY2VudExlbmd0aCkge1xuICAgIGZ1bmN0aW9uIHBhcnNlKGZyb21WYWx1ZSkge1xuICAgICAgICBpZiAoZnJvbVZhbHVlID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmcm9tVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9IGZyb21WYWx1ZS50cmltKCk7XG4gICAgICAgICAgICB2YXIgcGVyY2VudEluZGV4ID0gc3RyaW5nVmFsdWUuaW5kZXhPZihcIiVcIik7XG4gICAgICAgICAgICBpZiAocGVyY2VudEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAocGVyY2VudEluZGV4ICE9PSAoc3RyaW5nVmFsdWUubGVuZ3RoIC0gMSkgfHwgcGVyY2VudEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gTnVtYmVyLk5hTjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdChzdHJpbmdWYWx1ZS5zdWJzdHJpbmcoMCwgc3RyaW5nVmFsdWUubGVuZ3RoIC0gMSkudHJpbSgpKSAvIDEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSB8fCAhaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgZnJvbVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdW5pdDogXCIlXCIsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nVmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gc3RyaW5nVmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4geyB1bml0OiBcInB4XCIsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcGFyc2VGbG9hdChzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSB8fCAhaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgZnJvbVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21WYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQZXJjZW50TGVuZ3RoLnBhcnNlID0gcGFyc2U7XG4gICAgUGVyY2VudExlbmd0aC5lcXVhbHMgPSBlcXVhbHNDb21tb247XG4gICAgUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzQ29tbW9uO1xuICAgIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nID0gY29udmVydFRvU3RyaW5nQ29tbW9uO1xufSkoUGVyY2VudExlbmd0aCA9IGV4cG9ydHMuUGVyY2VudExlbmd0aCB8fCAoZXhwb3J0cy5QZXJjZW50TGVuZ3RoID0ge30pKTtcbnZhciBMZW5ndGg7XG4oZnVuY3Rpb24gKExlbmd0aCkge1xuICAgIGZ1bmN0aW9uIHBhcnNlKGZyb21WYWx1ZSkge1xuICAgICAgICBpZiAoZnJvbVZhbHVlID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmcm9tVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9IGZyb21WYWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAoc3RyaW5nVmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gc3RyaW5nVmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHVuaXQ6IFwicHhcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmcm9tVmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgTGVuZ3RoLnBhcnNlID0gcGFyc2U7XG4gICAgTGVuZ3RoLmVxdWFscyA9IGVxdWFsc0NvbW1vbjtcbiAgICBMZW5ndGgudG9EZXZpY2VQaXhlbHMgPSB0b0RldmljZVBpeGVsc0NvbW1vbjtcbiAgICBMZW5ndGguY29udmVydFRvU3RyaW5nID0gY29udmVydFRvU3RyaW5nQ29tbW9uO1xufSkoTGVuZ3RoID0gZXhwb3J0cy5MZW5ndGggfHwgKGV4cG9ydHMuTGVuZ3RoID0ge30pKTtcbmV4cG9ydHMuemVyb0xlbmd0aCA9IHsgdmFsdWU6IDAsIHVuaXQ6IFwicHhcIiB9O1xuZXhwb3J0cy5taW5XaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW5XaWR0aFwiLCBjc3NOYW1lOiBcIm1pbi13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5XaWR0aCA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLm1pbldpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMubWluSGVpZ2h0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbkhlaWdodFwiLCBjc3NOYW1lOiBcIm1pbi1oZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlTWluSGVpZ2h0ID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMubWluSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMud2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoe1xuICAgIG5hbWU6IFwid2lkdGhcIiwgY3NzTmFtZTogXCJ3aWR0aFwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b1wiLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2aWV3LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMud2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5oZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaGVpZ2h0XCIsIGNzc05hbWU6IFwiaGVpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UsXG59KTtcbmV4cG9ydHMuaGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBtYXJnaW5Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWFyZ2luXCIsIGNzc05hbWU6IFwibWFyZ2luXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChQZXJjZW50TGVuZ3RoLmVxdWFscyh0aGlzLm1hcmdpblRvcCwgdGhpcy5tYXJnaW5SaWdodCkgJiZcbiAgICAgICAgICAgIFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpbkJvdHRvbSkgJiZcbiAgICAgICAgICAgIFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpbkxlZnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXJnaW5Ub3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMubWFyZ2luVG9wKSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5SaWdodCkgKyBcIiBcIiArIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMubWFyZ2luQm90dG9tKSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5MZWZ0KTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvTWFyZ2luc1xufSk7XG5tYXJnaW5Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJtYXJnaW5MZWZ0XCIsIGNzc05hbWU6IFwibWFyZ2luLWxlZnRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpblJpZ2h0XCIsIGNzc05hbWU6IFwibWFyZ2luLXJpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogUGVyY2VudExlbmd0aC5wYXJzZSB9KTtcbmV4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpblRvcFwiLCBjc3NOYW1lOiBcIm1hcmdpbi10b3BcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpbkJvdHRvbVwiLCBjc3NOYW1lOiBcIm1hcmdpbi1ib3R0b21cIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIHBhZGRpbmdQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1wiLCBjc3NOYW1lOiBcInBhZGRpbmdcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdSaWdodCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdCb3R0b20pICYmXG4gICAgICAgICAgICBMZW5ndGguZXF1YWxzKHRoaXMucGFkZGluZ1RvcCwgdGhpcy5wYWRkaW5nTGVmdCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZGRpbmdUb3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5wYWRkaW5nVG9wKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdSaWdodCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5wYWRkaW5nQm90dG9tKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdMZWZ0KTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvUGFkZGluZ3Ncbn0pO1xucGFkZGluZ1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInBhZGRpbmdMZWZ0XCIsIGNzc05hbWU6IFwicGFkZGluZy1sZWZ0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1JpZ2h0XCIsIGNzc05hbWU6IFwicGFkZGluZy1yaWdodFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInBhZGRpbmdUb3BcIiwgY3NzTmFtZTogXCJwYWRkaW5nLXRvcFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVQYWRkaW5nVG9wID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ0JvdHRvbVwiLCBjc3NOYW1lOiBcInBhZGRpbmctYm90dG9tXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nQm90dG9tUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBIb3Jpem9udGFsQWxpZ25tZW50O1xuKGZ1bmN0aW9uIChIb3Jpem9udGFsQWxpZ25tZW50KSB7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5MRUZUID0gXCJsZWZ0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQuUklHSFQgPSBcInJpZ2h0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoSG9yaXpvbnRhbEFsaWdubWVudC5MRUZULCBIb3Jpem9udGFsQWxpZ25tZW50LkNFTlRFUiwgSG9yaXpvbnRhbEFsaWdubWVudC5SSUdIVCwgSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENIKTtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoSG9yaXpvbnRhbEFsaWdubWVudC5pc1ZhbGlkKTtcbn0pKEhvcml6b250YWxBbGlnbm1lbnQgPSBleHBvcnRzLkhvcml6b250YWxBbGlnbm1lbnQgfHwgKGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCA9IHt9KSk7XG5leHBvcnRzLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImhvcml6b250YWxBbGlnbm1lbnRcIiwgY3NzTmFtZTogXCJob3Jpem9udGFsLWFsaWduXCIsIGRlZmF1bHRWYWx1ZTogSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogSG9yaXpvbnRhbEFsaWdubWVudC5wYXJzZSB9KTtcbmV4cG9ydHMuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgVmVydGljYWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFZlcnRpY2FsQWxpZ25tZW50KSB7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuVE9QID0gXCJ0b3BcIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5NSURETEUgPSBcIm1pZGRsZVwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LkJPVFRPTSA9IFwiYm90dG9tXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuU1RSRVRDSCA9IFwic3RyZXRjaFwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihWZXJ0aWNhbEFsaWdubWVudC5UT1AsIFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSwgVmVydGljYWxBbGlnbm1lbnQuQk9UVE9NLCBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENIKTtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjZW50ZXJcIiA/IFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSA6IHBhcnNlU3RyaWN0KHZhbHVlKTsgfTtcbiAgICB2YXIgcGFyc2VTdHJpY3QgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihWZXJ0aWNhbEFsaWdubWVudC5pc1ZhbGlkKTtcbn0pKFZlcnRpY2FsQWxpZ25tZW50ID0gZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCA9IHt9KSk7XG5leHBvcnRzLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ2ZXJ0aWNhbEFsaWdubWVudFwiLCBjc3NOYW1lOiBcInZlcnRpY2FsLWFsaWduXCIsIGRlZmF1bHRWYWx1ZTogVmVydGljYWxBbGlnbm1lbnQuU1RSRVRDSCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IFZlcnRpY2FsQWxpZ25tZW50LnBhcnNlIH0pO1xuZXhwb3J0cy52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBwYXJzZVRoaWNrbmVzcyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bICxdKy8pO1xuICAgICAgICB2YXIgdG9wXzE7XG4gICAgICAgIHZhciByaWdodCA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGJvdHRvbSA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGxlZnQgPSB2b2lkIDA7XG4gICAgICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzBdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzBdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIGJvdHRvbSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclsxXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclsxXTtcbiAgICAgICAgICAgIGJvdHRvbSA9IGFyclsyXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzJdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclszXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEsIDIsIDMgb3IgNCBwYXJhbWV0ZXJzLiBBY3R1YWw6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3A6IHRvcF8xLFxuICAgICAgICAgICAgcmlnaHQ6IHJpZ2h0LFxuICAgICAgICAgICAgYm90dG9tOiBib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiBsZWZ0XG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufVxuZnVuY3Rpb24gY29udmVydFRvTWFyZ2lucyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgIHZhciB0aGlja25lc3MgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSwgUGVyY2VudExlbmd0aC5wYXJzZSh0aGlja25lc3MudG9wKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5yaWdodCldLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luQm90dG9tUHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLmJvdHRvbSldLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luTGVmdFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5sZWZ0KV1cbiAgICAgICAgXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luQm90dG9tUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgIF07XG4gICAgfVxufVxuZnVuY3Rpb24gY29udmVydFRvUGFkZGluZ3ModmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlICE9PSBcImF1dG9cIikge1xuICAgICAgICB2YXIgdGhpY2tuZXNzID0gcGFyc2VUaGlja25lc3ModmFsdWUpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LCBMZW5ndGgucGFyc2UodGhpY2tuZXNzLnRvcCldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1JpZ2h0UHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MucmlnaHQpXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5ib3R0b20pXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MubGVmdCldXG4gICAgICAgIF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nTGVmdFByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5leHBvcnRzLnJvdGF0ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwicm90YXRlXCIsIGNzc05hbWU6IFwicm90YXRlXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnJvdGF0ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnNjYWxlWFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwic2NhbGVYXCIsIGNzc05hbWU6IFwic2NhbGVYXCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnNjYWxlWFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnNjYWxlWVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwic2NhbGVZXCIsIGNzc05hbWU6IFwic2NhbGVZXCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnNjYWxlWVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBwYXJzZURJUHModmFsdWUpIHtcbiAgICBpZiAodmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhwYXJzZUZsb2F0KHZhbHVlLnJlcGxhY2UoXCJweFwiLCBcIlwiKS50cmltKCkpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlLnJlcGxhY2UoXCJkaXBcIiwgXCJcIikudHJpbSgpKTtcbiAgICB9XG59XG5leHBvcnRzLnRyYW5zbGF0ZVhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcInRyYW5zbGF0ZVhcIiwgY3NzTmFtZTogXCJ0cmFuc2xhdGVYXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRElQcyB9KTtcbmV4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnRyYW5zbGF0ZVlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcInRyYW5zbGF0ZVlcIiwgY3NzTmFtZTogXCJ0cmFuc2xhdGVZXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRElQcyB9KTtcbmV4cG9ydHMudHJhbnNsYXRlWVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgdHJhbnNmb3JtUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRyYW5zZm9ybVwiLCBjc3NOYW1lOiBcInRyYW5zZm9ybVwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2NhbGVYID0gdGhpcy5zY2FsZVg7XG4gICAgICAgIHZhciBzY2FsZVkgPSB0aGlzLnNjYWxlWTtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVg7XG4gICAgICAgIHZhciB0cmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZO1xuICAgICAgICB2YXIgcm90YXRlID0gdGhpcy5yb3RhdGU7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICBpZiAodHJhbnNsYXRlWCAhPT0gMCB8fCB0cmFuc2xhdGVZICE9PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJ0cmFuc2xhdGUoXCIgKyB0cmFuc2xhdGVYICsgXCIsIFwiICsgdHJhbnNsYXRlWSArIFwiKSBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NhbGVYICE9PSAxIHx8IHNjYWxlWSAhPT0gMSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwic2NhbGUoXCIgKyBzY2FsZVggKyBcIiwgXCIgKyBzY2FsZVkgKyBcIikgXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwicm90YXRlIChcIiArIHJvdGF0ZSArIFwiKVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQudHJpbSgpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9UcmFuc2Zvcm1cbn0pO1xudHJhbnNmb3JtUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBJREVOVElUWV9UUkFOU0ZPUk1BVElPTiA9IHtcbiAgICB0cmFuc2xhdGU6IHsgeDogMCwgeTogMCB9LFxuICAgIHJvdGF0ZTogMCxcbiAgICBzY2FsZTogeyB4OiAxLCB5OiAxIH0sXG59O1xudmFyIFRSQU5TRk9STV9TUExJVFRFUiA9IG5ldyBSZWdFeHAoL1xccyooLis/KVxcKCguKj8pXFwpL2cpO1xudmFyIFRSQU5TRk9STUFUSU9OUyA9IE9iamVjdC5mcmVlemUoW1xuICAgIFwicm90YXRlXCIsXG4gICAgXCJ0cmFuc2xhdGVcIixcbiAgICBcInRyYW5zbGF0ZTNkXCIsXG4gICAgXCJ0cmFuc2xhdGVYXCIsXG4gICAgXCJ0cmFuc2xhdGVZXCIsXG4gICAgXCJzY2FsZVwiLFxuICAgIFwic2NhbGUzZFwiLFxuICAgIFwic2NhbGVYXCIsXG4gICAgXCJzY2FsZVlcIixcbl0pO1xudmFyIFNUWUxFX1RSQU5TRk9STUFUSU9OX01BUCA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwic2NhbGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJzY2FsZTNkXCI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gKHsgcHJvcGVydHk6IFwic2NhbGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwic2NhbGVYXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLng7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogeyB4OiB4LCB5OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi5zY2FsZS55IH0gfSk7XG4gICAgfSxcbiAgICBcInNjYWxlWVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwic2NhbGVcIiwgdmFsdWU6IHsgeTogeSwgeDogSURFTlRJVFlfVFJBTlNGT1JNQVRJT04uc2NhbGUueCB9IH0pO1xuICAgIH0sXG4gICAgXCJ0cmFuc2xhdGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwidHJhbnNsYXRlM2RcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwidHJhbnNsYXRlWFwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHggPSBfYS54O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwidHJhbnNsYXRlXCIsIHZhbHVlOiB7IHg6IHgsIHk6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnRyYW5zbGF0ZS55IH0gfSk7XG4gICAgfSxcbiAgICBcInRyYW5zbGF0ZVlcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB5ID0gX2EueTtcbiAgICAgICAgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogeyB5OiB5LCB4OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi50cmFuc2xhdGUueCB9IH0pO1xuICAgIH0sXG4gICAgXCJyb3RhdGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJyb3RhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxufSk7XG5mdW5jdGlvbiBjb252ZXJ0VG9UcmFuc2Zvcm0odmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHByb3BlcnRpZXNfMS51bnNldFZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gXCJub25lXCI7XG4gICAgfVxuICAgIHZhciBfYSA9IHRyYW5zZm9ybUNvbnZlcnRlcih2YWx1ZSksIHRyYW5zbGF0ZSA9IF9hLnRyYW5zbGF0ZSwgcm90YXRlID0gX2Eucm90YXRlLCBzY2FsZSA9IF9hLnNjYWxlO1xuICAgIHJldHVybiBbXG4gICAgICAgIFtleHBvcnRzLnRyYW5zbGF0ZVhQcm9wZXJ0eSwgdHJhbnNsYXRlLnhdLFxuICAgICAgICBbZXhwb3J0cy50cmFuc2xhdGVZUHJvcGVydHksIHRyYW5zbGF0ZS55XSxcbiAgICAgICAgW2V4cG9ydHMuc2NhbGVYUHJvcGVydHksIHNjYWxlLnhdLFxuICAgICAgICBbZXhwb3J0cy5zY2FsZVlQcm9wZXJ0eSwgc2NhbGUueV0sXG4gICAgICAgIFtleHBvcnRzLnJvdGF0ZVByb3BlcnR5LCByb3RhdGVdLFxuICAgIF07XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm1Db252ZXJ0ZXIodGV4dCkge1xuICAgIHZhciB0cmFuc2Zvcm1hdGlvbnMgPSBwYXJzZVRyYW5zZm9ybVN0cmluZyh0ZXh0KTtcbiAgICBpZiAodGV4dCA9PT0gXCJub25lXCIgfHwgdGV4dCA9PT0gXCJcIiB8fCAhdHJhbnNmb3JtYXRpb25zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gSURFTlRJVFlfVFJBTlNGT1JNQVRJT047XG4gICAgfVxuICAgIHZhciB1c2VkVHJhbnNmb3JtcyA9IHRyYW5zZm9ybWF0aW9ucy5tYXAoZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQucHJvcGVydHk7IH0pO1xuICAgIGlmICghdXRpbHNfMS5oYXNEdXBsaWNhdGVzKHVzZWRUcmFuc2Zvcm1zKSkge1xuICAgICAgICB2YXIgZnVsbFRyYW5zZm9ybWF0aW9uc18xID0gX19hc3NpZ24oe30sIElERU5USVRZX1RSQU5TRk9STUFUSU9OKTtcbiAgICAgICAgdHJhbnNmb3JtYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xuICAgICAgICAgICAgZnVsbFRyYW5zZm9ybWF0aW9uc18xW3RyYW5zZm9ybS5wcm9wZXJ0eV0gPSB0cmFuc2Zvcm0udmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVsbFRyYW5zZm9ybWF0aW9uc18xO1xuICAgIH1cbiAgICB2YXIgYWZmaW5lTWF0cml4ID0gdHJhbnNmb3JtYXRpb25zXG4gICAgICAgIC5tYXAobWF0cml4XzEuZ2V0VHJhbnNmb3JtTWF0cml4KVxuICAgICAgICAucmVkdWNlKG1hdHJpeF8xLm11bHRpcGx5QWZmaW5lMmQpO1xuICAgIHZhciBjc3NNYXRyaXggPSBtYXRyaXhfMS5tYXRyaXhBcnJheVRvQ3NzTWF0cml4KGFmZmluZU1hdHJpeCk7XG4gICAgcmV0dXJuIG1hdHJpeF8xLmRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4KGNzc01hdHJpeCk7XG59XG5leHBvcnRzLnRyYW5zZm9ybUNvbnZlcnRlciA9IHRyYW5zZm9ybUNvbnZlcnRlcjtcbmZ1bmN0aW9uIHBhcnNlVHJhbnNmb3JtU3RyaW5nKHRleHQpIHtcbiAgICB2YXIgbWF0Y2hlcyA9IFtdO1xuICAgIHZhciBtYXRjaDtcbiAgICB3aGlsZSAoKG1hdGNoID0gVFJBTlNGT1JNX1NQTElUVEVSLmV4ZWModGV4dCkpICE9PSBudWxsKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IG1hdGNoWzFdO1xuICAgICAgICB2YXIgdmFsdWUgPSBjb252ZXJ0VHJhbnNmb3JtVmFsdWUocHJvcGVydHksIG1hdGNoWzJdKTtcbiAgICAgICAgaWYgKFRSQU5TRk9STUFUSU9OUy5pbmRleE9mKHByb3BlcnR5KSAhPT0gLTEpIHtcbiAgICAgICAgICAgIG1hdGNoZXMucHVzaChub3JtYWxpemVUcmFuc2Zvcm1hdGlvbih7IHByb3BlcnR5OiBwcm9wZXJ0eSwgdmFsdWU6IHZhbHVlIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWF0Y2hlcztcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVRyYW5zZm9ybWF0aW9uKF9hKSB7XG4gICAgdmFyIHByb3BlcnR5ID0gX2EucHJvcGVydHksIHZhbHVlID0gX2EudmFsdWU7XG4gICAgcmV0dXJuIFNUWUxFX1RSQU5TRk9STUFUSU9OX01BUFtwcm9wZXJ0eV0odmFsdWUpO1xufVxuZnVuY3Rpb24gY29udmVydFRyYW5zZm9ybVZhbHVlKHByb3BlcnR5LCBzdHJpbmdWYWx1ZSkge1xuICAgIHZhciBfYSA9IHN0cmluZ1ZhbHVlLnNwbGl0KFwiLFwiKS5tYXAocGFyc2VGbG9hdCksIHggPSBfYVswXSwgX2IgPSBfYVsxXSwgeSA9IF9iID09PSB2b2lkIDAgPyB4IDogX2I7XG4gICAgaWYgKHByb3BlcnR5ID09PSBcInJvdGF0ZVwiKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdWYWx1ZS5zbGljZSgtMykgPT09IFwicmFkXCIgPyBudW1iZXJfdXRpbHNfMS5yYWRpYW5zVG9EZWdyZWVzKHgpIDogeDtcbiAgICB9XG4gICAgcmV0dXJuIHsgeDogeCwgeTogeSB9O1xufVxudmFyIGJhY2tncm91bmRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFwiLCBjc3NOYW1lOiBcImJhY2tncm91bmRcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFja2dyb3VuZENvbG9yICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRJbWFnZSArIFwiIFwiICsgdGhpcy5iYWNrZ3JvdW5kUmVwZWF0ICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRQb3NpdGlvbjtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvQmFja2dyb3VuZHNcbn0pO1xuYmFja2dyb3VuZFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kSW50ZXJuYWxcIixcbiAgICBjc3NOYW1lOiBcIl9iYWNrZ3JvdW5kSW50ZXJuYWxcIixcbiAgICBkZWZhdWx0VmFsdWU6IGJhY2tncm91bmRfMS5CYWNrZ3JvdW5kLmRlZmF1bHRcbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZEltYWdlXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1pbWFnZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEltYWdlKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSxcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKHZhbHVlMSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50ICYmIHZhbHVlMiBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQuZXF1YWxzKHZhbHVlMSwgdmFsdWUyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTEgPT09IHZhbHVlMjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgcGFyc2VkID0gcGFyc2VyLnBhcnNlQmFja2dyb3VuZCh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAocGFyc2VkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhY2tncm91bmQgPSBwYXJzZWQudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAodHlwZW9mIGJhY2tncm91bmQuaW1hZ2UgPT09IFwib2JqZWN0XCIpID8gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQucGFyc2UoYmFja2dyb3VuZC5pbWFnZSkgOiB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kQ29sb3JcIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQ29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBCYWNrZ3JvdW5kUmVwZWF0O1xuKGZ1bmN0aW9uIChCYWNrZ3JvdW5kUmVwZWF0KSB7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVQgPSBcInJlcGVhdFwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1ggPSBcInJlcGVhdC14XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWSA9IFwicmVwZWF0LXlcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0Lk5PX1JFUEVBVCA9IFwibm8tcmVwZWF0XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoQmFja2dyb3VuZFJlcGVhdC5SRVBFQVQsIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1gsIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1ksIEJhY2tncm91bmRSZXBlYXQuTk9fUkVQRUFUKTtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoQmFja2dyb3VuZFJlcGVhdC5pc1ZhbGlkKTtcbn0pKEJhY2tncm91bmRSZXBlYXQgPSBleHBvcnRzLkJhY2tncm91bmRSZXBlYXQgfHwgKGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCA9IHt9KSk7XG5leHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFJlcGVhdFwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtcmVwZWF0XCIsIHZhbHVlQ29udmVydGVyOiBCYWNrZ3JvdW5kUmVwZWF0LnBhcnNlLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoUmVwZWF0KG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU2l6ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kU2l6ZVwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtc2l6ZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aFNpemUobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFNpemVQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFBvc2l0aW9uXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1wb3NpdGlvblwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aFBvc2l0aW9uKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBjb252ZXJ0VG9CYWNrZ3JvdW5kcyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmRzID0gcGFyc2VyLnBhcnNlQmFja2dyb3VuZCh2YWx1ZSkudmFsdWU7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kcy5jb2xvciA/IG5ldyBjb2xvcl8xLkNvbG9yKGJhY2tncm91bmRzLmNvbG9yKSA6IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB2YXIgYmFja2dyb3VuZEltYWdlID0gdm9pZCAwO1xuICAgICAgICBpZiAodHlwZW9mIGJhY2tncm91bmRzLmltYWdlID09PSBcIm9iamVjdFwiICYmIGJhY2tncm91bmRzLmltYWdlKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2UgPSBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5wYXJzZShiYWNrZ3JvdW5kcy5pbWFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2UgPSBiYWNrZ3JvdW5kcy5pbWFnZSB8fCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZFJlcGVhdCA9IGJhY2tncm91bmRzLnJlcGVhdCB8fCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRQb3NpdGlvbiA9IGJhY2tncm91bmRzLnBvc2l0aW9uID8gYmFja2dyb3VuZHMucG9zaXRpb24udGV4dCA6IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHksIGJhY2tncm91bmRDb2xvcl0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSwgYmFja2dyb3VuZEltYWdlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eSwgYmFja2dyb3VuZFJlcGVhdF0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSwgYmFja2dyb3VuZFBvc2l0aW9uXVxuICAgICAgICBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRDb2xvclByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdXG4gICAgICAgIF07XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VCb3JkZXJDb2xvcih2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSB7IHRvcDogdW5kZWZpbmVkLCByaWdodDogdW5kZWZpbmVkLCBib3R0b206IHVuZGVmaW5lZCwgbGVmdDogdW5kZWZpbmVkIH07XG4gICAgaWYgKHZhbHVlLmluZGV4T2YoXCJyZ2JcIikgPT09IDApIHtcbiAgICAgICAgcmVzdWx0LnRvcCA9IHJlc3VsdC5yaWdodCA9IHJlc3VsdC5ib3R0b20gPSByZXN1bHQubGVmdCA9IG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bICxdKy8pO1xuICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIwO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHJlc3VsdC50b3AgPSBhcnIwO1xuICAgICAgICByZXN1bHQucmlnaHQgPSBhcnIxO1xuICAgICAgICByZXN1bHQuYm90dG9tID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LmxlZnQgPSBhcnIxO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgdmFyIGFycjEgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMV0pO1xuICAgICAgICB2YXIgYXJyMiA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsyXSk7XG4gICAgICAgIHJlc3VsdC50b3AgPSBhcnIwO1xuICAgICAgICByZXN1bHQucmlnaHQgPSBhcnIxO1xuICAgICAgICByZXN1bHQuYm90dG9tID0gYXJyMjtcbiAgICAgICAgcmVzdWx0LmxlZnQgPSBhcnIxO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgdmFyIGFycjEgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMV0pO1xuICAgICAgICB2YXIgYXJyMiA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsyXSk7XG4gICAgICAgIHZhciBhcnIzID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzNdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIyO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxLCAyLCAzIG9yIDQgcGFyYW1ldGVycy4gQWN0dWFsOiBcIiArIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnZhciBib3JkZXJDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1jb2xvclwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJSaWdodENvbG9yKSAmJlxuICAgICAgICAgICAgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJCb3R0b21Db2xvcikgJiZcbiAgICAgICAgICAgIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyTGVmdENvbG9yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvciArIFwiIFwiICsgdGhpcy5ib3JkZXJSaWdodENvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlckJvdHRvbUNvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGZvdXJDb2xvcnMgPSBwYXJzZUJvcmRlckNvbG9yKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy50b3BdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy5yaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tQ29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLmxlZnRdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tQ29sb3JQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmJvcmRlckNvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyVG9wQ29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItdG9wLWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyVG9wQ29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJSaWdodENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclJpZ2h0Q29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItcmlnaHQtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJSaWdodENvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21Db2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1ib3R0b20tY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21Db2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJMZWZ0Q29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItbGVmdC1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckxlZnRDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJMZWZ0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGJvcmRlcldpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlcldpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXdpZHRoXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wV2lkdGgsIHRoaXMuYm9yZGVyUmlnaHRXaWR0aCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJMZWZ0V2lkdGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyVG9wV2lkdGgpICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyUmlnaHRXaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21XaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJMZWZ0V2lkdGgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlICE9PSBcImF1dG9cIikge1xuICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRocyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eSwgYm9yZGVyV2lkdGhzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMucmlnaHRdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMubGVmdF1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BXaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci10b3Atd2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcFdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJSaWdodFdpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1yaWdodC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyUmlnaHRXaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyQm90dG9tV2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20td2lkdGggc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21XaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJMZWZ0V2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItbGVmdC13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItbGVmdC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJMZWZ0V2lkdGgodmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBib3JkZXJSYWRpdXNQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyUmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXJhZGl1c1wiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMsIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMpICYmXG4gICAgICAgICAgICBMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cywgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cykgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzLCB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzKTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBib3JkZXJSYWRpdXMgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcExlZnRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wUmlnaHRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLnJpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMuYm90dG9tXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHksIGJvcmRlclJhZGl1cy5sZWZ0XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wUmlnaHRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyUmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BMZWZ0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC1sZWZ0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci10b3AtbGVmdC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BMZWZ0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcExlZnRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BSaWdodFJhZGl1c1wiLCBjc3NOYW1lOiBcImJvcmRlci10b3AtcmlnaHQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BSaWdodFJhZGl1cyh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXNcIiwgZGVmYXVsdFZhbHVlOiAwLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21MZWZ0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21MZWZ0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZnVuY3Rpb24gaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiBpc0Zpbml0ZSh2YWx1ZSkgJiYgIWlzTmFOKHZhbHVlKSAmJiB2YWx1ZSA+PSAwO1xufVxudmFyIHN1cHBvcnRlZFBhdGhzID0gW1wicmVjdFwiLCBcImNpcmNsZVwiLCBcImVsbGlwc2VcIiwgXCJwb2x5Z29uXCIsIFwiaW5zZXRcIl07XG5mdW5jdGlvbiBpc0NsaXBQYXRoVmFsaWQodmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB2YXIgZnVuY3Rpb25OYW1lID0gdmFsdWUuc3Vic3RyaW5nKDAsIHZhbHVlLmluZGV4T2YoXCIoXCIpKS50cmltKCk7XG4gICAgcmV0dXJuIHN1cHBvcnRlZFBhdGhzLmluZGV4T2YoZnVuY3Rpb25OYW1lKSAhPT0gLTE7XG59XG5leHBvcnRzLmNsaXBQYXRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImNsaXBQYXRoXCIsIGNzc05hbWU6IFwiY2xpcC1wYXRoXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNDbGlwUGF0aFZhbGlkKG5ld1ZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2xpcC1wYXRoIGlzIG5vdCB2YWxpZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhDbGlwUGF0aChuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5jbGlwUGF0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBpc0Zsb2F0VmFsdWVDb252ZXJ0ZXIodmFsdWUpIHtcbiAgICB2YXIgbmV3VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICBpZiAoaXNOYU4obmV3VmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgbmV3VmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3VmFsdWU7XG59XG5leHBvcnRzLnpJbmRleFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiekluZGV4XCIsIGNzc05hbWU6IFwiei1pbmRleFwiLCB2YWx1ZUNvbnZlcnRlcjogaXNGbG9hdFZhbHVlQ29udmVydGVyIH0pO1xuZXhwb3J0cy56SW5kZXhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZnVuY3Rpb24gb3BhY2l0eUNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmICghaXNOYU4obmV3VmFsdWUpICYmIDAgPD0gbmV3VmFsdWUgJiYgbmV3VmFsdWUgPD0gMSkge1xuICAgICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIk9wYWNpdHkgc2hvdWxkIGJlIGJldHdlZW4gWzAsIDFdLiBWYWx1ZTogXCIgKyBuZXdWYWx1ZSk7XG59XG5leHBvcnRzLm9wYWNpdHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcIm9wYWNpdHlcIiwgY3NzTmFtZTogXCJvcGFjaXR5XCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IG9wYWNpdHlDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLm9wYWNpdHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5jb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwiY29sb3JcIiwgY3NzTmFtZTogXCJjb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuY29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250SW50ZXJuYWxQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZvbnRJbnRlcm5hbFwiLCBjc3NOYW1lOiBcIl9mb250SW50ZXJuYWxcIiwgZGVmYXVsdFZhbHVlOiBmb250XzEuRm9udC5kZWZhdWx0IH0pO1xuZXhwb3J0cy5mb250SW50ZXJuYWxQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZENzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImZvbnRGYW1pbHlcIiwgY3NzTmFtZTogXCJmb250LWZhbWlseVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udEZhbWlseSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBuZXdGb250ID0gY3VycmVudEZvbnQud2l0aEZvbnRGYW1pbHkobmV3VmFsdWUpO1xuICAgICAgICAgICAgdGFyZ2V0LmZvbnRJbnRlcm5hbCA9IGZvbnRfMS5Gb250LmVxdWFscyhmb250XzEuRm9udC5kZWZhdWx0LCBuZXdGb250KSA/IHByb3BlcnRpZXNfMS51bnNldFZhbHVlIDogbmV3Rm9udDtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuZm9udFNpemVQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFNpemVcIiwgY3NzTmFtZTogXCJmb250LXNpemVcIiwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRTaXplICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFNpemUobmV3VmFsdWUpO1xuICAgICAgICAgICAgdGFyZ2V0LmZvbnRJbnRlcm5hbCA9IGZvbnRfMS5Gb250LmVxdWFscyhmb250XzEuRm9udC5kZWZhdWx0LCBuZXdGb250KSA/IHByb3BlcnRpZXNfMS51bnNldFZhbHVlIDogbmV3Rm9udDtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9XG59KTtcbmV4cG9ydHMuZm9udFNpemVQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFN0eWxlXCIsIGNzc05hbWU6IFwiZm9udC1zdHlsZVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBkZWZhdWx0VmFsdWU6IGZvbnRfMS5Gb250U3R5bGUuTk9STUFMLCB2YWx1ZUNvbnZlcnRlcjogZm9udF8xLkZvbnRTdHlsZS5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRTdHlsZSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBuZXdGb250ID0gY3VycmVudEZvbnQud2l0aEZvbnRTdHlsZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRTdHlsZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFdlaWdodFwiLCBjc3NOYW1lOiBcImZvbnQtd2VpZ2h0XCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGRlZmF1bHRWYWx1ZTogZm9udF8xLkZvbnRXZWlnaHQuTk9STUFMLCB2YWx1ZUNvbnZlcnRlcjogZm9udF8xLkZvbnRXZWlnaHQucGFyc2UsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjdXJyZW50Rm9udCA9IHRhcmdldC5mb250SW50ZXJuYWw7XG4gICAgICAgIGlmIChjdXJyZW50Rm9udC5mb250V2VpZ2h0ICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFdlaWdodChuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGZvbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFwiLCBjc3NOYW1lOiBcImZvbnRcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9udFN0eWxlICsgXCIgXCIgKyB0aGlzLmZvbnRXZWlnaHQgKyBcIiBcIiArIHRoaXMuZm9udFNpemUgKyBcIiBcIiArIHRoaXMuZm9udEZhbWlseTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gcHJvcGVydGllc18xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFN0eWxlUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250V2VpZ2h0UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udEZhbWlseVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZm9udCA9IGZvbnRfMS5wYXJzZUZvbnQodmFsdWUpO1xuICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gcGFyc2VGbG9hdChmb250LmZvbnRTaXplKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFN0eWxlUHJvcGVydHksIGZvbnQuZm9udFN0eWxlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250V2VpZ2h0UHJvcGVydHksIGZvbnQuZm9udFdlaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFNpemVQcm9wZXJ0eSwgZm9udFNpemVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eSwgZm9udC5mb250RmFtaWx5XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZm9udFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoVmlzaWJpbGl0eSkge1xuICAgIFZpc2liaWxpdHkuVklTSUJMRSA9IFwidmlzaWJsZVwiO1xuICAgIFZpc2liaWxpdHkuSElEREVOID0gXCJoaWRkZW5cIjtcbiAgICBWaXNpYmlsaXR5LkNPTExBUFNFID0gXCJjb2xsYXBzZVwiO1xuICAgIFZpc2liaWxpdHkuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKFZpc2liaWxpdHkuVklTSUJMRSwgVmlzaWJpbGl0eS5ISURERU4sIFZpc2liaWxpdHkuQ09MTEFQU0UpO1xuICAgIFZpc2liaWxpdHkucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwiY29sbGFwc2VkXCIgPyBWaXNpYmlsaXR5LkNPTExBUFNFIDogcGFyc2VTdHJpY3QodmFsdWUpOyB9O1xuICAgIHZhciBwYXJzZVN0cmljdCA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKFZpc2liaWxpdHkuaXNWYWxpZCk7XG59KShWaXNpYmlsaXR5ID0gZXhwb3J0cy5WaXNpYmlsaXR5IHx8IChleHBvcnRzLlZpc2liaWxpdHkgPSB7fSkpO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInZpc2liaWxpdHlcIiwgY3NzTmFtZTogXCJ2aXNpYmlsaXR5XCIsIGRlZmF1bHRWYWx1ZTogVmlzaWJpbGl0eS5WSVNJQkxFLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogVmlzaWJpbGl0eS5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuaXNDb2xsYXBzZWQgPSAobmV3VmFsdWUgPT09IFZpc2liaWxpdHkuQ09MTEFQU0UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYW5kcm9pZEVsZXZhdGlvblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZEVsZXZhdGlvblwiLCBjc3NOYW1lOiBcImFuZHJvaWQtZWxldmF0aW9uXCIsIHZhbHVlQ29udmVydGVyOiBwYXJzZUZsb2F0IH0pO1xuZXhwb3J0cy5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0XCIsIGNzc05hbWU6IFwiYW5kcm9pZC1keW5hbWljLWVsZXZhdGlvbi1vZmZzZXRcIiwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLXByb3BlcnRpZXMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgY3NzXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzXCIpO1xudmFyIHBhcnNlcl8xID0gcmVxdWlyZShcIi4uLy4uL2Nzcy9wYXJzZXJcIik7XG52YXIgY3NzX3NlbGVjdG9yXzEgPSByZXF1aXJlKFwiLi9jc3Mtc2VsZWN0b3JcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xudmFyIGFwcGxpY2F0aW9uQ29tbW9uID0gcmVxdWlyZShcIi4uLy4uL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVLZXlmcmFtZUFuaW1hdGlvbk1vZHVsZSgpIHtcbiAgICBpZiAoIWtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKSB7XG4gICAgICAgIGtleWZyYW1lQW5pbWF0aW9uTW9kdWxlID0gcmVxdWlyZShcIi4uL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb25cIik7XG4gICAgfVxufVxudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEgPSByZXF1aXJlKFwiLi4vLi4vbW9kdWxlLW5hbWUtcmVzb2x2ZXJcIik7XG52YXIgY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlO1xuZnVuY3Rpb24gZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCkge1xuICAgIGlmICghY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKSB7XG4gICAgICAgIGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSA9IHJlcXVpcmUoXCIuL2Nzcy1hbmltYXRpb24tcGFyc2VyXCIpO1xuICAgIH1cbn1cbnZhciBwYXJzZXIgPSBcInJld29ya1wiO1xudHJ5IHtcbiAgICB2YXIgYXBwQ29uZmlnID0gcmVxdWlyZShcIn4vcGFja2FnZS5qc29uXCIpO1xuICAgIGlmIChhcHBDb25maWcgJiYgYXBwQ29uZmlnLmNzc1BhcnNlciA9PT0gXCJuYXRpdmVzY3JpcHRcIikge1xuICAgICAgICBwYXJzZXIgPSBcIm5hdGl2ZXNjcmlwdFwiO1xuICAgIH1cbn1cbmNhdGNoIChlKSB7XG59XG5mdW5jdGlvbiBldmFsdWF0ZUNzc0V4cHJlc3Npb25zKHZpZXcsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHByb3BlcnRpZXNfMS5fZXZhbHVhdGVDc3NWYXJpYWJsZUV4cHJlc3Npb24odmlldywgcHJvcGVydHksIHZhbHVlKTtcbiAgICBpZiAobmV3VmFsdWUgPT09IFwidW5zZXRcIikge1xuICAgICAgICByZXR1cm4gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgfVxuICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFsdWUgPSBwcm9wZXJ0aWVzXzEuX2V2YWx1YXRlQ3NzQ2FsY0V4cHJlc3Npb24odmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiRmFpbGVkIHRvIGV2YWx1YXRlIGNzcy1jYWxjIGZvciBwcm9wZXJ0eSBbXCIgKyBwcm9wZXJ0eSArIFwiXSBmb3IgZXhwcmVzc2lvbiBbXCIgKyB2YWx1ZSArIFwiXSB0byBcIiArIHZpZXcgKyBcIi4gXCIgKyBlLnN0YWNrLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICByZXR1cm4gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIG1lcmdlQ3NzU2VsZWN0b3JzKCkge1xuICAgIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzID0gYXBwbGljYXRpb25TZWxlY3RvcnMuc2xpY2UoKTtcbiAgICBhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycy5wdXNoLmFwcGx5KGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzLCBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMpO1xuICAgIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uKys7XG59XG5leHBvcnRzLm1lcmdlQ3NzU2VsZWN0b3JzID0gbWVyZ2VDc3NTZWxlY3RvcnM7XG52YXIgYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMgPSBbXTtcbnZhciBhcHBsaWNhdGlvbkNzc1NlbGVjdG9yVmVyc2lvbiA9IDA7XG52YXIgYXBwbGljYXRpb25TZWxlY3RvcnMgPSBbXTtcbnZhciBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMgPSBbXTtcbnZhciBhcHBsaWNhdGlvbktleWZyYW1lcyA9IHt9O1xudmFyIGFuaW1hdGlvbnNTeW1ib2wgPSBTeW1ib2woXCJhbmltYXRpb25zXCIpO1xudmFyIHBhdHRlcm4gPSAvKCd8XCIpKC4qPylcXDEvO1xudmFyIENTU1NvdXJjZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ1NTU291cmNlKF9hc3QsIF91cmwsIF9maWxlLCBfa2V5ZnJhbWVzLCBfc291cmNlKSB7XG4gICAgICAgIHRoaXMuX2FzdCA9IF9hc3Q7XG4gICAgICAgIHRoaXMuX3VybCA9IF91cmw7XG4gICAgICAgIHRoaXMuX2ZpbGUgPSBfZmlsZTtcbiAgICAgICAgdGhpcy5fa2V5ZnJhbWVzID0gX2tleWZyYW1lcztcbiAgICAgICAgdGhpcy5fc291cmNlID0gX3NvdXJjZTtcbiAgICAgICAgdGhpcy5fc2VsZWN0b3JzID0gW107XG4gICAgICAgIHRoaXMucGFyc2UoKTtcbiAgICB9XG4gICAgQ1NTU291cmNlLmZyb21VUkkgPSBmdW5jdGlvbiAodXJpLCBrZXlmcmFtZXMpIHtcbiAgICAgICAgdmFyIGFwcFJlbGF0aXZlVXJpID0gQ1NTU291cmNlLnBhdGhSZWxhdGl2ZVRvQXBwKHVyaSk7XG4gICAgICAgIHZhciBzYW5pdGl6ZWRNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGFwcFJlbGF0aXZlVXJpKTtcbiAgICAgICAgdmFyIHJlc29sdmVkTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUoc2FuaXRpemVkTW9kdWxlTmFtZSwgXCJjc3NcIik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgY3NzT3JBc3QgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZE1vZHVsZU5hbWUsIHRydWUpO1xuICAgICAgICAgICAgaWYgKGNzc09yQXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjc3NPckFzdCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzT3JBc3QsIGtleWZyYW1lcywgcmVzb2x2ZWRNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGNzc09yQXN0ID09PSBcIm9iamVjdFwiICYmIGNzc09yQXN0LnR5cGUgPT09IFwic3R5bGVzaGVldFwiICYmIGNzc09yQXN0LnN0eWxlc2hlZXQgJiYgY3NzT3JBc3Quc3R5bGVzaGVldC5ydWxlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ1NTU291cmNlLmZyb21BU1QoY3NzT3JBc3QsIGtleWZyYW1lcywgcmVzb2x2ZWRNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NPckFzdC50b1N0cmluZygpLCBrZXlmcmFtZXMsIHJlc29sdmVkTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ291bGQgbm90IGxvYWQgQ1NTIGZyb20gXCIgKyB1cmkgKyBcIjogXCIgKyBlLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbUZpbGUoYXBwUmVsYXRpdmVVcmksIGtleWZyYW1lcyk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucGF0aFJlbGF0aXZlVG9BcHAgPSBmdW5jdGlvbiAodXJpKSB7XG4gICAgICAgIGlmICghdXJpLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhcHBQYXRoID0gZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGg7XG4gICAgICAgIGlmICghdXJpLnN0YXJ0c1dpdGgoYXBwUGF0aCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUodXJpICsgXCIgZG9lcyBub3Qgc3RhcnQgd2l0aCBcIiArIGFwcFBhdGgsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWxhdGl2ZVVyaSA9IFwiLlwiICsgdXJpLnN1YnN0cihhcHBQYXRoLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiByZWxhdGl2ZVVyaTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tRmlsZSA9IGZ1bmN0aW9uICh1cmwsIGtleWZyYW1lcykge1xuICAgICAgICB2YXIgY3NzRmlsZVVybCA9IHVybC5yZXBsYWNlKC9cXC4uXFx3KyQvLCBcIi5jc3NcIik7XG4gICAgICAgIGlmIChjc3NGaWxlVXJsICE9PSB1cmwpIHtcbiAgICAgICAgICAgIHZhciBjc3NGaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTChjc3NGaWxlVXJsKTtcbiAgICAgICAgICAgIGlmIChjc3NGaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGNzc0ZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZSA9IENTU1NvdXJjZS5yZXNvbHZlQ1NTUGF0aEZyb21VUkwodXJsKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tRmlsZUltcG9ydCA9IGZ1bmN0aW9uICh1cmwsIGtleWZyYW1lcywgaW1wb3J0U291cmNlKSB7XG4gICAgICAgIHZhciBmaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTCh1cmwsIGltcG9ydFNvdXJjZSk7XG4gICAgICAgIHJldHVybiBuZXcgQ1NTU291cmNlKHVuZGVmaW5lZCwgdXJsLCBmaWxlLCBrZXlmcmFtZXMsIHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMID0gZnVuY3Rpb24gKHVybCwgaW1wb3J0U291cmNlKSB7XG4gICAgICAgIHZhciBhcHAgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICAgICAgdmFyIGZpbGUgPSByZXNvbHZlRmlsZU5hbWVGcm9tVXJsKHVybCwgYXBwLCBmaWxlX3N5c3RlbV8xLkZpbGUuZXhpc3RzLCBpbXBvcnRTb3VyY2UpO1xuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSwga2V5ZnJhbWVzLCB1cmwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIHVuZGVmaW5lZCwga2V5ZnJhbWVzLCBzb3VyY2UpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21BU1QgPSBmdW5jdGlvbiAoYXN0LCBrZXlmcmFtZXMsIHVybCkge1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZShhc3QsIHVybCwgdW5kZWZpbmVkLCBrZXlmcmFtZXMsIHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ1NTU291cmNlLnByb3RvdHlwZSwgXCJzZWxlY3RvcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3NlbGVjdG9yczsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENTU1NvdXJjZS5wcm90b3R5cGUsIFwic291cmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9zb3VyY2U7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBmaWxlX3N5c3RlbV8xLkZpbGUuZnJvbVBhdGgodGhpcy5fZmlsZSk7XG4gICAgICAgIHRoaXMuX3NvdXJjZSA9IGZpbGUucmVhZFRleHRTeW5jKCk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvdXJjZSAmJiB0aGlzLl9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc291cmNlICYmIHRoaXMuc291cmNlICE9PSBcIltvYmplY3QgT2JqZWN0XVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VDU1NBc3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fYXN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ3NzIHN0eWxpbmcgZmFpbGVkOiBcIiArIGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5wYXJzZUNTU0FzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NvdXJjZSkge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJzZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwibmF0aXZlc2NyaXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NwYXJzZXIgPSBuZXcgcGFyc2VyXzEuQ1NTM1BhcnNlcih0aGlzLl9zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3R5bGVzaGVldCA9IGNzc3BhcnNlci5wYXJzZUFTdHlsZXNoZWV0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NOUyA9IG5ldyBwYXJzZXJfMS5DU1NOYXRpdmVTY3JpcHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXN0ID0gY3NzTlMucGFyc2VTdHlsZXNoZWV0KHN0eWxlc2hlZXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgY2FzZSBcInJld29ya1wiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hc3QgPSBjc3NfMS5wYXJzZSh0aGlzLl9zb3VyY2UsIHsgc291cmNlOiB0aGlzLl9maWxlIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBfX3NwcmVhZEFycmF5cyh0aGlzLmNyZWF0ZVNlbGVjdG9yc0Zyb21JbXBvcnRzKCksIHRoaXMuY3JlYXRlU2VsZWN0b3JzRnJvbVN5bnRheFRyZWUoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzRnJvbUltcG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpbXBvcnRzID0gdGhpcy5fYXN0W1wic3R5bGVzaGVldFwiXVtcInJ1bGVzXCJdLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gci50eXBlID09PSBcImltcG9ydFwiOyB9KTtcbiAgICAgICAgdmFyIHVybEZyb21JbXBvcnRPYmplY3QgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaW1wb3J0SXRlbSA9IGltcG9ydE9iamVjdFtcImltcG9ydFwiXTtcbiAgICAgICAgICAgIHZhciB1cmxNYXRjaCA9IGltcG9ydEl0ZW0gJiYgaW1wb3J0SXRlbS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIHJldHVybiB1cmxNYXRjaCAmJiB1cmxNYXRjaFsyXTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNvdXJjZUZyb21JbXBvcnRPYmplY3QgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gaW1wb3J0T2JqZWN0W1wicG9zaXRpb25cIl0gJiYgaW1wb3J0T2JqZWN0W1wicG9zaXRpb25cIl1bXCJzb3VyY2VcIl07XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0b1VybFNvdXJjZVBhaXIgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7IHJldHVybiAoe1xuICAgICAgICAgICAgdXJsOiB1cmxGcm9tSW1wb3J0T2JqZWN0KGltcG9ydE9iamVjdCksXG4gICAgICAgICAgICBzb3VyY2U6IHNvdXJjZUZyb21JbXBvcnRPYmplY3QoaW1wb3J0T2JqZWN0KSxcbiAgICAgICAgfSk7IH07XG4gICAgICAgIHZhciBnZXRDc3NGaWxlID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gX2EudXJsLCBzb3VyY2UgPSBfYS5zb3VyY2U7XG4gICAgICAgICAgICByZXR1cm4gc291cmNlID9cbiAgICAgICAgICAgICAgICBDU1NTb3VyY2UuZnJvbUZpbGVJbXBvcnQodXJsLCBfdGhpcy5fa2V5ZnJhbWVzLCBzb3VyY2UpIDpcbiAgICAgICAgICAgICAgICBDU1NTb3VyY2UuZnJvbVVSSSh1cmwsIF90aGlzLl9rZXlmcmFtZXMpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY3NzRmlsZXMgPSBpbXBvcnRzXG4gICAgICAgICAgICAubWFwKHRvVXJsU291cmNlUGFpcilcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gX2EudXJsO1xuICAgICAgICAgICAgcmV0dXJuICEhdXJsO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLm1hcChnZXRDc3NGaWxlKTtcbiAgICAgICAgdmFyIHNlbGVjdG9ycyA9IGNzc0ZpbGVzLm1hcChmdW5jdGlvbiAoZmlsZSkgeyByZXR1cm4gKGZpbGUgJiYgZmlsZS5zZWxlY3RvcnMpIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgdmFsKSB7IHJldHVybiBhY2MuY29uY2F0KHZhbCk7IH0sIFtdKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzRnJvbVN5bnRheFRyZWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBub2RlcyA9IHRoaXMuX2FzdC5zdHlsZXNoZWV0LnJ1bGVzO1xuICAgICAgICBub2Rlcy5maWx0ZXIoaXNLZXlmcmFtZSkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gX3RoaXMuX2tleWZyYW1lc1tub2RlLm5hbWVdID0gbm9kZTsgfSk7XG4gICAgICAgIHZhciBydWxlc2V0cyA9IGNzc19zZWxlY3Rvcl8xLmZyb21Bc3ROb2Rlcyhub2Rlcyk7XG4gICAgICAgIGlmIChydWxlc2V0cyAmJiBydWxlc2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpO1xuICAgICAgICAgICAgcnVsZXNldHMuZm9yRWFjaChmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgIHJ1bGVbYW5pbWF0aW9uc1N5bWJvbF0gPSBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGUuQ3NzQW5pbWF0aW9uUGFyc2VyXG4gICAgICAgICAgICAgICAgICAgIC5rZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTRGVjbGFyYXRpb25zKHJ1bGUuZGVjbGFyYXRpb25zKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBydWxlc2V0cztcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWxlIHx8IHRoaXMuX3VybCB8fCBcIihpbi1tZW1vcnkpXCI7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwibG9hZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwicGFyc2VcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UucHJvdG90eXBlLCBcInBhcnNlQ1NTQXN0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJjcmVhdGVTZWxlY3RvcnNcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UsIFwicmVzb2x2ZUNTU1BhdGhGcm9tVVJMXCIsIG51bGwpO1xuICAgIHJldHVybiBDU1NTb3VyY2U7XG59KCkpO1xuZnVuY3Rpb24gcmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUyh0YWcpIHtcbiAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnNbaV0udGFnID09PSB0YWcpIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICBpLS07XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbiAgICByZXR1cm4gY2hhbmdlZDtcbn1cbmV4cG9ydHMucmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUyA9IHJlbW92ZVRhZ2dlZEFkZGl0aW9uYWxDU1M7XG5mdW5jdGlvbiBhZGRUYWdnZWRBZGRpdGlvbmFsQ1NTKGNzc1RleHQsIHRhZykge1xuICAgIHZhciBwYXJzZWQgPSBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NUZXh0LCBhcHBsaWNhdGlvbktleWZyYW1lcywgdW5kZWZpbmVkKS5zZWxlY3RvcnM7XG4gICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcbiAgICBpZiAocGFyc2VkICYmIHBhcnNlZC5sZW5ndGgpIHtcbiAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgIGlmICh0YWcgIT0gbnVsbCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJzZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJzZWRbaV0udGFnID0gdGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5wdXNoLmFwcGx5KGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycywgcGFyc2VkKTtcbiAgICAgICAgbWVyZ2VDc3NTZWxlY3RvcnMoKTtcbiAgICB9XG4gICAgcmV0dXJuIGNoYW5nZWQ7XG59XG5leHBvcnRzLmFkZFRhZ2dlZEFkZGl0aW9uYWxDU1MgPSBhZGRUYWdnZWRBZGRpdGlvbmFsQ1NTO1xudmFyIG9uQ3NzQ2hhbmdlZCA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLm9uQ3NzQ2hhbmdlZFwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGlmIChhcmdzLmNzc1RleHQpIHtcbiAgICAgICAgdmFyIHBhcnNlZCA9IENTU1NvdXJjZS5mcm9tU291cmNlKGFyZ3MuY3NzVGV4dCwgYXBwbGljYXRpb25LZXlmcmFtZXMsIGFyZ3MuY3NzRmlsZSkuc2VsZWN0b3JzO1xuICAgICAgICBpZiAocGFyc2VkKSB7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMucHVzaC5hcHBseShhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMsIHBhcnNlZCk7XG4gICAgICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3MuY3NzRmlsZSkge1xuICAgICAgICBsb2FkQ3NzKGFyZ3MuY3NzRmlsZSk7XG4gICAgfVxufSk7XG5mdW5jdGlvbiBvbkxpdmVTeW5jKGFyZ3MpIHtcbiAgICBsb2FkQ3NzKGFwcGxpY2F0aW9uQ29tbW9uLmdldENzc0ZpbGVOYW1lKCkpO1xufVxudmFyIGxvYWRDc3MgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiXFxcInN0eWxlLXNjb3BlXFxcIi5sb2FkQ3NzXCIsIGZ1bmN0aW9uIChjc3NNb2R1bGUpIHtcbiAgICBpZiAoIWNzc01vZHVsZSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAoY3NzTW9kdWxlLnN0YXJ0c1dpdGgoXCIuL1wiKSkge1xuICAgICAgICBjc3NNb2R1bGUgPSBjc3NNb2R1bGUuc3Vic3RyKDIpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gQ1NTU291cmNlLmZyb21VUkkoY3NzTW9kdWxlLCBhcHBsaWNhdGlvbktleWZyYW1lcykuc2VsZWN0b3JzO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICBhcHBsaWNhdGlvblNlbGVjdG9ycyA9IHJlc3VsdDtcbiAgICAgICAgbWVyZ2VDc3NTZWxlY3RvcnMoKTtcbiAgICB9XG59KTtcbmFwcGxpY2F0aW9uQ29tbW9uLm9uKFwiY3NzQ2hhbmdlZFwiLCBvbkNzc0NoYW5nZWQpO1xuYXBwbGljYXRpb25Db21tb24ub24oXCJsaXZlc3luY1wiLCBvbkxpdmVTeW5jKTtcbmV4cG9ydHMubG9hZEFwcENTUyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLmxvYWRBcHBDU1NcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICBsb2FkQ3NzKGFyZ3MuY3NzRmlsZSk7XG4gICAgYXBwbGljYXRpb25Db21tb24ub2ZmKFwibG9hZEFwcENzc1wiLCBleHBvcnRzLmxvYWRBcHBDU1MpO1xufSk7XG5pZiAoYXBwbGljYXRpb25Db21tb24uaGFzTGF1bmNoZWQoKSkge1xuICAgIGV4cG9ydHMubG9hZEFwcENTUyh7IGV2ZW50TmFtZTogXCJsb2FkQXBwQ3NzXCIsIG9iamVjdDogYXBwbGljYXRpb25Db21tb24sIGNzc0ZpbGU6IGFwcGxpY2F0aW9uQ29tbW9uLmdldENzc0ZpbGVOYW1lKCkgfSk7XG59XG5lbHNlIHtcbiAgICBhcHBsaWNhdGlvbkNvbW1vbi5vbihcImxvYWRBcHBDc3NcIiwgZXhwb3J0cy5sb2FkQXBwQ1NTKTtcbn1cbnZhciBDc3NTdGF0ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3NzU3RhdGUodmlld1JlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnZpZXdSZWYgPSB2aWV3UmVmO1xuICAgICAgICB0aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy51cGRhdGVEeW5hbWljU3RhdGUoKTsgfTtcbiAgICB9XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZUZyb21EeW5hbWljVXBkYXRlcygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVNYXRjaCgpO1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVGb3JEeW5hbWljVXBkYXRlcygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVEeW5hbWljU3RhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX21hdGNoSW52YWxpZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5pc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiaXNTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCByZXR1cm5zIGRlZmF1bHQgdmFsdWUgXFxcImZhbHNlXFxcIiBiZWNhdXNlIFxcXCJ0aGlzLnZpZXdSZWZcXFwiIGNsZWFyZWQuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy52aWV3UmVmLmdldCgpLl9zdHlsZVNjb3BlLl9nZXRTZWxlY3RvcnNWZXJzaW9uKCkgPT09IHRoaXMuX2FwcGxpZWRTZWxlY3RvcnNWZXJzaW9uO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fbWF0Y2hJbnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1hdGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzY3JpYmVGb3JEeW5hbWljVXBkYXRlcygpO1xuICAgICAgICB0aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVGcm9tRHluYW1pY1VwZGF0ZXMoKTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS51cGRhdGVNYXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX21hdGNoID0gdmlldy5fc3R5bGVTY29wZS5tYXRjaFNlbGVjdG9ycyh2aWV3KTtcbiAgICAgICAgICAgIHRoaXMuX2FwcGxpZWRTZWxlY3RvcnNWZXJzaW9uID0gdmlldy5fc3R5bGVTY29wZS5fZ2V0U2VsZWN0b3JzVmVyc2lvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2ggPSBDc3NTdGF0ZS5lbXB0eU1hdGNoO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21hdGNoSW52YWxpZCA9IGZhbHNlO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVwZGF0ZUR5bmFtaWNTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInVwZGF0ZUR5bmFtaWNTdGF0ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hdGNoaW5nU2VsZWN0b3JzID0gdGhpcy5fbWF0Y2guc2VsZWN0b3JzLmZpbHRlcihmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYyA/IHNlbC5tYXRjaCh2aWV3KSA6IHRydWU7IH0pO1xuICAgICAgICB2aWV3Ll9iYXRjaFVwZGF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zdG9wS2V5ZnJhbWVBbmltYXRpb25zKCk7XG4gICAgICAgICAgICBfdGhpcy5zZXRQcm9wZXJ0eVZhbHVlcyhtYXRjaGluZ1NlbGVjdG9ycyk7XG4gICAgICAgICAgICBfdGhpcy5wbGF5S2V5ZnJhbWVBbmltYXRpb25zKG1hdGNoaW5nU2VsZWN0b3JzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUucGxheUtleWZyYW1lQW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChtYXRjaGluZ1NlbGVjdG9ycykge1xuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IFtdO1xuICAgICAgICBtYXRjaGluZ1NlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgdmFyIHJ1bGVBbmltYXRpb25zID0gc2VsZWN0b3IucnVsZXNldFthbmltYXRpb25zU3ltYm9sXTtcbiAgICAgICAgICAgIGlmIChydWxlQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgICAgIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBydWxlQW5pbWF0aW9uc18xID0gcnVsZUFuaW1hdGlvbnM7IF9pIDwgcnVsZUFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkluZm8gPSBydWxlQW5pbWF0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGtleWZyYW1lQW5pbWF0aW9uTW9kdWxlLktleWZyYW1lQW5pbWF0aW9uLmtleWZyYW1lQW5pbWF0aW9uRnJvbUluZm8oYW5pbWF0aW9uSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zID0gYW5pbWF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgdmlld18xID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3XzEpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiS2V5ZnJhbWVBbmltYXRpb25zIGNhbm5vdCBwbGF5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5pbWF0aW9ucy5tYXAoZnVuY3Rpb24gKGFuaW1hdGlvbikgeyByZXR1cm4gYW5pbWF0aW9uLnBsYXkodmlld18xKTsgfSk7XG4gICAgICAgICAgICBPYmplY3QuZnJlZXplKGFuaW1hdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5fYXBwbGllZEFuaW1hdGlvbnMgPSBhbmltYXRpb25zO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUuc3RvcEtleWZyYW1lQW5pbWF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9wbGF5c0tleWZyYW1lQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FwcGxpZWRBbmltYXRpb25zXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhbmltYXRpb24pIHsgcmV0dXJuIGFuaW1hdGlvbi5pc1BsYXlpbmc7IH0pXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoYW5pbWF0aW9uKSB7IHJldHVybiBhbmltYXRpb24uY2FuY2VsKCk7IH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQW5pbWF0aW9ucyA9IENzc1N0YXRlLmVtcHR5QW5pbWF0aW9uQXJyYXk7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnJvdGF0ZVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnNjYWxlWFwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnNjYWxlWVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnRyYW5zbGF0ZVhcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTp0cmFuc2xhdGVZXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6YmFja2dyb3VuZENvbG9yXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6b3BhY2l0eVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lQW5pbWF0aW9ucyBjYW5ub3QgYmUgc3RvcHBlZCBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zID0gZmFsc2U7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUuc2V0UHJvcGVydHlWYWx1ZXMgPSBmdW5jdGlvbiAobWF0Y2hpbmdTZWxlY3RvcnMpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShtYXRjaGluZ1NlbGVjdG9ycyArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3UHJvcGVydHlWYWx1ZXMgPSBuZXcgdmlldy5zdHlsZS5Qcm9wZXJ0eUJhZygpO1xuICAgICAgICBtYXRjaGluZ1NlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdG9yLnJ1bGVzZXQuZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGRlY2xhcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1Byb3BlcnR5VmFsdWVzW2RlY2xhcmF0aW9uLnByb3BlcnR5XSA9IGRlY2xhcmF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgb2xkUHJvcGVydGllcyA9IHRoaXMuX2FwcGxpZWRQcm9wZXJ0eVZhbHVlcztcbiAgICAgICAgdmFyIGlzQ3NzRXhwcmVzc2lvbkluVXNlID0gZmFsc2U7XG4gICAgICAgIHZpZXcuc3R5bGUucmVzZXRTY29wZWRDc3NWYXJpYWJsZXMoKTtcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gbmV3UHJvcGVydHlWYWx1ZXMpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0aWVzXzEuaXNDc3NWYXJpYWJsZShwcm9wZXJ0eSkpIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlLnNldFNjb3BlZENzc1ZhcmlhYmxlKHByb3BlcnR5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzQ3NzRXhwcmVzc2lvbkluVXNlID0gaXNDc3NFeHByZXNzaW9uSW5Vc2UgfHwgcHJvcGVydGllc18xLmlzQ3NzVmFyaWFibGVFeHByZXNzaW9uKHZhbHVlKSB8fCBwcm9wZXJ0aWVzXzEuaXNDc3NDYWxjRXhwcmVzc2lvbih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQ3NzRXhwcmVzc2lvbkluVXNlKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBuZXdQcm9wZXJ0eVZhbHVlcykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGV2YWx1YXRlQ3NzRXhwcmVzc2lvbnModmlldywgcHJvcGVydHksIG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XSk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmZyZWV6ZShuZXdQcm9wZXJ0eVZhbHVlcyk7XG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG9sZFByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGlmICghKHByb3BlcnR5IGluIG5ld1Byb3BlcnR5VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eSBpbiB2aWV3LnN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJjc3M6XCIgKyBwcm9wZXJ0eV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG5ld1Byb3BlcnR5VmFsdWVzKSB7XG4gICAgICAgICAgICBpZiAob2xkUHJvcGVydGllcyAmJiBwcm9wZXJ0eSBpbiBvbGRQcm9wZXJ0aWVzICYmIG9sZFByb3BlcnRpZXNbcHJvcGVydHldID09PSBuZXdQcm9wZXJ0eVZhbHVlc1twcm9wZXJ0eV0pIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zdHlsZVtcImNzczpcIiArIHByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbWVsQ2FzZWRQcm9wZXJ0eSA9IHByb3BlcnR5LnJlcGxhY2UoLy0oW2Etel0pL2csIGZ1bmN0aW9uIChnKSB7IHJldHVybiBnWzFdLnRvVXBwZXJDYXNlKCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICB2aWV3W2NhbWVsQ2FzZWRQcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJGYWlsZWQgdG8gYXBwbHkgcHJvcGVydHkgW1wiICsgcHJvcGVydHkgKyBcIl0gd2l0aCB2YWx1ZSBbXCIgKyB2YWx1ZSArIFwiXSB0byBcIiArIHZpZXcgKyBcIi4gXCIgKyBlLnN0YWNrLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FwcGxpZWRQcm9wZXJ0eVZhbHVlcyA9IG5ld1Byb3BlcnR5VmFsdWVzO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2hhbmdlTWFwID0gdGhpcy5fbWF0Y2guY2hhbmdlTWFwO1xuICAgICAgICBjaGFuZ2VNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlcywgdmlldykge1xuICAgICAgICAgICAgaWYgKGNoYW5nZXMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMuYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hZGRFdmVudExpc3RlbmVyKGF0dHJpYnV0ZSArIFwiQ2hhbmdlXCIsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoYW5nZXMucHNldWRvQ2xhc3Nlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMucHNldWRvQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChwc2V1ZG9DbGFzcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gXCI6XCIgKyBwc2V1ZG9DbGFzcztcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hZGRFdmVudExpc3RlbmVyKFwiOlwiICsgcHNldWRvQ2xhc3MsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tldmVudE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3W2V2ZW50TmFtZV0oKzEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwID0gY2hhbmdlTWFwO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVuc3Vic2NyaWJlRnJvbUR5bmFtaWNVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZXMsIHZpZXcpIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLmF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcihhdHRyaWJ1dGUgKyBcIkNoYW5nZVwiLCBfdGhpcy5fb25EeW5hbWljU3RhdGVDaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLnBzZXVkb0NsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnBzZXVkb0NsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAocHNldWRvQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IFwiOlwiICsgcHNldWRvQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tldmVudE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3W2V2ZW50TmFtZV0oLTEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwID0gQ3NzU3RhdGUuZW1wdHlDaGFuZ2VNYXA7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJ0b1N0cmluZygpIG9mIENzc1N0YXRlIGNhbm5vdCBleGVjdXRlIGNvcnJlY3RseSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXcgKyBcIi5fY3NzU3RhdGVcIjtcbiAgICB9O1xuICAgIENzc1N0YXRlLmVtcHR5Q2hhbmdlTWFwID0gT2JqZWN0LmZyZWV6ZShuZXcgTWFwKCkpO1xuICAgIENzc1N0YXRlLmVtcHR5UHJvcGVydHlCYWcgPSBPYmplY3QuZnJlZXplKHt9KTtcbiAgICBDc3NTdGF0ZS5lbXB0eUFuaW1hdGlvbkFycmF5ID0gT2JqZWN0LmZyZWV6ZShbXSk7XG4gICAgQ3NzU3RhdGUuZW1wdHlNYXRjaCA9IHsgc2VsZWN0b3JzOiBbXSwgY2hhbmdlTWFwOiBuZXcgTWFwKCkgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENzc1N0YXRlLnByb3RvdHlwZSwgXCJ1cGRhdGVNYXRjaFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENzc1N0YXRlLnByb3RvdHlwZSwgXCJ1cGRhdGVEeW5hbWljU3RhdGVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIENzc1N0YXRlO1xufSgpKTtcbmV4cG9ydHMuQ3NzU3RhdGUgPSBDc3NTdGF0ZTtcbkNzc1N0YXRlLnByb3RvdHlwZS5fYXBwbGllZENoYW5nZU1hcCA9IENzc1N0YXRlLmVtcHR5Q2hhbmdlTWFwO1xuQ3NzU3RhdGUucHJvdG90eXBlLl9hcHBsaWVkUHJvcGVydHlWYWx1ZXMgPSBDc3NTdGF0ZS5lbXB0eVByb3BlcnR5QmFnO1xuQ3NzU3RhdGUucHJvdG90eXBlLl9hcHBsaWVkQW5pbWF0aW9ucyA9IENzc1N0YXRlLmVtcHR5QW5pbWF0aW9uQXJyYXk7XG5Dc3NTdGF0ZS5wcm90b3R5cGUuX21hdGNoSW52YWxpZCA9IHRydWU7XG52YXIgU3R5bGVTY29wZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3R5bGVTY29wZSgpIHtcbiAgICAgICAgdGhpcy5fY3NzID0gXCJcIjtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMuX2tleWZyYW1lcyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0eWxlU2NvcGUucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NzcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q3NzKHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuYWRkQ3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmRDc3MoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5hZGRDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuYXBwZW5kQ3NzKG51bGwsIGNzc0ZpbGVOYW1lKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmNoYW5nZUNzc0ZpbGUgPSBmdW5jdGlvbiAoY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgaWYgKCFjc3NGaWxlTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjc3NTZWxlY3RvcnMgPSBDU1NTb3VyY2UuZnJvbVVSSShjc3NGaWxlTmFtZSwgdGhpcy5fa2V5ZnJhbWVzKTtcbiAgICAgICAgdGhpcy5fY3NzID0gY3NzU2VsZWN0b3JzLnNvdXJjZTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMgPSBjc3NTZWxlY3RvcnMuc2VsZWN0b3JzO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbisrO1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuc2V0Q3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5fY3NzID0gY3NzU3RyaW5nO1xuICAgICAgICB2YXIgY3NzRmlsZSA9IENTU1NvdXJjZS5mcm9tU291cmNlKGNzc1N0cmluZywgdGhpcy5fa2V5ZnJhbWVzLCBjc3NGaWxlTmFtZSk7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzID0gY3NzRmlsZS5zZWxlY3RvcnM7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uKys7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5hcHBlbmRDc3MgPSBmdW5jdGlvbiAoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSkge1xuICAgICAgICBpZiAoIWNzc1N0cmluZyAmJiAhY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyc2VkQ3NzU2VsZWN0b3JzID0gY3NzU3RyaW5nID8gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzU3RyaW5nLCB0aGlzLl9rZXlmcmFtZXMsIGNzc0ZpbGVOYW1lKSA6IENTU1NvdXJjZS5mcm9tVVJJKGNzc0ZpbGVOYW1lLCB0aGlzLl9rZXlmcmFtZXMpO1xuICAgICAgICB0aGlzLl9jc3MgPSB0aGlzLl9jc3MgKyBwYXJzZWRDc3NTZWxlY3RvcnMuc291cmNlO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9ycy5wdXNoLmFwcGx5KHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzLCBwYXJzZWRDc3NTZWxlY3RvcnMuc2VsZWN0b3JzKTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24rKztcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmdldEtleWZyYW1lQW5pbWF0aW9uV2l0aE5hbWUgPSBmdW5jdGlvbiAoYW5pbWF0aW9uTmFtZSkge1xuICAgICAgICB2YXIgY3NzS2V5ZnJhbWVzID0gdGhpcy5fa2V5ZnJhbWVzW2FuaW1hdGlvbk5hbWVdO1xuICAgICAgICBpZiAoIWNzc0tleWZyYW1lcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCk7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSBuZXcga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUuS2V5ZnJhbWVBbmltYXRpb25JbmZvKCk7XG4gICAgICAgIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpO1xuICAgICAgICBhbmltYXRpb24ua2V5ZnJhbWVzID0gY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlXG4gICAgICAgICAgICAuQ3NzQW5pbWF0aW9uUGFyc2VyLmtleWZyYW1lc0FycmF5RnJvbUNTUyhjc3NLZXlmcmFtZXMua2V5ZnJhbWVzKTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdGlvbjtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmVuc3VyZVNlbGVjdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzQXBwbGljYXRpb25Dc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCgpIHx8XG4gICAgICAgICAgICAhdGhpcy5pc0xvY2FsQ3NzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQoKSB8fFxuICAgICAgICAgICAgIXRoaXMuX21lcmdlZENzc1NlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlU2VsZWN0b3JzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFNlbGVjdG9yc1ZlcnNpb24oKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmlzQXBwbGljYXRpb25Dc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPT09IGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuaXNMb2NhbENzc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9PT0gdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5fY3JlYXRlU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9NZXJnZSA9IFtdO1xuICAgICAgICB0b01lcmdlLnB1c2goYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMpO1xuICAgICAgICB0aGlzLl9hcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb247XG4gICAgICAgIHRvTWVyZ2UucHVzaCh0aGlzLl9sb2NhbENzc1NlbGVjdG9ycyk7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPSB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbjtcbiAgICAgICAgZm9yICh2YXIga2V5ZnJhbWUgaW4gYXBwbGljYXRpb25LZXlmcmFtZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2tleWZyYW1lc1trZXlmcmFtZV0gPSBhcHBsaWNhdGlvbktleWZyYW1lc1trZXlmcmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRvTWVyZ2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzID0gdG9NZXJnZS5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuICEhbTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIG5leHQpIHsgcmV0dXJuIG1lcmdlZC5jb25jYXQobmV4dCk7IH0sIFtdKTtcbiAgICAgICAgICAgIHRoaXMuX2FwcGx5S2V5ZnJhbWVzT25TZWxlY3RvcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IG5ldyBjc3Nfc2VsZWN0b3JfMS5TZWxlY3RvcnNNYXAodGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUubWF0Y2hTZWxlY3RvcnMgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzLnF1ZXJ5KHZpZXcpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzLnF1ZXJ5KG5vZGUpLnNlbGVjdG9ycztcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLl9nZXRTZWxlY3RvcnNWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTAwMDAwICogdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiArIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5fYXBwbHlLZXlmcmFtZXNPblNlbGVjdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX21lcmdlZENzc1NlbGVjdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIHJ1bGVzZXQgPSB0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnNbaV07XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IHJ1bGVzZXRbYW5pbWF0aW9uc1N5bWJvbF07XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9ucyAhPT0gdW5kZWZpbmVkICYmIGFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhbmltYXRpb25zXzEgPSBhbmltYXRpb25zOyBfaSA8IGFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGFuaW1hdGlvbnNfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NLZXlmcmFtZSA9IHRoaXMuX2tleWZyYW1lc1thbmltYXRpb24ubmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc3NLZXlmcmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24ua2V5ZnJhbWVzID0gY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLkNzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZXNBcnJheUZyb21DU1MoY3NzS2V5ZnJhbWUua2V5ZnJhbWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuZ2V0QW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChydWxlc2V0KSB7XG4gICAgICAgIHJldHVybiBydWxlc2V0W2FuaW1hdGlvbnNTeW1ib2xdO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJzZXRDc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJhcHBlbmRDc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJfY3JlYXRlU2VsZWN0b3JzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgU3R5bGVTY29wZS5wcm90b3R5cGUsIFwibWF0Y2hTZWxlY3RvcnNcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFN0eWxlU2NvcGU7XG59KCkpO1xuZXhwb3J0cy5TdHlsZVNjb3BlID0gU3R5bGVTY29wZTtcbmZ1bmN0aW9uIHJlc29sdmVGaWxlTmFtZUZyb21VcmwodXJsLCBhcHBEaXJlY3RvcnksIGZpbGVFeGlzdHMsIGltcG9ydFNvdXJjZSkge1xuICAgIHZhciBmaWxlTmFtZSA9IHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgPyB1cmwudHJpbSgpIDogXCJcIjtcbiAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZShcIn4vXCIsIFwiXCIpO1xuICAgIH1cbiAgICB2YXIgaXNBYnNvbHV0ZVBhdGggPSBmaWxlTmFtZS5pbmRleE9mKFwiL1wiKSA9PT0gMDtcbiAgICB2YXIgYWJzb2x1dGVQYXRoID0gaXNBYnNvbHV0ZVBhdGggPyBmaWxlTmFtZSA6IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGFwcERpcmVjdG9yeSwgZmlsZU5hbWUpO1xuICAgIGlmIChmaWxlRXhpc3RzKGFic29sdXRlUGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIGFic29sdXRlUGF0aDtcbiAgICB9XG4gICAgaWYgKCFpc0Fic29sdXRlUGF0aCkge1xuICAgICAgICBpZiAoZmlsZU5hbWVbMF0gPT09IFwiflwiICYmIGZpbGVOYW1lWzFdICE9PSBcIi9cIiAmJiBmaWxlTmFtZVsxXSAhPT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgICAgIHZhciBpbXBvcnRGaWxlID0gcmVzb2x2ZUZpbGVQYXRoRnJvbUltcG9ydChpbXBvcnRTb3VyY2UsIGZpbGVOYW1lKTtcbiAgICAgICAgICAgIGlmIChmaWxlRXhpc3RzKGltcG9ydEZpbGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGltcG9ydEZpbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV4dGVybmFsXzEgPSBmaWxlX3N5c3RlbV8xLnBhdGguam9pbihhcHBEaXJlY3RvcnksIFwidG5zX21vZHVsZXNcIiwgZmlsZU5hbWUpO1xuICAgICAgICBpZiAoZmlsZUV4aXN0cyhleHRlcm5hbF8xKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsXzE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnJlc29sdmVGaWxlTmFtZUZyb21VcmwgPSByZXNvbHZlRmlsZU5hbWVGcm9tVXJsO1xuZnVuY3Rpb24gcmVzb2x2ZUZpbGVQYXRoRnJvbUltcG9ydChpbXBvcnRTb3VyY2UsIGZpbGVOYW1lKSB7XG4gICAgdmFyIGltcG9ydFNvdXJjZVBhcnRzID0gaW1wb3J0U291cmNlLnNwbGl0KGZpbGVfc3lzdGVtXzEucGF0aC5zZXBhcmF0b3IpO1xuICAgIHZhciBmaWxlTmFtZVBhcnRzID0gZmlsZU5hbWUuc3BsaXQoZmlsZV9zeXN0ZW1fMS5wYXRoLnNlcGFyYXRvcilcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gIWlzQ3VycmVudERpcmVjdG9yeShwKTsgfSk7XG4gICAgaW1wb3J0U291cmNlUGFydHMucG9wKCk7XG4gICAgZmlsZU5hbWVQYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7IHJldHVybiBpc1BhcmVudERpcmVjdG9yeShwKSA/IGltcG9ydFNvdXJjZVBhcnRzLnBvcCgpIDogaW1wb3J0U291cmNlUGFydHMucHVzaChwKTsgfSk7XG4gICAgcmV0dXJuIGltcG9ydFNvdXJjZVBhcnRzLmpvaW4oZmlsZV9zeXN0ZW1fMS5wYXRoLnNlcGFyYXRvcik7XG59XG5leHBvcnRzLmFwcGx5SW5saW5lU3R5bGUgPSBwcm9maWxpbmdfMS5wcm9maWxlKGZ1bmN0aW9uIGFwcGx5SW5saW5lU3R5bGUodmlldywgc3R5bGVTdHIpIHtcbiAgICB2YXIgbG9jYWxTdHlsZSA9IFwibG9jYWwgeyBcIiArIHN0eWxlU3RyICsgXCIgfVwiO1xuICAgIHZhciBpbmxpbmVSdWxlU2V0ID0gQ1NTU291cmNlLmZyb21Tb3VyY2UobG9jYWxTdHlsZSwgbmV3IE1hcCgpKS5zZWxlY3RvcnM7XG4gICAgdmlldy5zdHlsZS5yZXNldFVuc2NvcGVkQ3NzVmFyaWFibGVzKCk7XG4gICAgaW5saW5lUnVsZVNldFswXS5kZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBkLnByb3BlcnR5O1xuICAgICAgICBpZiAocHJvcGVydGllc18xLmlzQ3NzVmFyaWFibGUocHJvcGVydHkpKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlLnNldFVuc2NvcGVkQ3NzVmFyaWFibGUocHJvcGVydHksIGQudmFsdWUpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaW5saW5lUnVsZVNldFswXS5kZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBkLnByb3BlcnR5O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXNfMS5pc0Nzc1ZhcmlhYmxlKHByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGV2YWx1YXRlQ3NzRXhwcmVzc2lvbnModmlldywgcHJvcGVydHksIGQudmFsdWUpO1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkZhaWxlZCB0byBhcHBseSBwcm9wZXJ0eSBbXCIgKyBkLnByb3BlcnR5ICsgXCJdIHdpdGggdmFsdWUgW1wiICsgZC52YWx1ZSArIFwiXSB0byBcIiArIHZpZXcgKyBcIi4gXCIgKyBlLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xufSk7XG5mdW5jdGlvbiBpc0N1cnJlbnREaXJlY3RvcnkodXJpUGFydCkge1xuICAgIHJldHVybiB1cmlQYXJ0ID09PSBcIi5cIjtcbn1cbmZ1bmN0aW9uIGlzUGFyZW50RGlyZWN0b3J5KHVyaVBhcnQpIHtcbiAgICByZXR1cm4gdXJpUGFydCA9PT0gXCIuLlwiO1xufVxuZnVuY3Rpb24gaXNLZXlmcmFtZShub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gXCJrZXlmcmFtZXNcIjtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLXNjb3BlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdHJhY2VcIik7XG52YXIgU3R5bGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdHlsZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdHlsZShvd25lclZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMudW5zY29wZWRDc3NWYXJpYWJsZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLnNjb3BlZENzc1ZhcmlhYmxlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgaWYgKG93bmVyVmlldy5jb25zdHJ1Y3Rvci50b1N0cmluZygpLmluZGV4T2YoXCJbbmF0aXZlIGNvZGVdXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgX3RoaXMudmlld1JlZiA9IG93bmVyVmlldztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLnZpZXdSZWYgPSBuZXcgV2Vha1JlZihvd25lclZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3R5bGUucHJvdG90eXBlLnNldFNjb3BlZENzc1ZhcmlhYmxlID0gZnVuY3Rpb24gKHZhck5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc2NvcGVkQ3NzVmFyaWFibGVzLnNldCh2YXJOYW1lLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBTdHlsZS5wcm90b3R5cGUuc2V0VW5zY29wZWRDc3NWYXJpYWJsZSA9IGZ1bmN0aW9uICh2YXJOYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLnVuc2NvcGVkQ3NzVmFyaWFibGVzLnNldCh2YXJOYW1lLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBTdHlsZS5wcm90b3R5cGUuZ2V0Q3NzVmFyaWFibGUgPSBmdW5jdGlvbiAodmFyTmFtZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlldztcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy51bnNjb3BlZENzc1ZhcmlhYmxlcy5oYXModmFyTmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnVuc2NvcGVkQ3NzVmFyaWFibGVzLmdldCh2YXJOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zY29wZWRDc3NWYXJpYWJsZXMuaGFzKHZhck5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zY29wZWRDc3NWYXJpYWJsZXMuZ2V0KHZhck5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmlldy5wYXJlbnQgfHwgIXZpZXcucGFyZW50LnN0eWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldy5wYXJlbnQuc3R5bGUuZ2V0Q3NzVmFyaWFibGUodmFyTmFtZSk7XG4gICAgfTtcbiAgICBTdHlsZS5wcm90b3R5cGUucmVzZXRTY29wZWRDc3NWYXJpYWJsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2NvcGVkQ3NzVmFyaWFibGVzLmNsZWFyKCk7XG4gICAgfTtcbiAgICBTdHlsZS5wcm90b3R5cGUucmVzZXRVbnNjb3BlZENzc1ZhcmlhYmxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnNjb3BlZENzc1ZhcmlhYmxlcy5jbGVhcigpO1xuICAgIH07XG4gICAgU3R5bGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwidG9TdHJpbmcoKSBvZiBTdHlsZSBjYW5ub3QgZXhlY3V0ZSBjb3JyZWN0bHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3ICsgXCIuc3R5bGVcIjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHlsZS5wcm90b3R5cGUsIFwidmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmlld1JlZikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gU3R5bGU7XG59KG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLlN0eWxlID0gU3R5bGU7XG5TdHlsZS5wcm90b3R5cGUuUHJvcGVydHlCYWcgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzEoKSB7XG4gICAgfVxuICAgIHJldHVybiBjbGFzc18xO1xufSgpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgU3dpdGNoQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN3aXRjaEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3dpdGNoQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTd2l0Y2hCYXNlLnByb3RvdHlwZS5fb25DaGVja2VkUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgfTtcbiAgICBTd2l0Y2hCYXNlLmNoZWNrZWRDaGFuZ2VFdmVudCA9IFwiY2hlY2tlZENoYW5nZVwiO1xuICAgIFN3aXRjaEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJTd2l0Y2hcIilcbiAgICBdLCBTd2l0Y2hCYXNlKTtcbiAgICByZXR1cm4gU3dpdGNoQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuU3dpdGNoQmFzZSA9IFN3aXRjaEJhc2U7XG5Td2l0Y2hCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZnVuY3Rpb24gb25DaGVja2VkUHJvcGVydHlDaGFuZ2VkKHN3aXRjaEJhc2UsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIHN3aXRjaEJhc2UuX29uQ2hlY2tlZFByb3BlcnR5Q2hhbmdlZChuZXdWYWx1ZSk7XG59XG5leHBvcnRzLmNoZWNrZWRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImNoZWNrZWRcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyLCB2YWx1ZUNoYW5nZWQ6IG9uQ2hlY2tlZFByb3BlcnR5Q2hhbmdlZCB9KTtcbmV4cG9ydHMuY2hlY2tlZFByb3BlcnR5LnJlZ2lzdGVyKFN3aXRjaEJhc2UpO1xuZXhwb3J0cy5vZmZCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcIm9mZkJhY2tncm91bmRDb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIoU3dpdGNoQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zd2l0Y2gtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc3dpdGNoX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc3dpdGNoLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3N3aXRjaC1jb21tb25cIikpO1xudmFyIENoZWNrZWRDaGFuZ2VMaXN0ZW5lcjtcbmZ1bmN0aW9uIGluaXRpYWxpemVDaGVja2VkQ2hhbmdlTGlzdGVuZXIoKSB7XG4gICAgaWYgKENoZWNrZWRDaGFuZ2VMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBDaGVja2VkQ2hhbmdlTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGwsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGwob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgQ2hlY2tlZENoYW5nZUxpc3RlbmVySW1wbC5wcm90b3R5cGUub25DaGVja2VkQ2hhbmdlZCA9IGZ1bmN0aW9uIChidXR0b25WaWV3LCBpc0NoZWNrZWQpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICBzd2l0Y2hfY29tbW9uXzEuY2hlY2tlZFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBpc0NoZWNrZWQpO1xuICAgICAgICB9O1xuICAgICAgICBDaGVja2VkQ2hhbmdlTGlzdGVuZXJJbXBsID0gX19kZWNvcmF0ZShbXG4gICAgICAgICAgICBJbnRlcmZhY2VzKFthbmRyb2lkLndpZGdldC5Db21wb3VuZEJ1dHRvbi5PbkNoZWNrZWRDaGFuZ2VMaXN0ZW5lcl0pXG4gICAgICAgIF0sIENoZWNrZWRDaGFuZ2VMaXN0ZW5lckltcGwpO1xuICAgICAgICByZXR1cm4gQ2hlY2tlZENoYW5nZUxpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBDaGVja2VkQ2hhbmdlTGlzdGVuZXIgPSBDaGVja2VkQ2hhbmdlTGlzdGVuZXJJbXBsO1xufVxudmFyIFN3aXRjaCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN3aXRjaCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTd2l0Y2goKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3dpdGNoLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuZHJvaWQud2lkZ2V0LlN3aXRjaCh0aGlzLl9jb250ZXh0KTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGluaXRpYWxpemVDaGVja2VkQ2hhbmdlTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmV3IENoZWNrZWRDaGFuZ2VMaXN0ZW5lcih0aGlzKTtcbiAgICAgICAgbmF0aXZlVmlldy5zZXRPbkNoZWNrZWRDaGFuZ2VMaXN0ZW5lcihsaXN0ZW5lcik7XG4gICAgICAgIG5hdGl2ZVZpZXcubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3Lmxpc3RlbmVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZS5zZXROYXRpdmVCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc3dpdGNoX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VHJhY2tEcmF3YWJsZSgpLnNldENvbG9yRmlsdGVyKHZhbHVlLmFuZHJvaWQsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VHJhY2tEcmF3YWJsZSgpLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZS5fb25DaGVja2VkUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLm9mZkJhY2tncm91bmRDb2xvcikge1xuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlQmFja2dyb3VuZENvbG9yKHRoaXMub2ZmQmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlQmFja2dyb3VuZENvbG9yKHRoaXMuYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuY2hlY2tlZFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jaGVja2VkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0Q2hlY2tlZCh2YWx1ZSk7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygc3dpdGNoX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VGh1bWJEcmF3YWJsZSgpLnNldENvbG9yRmlsdGVyKHZhbHVlLmFuZHJvaWQsIGFuZHJvaWQuZ3JhcGhpY3MuUG9ydGVyRHVmZi5Nb2RlLlNSQ19JTik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0VGh1bWJEcmF3YWJsZSgpLmNsZWFyQ29sb3JGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLm9mZkJhY2tncm91bmRDb2xvciB8fCB0aGlzLmNoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlQmFja2dyb3VuZENvbG9yKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLm9mZkJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNoZWNrZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlQmFja2dyb3VuZENvbG9yKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFN3aXRjaDtcbn0oc3dpdGNoX2NvbW1vbl8xLlN3aXRjaEJhc2UpKTtcbmV4cG9ydHMuU3dpdGNoID0gU3dpdGNoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3dpdGNoLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb3JlL3ZpZXdcIik7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29udGVudC12aWV3XCIpO1xuZXhwb3J0cy50cmFjZUNhdGVnb3J5ID0gXCJUYWJWaWV3XCI7XG52YXIgVGFiQ29udGVudEl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiQ29udGVudEl0ZW1CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYkNvbnRlbnRJdGVtQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJDb250ZW50SXRlbUJhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5jb250ZW50KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJDb250ZW50SXRlbUJhc2UucHJvdG90eXBlLmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIHRhYlZpZXcgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHRhYlZpZXcgJiYgdGFiVmlldy5pdGVtcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuQmVMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmxvYWRWaWV3LmNhbGwodGhpcywgdmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYkNvbnRlbnRJdGVtXCIpXG4gICAgXSwgVGFiQ29udGVudEl0ZW1CYXNlKTtcbiAgICByZXR1cm4gVGFiQ29udGVudEl0ZW1CYXNlO1xufShjb250ZW50X3ZpZXdfMS5Db250ZW50VmlldykpO1xuZXhwb3J0cy5UYWJDb250ZW50SXRlbUJhc2UgPSBUYWJDb250ZW50SXRlbUJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItY29udGVudC1pdGVtLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGdyaWRfbGF5b3V0XzEgPSByZXF1aXJlKFwiLi4vLi4vbGF5b3V0cy9ncmlkLWxheW91dFwiKTtcbnZhciB0YWJfY29udGVudF9pdGVtX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGFiLWNvbnRlbnQtaXRlbS1jb21tb25cIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RhYi1jb250ZW50LWl0ZW0tY29tbW9uXCIpKTtcbnZhciBUYWJDb250ZW50SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYkNvbnRlbnRJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYkNvbnRlbnRJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJDb250ZW50SXRlbS5wcm90b3R5cGUsIFwiX2hhc0ZyYWdtZW50c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGF5b3V0ID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkTGF5b3V0KHRoaXMuX2NvbnRleHQpO1xuICAgICAgICBsYXlvdXQuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5zdGFyKSk7XG4gICAgICAgIHJldHVybiBsYXlvdXQ7XG4gICAgfTtcbiAgICBUYWJDb250ZW50SXRlbS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIGdyaWRfbGF5b3V0XzEuR3JpZExheW91dC5zZXRSb3coY2hpbGQsIDApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQsIGF0SW5kZXgpO1xuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW0ucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuY2FuQmVMb2FkZWQgPSBmYWxzZTtcbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZS5fZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWJWaWV3ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0YWJGcmFnbWVudCA9IG51bGw7XG4gICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0YWJWaWV3Ll9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmluZGV4ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIkN1cnJlbnQgVGFiQ29udGVudEl0ZW0gaW5kZXggaXMgbm90IHNldFwiLCB0YWJfY29udGVudF9pdGVtX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcnksIHZpZXdfMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZnJhZ21lbnRNYW5hZ2VyLmdldEZyYWdtZW50cygpLnRvQXJyYXkoKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IF9hW19pXTtcbiAgICAgICAgICAgIGlmIChmcmFnbWVudC5pbmRleCA9PT0gdGhpcy5pbmRleCkge1xuICAgICAgICAgICAgICAgIHRhYkZyYWdtZW50ID0gZnJhZ21lbnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YWJGcmFnbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRhYlZpZXcuX2dldFJvb3RGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFiRnJhZ21lbnQuZ2V0Q2hpbGRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICB9O1xuICAgIHJldHVybiBUYWJDb250ZW50SXRlbTtcbn0odGFiX2NvbnRlbnRfaXRlbV9jb21tb25fMS5UYWJDb250ZW50SXRlbUJhc2UpKTtcbmV4cG9ydHMuVGFiQ29udGVudEl0ZW0gPSBUYWJDb250ZW50SXRlbTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYi1jb250ZW50LWl0ZW0uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5pdGVtcyA9IFwiaXRlbXNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgVGFiTmF2aWdhdGlvbkJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJOYXZpZ2F0aW9uQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJOYXZpZ2F0aW9uQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiVGFiQ29udGVudEl0ZW1cIikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWUgPT09IFwiVGFiU3RyaXBcIikge1xuICAgICAgICAgICAgdGhpcy50YWJTdHJpcCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLCBcIl9zZWxlY3RlZFZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkSW5kZXggPiAtMSA/IHRoaXMuaXRlbXNbc2VsZWN0ZWRJbmRleF0uY29udGVudCA6IG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICByZXR1cm4gaXRlbXMgPyBpdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYlN0cmlwID0gdGhpcy50YWJTdHJpcDtcbiAgICAgICAgaWYgKHRhYlN0cmlwKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0YWJTdHJpcCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0uY29udGVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVWaWV3KGl0ZW0pOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWl0ZW0uY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUYWJDb250ZW50SXRlbSBtdXN0IGhhdmUgYSBjb250ZW50ICh2aWV3KS5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLl9hZGRWaWV3KGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5vblRhYlN0cmlwQ2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRUYWJTdHJpcCwgbmV3VGFiU3RyaXApIHtcbiAgICAgICAgaWYgKG9sZFRhYlN0cmlwICYmIG9sZFRhYlN0cmlwLnBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyhvbGRUYWJTdHJpcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1RhYlN0cmlwKSB7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KG5ld1RhYlN0cmlwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQgPSBmdW5jdGlvbiAob2xkSW5kZXgsIG5ld0luZGV4KSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBUYWJOYXZpZ2F0aW9uQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50LCBvYmplY3Q6IHRoaXMsIG9sZEluZGV4OiBvbGRJbmRleCwgbmV3SW5kZXg6IG5ld0luZGV4IH0pO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFyRm9udEludGVybmFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJGb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJUZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJUZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFyQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtVGl0bGUgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1CYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckl0ZW1CYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJY29uQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Gb250U2l6ZSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUZvbnRTaXplID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJJdGVtRm9udEludGVybmFsID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udEludGVybmFsID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJJdGVtVGV4dFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySXRlbVRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2Uuc2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudCA9IFwic2VsZWN0ZWRJbmRleENoYW5nZWRcIjtcbiAgICByZXR1cm4gVGFiTmF2aWdhdGlvbkJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRhYk5hdmlnYXRpb25CYXNlID0gVGFiTmF2aWdhdGlvbkJhc2U7XG52YXIgTUlOX0lDT05fU0laRSA9IDI0O1xudmFyIE1BWF9JQ09OX1dJRFRIID0gMzE7XG52YXIgTUFYX0lDT05fSEVJR0hUID0gMjg7XG5mdW5jdGlvbiBnZXRJY29uU3BlY1NpemUoc2l6ZSkge1xuICAgIHZhciBpbldpZHRoID0gc2l6ZS53aWR0aDtcbiAgICB2YXIgaW5IZWlnaHQgPSBzaXplLmhlaWdodDtcbiAgICB2YXIgb3V0V2lkdGggPSAwO1xuICAgIHZhciBvdXRIZWlnaHQgPSAwO1xuICAgIGlmIChpbldpZHRoIDwgaW5IZWlnaHQpIHtcbiAgICAgICAgb3V0V2lkdGggPSBNSU5fSUNPTl9TSVpFO1xuICAgICAgICBvdXRIZWlnaHQgPSAoaW5IZWlnaHQgKiBNSU5fSUNPTl9TSVpFKSAvIGluV2lkdGg7XG4gICAgICAgIGlmIChvdXRIZWlnaHQgPiBNQVhfSUNPTl9IRUlHSFQpIHtcbiAgICAgICAgICAgIG91dEhlaWdodCA9IE1BWF9JQ09OX0hFSUdIVDtcbiAgICAgICAgICAgIG91dFdpZHRoID0gKGluV2lkdGggKiBNQVhfSUNPTl9IRUlHSFQpIC8gaW5IZWlnaHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG91dEhlaWdodCA9IE1JTl9JQ09OX1NJWkU7XG4gICAgICAgIG91dFdpZHRoID0gKGluV2lkdGggKiBNSU5fSUNPTl9TSVpFKSAvIGluSGVpZ2h0O1xuICAgICAgICBpZiAob3V0V2lkdGggPiBNQVhfSUNPTl9XSURUSCkge1xuICAgICAgICAgICAgb3V0V2lkdGggPSBNQVhfSUNPTl9XSURUSDtcbiAgICAgICAgICAgIG91dEhlaWdodCA9IChpbkhlaWdodCAqIE1BWF9JQ09OX1dJRFRIKSAvIGluV2lkdGg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHsgd2lkdGg6IG91dFdpZHRoLCBoZWlnaHQ6IG91dEhlaWdodCB9O1xufVxuZXhwb3J0cy5nZXRJY29uU3BlY1NpemUgPSBnZXRJY29uU3BlY1NpemU7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwic2VsZWN0ZWRJbmRleFwiLCBkZWZhdWx0VmFsdWU6IC0xLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uU2VsZWN0ZWRJbmRleENoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9LFxuICAgIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0YXJnZXQuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgdmFyIG1heCA9IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAodmFsdWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkucmVnaXN0ZXIoVGFiTmF2aWdhdGlvbkJhc2UpO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtc1wiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25JdGVtc0NoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihUYWJOYXZpZ2F0aW9uQmFzZSk7XG5leHBvcnRzLnRhYlN0cmlwUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRhYlN0cmlwXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vblRhYlN0cmlwQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy50YWJTdHJpcFByb3BlcnR5LnJlZ2lzdGVyKFRhYk5hdmlnYXRpb25CYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYi1uYXZpZ2F0aW9uLWJhc2UuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBpbWFnZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlL2ltYWdlXCIpO1xudmFyIGxhYmVsXzEgPSByZXF1aXJlKFwiLi4vLi4vbGFiZWwvbGFiZWxcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbnZhciB0YWJzXzEgPSByZXF1aXJlKFwiLi4vLi4vdGFic1wiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3BsYXRmb3JtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKSk7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbnZhciBUYWJTdHJpcEl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJTdHJpcEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiU3RyaXBJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYlN0cmlwSXRlbV8xID0gVGFiU3RyaXBJdGVtO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJTdHJpcEl0ZW0ucHJvdG90eXBlLCBcInRpdGxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxhYmVsLnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGl0bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl90aXRsZSA9IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxhYmVsLnRleHQgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlN0cmlwSXRlbS5wcm90b3R5cGUsIFwiaWNvblNvdXJjZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbWFnZS5zcmM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWNvblNvdXJjZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2ljb25Tb3VyY2UgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbWFnZS5zcmMgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLmltYWdlKSB7XG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgaW1hZ2VfMS5JbWFnZSgpO1xuICAgICAgICAgICAgaW1hZ2Uuc3JjID0gdGhpcy5pY29uU291cmNlO1xuICAgICAgICAgICAgdGhpcy5pbWFnZSA9IGltYWdlO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh0aGlzLmltYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMubGFiZWwpIHtcbiAgICAgICAgICAgIHZhciBsYWJlbCA9IG5ldyBsYWJlbF8xLkxhYmVsKCk7XG4gICAgICAgICAgICBsYWJlbC50ZXh0ID0gdGhpcy50aXRsZTtcbiAgICAgICAgICAgIHRoaXMubGFiZWwgPSBsYWJlbDtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5sYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9sYWJlbENvbG9ySGFuZGxlciA9IHRoaXMuX2xhYmVsQ29sb3JIYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IF90aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1Db2xvcihfdGhpcywgYXJncy52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxhYmVsLnN0eWxlLm9uKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5fbGFiZWxDb2xvckhhbmRsZXIpO1xuICAgICAgICB0aGlzLl9sYWJlbEZvbnRIYW5kbGVyID0gdGhpcy5fbGFiZWxGb250SGFuZGxlciB8fCAoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJdGVtRm9udEludGVybmFsKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub24oXCJmb250SW50ZXJuYWxDaGFuZ2VcIiwgdGhpcy5fbGFiZWxGb250SGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2xhYmVsVGV4dFRyYW5zZm9ybUhhbmRsZXIgPSB0aGlzLl9sYWJlbFRleHRUcmFuc2Zvcm1IYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IF90aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub24oXCJ0ZXh0VHJhbnNmb3JtQ2hhbmdlXCIsIHRoaXMuX2xhYmVsVGV4dFRyYW5zZm9ybUhhbmRsZXIpO1xuICAgICAgICB0aGlzLl9sYWJlbFRleHRIYW5kbGVyID0gdGhpcy5fbGFiZWxUZXh0SGFuZGxlciB8fCAoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSBfdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJdGVtVGl0bGUoX3RoaXMsIGFyZ3MudmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sYWJlbC5vbihcInRleHRDaGFuZ2VcIiwgdGhpcy5fbGFiZWxUZXh0SGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2ltYWdlQ29sb3JIYW5kbGVyID0gdGhpcy5faW1hZ2VDb2xvckhhbmRsZXIgfHwgKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySWNvbkNvbG9yKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW1hZ2Uuc3R5bGUub24oXCJjb2xvckNoYW5nZVwiLCB0aGlzLl9pbWFnZUNvbG9ySGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2ltYWdlRm9udEhhbmRsZXIgPSB0aGlzLl9pbWFnZUZvbnRIYW5kbGVyIHx8IChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IF90aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckljb25Db2xvcihfdGhpcywgYXJncy52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmltYWdlLnN0eWxlLm9uKFwiZm9udEludGVybmFsQ2hhbmdlXCIsIHRoaXMuX2ltYWdlRm9udEhhbmRsZXIpO1xuICAgICAgICB0aGlzLl9pbWFnZVNyY0hhbmRsZXIgPSB0aGlzLl9pbWFnZVNyY0hhbmRsZXIgfHwgKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gX3RoaXMucGFyZW50O1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySWNvbkNvbG9yKF90aGlzLCBhcmdzLnZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW1hZ2Uub24oXCJzcmNDaGFuZ2VcIiwgdGhpcy5faW1hZ2VTcmNIYW5kbGVyKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubGFiZWwuc3R5bGUub2ZmKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5fbGFiZWxDb2xvckhhbmRsZXIpO1xuICAgICAgICB0aGlzLmxhYmVsLnN0eWxlLm9mZihcImZvbnRJbnRlcm5hbENoYW5nZVwiLCB0aGlzLl9sYWJlbEZvbnRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5sYWJlbC5zdHlsZS5vZmYoXCJ0ZXh0VHJhbnNmb3JtQ2hhbmdlXCIsIHRoaXMuX2xhYmVsVGV4dFRyYW5zZm9ybUhhbmRsZXIpO1xuICAgICAgICB0aGlzLmxhYmVsLnN0eWxlLm9mZihcInRleHRDaGFuZ2VcIiwgdGhpcy5fbGFiZWxUZXh0SGFuZGxlcik7XG4gICAgICAgIHRoaXMuaW1hZ2Uuc3R5bGUub2ZmKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5faW1hZ2VDb2xvckhhbmRsZXIpO1xuICAgICAgICB0aGlzLmltYWdlLnN0eWxlLm9mZihcImZvbnRJbnRlcm5hbENoYW5nZVwiLCB0aGlzLl9pbWFnZUZvbnRIYW5kbGVyKTtcbiAgICAgICAgdGhpcy5pbWFnZS5zdHlsZS5vZmYoXCJzcmNDaGFuZ2VcIiwgdGhpcy5faW1hZ2VTcmNIYW5kbGVyKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmxhYmVsKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmxhYmVsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pbWFnZSkge1xuICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5pbWFnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiSW1hZ2VcIikge1xuICAgICAgICAgICAgdGhpcy5pbWFnZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5pY29uU291cmNlID0gdmFsdWUuc3JjO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT09IFwiTGFiZWxcIikge1xuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHZhbHVlLnRleHQ7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUuX3VwZGF0ZVRhYlN0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHN1YnNjcmliZSkge1xuICAgICAgICAgICAgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyID0gdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9ub3JtYWxIYW5kbGVyID0gdGhpcy5fbm9ybWFsSGFuZGxlciB8fCAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJub3JtYWxcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub24oVGFiU3RyaXBJdGVtXzEuc2VsZWN0RXZlbnQsIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLm9uKFRhYlN0cmlwSXRlbV8xLnVuc2VsZWN0RXZlbnQsIHRoaXMuX25vcm1hbEhhbmRsZXIpO1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnRfMSAmJiBwYXJlbnRfMS5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5pbmRleCA9PT0gdGFiU3RyaXBQYXJlbnQuc2VsZWN0ZWRJbmRleCAmJlxuICAgICAgICAgICAgICAgICEocGxhdGZvcm1fMS5pc0lPUyAmJiB0YWJTdHJpcFBhcmVudCBpbnN0YW5jZW9mIHRhYnNfMS5UYWJzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vZmYoVGFiU3RyaXBJdGVtXzEuc2VsZWN0RXZlbnQsIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLm9mZihUYWJTdHJpcEl0ZW1fMS51bnNlbGVjdEV2ZW50LCB0aGlzLl9ub3JtYWxIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5nZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1CYWNrZ3JvdW5kQ29sb3IodGhpcywgdmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgdmFyIFRhYlN0cmlwSXRlbV8xO1xuICAgIFRhYlN0cmlwSXRlbS50YXBFdmVudCA9IFwidGFwXCI7XG4gICAgVGFiU3RyaXBJdGVtLnNlbGVjdEV2ZW50ID0gXCJzZWxlY3RcIjtcbiAgICBUYWJTdHJpcEl0ZW0udW5zZWxlY3RFdmVudCA9IFwidW5zZWxlY3RcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLlBzZXVkb0NsYXNzSGFuZGxlcihcIm5vcm1hbFwiLCBcImhpZ2hsaWdodGVkXCIsIFwicHJlc3NlZFwiLCBcImFjdGl2ZVwiKVxuICAgIF0sIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUsIFwiX3VwZGF0ZVRhYlN0YXRlQ2hhbmdlSGFuZGxlclwiLCBudWxsKTtcbiAgICBUYWJTdHJpcEl0ZW0gPSBUYWJTdHJpcEl0ZW1fMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYlN0cmlwSXRlbVwiKVxuICAgIF0sIFRhYlN0cmlwSXRlbSk7XG4gICAgcmV0dXJuIFRhYlN0cmlwSXRlbTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGFiU3RyaXBJdGVtID0gVGFiU3RyaXBJdGVtO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLXN0cmlwLWl0ZW0uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY29sb3JcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90ZXh0LWJhc2VcIik7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbmV4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImhpZ2hsaWdodENvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHYpOyB9IH0pO1xudmFyIFRhYlN0cmlwID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiU3RyaXAsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiU3RyaXAoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFiU3RyaXAucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiVGFiU3RyaXBJdGVtXCIpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVWaWV3KGl0ZW0pOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fYWRkVmlldyhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhckJhY2tncm91bmRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyQmFja2dyb3VuZENvbG9yKHZhbHVlKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuZ2V0VGFiQmFyQ29sb3IoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyQ29sb3IodmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5nZXRUYWJCYXJGb250SW50ZXJuYWwoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNldFRhYkJhckZvbnRJbnRlcm5hbCh2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdGV4dF9iYXNlXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhclRleHRUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS50ZXh0VHJhbnNmb3JtUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNldFRhYkJhclRleHRUcmFuc2Zvcm0odmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW2V4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5nZXRUYWJCYXJIaWdobGlnaHRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW2V4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IodmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAuaXRlbVRhcEV2ZW50ID0gXCJpdGVtVGFwXCI7XG4gICAgVGFiU3RyaXAgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUYWJTdHJpcFwiKVxuICAgIF0sIFRhYlN0cmlwKTtcbiAgICByZXR1cm4gVGFiU3RyaXA7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRhYlN0cmlwID0gVGFiU3RyaXA7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vbkl0ZW1zQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFRhYlN0cmlwKTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlvc0ljb25SZW5kZXJpbmdNb2RlXCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvbWF0aWNcIiB9KTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eS5yZWdpc3RlcihUYWJTdHJpcCk7XG5leHBvcnRzLmlzSWNvblNpemVGaXhlZFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpc0ljb25TaXplRml4ZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXJcbn0pO1xuZXhwb3J0cy5pc0ljb25TaXplRml4ZWRQcm9wZXJ0eS5yZWdpc3RlcihUYWJTdHJpcCk7XG5leHBvcnRzLmhpZ2hsaWdodENvbG9yUHJvcGVydHkucmVnaXN0ZXIoVGFiU3RyaXApO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLXN0cmlwLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xuZXhwb3J0cy50cmFjZUNhdGVnb3J5ID0gXCJUYWJWaWV3XCI7XG52YXIgVGFiVmlld0l0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiVmlld0l0ZW1CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYlZpZXdJdGVtQmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl90aXRsZSA9IFwiXCI7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUsIFwidGV4dFRyYW5zZm9ybVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dFRyYW5zZm9ybTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dFRyYW5zZm9ybSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUsIFwidGl0bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aXRsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aXRsZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90aXRsZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJ2aWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdmlldztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl92aWV3ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl92aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNoYW5naW5nIHRoZSB2aWV3IG9mIGFuIGFscmVhZHkgbG9hZGVkIFRhYlZpZXdJdGVtIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlldyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJpY29uU291cmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWNvblNvdXJjZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pY29uU291cmNlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ljb25Tb3VyY2UgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLl92aWV3O1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUubG9hZFZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgdGFiVmlldyA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAodGFiVmlldyAmJiB0YWJWaWV3Lml0ZW1zKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW5CZUxvYWRlZCkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUubG9hZFZpZXcuY2FsbCh0aGlzLCB2aWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0l0ZW1CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiVmlld0l0ZW1cIilcbiAgICBdLCBUYWJWaWV3SXRlbUJhc2UpO1xuICAgIHJldHVybiBUYWJWaWV3SXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5UYWJWaWV3SXRlbUJhc2UgPSBUYWJWaWV3SXRlbUJhc2U7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuaXRlbXMgPSBcIml0ZW1zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIFRhYlZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiVmlld0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFiVmlld0Jhc2VfMSA9IFRhYlZpZXdCYXNlO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwiYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcInRhYlRleHRGb250U2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGFiVGV4dEZvbnRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50YWJUZXh0Rm9udFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJ0YWJUZXh0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRhYlRleHRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGFiVGV4dENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwidGFiQmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50YWJCYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRhYkJhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcInNlbGVjdGVkVGFiVGV4dENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zZWxlY3RlZFRhYlRleHRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2VsZWN0ZWRUYWJUZXh0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLl9hZGRBcnJheUZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBcIml0ZW1zXCIpIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBcIlRhYlZpZXdJdGVtXCIpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgICAgIGV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJfc2VsZWN0ZWRWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZEluZGV4ID4gLTEgPyB0aGlzLml0ZW1zW3NlbGVjdGVkSW5kZXhdLnZpZXcgOiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zID8gaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUuZWFjaENoaWxkVmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhpdGVtLnZpZXcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5vbkl0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRJdGVtcywgbmV3SXRlbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKG9sZEl0ZW1zKSB7XG4gICAgICAgICAgICBvbGRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBfdGhpcy5fcmVtb3ZlVmlldyhpdGVtKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld0l0ZW1zKSB7XG4gICAgICAgICAgICBuZXdJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpdGVtLnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGFiVmlld0l0ZW0gbXVzdCBoYXZlIGEgdmlldy5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLl9hZGRWaWV3KGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5vblNlbGVjdGVkSW5kZXhDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEluZGV4LCBuZXdJbmRleCkge1xuICAgICAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogVGFiVmlld0Jhc2VfMS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50LCBvYmplY3Q6IHRoaXMsIG9sZEluZGV4OiBvbGRJbmRleCwgbmV3SW5kZXg6IG5ld0luZGV4IH0pO1xuICAgIH07XG4gICAgdmFyIFRhYlZpZXdCYXNlXzE7XG4gICAgVGFiVmlld0Jhc2Uuc2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudCA9IFwic2VsZWN0ZWRJbmRleENoYW5nZWRcIjtcbiAgICBUYWJWaWV3QmFzZSA9IFRhYlZpZXdCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUYWJWaWV3XCIpXG4gICAgXSwgVGFiVmlld0Jhc2UpO1xuICAgIHJldHVybiBUYWJWaWV3QmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGFiVmlld0Jhc2UgPSBUYWJWaWV3QmFzZTtcbmZ1bmN0aW9uIHRyYWNlTWlzc2luZ0ljb24oaWNvbikge1xuICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ291bGQgbm90IGxvYWQgdGFiIGJhciBpY29uOiBcIiArIGljb24sIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuRXJyb3IsIHZpZXdfMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbn1cbmV4cG9ydHMudHJhY2VNaXNzaW5nSWNvbiA9IHRyYWNlTWlzc2luZ0ljb247XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwic2VsZWN0ZWRJbmRleFwiLCBkZWZhdWx0VmFsdWU6IC0xLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uU2VsZWN0ZWRJbmRleENoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9LFxuICAgIGNvZXJjZVZhbHVlOiBmdW5jdGlvbiAodGFyZ2V0LCB2YWx1ZSkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0YXJnZXQuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgdmFyIG1heCA9IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAodmFsdWUgPCAwKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBtYXg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtc1wiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25JdGVtc0NoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpb3NJY29uUmVuZGVyaW5nTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b21hdGljXCIgfSk7XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy5hbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYW5kcm9pZE9mZnNjcmVlblRhYkxpbWl0XCIsIGRlZmF1bHRWYWx1ZTogMSwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TLFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5hbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eS5yZWdpc3RlcihUYWJWaWV3QmFzZSk7XG5leHBvcnRzLmFuZHJvaWRUYWJzUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImFuZHJvaWRUYWJzUG9zaXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcInRvcFwiIH0pO1xuZXhwb3J0cy5hbmRyb2lkVGFic1Bvc2l0aW9uUHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy5hbmRyb2lkU3dpcGVFbmFibGVkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJhbmRyb2lkU3dpcGVFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5hbmRyb2lkU3dpcGVFbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRhYlRleHRGb250U2l6ZVwiLCBjc3NOYW1lOiBcInRhYi10ZXh0LWZvbnQtc2l6ZVwiLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLnRhYlRleHRGb250U2l6ZVByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLnRhYlRleHRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGFiVGV4dENvbG9yXCIsIGNzc05hbWU6IFwidGFiLXRleHQtY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy50YWJUZXh0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy50YWJCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRhYkJhY2tncm91bmRDb2xvclwiLCBjc3NOYW1lOiBcInRhYi1iYWNrZ3JvdW5kLWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMudGFiQmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMuc2VsZWN0ZWRUYWJUZXh0Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInNlbGVjdGVkVGFiVGV4dENvbG9yXCIsIGNzc05hbWU6IFwic2VsZWN0ZWQtdGFiLXRleHQtY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5zZWxlY3RlZFRhYlRleHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclwiLCBjc3NOYW1lOiBcImFuZHJvaWQtc2VsZWN0ZWQtdGFiLWhpZ2hsaWdodC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLmFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYi12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZvbnRfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2ZvbnRcIik7XG52YXIgdGFiX3ZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90YWItdmlldy1jb21tb25cIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90YWItdmlldy1jb21tb25cIikpO1xudmFyIEFDQ0VOVF9DT0xPUiA9IFwiY29sb3JBY2NlbnRcIjtcbnZhciBQUklNQVJZX0NPTE9SID0gXCJjb2xvclByaW1hcnlcIjtcbnZhciBERUZBVUxUX0VMRVZBVElPTiA9IDQ7XG52YXIgVEFCSUQgPSBcIl90YWJJZFwiO1xudmFyIElOREVYID0gXCJfaW5kZXhcIjtcbnZhciBQYWdlckFkYXB0ZXI7XG5mdW5jdGlvbiBtYWtlRnJhZ21lbnROYW1lKHZpZXdJZCwgaWQpIHtcbiAgICByZXR1cm4gXCJhbmRyb2lkOnZpZXdwYWdlcjpcIiArIHZpZXdJZCArIFwiOlwiICsgaWQ7XG59XG5mdW5jdGlvbiBnZXRUYWJCeUlkKGlkKSB7XG4gICAgdmFyIHJlZiA9IGV4cG9ydHMudGFicy5maW5kKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgdmFyIHRhYiA9IHJlZi5nZXQoKTtcbiAgICAgICAgcmV0dXJuIHRhYiAmJiB0YWIuX2RvbUlkID09PSBpZDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVmICYmIHJlZi5nZXQoKTtcbn1cbmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCkge1xuICAgIGlmIChQYWdlckFkYXB0ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ubmV3SW5zdGFuY2UgPSBmdW5jdGlvbiAodGFiSWQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBhbmRyb2lkLm9zLkJ1bmRsZSgpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoVEFCSUQsIHRhYklkKTtcbiAgICAgICAgICAgIGFyZ3MucHV0SW50KElOREVYLCBpbmRleCk7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBuZXcgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgICAgICAgZnJhZ21lbnQuc2V0QXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9O1xuICAgICAgICBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZSA9IGZ1bmN0aW9uIChzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGUuY2FsbCh0aGlzLCBzYXZlZEluc3RhbmNlU3RhdGUpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmdldEFyZ3VtZW50cygpO1xuICAgICAgICAgICAgdGhpcy50YWIgPSBnZXRUYWJCeUlkKGFyZ3MuZ2V0SW50KFRBQklEKSk7XG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gYXJncy5nZXRJbnQoSU5ERVgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRhYikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIFRhYlZpZXdcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlVmlldyA9IGZ1bmN0aW9uIChpbmZsYXRlciwgY29udGFpbmVyLCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciB0YWJJdGVtID0gdGhpcy50YWIuaXRlbXNbdGhpcy5pbmRleF07XG4gICAgICAgICAgICByZXR1cm4gdGFiSXRlbS52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uO1xuICAgIH0ob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkZyYWdtZW50QmFzZSkpO1xuICAgIHZhciBQT1NJVElPTl9VTkNIQU5HRUQgPSAtMTtcbiAgICB2YXIgUE9TSVRJT05fTk9ORSA9IC0yO1xuICAgIHZhciBGcmFnbWVudFBhZ2VyQWRhcHRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhGcmFnbWVudFBhZ2VyQWRhcHRlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRnJhZ21lbnRQYWdlckFkYXB0ZXIob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbC5fX25hdGl2ZShfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5nZXRQYWdlVGl0bGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zW2luZGV4XS50aXRsZTtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLnN0YXJ0VXBkYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgaWYgKGNvbnRhaW5lci5nZXRJZCgpID09PSBhbmRyb2lkLnZpZXcuVmlldy5OT19JRCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZpZXdQYWdlciB3aXRoIGFkYXB0ZXIgXCIgKyB0aGlzICsgXCIgcmVxdWlyZXMgYSB2aWV3IGNvbnRhaW5lcklkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuaW5zdGFudGlhdGVJdGVtID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0aGlzLm93bmVyLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5tQ3VyVHJhbnNhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaXRlbUlkID0gdGhpcy5nZXRJdGVtSWQocG9zaXRpb24pO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBtYWtlRnJhZ21lbnROYW1lKGNvbnRhaW5lci5nZXRJZCgpLCBpdGVtSWQpO1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gZnJhZ21lbnRNYW5hZ2VyLmZpbmRGcmFnbWVudEJ5VGFnKG5hbWUpO1xuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbi5hdHRhY2goZnJhZ21lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQgPSBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLm5ld0luc3RhbmNlKHRoaXMub3duZXIuX2RvbUlkLCBwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24uYWRkKGNvbnRhaW5lci5nZXRJZCgpLCBmcmFnbWVudCwgbmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQgIT09IHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSkge1xuICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldE1lbnVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYkl0ZW1zID0gdGhpcy5vd25lci5pdGVtcztcbiAgICAgICAgICAgIHZhciB0YWJJdGVtID0gdGFiSXRlbXMgPyB0YWJJdGVtc1twb3NpdGlvbl0gOiBudWxsO1xuICAgICAgICAgICAgaWYgKHRhYkl0ZW0pIHtcbiAgICAgICAgICAgICAgICB0YWJJdGVtLmNhbkJlTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmcmFnbWVudDtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldEl0ZW1Qb3NpdGlvbiA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zID8gUE9TSVRJT05fVU5DSEFOR0VEIDogUE9TSVRJT05fTk9ORTtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmRlc3Ryb3lJdGVtID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcG9zaXRpb24sIG9iamVjdCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1DdXJUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBmcmFnbWVudE1hbmFnZXIgPSB0aGlzLm93bmVyLl9nZXRGcmFnbWVudE1hbmFnZXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBvYmplY3Q7XG4gICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbi5kZXRhY2goZnJhZ21lbnQpO1xuICAgICAgICAgICAgaWYgKHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSA9PT0gZnJhZ21lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHRhYkl0ZW1zID0gdGhpcy5vd25lci5pdGVtcztcbiAgICAgICAgICAgIHZhciB0YWJJdGVtID0gdGFiSXRlbXMgPyB0YWJJdGVtc1twb3NpdGlvbl0gOiBudWxsO1xuICAgICAgICAgICAgaWYgKHRhYkl0ZW0pIHtcbiAgICAgICAgICAgICAgICB0YWJJdGVtLmNhbkJlTG9hZGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5zZXRQcmltYXJ5SXRlbSA9IGZ1bmN0aW9uIChjb250YWluZXIsIHBvc2l0aW9uLCBvYmplY3QpIHtcbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG9iamVjdDtcbiAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPT0gdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbS5zZXRNZW51VmlzaWJpbGl0eShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbS5zZXRVc2VyVmlzaWJsZUhpbnQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZnJhZ21lbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRNZW51VmlzaWJpbGl0eSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0VXNlclZpc2libGVIaW50KHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0gPSBmcmFnbWVudDtcbiAgICAgICAgICAgICAgICB0aGlzLm93bmVyLnNlbGVjdGVkSW5kZXggPSBwb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgdGFiID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0YWIuaXRlbXM7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1RhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1RhYkl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFiLl9sb2FkVW5sb2FkVGFiSXRlbXModGFiLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmZpbmlzaFVwZGF0ZSA9IGZ1bmN0aW9uIChjb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbigpO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuaXNWaWV3RnJvbU9iamVjdCA9IGZ1bmN0aW9uICh2aWV3LCBvYmplY3QpIHtcbiAgICAgICAgICAgIHJldHVybiBvYmplY3QuZ2V0VmlldygpID09PSB2aWV3O1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuc2F2ZVN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fY29tbWl0Q3VycmVudFRyYW5zYWN0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLnJlc3RvcmVTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgbG9hZGVyKSB7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5nZXRJdGVtSWQgPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbjtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLl9jb21taXRDdXJyZW50VHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tQ3VyVHJhbnNhY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmNvbW1pdE5vd0FsbG93aW5nU3RhdGVMb3NzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRnJhZ21lbnRQYWdlckFkYXB0ZXI7XG4gICAgfShhbmRyb2lkeC52aWV3cGFnZXIud2lkZ2V0LlBhZ2VyQWRhcHRlcikpO1xuICAgIFBhZ2VyQWRhcHRlciA9IEZyYWdtZW50UGFnZXJBZGFwdGVyO1xufVxuZnVuY3Rpb24gY3JlYXRlVGFiSXRlbVNwZWMoaXRlbSkge1xuICAgIHZhciByZXN1bHQgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlRhYkl0ZW1TcGVjKCk7XG4gICAgcmVzdWx0LnRpdGxlID0gaXRlbS50aXRsZTtcbiAgICBpZiAoaXRlbS5pY29uU291cmNlKSB7XG4gICAgICAgIGlmIChpdGVtLmljb25Tb3VyY2UuaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgICAgIHJlc3VsdC5pY29uSWQgPSB1dGlsc18xLmFkLnJlc291cmNlcy5nZXREcmF3YWJsZUlkKGl0ZW0uaWNvblNvdXJjZS5zdWJzdHIodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgubGVuZ3RoKSk7XG4gICAgICAgICAgICBpZiAocmVzdWx0Lmljb25JZCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlTWlzc2luZ0ljb24oaXRlbS5pY29uU291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpcyA9IGltYWdlX3NvdXJjZV8xLmZyb21GaWxlT3JSZXNvdXJjZShpdGVtLmljb25Tb3VyY2UpO1xuICAgICAgICAgICAgaWYgKGlzKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0Lmljb25EcmF3YWJsZSA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkJpdG1hcERyYXdhYmxlKGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dC5nZXRSZXNvdXJjZXMoKSwgaXMuYW5kcm9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZU1pc3NpbmdJY29uKGl0ZW0uaWNvblNvdXJjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnZhciBkZWZhdWx0QWNjZW50Q29sb3IgPSB1bmRlZmluZWQ7XG5mdW5jdGlvbiBnZXREZWZhdWx0QWNjZW50Q29sb3IoY29udGV4dCkge1xuICAgIGlmIChkZWZhdWx0QWNjZW50Q29sb3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkZWZhdWx0QWNjZW50Q29sb3IgPSB1dGlsc18xLmFkLnJlc291cmNlcy5nZXRQYWxldHRlQ29sb3IoQUNDRU5UX0NPTE9SLCBjb250ZXh0KSB8fCAweEZGMzNCNUU1O1xuICAgIH1cbiAgICByZXR1cm4gZGVmYXVsdEFjY2VudENvbG9yO1xufVxudmFyIFRhYlZpZXdJdGVtID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiVmlld0l0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiVmlld0l0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdJdGVtLnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRUcmFuc2Zvcm1hdGlvbk1ldGhvZCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCh0aGlzLl9kZWZhdWx0VHJhbnNmb3JtYXRpb25NZXRob2QpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5jYW5CZUxvYWRlZCA9IGZhbHNlO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHR2ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgdGFiVmlldyA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAodHYgJiYgdGFiVmlldykge1xuICAgICAgICAgICAgdGhpcy50YWJJdGVtU3BlYyA9IGNyZWF0ZVRhYkl0ZW1TcGVjKHRoaXMpO1xuICAgICAgICAgICAgdGFiVmlldy51cGRhdGVBbmRyb2lkSXRlbUF0KHRoaXMuaW5kZXgsIHRoaXMudGFiSXRlbVNwZWMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuX2dldENoaWxkRnJhZ21lbnRNYW5hZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFiVmlldyA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiRnJhZ21lbnQgPSBudWxsO1xuICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGFiVmlldy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBmcmFnbWVudE1hbmFnZXIuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgaWYgKGZyYWdtZW50LmluZGV4ID09PSB0aGlzLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgdGFiRnJhZ21lbnQgPSBmcmFnbWVudDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRhYkZyYWdtZW50KSB7XG4gICAgICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiQ291bGQgbm90IGdldCBjaGlsZCBmcmFnbWVudCBtYW5hZ2VyIGZvciB0YWIgaXRlbSB3aXRoIGluZGV4IFwiICsgdGhpcy5pbmRleCwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGFiVmlldy5fZ2V0Um9vdEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0YWJGcmFnbWVudC5nZXRDaGlsZEZyYWdtZW50TWFuYWdlcigpO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmZvbnRTaXplUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IG5hdGl2ZVNpemU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRUZXh0U2l6ZSgpIH07XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dFNpemUoYW5kcm9pZC51dGlsLlR5cGVkVmFsdWUuQ09NUExFWF9VTklUX1BYLCB2YWx1ZS5uYXRpdmVTaXplKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmZvbnRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmdldFR5cGVmYWNlKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VHlwZWZhY2UodmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCA/IHZhbHVlLmdldEFuZHJvaWRUeXBlZmFjZSgpIDogdmFsdWUpO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlW3RleHRfYmFzZV8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiZGVmYXVsdFwiO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlW3RleHRfYmFzZV8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB0diA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKHZhbHVlID09PSBcImRlZmF1bHRcIikge1xuICAgICAgICAgICAgdHYuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QodGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kKTtcbiAgICAgICAgICAgIHR2LnNldFRleHQodGhpcy50aXRsZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KHRoaXMudGl0bGUsIHZhbHVlKTtcbiAgICAgICAgICAgIHR2LnNldFRleHQocmVzdWx0KTtcbiAgICAgICAgICAgIHR2LnNldFRyYW5zZm9ybWF0aW9uTWV0aG9kKG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gVGFiVmlld0l0ZW07XG59KHRhYl92aWV3X2NvbW1vbl8xLlRhYlZpZXdJdGVtQmFzZSkpO1xuZXhwb3J0cy5UYWJWaWV3SXRlbSA9IFRhYlZpZXdJdGVtO1xuZnVuY3Rpb24gc2V0RWxldmF0aW9uKGdyaWQsIHRhYkxheW91dCkge1xuICAgIHZhciBjb21wYXQgPSBhbmRyb2lkeC5jb3JlLnZpZXcuVmlld0NvbXBhdDtcbiAgICBpZiAoY29tcGF0LnNldEVsZXZhdGlvbikge1xuICAgICAgICB2YXIgdmFsID0gREVGQVVMVF9FTEVWQVRJT04gKiB0YWJfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgY29tcGF0LnNldEVsZXZhdGlvbihncmlkLCB2YWwpO1xuICAgICAgICBjb21wYXQuc2V0RWxldmF0aW9uKHRhYkxheW91dCwgdmFsKTtcbiAgICB9XG59XG5leHBvcnRzLnRhYnMgPSBuZXcgQXJyYXkoKTtcbmZ1bmN0aW9uIGl0ZXJhdGVJbmRleFJhbmdlKGluZGV4LCBlcHMsIGxhc3RJbmRleCwgY2FsbGJhY2spIHtcbiAgICB2YXIgcmFuZ2VTdGFydCA9IE1hdGgubWF4KDAsIGluZGV4IC0gZXBzKTtcbiAgICB2YXIgcmFuZ2VFbmQgPSBNYXRoLm1pbihpbmRleCArIGVwcywgbGFzdEluZGV4KTtcbiAgICBmb3IgKHZhciBpID0gcmFuZ2VTdGFydDsgaSA8PSByYW5nZUVuZDsgaSsrKSB7XG4gICAgICAgIGNhbGxiYWNrKGkpO1xuICAgIH1cbn1cbnZhciBUYWJWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYW5kcm9pZFZpZXdJZCA9IC0xO1xuICAgICAgICBleHBvcnRzLnRhYnMucHVzaChuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3LnByb3RvdHlwZSwgXCJfaGFzRnJhZ21lbnRzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlldy5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQuY2FsbCh0aGlzLCBvbGRJdGVtcywgbmV3SXRlbXMpO1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIG9sZEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgICAgIGl0ZW0uaW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIGl0ZW0udGFiSXRlbVNwZWMgPSBudWxsO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0TmF0aXZlVmlldyhudWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpbml0aWFsaXplTmF0aXZlQ2xhc3NlcygpO1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3Ll9jcmVhdGVVSShcIiArIHRoaXMgKyBcIik7XCIsIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcnkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fY29udGV4dDtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRMYXlvdXQoY29udGV4dCk7XG4gICAgICAgIHZhciB2aWV3UGFnZXIgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlRhYlZpZXdQYWdlcihjb250ZXh0KTtcbiAgICAgICAgdmFyIHRhYkxheW91dCA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFiTGF5b3V0KGNvbnRleHQpO1xuICAgICAgICB2YXIgbHAgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICB2YXIgcHJpbWFyeUNvbG9yID0gdXRpbHNfMS5hZC5yZXNvdXJjZXMuZ2V0UGFsZXR0ZUNvbG9yKFBSSU1BUllfQ09MT1IsIGNvbnRleHQpO1xuICAgICAgICB2YXIgYWNjZW50Q29sb3IgPSBnZXREZWZhdWx0QWNjZW50Q29sb3IoY29udGV4dCk7XG4gICAgICAgIGxwLnJvdyA9IDE7XG4gICAgICAgIGlmICh0aGlzLmFuZHJvaWRUYWJzUG9zaXRpb24gPT09IFwidG9wXCIpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5hdXRvKSk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuc3RhcikpO1xuICAgICAgICAgICAgdmlld1BhZ2VyLnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYW5kcm9pZFN3aXBlRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHZpZXdQYWdlci5zZXRTd2lwZVBhZ2VFbmFibGVkKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5zdGFyKSk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuYXV0bykpO1xuICAgICAgICAgICAgdGFiTGF5b3V0LnNldExheW91dFBhcmFtcyhscCk7XG4gICAgICAgICAgICB2aWV3UGFnZXIuc2V0U3dpcGVQYWdlRW5hYmxlZChmYWxzZSk7XG4gICAgICAgICAgICBhY2NlbnRDb2xvciA9IDB4MDBGRkZGRkY7XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5hZGRWaWV3KHZpZXdQYWdlcik7XG4gICAgICAgIG5hdGl2ZVZpZXcudmlld1BhZ2VyID0gdmlld1BhZ2VyO1xuICAgICAgICB2YXIgYWRhcHRlciA9IG5ldyBQYWdlckFkYXB0ZXIodGhpcyk7XG4gICAgICAgIHZpZXdQYWdlci5zZXRBZGFwdGVyKGFkYXB0ZXIpO1xuICAgICAgICB2aWV3UGFnZXIuYWRhcHRlciA9IGFkYXB0ZXI7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVmlldyh0YWJMYXlvdXQpO1xuICAgICAgICBuYXRpdmVWaWV3LnRhYkxheW91dCA9IHRhYkxheW91dDtcbiAgICAgICAgc2V0RWxldmF0aW9uKG5hdGl2ZVZpZXcsIHRhYkxheW91dCk7XG4gICAgICAgIGlmIChhY2NlbnRDb2xvcikge1xuICAgICAgICAgICAgdGFiTGF5b3V0LnNldFNlbGVjdGVkSW5kaWNhdG9yQ29sb3JzKFthY2NlbnRDb2xvcl0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcmltYXJ5Q29sb3IpIHtcbiAgICAgICAgICAgIHRhYkxheW91dC5zZXRCYWNrZ3JvdW5kQ29sb3IocHJpbWFyeUNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmF0aXZlVmlldztcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLl9hbmRyb2lkVmlld0lkIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXdJZCA9IGFuZHJvaWQudmlldy5WaWV3LmdlbmVyYXRlVmlld0lkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRoaXMuX3RhYkxheW91dCA9IG5hdGl2ZVZpZXcudGFiTGF5b3V0O1xuICAgICAgICB2YXIgdmlld1BhZ2VyID0gbmF0aXZlVmlldy52aWV3UGFnZXI7XG4gICAgICAgIHZpZXdQYWdlci5zZXRJZCh0aGlzLl9hbmRyb2lkVmlld0lkKTtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyID0gdmlld1BhZ2VyO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIgPSB2aWV3UGFnZXIuYWRhcHRlcjtcbiAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm93bmVyID0gdGhpcztcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLl9sb2FkVW5sb2FkVGFiSXRlbXMgPSBmdW5jdGlvbiAobmV3SW5kZXgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgdmFyIGxhc3RJbmRleCA9IHRoaXMuaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIG9mZnNpZGVJdGVtcyA9IHRoaXMuYW5kcm9pZFRhYnNQb3NpdGlvbiA9PT0gXCJ0b3BcIiA/IHRoaXMuYW5kcm9pZE9mZnNjcmVlblRhYkxpbWl0IDogMTtcbiAgICAgICAgdmFyIHRvVW5sb2FkID0gW107XG4gICAgICAgIHZhciB0b0xvYWQgPSBbXTtcbiAgICAgICAgaXRlcmF0ZUluZGV4UmFuZ2UobmV3SW5kZXgsIG9mZnNpZGVJdGVtcywgbGFzdEluZGV4LCBmdW5jdGlvbiAoaSkgeyByZXR1cm4gdG9Mb2FkLnB1c2goaSk7IH0pO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhPZkkgPSB0b0xvYWQuaW5kZXhPZihpKTtcbiAgICAgICAgICAgIGlmIChpbmRleE9mSSA8IDApIHtcbiAgICAgICAgICAgICAgICB0b1VubG9hZC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdG9VbmxvYWQuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIGl0ZW0udW5sb2FkVmlldyhpdGVtLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG5ld0l0ZW0gPSBpdGVtc1tuZXdJbmRleF07XG4gICAgICAgIHZhciBzZWxlY3RlZFZpZXcgPSBuZXdJdGVtICYmIG5ld0l0ZW0udmlldztcbiAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkVmlldy5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRvTG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2FkZWQgJiYgaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5sb2FkVmlldyhpdGVtLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0QWRhcHRlckl0ZW1zKHRoaXMuaXRlbXMpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0QWRhcHRlckl0ZW1zKG51bGwpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3RhYkxheW91dC5zZXRJdGVtcyhudWxsLCBudWxsKTtcbiAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLm93bmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdGFiTGF5b3V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRGcmFnbWVudHMoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLmRpc3Bvc2VDdXJyZW50RnJhZ21lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBmcmFnbWVudE1hbmFnZXIuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ucmVtb3ZlKGZyYWdtZW50KTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2FjdGlvbi5jb21taXROb3dBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuc2hvdWxkVXBkYXRlQWRhcHRlciA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICBpZiAoIXRoaXMuX3BhZ2VyQWRhcHRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMgPSB0aGlzLl9wYWdlckFkYXB0ZXIuaXRlbXM7XG4gICAgICAgIGlmICghaXRlbXMgJiYgIWN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXRlbXMgfHwgIWN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCAhPT0gY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hdGNoaW5nSXRlbXMgPSBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChjdXJyZW50SXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuICEhaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uX2RvbUlkID09PSBjdXJyZW50SXRlbS5fZG9tSWQ7XG4gICAgICAgICAgICB9KVswXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChtYXRjaGluZ0l0ZW1zLmxlbmd0aCAhPT0gaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5zZXRBZGFwdGVySXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkVXBkYXRlQWRhcHRlcihpdGVtcykpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5pdGVtcyA9IGl0ZW1zO1xuICAgICAgICAgICAgdmFyIGxlbmd0aF8xID0gaXRlbXMgPyBpdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgaWYgKGxlbmd0aF8xID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldEl0ZW1zKG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5ub3RpZnlEYXRhU2V0Q2hhbmdlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJJdGVtc18xID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSBjcmVhdGVUYWJJdGVtU3BlYyhpdGVtKTtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICBpdGVtLnRhYkl0ZW1TcGVjID0gdGFiSXRlbVNwZWM7XG4gICAgICAgICAgICAgICAgdGFiSXRlbXNfMS5wdXNoKHRhYkl0ZW1TcGVjKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHRhYkxheW91dF8xID0gdGhpcy5fdGFiTGF5b3V0O1xuICAgICAgICAgICAgdGFiTGF5b3V0XzEuc2V0SXRlbXModGFiSXRlbXNfMSwgdGhpcy5fdmlld1BhZ2VyKTtcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgICAgIHZhciB0diA9IHRhYkxheW91dF8xLmdldFRleHRWaWV3Rm9ySXRlbUF0KGkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0TmF0aXZlVmlldyh0dik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5ub3RpZnlEYXRhU2V0Q2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS51cGRhdGVBbmRyb2lkSXRlbUF0ID0gZnVuY3Rpb24gKGluZGV4LCBzcGVjKSB7XG4gICAgICAgIHRoaXMuX3RhYkxheW91dC51cGRhdGVJdGVtQXQoaW5kZXgsIHNwZWMpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuYW5kcm9pZE9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3UGFnZXIuZ2V0T2Zmc2NyZWVuUGFnZUxpbWl0KCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5hbmRyb2lkT2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ZpZXdQYWdlci5zZXRPZmZzY3JlZW5QYWdlTGltaXQodmFsdWUpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHNtb290aFNjcm9sbCA9IHRoaXMuYW5kcm9pZFRhYnNQb3NpdGlvbiA9PT0gXCJ0b3BcIjtcbiAgICAgICAgaWYgKHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiVGFiVmlldyB0aGlzLl92aWV3UGFnZXIuc2V0Q3VycmVudEl0ZW0oXCIgKyB2YWx1ZSArIFwiLCBcIiArIHNtb290aFNjcm9sbCArIFwiKTtcIiwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yeSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyLnNldEN1cnJlbnRJdGVtKHZhbHVlLCBzbW9vdGhTY3JvbGwpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuaXRlbXNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRBZGFwdGVySXRlbXModmFsdWUpO1xuICAgICAgICB0YWJfdmlld19jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEudGFiQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWJMYXlvdXQuZ2V0QmFja2dyb3VuZCgpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEudGFiQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB0YWJfdmlld19jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldEJhY2tncm91bmRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3RhYkxheW91dC5zZXRCYWNrZ3JvdW5kKHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5nZXRSZXNvdXJjZXMpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEudGFiVGV4dEZvbnRTaXplUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWJMYXlvdXQuZ2V0VGFiVGV4dEZvbnRTaXplKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX3RhYkxheW91dC5zZXRUYWJUZXh0Rm9udFNpemUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGFiTGF5b3V0LnNldFRhYlRleHRGb250U2l6ZSh2YWx1ZS5uYXRpdmVTaXplKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEudGFiVGV4dENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWJMYXlvdXQuZ2V0VGFiVGV4dENvbG9yKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIHRoaXMuX3RhYkxheW91dC5zZXRUYWJUZXh0Q29sb3IoY29sb3IpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuc2VsZWN0ZWRUYWJUZXh0Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RhYkxheW91dC5nZXRTZWxlY3RlZFRhYlRleHRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuc2VsZWN0ZWRUYWJUZXh0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIHRoaXMuX3RhYkxheW91dC5zZXRTZWxlY3RlZFRhYlRleHRDb2xvcihjb2xvcik7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZ2V0RGVmYXVsdEFjY2VudENvbG9yKHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB0YWJMYXlvdXQgPSB0aGlzLl90YWJMYXlvdXQ7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIHRhYkxheW91dC5zZXRTZWxlY3RlZEluZGljYXRvckNvbG9ycyhbY29sb3JdKTtcbiAgICB9O1xuICAgIHJldHVybiBUYWJWaWV3O1xufSh0YWJfdmlld19jb21tb25fMS5UYWJWaWV3QmFzZSkpO1xuZXhwb3J0cy5UYWJWaWV3ID0gVGFiVmlldztcbmZ1bmN0aW9uIHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHJlc291cmNlcykge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29uc3RhbnRTdGF0ZSA9IHZhbHVlLmdldENvbnN0YW50U3RhdGUoKTtcbiAgICAgICAgaWYgKGNvbnN0YW50U3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25zdGFudFN0YXRlLm5ld0RyYXdhYmxlKHJlc291cmNlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLXZpZXcuYW5kcm9pZC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2VcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItbmF2aWdhdGlvbi1iYXNlXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiKSk7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5pdGVtcyA9IFwiaXRlbXNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgVGFic0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJzQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJzQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJzQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYnNcIilcbiAgICBdLCBUYWJzQmFzZSk7XG4gICAgcmV0dXJuIFRhYnNCYXNlO1xufSh0YWJfbmF2aWdhdGlvbl9iYXNlXzEuVGFiTmF2aWdhdGlvbkJhc2UpKTtcbmV4cG9ydHMuVGFic0Jhc2UgPSBUYWJzQmFzZTtcbmV4cG9ydHMuc3dpcGVFbmFibGVkUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInN3aXBlRW5hYmxlZFwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlclxufSk7XG5leHBvcnRzLnN3aXBlRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFRhYnNCYXNlKTtcbmV4cG9ydHMub2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwib2Zmc2NyZWVuVGFiTGltaXRcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMub2Zmc2NyZWVuVGFiTGltaXRQcm9wZXJ0eS5yZWdpc3RlcihUYWJzQmFzZSk7XG5leHBvcnRzLnRhYnNQb3NpdGlvblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGFic1Bvc2l0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJ0b3BcIiB9KTtcbmV4cG9ydHMudGFic1Bvc2l0aW9uUHJvcGVydHkucmVnaXN0ZXIoVGFic0Jhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFicy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0YWJfc3RyaXBfMSA9IHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiKTtcbnZhciB0YWJfc3RyaXBfaXRlbV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIik7XG52YXIgYXBwbGljYXRpb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG52YXIgaW1hZ2Vfc291cmNlXzEgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2Utc291cmNlXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4uL2ZyYW1lXCIpO1xudmFyIHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2VcIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xudmFyIHRhYnNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90YWJzLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RhYnMtY29tbW9uXCIpKTtcbnZhciBBQ0NFTlRfQ09MT1IgPSBcImNvbG9yQWNjZW50XCI7XG52YXIgUFJJTUFSWV9DT0xPUiA9IFwiY29sb3JQcmltYXJ5XCI7XG52YXIgREVGQVVMVF9FTEVWQVRJT04gPSA0O1xudmFyIFRBQklEID0gXCJfdGFiSWRcIjtcbnZhciBJTkRFWCA9IFwiX2luZGV4XCI7XG52YXIgUGFnZXJBZGFwdGVyO1xudmFyIFRhYnNCYXI7XG5mdW5jdGlvbiBtYWtlRnJhZ21lbnROYW1lKHZpZXdJZCwgaWQpIHtcbiAgICByZXR1cm4gXCJhbmRyb2lkOnZpZXdwYWdlcjpcIiArIHZpZXdJZCArIFwiOlwiICsgaWQ7XG59XG5mdW5jdGlvbiBnZXRUYWJCeUlkKGlkKSB7XG4gICAgdmFyIHJlZiA9IGV4cG9ydHMudGFicy5maW5kKGZ1bmN0aW9uIChyZWYpIHtcbiAgICAgICAgdmFyIHRhYiA9IHJlZi5nZXQoKTtcbiAgICAgICAgcmV0dXJuIHRhYiAmJiB0YWIuX2RvbUlkID09PSBpZDtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVmICYmIHJlZi5nZXQoKTtcbn1cbmZ1bmN0aW9uIGluaXRpYWxpemVOYXRpdmVDbGFzc2VzKCkge1xuICAgIGlmIChQYWdlckFkYXB0ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ubmV3SW5zdGFuY2UgPSBmdW5jdGlvbiAodGFiSWQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IG5ldyBhbmRyb2lkLm9zLkJ1bmRsZSgpO1xuICAgICAgICAgICAgYXJncy5wdXRJbnQoVEFCSUQsIHRhYklkKTtcbiAgICAgICAgICAgIGFyZ3MucHV0SW50KElOREVYLCBpbmRleCk7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBuZXcgVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgICAgICAgZnJhZ21lbnQuc2V0QXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9O1xuICAgICAgICBUYWJGcmFnbWVudEltcGxlbWVudGF0aW9uLnByb3RvdHlwZS5vbkNyZWF0ZSA9IGZ1bmN0aW9uIChzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25DcmVhdGUuY2FsbCh0aGlzLCBzYXZlZEluc3RhbmNlU3RhdGUpO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSB0aGlzLmdldEFyZ3VtZW50cygpO1xuICAgICAgICAgICAgdGhpcy50YWIgPSBnZXRUYWJCeUlkKGFyZ3MuZ2V0SW50KFRBQklEKSk7XG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gYXJncy5nZXRJbnQoSU5ERVgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnRhYikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIFRhYlZpZXdcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uQ3JlYXRlVmlldyA9IGZ1bmN0aW9uIChpbmZsYXRlciwgY29udGFpbmVyLCBzYXZlZEluc3RhbmNlU3RhdGUpIHtcbiAgICAgICAgICAgIHZhciB0YWJJdGVtID0gdGhpcy50YWIuaXRlbXNbdGhpcy5pbmRleF07XG4gICAgICAgICAgICByZXR1cm4gdGFiSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVGFiRnJhZ21lbnRJbXBsZW1lbnRhdGlvbjtcbiAgICB9KG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5GcmFnbWVudEJhc2UpKTtcbiAgICB2YXIgUE9TSVRJT05fVU5DSEFOR0VEID0gLTE7XG4gICAgdmFyIFBPU0lUSU9OX05PTkUgPSAtMjtcbiAgICB2YXIgRnJhZ21lbnRQYWdlckFkYXB0ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRnJhZ21lbnRQYWdlckFkYXB0ZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEZyYWdtZW50UGFnZXJBZGFwdGVyKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgICAgICByZXR1cm4gaXRlbXMgPyBpdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZ2V0UGFnZVRpdGxlID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuc3RhcnRVcGRhdGUgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLmdldElkKCkgPT09IGFuZHJvaWQudmlldy5WaWV3Lk5PX0lEKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlld1BhZ2VyIHdpdGggYWRhcHRlciBcIiArIHRoaXMgKyBcIiByZXF1aXJlcyBhIHZpZXcgY29udGFpbmVySWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5pbnN0YW50aWF0ZUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbikge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMub3duZXIuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1DdXJUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpdGVtSWQgPSB0aGlzLmdldEl0ZW1JZChwb3NpdGlvbik7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG1ha2VGcmFnbWVudE5hbWUoY29udGFpbmVyLmdldElkKCksIGl0ZW1JZCk7XG4gICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSBmcmFnbWVudE1hbmFnZXIuZmluZEZyYWdtZW50QnlUYWcobmFtZSk7XG4gICAgICAgICAgICBpZiAoZnJhZ21lbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmF0dGFjaChmcmFnbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudCA9IFRhYkZyYWdtZW50SW1wbGVtZW50YXRpb24ubmV3SW5zdGFuY2UodGhpcy5vd25lci5fZG9tSWQsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbi5hZGQoY29udGFpbmVyLmdldElkKCksIGZyYWdtZW50LCBuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPT0gdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtKSB7XG4gICAgICAgICAgICAgICAgZnJhZ21lbnQuc2V0TWVudVZpc2liaWxpdHkoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldFVzZXJWaXNpYmxlSGludChmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0aGlzLm93bmVyLml0ZW1zO1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodGFiSXRlbSkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW0uY2FuQmVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50O1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZ2V0SXRlbVBvc2l0aW9uID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXMgPyBQT1NJVElPTl9VTkNIQU5HRUQgOiBQT1NJVElPTl9OT05FO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZGVzdHJveUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyLCBwb3NpdGlvbiwgb2JqZWN0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubUN1clRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYWdtZW50TWFuYWdlciA9IHRoaXMub3duZXIuX2dldEZyYWdtZW50TWFuYWdlcigpO1xuICAgICAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uID0gZnJhZ21lbnRNYW5hZ2VyLmJlZ2luVHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmcmFnbWVudCA9IG9iamVjdDtcbiAgICAgICAgICAgIHRoaXMubUN1clRyYW5zYWN0aW9uLmRldGFjaChmcmFnbWVudCk7XG4gICAgICAgICAgICBpZiAodGhpcy5tQ3VycmVudFByaW1hcnlJdGVtID09PSBmcmFnbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFiSXRlbXMgPSB0aGlzLm93bmVyLml0ZW1zO1xuICAgICAgICAgICAgdmFyIHRhYkl0ZW0gPSB0YWJJdGVtcyA/IHRhYkl0ZW1zW3Bvc2l0aW9uXSA6IG51bGw7XG4gICAgICAgICAgICBpZiAodGFiSXRlbSkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW0uY2FuQmVMb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLnNldFByaW1hcnlJdGVtID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcG9zaXRpb24sIG9iamVjdCkge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gb2JqZWN0O1xuICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9PSB0aGlzLm1DdXJyZW50UHJpbWFyeUl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tQ3VycmVudFByaW1hcnlJdGVtICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtLnNldE1lbnVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tQ3VycmVudFByaW1hcnlJdGVtLnNldFVzZXJWaXNpYmxlSGludChmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChmcmFnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LnNldE1lbnVWaXNpYmlsaXR5KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5zZXRVc2VyVmlzaWJsZUhpbnQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubUN1cnJlbnRQcmltYXJ5SXRlbSA9IGZyYWdtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0ZWRJbmRleCA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgICAgIHZhciB0YWIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgICAgIHZhciB0YWJJdGVtcyA9IHRhYi5pdGVtcztcbiAgICAgICAgICAgICAgICB2YXIgbmV3VGFiSXRlbSA9IHRhYkl0ZW1zID8gdGFiSXRlbXNbcG9zaXRpb25dIDogbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAobmV3VGFiSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB0YWIuX2xvYWRVbmxvYWRUYWJJdGVtcyh0YWIuc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuZmluaXNoVXBkYXRlID0gZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5fY29tbWl0Q3VycmVudFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5pc1ZpZXdGcm9tT2JqZWN0ID0gZnVuY3Rpb24gKHZpZXcsIG9iamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIG9iamVjdC5nZXRWaWV3KCkgPT09IHZpZXc7XG4gICAgICAgIH07XG4gICAgICAgIEZyYWdtZW50UGFnZXJBZGFwdGVyLnByb3RvdHlwZS5zYXZlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9jb21taXRDdXJyZW50VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUucmVzdG9yZVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlLCBsb2FkZXIpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRnJhZ21lbnRQYWdlckFkYXB0ZXIucHJvdG90eXBlLmdldEl0ZW1JZCA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9uO1xuICAgICAgICB9O1xuICAgICAgICBGcmFnbWVudFBhZ2VyQWRhcHRlci5wcm90b3R5cGUuX2NvbW1pdEN1cnJlbnRUcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm1DdXJUcmFuc2FjdGlvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tQ3VyVHJhbnNhY3Rpb24uY29tbWl0Tm93QWxsb3dpbmdTdGF0ZUxvc3MoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1DdXJUcmFuc2FjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBGcmFnbWVudFBhZ2VyQWRhcHRlcjtcbiAgICB9KGFuZHJvaWR4LnZpZXdwYWdlci53aWRnZXQuUGFnZXJBZGFwdGVyKSk7XG4gICAgdmFyIFRhYnNCYXJJbXBsZW1lbnRhdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUYWJzQmFySW1wbGVtZW50YXRpb24sIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFRhYnNCYXJJbXBsZW1lbnRhdGlvbihjb250ZXh0LCBvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgY29udGV4dCkgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBUYWJzQmFySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uU2VsZWN0ZWRQb3NpdGlvbkNoYW5nZSA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgcHJldlBvc2l0aW9uKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJTdHJpcEl0ZW1zID0gb3duZXIudGFiU3RyaXAgJiYgb3duZXIudGFiU3RyaXAuaXRlbXM7XG4gICAgICAgICAgICBpZiAocG9zaXRpb24gPj0gMCAmJiB0YWJTdHJpcEl0ZW1zICYmIHRhYlN0cmlwSXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0uc2VsZWN0RXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZXZQb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXMgJiYgdGFiU3RyaXBJdGVtc1twcmV2UG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twcmV2UG9zaXRpb25dLl9lbWl0KHRhYl9zdHJpcF9pdGVtXzEuVGFiU3RyaXBJdGVtLnVuc2VsZWN0RXZlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBUYWJzQmFySW1wbGVtZW50YXRpb24ucHJvdG90eXBlLm9uVGFwID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YWJTdHJpcCA9IG93bmVyLnRhYlN0cmlwO1xuICAgICAgICAgICAgdmFyIHRhYlN0cmlwSXRlbXMgPSB0YWJTdHJpcCAmJiB0YWJTdHJpcC5pdGVtcztcbiAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+PSAwICYmIHRhYlN0cmlwSXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0udGFwRXZlbnQpO1xuICAgICAgICAgICAgICAgIHRhYlN0cmlwLm5vdGlmeSh7IGV2ZW50TmFtZTogdGFiX3N0cmlwXzEuVGFiU3RyaXAuaXRlbVRhcEV2ZW50LCBvYmplY3Q6IHRhYlN0cmlwLCBpbmRleDogcG9zaXRpb24gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW93bmVyLml0ZW1zW3Bvc2l0aW9uXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVGFic0JhckltcGxlbWVudGF0aW9uO1xuICAgIH0ob3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlRhYnNCYXIpKTtcbiAgICBQYWdlckFkYXB0ZXIgPSBGcmFnbWVudFBhZ2VyQWRhcHRlcjtcbiAgICBUYWJzQmFyID0gVGFic0JhckltcGxlbWVudGF0aW9uO1xufVxudmFyIGRlZmF1bHRBY2NlbnRDb2xvciA9IHVuZGVmaW5lZDtcbmZ1bmN0aW9uIGdldERlZmF1bHRBY2NlbnRDb2xvcihjb250ZXh0KSB7XG4gICAgaWYgKGRlZmF1bHRBY2NlbnRDb2xvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGRlZmF1bHRBY2NlbnRDb2xvciA9IHV0aWxzXzEuYWQucmVzb3VyY2VzLmdldFBhbGV0dGVDb2xvcihBQ0NFTlRfQ09MT1IsIGNvbnRleHQpIHx8IDB4RkYzM0I1RTU7XG4gICAgfVxuICAgIHJldHVybiBkZWZhdWx0QWNjZW50Q29sb3I7XG59XG5mdW5jdGlvbiBzZXRFbGV2YXRpb24oZ3JpZCwgdGFic0JhciwgdGFic1Bvc2l0aW9uKSB7XG4gICAgdmFyIGNvbXBhdCA9IGFuZHJvaWR4LmNvcmUudmlldy5WaWV3Q29tcGF0O1xuICAgIGlmIChjb21wYXQuc2V0RWxldmF0aW9uKSB7XG4gICAgICAgIHZhciB2YWwgPSBERUZBVUxUX0VMRVZBVElPTiAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIGlmICh0YWJzUG9zaXRpb24gPT09IFwidG9wXCIpIHtcbiAgICAgICAgICAgIGNvbXBhdC5zZXRFbGV2YXRpb24oZ3JpZCwgdmFsKTtcbiAgICAgICAgfVxuICAgICAgICBjb21wYXQuc2V0RWxldmF0aW9uKHRhYnNCYXIsIHZhbCk7XG4gICAgfVxufVxuZXhwb3J0cy50YWJzID0gbmV3IEFycmF5KCk7XG5mdW5jdGlvbiBpdGVyYXRlSW5kZXhSYW5nZShpbmRleCwgZXBzLCBsYXN0SW5kZXgsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHJhbmdlU3RhcnQgPSBNYXRoLm1heCgwLCBpbmRleCAtIGVwcyk7XG4gICAgdmFyIHJhbmdlRW5kID0gTWF0aC5taW4oaW5kZXggKyBlcHMsIGxhc3RJbmRleCk7XG4gICAgZm9yICh2YXIgaSA9IHJhbmdlU3RhcnQ7IGkgPD0gcmFuZ2VFbmQ7IGkrKykge1xuICAgICAgICBjYWxsYmFjayhpKTtcbiAgICB9XG59XG52YXIgVGFicyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYnMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFicygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuZHJvaWRWaWV3SWQgPSAtMTtcbiAgICAgICAgZXhwb3J0cy50YWJzLnB1c2gobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFicy5wcm90b3R5cGUsIFwiX2hhc0ZyYWdtZW50c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYnMucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkLmNhbGwodGhpcywgb2xkSXRlbXMsIG5ld0l0ZW1zKTtcbiAgICAgICAgaWYgKG9sZEl0ZW1zKSB7XG4gICAgICAgICAgICBvbGRJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpLCBhcnIpIHtcbiAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICBpdGVtLnRhYkl0ZW1TcGVjID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpdGVtLnNldE5hdGl2ZVZpZXcobnVsbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdGlhbGl6ZU5hdGl2ZUNsYXNzZXMoKTtcbiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZExheW91dChjb250ZXh0KTtcbiAgICAgICAgdmFyIHZpZXdQYWdlciA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFiVmlld1BhZ2VyKGNvbnRleHQpO1xuICAgICAgICB2YXIgdGFic0JhciA9IG5ldyBUYWJzQmFyKGNvbnRleHQsIHRoaXMpO1xuICAgICAgICB2YXIgbHAgPSBuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkNvbW1vbkxheW91dFBhcmFtcygpO1xuICAgICAgICB2YXIgcHJpbWFyeUNvbG9yID0gdXRpbHNfMS5hZC5yZXNvdXJjZXMuZ2V0UGFsZXR0ZUNvbG9yKFBSSU1BUllfQ09MT1IsIGNvbnRleHQpO1xuICAgICAgICB2YXIgYWNjZW50Q29sb3IgPSBnZXREZWZhdWx0QWNjZW50Q29sb3IoY29udGV4dCk7XG4gICAgICAgIGxwLnJvdyA9IDE7XG4gICAgICAgIGlmICh0aGlzLnRhYnNQb3NpdGlvbiA9PT0gXCJ0b3BcIikge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRSb3cobmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5JdGVtU3BlYygxLCBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuR3JpZFVuaXRUeXBlLmF1dG8pKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5zdGFyKSk7XG4gICAgICAgICAgICB2aWV3UGFnZXIuc2V0TGF5b3V0UGFyYW1zKGxwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkUm93KG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuSXRlbVNwZWMoMSwgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkdyaWRVbml0VHlwZS5zdGFyKSk7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmFkZFJvdyhuZXcgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLkl0ZW1TcGVjKDEsIG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5HcmlkVW5pdFR5cGUuYXV0bykpO1xuICAgICAgICAgICAgdGFic0Jhci5zZXRMYXlvdXRQYXJhbXMobHApO1xuICAgICAgICB9XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVmlldyh2aWV3UGFnZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LnZpZXdQYWdlciA9IHZpZXdQYWdlcjtcbiAgICAgICAgdmFyIGFkYXB0ZXIgPSBuZXcgUGFnZXJBZGFwdGVyKHRoaXMpO1xuICAgICAgICB2aWV3UGFnZXIuc2V0QWRhcHRlcihhZGFwdGVyKTtcbiAgICAgICAgdmlld1BhZ2VyLmFkYXB0ZXIgPSBhZGFwdGVyO1xuICAgICAgICBuYXRpdmVWaWV3LmFkZFZpZXcodGFic0Jhcik7XG4gICAgICAgIG5hdGl2ZVZpZXcudGFic0JhciA9IHRhYnNCYXI7XG4gICAgICAgIHNldEVsZXZhdGlvbihuYXRpdmVWaWV3LCB0YWJzQmFyLCB0aGlzLnRhYnNQb3NpdGlvbik7XG4gICAgICAgIGlmIChhY2NlbnRDb2xvcikge1xuICAgICAgICAgICAgdGFic0Jhci5zZXRTZWxlY3RlZEluZGljYXRvckNvbG9ycyhbYWNjZW50Q29sb3JdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJpbWFyeUNvbG9yKSB7XG4gICAgICAgICAgICB0YWJzQmFyLnNldEJhY2tncm91bmRDb2xvcihwcmltYXJ5Q29sb3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYXRpdmVWaWV3O1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuX2FuZHJvaWRWaWV3SWQgPCAwKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmRyb2lkVmlld0lkID0gYW5kcm9pZC52aWV3LlZpZXcuZ2VuZXJhdGVWaWV3SWQoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdGhpcy5fdGFic0JhciA9IG5hdGl2ZVZpZXcudGFic0JhcjtcbiAgICAgICAgdmFyIHZpZXdQYWdlciA9IG5hdGl2ZVZpZXcudmlld1BhZ2VyO1xuICAgICAgICB2aWV3UGFnZXIuc2V0SWQodGhpcy5fYW5kcm9pZFZpZXdJZCk7XG4gICAgICAgIHRoaXMuX3ZpZXdQYWdlciA9IHZpZXdQYWdlcjtcbiAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyID0gdmlld1BhZ2VyLmFkYXB0ZXI7XG4gICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5vd25lciA9IHRoaXM7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5fbG9hZFVubG9hZFRhYkl0ZW1zID0gZnVuY3Rpb24gKG5ld0luZGV4KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIHZhciBsYXN0SW5kZXggPSB0aGlzLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBvZmZzaWRlSXRlbXMgPSB0aGlzLm9mZnNjcmVlblRhYkxpbWl0O1xuICAgICAgICB2YXIgdG9VbmxvYWQgPSBbXTtcbiAgICAgICAgdmFyIHRvTG9hZCA9IFtdO1xuICAgICAgICBpdGVyYXRlSW5kZXhSYW5nZShuZXdJbmRleCwgb2Zmc2lkZUl0ZW1zLCBsYXN0SW5kZXgsIGZ1bmN0aW9uIChpKSB7IHJldHVybiB0b0xvYWQucHVzaChpKTsgfSk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgIHZhciBpbmRleE9mSSA9IHRvTG9hZC5pbmRleE9mKGkpO1xuICAgICAgICAgICAgaWYgKGluZGV4T2ZJIDwgMCkge1xuICAgICAgICAgICAgICAgIHRvVW5sb2FkLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0b1VubG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS51bmxvYWRWaWV3KGl0ZW0uY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbmV3SXRlbSA9IGl0ZW1zW25ld0luZGV4XTtcbiAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IG5ld0l0ZW0gJiYgbmV3SXRlbS5jb250ZW50O1xuICAgICAgICBpZiAoc2VsZWN0ZWRWaWV3IGluc3RhbmNlb2YgZnJhbWVfMS5GcmFtZSkge1xuICAgICAgICAgICAgc2VsZWN0ZWRWaWV3Ll9wdXNoSW5GcmFtZVN0YWNrUmVjdXJzaXZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdG9Mb2FkLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pc0xvYWRlZCAmJiBpdGVtc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmxvYWRWaWV3KGl0ZW0uY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRJdGVtcyh0aGlzLml0ZW1zKTtcbiAgICAgICAgaWYgKHRoaXMudGFiU3RyaXApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyh0aGlzLnRhYlN0cmlwLml0ZW1zKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0SXRlbXMobnVsbCk7XG4gICAgICAgIHRoaXMuc2V0VGFiU3RyaXBJdGVtcyhudWxsKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90YWJzQmFyLnNldEl0ZW1zKG51bGwsIG51bGwpO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIub3duZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9wYWdlckFkYXB0ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl90YWJzQmFyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRGcmFnbWVudHMoKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmRpc3Bvc2VDdXJyZW50RnJhZ21lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZnJhZ21lbnRNYW5hZ2VyID0gdGhpcy5fZ2V0RnJhZ21lbnRNYW5hZ2VyKCk7XG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGZyYWdtZW50TWFuYWdlci5iZWdpblRyYW5zYWN0aW9uKCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBmcmFnbWVudE1hbmFnZXIuZ2V0RnJhZ21lbnRzKCkudG9BcnJheSgpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYWdtZW50ID0gX2FbX2ldO1xuICAgICAgICAgICAgdHJhbnNhY3Rpb24ucmVtb3ZlKGZyYWdtZW50KTtcbiAgICAgICAgfVxuICAgICAgICB0cmFuc2FjdGlvbi5jb21taXROb3dBbGxvd2luZ1N0YXRlTG9zcygpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2hvdWxkVXBkYXRlQWRhcHRlciA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICBpZiAoIXRoaXMuX3BhZ2VyQWRhcHRlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMgPSB0aGlzLl9wYWdlckFkYXB0ZXIuaXRlbXM7XG4gICAgICAgIGlmICghaXRlbXMgJiYgIWN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXRlbXMgfHwgIWN1cnJlbnRQYWdlckFkYXB0ZXJJdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCAhPT0gY3VycmVudFBhZ2VyQWRhcHRlckl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hdGNoaW5nSXRlbXMgPSBjdXJyZW50UGFnZXJBZGFwdGVySXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChjdXJyZW50SXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuICEhaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uX2RvbUlkID09PSBjdXJyZW50SXRlbS5fZG9tSWQ7XG4gICAgICAgICAgICB9KVswXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChtYXRjaGluZ0l0ZW1zLmxlbmd0aCAhPT0gaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRJdGVtcyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICBpZiAodGhpcy5zaG91bGRVcGRhdGVBZGFwdGVyKGl0ZW1zKSkge1xuICAgICAgICAgICAgdGhpcy5fcGFnZXJBZGFwdGVyLml0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICBpZiAoaXRlbXMgJiYgaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3BhZ2VyQWRhcHRlci5ub3RpZnlEYXRhU2V0Q2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJTdHJpcEl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBsZW5ndGggPSBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3RhYnNCYXIuc2V0SXRlbXMobnVsbCwgbnVsbCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYkl0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgaXRlbS5pbmRleCA9IGk7XG4gICAgICAgICAgICB2YXIgdGFiSXRlbVNwZWMgPSBfdGhpcy5jcmVhdGVUYWJJdGVtU3BlYyhpdGVtKTtcbiAgICAgICAgICAgIGl0ZW0udGFiSXRlbVNwZWMgPSB0YWJJdGVtU3BlYztcbiAgICAgICAgICAgIHRhYkl0ZW1zLnB1c2godGFiSXRlbVNwZWMpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHRhYnNCYXIgPSB0aGlzLl90YWJzQmFyO1xuICAgICAgICB0YWJzQmFyLnNldEl0ZW1zKHRhYkl0ZW1zLCB0aGlzLl92aWV3UGFnZXIpO1xuICAgICAgICB0aGlzLnRhYlN0cmlwLnNldE5hdGl2ZVZpZXcodGFic0Jhcik7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGksIGFycikge1xuICAgICAgICAgICAgdmFyIHR2ID0gdGFic0Jhci5nZXRUZXh0Vmlld0Zvckl0ZW1BdChpKTtcbiAgICAgICAgICAgIGl0ZW0uc2V0TmF0aXZlVmlldyh0dik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuY3JlYXRlVGFiSXRlbVNwZWMgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgIHZhciB0YWJJdGVtU3BlYyA9IG5ldyBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVGFiSXRlbVNwZWMoKTtcbiAgICAgICAgaWYgKHRhYlN0cmlwSXRlbS5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdmFyIG5lc3RlZExhYmVsID0gdGFiU3RyaXBJdGVtLmxhYmVsO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gbmVzdGVkTGFiZWwudGV4dDtcbiAgICAgICAgICAgIHZhciB0ZXh0VHJhbnNmb3JtID0gbmVzdGVkTGFiZWwuc3R5bGUudGV4dFRyYW5zZm9ybTtcbiAgICAgICAgICAgIGlmICh0ZXh0VHJhbnNmb3JtKSB7XG4gICAgICAgICAgICAgICAgdGl0bGUgPSB0ZXh0X2Jhc2VfMS5nZXRUcmFuc2Zvcm1lZFRleHQodGl0bGUsIHRleHRUcmFuc2Zvcm0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFiSXRlbVNwZWMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSB0YWJTdHJpcEl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgaWYgKGJhY2tncm91bmRDb2xvcikge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRDb2xvci5hbmRyb2lkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNvbG9yID0gbmVzdGVkTGFiZWwuc3R5bGUuY29sb3I7XG4gICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0YWJJdGVtU3BlYy5jb2xvciA9IGNvbG9yLmFuZHJvaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZm9udEludGVybmFsID0gbmVzdGVkTGFiZWwuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgaWYgKGZvbnRJbnRlcm5hbCkge1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLmZvbnRTaXplID0gZm9udEludGVybmFsLmZvbnRTaXplO1xuICAgICAgICAgICAgICAgIHRhYkl0ZW1TcGVjLnR5cGVGYWNlID0gZm9udEludGVybmFsLmdldEFuZHJvaWRUeXBlZmFjZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGljb25Tb3VyY2UgPSB0YWJTdHJpcEl0ZW0uaW1hZ2UgJiYgdGFiU3RyaXBJdGVtLmltYWdlLnNyYztcbiAgICAgICAgICAgIGlmIChpY29uU291cmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGljb24gPSB0aGlzLmdldEljb24odGFiU3RyaXBJdGVtKTtcbiAgICAgICAgICAgICAgICBpZiAoaWNvbikge1xuICAgICAgICAgICAgICAgICAgICB0YWJJdGVtU3BlYy5pY29uRHJhd2FibGUgPSBpY29uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhYkl0ZW1TcGVjO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZ2V0SWNvbiA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgdmFyIGljb25Tb3VyY2UgPSB0YWJTdHJpcEl0ZW0uaW1hZ2UgJiYgdGFiU3RyaXBJdGVtLmltYWdlLnNyYztcbiAgICAgICAgdmFyIGlzO1xuICAgICAgICBpZiAodXRpbHNfMS5pc0ZvbnRJY29uVVJJKGljb25Tb3VyY2UpKSB7XG4gICAgICAgICAgICB2YXIgZm9udEljb25Db2RlID0gaWNvblNvdXJjZS5zcGxpdChcIi8vXCIpWzFdO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRhYlN0cmlwSXRlbS5pbWFnZSA/IHRhYlN0cmlwSXRlbS5pbWFnZSA6IHRhYlN0cmlwSXRlbTtcbiAgICAgICAgICAgIHZhciBmb250ID0gdGFyZ2V0LnN0eWxlLmZvbnRJbnRlcm5hbDtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IHRhcmdldC5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGljb25Tb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbWFnZURyYXdhYmxlO1xuICAgICAgICBpZiAoaXMgJiYgaXMuYW5kcm9pZCkge1xuICAgICAgICAgICAgdmFyIGltYWdlID0gaXMuYW5kcm9pZDtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhYlN0cmlwICYmIHRoaXMudGFiU3RyaXAuaXNJY29uU2l6ZUZpeGVkKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2UgPSB0aGlzLmdldEZpeGVkU2l6ZUljb24oaW1hZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW1hZ2VEcmF3YWJsZSA9IG5ldyBhbmRyb2lkLmdyYXBoaWNzLmRyYXdhYmxlLkJpdG1hcERyYXdhYmxlKGFwcGxpY2F0aW9uLmFuZHJvaWQuY29udGV4dC5nZXRSZXNvdXJjZXMoKSwgaW1hZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbWFnZURyYXdhYmxlO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZ2V0Rml4ZWRTaXplSWNvbiA9IGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICB2YXIgaW5XaWR0aCA9IGltYWdlLmdldFdpZHRoKCk7XG4gICAgICAgIHZhciBpbkhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpO1xuICAgICAgICB2YXIgaWNvblNwZWNTaXplID0gdGFiX25hdmlnYXRpb25fYmFzZV8xLmdldEljb25TcGVjU2l6ZSh7IHdpZHRoOiBpbldpZHRoLCBoZWlnaHQ6IGluSGVpZ2h0IH0pO1xuICAgICAgICB2YXIgd2lkdGhQaXhlbHMgPSBpY29uU3BlY1NpemUud2lkdGggKiB1dGlsc18xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgICAgICB2YXIgaGVpZ2h0UGl4ZWxzID0gaWNvblNwZWNTaXplLmhlaWdodCAqIHV0aWxzXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIHZhciBzY2FsZWRJbWFnZSA9IGFuZHJvaWQuZ3JhcGhpY3MuQml0bWFwLmNyZWF0ZVNjYWxlZEJpdG1hcChpbWFnZSwgd2lkdGhQaXhlbHMsIGhlaWdodFBpeGVscywgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBzY2FsZWRJbWFnZTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnVwZGF0ZUFuZHJvaWRJdGVtQXQgPSBmdW5jdGlvbiAoaW5kZXgsIHNwZWMpIHtcbiAgICAgICAgdGhpcy5fdGFic0Jhci51cGRhdGVJdGVtQXQoaW5kZXgsIHNwZWMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZ2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFic0Jhci5nZXRCYWNrZ3JvdW5kKCk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2Ygdmlld18xLkNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLl90YWJzQmFyLnNldEJhY2tncm91bmRDb2xvcih2YWx1ZS5hbmRyb2lkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3RhYnNCYXIuc2V0QmFja2dyb3VuZCh0cnlDbG9uZURyYXdhYmxlKHZhbHVlLCB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZ2V0UmVzb3VyY2VzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmdldFRhYkJhckhpZ2hsaWdodENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZ2V0RGVmYXVsdEFjY2VudENvbG9yKHRoaXMuX2NvbnRleHQpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuQ29sb3IgPyB2YWx1ZS5hbmRyb2lkIDogdmFsdWU7XG4gICAgICAgIHRoaXMuX3RhYnNCYXIuc2V0U2VsZWN0ZWRJbmRpY2F0b3JDb2xvcnMoW2NvbG9yXSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtVGl0bGUgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB2YXIgdGFiU3RyaXBJdGVtSW5kZXggPSB0aGlzLnRhYlN0cmlwLml0ZW1zLmluZGV4T2YodGFiU3RyaXBJdGVtKTtcbiAgICAgICAgdmFyIHRhYkl0ZW1TcGVjID0gdGhpcy5jcmVhdGVUYWJJdGVtU3BlYyh0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB0aGlzLnVwZGF0ZUFuZHJvaWRJdGVtQXQodGFiU3RyaXBJdGVtSW5kZXgsIHRhYkl0ZW1TcGVjKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckl0ZW1CYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB2YXIgdGFiU3RyaXBJdGVtSW5kZXggPSB0aGlzLnRhYlN0cmlwLml0ZW1zLmluZGV4T2YodGFiU3RyaXBJdGVtKTtcbiAgICAgICAgdmFyIHRhYkl0ZW1TcGVjID0gdGhpcy5jcmVhdGVUYWJJdGVtU3BlYyh0YWJTdHJpcEl0ZW0pO1xuICAgICAgICB0aGlzLnVwZGF0ZUFuZHJvaWRJdGVtQXQodGFiU3RyaXBJdGVtSW5kZXgsIHRhYkl0ZW1TcGVjKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUZXh0Q29sb3IodmFsdWUuYW5kcm9pZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhckljb25Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHRhYlN0cmlwSXRlbS5pbmRleDtcbiAgICAgICAgdmFyIHRhYkJhckl0ZW0gPSB0aGlzLl90YWJzQmFyLmdldFZpZXdGb3JJdGVtQXQoaW5kZXgpO1xuICAgICAgICB2YXIgaW1nVmlldyA9IHRhYkJhckl0ZW0uZ2V0Q2hpbGRBdCgwKTtcbiAgICAgICAgdmFyIGRyYXdhYmxlID0gdGhpcy5nZXRJY29uKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIGltZ1ZpZXcuc2V0SW1hZ2VEcmF3YWJsZShkcmF3YWJsZSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udEludGVybmFsID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dFNpemUodmFsdWUuZm9udFNpemUpO1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRUeXBlZmFjZSh2YWx1ZS5nZXRBbmRyb2lkVHlwZWZhY2UoKSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtVGV4dFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXN0ZWRMYWJlbCA9IHRhYlN0cmlwSXRlbS5sYWJlbDtcbiAgICAgICAgdmFyIHRpdGxlID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KG5lc3RlZExhYmVsLnRleHQsIHZhbHVlKTtcbiAgICAgICAgdGFiU3RyaXBJdGVtLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2V0VGV4dCh0aXRsZSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHNtb290aFNjcm9sbCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3ZpZXdQYWdlci5zZXRDdXJyZW50SXRlbSh2YWx1ZSwgc21vb3RoU2Nyb2xsKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtcyh2YWx1ZSk7XG4gICAgICAgIHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuY29lcmNlKHRoaXMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLnRhYlN0cmlwUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFiX25hdmlnYXRpb25fYmFzZV8xLnRhYlN0cmlwUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldFRhYlN0cmlwSXRlbXModmFsdWUuaXRlbXMpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFic19jb21tb25fMS5zd2lwZUVuYWJsZWRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJzX2NvbW1vbl8xLnN3aXBlRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyLnNldFN3aXBlUGFnZUVuYWJsZWQodmFsdWUpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFic19jb21tb25fMS5vZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmlld1BhZ2VyLmdldE9mZnNjcmVlblBhZ2VMaW1pdCgpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFic19jb21tb25fMS5vZmZzY3JlZW5UYWJMaW1pdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdmlld1BhZ2VyLnNldE9mZnNjcmVlblBhZ2VMaW1pdCh2YWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gVGFicztcbn0odGFic19jb21tb25fMS5UYWJzQmFzZSkpO1xuZXhwb3J0cy5UYWJzID0gVGFicztcbmZ1bmN0aW9uIHRyeUNsb25lRHJhd2FibGUodmFsdWUsIHJlc291cmNlcykge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29uc3RhbnRTdGF0ZSA9IHZhbHVlLmdldENvbnN0YW50U3RhdGUoKTtcbiAgICAgICAgaWYgKGNvbnN0YW50U3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25zdGFudFN0YXRlLm5ld0RyYXdhYmxlKHJlc291cmNlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFicy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmb3JtYXR0ZWRfc3RyaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vdGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIpO1xuZXhwb3J0cy5Gb3JtYXR0ZWRTdHJpbmcgPSBmb3JtYXR0ZWRfc3RyaW5nXzEuRm9ybWF0dGVkU3RyaW5nO1xuZXhwb3J0cy5TcGFuID0gZm9ybWF0dGVkX3N0cmluZ18xLlNwYW47XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBDSElMRF9TUEFOID0gXCJTcGFuXCI7XG52YXIgQ0hJTERfRk9STUFUVEVEX1RFWFQgPSBcImZvcm1hdHRlZFRleHRcIjtcbnZhciBDSElMRF9GT1JNQVRURURfU1RSSU5HID0gXCJGb3JtYXR0ZWRTdHJpbmdcIjtcbnZhciBUZXh0QmFzZUNvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRleHRCYXNlQ29tbW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRCYXNlQ29tbW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwibmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udEZhbWlseVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udEZhbWlseTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udEZhbWlseSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImZvbnRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udFdlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFdlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFdlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImxldHRlclNwYWNpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmxldHRlclNwYWNpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmxldHRlclNwYWNpbmcgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJsaW5lSGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5saW5lSGVpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5saW5lSGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwidGV4dEFsaWdubWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dEFsaWdubWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dEFsaWdubWVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInRleHREZWNvcmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJ0ZXh0VHJhbnNmb3JtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwid2hpdGVTcGFjZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmcgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nVG9wO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ1JpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nUmlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdSaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdCb3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b207XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b20gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nTGVmdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdMZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fb25Gb3JtYXR0ZWRUZXh0Q29udGVudHNDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpc1tleHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eS5zZXROYXRpdmVdKGRhdGEudmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IENISUxEX1NQQU4pIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFRleHQgPSBuZXcgZm9ybWF0dGVkX3N0cmluZ18xLkZvcm1hdHRlZFN0cmluZygpO1xuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFRleHQuc3BhbnMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXR0ZWRUZXh0ID0gZm9ybWF0dGVkVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0dGVkVGV4dC5zcGFucy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYW1lID09PSBDSElMRF9GT1JNQVRURURfVEVYVCB8fCBuYW1lID09PSBDSElMRF9GT1JNQVRURURfU1RSSU5HKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm1hdHRlZFRleHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9yZXF1ZXN0TGF5b3V0T25UZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5mb3JtYXR0ZWRUZXh0O1xuICAgICAgICBpZiAodGV4dCkge1xuICAgICAgICAgICAgY2FsbGJhY2sodGV4dCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fc2V0TmF0aXZlVGV4dCA9IGZ1bmN0aW9uIChyZXNldCkge1xuICAgICAgICBpZiAocmVzZXQgPT09IHZvaWQgMCkgeyByZXNldCA9IGZhbHNlOyB9XG4gICAgfTtcbiAgICByZXR1cm4gVGV4dEJhc2VDb21tb247XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRleHRCYXNlQ29tbW9uID0gVGV4dEJhc2VDb21tb247XG5UZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2lzU2luZ2xlTGluZSA9IGZhbHNlO1xuZnVuY3Rpb24gaXNCb2xkKGZvbnRXZWlnaHQpIHtcbiAgICByZXR1cm4gZm9udFdlaWdodCA9PT0gXCJib2xkXCIgfHwgZm9udFdlaWdodCA9PT0gXCI3MDBcIiB8fCBmb250V2VpZ2h0ID09PSBcIjgwMFwiIHx8IGZvbnRXZWlnaHQgPT09IFwiOTAwXCI7XG59XG5leHBvcnRzLmlzQm9sZCA9IGlzQm9sZDtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0FuZHJvaWQgfSk7XG5leHBvcnRzLnRleHRQcm9wZXJ0eS5yZWdpc3RlcihUZXh0QmFzZUNvbW1vbik7XG5leHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImZvcm1hdHRlZFRleHRcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSwgdmFsdWVDaGFuZ2VkOiBvbkZvcm1hdHRlZFRleHRQcm9wZXJ0eUNoYW5nZWQgfSk7XG5leHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eS5yZWdpc3RlcihUZXh0QmFzZUNvbW1vbik7XG5mdW5jdGlvbiBvbkZvcm1hdHRlZFRleHRQcm9wZXJ0eUNoYW5nZWQodGV4dEJhc2UsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGlmIChvbGRWYWx1ZSkge1xuICAgICAgICBvbGRWYWx1ZS5vZmYodmlld18xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGV4dEJhc2UuX29uRm9ybWF0dGVkVGV4dENvbnRlbnRzQ2hhbmdlZCwgdGV4dEJhc2UpO1xuICAgICAgICB0ZXh0QmFzZS5fcmVtb3ZlVmlldyhvbGRWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgb2xkUGFyZW50ID0gbmV3VmFsdWUucGFyZW50O1xuICAgICAgICBpZiAob2xkUGFyZW50KSB7XG4gICAgICAgICAgICBvbGRQYXJlbnQuX3JlbW92ZVZpZXcobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRleHRCYXNlLl9hZGRWaWV3KG5ld1ZhbHVlKTtcbiAgICAgICAgbmV3VmFsdWUub24odmlld18xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGV4dEJhc2UuX29uRm9ybWF0dGVkVGV4dENvbnRlbnRzQ2hhbmdlZCwgdGV4dEJhc2UpO1xuICAgIH1cbn1cbnZhciB0ZXh0QWxpZ25tZW50Q29udmVydGVyID0gdmlld18xLm1ha2VQYXJzZXIodmlld18xLm1ha2VWYWxpZGF0b3IoXCJpbml0aWFsXCIsIFwibGVmdFwiLCBcImNlbnRlclwiLCBcInJpZ2h0XCIpKTtcbmV4cG9ydHMudGV4dEFsaWdubWVudFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGV4dEFsaWdubWVudFwiLCBjc3NOYW1lOiBcInRleHQtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBcImluaXRpYWxcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHRBbGlnbm1lbnRDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xudmFyIHRleHRUcmFuc2Zvcm1Db252ZXJ0ZXIgPSB2aWV3XzEubWFrZVBhcnNlcih2aWV3XzEubWFrZVZhbGlkYXRvcihcImluaXRpYWxcIiwgXCJub25lXCIsIFwiY2FwaXRhbGl6ZVwiLCBcInVwcGVyY2FzZVwiLCBcImxvd2VyY2FzZVwiKSk7XG5leHBvcnRzLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRleHRUcmFuc2Zvcm1cIiwgY3NzTmFtZTogXCJ0ZXh0LXRyYW5zZm9ybVwiLCBkZWZhdWx0VmFsdWU6IFwiaW5pdGlhbFwiLCB2YWx1ZUNvbnZlcnRlcjogdGV4dFRyYW5zZm9ybUNvbnZlcnRlciB9KTtcbmV4cG9ydHMudGV4dFRyYW5zZm9ybVByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG52YXIgd2hpdGVTcGFjZUNvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwiaW5pdGlhbFwiLCBcIm5vcm1hbFwiLCBcIm5vd3JhcFwiKSk7XG5leHBvcnRzLndoaXRlU3BhY2VQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIndoaXRlU3BhY2VcIiwgY3NzTmFtZTogXCJ3aGl0ZS1zcGFjZVwiLCBkZWZhdWx0VmFsdWU6IFwiaW5pdGlhbFwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiB3aGl0ZVNwYWNlQ29udmVydGVyIH0pO1xuZXhwb3J0cy53aGl0ZVNwYWNlUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbnZhciB0ZXh0RGVjb3JhdGlvbkNvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwibm9uZVwiLCBcInVuZGVybGluZVwiLCBcImxpbmUtdGhyb3VnaFwiLCBcInVuZGVybGluZSBsaW5lLXRocm91Z2hcIikpO1xuZXhwb3J0cy50ZXh0RGVjb3JhdGlvblByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGV4dERlY29yYXRpb25cIiwgY3NzTmFtZTogXCJ0ZXh0LWRlY29yYXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcIm5vbmVcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHREZWNvcmF0aW9uQ29udmVydGVyIH0pO1xuZXhwb3J0cy50ZXh0RGVjb3JhdGlvblByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmxldHRlclNwYWNpbmdQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImxldHRlclNwYWNpbmdcIiwgY3NzTmFtZTogXCJsZXR0ZXItc3BhY2luZ1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5sZXR0ZXJTcGFjaW5nUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMubGluZUhlaWdodFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibGluZUhlaWdodFwiLCBjc3NOYW1lOiBcImxpbmUtaGVpZ2h0XCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5saW5lSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMucmVzZXRTeW1ib2wgPSBTeW1ib2woXCJ0ZXh0UHJvcGVydHlEZWZhdWx0XCIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1iYXNlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZvbnRfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2ZvbnRcIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciB0ZXh0X2Jhc2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90ZXh0LWJhc2UtY29tbW9uXCIpO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90ZXh0LWJhc2UtY29tbW9uXCIpKTtcbnZhciBUZXh0VHJhbnNmb3JtYXRpb247XG5mdW5jdGlvbiBpbml0aWFsaXplVGV4dFRyYW5zZm9ybWF0aW9uKCkge1xuICAgIGlmIChUZXh0VHJhbnNmb3JtYXRpb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgVGV4dFRyYW5zZm9ybWF0aW9uSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhUZXh0VHJhbnNmb3JtYXRpb25JbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUZXh0VHJhbnNmb3JtYXRpb25JbXBsKHRleHRCYXNlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMudGV4dEJhc2UgPSB0ZXh0QmFzZTtcbiAgICAgICAgICAgIHJldHVybiBnbG9iYWwuX19uYXRpdmUoX3RoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFRleHRUcmFuc2Zvcm1hdGlvbkltcGwucHJvdG90eXBlLmdldFRyYW5zZm9ybWF0aW9uID0gZnVuY3Rpb24gKGNoYXJTZXEsIHZpZXcpIHtcbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRUZXh0ID0gdGhpcy50ZXh0QmFzZS5mb3JtYXR0ZWRUZXh0O1xuICAgICAgICAgICAgaWYgKGZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlU3Bhbm5hYmxlU3RyaW5nQnVpbGRlcihmb3JtYXR0ZWRUZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy50ZXh0QmFzZS50ZXh0O1xuICAgICAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9ICh0ZXh0ID09PSBudWxsIHx8IHRleHQgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdGV4dC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRUcmFuc2Zvcm1lZFRleHQoc3RyaW5nVmFsdWUsIHRoaXMudGV4dEJhc2UudGV4dFRyYW5zZm9ybSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRleHRUcmFuc2Zvcm1hdGlvbkltcGwucHJvdG90eXBlLm9uRm9jdXNDaGFuZ2VkID0gZnVuY3Rpb24gKHZpZXcsIHNvdXJjZVRleHQsIGZvY3VzZWQsIGRpcmVjdGlvbiwgcHJldmlvdXNseUZvY3VzZWRSZWN0KSB7XG4gICAgICAgIH07XG4gICAgICAgIFRleHRUcmFuc2Zvcm1hdGlvbkltcGwgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIEludGVyZmFjZXMoW2FuZHJvaWQudGV4dC5tZXRob2QuVHJhbnNmb3JtYXRpb25NZXRob2RdKVxuICAgICAgICBdLCBUZXh0VHJhbnNmb3JtYXRpb25JbXBsKTtcbiAgICAgICAgcmV0dXJuIFRleHRUcmFuc2Zvcm1hdGlvbkltcGw7XG4gICAgfShqYXZhLmxhbmcuT2JqZWN0KSk7XG4gICAgVGV4dFRyYW5zZm9ybWF0aW9uID0gVGV4dFRyYW5zZm9ybWF0aW9uSW1wbDtcbn1cbnZhciBUZXh0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRleHRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRleHRCYXNlLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpbml0aWFsaXplVGV4dFRyYW5zZm9ybWF0aW9uKCk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kID0gbmF0aXZlVmlldy5nZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCgpO1xuICAgICAgICB0aGlzLl9taW5IZWlnaHQgPSBuYXRpdmVWaWV3LmdldE1pbkhlaWdodCgpO1xuICAgICAgICB0aGlzLl9tYXhIZWlnaHQgPSBuYXRpdmVWaWV3LmdldE1heEhlaWdodCgpO1xuICAgICAgICB0aGlzLl9taW5MaW5lcyA9IG5hdGl2ZVZpZXcuZ2V0TWluTGluZXMoKTtcbiAgICAgICAgdGhpcy5fbWF4TGluZXMgPSBuYXRpdmVWaWV3LmdldE1heExpbmVzKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0U2luZ2xlTGluZSh0aGlzLl9pc1NpbmdsZUxpbmUpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFRyYW5zZm9ybWF0aW9uTWV0aG9kKHRoaXMuX2RlZmF1bHRUcmFuc2Zvcm1hdGlvbk1ldGhvZCk7XG4gICAgICAgIHRoaXMuX2RlZmF1bHRUcmFuc2Zvcm1hdGlvbk1ldGhvZCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLl9wYWludEZsYWdzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0UGFpbnRGbGFncyh0aGlzLl9wYWludEZsYWdzKTtcbiAgICAgICAgICAgIHRoaXMuX3BhaW50RmxhZ3MgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX21pbkxpbmVzICE9PSAtMSkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRNaW5MaW5lcyh0aGlzLl9taW5MaW5lcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldE1pbkhlaWdodCh0aGlzLl9taW5IZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21pbkhlaWdodCA9IHRoaXMuX21pbkxpbmVzID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodGhpcy5fbWF4TGluZXMgIT09IC0xKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LnNldE1heExpbmVzKHRoaXMuX21heExpbmVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TWF4SGVpZ2h0KHRoaXMuX21heEhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWF4SGVpZ2h0ID0gdGhpcy5fbWF4TGluZXMgPSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbDtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc2V0ID0gdmFsdWUgPT09IHRleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbDtcbiAgICAgICAgaWYgKCFyZXNldCAmJiB0aGlzLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXROYXRpdmVUZXh0KHJlc2V0KTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9ybWF0dGVkVGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIGFuZHJvaWQud2lkZ2V0LkJ1dHRvbiAmJlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuZ2V0VHJhbnNmb3JtYXRpb25NZXRob2QoKSBpbnN0YW5jZW9mIFRleHRUcmFuc2Zvcm1hdGlvbikge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QodGhpcy5fZGVmYXVsdFRyYW5zZm9ybWF0aW9uTWV0aG9kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZWN1cmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3Bhbm5hYmxlU3RyaW5nQnVpbGRlciA9IGNyZWF0ZVNwYW5uYWJsZVN0cmluZ0J1aWxkZXIodmFsdWUpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFRleHQoc3Bhbm5hYmxlU3RyaW5nQnVpbGRlcik7XG4gICAgICAgIHRleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2UodGhpcywgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpID8gXCJcIiA6IHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgICAgICBpZiAoc3Bhbm5hYmxlU3RyaW5nQnVpbGRlciAmJiBuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZC53aWRnZXQuQnV0dG9uICYmXG4gICAgICAgICAgICAhKG5hdGl2ZVZpZXcuZ2V0VHJhbnNmb3JtYXRpb25NZXRob2QoKSBpbnN0YW5jZW9mIFRleHRUcmFuc2Zvcm1hdGlvbikpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QobmV3IFRleHRUcmFuc2Zvcm1hdGlvbih0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBcImluaXRpYWxcIikge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUcmFuc2Zvcm1hdGlvbk1ldGhvZCh0aGlzLl9kZWZhdWx0VHJhbnNmb3JtYXRpb25NZXRob2QpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlY3VyZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VHJhbnNmb3JtYXRpb25NZXRob2QobmV3IFRleHRUcmFuc2Zvcm1hdGlvbih0aGlzKSk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiaW5pdGlhbFwiO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0QWxpZ25tZW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdmVydGljYWxHcmF2aXR5ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRHcmF2aXR5KCkgJiBhbmRyb2lkLnZpZXcuR3Jhdml0eS5WRVJUSUNBTF9HUkFWSVRZX01BU0s7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJpbml0aWFsXCI6XG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0R3Jhdml0eShhbmRyb2lkLnZpZXcuR3Jhdml0eS5TVEFSVCB8IHZlcnRpY2FsR3Jhdml0eSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRHcmF2aXR5KGFuZHJvaWQudmlldy5HcmF2aXR5LkNFTlRFUl9IT1JJWk9OVEFMIHwgdmVydGljYWxHcmF2aXR5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0R3Jhdml0eShhbmRyb2lkLnZpZXcuR3Jhdml0eS5FTkQgfCB2ZXJ0aWNhbEdyYXZpdHkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLndoaXRlU3BhY2VQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImluaXRpYWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFNpbmdsZUxpbmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0RWxsaXBzaXplKG51bGwpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm5vd3JhcFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0U2luZ2xlTGluZSh0cnVlKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldEVsbGlwc2l6ZShhbmRyb2lkLnRleHQuVGV4dFV0aWxzLlRydW5jYXRlQXQuRU5EKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRUZXh0Q29sb3JzKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuZm9ybWF0dGVkVGV4dCB8fCAhKHZhbHVlIGluc3RhbmNlb2YgdGV4dF9iYXNlX2NvbW1vbl8xLkNvbG9yKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgdGV4dF9iYXNlX2NvbW1vbl8xLkNvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUZXh0Q29sb3IodmFsdWUuYW5kcm9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFRleHRDb2xvcih2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgbmF0aXZlU2l6ZTogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5nZXRUZXh0U2l6ZSgpIH07XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmZvbnRTaXplUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuZm9ybWF0dGVkVGV4dCB8fCAodHlwZW9mIHZhbHVlICE9PSBcIm51bWJlclwiKSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VGV4dFNpemUodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUZXh0U2l6ZShhbmRyb2lkLnV0aWwuVHlwZWRWYWx1ZS5DT01QTEVYX1VOSVRfUFgsIHZhbHVlLm5hdGl2ZVNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxpbmVIZWlnaHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0TGluZVNwYWNpbmdFeHRyYSgpIC8gdGV4dF9iYXNlX2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5saW5lSGVpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldExpbmVTcGFjaW5nKHZhbHVlICogdGV4dF9iYXNlX2NvbW1vbl8xLmxheW91dC5nZXREaXNwbGF5RGVuc2l0eSgpLCAxKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmdldFR5cGVmYWNlKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmZvbnRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmZvcm1hdHRlZFRleHQgfHwgISh2YWx1ZSBpbnN0YW5jZW9mIGZvbnRfMS5Gb250KSkge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRUeXBlZmFjZSh2YWx1ZSBpbnN0YW5jZW9mIGZvbnRfMS5Gb250ID8gdmFsdWUuZ2V0QW5kcm9pZFR5cGVmYWNlKCkgOiB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFpbnRGbGFncyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZ2V0UGFpbnRGbGFncygpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcIm5vbmVcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFBhaW50RmxhZ3MoMCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidW5kZXJsaW5lXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRQYWludEZsYWdzKGFuZHJvaWQuZ3JhcGhpY3MuUGFpbnQuVU5ERVJMSU5FX1RFWFRfRkxBRyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibGluZS10aHJvdWdoXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRQYWludEZsYWdzKGFuZHJvaWQuZ3JhcGhpY3MuUGFpbnQuU1RSSUtFX1RIUlVfVEVYVF9GTEFHKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ1bmRlcmxpbmUgbGluZS10aHJvdWdoXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRQYWludEZsYWdzKGFuZHJvaWQuZ3JhcGhpY3MuUGFpbnQuVU5ERVJMSU5FX1RFWFRfRkxBRyB8IGFuZHJvaWQuZ3JhcGhpY3MuUGFpbnQuU1RSSUtFX1RIUlVfVEVYVF9GTEFHKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRQYWludEZsYWdzKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5sZXR0ZXJTcGFjaW5nUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5nZXRMZXR0ZXJzcGFjaW5nKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5sZXR0ZXJTcGFjaW5nUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRMZXR0ZXJzcGFjaW5nKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3AsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nVG9wKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQsIHRleHRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodCwgdW5pdDogXCJweFwiIH07XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ1JpZ2h0KHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQsIHRleHRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlclJpZ2h0V2lkdGgsIDApKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB2YWx1ZTogdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b20sIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5zZXRQYWRkaW5nQm90dG9tKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQsIHRleHRfYmFzZV9jb21tb25fMS5MZW5ndGgudG9EZXZpY2VQaXhlbHModmFsdWUsIDApICsgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IHZhbHVlOiB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQsIHVuaXQ6IFwicHhcIiB9O1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuc2V0UGFkZGluZ0xlZnQodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCwgdGV4dF9iYXNlX2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCkgKyB0ZXh0X2Jhc2VfY29tbW9uXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoLCAwKSk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGUuX3NldE5hdGl2ZVRleHQgPSBmdW5jdGlvbiAocmVzZXQpIHtcbiAgICAgICAgaWYgKHJlc2V0ID09PSB2b2lkIDApIHsgcmVzZXQgPSBmYWxzZTsgfVxuICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VGV4dChudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdHJhbnNmb3JtZWRUZXh0O1xuICAgICAgICBpZiAodGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0cmFuc2Zvcm1lZFRleHQgPSBjcmVhdGVTcGFubmFibGVTdHJpbmdCdWlsZGVyKHRoaXMuZm9ybWF0dGVkVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGV4dCA9IHRoaXMudGV4dDtcbiAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9ICh0ZXh0ID09PSBudWxsIHx8IHRleHQgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdGV4dC50b1N0cmluZygpO1xuICAgICAgICAgICAgdHJhbnNmb3JtZWRUZXh0ID0gZ2V0VHJhbnNmb3JtZWRUZXh0KHN0cmluZ1ZhbHVlLCB0aGlzLnRleHRUcmFuc2Zvcm0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VGV4dCh0cmFuc2Zvcm1lZFRleHQpO1xuICAgIH07XG4gICAgcmV0dXJuIFRleHRCYXNlO1xufSh0ZXh0X2Jhc2VfY29tbW9uXzEuVGV4dEJhc2VDb21tb24pKTtcbmV4cG9ydHMuVGV4dEJhc2UgPSBUZXh0QmFzZTtcbmZ1bmN0aW9uIGdldENhcGl0YWxpemVkU3RyaW5nKHN0cikge1xuICAgIHZhciB3b3JkcyA9IHN0ci5zcGxpdChcIiBcIik7XG4gICAgdmFyIG5ld1dvcmRzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gd29yZHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICB2YXIgd29yZCA9IHdvcmRzW2ldLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIG5ld1dvcmRzLnB1c2god29yZC5zdWJzdHIoMCwgMSkudG9VcHBlckNhc2UoKSArIHdvcmQuc3Vic3RyaW5nKDEpKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1dvcmRzLmpvaW4oXCIgXCIpO1xufVxuZnVuY3Rpb24gZ2V0VHJhbnNmb3JtZWRUZXh0KHRleHQsIHRleHRUcmFuc2Zvcm0pIHtcbiAgICBpZiAoIXRleHQgfHwgIXR5cGVzXzEuaXNTdHJpbmcodGV4dCkpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICAgIHN3aXRjaCAodGV4dFRyYW5zZm9ybSkge1xuICAgICAgICBjYXNlIFwidXBwZXJjYXNlXCI6XG4gICAgICAgICAgICByZXR1cm4gdGV4dC50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBjYXNlIFwibG93ZXJjYXNlXCI6XG4gICAgICAgICAgICByZXR1cm4gdGV4dC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBjYXNlIFwiY2FwaXRhbGl6ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGdldENhcGl0YWxpemVkU3RyaW5nKHRleHQpO1xuICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxufVxuZXhwb3J0cy5nZXRUcmFuc2Zvcm1lZFRleHQgPSBnZXRUcmFuc2Zvcm1lZFRleHQ7XG5mdW5jdGlvbiBjcmVhdGVTcGFubmFibGVTdHJpbmdCdWlsZGVyKGZvcm1hdHRlZFN0cmluZykge1xuICAgIGlmICghZm9ybWF0dGVkU3RyaW5nIHx8ICFmb3JtYXR0ZWRTdHJpbmcucGFyZW50KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgc3NiID0gbmV3IGFuZHJvaWQudGV4dC5TcGFubmFibGVTdHJpbmdCdWlsZGVyKCk7XG4gICAgZm9yICh2YXIgaSA9IDAsIHNwYW5TdGFydCA9IDAsIHNwYW5MZW5ndGggPSAwLCBsZW5ndGhfMiA9IGZvcm1hdHRlZFN0cmluZy5zcGFucy5sZW5ndGg7IGkgPCBsZW5ndGhfMjsgaSsrKSB7XG4gICAgICAgIHZhciBzcGFuID0gZm9ybWF0dGVkU3RyaW5nLnNwYW5zLmdldEl0ZW0oaSk7XG4gICAgICAgIHZhciB0ZXh0ID0gc3Bhbi50ZXh0O1xuICAgICAgICB2YXIgdGV4dFRyYW5zZm9ybSA9IGZvcm1hdHRlZFN0cmluZy5wYXJlbnQudGV4dFRyYW5zZm9ybTtcbiAgICAgICAgdmFyIHNwYW5UZXh0ID0gKHRleHQgPT09IG51bGwgfHwgdGV4dCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0ZXh0LnRvU3RyaW5nKCk7XG4gICAgICAgIGlmICh0ZXh0VHJhbnNmb3JtICYmIHRleHRUcmFuc2Zvcm0gIT09IFwibm9uZVwiKSB7XG4gICAgICAgICAgICBzcGFuVGV4dCA9IGdldFRyYW5zZm9ybWVkVGV4dChzcGFuVGV4dCwgdGV4dFRyYW5zZm9ybSk7XG4gICAgICAgIH1cbiAgICAgICAgc3Bhbkxlbmd0aCA9IHNwYW5UZXh0Lmxlbmd0aDtcbiAgICAgICAgaWYgKHNwYW5MZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBzc2IuaW5zZXJ0KHNwYW5TdGFydCwgc3BhblRleHQpO1xuICAgICAgICAgICAgc2V0U3Bhbk1vZGlmaWVycyhzc2IsIHNwYW4sIHNwYW5TdGFydCwgc3BhblN0YXJ0ICsgc3Bhbkxlbmd0aCk7XG4gICAgICAgICAgICBzcGFuU3RhcnQgKz0gc3Bhbkxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3NiO1xufVxuZnVuY3Rpb24gc2V0U3Bhbk1vZGlmaWVycyhzc2IsIHNwYW4sIHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgc3BhblN0eWxlID0gc3Bhbi5zdHlsZTtcbiAgICB2YXIgYm9sZCA9IHRleHRfYmFzZV9jb21tb25fMS5pc0JvbGQoc3BhblN0eWxlLmZvbnRXZWlnaHQpO1xuICAgIHZhciBpdGFsaWMgPSBzcGFuU3R5bGUuZm9udFN0eWxlID09PSBcIml0YWxpY1wiO1xuICAgIGlmIChib2xkICYmIGl0YWxpYykge1xuICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLlN0eWxlU3BhbihhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLkJPTERfSVRBTElDKSwgc3RhcnQsIGVuZCwgYW5kcm9pZC50ZXh0LlNwYW5uZWQuU1BBTl9FWENMVVNJVkVfRVhDTFVTSVZFKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYm9sZCkge1xuICAgICAgICBzc2Iuc2V0U3BhbihuZXcgYW5kcm9pZC50ZXh0LnN0eWxlLlN0eWxlU3BhbihhbmRyb2lkLmdyYXBoaWNzLlR5cGVmYWNlLkJPTEQpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpdGFsaWMpIHtcbiAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5TdHlsZVNwYW4oYW5kcm9pZC5ncmFwaGljcy5UeXBlZmFjZS5JVEFMSUMpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgIH1cbiAgICB2YXIgZm9udEZhbWlseSA9IHNwYW4uZm9udEZhbWlseTtcbiAgICBpZiAoZm9udEZhbWlseSkge1xuICAgICAgICB2YXIgZm9udCA9IG5ldyBmb250XzEuRm9udChmb250RmFtaWx5LCAwLCAoaXRhbGljKSA/IFwiaXRhbGljXCIgOiBcIm5vcm1hbFwiLCAoYm9sZCkgPyBcImJvbGRcIiA6IFwibm9ybWFsXCIpO1xuICAgICAgICB2YXIgdHlwZWZhY2UgPSBmb250LmdldEFuZHJvaWRUeXBlZmFjZSgpIHx8IGFuZHJvaWQuZ3JhcGhpY3MuVHlwZWZhY2UuY3JlYXRlKGZvbnRGYW1pbHksIDApO1xuICAgICAgICB2YXIgdHlwZWZhY2VTcGFuID0gbmV3IG9yZy5uYXRpdmVzY3JpcHQud2lkZ2V0cy5DdXN0b21UeXBlZmFjZVNwYW4oZm9udEZhbWlseSwgdHlwZWZhY2UpO1xuICAgICAgICBzc2Iuc2V0U3Bhbih0eXBlZmFjZVNwYW4sIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgfVxuICAgIHZhciByZWFsRm9udFNpemUgPSBzcGFuLmZvbnRTaXplO1xuICAgIGlmIChyZWFsRm9udFNpemUpIHtcbiAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5BYnNvbHV0ZVNpemVTcGFuKHJlYWxGb250U2l6ZSAqIHRleHRfYmFzZV9jb21tb25fMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKSksIHN0YXJ0LCBlbmQsIGFuZHJvaWQudGV4dC5TcGFubmVkLlNQQU5fRVhDTFVTSVZFX0VYQ0xVU0lWRSk7XG4gICAgfVxuICAgIHZhciBjb2xvciA9IHNwYW4uY29sb3I7XG4gICAgaWYgKGNvbG9yKSB7XG4gICAgICAgIHNzYi5zZXRTcGFuKG5ldyBhbmRyb2lkLnRleHQuc3R5bGUuRm9yZWdyb3VuZENvbG9yU3Bhbihjb2xvci5hbmRyb2lkKSwgc3RhcnQsIGVuZCwgYW5kcm9pZC50ZXh0LlNwYW5uZWQuU1BBTl9FWENMVVNJVkVfRVhDTFVTSVZFKTtcbiAgICB9XG4gICAgdmFyIGJhY2tncm91bmRDb2xvcjtcbiAgICBpZiAoc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmlzU2V0KHNwYW5TdHlsZSkpIHtcbiAgICAgICAgYmFja2dyb3VuZENvbG9yID0gc3BhblN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICB9XG4gICAgZWxzZSBpZiAoc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmlzU2V0KHNwYW4ucGFyZW50LnN0eWxlKSkge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3IgPSBzcGFuLnBhcmVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgfVxuICAgIGVsc2UgaWYgKHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5pc1NldChzcGFuLnBhcmVudC5wYXJlbnQuc3R5bGUpKSB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvciA9IHNwYW4ucGFyZW50LnBhcmVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgfVxuICAgIGlmIChiYWNrZ3JvdW5kQ29sb3IpIHtcbiAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5CYWNrZ3JvdW5kQ29sb3JTcGFuKGJhY2tncm91bmRDb2xvci5hbmRyb2lkKSwgc3RhcnQsIGVuZCwgYW5kcm9pZC50ZXh0LlNwYW5uZWQuU1BBTl9FWENMVVNJVkVfRVhDTFVTSVZFKTtcbiAgICB9XG4gICAgdmFyIHZhbHVlU291cmNlO1xuICAgIGlmICh0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5pc1NldChzcGFuU3R5bGUpKSB7XG4gICAgICAgIHZhbHVlU291cmNlID0gc3BhblN0eWxlO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5pc1NldChzcGFuLnBhcmVudC5zdHlsZSkpIHtcbiAgICAgICAgdmFsdWVTb3VyY2UgPSBzcGFuLnBhcmVudC5zdHlsZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodGV4dF9iYXNlX2NvbW1vbl8xLnRleHREZWNvcmF0aW9uUHJvcGVydHkuaXNTZXQoc3Bhbi5wYXJlbnQucGFyZW50LnN0eWxlKSkge1xuICAgICAgICB2YWx1ZVNvdXJjZSA9IHNwYW4ucGFyZW50LnBhcmVudC5zdHlsZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlU291cmNlKSB7XG4gICAgICAgIHZhciB0ZXh0RGVjb3JhdGlvbnMgPSB2YWx1ZVNvdXJjZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgdmFyIHVuZGVybGluZV8xID0gdGV4dERlY29yYXRpb25zLmluZGV4T2YoXCJ1bmRlcmxpbmVcIikgIT09IC0xO1xuICAgICAgICBpZiAodW5kZXJsaW5lXzEpIHtcbiAgICAgICAgICAgIHNzYi5zZXRTcGFuKG5ldyBhbmRyb2lkLnRleHQuc3R5bGUuVW5kZXJsaW5lU3BhbigpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdHJpa2V0aHJvdWdoID0gdGV4dERlY29yYXRpb25zLmluZGV4T2YoXCJsaW5lLXRocm91Z2hcIikgIT09IC0xO1xuICAgICAgICBpZiAoc3RyaWtldGhyb3VnaCkge1xuICAgICAgICAgICAgc3NiLnNldFNwYW4obmV3IGFuZHJvaWQudGV4dC5zdHlsZS5TdHJpa2V0aHJvdWdoU3BhbigpLCBzdGFydCwgZW5kLCBhbmRyb2lkLnRleHQuU3Bhbm5lZC5TUEFOX0VYQ0xVU0lWRV9FWENMVVNJVkUpO1xuICAgICAgICB9XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1iYXNlLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlZGl0YWJsZV90ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9lZGl0YWJsZS10ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vZWRpdGFibGUtdGV4dC1iYXNlXCIpKTtcbnZhciBUZXh0RmllbGRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEZpZWxkQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUZXh0RmllbGRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRleHRGaWVsZEJhc2UucmV0dXJuUHJlc3NFdmVudCA9IFwicmV0dXJuUHJlc3NcIjtcbiAgICBUZXh0RmllbGRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV8xLkNTU1R5cGUoXCJUZXh0RmllbGRcIilcbiAgICBdLCBUZXh0RmllbGRCYXNlKTtcbiAgICByZXR1cm4gVGV4dEZpZWxkQmFzZTtcbn0oZWRpdGFibGVfdGV4dF9iYXNlXzEuRWRpdGFibGVUZXh0QmFzZSkpO1xuZXhwb3J0cy5UZXh0RmllbGRCYXNlID0gVGV4dEZpZWxkQmFzZTtcblRleHRGaWVsZEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLnNlY3VyZVByb3BlcnR5ID0gbmV3IGVkaXRhYmxlX3RleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJzZWN1cmVcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IGVkaXRhYmxlX3RleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLnNlY3VyZVByb3BlcnR5LnJlZ2lzdGVyKFRleHRGaWVsZEJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1maWVsZC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0ZXh0X2ZpZWxkX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGV4dC1maWVsZC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90ZXh0LWZpZWxkLWNvbW1vblwiKSk7XG52YXIgVGV4dEZpZWxkID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEZpZWxkLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRGaWVsZCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUZXh0RmllbGQucHJvdG90eXBlLl9jb25maWd1cmVFZGl0VGV4dCA9IGZ1bmN0aW9uIChlZGl0VGV4dCkge1xuICAgICAgICBlZGl0VGV4dC5zZXRJbnB1dFR5cGUoYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fTk9STUFMIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfU0VOVEVOQ0VTIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19OT19TVUdHRVNUSU9OUyk7XG4gICAgICAgIGVkaXRUZXh0LnNldExpbmVzKDEpO1xuICAgICAgICBlZGl0VGV4dC5zZXRNYXhMaW5lcygxKTtcbiAgICAgICAgZWRpdFRleHQuc2V0SG9yaXpvbnRhbGx5U2Nyb2xsaW5nKHRydWUpO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZS5fb25SZXR1cm5QcmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IFRleHRGaWVsZC5yZXR1cm5QcmVzc0V2ZW50LCBvYmplY3Q6IHRoaXMgfSk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuc2VjdXJlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXRTZWN1cmVBbmRLZXlib2FyZFR5cGUoKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5rZXlib2FyZFR5cGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNldFNlY3VyZUFuZEtleWJvYXJkVHlwZSgpO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZS5zZXRTZWN1cmVBbmRLZXlib2FyZFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnB1dFR5cGU7XG4gICAgICAgIGlmICh0aGlzLnNlY3VyZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMua2V5Ym9hcmRUeXBlID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX05VTUJFUiB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9OVU1CRVJfVkFSSUFUSU9OX1BBU1NXT1JEO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fUEFTU1dPUkQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbnB1dFR5cGUgPSBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfQ0xBU1NfVEVYVCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX1ZBUklBVElPTl9OT1JNQUw7XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvY29ycmVjdCkge1xuICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQVVUT19DT01QTEVURTtcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9GTEFHX0FVVE9fQ09SUkVDVDtcbiAgICAgICAgICAgICAgICBpbnB1dFR5cGUgPSBpbnB1dFR5cGUgJiB+YW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19OT19TVUdHRVNUSU9OUztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5hdXRvY2FwaXRhbGl6YXRpb25UeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIndvcmRzXCI6XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1dPUkRTO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwic2VudGVuY2VzXCI6XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGlucHV0VHlwZSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1NFTlRFTkNFUztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImFsbGNoYXJhY3RlcnNcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gaW5wdXRUeXBlIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfRkxBR19DQVBfQ0hBUkFDVEVSUztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMua2V5Ym9hcmRUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImRhdGV0aW1lXCI6XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19EQVRFVElNRSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9EQVRFVElNRV9WQVJJQVRJT05fTk9STUFMO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicGhvbmVcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1BIT05FO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VHlwZSA9IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19OVU1CRVIgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfTlVNQkVSX1ZBUklBVElPTl9OT1JNQUwgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfTlVNQkVSX0ZMQUdfU0lHTkVEIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX05VTUJFUl9GTEFHX0RFQ0lNQUw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ1cmxcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fVVJJO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW1haWxcIjpcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX0NMQVNTX1RFWFQgfCBhbmRyb2lkLnRleHQuSW5wdXRUeXBlLlRZUEVfVEVYVF9WQVJJQVRJT05fRU1BSUxfQUREUkVTUztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0SW5wdXRUeXBlKGlucHV0VHlwZSk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEud2hpdGVTcGFjZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJub3dyYXBcIjtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS53aGl0ZVNwYWNlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgcmV0dXJuIFRleHRGaWVsZDtcbn0odGV4dF9maWVsZF9jb21tb25fMS5UZXh0RmllbGRCYXNlKSk7XG5leHBvcnRzLlRleHRGaWVsZCA9IFRleHRGaWVsZDtcblRleHRGaWVsZC5wcm90b3R5cGUuX2lzU2luZ2xlTGluZSA9IHRydWU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWZpZWxkLmFuZHJvaWQuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlZGl0YWJsZV90ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9lZGl0YWJsZS10ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBUZXh0VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRleHRWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRleHRWaWV3LnByb3RvdHlwZS5fY29uZmlndXJlRWRpdFRleHQgPSBmdW5jdGlvbiAoZWRpdFRleHQpIHtcbiAgICAgICAgZWRpdFRleHQuc2V0SW5wdXRUeXBlKGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9DTEFTU19URVhUIHwgYW5kcm9pZC50ZXh0LklucHV0VHlwZS5UWVBFX1RFWFRfVkFSSUFUSU9OX05PUk1BTCB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfQ0FQX1NFTlRFTkNFUyB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfTVVMVElfTElORSB8IGFuZHJvaWQudGV4dC5JbnB1dFR5cGUuVFlQRV9URVhUX0ZMQUdfTk9fU1VHR0VTVElPTlMpO1xuICAgICAgICBlZGl0VGV4dC5zZXRHcmF2aXR5KGFuZHJvaWQudmlldy5HcmF2aXR5LlRPUCB8IGFuZHJvaWQudmlldy5HcmF2aXR5LlNUQVJUKTtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0R3Jhdml0eShhbmRyb2lkLnZpZXcuR3Jhdml0eS5UT1AgfCBhbmRyb2lkLnZpZXcuR3Jhdml0eS5TVEFSVCk7XG4gICAgfTtcbiAgICBUZXh0VmlldyA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5DU1NUeXBlKFwiVGV4dFZpZXdcIilcbiAgICBdLCBUZXh0Vmlldyk7XG4gICAgcmV0dXJuIFRleHRWaWV3O1xufShlZGl0YWJsZV90ZXh0X2Jhc2VfMS5FZGl0YWJsZVRleHRCYXNlKSk7XG5leHBvcnRzLlRleHRWaWV3ID0gVGV4dFZpZXc7XG5UZXh0Vmlldy5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRleHQtdmlldy5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIGRhdGVDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA8PSB5ICYmIHggPj0geSk7IH07XG5mdW5jdGlvbiBnZXRWYWxpZFRpbWUocGlja2VyLCBob3VyLCBtaW51dGUpIHtcbiAgICBpZiAocGlja2VyLm1pbnV0ZUludGVydmFsID4gMSkge1xuICAgICAgICB2YXIgbWludXRlRmxvb3IgPSBtaW51dGUgLSAobWludXRlICUgcGlja2VyLm1pbnV0ZUludGVydmFsKTtcbiAgICAgICAgbWludXRlID0gbWludXRlRmxvb3IgKyAobWludXRlID09PSBtaW51dGVGbG9vciArIDEgPyBwaWNrZXIubWludXRlSW50ZXJ2YWwgOiAwKTtcbiAgICAgICAgaWYgKG1pbnV0ZSA9PT0gNjApIHtcbiAgICAgICAgICAgIGhvdXIrKztcbiAgICAgICAgICAgIG1pbnV0ZSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHRpbWUgPSB7IGhvdXI6IGhvdXIsIG1pbnV0ZTogbWludXRlIH07XG4gICAgaWYgKCFpc0xlc3NUaGFuTWF4VGltZShwaWNrZXIsIGhvdXIsIG1pbnV0ZSkpIHtcbiAgICAgICAgdGltZSA9IHsgaG91cjogcGlja2VyLm1heEhvdXIsIG1pbnV0ZTogcGlja2VyLm1heE1pbnV0ZSB9O1xuICAgIH1cbiAgICBpZiAoIWlzR3JlYXRlclRoYW5NaW5UaW1lKHBpY2tlciwgaG91ciwgbWludXRlKSkge1xuICAgICAgICB0aW1lID0geyBob3VyOiBwaWNrZXIubWluSG91ciwgbWludXRlOiBwaWNrZXIubWluTWludXRlIH07XG4gICAgfVxuICAgIHJldHVybiB0aW1lO1xufVxuZXhwb3J0cy5nZXRWYWxpZFRpbWUgPSBnZXRWYWxpZFRpbWU7XG5mdW5jdGlvbiBpc1ZhbGlkVGltZShwaWNrZXIpIHtcbiAgICByZXR1cm4gaXNHcmVhdGVyVGhhbk1pblRpbWUocGlja2VyKSAmJiBpc0xlc3NUaGFuTWF4VGltZShwaWNrZXIpO1xufVxuZnVuY3Rpb24gaXNIb3VyVmFsaWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiICYmIHZhbHVlID49IDAgJiYgdmFsdWUgPD0gMjM7XG59XG5mdW5jdGlvbiBpc01pbnV0ZVZhbGlkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiB2YWx1ZSA+PSAwICYmIHZhbHVlIDw9IDU5O1xufVxuZnVuY3Rpb24gaXNNaW51dGVJbnRlcnZhbFZhbGlkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiB2YWx1ZSA+PSAxICYmIHZhbHVlIDw9IDMwICYmIDYwICUgdmFsdWUgPT09IDA7XG59XG5mdW5jdGlvbiBnZXRNaW51dGVzKGhvdXIpIHtcbiAgICByZXR1cm4gaG91ciAqIDYwO1xufVxuZnVuY3Rpb24gaXNEZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQ7XG59XG5leHBvcnRzLmlzRGVmaW5lZCA9IGlzRGVmaW5lZDtcbmZ1bmN0aW9uIGlzR3JlYXRlclRoYW5NaW5UaW1lKHBpY2tlciwgaG91ciwgbWludXRlKSB7XG4gICAgaWYgKHBpY2tlci5taW5Ib3VyID09PSB1bmRlZmluZWQgfHwgcGlja2VyLm1pbk1pbnV0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZ2V0TWludXRlcyhob3VyICE9PSB1bmRlZmluZWQgPyBob3VyIDogcGlja2VyLmhvdXIpICsgKG1pbnV0ZSAhPT0gdW5kZWZpbmVkID8gbWludXRlIDogcGlja2VyLm1pbnV0ZSkgPj0gZ2V0TWludXRlcyhwaWNrZXIubWluSG91cikgKyBwaWNrZXIubWluTWludXRlO1xufVxuZnVuY3Rpb24gaXNMZXNzVGhhbk1heFRpbWUocGlja2VyLCBob3VyLCBtaW51dGUpIHtcbiAgICBpZiAoIWlzRGVmaW5lZChwaWNrZXIubWF4SG91cikgfHwgIWlzRGVmaW5lZChwaWNrZXIubWF4TWludXRlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGdldE1pbnV0ZXMoaXNEZWZpbmVkKGhvdXIpID8gaG91ciA6IHBpY2tlci5ob3VyKSArIChpc0RlZmluZWQobWludXRlKSA/IG1pbnV0ZSA6IHBpY2tlci5taW51dGUpIDw9IGdldE1pbnV0ZXMocGlja2VyLm1heEhvdXIpICsgcGlja2VyLm1heE1pbnV0ZTtcbn1cbmZ1bmN0aW9uIHRvU3RyaW5nKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgKyBcIlwiO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWUgPCAxMCA/IFwiMFwiICsgdmFsdWUgOiBcIlwiICsgdmFsdWU7XG59XG5mdW5jdGlvbiBnZXRNaW5NYXhUaW1lRXJyb3JNZXNzYWdlKHBpY2tlcikge1xuICAgIHJldHVybiBcIk1pbiB0aW1lOiAoXCIgKyB0b1N0cmluZyhwaWNrZXIubWluSG91cikgKyBcIjpcIiArIHRvU3RyaW5nKHBpY2tlci5taW5NaW51dGUpICsgXCIpLCBtYXggdGltZTogKFwiICsgdG9TdHJpbmcocGlja2VyLm1heEhvdXIpICsgXCI6XCIgKyB0b1N0cmluZyhwaWNrZXIubWF4TWludXRlKSArIFwiKVwiO1xufVxuZnVuY3Rpb24gZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgcHJvcGVydHlOYW1lLCBuZXdWYWx1ZSkge1xuICAgIHJldHVybiBwcm9wZXJ0eU5hbWUgKyBcIiBwcm9wZXJ0eSB2YWx1ZSAoXCIgKyB0b1N0cmluZyhuZXdWYWx1ZSkgKyBcIjpcIiArIHRvU3RyaW5nKHBpY2tlci5taW51dGUpICsgXCIpIGlzIG5vdCB2YWxpZC4gXCIgKyBnZXRNaW5NYXhUaW1lRXJyb3JNZXNzYWdlKHBpY2tlcikgKyBcIi5cIjtcbn1cbnZhciBUaW1lUGlja2VyQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRpbWVQaWNrZXJCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRpbWVQaWNrZXJCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRpbWVQaWNrZXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGltZVBpY2tlclwiKVxuICAgIF0sIFRpbWVQaWNrZXJCYXNlKTtcbiAgICByZXR1cm4gVGltZVBpY2tlckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRpbWVQaWNrZXJCYXNlID0gVGltZVBpY2tlckJhc2U7XG5UaW1lUGlja2VyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMubWluSG91clByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW5Ib3VyXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0hvdXJWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1pbkhvdXJcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5taW5Ib3VyUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tYXhIb3VyUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heEhvdXJcIiwgZGVmYXVsdFZhbHVlOiAyMywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0hvdXJWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1heEhvdXJcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5tYXhIb3VyUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5taW5NaW51dGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluTWludXRlXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc01pbnV0ZVZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWluTWludXRlXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWluTWludXRlUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tYXhNaW51dGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWF4TWludXRlXCIsIGRlZmF1bHRWYWx1ZTogNTksIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNNaW51dGVWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1heE1pbnV0ZVwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1heE1pbnV0ZVByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMubWludXRlSW50ZXJ2YWxQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWludXRlSW50ZXJ2YWxcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzTWludXRlSW50ZXJ2YWxWYWxpZChuZXdWYWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1pbnV0ZUludGVydmFsXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWludXRlSW50ZXJ2YWxQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLm1pbnV0ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW51dGVcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzTWludXRlVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtaW51dGVcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBwaWNrZXIudGltZSA9IG5ldyBEYXRlKDAsIDAsIDAsIHBpY2tlci5ob3VyLCBwaWNrZXIubWludXRlKTtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWludXRlUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5ob3VyUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImhvdXJcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzSG91clZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwiSG91clwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHBpY2tlci50aW1lID0gbmV3IERhdGUoMCwgMCwgMCwgcGlja2VyLmhvdXIsIHBpY2tlci5taW51dGUpO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5ob3VyUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy50aW1lUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRpbWVcIiwgZGVmYXVsdFZhbHVlOiBuZXcgRGF0ZSgpLCBlcXVhbGl0eUNvbXBhcmVyOiBkYXRlQ29tcGFyZXIsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJ0aW1lXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcGlja2VyLmhvdXIgPSBuZXdWYWx1ZS5nZXRIb3VycygpO1xuICAgICAgICBwaWNrZXIubWludXRlID0gbmV3VmFsdWUuZ2V0TWludXRlcygpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy50aW1lUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGltZS1waWNrZXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGltZV9waWNrZXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90aW1lLXBpY2tlci1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90aW1lLXBpY2tlci1jb21tb25cIikpO1xudmFyIFRpbWVDaGFuZ2VkTGlzdGVuZXI7XG5mdW5jdGlvbiBpbml0aWFsaXplVGltZUNoYW5nZWRMaXN0ZW5lcigpIHtcbiAgICBpZiAoVGltZUNoYW5nZWRMaXN0ZW5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGFwaUxldmVsID0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OLlNES19JTlQ7XG4gICAgdmFyIFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFRpbWVDaGFuZ2VkTGlzdGVuZXJJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbC5wcm90b3R5cGUub25UaW1lQ2hhbmdlZCA9IGZ1bmN0aW9uIChwaWNrZXIsIGhvdXIsIG1pbnV0ZSkge1xuICAgICAgICAgICAgdmFyIHRpbWVQaWNrZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKHRpbWVQaWNrZXIudXBkYXRpbmdOYXRpdmVWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWxpZFRpbWUgPSB0aW1lX3BpY2tlcl9jb21tb25fMS5nZXRWYWxpZFRpbWUodGltZVBpY2tlciwgaG91ciwgbWludXRlKTtcbiAgICAgICAgICAgIHRpbWVfcGlja2VyX2NvbW1vbl8xLnRpbWVQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZSh0aW1lUGlja2VyLCBuZXcgRGF0ZSgwLCAwLCAwLCB2YWxpZFRpbWUuaG91ciwgdmFsaWRUaW1lLm1pbnV0ZSkpO1xuICAgICAgICB9O1xuICAgICAgICBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgSW50ZXJmYWNlcyhbYW5kcm9pZC53aWRnZXQuVGltZVBpY2tlci5PblRpbWVDaGFuZ2VkTGlzdGVuZXJdKVxuICAgICAgICBdLCBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbCk7XG4gICAgICAgIHJldHVybiBUaW1lQ2hhbmdlZExpc3RlbmVySW1wbDtcbiAgICB9KGphdmEubGFuZy5PYmplY3QpKTtcbiAgICBUaW1lQ2hhbmdlZExpc3RlbmVyID0gVGltZUNoYW5nZWRMaXN0ZW5lckltcGw7XG59XG52YXIgYXBpTGV2ZWw7XG52YXIgVGltZVBpY2tlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRpbWVQaWNrZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGltZVBpY2tlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuZHJvaWQud2lkZ2V0LlRpbWVQaWNrZXIodGhpcy5fY29udGV4dCk7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaW5pdGlhbGl6ZVRpbWVDaGFuZ2VkTGlzdGVuZXIoKTtcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmV3IFRpbWVDaGFuZ2VkTGlzdGVuZXIodGhpcyk7XG4gICAgICAgIG5hdGl2ZVZpZXcuc2V0T25UaW1lQ2hhbmdlZExpc3RlbmVyKGxpc3RlbmVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgICAgICB2YXIgY2FsZW5kYXIgPSBuYXRpdmVWaWV3LmNhbGVuZGFyID0gamF2YS51dGlsLkNhbGVuZGFyLmdldEluc3RhbmNlKCk7XG4gICAgICAgIHZhciBob3VyID0gdGltZV9waWNrZXJfY29tbW9uXzEuaG91clByb3BlcnR5LmlzU2V0KHRoaXMpID8gdGhpcy5ob3VyIDogY2FsZW5kYXIuZ2V0KGphdmEudXRpbC5DYWxlbmRhci5IT1VSX09GX0RBWSk7XG4gICAgICAgIHZhciBtaW51dGUgPSB0aW1lX3BpY2tlcl9jb21tb25fMS5taW51dGVQcm9wZXJ0eS5pc1NldCh0aGlzKSA/IHRoaXMubWludXRlIDogY2FsZW5kYXIuZ2V0KGphdmEudXRpbC5DYWxlbmRhci5NSU5VVEUpO1xuICAgICAgICB2YXIgdmFsaWRUaW1lID0gdGltZV9waWNrZXJfY29tbW9uXzEuZ2V0VmFsaWRUaW1lKHRoaXMsIGhvdXIsIG1pbnV0ZSk7XG4gICAgICAgIGlmICghdGltZV9waWNrZXJfY29tbW9uXzEudGltZVByb3BlcnR5LmlzU2V0KHRoaXMpKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWUgPSBuZXcgRGF0ZSgwLCAwLCAwLCB2YWxpZFRpbWUuaG91ciwgdmFsaWRUaW1lLm1pbnV0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1pbnV0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGluZ05hdGl2ZVZhbHVlID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChhcGlMZXZlbCA+PSAyMykge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRNaW51dGUodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldEN1cnJlbnRNaW51dGUobmV3IGphdmEubGFuZy5JbnRlZ2VyKHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0aW5nTmF0aXZlVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEuaG91clByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGluZ05hdGl2ZVZhbHVlID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChhcGlMZXZlbCA+PSAyMykge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRIb3VyKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRDdXJyZW50SG91cihuZXcgamF2YS5sYW5nLkludGVnZXIodmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRpbmdOYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gVGltZVBpY2tlcjtcbn0odGltZV9waWNrZXJfY29tbW9uXzEuVGltZVBpY2tlckJhc2UpKTtcbmV4cG9ydHMuVGltZVBpY2tlciA9IFRpbWVQaWNrZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lLXBpY2tlci5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi90cmFuc2l0aW9uXCIpO1xudmFyIEZhZGVUcmFuc2l0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRmFkZVRyYW5zaXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmFkZVRyYW5zaXRpb24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRmFkZVRyYW5zaXRpb24ucHJvdG90eXBlLmNyZWF0ZUFuZHJvaWRBbmltYXRvciA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICB2YXIgYWxwaGFWYWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgc3dpdGNoICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyOlxuICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEVudGVyOlxuICAgICAgICAgICAgICAgIGFscGhhVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICBhbHBoYVZhbHVlc1sxXSA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDpcbiAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbl8xLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0OlxuICAgICAgICAgICAgICAgIGFscGhhVmFsdWVzWzBdID0gMTtcbiAgICAgICAgICAgICAgICBhbHBoYVZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcImFscGhhXCIsIGFscGhhVmFsdWVzKTtcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5nZXREdXJhdGlvbigpO1xuICAgICAgICBpZiAoZHVyYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oZHVyYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdG9yLnNldEludGVycG9sYXRvcih0aGlzLmdldEN1cnZlKCkpO1xuICAgICAgICByZXR1cm4gYW5pbWF0b3I7XG4gICAgfTtcbiAgICByZXR1cm4gRmFkZVRyYW5zaXRpb247XG59KHRyYW5zaXRpb25fMS5UcmFuc2l0aW9uKSk7XG5leHBvcnRzLkZhZGVUcmFuc2l0aW9uID0gRmFkZVRyYW5zaXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mYWRlLXRyYW5zaXRpb24uYW5kcm9pZC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHJhbnNpdGlvbl8xID0gcmVxdWlyZShcIi4vdHJhbnNpdGlvblwiKTtcbnZhciBGbGlwVHJhbnNpdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZsaXBUcmFuc2l0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZsaXBUcmFuc2l0aW9uKGRpcmVjdGlvbiwgZHVyYXRpb24sIGN1cnZlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGR1cmF0aW9uLCBjdXJ2ZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2RpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGbGlwVHJhbnNpdGlvbi5wcm90b3R5cGUuY3JlYXRlQW5kcm9pZEFuaW1hdG9yID0gZnVuY3Rpb24gKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBvYmplY3RBbmltYXRvcnM7XG4gICAgICAgIHZhciB2YWx1ZXM7XG4gICAgICAgIHZhciBhbmltYXRvcjtcbiAgICAgICAgdmFyIGFuaW1hdG9yU2V0ID0gbmV3IGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yU2V0KCk7XG4gICAgICAgIHZhciBmdWxsRHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCkgfHwgMzAwO1xuICAgICAgICB2YXIgaW50ZXJwb2xhdG9yID0gdGhpcy5nZXRDdXJ2ZSgpO1xuICAgICAgICB2YXIgcm90YXRpb25ZID0gdGhpcy5fZGlyZWN0aW9uID09PSBcInJpZ2h0XCIgPyAxODAgOiAtMTgwO1xuICAgICAgICBzd2l0Y2ggKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXI6XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCAzKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSAxLjA7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMC4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcImFscGhhXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMCk7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzBdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gcm90YXRpb25ZO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IDAuMDtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJyb3RhdGlvbllcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRJbnRlcnBvbGF0b3IoaW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbihmdWxsRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1sxXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDAuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAxLjA7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwiYWxwaGFcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRTdGFydERlbGF5KGZ1bGxEdXJhdGlvbiAvIDIpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKDEpO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1syXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQ6XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzID0gQXJyYXkuY3JlYXRlKGFuZHJvaWQuYW5pbWF0aW9uLkFuaW1hdG9yLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSAwLjA7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gLXJvdGF0aW9uWTtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJyb3RhdGlvbllcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRJbnRlcnBvbGF0b3IoaW50ZXJwb2xhdG9yKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbihmdWxsRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1swXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDEuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSAwLjA7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwiYWxwaGFcIiwgdmFsdWVzKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXRTdGFydERlbGF5KGZ1bGxEdXJhdGlvbiAvIDIpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKDEpO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1sxXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uXzEuQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEVudGVyOlxuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9ycyA9IEFycmF5LmNyZWF0ZShhbmRyb2lkLmFuaW1hdGlvbi5BbmltYXRvciwgMyk7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gMS4wO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IDAuMDtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJhbHBoYVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKDApO1xuICAgICAgICAgICAgICAgIG9iamVjdEFuaW1hdG9yc1swXSA9IGFuaW1hdG9yO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IC1yb3RhdGlvblk7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMC4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcInJvdGF0aW9uWVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldEludGVycG9sYXRvcihpbnRlcnBvbGF0b3IpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldER1cmF0aW9uKGZ1bGxEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzFdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgdmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gMC4wO1xuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IDEuMDtcbiAgICAgICAgICAgICAgICBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgXCJhbHBoYVwiLCB2YWx1ZXMpO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yLnNldFN0YXJ0RGVsYXkoZnVsbER1cmF0aW9uIC8gMik7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oMSk7XG4gICAgICAgICAgICAgICAgb2JqZWN0QW5pbWF0b3JzWzJdID0gYW5pbWF0b3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHRyYW5zaXRpb25fMS5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRXhpdDpcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnMgPSBBcnJheS5jcmVhdGUoYW5kcm9pZC5hbmltYXRpb24uQW5pbWF0b3IsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlcyA9IEFycmF5LmNyZWF0ZShcImZsb2F0XCIsIDIpO1xuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IDAuMDtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSByb3RhdGlvblk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3IgPSBhbmRyb2lkLmFuaW1hdGlvbi5PYmplY3RBbmltYXRvci5vZkZsb2F0KG51bGwsIFwicm90YXRpb25ZXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0SW50ZXJwb2xhdG9yKGludGVycG9sYXRvcik7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0RHVyYXRpb24oZnVsbER1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnNbMF0gPSBhbmltYXRvcjtcbiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBBcnJheS5jcmVhdGUoXCJmbG9hdFwiLCAyKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSAxLjA7XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gMC4wO1xuICAgICAgICAgICAgICAgIGFuaW1hdG9yID0gYW5kcm9pZC5hbmltYXRpb24uT2JqZWN0QW5pbWF0b3Iub2ZGbG9hdChudWxsLCBcImFscGhhXCIsIHZhbHVlcyk7XG4gICAgICAgICAgICAgICAgYW5pbWF0b3Iuc2V0U3RhcnREZWxheShmdWxsRHVyYXRpb24gLyAyKTtcbiAgICAgICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbigxKTtcbiAgICAgICAgICAgICAgICBvYmplY3RBbmltYXRvcnNbMV0gPSBhbmltYXRvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBhbmltYXRvclNldC5wbGF5VG9nZXRoZXIob2JqZWN0QW5pbWF0b3JzKTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdG9yU2V0O1xuICAgIH07XG4gICAgcmV0dXJuIEZsaXBUcmFuc2l0aW9uO1xufSh0cmFuc2l0aW9uXzEuVHJhbnNpdGlvbikpO1xuZXhwb3J0cy5GbGlwVHJhbnNpdGlvbiA9IEZsaXBUcmFuc2l0aW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmxpcC10cmFuc2l0aW9uLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYW5zaXRpb24gPSByZXF1aXJlKFwiLi90cmFuc2l0aW9uXCIpO1xudmFyIHBsYXRmb3JtID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIGxhenlfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9sYXp5XCIpO1xudmFyIHNjcmVlbldpZHRoID0gbGF6eV8xLmRlZmF1bHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcGxhdGZvcm0uc2NyZWVuLm1haW5TY3JlZW4ud2lkdGhQaXhlbHM7IH0pO1xudmFyIHNjcmVlbkhlaWdodCA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHBsYXRmb3JtLnNjcmVlbi5tYWluU2NyZWVuLmhlaWdodFBpeGVsczsgfSk7XG52YXIgU2xpZGVUcmFuc2l0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2xpZGVUcmFuc2l0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNsaWRlVHJhbnNpdGlvbihkaXJlY3Rpb24sIGR1cmF0aW9uLCBjdXJ2ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkdXJhdGlvbiwgY3VydmUpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU2xpZGVUcmFuc2l0aW9uLnByb3RvdHlwZS5jcmVhdGVBbmRyb2lkQW5pbWF0b3IgPSBmdW5jdGlvbiAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIHRyYW5zbGF0aW9uVmFsdWVzID0gQXJyYXkuY3JlYXRlKFwiZmxvYXRcIiwgMik7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gc2NyZWVuV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLmV4aXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IC1zY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IC1zY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRXhpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gc2NyZWVuV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gLXNjcmVlbldpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSBzY3JlZW5XaWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IHNjcmVlbldpZHRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAtc2NyZWVuV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRyYW5zaXRpb25UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZW50ZXI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IHNjcmVlbkhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gLXNjcmVlbkhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUucG9wRW50ZXI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IC1zY3JlZW5IZWlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIHRyYW5zaXRpb24uQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEV4aXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IHNjcmVlbkhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5lbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gLXNjcmVlbkhlaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgdHJhbnNpdGlvbi5BbmRyb2lkVHJhbnNpdGlvblR5cGUuZXhpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzFdID0gc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFbnRlcjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0aW9uVmFsdWVzWzBdID0gc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGlvblZhbHVlc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSB0cmFuc2l0aW9uLkFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRpb25WYWx1ZXNbMV0gPSAtc2NyZWVuSGVpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb3A7XG4gICAgICAgIGlmICh0aGlzLl9kaXJlY3Rpb24gPT09IFwibGVmdFwiIHx8IHRoaXMuX2RpcmVjdGlvbiA9PT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICBwcm9wID0gXCJ0cmFuc2xhdGlvblhcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByb3AgPSBcInRyYW5zbGF0aW9uWVwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRvciA9IGFuZHJvaWQuYW5pbWF0aW9uLk9iamVjdEFuaW1hdG9yLm9mRmxvYXQobnVsbCwgcHJvcCwgdHJhbnNsYXRpb25WYWx1ZXMpO1xuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCk7XG4gICAgICAgIGlmIChkdXJhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBhbmltYXRvci5zZXREdXJhdGlvbihkdXJhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0b3Iuc2V0SW50ZXJwb2xhdG9yKHRoaXMuZ2V0Q3VydmUoKSk7XG4gICAgICAgIHJldHVybiBhbmltYXRvcjtcbiAgICB9O1xuICAgIFNsaWRlVHJhbnNpdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGhpcykgKyBcIiBcIiArIHRoaXMuX2RpcmVjdGlvbjtcbiAgICB9O1xuICAgIHJldHVybiBTbGlkZVRyYW5zaXRpb247XG59KHRyYW5zaXRpb24uVHJhbnNpdGlvbikpO1xuZXhwb3J0cy5TbGlkZVRyYW5zaXRpb24gPSBTbGlkZVRyYW5zaXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbGlkZS10cmFuc2l0aW9uLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFuaW1hdGlvbl8xID0gcmVxdWlyZShcIi4uL2FuaW1hdGlvblwiKTtcbnZhciBsYXp5XzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbGF6eVwiKTtcbnZhciBfZGVmYXVsdEludGVycG9sYXRvciA9IGxhenlfMS5kZWZhdWx0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBhbmRyb2lkLnZpZXcuYW5pbWF0aW9uLkFjY2VsZXJhdGVEZWNlbGVyYXRlSW50ZXJwb2xhdG9yKCk7IH0pO1xudmFyIEFuZHJvaWRUcmFuc2l0aW9uVHlwZTtcbihmdW5jdGlvbiAoQW5kcm9pZFRyYW5zaXRpb25UeXBlKSB7XG4gICAgQW5kcm9pZFRyYW5zaXRpb25UeXBlLmVudGVyID0gXCJlbnRlclwiO1xuICAgIEFuZHJvaWRUcmFuc2l0aW9uVHlwZS5leGl0ID0gXCJleGl0XCI7XG4gICAgQW5kcm9pZFRyYW5zaXRpb25UeXBlLnBvcEVudGVyID0gXCJwb3BFbnRlclwiO1xuICAgIEFuZHJvaWRUcmFuc2l0aW9uVHlwZS5wb3BFeGl0ID0gXCJwb3BFeGl0XCI7XG59KShBbmRyb2lkVHJhbnNpdGlvblR5cGUgPSBleHBvcnRzLkFuZHJvaWRUcmFuc2l0aW9uVHlwZSB8fCAoZXhwb3J0cy5BbmRyb2lkVHJhbnNpdGlvblR5cGUgPSB7fSkpO1xudmFyIHRyYW5zaXRpb25JZCA9IDA7XG52YXIgVHJhbnNpdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVHJhbnNpdGlvbihkdXJhdGlvbiwgY3VydmUpIHtcbiAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgdGhpcy5faW50ZXJwb2xhdG9yID0gY3VydmUgPyBhbmltYXRpb25fMS5fcmVzb2x2ZUFuaW1hdGlvbkN1cnZlKGN1cnZlKSA6IF9kZWZhdWx0SW50ZXJwb2xhdG9yKCk7XG4gICAgICAgIHRoaXMuX2lkID0gdHJhbnNpdGlvbklkKys7XG4gICAgfVxuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmdldER1cmF0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZHVyYXRpb247XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5nZXRDdXJ2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVycG9sYXRvcjtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmFuaW1hdGVJT1NUcmFuc2l0aW9uID0gZnVuY3Rpb24gKGNvbnRhaW5lclZpZXcsIGZyb21WaWV3LCB0b1ZpZXcsIG9wZXJhdGlvbiwgY29tcGxldGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBYnN0cmFjdCBtZXRob2QgY2FsbFwiKTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmNyZWF0ZUFuZHJvaWRBbmltYXRvciA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBYnN0cmFjdCBtZXRob2QgY2FsbFwiKTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJUcmFuc2l0aW9uQFwiICsgdGhpcy5faWQ7XG4gICAgfTtcbiAgICByZXR1cm4gVHJhbnNpdGlvbjtcbn0oKSk7XG5leHBvcnRzLlRyYW5zaXRpb24gPSBUcmFuc2l0aW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhbnNpdGlvbi5hbmRyb2lkLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuZXhwb3J0cy5GaWxlID0gZmlsZV9zeXN0ZW1fMS5GaWxlO1xuZXhwb3J0cy5rbm93bkZvbGRlcnMgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycztcbmV4cG9ydHMucGF0aCA9IGZpbGVfc3lzdGVtXzEucGF0aDtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInNyY1wiIH0pO1xudmFyIFdlYlZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV2ViVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV2ViVmlld0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV2ViVmlld0Jhc2VfMSA9IFdlYlZpZXdCYXNlO1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZS5fb25Mb2FkRmluaXNoZWQgPSBmdW5jdGlvbiAodXJsLCBlcnJvcikge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogV2ViVmlld0Jhc2VfMS5sb2FkRmluaXNoZWRFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yOiBlcnJvclxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZS5fb25Mb2FkU3RhcnRlZCA9IGZ1bmN0aW9uICh1cmwsIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBXZWJWaWV3QmFzZV8xLmxvYWRTdGFydGVkRXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBuYXZpZ2F0aW9uVHlwZSxcbiAgICAgICAgICAgIGVycm9yOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlld0Jhc2UucHJvdG90eXBlLCBcImNhbkdvQmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBtZW1iZXIgaXMgYWJzdHJhY3QuXCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlld0Jhc2UucHJvdG90eXBlLCBcImNhbkdvRm9yd2FyZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBtZW1iZXIgaXMgYWJzdHJhY3QuXCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBXZWJWaWV3QmFzZS5wcm90b3R5cGVbZXhwb3J0cy5zcmNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBXZWJWaWV3QmFzZS5wcm90b3R5cGVbZXhwb3J0cy5zcmNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHNyYykge1xuICAgICAgICB0aGlzLnN0b3BMb2FkaW5nKCk7XG4gICAgICAgIGlmIChzcmMuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgICAgICBzcmMgPSBcImZpbGU6Ly8vXCIgKyBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCArIFwiL1wiICsgc3JjLnN1YnN0cigyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzcmMuaW5kZXhPZihcIi9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHNyYyA9IFwiZmlsZTovL1wiICsgc3JjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiZmlsZTovLy9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHNyYyA9IGVuY29kZVVSSShzcmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiaHR0cDovL1wiKSA9PT0gMCB8fFxuICAgICAgICAgICAgc3JjLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcImh0dHBzOi8vXCIpID09PSAwIHx8XG4gICAgICAgICAgICBzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiZmlsZTovLy9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRVcmwoc3JjKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWREYXRhKHNyYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBXZWJWaWV3QmFzZV8xO1xuICAgIFdlYlZpZXdCYXNlLmxvYWRTdGFydGVkRXZlbnQgPSBcImxvYWRTdGFydGVkXCI7XG4gICAgV2ViVmlld0Jhc2UubG9hZEZpbmlzaGVkRXZlbnQgPSBcImxvYWRGaW5pc2hlZFwiO1xuICAgIFdlYlZpZXdCYXNlID0gV2ViVmlld0Jhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIldlYlZpZXdcIilcbiAgICBdLCBXZWJWaWV3QmFzZSk7XG4gICAgcmV0dXJuIFdlYlZpZXdCYXNlO1xufSh2aWV3XzEuQ29udGFpbmVyVmlldykpO1xuZXhwb3J0cy5XZWJWaWV3QmFzZSA9IFdlYlZpZXdCYXNlO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eS5yZWdpc3RlcihXZWJWaWV3QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWItdmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB3ZWJfdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3dlYi12aWV3LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3dlYi12aWV3LWNvbW1vblwiKSk7XG52YXIgV2ViVmlld0NsaWVudDtcbmZ1bmN0aW9uIGluaXRpYWxpemVXZWJWaWV3Q2xpZW50KCkge1xuICAgIGlmIChXZWJWaWV3Q2xpZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIFdlYlZpZXdDbGllbnRJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFdlYlZpZXdDbGllbnRJbXBsLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBXZWJWaWV3Q2xpZW50SW1wbChvd25lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gZ2xvYmFsLl9fbmF0aXZlKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBXZWJWaWV3Q2xpZW50SW1wbC5wcm90b3R5cGUuc2hvdWxkT3ZlcnJpZGVVcmxMb2FkaW5nID0gZnVuY3Rpb24gKHZpZXcsIHVybCkge1xuICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIldlYlZpZXdDbGllbnRDbGFzcy5zaG91bGRPdmVycmlkZVVybExvYWRpbmcoXCIgKyB1cmwgKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgV2ViVmlld0NsaWVudEltcGwucHJvdG90eXBlLm9uUGFnZVN0YXJ0ZWQgPSBmdW5jdGlvbiAodmlldywgdXJsLCBmYXZpY29uKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUGFnZVN0YXJ0ZWQuY2FsbCh0aGlzLCB2aWV3LCB1cmwsIGZhdmljb24pO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIGlmICh3ZWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV2ViVmlld0NsaWVudENsYXNzLm9uUGFnZVN0YXJ0ZWQoXCIgKyB1cmwgKyBcIiwgXCIgKyBmYXZpY29uICsgXCIpXCIsIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG93bmVyLl9vbkxvYWRTdGFydGVkKHVybCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgV2ViVmlld0NsaWVudEltcGwucHJvdG90eXBlLm9uUGFnZUZpbmlzaGVkID0gZnVuY3Rpb24gKHZpZXcsIHVybCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblBhZ2VGaW5pc2hlZC5jYWxsKHRoaXMsIHZpZXcsIHVybCk7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJXZWJWaWV3Q2xpZW50Q2xhc3Mub25QYWdlRmluaXNoZWQoXCIgKyB1cmwgKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3duZXIuX29uTG9hZEZpbmlzaGVkKHVybCwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgV2ViVmlld0NsaWVudEltcGwucHJvdG90eXBlLm9uUmVjZWl2ZWRFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3JDb2RlID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgICAgICAgICB2YXIgZmFpbGluZ1VybCA9IGFyZ3VtZW50c1szXTtcbiAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUmVjZWl2ZWRFcnJvci5jYWxsKHRoaXMsIHZpZXcsIGVycm9yQ29kZSwgZGVzY3JpcHRpb24sIGZhaWxpbmdVcmwpO1xuICAgICAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXI7XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3ZWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIldlYlZpZXdDbGllbnRDbGFzcy5vblJlY2VpdmVkRXJyb3IoXCIgKyBlcnJvckNvZGUgKyBcIiwgXCIgKyBkZXNjcmlwdGlvbiArIFwiLCBcIiArIGZhaWxpbmdVcmwgKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvd25lci5fb25Mb2FkRmluaXNoZWQoZmFpbGluZ1VybCwgZGVzY3JpcHRpb24gKyBcIihcIiArIGVycm9yQ29kZSArIFwiKVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSBhcmd1bWVudHNbMl07XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblJlY2VpdmVkRXJyb3IuY2FsbCh0aGlzLCB2aWV3LCByZXF1ZXN0LCBlcnJvcik7XG4gICAgICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lcjtcbiAgICAgICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV2ViVmlld0NsaWVudENsYXNzLm9uUmVjZWl2ZWRFcnJvcihcIiArIGVycm9yLmdldEVycm9yQ29kZSgpICsgXCIsIFwiICsgZXJyb3IuZ2V0RGVzY3JpcHRpb24oKSArIFwiLCBcIiArIChlcnJvci5nZXRVcmwgJiYgZXJyb3IuZ2V0VXJsKCkpICsgXCIpXCIsIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb3duZXIuX29uTG9hZEZpbmlzaGVkKGVycm9yLmdldFVybCAmJiBlcnJvci5nZXRVcmwoKSwgZXJyb3IuZ2V0RGVzY3JpcHRpb24oKSArIFwiKFwiICsgZXJyb3IuZ2V0RXJyb3JDb2RlKCkgKyBcIilcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gV2ViVmlld0NsaWVudEltcGw7XG4gICAgfShhbmRyb2lkLndlYmtpdC5XZWJWaWV3Q2xpZW50KSk7XG4gICAgV2ViVmlld0NsaWVudCA9IFdlYlZpZXdDbGllbnRJbXBsO1xufVxudmFyIFdlYlZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXZWJWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdlYlZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV2ViVmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBuZXcgYW5kcm9pZC53ZWJraXQuV2ViVmlldyh0aGlzLl9jb250ZXh0KTtcbiAgICAgICAgbmF0aXZlVmlldy5nZXRTZXR0aW5ncygpLnNldEphdmFTY3JpcHRFbmFibGVkKHRydWUpO1xuICAgICAgICBuYXRpdmVWaWV3LmdldFNldHRpbmdzKCkuc2V0QnVpbHRJblpvb21Db250cm9scyh0cnVlKTtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXc7XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICBpbml0aWFsaXplV2ViVmlld0NsaWVudCgpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGNsaWVudCA9IG5ldyBXZWJWaWV3Q2xpZW50KHRoaXMpO1xuICAgICAgICBuYXRpdmVWaWV3LnNldFdlYlZpZXdDbGllbnQoY2xpZW50KTtcbiAgICAgICAgbmF0aXZlVmlldy5jbGllbnQgPSBjbGllbnQ7XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LmNsaWVudC5vd25lciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLl9sb2FkVXJsID0gZnVuY3Rpb24gKHNyYykge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKCFuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5sb2FkVXJsKHNyYyk7XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5fbG9hZERhdGEgPSBmdW5jdGlvbiAoc3JjKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFzZVVybCA9IFwiZmlsZTovLy9cIiArIHdlYl92aWV3X2NvbW1vbl8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCArIFwiL1wiO1xuICAgICAgICBuYXRpdmVWaWV3LmxvYWREYXRhV2l0aEJhc2VVUkwoYmFzZVVybCwgc3JjLCBcInRleHQvaHRtbFwiLCBcInV0Zi04XCIsIG51bGwpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdlYlZpZXcucHJvdG90eXBlLCBcImNhbkdvQmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jYW5Hb0JhY2soKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgV2ViVmlldy5wcm90b3R5cGUuc3RvcExvYWRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zdG9wTG9hZGluZygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlldy5wcm90b3R5cGUsIFwiY2FuR29Gb3J3YXJkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuY2FuR29Gb3J3YXJkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFdlYlZpZXcucHJvdG90eXBlLmdvQmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy5nb0JhY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV2ViVmlldy5wcm90b3R5cGUuZ29Gb3J3YXJkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBuYXRpdmVWaWV3LmdvRm9yd2FyZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5yZWxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcucmVsb2FkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBXZWJWaWV3O1xufSh3ZWJfdmlld19jb21tb25fMS5XZWJWaWV3QmFzZSkpO1xuZXhwb3J0cy5XZWJWaWV3ID0gV2ViVmlldztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYi12aWV3LmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybVwiKTtcbmV4cG9ydHMuZGVidWcgPSB0cnVlO1xudmFyIGFwcGxpY2F0aW9uUm9vdFBhdGg7XG5mdW5jdGlvbiBlbnN1cmVBcHBSb290UGF0aCgpIHtcbiAgICBpZiAoIWFwcGxpY2F0aW9uUm9vdFBhdGgpIHtcbiAgICAgICAgYXBwbGljYXRpb25Sb290UGF0aCA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoO1xuICAgICAgICBhcHBsaWNhdGlvblJvb3RQYXRoID0gYXBwbGljYXRpb25Sb290UGF0aC5zdWJzdHIoMCwgYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGggLSBcImFwcC9cIi5sZW5ndGgpO1xuICAgIH1cbn1cbnZhciBTb3VyY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNvdXJjZSh1cmksIGxpbmUsIGNvbHVtbikge1xuICAgICAgICBlbnN1cmVBcHBSb290UGF0aCgpO1xuICAgICAgICBpZiAodXJpLmxlbmd0aCA+IGFwcGxpY2F0aW9uUm9vdFBhdGgubGVuZ3RoICYmIHVyaS5zdWJzdHIoMCwgYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGgpID09PSBhcHBsaWNhdGlvblJvb3RQYXRoKSB7XG4gICAgICAgICAgICB0aGlzLl91cmkgPSBcImZpbGU6Ly9cIiArIHVyaS5zdWJzdHIoYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdXJpID0gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xpbmUgPSBsaW5lO1xuICAgICAgICB0aGlzLl9jb2x1bW4gPSBjb2x1bW47XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3VyY2UucHJvdG90eXBlLCBcInVyaVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fdXJpOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlLnByb3RvdHlwZSwgXCJsaW5lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9saW5lOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlLnByb3RvdHlwZSwgXCJjb2x1bW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NvbHVtbjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU291cmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VyaSArIFwiOlwiICsgdGhpcy5fbGluZSArIFwiOlwiICsgdGhpcy5fY29sdW1uO1xuICAgIH07XG4gICAgU291cmNlLmdldCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIG9iamVjdFtTb3VyY2UuX3NvdXJjZV07XG4gICAgfTtcbiAgICBTb3VyY2Uuc2V0ID0gZnVuY3Rpb24gKG9iamVjdCwgc3JjKSB7XG4gICAgICAgIG9iamVjdFtTb3VyY2UuX3NvdXJjZV0gPSBzcmM7XG4gICAgfTtcbiAgICBTb3VyY2UuX3NvdXJjZSA9IFN5bWJvbChcInNvdXJjZVwiKTtcbiAgICByZXR1cm4gU291cmNlO1xufSgpKTtcbmV4cG9ydHMuU291cmNlID0gU291cmNlO1xudmFyIFNjb3BlRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTY29wZUVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNjb3BlRXJyb3IoaW5uZXIsIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGZvcm1hdHRlZE1lc3NhZ2U7XG4gICAgICAgIGlmIChtZXNzYWdlICYmIGlubmVyLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZE1lc3NhZ2UgPSBtZXNzYWdlICsgXCJcXG4gPiBcIiArIGlubmVyLm1lc3NhZ2UucmVwbGFjZShcIlxcblwiLCBcIlxcbiAgXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9ybWF0dGVkTWVzc2FnZSA9IG1lc3NhZ2UgfHwgaW5uZXIubWVzc2FnZSB8fCB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmb3JtYXR0ZWRNZXNzYWdlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGFjayA9IHBsYXRmb3JtXzEuaXNBbmRyb2lkID8gXCJFcnJvcjogXCIgKyBfdGhpcy5tZXNzYWdlICsgXCJcXG5cIiArIGlubmVyLnN0YWNrLnN1YnN0cihpbm5lci5zdGFjay5pbmRleE9mKFwiXFxuXCIpICsgMSkgOiBpbm5lci5zdGFjaztcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IGZvcm1hdHRlZE1lc3NhZ2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFNjb3BlRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnRzLlNjb3BlRXJyb3IgPSBTY29wZUVycm9yO1xudmFyIFNvdXJjZUVycm9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU291cmNlRXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU291cmNlRXJyb3IoY2hpbGQsIHNvdXJjZSwgbWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgY2hpbGQsIG1lc3NhZ2UgPyBtZXNzYWdlICsgXCIgQFwiICsgc291cmNlICsgXCJcIiA6IHNvdXJjZSArIFwiXCIpIHx8IHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBTb3VyY2VFcnJvcjtcbn0oU2NvcGVFcnJvcikpO1xuZXhwb3J0cy5Tb3VyY2VFcnJvciA9IFNvdXJjZUVycm9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVidWcuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gbGF6eShhY3Rpb24pIHtcbiAgICB2YXIgX3ZhbHVlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdmFsdWUgfHwgKF92YWx1ZSA9IGFjdGlvbigpKTsgfTtcbn1cbmV4cG9ydHMuZGVmYXVsdCA9IGxhenk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sYXp5LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGRpc3BhdGNoVG9NYWluVGhyZWFkKGZ1bmMpIHtcbiAgICBuZXcgYW5kcm9pZC5vcy5IYW5kbGVyKGFuZHJvaWQub3MuTG9vcGVyLmdldE1haW5Mb29wZXIoKSlcbiAgICAgICAgLnBvc3QobmV3IGphdmEubGFuZy5SdW5uYWJsZSh7XG4gICAgICAgIHJ1bjogZnVuY1xuICAgIH0pKTtcbn1cbmV4cG9ydHMuZGlzcGF0Y2hUb01haW5UaHJlYWQgPSBkaXNwYXRjaFRvTWFpblRocmVhZDtcbmZ1bmN0aW9uIGlzTWFpblRocmVhZCgpIHtcbiAgICByZXR1cm4gYW5kcm9pZC5vcy5Mb29wZXIubXlMb29wZXIoKSA9PT0gYW5kcm9pZC5vcy5Mb29wZXIuZ2V0TWFpbkxvb3BlcigpO1xufVxuZXhwb3J0cy5pc01haW5UaHJlYWQgPSBpc01haW5UaHJlYWQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYWludGhyZWFkLWhlbHBlci5hbmRyb2lkLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlcHNpbG9uID0gMUUtMDU7XG5mdW5jdGlvbiBhcmVDbG9zZSh2YWx1ZTEsIHZhbHVlMikge1xuICAgIHJldHVybiAoTWF0aC5hYnModmFsdWUxIC0gdmFsdWUyKSA8IGVwc2lsb24pO1xufVxuZXhwb3J0cy5hcmVDbG9zZSA9IGFyZUNsb3NlO1xuZnVuY3Rpb24gZ3JlYXRlclRoYW5PckNsb3NlKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuICh2YWx1ZTEgPiB2YWx1ZTIpIHx8IGFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMuZ3JlYXRlclRoYW5PckNsb3NlID0gZ3JlYXRlclRoYW5PckNsb3NlO1xuZnVuY3Rpb24gZ3JlYXRlclRoYW4odmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA+IHZhbHVlMikgJiYgIWFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMuZ3JlYXRlclRoYW4gPSBncmVhdGVyVGhhbjtcbmZ1bmN0aW9uIGxlc3NUaGFuKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuICh2YWx1ZTEgPCB2YWx1ZTIpICYmICFhcmVDbG9zZSh2YWx1ZTEsIHZhbHVlMik7XG59XG5leHBvcnRzLmxlc3NUaGFuID0gbGVzc1RoYW47XG5mdW5jdGlvbiBpc1plcm8odmFsdWUpIHtcbiAgICByZXR1cm4gKE1hdGguYWJzKHZhbHVlKSA8IGVwc2lsb24pO1xufVxuZXhwb3J0cy5pc1plcm8gPSBpc1plcm87XG5mdW5jdGlvbiBncmVhdGVyVGhhblplcm8odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPiAwO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhblplcm8gPSBncmVhdGVyVGhhblplcm87XG5mdW5jdGlvbiBub3ROZWdhdGl2ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA+PSAwO1xufVxuZXhwb3J0cy5ub3ROZWdhdGl2ZSA9IG5vdE5lZ2F0aXZlO1xuZXhwb3J0cy5yYWRpYW5zVG9EZWdyZWVzID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEgKiAoMTgwIC8gTWF0aC5QSSk7IH07XG5leHBvcnRzLmRlZ3JlZXNUb1JhZGlhbnMgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSAqIChNYXRoLlBJIC8gMTgwKTsgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW51bWJlci11dGlscy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmc7XG59XG5leHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7XG5mdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBOdW1iZXI7XG59XG5leHBvcnRzLmlzTnVtYmVyID0gaXNOdW1iZXI7XG5mdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIEJvb2xlYW47XG59XG5leHBvcnRzLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtcbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiO1xufVxuZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCI7XG59XG5leHBvcnRzLmlzT2JqZWN0ID0gaXNPYmplY3Q7XG5mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkO1xuZnVuY3Rpb24gaXNEZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSAhPT0gXCJ1bmRlZmluZWRcIjtcbn1cbmV4cG9ydHMuaXNEZWZpbmVkID0gaXNEZWZpbmVkO1xuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNOdWxsT3JVbmRlZmluZWQgPSBpc051bGxPclVuZGVmaW5lZDtcbmZ1bmN0aW9uIHZlcmlmeUNhbGxiYWNrKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlICYmICFpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2FsbGJhY2sgbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLlwiKTtcbiAgICB9XG59XG5leHBvcnRzLnZlcmlmeUNhbGxiYWNrID0gdmVyaWZ5Q2FsbGJhY2s7XG52YXIgY2xhc3NJbmZvc01hcCA9IG5ldyBNYXAoKTtcbnZhciBmdW5jTmFtZVJlZ2V4ID0gL2Z1bmN0aW9uIChbX2EtekEtWjAtOV17MSx9KVxcKC87XG5mdW5jdGlvbiBnZXRDbGFzcyhvYmplY3QpIHtcbiAgICByZXR1cm4gZ2V0Q2xhc3NJbmZvKG9iamVjdCkubmFtZTtcbn1cbmV4cG9ydHMuZ2V0Q2xhc3MgPSBnZXRDbGFzcztcbmZ1bmN0aW9uIGdldENsYXNzSW5mbyhvYmplY3QpIHtcbiAgICB2YXIgY29uc3RydWN0b3IgPSBvYmplY3QuY29uc3RydWN0b3I7XG4gICAgdmFyIHJlc3VsdCA9IGNsYXNzSW5mb3NNYXAuZ2V0KGNvbnN0cnVjdG9yKTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQ2xhc3NJbmZvKGNvbnN0cnVjdG9yKTtcbiAgICAgICAgY2xhc3NJbmZvc01hcC5zZXQoY29uc3RydWN0b3IsIHJlc3VsdCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldENsYXNzSW5mbyA9IGdldENsYXNzSW5mbztcbmZ1bmN0aW9uIGdldEJhc2VDbGFzc2VzKG9iamVjdCkge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgaW5mbyA9IGdldENsYXNzSW5mbyhvYmplY3QpO1xuICAgIHdoaWxlIChpbmZvKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGluZm8ubmFtZSk7XG4gICAgICAgIGluZm8gPSBpbmZvLmJhc2VDbGFzc0luZm87XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldEJhc2VDbGFzc2VzID0gZ2V0QmFzZUNsYXNzZXM7XG52YXIgQ2xhc3NJbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDbGFzc0luZm8odHlwZUNvc250cnVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3R5cGVDb3NudHJ1Y3RvciA9IHR5cGVDb3NudHJ1Y3RvcjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENsYXNzSW5mby5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9uYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSAoZnVuY05hbWVSZWdleCkuZXhlYyh0aGlzLl90eXBlQ29zbnRydWN0b3IudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbmFtZSA9IChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gMSkgPyByZXN1bHRzWzFdIDogXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2xhc3NJbmZvLnByb3RvdHlwZSwgXCJiYXNlQ2xhc3NJbmZvXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoaXNVbmRlZmluZWQodGhpcy5fYmFzZUNsYXNzSW5mbykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXNlQ2xhc3NJbmZvID0gQ2xhc3NJbmZvLl9nZXRCYXNlKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iYXNlQ2xhc3NJbmZvICYmIHRoaXMuX2Jhc2VDbGFzc0luZm8ubmFtZSA9PT0gdGhpcy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Jhc2VDbGFzc0luZm8gPSBDbGFzc0luZm8uX2dldEJhc2UodGhpcy5fYmFzZUNsYXNzSW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jhc2VDbGFzc0luZm87XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENsYXNzSW5mby5fZ2V0QmFzZSA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgICAgICB2YXIgY29uc3RydWN0b3JQcm90byA9IGluZm8uX3R5cGVDb3NudHJ1Y3Rvci5wcm90b3R5cGU7XG4gICAgICAgIGlmIChjb25zdHJ1Y3RvclByb3RvLl9fcHJvdG9fXykge1xuICAgICAgICAgICAgcmVzdWx0ID0gZ2V0Q2xhc3NJbmZvKGNvbnN0cnVjdG9yUHJvdG8uX19wcm90b19fKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIENsYXNzSW5mbztcbn0oKSk7XG5leHBvcnRzLkNsYXNzSW5mbyA9IENsYXNzSW5mbztcbmZ1bmN0aW9uIHRvVUlTdHJpbmcob2JqKSB7XG4gICAgcmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKG9iaikgPyBcIlwiIDogb2JqICsgXCJcIjtcbn1cbmV4cG9ydHMudG9VSVN0cmluZyA9IHRvVUlTdHJpbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4vdHlwZXNcIik7XG52YXIgbWFpbnRocmVhZF9oZWxwZXJfMSA9IHJlcXVpcmUoXCIuL21haW50aHJlYWQtaGVscGVyXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL3VpL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbWFpbnRocmVhZC1oZWxwZXJcIikpO1xuZXhwb3J0cy5SRVNPVVJDRV9QUkVGSVggPSBcInJlczovL1wiO1xuZXhwb3J0cy5GSUxFX1BSRUZJWCA9IFwiZmlsZTovLy9cIjtcbmZ1bmN0aW9uIGVzY2FwZVJlZ2V4U3ltYm9scyhzb3VyY2UpIHtcbiAgICB2YXIgZXNjYXBlUmVnZXggPSAvW1xcLVxcW1xcXVxcL1xce1xcfVxcKFxcKVxcKlxcK1xcP1xcLlxcXFxcXF5cXCRcXHxdL2c7XG4gICAgcmV0dXJuIHNvdXJjZS5yZXBsYWNlKGVzY2FwZVJlZ2V4LCBcIlxcXFwkJlwiKTtcbn1cbmV4cG9ydHMuZXNjYXBlUmVnZXhTeW1ib2xzID0gZXNjYXBlUmVnZXhTeW1ib2xzO1xuZnVuY3Rpb24gY29udmVydFN0cmluZyh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyh2YWx1ZSkgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHZhbHVlQXNOdW1iZXIgPSArdmFsdWU7XG4gICAgICAgIGlmICghaXNOYU4odmFsdWVBc051bWJlcikpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQXNOdW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgJiYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiIHx8IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwiZmFsc2VcIikpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuY29udmVydFN0cmluZyA9IGNvbnZlcnRTdHJpbmc7XG5mdW5jdGlvbiBnZXRNb2R1bGVOYW1lKHBhdGgpIHtcbiAgICB2YXIgbW9kdWxlTmFtZSA9IHBhdGgucmVwbGFjZShcIi4vXCIsIFwiXCIpO1xuICAgIHJldHVybiBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSk7XG59XG5leHBvcnRzLmdldE1vZHVsZU5hbWUgPSBnZXRNb2R1bGVOYW1lO1xudmFyIGxheW91dENvbW1vbjtcbihmdW5jdGlvbiAobGF5b3V0Q29tbW9uKSB7XG4gICAgdmFyIE1PREVfU0hJRlQgPSAzMDtcbiAgICB2YXIgTU9ERV9NQVNLID0gMHgzIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLlVOU1BFQ0lGSUVEID0gMCA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5FWEFDVExZID0gMSA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5BVF9NT1NUID0gMiA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQgPSAweDAwMDAwMDEwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TVEFURV9UT09fU01BTEwgPSAweDAxMDAwMDAwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TVEFURV9NQVNLID0gMHhmZjAwMDAwMDtcbiAgICBsYXlvdXRDb21tb24uTUVBU1VSRURfU0laRV9NQVNLID0gMHgwMGZmZmZmZjtcbiAgICBmdW5jdGlvbiBnZXRNb2RlKG1vZGUpIHtcbiAgICAgICAgc3dpdGNoIChtb2RlKSB7XG4gICAgICAgICAgICBjYXNlIGxheW91dENvbW1vbi5FWEFDVExZOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIkV4YWN0XCI7XG4gICAgICAgICAgICBjYXNlIGxheW91dENvbW1vbi5BVF9NT1NUOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIkF0TW9zdFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJVbnNwZWNpZmllZFwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNb2RlID0gZ2V0TW9kZTtcbiAgICBmdW5jdGlvbiBnZXRNZWFzdXJlU3BlY01vZGUoc3BlYykge1xuICAgICAgICByZXR1cm4gKHNwZWMgJiBNT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24uZ2V0TWVhc3VyZVNwZWNNb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlO1xuICAgIGZ1bmN0aW9uIGdldE1lYXN1cmVTcGVjU2l6ZShzcGVjKSB7XG4gICAgICAgIHJldHVybiAoc3BlYyAmIH5NT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24uZ2V0TWVhc3VyZVNwZWNTaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplO1xuICAgIGZ1bmN0aW9uIG1lYXN1cmVTcGVjVG9TdHJpbmcobWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIG1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUobWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgc2l6ZSA9IGdldE1lYXN1cmVTcGVjU2l6ZShtZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB0ZXh0ID0gXCJNZWFzdXJlU3BlYzogXCI7XG4gICAgICAgIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uVU5TUEVDSUZJRUQpIHtcbiAgICAgICAgICAgIHRleHQgKz0gXCJVTlNQRUNJRklFRCBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uRVhBQ1RMWSkge1xuICAgICAgICAgICAgdGV4dCArPSBcIkVYQUNUTFkgXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobW9kZSA9PT0gbGF5b3V0Q29tbW9uLkFUX01PU1QpIHtcbiAgICAgICAgICAgIHRleHQgKz0gXCJBVF9NT1NUIFwiO1xuICAgICAgICB9XG4gICAgICAgIHRleHQgKz0gc2l6ZTtcbiAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5tZWFzdXJlU3BlY1RvU3RyaW5nID0gbWVhc3VyZVNwZWNUb1N0cmluZztcbiAgICBmdW5jdGlvbiByb3VuZCh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzID0gTWF0aC5mbG9vcih2YWx1ZSArIDAuNSk7XG4gICAgICAgIGlmIChyZXMgIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24ucm91bmQgPSByb3VuZDtcbn0pKGxheW91dENvbW1vbiA9IGV4cG9ydHMubGF5b3V0Q29tbW9uIHx8IChleHBvcnRzLmxheW91dENvbW1vbiA9IHt9KSk7XG5mdW5jdGlvbiBpc0ZpbGVPclJlc291cmNlUGF0aChwYXRoKSB7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyhwYXRoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBwYXRoLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCB8fFxuICAgICAgICBwYXRoLmluZGV4T2YoXCIvXCIpID09PSAwIHx8XG4gICAgICAgIHBhdGguaW5kZXhPZihleHBvcnRzLlJFU09VUkNFX1BSRUZJWCkgPT09IDA7XG59XG5leHBvcnRzLmlzRmlsZU9yUmVzb3VyY2VQYXRoID0gaXNGaWxlT3JSZXNvdXJjZVBhdGg7XG5mdW5jdGlvbiBpc0ZvbnRJY29uVVJJKHVyaSkge1xuICAgIGlmICghdHlwZXMuaXNTdHJpbmcodXJpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBmaXJzdFNlZ21lbnQgPSB1cmkudHJpbSgpLnNwbGl0KFwiLy9cIilbMF07XG4gICAgcmV0dXJuIGZpcnN0U2VnbWVudCAmJiBmaXJzdFNlZ21lbnQuaW5kZXhPZihcImZvbnQ6XCIpID09PSAwO1xufVxuZXhwb3J0cy5pc0ZvbnRJY29uVVJJID0gaXNGb250SWNvblVSSTtcbmZ1bmN0aW9uIGlzRGF0YVVSSSh1cmkpIHtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHVyaSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgZmlyc3RTZWdtZW50ID0gdXJpLnRyaW0oKS5zcGxpdChcIixcIilbMF07XG4gICAgcmV0dXJuIGZpcnN0U2VnbWVudCAmJiBmaXJzdFNlZ21lbnQuaW5kZXhPZihcImRhdGE6XCIpID09PSAwICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiYmFzZTY0XCIpID49IDA7XG59XG5leHBvcnRzLmlzRGF0YVVSSSA9IGlzRGF0YVVSSTtcbmZ1bmN0aW9uIG1lcmdlU29ydChhcnIsIGNvbXBhcmVGdW5jKSB7XG4gICAgaWYgKGFyci5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfVxuICAgIHZhciBtaWRkbGUgPSBhcnIubGVuZ3RoIC8gMjtcbiAgICB2YXIgbGVmdCA9IGFyci5zbGljZSgwLCBtaWRkbGUpO1xuICAgIHZhciByaWdodCA9IGFyci5zbGljZShtaWRkbGUsIGFyci5sZW5ndGgpO1xuICAgIHJldHVybiBtZXJnZShtZXJnZVNvcnQobGVmdCwgY29tcGFyZUZ1bmMpLCBtZXJnZVNvcnQocmlnaHQsIGNvbXBhcmVGdW5jKSwgY29tcGFyZUZ1bmMpO1xufVxuZXhwb3J0cy5tZXJnZVNvcnQgPSBtZXJnZVNvcnQ7XG5mdW5jdGlvbiBtZXJnZShsZWZ0LCByaWdodCwgY29tcGFyZUZ1bmMpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgd2hpbGUgKGxlZnQubGVuZ3RoICYmIHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICBpZiAoY29tcGFyZUZ1bmMobGVmdFswXSwgcmlnaHRbMF0pIDw9IDApIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAobGVmdC5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICB9XG4gICAgd2hpbGUgKHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMubWVyZ2UgPSBtZXJnZTtcbmZ1bmN0aW9uIGhhc0R1cGxpY2F0ZXMoYXJyKSB7XG4gICAgcmV0dXJuIGFyci5sZW5ndGggIT09IGVsaW1pbmF0ZUR1cGxpY2F0ZXMoYXJyKS5sZW5ndGg7XG59XG5leHBvcnRzLmhhc0R1cGxpY2F0ZXMgPSBoYXNEdXBsaWNhdGVzO1xuZnVuY3Rpb24gZWxpbWluYXRlRHVwbGljYXRlcyhhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KGFycikpO1xufVxuZXhwb3J0cy5lbGltaW5hdGVEdXBsaWNhdGVzID0gZWxpbWluYXRlRHVwbGljYXRlcztcbmZ1bmN0aW9uIGV4ZWN1dGVPbk1haW5UaHJlYWQoZnVuYykge1xuICAgIGlmIChtYWludGhyZWFkX2hlbHBlcl8xLmlzTWFpblRocmVhZCgpKSB7XG4gICAgICAgIHJldHVybiBmdW5jKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBtYWludGhyZWFkX2hlbHBlcl8xLmRpc3BhdGNoVG9NYWluVGhyZWFkKGZ1bmMpO1xuICAgIH1cbn1cbmV4cG9ydHMuZXhlY3V0ZU9uTWFpblRocmVhZCA9IGV4ZWN1dGVPbk1haW5UaHJlYWQ7XG5mdW5jdGlvbiBtYWluVGhyZWFkaWZ5KGZ1bmMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYXJnc1RvUGFzcyA9IGFyZ3VtZW50cztcbiAgICAgICAgZXhlY3V0ZU9uTWFpblRocmVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBmdW5jLmFwcGx5KF90aGlzLCBhcmdzVG9QYXNzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMubWFpblRocmVhZGlmeSA9IG1haW5UaHJlYWRpZnk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uL3RyYWNlXCIpO1xudmFyIHV0aWxzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdXRpbHMtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdXRpbHMtY29tbW9uXCIpKTtcbnZhciBhcHBsaWNhdGlvbl8xID0gcmVxdWlyZShcIi4uL2FwcGxpY2F0aW9uXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vcGxhdGZvcm1cIik7XG52YXIgZmlsZV9zeXN0ZW1fYWNjZXNzXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW0vZmlsZS1zeXN0ZW0tYWNjZXNzXCIpO1xudmFyIE1JTl9VUklfU0hBUkVfUkVTVFJJQ1RFRF9BUEtfVkVSU0lPTiA9IDI0O1xudmFyIGxheW91dDtcbihmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgdmFyIGRlbnNpdHk7XG4gICAgdmFyIE1PREVfU0hJRlQgPSAzMDtcbiAgICB2YXIgTU9ERV9NQVNLID0gMHgzIDw8IE1PREVfU0hJRlQ7XG4gICAgdmFyIHNka1ZlcnNpb247XG4gICAgdmFyIHVzZU9sZE1lYXN1cmVTcGVjID0gZmFsc2U7XG4gICAgZnVuY3Rpb24gbWFrZU1lYXN1cmVTcGVjKHNpemUsIG1vZGUpIHtcbiAgICAgICAgaWYgKHNka1ZlcnNpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2RrVmVyc2lvbiA9IGFkLmdldEFwcGxpY2F0aW9uQ29udGV4dCgpLmdldEFwcGxpY2F0aW9uSW5mbygpLnRhcmdldFNka1ZlcnNpb247XG4gICAgICAgICAgICB1c2VPbGRNZWFzdXJlU3BlYyA9IHNka1ZlcnNpb24gPD0gYW5kcm9pZC5vcy5CdWlsZC5WRVJTSU9OX0NPREVTLkpFTExZX0JFQU5fTVIxO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1c2VPbGRNZWFzdXJlU3BlYykge1xuICAgICAgICAgICAgcmV0dXJuIHNpemUgKyBtb2RlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoc2l6ZSAmIH5NT0RFX01BU0spIHwgKG1vZGUgJiBNT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXQubWFrZU1lYXN1cmVTcGVjID0gbWFrZU1lYXN1cmVTcGVjO1xuICAgIGZ1bmN0aW9uIGdldERpc3BsYXlEZW5zaXR5KCkge1xuICAgICAgICBpZiAoZGVuc2l0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkZW5zaXR5ID0gYWQuZ2V0UmVzb3VyY2VzKCkuZ2V0RGlzcGxheU1ldHJpY3MoKS5kZW5zaXR5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZW5zaXR5O1xuICAgIH1cbiAgICBsYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkgPSBnZXREaXNwbGF5RGVuc2l0eTtcbiAgICBmdW5jdGlvbiB0b0RldmljZVBpeGVscyh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgKiBnZXREaXNwbGF5RGVuc2l0eSgpO1xuICAgIH1cbiAgICBsYXlvdXQudG9EZXZpY2VQaXhlbHMgPSB0b0RldmljZVBpeGVscztcbiAgICBmdW5jdGlvbiB0b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAvIGdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgfVxuICAgIGxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzID0gdG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscztcbiAgICBmdW5jdGlvbiBtZWFzdXJlTmF0aXZlVmlldyhuYXRpdmVWaWV3LCB3aWR0aCwgd2lkdGhNb2RlLCBoZWlnaHQsIGhlaWdodE1vZGUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBuYXRpdmVWaWV3O1xuICAgICAgICB2aWV3Lm1lYXN1cmUobWFrZU1lYXN1cmVTcGVjKHdpZHRoLCB3aWR0aE1vZGUpLCBtYWtlTWVhc3VyZVNwZWMoaGVpZ2h0LCBoZWlnaHRNb2RlKSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogdmlldy5nZXRNZWFzdXJlZFdpZHRoKCksXG4gICAgICAgICAgICBoZWlnaHQ6IHZpZXcuZ2V0TWVhc3VyZWRIZWlnaHQoKVxuICAgICAgICB9O1xuICAgIH1cbiAgICBsYXlvdXQubWVhc3VyZU5hdGl2ZVZpZXcgPSBtZWFzdXJlTmF0aXZlVmlldztcbn0pKGxheW91dCA9IGV4cG9ydHMubGF5b3V0IHx8IChleHBvcnRzLmxheW91dCA9IHt9KSk7XG5PYmplY3QuYXNzaWduKGxheW91dCwgdXRpbHNfY29tbW9uXzEubGF5b3V0Q29tbW9uKTtcbnZhciBhZDtcbihmdW5jdGlvbiAoYWQpIHtcbiAgICB2YXIgYXBwbGljYXRpb247XG4gICAgdmFyIGFwcGxpY2F0aW9uQ29udGV4dDtcbiAgICB2YXIgY29udGV4dFJlc291cmNlcztcbiAgICB2YXIgcGFja2FnZU5hbWU7XG4gICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb25Db250ZXh0KCkge1xuICAgICAgICBpZiAoIWFwcGxpY2F0aW9uQ29udGV4dCkge1xuICAgICAgICAgICAgYXBwbGljYXRpb25Db250ZXh0ID0gZ2V0QXBwbGljYXRpb24oKS5nZXRBcHBsaWNhdGlvbkNvbnRleHQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXBwbGljYXRpb25Db250ZXh0O1xuICAgIH1cbiAgICBhZC5nZXRBcHBsaWNhdGlvbkNvbnRleHQgPSBnZXRBcHBsaWNhdGlvbkNvbnRleHQ7XG4gICAgZnVuY3Rpb24gZ2V0QXBwbGljYXRpb24oKSB7XG4gICAgICAgIGlmICghYXBwbGljYXRpb24pIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uID0gYXBwbGljYXRpb25fMS5nZXROYXRpdmVBcHBsaWNhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBsaWNhdGlvbjtcbiAgICB9XG4gICAgYWQuZ2V0QXBwbGljYXRpb24gPSBnZXRBcHBsaWNhdGlvbjtcbiAgICBmdW5jdGlvbiBnZXRSZXNvdXJjZXMoKSB7XG4gICAgICAgIGlmICghY29udGV4dFJlc291cmNlcykge1xuICAgICAgICAgICAgY29udGV4dFJlc291cmNlcyA9IGdldEFwcGxpY2F0aW9uKCkuZ2V0UmVzb3VyY2VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRleHRSZXNvdXJjZXM7XG4gICAgfVxuICAgIGFkLmdldFJlc291cmNlcyA9IGdldFJlc291cmNlcztcbiAgICBmdW5jdGlvbiBnZXRQYWNrYWdlTmFtZSgpIHtcbiAgICAgICAgaWYgKCFwYWNrYWdlTmFtZSkge1xuICAgICAgICAgICAgcGFja2FnZU5hbWUgPSBnZXRBcHBsaWNhdGlvbkNvbnRleHQoKS5nZXRQYWNrYWdlTmFtZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYWNrYWdlTmFtZTtcbiAgICB9XG4gICAgdmFyIGlucHV0TWV0aG9kTWFuYWdlcjtcbiAgICBmdW5jdGlvbiBnZXRJbnB1dE1ldGhvZE1hbmFnZXIoKSB7XG4gICAgICAgIGlmICghaW5wdXRNZXRob2RNYW5hZ2VyKSB7XG4gICAgICAgICAgICBpbnB1dE1ldGhvZE1hbmFnZXIgPSBnZXRBcHBsaWNhdGlvbkNvbnRleHQoKS5nZXRTeXN0ZW1TZXJ2aWNlKGFuZHJvaWQuY29udGVudC5Db250ZXh0LklOUFVUX01FVEhPRF9TRVJWSUNFKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5wdXRNZXRob2RNYW5hZ2VyO1xuICAgIH1cbiAgICBhZC5nZXRJbnB1dE1ldGhvZE1hbmFnZXIgPSBnZXRJbnB1dE1ldGhvZE1hbmFnZXI7XG4gICAgZnVuY3Rpb24gc2hvd1NvZnRJbnB1dChuYXRpdmVWaWV3KSB7XG4gICAgICAgIHZhciBpbnB1dE1hbmFnZXIgPSBnZXRJbnB1dE1ldGhvZE1hbmFnZXIoKTtcbiAgICAgICAgaWYgKGlucHV0TWFuYWdlciAmJiBuYXRpdmVWaWV3IGluc3RhbmNlb2YgYW5kcm9pZC52aWV3LlZpZXcpIHtcbiAgICAgICAgICAgIGlucHV0TWFuYWdlci5zaG93U29mdElucHV0KG5hdGl2ZVZpZXcsIGFuZHJvaWQudmlldy5pbnB1dG1ldGhvZC5JbnB1dE1ldGhvZE1hbmFnZXIuU0hPV19JTVBMSUNJVCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWQuc2hvd1NvZnRJbnB1dCA9IHNob3dTb2Z0SW5wdXQ7XG4gICAgZnVuY3Rpb24gZGlzbWlzc1NvZnRJbnB1dChuYXRpdmVWaWV3KSB7XG4gICAgICAgIHZhciBpbnB1dE1hbmFnZXIgPSBnZXRJbnB1dE1ldGhvZE1hbmFnZXIoKTtcbiAgICAgICAgdmFyIHdpbmRvd1Rva2VuO1xuICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIGFuZHJvaWQudmlldy5WaWV3KSB7XG4gICAgICAgICAgICB3aW5kb3dUb2tlbiA9IG5hdGl2ZVZpZXcuZ2V0V2luZG93VG9rZW4oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcHBsaWNhdGlvbl8xLmFuZHJvaWQuZm9yZWdyb3VuZEFjdGl2aXR5IGluc3RhbmNlb2YgYW5kcm9pZHguYXBwY29tcGF0LmFwcC5BcHBDb21wYXRBY3Rpdml0eSkge1xuICAgICAgICAgICAgdmFyIGRlY29yVmlldyA9IGFwcGxpY2F0aW9uXzEuYW5kcm9pZC5mb3JlZ3JvdW5kQWN0aXZpdHkuZ2V0V2luZG93KCkuZ2V0RGVjb3JWaWV3KCk7XG4gICAgICAgICAgICB3aW5kb3dUb2tlbiA9IGRlY29yVmlldyA/IGRlY29yVmlldy5nZXRXaW5kb3dUb2tlbigpIDogbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXRNYW5hZ2VyICYmIHdpbmRvd1Rva2VuKSB7XG4gICAgICAgICAgICBpbnB1dE1hbmFnZXIuaGlkZVNvZnRJbnB1dEZyb21XaW5kb3cod2luZG93VG9rZW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkLmRpc21pc3NTb2Z0SW5wdXQgPSBkaXNtaXNzU29mdElucHV0O1xuICAgIHZhciBjb2xsZWN0aW9ucztcbiAgICAoZnVuY3Rpb24gKGNvbGxlY3Rpb25zKSB7XG4gICAgICAgIGZ1bmN0aW9uIHN0cmluZ0FycmF5VG9TdHJpbmdTZXQoc3RyKSB7XG4gICAgICAgICAgICB2YXIgaGFzaFNldCA9IG5ldyBqYXZhLnV0aWwuSGFzaFNldCgpO1xuICAgICAgICAgICAgaWYgKHN0ciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZWxlbWVudCBpbiBzdHIpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFzaFNldC5hZGQoXCJcIiArIHN0cltlbGVtZW50XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGhhc2hTZXQ7XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbnMuc3RyaW5nQXJyYXlUb1N0cmluZ1NldCA9IHN0cmluZ0FycmF5VG9TdHJpbmdTZXQ7XG4gICAgICAgIGZ1bmN0aW9uIHN0cmluZ1NldFRvU3RyaW5nQXJyYXkoc3RyaW5nU2V0KSB7XG4gICAgICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgICAgICBpZiAoc3RyaW5nU2V0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgaXRfMSA9IHN0cmluZ1NldC5pdGVyYXRvcigpO1xuICAgICAgICAgICAgICAgIHdoaWxlIChpdF8xLmhhc05leHQoKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IFwiXCIgKyBpdF8xLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFycjtcbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9ucy5zdHJpbmdTZXRUb1N0cmluZ0FycmF5ID0gc3RyaW5nU2V0VG9TdHJpbmdBcnJheTtcbiAgICB9KShjb2xsZWN0aW9ucyA9IGFkLmNvbGxlY3Rpb25zIHx8IChhZC5jb2xsZWN0aW9ucyA9IHt9KSk7XG4gICAgdmFyIHJlc291cmNlcztcbiAgICAoZnVuY3Rpb24gKHJlc291cmNlc18xKSB7XG4gICAgICAgIHZhciBhdHRyO1xuICAgICAgICB2YXIgYXR0ckNhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICBmdW5jdGlvbiBnZXREcmF3YWJsZUlkKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRJZChcIjpkcmF3YWJsZS9cIiArIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJlc291cmNlc18xLmdldERyYXdhYmxlSWQgPSBnZXREcmF3YWJsZUlkO1xuICAgICAgICBmdW5jdGlvbiBnZXRTdHJpbmdJZChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0SWQoXCI6c3RyaW5nL1wiICsgbmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb3VyY2VzXzEuZ2V0U3RyaW5nSWQgPSBnZXRTdHJpbmdJZDtcbiAgICAgICAgZnVuY3Rpb24gZ2V0SWQobmFtZSkge1xuICAgICAgICAgICAgdmFyIHJlc291cmNlcyA9IGdldFJlc291cmNlcygpO1xuICAgICAgICAgICAgdmFyIHBhY2thZ2VOYW1lID0gZ2V0UGFja2FnZU5hbWUoKTtcbiAgICAgICAgICAgIHZhciB1cmkgPSBwYWNrYWdlTmFtZSArIG5hbWU7XG4gICAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzLmdldElkZW50aWZpZXIodXJpLCBudWxsLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXNvdXJjZXNfMS5nZXRJZCA9IGdldElkO1xuICAgICAgICBmdW5jdGlvbiBnZXRQYWxsZXRlQ29sb3IobmFtZSwgY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFBhbGV0dGVDb2xvcihuYW1lLCBjb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXNvdXJjZXNfMS5nZXRQYWxsZXRlQ29sb3IgPSBnZXRQYWxsZXRlQ29sb3I7XG4gICAgICAgIGZ1bmN0aW9uIGdldFBhbGV0dGVDb2xvcihuYW1lLCBjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAoYXR0ckNhY2hlLmhhcyhuYW1lKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhdHRyQ2FjaGUuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICghYXR0cikge1xuICAgICAgICAgICAgICAgICAgICBhdHRyID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoXCJhbmRyb2lkeC5hcHBjb21wYXQuUiRhdHRyXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29sb3JJRCA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gYXR0ci5nZXRGaWVsZChuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3JJRCA9IGZpZWxkLmdldEludChudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNvbG9ySUQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVkVmFsdWUgPSBuZXcgYW5kcm9pZC51dGlsLlR5cGVkVmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5nZXRUaGVtZSgpLnJlc29sdmVBdHRyaWJ1dGUoY29sb3JJRCwgdHlwZWRWYWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHR5cGVkVmFsdWUuZGF0YTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ2Fubm90IGdldCBwYWxsZXRlIGNvbG9yOiBcIiArIG5hbWUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhdHRyQ2FjaGUuc2V0KG5hbWUsIHJlc3VsdCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHJlc291cmNlc18xLmdldFBhbGV0dGVDb2xvciA9IGdldFBhbGV0dGVDb2xvcjtcbiAgICB9KShyZXNvdXJjZXMgPSBhZC5yZXNvdXJjZXMgfHwgKGFkLnJlc291cmNlcyA9IHt9KSk7XG59KShhZCA9IGV4cG9ydHMuYWQgfHwgKGV4cG9ydHMuYWQgPSB7fSkpO1xuZnVuY3Rpb24gR0MoKSB7XG4gICAgZ2MoKTtcbn1cbmV4cG9ydHMuR0MgPSBHQztcbmZ1bmN0aW9uIHJlbGVhc2VOYXRpdmVPYmplY3Qob2JqZWN0KSB7XG4gICAgX19yZWxlYXNlTmF0aXZlQ291bnRlcnBhcnQob2JqZWN0KTtcbn1cbmV4cG9ydHMucmVsZWFzZU5hdGl2ZU9iamVjdCA9IHJlbGVhc2VOYXRpdmVPYmplY3Q7XG5mdW5jdGlvbiBvcGVuVXJsKGxvY2F0aW9uKSB7XG4gICAgdmFyIGNvbnRleHQgPSBhZC5nZXRBcHBsaWNhdGlvbkNvbnRleHQoKTtcbiAgICB0cnkge1xuICAgICAgICB2YXIgaW50ZW50ID0gbmV3IGFuZHJvaWQuY29udGVudC5JbnRlbnQoYW5kcm9pZC5jb250ZW50LkludGVudC5BQ1RJT05fVklFVywgYW5kcm9pZC5uZXQuVXJpLnBhcnNlKGxvY2F0aW9uLnRyaW0oKSkpO1xuICAgICAgICBpbnRlbnQuYWRkRmxhZ3MoYW5kcm9pZC5jb250ZW50LkludGVudC5GTEFHX0FDVElWSVRZX05FV19UQVNLKTtcbiAgICAgICAgY29udGV4dC5zdGFydEFjdGl2aXR5KGludGVudCk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJFcnJvciBpbiBPcGVuVVJMXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5leHBvcnRzLm9wZW5VcmwgPSBvcGVuVXJsO1xuZnVuY3Rpb24gaXNFeHRlcm5hbFN0b3JhZ2VSZWFkT25seSgpIHtcbiAgICB2YXIgZXh0U3RvcmFnZVN0YXRlID0gYW5kcm9pZC5vcy5FbnZpcm9ubWVudC5nZXRFeHRlcm5hbFN0b3JhZ2VTdGF0ZSgpO1xuICAgIGlmIChhbmRyb2lkLm9zLkVudmlyb25tZW50Lk1FRElBX01PVU5URURfUkVBRF9PTkxZID09PSBleHRTdG9yYWdlU3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzRXh0ZXJuYWxTdG9yYWdlQXZhaWxhYmxlKCkge1xuICAgIHZhciBleHRTdG9yYWdlU3RhdGUgPSBhbmRyb2lkLm9zLkVudmlyb25tZW50LmdldEV4dGVybmFsU3RvcmFnZVN0YXRlKCk7XG4gICAgaWYgKGFuZHJvaWQub3MuRW52aXJvbm1lbnQuTUVESUFfTU9VTlRFRCA9PT0gZXh0U3RvcmFnZVN0YXRlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBnZXRNaW1lVHlwZU5hbWVGcm9tRXh0ZW5zaW9uKGZpbGVQYXRoKSB7XG4gICAgdmFyIG1pbWVUeXBlTWFwID0gYW5kcm9pZC53ZWJraXQuTWltZVR5cGVNYXAuZ2V0U2luZ2xldG9uKCk7XG4gICAgdmFyIGV4dGVuc2lvbiA9IG5ldyBmaWxlX3N5c3RlbV9hY2Nlc3NfMS5GaWxlU3lzdGVtQWNjZXNzKClcbiAgICAgICAgLmdldEZpbGVFeHRlbnNpb24oZmlsZVBhdGgpXG4gICAgICAgIC5yZXBsYWNlKFwiLlwiLCBcIlwiKVxuICAgICAgICAudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gbWltZVR5cGVNYXAuZ2V0TWltZVR5cGVGcm9tRXh0ZW5zaW9uKGV4dGVuc2lvbik7XG59XG5mdW5jdGlvbiBvcGVuRmlsZShmaWxlUGF0aCkge1xuICAgIHZhciBjb250ZXh0ID0gYWQuZ2V0QXBwbGljYXRpb25Db250ZXh0KCk7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKCFpc0V4dGVybmFsU3RvcmFnZUF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiXFxuRXh0ZXJuYWwgc3RvcmFnZSBpcyB1bmF2YWlsYWJsZSAocGxlYXNlIGNoZWNrIGFwcCBwZXJtaXNzaW9ucykuXFxuQXBwbGljYXRpb25zIGNhbm5vdCBhY2Nlc3MgaW50ZXJuYWwgc3RvcmFnZSBvZiBvdGhlciBhcHBsaWNhdGlvbiBvbiBBbmRyb2lkIChzZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL2d1aWRlL3RvcGljcy9kYXRhL2RhdGEtc3RvcmFnZSkuXFxuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRXh0ZXJuYWxTdG9yYWdlUmVhZE9ubHkoKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkV4dGVybmFsIHN0b3JhZ2UgaXMgcmVhZCBvbmx5XCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1pbWVUeXBlID0gZ2V0TWltZVR5cGVOYW1lRnJvbUV4dGVuc2lvbihmaWxlUGF0aCk7XG4gICAgICAgIHZhciBpbnRlbnQgPSBuZXcgYW5kcm9pZC5jb250ZW50LkludGVudChhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkFDVElPTl9WSUVXKTtcbiAgICAgICAgdmFyIGNob29zZXJJbnRlbnQgPSBhbmRyb2lkLmNvbnRlbnQuSW50ZW50LmNyZWF0ZUNob29zZXIoaW50ZW50LCBcIk9wZW4gRmlsZS4uLlwiKTtcbiAgICAgICAgaW50ZW50LmFkZEZsYWdzKGFuZHJvaWQuY29udGVudC5JbnRlbnQuRkxBR19BQ1RJVklUWV9ORVdfVEFTSyk7XG4gICAgICAgIGNob29zZXJJbnRlbnQuYWRkRmxhZ3MoYW5kcm9pZC5jb250ZW50LkludGVudC5GTEFHX0FDVElWSVRZX05FV19UQVNLKTtcbiAgICAgICAgdmFyIHNka1ZlcnNpb24gPSBwYXJzZUludChwbGF0Zm9ybV8xLmRldmljZS5zZGtWZXJzaW9uLCAxMCk7XG4gICAgICAgIGlmIChzZGtWZXJzaW9uICYmIHNka1ZlcnNpb24gPCBNSU5fVVJJX1NIQVJFX1JFU1RSSUNURURfQVBLX1ZFUlNJT04pIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJkZXRlY3RlZCBzZGsgdmVyc2lvbiBcIiArIHNka1ZlcnNpb24gKyBcIiAoPCBcIiArIE1JTl9VUklfU0hBUkVfUkVTVFJJQ1RFRF9BUEtfVkVSU0lPTiArIFwiKSwgdXNpbmcgc2ltcGxlIG9wZW5GaWxlXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICBpbnRlbnQuc2V0RGF0YUFuZFR5cGUoYW5kcm9pZC5uZXQuVXJpLmZyb21GaWxlKG5ldyBqYXZhLmlvLkZpbGUoZmlsZVBhdGgpKSwgbWltZVR5cGUpO1xuICAgICAgICAgICAgY29udGV4dC5zdGFydEFjdGl2aXR5KGNob29zZXJJbnRlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdHJhY2VfMS53cml0ZShcImRldGVjdGVkIHNkayB2ZXJzaW9uIFwiICsgc2RrVmVyc2lvbiArIFwiICg+PSBcIiArIE1JTl9VUklfU0hBUkVfUkVTVFJJQ1RFRF9BUEtfVkVSU0lPTiArIFwiKSwgdXNpbmcgVVJJIG9wZW5GaWxlXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgIHZhciBwcm92aWRlck5hbWUgPSBjb250ZXh0LmdldFBhY2thZ2VOYW1lKCkgKyBcIi5wcm92aWRlclwiO1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiZnVsbHktcXVhbGlmaWVkIHByb3ZpZGVyIG5hbWUgW1wiICsgcHJvdmlkZXJOYW1lICsgXCJdXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgIHZhciBhcGtVUkkgPSBhbmRyb2lkeC5jb3JlLmNvbnRlbnQuRmlsZVByb3ZpZGVyLmdldFVyaUZvckZpbGUoY29udGV4dCwgcHJvdmlkZXJOYW1lLCBuZXcgamF2YS5pby5GaWxlKGZpbGVQYXRoKSk7XG4gICAgICAgIGludGVudC5hZGRGbGFncyhhbmRyb2lkLmNvbnRlbnQuSW50ZW50LkZMQUdfR1JBTlRfUkVBRF9VUklfUEVSTUlTU0lPTik7XG4gICAgICAgIGNob29zZXJJbnRlbnQuYWRkRmxhZ3MoYW5kcm9pZC5jb250ZW50LkludGVudC5GTEFHX0dSQU5UX1JFQURfVVJJX1BFUk1JU1NJT04pO1xuICAgICAgICBpbnRlbnQuc2V0RGF0YUFuZFR5cGUoYXBrVVJJLCBtaW1lVHlwZSk7XG4gICAgICAgIGNvbnRleHQuc3RhcnRBY3Rpdml0eShjaG9vc2VySW50ZW50KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgdmFyIG1zZ18xID0gZXJyLm1lc3NhZ2UgPyBcIjogXCIgKyBlcnIubWVzc2FnZSA6IFwiXCI7XG4gICAgICAgIHRyYWNlXzEud3JpdGUoXCJFcnJvciBpbiBvcGVuRmlsZVwiICsgbXNnXzEsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIGlmIChtc2dfMSAmJlxuICAgICAgICAgICAgbXNnXzEuaW5jbHVkZXMoXCJBdHRlbXB0IHRvIGludm9rZSB2aXJ0dWFsIG1ldGhvZFwiKSAmJlxuICAgICAgICAgICAgbXNnXzEuaW5jbHVkZXMoXCJhbmRyb2lkLmNvbnRlbnQucG0uUHJvdmlkZXJJbmZvLmxvYWRYbWxNZXRhRGF0YVwiKSAmJlxuICAgICAgICAgICAgbXNnXzEuaW5jbHVkZXMoXCJvbiBhIG51bGwgb2JqZWN0IHJlZmVyZW5jZVwiKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlxcblBsZWFzZSBlbnN1cmUgeW91IGhhdmUgeW91ciBtYW5pZmVzdCBjb3JyZWN0bHkgY29uZmlndXJlZCB3aXRoIHRoZSBGaWxlUHJvdmlkZXIuXFxuKHNlZTogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2FuZHJvaWQvc3VwcG9ydC92NC9jb250ZW50L0ZpbGVQcm92aWRlciNQcm92aWRlckRlZmluaXRpb24pXFxuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cbmV4cG9ydHMub3BlbkZpbGUgPSBvcGVuRmlsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmFuZHJvaWQuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGh0dHAgPSByZXF1aXJlKFwiLi4vaHR0cFwiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi91dGlscy90eXBlc1wiKTtcbnZhciBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZTtcbihmdW5jdGlvbiAoWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUpIHtcbiAgICBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS5lbXB0eSA9IFwiXCI7XG4gICAgWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUudGV4dCA9IFwidGV4dFwiO1xuICAgIFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLmpzb24gPSBcImpzb25cIjtcbn0pKFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlIHx8IChYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZSA9IHt9KSk7XG52YXIgWE1MSHR0cFJlcXVlc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFhNTEh0dHBSZXF1ZXN0KCkge1xuICAgICAgICB0aGlzLlVOU0VOVCA9IDA7XG4gICAgICAgIHRoaXMuT1BFTkVEID0gMTtcbiAgICAgICAgdGhpcy5IRUFERVJTX1JFQ0VJVkVEID0gMjtcbiAgICAgICAgdGhpcy5MT0FESU5HID0gMztcbiAgICAgICAgdGhpcy5ET05FID0gNDtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUeXBlID0gXCJcIjtcbiAgICAgICAgdGhpcy50ZXh0VHlwZXMgPSBbXG4gICAgICAgICAgICBcInRleHQvcGxhaW5cIixcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24veG1sXCIsXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL3Jzcyt4bWxcIixcbiAgICAgICAgICAgIFwidGV4dC9odG1sXCIsXG4gICAgICAgICAgICBcInRleHQveG1sXCJcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdGhpcy5VTlNFTlQ7XG4gICAgfVxuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzc3dvcmQpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKG1ldGhvZCkgJiYgdHlwZXMuaXNTdHJpbmcodXJsKSkge1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHsgdXJsOiB1cmwsIG1ldGhvZDogbWV0aG9kIH07XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zLmhlYWRlcnMgPSB7fTtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyh1c2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuaGVhZGVyc1tcInVzZXJcIl0gPSB1c2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKHBhc3N3b3JkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuaGVhZGVyc1tcInBhc3N3b3JkXCJdID0gcGFzc3dvcmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuT1BFTkVEKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9lcnJvckZsYWcgPSB0cnVlO1xuICAgICAgICB0aGlzLl9yZXNwb25zZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlVGV4dFJlYWRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5VTlNFTlQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5PUEVORUQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdGhpcy5VTlNFTlQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuRE9ORSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fZXJyb3JGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IG51bGw7XG4gICAgICAgIGlmICh0eXBlcy5pc0RlZmluZWQodGhpcy5fb3B0aW9ucykpIHtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhkYXRhKSAmJiB0aGlzLl9vcHRpb25zLm1ldGhvZCAhPT0gXCJHRVRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuY29udGVudCA9IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vcHRpb25zLmNvbnRlbnQgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBodHRwLnJlcXVlc3QodGhpcy5fb3B0aW9ucykudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuX2Vycm9yRmxhZykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZFJlc3BvbnNlKHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2Vycm9yRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3RoaXMuX3NldFJlYWR5U3RhdGUoX3RoaXMuRE9ORSwgZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9sb2FkUmVzcG9uc2UgPSBmdW5jdGlvbiAocikge1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSByLnN0YXR1c0NvZGU7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gci5jb250ZW50LnJhdyArIFwiXCI7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSByLmhlYWRlcnM7XG4gICAgICAgIHRoaXMuX3NldFJlYWR5U3RhdGUodGhpcy5IRUFERVJTX1JFQ0VJVkVEKTtcbiAgICAgICAgdGhpcy5fc2V0UmVhZHlTdGF0ZSh0aGlzLkxPQURJTkcpO1xuICAgICAgICB0aGlzLl9zZXRSZXNwb25zZVR5cGUoKTtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gci5jb250ZW50LnRvU3RyaW5nKCk7IH07XG4gICAgICAgIHRoaXMuX2FkZFRvU3RyaW5nT25SZXNwb25zZSgpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZVR5cGUgPT09IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLmpzb24pIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXNwb25zZVR5cGUgPT09IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0UmVhZHlTdGF0ZSh0aGlzLkRPTkUpO1xuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9hZGRUb1N0cmluZ09uUmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlcy5pc09iamVjdCh0aGlzLnJlc3BvbnNlKSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuX3Jlc3BvbnNlLCBcInRvU3RyaW5nXCIsIHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlc3BvbnNlVGV4dDsgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5pc1RleHRDb250ZW50VHlwZSA9IGZ1bmN0aW9uIChjb250ZW50VHlwZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50ZXh0VHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50VHlwZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGhpcy50ZXh0VHlwZXNbaV0pID49IDApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuX3NldFJlc3BvbnNlVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7XG4gICAgICAgIHZhciBjb250ZW50VHlwZSA9IGhlYWRlciAmJiBoZWFkZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlKSB7XG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGUuaW5kZXhPZihcImFwcGxpY2F0aW9uL2pzb25cIikgPj0gMCB8fCBjb250ZW50VHlwZS5pbmRleE9mKFwiK2pzb25cIikgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUeXBlID0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuanNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNUZXh0Q29udGVudFR5cGUoY29udGVudFR5cGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS50ZXh0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGhhbmRsZXIpIHtcbiAgICAgICAgaWYgKGV2ZW50TmFtZSAhPT0gXCJsb2FkXCIgJiYgZXZlbnROYW1lICE9PSBcImVycm9yXCIgJiYgZXZlbnROYW1lICE9PSBcInByb2dyZXNzXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV2ZW50IG5vdCBzdXBwb3J0ZWQ6IFwiICsgZXZlbnROYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGFuZGxlcnMgPSB0aGlzLl9saXN0ZW5lcnMuZ2V0KGV2ZW50TmFtZSkgfHwgW107XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2xpc3RlbmVycy5zZXQoZXZlbnROYW1lLCBoYW5kbGVycyk7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIHRvRGV0YWNoKSB7XG4gICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuX2xpc3RlbmVycy5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICAgICAgaGFuZGxlcnMgPSBoYW5kbGVycy5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHsgcmV0dXJuIGhhbmRsZXIgIT09IHRvRGV0YWNoOyB9KTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzLnNldChldmVudE5hbWUsIGhhbmRsZXJzKTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5lbWl0RXZlbnQgPSBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuX2xpc3RlbmVycy5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICAgICAgaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikge1xuICAgICAgICAgICAgaGFuZGxlci5hcHBseSh2b2lkIDAsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZXRSZXF1ZXN0SGVhZGVyID0gZnVuY3Rpb24gKGhlYWRlciwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzRGVmaW5lZCh0aGlzLl9vcHRpb25zKSAmJiB0eXBlcy5pc1N0cmluZyhoZWFkZXIpICYmIHR5cGVzLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzW2hlYWRlcl0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmdldEFsbFJlc3BvbnNlSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5U3RhdGUgPCAyIHx8IHRoaXMuX2Vycm9yRmxhZykge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5faGVhZGVycykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IGkgKyBcIjogXCIgKyB0aGlzLl9oZWFkZXJzW2ldICsgXCJcXHJcXG5cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0LnN1YnN0cigwLCByZXN1bHQubGVuZ3RoIC0gMik7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VIZWFkZXIgPSBmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhoZWFkZXIpICYmIHRoaXMuX3JlYWR5U3RhdGUgPiAxXG4gICAgICAgICAgICAmJiB0aGlzLl9oZWFkZXJzXG4gICAgICAgICAgICAmJiAhdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICBoZWFkZXIgPSBoZWFkZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5faGVhZGVycykge1xuICAgICAgICAgICAgICAgIGlmIChpLnRvTG93ZXJDYXNlKCkgPT09IGhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3ZlcnJpZGVNaW1lVHlwZSA9IGZ1bmN0aW9uIChtaW1lKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlYWR5U3RhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkeVN0YXRlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlc3BvbnNlVHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNlVHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuZW1wdHkgfHwgdmFsdWUgaW4gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXNwb25zZVR5cGUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlc3BvbnNlIHR5cGUgb2YgJ1wiICsgdmFsdWUgKyBcIicgbm90IHN1cHBvcnRlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5fc2V0UmVhZHlTdGF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5U3RhdGUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNGdW5jdGlvbih0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9lcnJvckZsYWcpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZXMuaXNGdW5jdGlvbih0aGlzLm9uZXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KFwiZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVzLmlzRnVuY3Rpb24odGhpcy5vbmxvYWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KFwibG9hZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXNwb25zZVRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc0Z1bmN0aW9uKHRoaXMuX3Jlc3BvbnNlVGV4dFJlYWRlcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXNwb25zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInN0YXR1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJzdGF0dXNUZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5VTlNFTlQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5PUEVORUQgfHwgdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RhdHVzZXNbdGhpcy5fc3RhdHVzXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFhNTEh0dHBSZXF1ZXN0O1xufSgpKTtcbmV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdDtcbnZhciBzdGF0dXNlcyA9IHtcbiAgICAxMDA6IFwiQ29udGludWVcIixcbiAgICAxMDE6IFwiU3dpdGNoaW5nIFByb3RvY29sc1wiLFxuICAgIDIwMDogXCJPS1wiLFxuICAgIDIwMTogXCJDcmVhdGVkXCIsXG4gICAgMjAyOiBcIkFjY2VwdGVkXCIsXG4gICAgMjAzOiBcIk5vbiAtIEF1dGhvcml0YXRpdmUgSW5mb3JtYXRpb25cIixcbiAgICAyMDQ6IFwiTm8gQ29udGVudFwiLFxuICAgIDIwNTogXCJSZXNldCBDb250ZW50XCIsXG4gICAgMjA2OiBcIlBhcnRpYWwgQ29udGVudFwiLFxuICAgIDMwMDogXCJNdWx0aXBsZSBDaG9pY2VzXCIsXG4gICAgMzAxOiBcIk1vdmVkIFBlcm1hbmVudGx5XCIsXG4gICAgMzAyOiBcIkZvdW5kXCIsXG4gICAgMzAzOiBcIlNlZSBPdGhlclwiLFxuICAgIDMwNDogXCJOb3QgTW9kaWZpZWRcIixcbiAgICAzMDU6IFwiVXNlIFByb3h5XCIsXG4gICAgMzA3OiBcIlRlbXBvcmFyeSBSZWRpcmVjdFwiLFxuICAgIDQwMDogXCJCYWQgUmVxdWVzdFwiLFxuICAgIDQwMTogXCJVbmF1dGhvcml6ZWRcIixcbiAgICA0MDI6IFwiUGF5bWVudCBSZXF1aXJlZFwiLFxuICAgIDQwMzogXCJGb3JiaWRkZW5cIixcbiAgICA0MDQ6IFwiTm90IEZvdW5kXCIsXG4gICAgNDA1OiBcIk1ldGhvZCBOb3QgQWxsb3dlZFwiLFxuICAgIDQwNjogXCJOb3QgQWNjZXB0YWJsZVwiLFxuICAgIDQwNzogXCJQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZFwiLFxuICAgIDQwODogXCJSZXF1ZXN0IFRpbWVvdXRcIixcbiAgICA0MDk6IFwiQ29uZmxpY3RcIixcbiAgICA0MTA6IFwiR29uZVwiLFxuICAgIDQxMTogXCJMZW5ndGggUmVxdWlyZWRcIixcbiAgICA0MTI6IFwiUHJlY29uZGl0aW9uIEZhaWxlZFwiLFxuICAgIDQxMzogXCJSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2VcIixcbiAgICA0MTQ6IFwiUmVxdWVzdCAtIFVSSSBUb28gTG9uZ1wiLFxuICAgIDQxNTogXCJVbnN1cHBvcnRlZCBNZWRpYSBUeXBlXCIsXG4gICAgNDE2OiBcIlJlcXVlc3RlZCBSYW5nZSBOb3QgU2F0aXNmaWFibGVcIixcbiAgICA0MTc6IFwiRXhwZWN0YXRpb24gRmFpbGVkXCIsXG4gICAgNTAwOiBcIkludGVybmFsIFNlcnZlciBFcnJvclwiLFxuICAgIDUwMTogXCJOb3QgSW1wbGVtZW50ZWRcIixcbiAgICA1MDI6IFwiQmFkIEdhdGV3YXlcIixcbiAgICA1MDM6IFwiU2VydmljZSBVbmF2YWlsYWJsZVwiLFxuICAgIDUwNDogXCJHYXRld2F5IFRpbWVvdXRcIixcbiAgICA1MDU6IFwiSFRUUCBWZXJzaW9uIE5vdCBTdXBwb3J0ZWRcIlxufTtcbnZhciBGb3JtRGF0YSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRm9ybURhdGEoKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIEZvcm1EYXRhLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZGF0YS5zZXQobmFtZSwgdmFsdWUpO1xuICAgIH07XG4gICAgRm9ybURhdGEucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJyID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2RhdGEuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUsIG1hcCkge1xuICAgICAgICAgICAgYXJyLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcnIuam9pbihcIiZcIik7XG4gICAgfTtcbiAgICByZXR1cm4gRm9ybURhdGE7XG59KCkpO1xuZXhwb3J0cy5Gb3JtRGF0YSA9IEZvcm1EYXRhO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9eGhyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlYXN5c2F4ID0gcmVxdWlyZShcIi4uL2pzLWxpYnMvZWFzeXNheFwiKTtcbnZhciBQYXJzZXJFdmVudFR5cGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcnNlckV2ZW50VHlwZSgpIHtcbiAgICB9XG4gICAgUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCA9IFwiU3RhcnRFbGVtZW50XCI7XG4gICAgUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQgPSBcIkVuZEVsZW1lbnRcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuVGV4dCA9IFwiVGV4dFwiO1xuICAgIFBhcnNlckV2ZW50VHlwZS5DREFUQSA9IFwiQ0RBVEFcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuQ29tbWVudCA9IFwiQ29tbWVudFwiO1xuICAgIHJldHVybiBQYXJzZXJFdmVudFR5cGU7XG59KCkpO1xuZXhwb3J0cy5QYXJzZXJFdmVudFR5cGUgPSBQYXJzZXJFdmVudFR5cGU7XG52YXIgUGFyc2VyRXZlbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcnNlckV2ZW50KGV2ZW50VHlwZSwgcG9zaXRpb24sIHByZWZpeCwgbmFtZXNwYWNlLCBlbGVtZW50TmFtZSwgYXR0cmlidXRlcywgZGF0YSkge1xuICAgICAgICB0aGlzLl9ldmVudFR5cGUgPSBldmVudFR5cGU7XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgIHRoaXMuX3ByZWZpeCA9IHByZWZpeDtcbiAgICAgICAgdGhpcy5fbmFtZXNwYWNlID0gbmFtZXNwYWNlO1xuICAgICAgICB0aGlzLl9lbGVtZW50TmFtZSA9IGVsZW1lbnROYW1lO1xuICAgICAgICB0aGlzLl9hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgfVxuICAgIFBhcnNlckV2ZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGV2ZW50VHlwZTogdGhpcy5ldmVudFR5cGUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdGhpcy5wb3NpdGlvbixcbiAgICAgICAgICAgIHByZWZpeDogdGhpcy5wcmVmaXgsXG4gICAgICAgICAgICBuYW1lc3BhY2U6IHRoaXMubmFtZXNwYWNlLFxuICAgICAgICAgICAgZWxlbWVudE5hbWU6IHRoaXMuZWxlbWVudE5hbWUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0aGlzLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBkYXRhOiB0aGlzLmRhdGFcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcImV2ZW50VHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50VHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJwb3NpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcInByZWZpeFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ByZWZpeDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJuYW1lc3BhY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lc3BhY2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwiZWxlbWVudE5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50TmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJhdHRyaWJ1dGVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cmlidXRlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJkYXRhXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFBhcnNlckV2ZW50O1xufSgpKTtcbmV4cG9ydHMuUGFyc2VyRXZlbnQgPSBQYXJzZXJFdmVudDtcbnZhciBfYW1wQ29kZXM7XG52YXIgX2VudGl0eVNlYXJjaFJlZ0V4ID0gLyYjKFxcZCspO3wmI3goWzAxMjM0NTY3ODlhYmNkZWZdKyk7fCYoXFx3Kyk7L2lnO1xuZnVuY3Rpb24gX2dlbmVyYXRlQW1wTWFwKCkge1xuICAgIHZhciBvYmpDb2RlcyA9IHsgVGFiOiA5LCBOZXdMaW5lOiAxMCwgZXhjbDogMzMsIHF1b3Q6IDM0LCBRVU9UOiAzNCwgbnVtOiAzNSwgZG9sbGFyOiAzNiwgcGVyY2VudDogMzcsIGFtcDogMzgsIEFNUDogMzgsIGFwb3M6IDM5LCBscGFyOiA0MCwgcnBhcjogNDEsIGFzdDogNDIsIG1pZGFzdDogNDIsIHBsdXM6IDQzLCBjb21tYTogNDQsIHBlcmlvZDogNDYsIHNvbDogNDcsIGNvbG9uOiA1OCwgc2VtaTogNTksIGx0OiA2MCwgTFQ6IDYwLCBlcXVhbHM6IDYxLCBndDogNjIsIEdUOiA2MiwgcXVlc3Q6IDYzLCBjb21tYXQ6IDY0LCBsc3FiOiA5MSwgbGJyYWNrOiA5MSwgYnNvbDogOTIsIHJzcWI6IDkyLCByYnJhY2s6IDkyLCBIYXQ6IDk0LCBsb3diYXI6IDk1LCBncmF2ZTogOTYsIERpYWNyaXRpY2FsR3JhdmU6IDk2LCBsY3ViOiAxMjMsIGxicmFjZTogMTIzLCB2ZXJiYXI6IDEyNCwgdmVydDogMTI0LCBWZXJ0aWNhbExpbmU6IDEyNCwgcmN1YjogMTI1LCByYnJhY2U6IDEyNSwgbmJzcDogMTYwLCBpZXhjbDogMTYxLCBjZW50OiAxNjIsIHBvdW5kOiAxNjMsIGN1cnJlbjogMTY0LCB5ZW46IDE2NSwgYnJ2YmFyOiAxNjYsIGJya2JhcjogMTY2LCBzZWN0OiAxNjcsIHVtbDogMTY4LCBjb3B5OiAxNjksIG9yZGY6IDE3MCwgbGFxdW86IDE3MSwgbm90OiAxNzIsIHNoeTogMTczLCByZWc6IDE3NCwgbWFjcjogMTc1LCBoaWJhcjogMTc1LCBkZWc6IDE3NiwgcGx1c21uOiAxNzcsIHN1cDI6IDE3OCwgc3VwMzogMTc5LCBhY3V0ZTogMTgwLCBtaWNybzogMTgxLCBwYXJhOiAxODIsIG1pZGRvdDogMTgzLCBjZWRpbDogMTg0LCBzdXAxOiAxODUsIG9yZG06IDE4NiwgcmFxdW86IDE4NywgZnJhYzE0OiAxODgsIGZyYWMxMjogMTg5LCBmcmFjMzQ6IDE5MCwgaXF1ZXN0OiAxOTEsIEFncmF2ZTogMTkyLCBBYWN1dGU6IDE5MywgQWNpcmM6IDE5NCwgQXRpbGRlOiAxOTUsIEF1bWw6IDE5NiwgQXJpbmc6IDE5NywgQUVsaWc6IDE5OCwgQ2NlZGlsOiAxOTksIEVncmF2ZTogMjAwLCBFYWN1dGU6IDIwMSwgRWNpcmM6IDIwMiwgRXVtbDogMjAzLCBJZ3JhdmU6IDIwNCwgSWFjdXRlOiAyMDUsIEljaXJjOiAyMDYsIEl1bWw6IDIwNywgRVRIOiAyMDgsIERzdHJvazogMjA4LCBOdGlsZGU6IDIwOSwgT2dyYXZlOiAyMTAsIE9hY3V0ZTogMjExLCBPY2lyYzogMjEyLCBPdGlsZGU6IDIxMywgT3VtbDogMjE0LCB0aW1lczogMjE1LCBPc2xhc2g6IDIxNiwgVWdyYXZlOiAyMTcsIFVhY3V0ZTogMjE4LCBVY2lyYzogMjE5LCBVdW1sOiAyMjAsIFlhY3V0ZTogMjIxLCBUSE9STjogMjIyLCBzemxpZzogMjIzLCBhZ3JhdmU6IDIyNCwgYWFjdXRlOiAyMjUsIGFjaXJjOiAyMjYsIGF0aWxkZTogMjI3LCBhdW1sOiAyMjgsIGFyaW5nOiAyMjksIGFlbGlnOiAyMzAsIGNjZWRpbDogMjMxLCBlZ3JhdmU6IDIzMiwgZWFjdXRlOiAyMzMsIGVjaXJjOiAyMzQsIGV1bWw6IDIzNSwgaWdyYXZlOiAyMzYsIGlhY3V0ZTogMjM3LCBpY2lyYzogMjM4LCBpdW1sOiAyMzksIGV0aDogMjQwLCBudGlsZGU6IDI0MSwgb2dyYXZlOiAyNDIsIG9hY3V0ZTogMjQzLCBvY2lyYzogMjQ0LCBvdGlsZGU6IDI0NSwgb3VtbDogMjQ2LCBkaXZpZGU6IDI0Nywgb3NsYXNoOiAyNDgsIHVncmF2ZTogMjQ5LCB1YWN1dGU6IDI1MCwgdWNpcmM6IDI1MSwgdXVtbDogMjUyLCB5YWN1dGU6IDI1MywgdGhvcm46IDI1NCwgeXVtbDogMjU1LCBmbm9mOiA0MDIsIGltcGVkOiA0MzcsIGdhY3V0ZTogNTAxLCBqbWF0aDogNTY3LCBjaXJjOiA3MTAsIGNhcm9uOiA3MTEsIEhhY2VrOiA3MTEsIGJyZXZlOiA3MjgsIEJyZXZlOiA3MjgsIGRvdDogNzI5LCBEaWFjcml0aWNhbERvdDogNzI5LCByaW5nOiA3MzAsIG9nb246IDczMSwgdGlsZGU6IDczMiwgRGlhY3JpdGljYWxUaWxkZTogNzMyLCBkYmxhYzogNzMzLCBEaWFjcml0aWNhbERvdWJsZUFjdXRlOiA3MzMsIERvd25CcmV2ZTogNzg1LCBVbmRlckJhcjogODE4LCBBbHBoYTogOTEzLCBCZXRhOiA5MTQsIEdhbW1hOiA5MTUsIERlbHRhOiA5MTYsIEVwc2lsb246IDkxNywgWmV0YTogOTE4LCBFdGE6IDkxOSwgVGhldGE6IDkyMCwgSW90YTogOTIxLCBLYXBwYTogOTIyLCBMYW1iZGE6IDkyMywgTXU6IDkyNCwgTnU6IDkyNSwgWGk6IDkyNiwgT21pY3JvbjogOTI3LCBQaTogOTI4LCBSaG86IDkyOSwgU2lnbWE6IDkzMSwgVGF1OiA5MzIsIFVwc2lsb246IDkzMywgUGhpOiA5MzQsIENoaTogOTM1LCBQc2k6IDkzNiwgT21lZ2E6IDkzNywgYWxwaGE6IDk0NSwgYmV0YTogOTQ2LCBnYW1tYTogOTQ3LCBkZWx0YTogOTQ4LCBlcHNpbG9uOiA5NDksIGVwc2l2OiA5NDksIHZhcmVwc2lsb246IDk0OSwgemV0YTogOTUwLCBldGE6IDk1MSwgdGhldGE6IDk1MiwgaW90YTogOTUzLCBrYXBwYTogOTU0LCBsYW1iZGE6IDk1NSwgbXU6IDk1NiwgbnU6IDk1NywgeGk6IDk1OCwgb21pY3JvbjogOTU5LCBwaTogOTYwLCByaG86IDk2MSwgc2lnbWFmOiA5NjIsIHNpZ21hdjogOTYyLCB2YXJzaWdtYTogOTYyLCBzaWdtYTogOTYzLCB0YXU6IDk2NCwgdXBzaWxvbjogOTY1LCBwaGk6IDk2NiwgY2hpOiA5NjcsIHBzaTogOTY4LCBvbWVnYTogOTY5LCB0aGV0YXY6IDk3NywgdmFydGhldGE6IDk3NywgdGhldGFzeW06IDk3NywgVXBzaTogOTc4LCB1cHNpaDogOTc4LCBzdHJhaWdodHBoaTogOTgxLCBwaXY6IDk4MiwgdmFycGk6IDk4MiwgR2FtbWFkOiA5ODgsIGdhbW1hZDogOTg5LCBkaWdhbW1hOiA5ODksIGthcHBhdjogMTAwOCwgdmFya2FwcGE6IDEwMDgsIHJob3Y6IDEwMDksIHZhcnJobzogMTAwOSwgZXBzaTogMTAxMywgc3RyYWlnaHRlcHNpbG9uOiAxMDEzLCBiZXBzaTogMTAxNCwgYmFja2Vwc2lsb246IDEwMTQsIGV1cm86IDgzNjQsIHRyYWRlOiA4NDgyLCBUUkFERTogODQ4MiwgZm9yYWxsOiA4NzA0LCBwYXJ0OiA4NzA2LCBsYXJyOiA4NTkyLCByYXJyOiA4NTkzLCBoeXBoZW46IDgyMDgsIGRhc2g6IDgyMDgsIG5kYXNoOiA4MjExLCBtZGFzaDogODIxMiwgaG9yYmFyOiA4MjEzLCBWZXJ0OiA4MjE0LCBWZXJiYXI6IDgyMTQsIGxzcXVvOiA4MjE2LCBPcGVuQ3VybHlRdW90ZTogODIxNiwgcnNxdW86IDgyMTcsIHJzcXVvcjogODIxNywgQ2xvc2VDdXJseVF1b3RlOiA4MjE3LCBsc3F1b3I6IDgyMTgsIHNicXVvOiA4MjE4LCBsZHF1bzogODIyMCwgT3BlbkN1cmx5RG91YmxlUXVvdGU6IDgyMjAsIHJkcXVvOiA4MjIxLCByZHF1b3I6IDgyMjEsIENsb3NlQ3VybHlEb3VibGVRdW90ZTogODIyMSwgbGRxdW9yOiA4MjIyLCBiZHF1bzogODIyMiwgZGFnZ2VyOiA4MjI0LCBEYWdnZXI6IDgyMjUsIGRkYWdnZXI6IDgyMjUsIGJ1bGw6IDgyMjYsIGJ1bGxldDogODIyNiwgbmxkcjogODIyOSwgaGVsbGlwOiA4MjMwLCBtbGRyOiA4MjMwLCBoeWJ1bGw6IDgyNTksIHRkb3Q6IDg0MTEsIFRyaXBsZURvdDogODQxMSwgRG90RG90OiA4NDEyLCBzdGFyOiA5NzM0LCBwaG9uZTogOTc0Miwgc3BhZGVzOiA5ODI0LCBjbHViczogOTgyNywgaGVhcnRzOiA5ODI5LCBkaWFtczogOTgzMCwgZmVtYWxlOiA5NzkyLCBtYWxlOiA5Nzk0LCBjaGVjazogMTAwMDMsIGNoZWNrbWFyazogMTAwMDMsIGNyb3NzOiAxMDAwNywgVmVydGljYWxTZXBhcmF0b3I6IDEwMDcyLCBFbXB0eVNtYWxsU3F1YXJlOiA5NzIzLCBGaWxsZWRTbWFsbFNxdWFyZTogOTcyNCwgc3RhcmY6IDk3MzMsIGJpZ3N0YXI6IDk3MzMsIHNxdWFyZTogOTYzMywgc3F1OiA5NjMzLCBTcXVhcmU6IDk2MzMgfTtcbiAgICB2YXIgYW1wQ29kZXMgPSBuZXcgTWFwKCk7XG4gICAgZm9yICh2YXIga2V5IGluIG9iakNvZGVzKSB7XG4gICAgICAgIGlmIChvYmpDb2Rlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBhbXBDb2Rlcy5zZXQoa2V5LCBvYmpDb2Rlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYW1wQ29kZXM7XG59XG5pZiAoZ2xvYmFsLl9fc25hcHNob3QpIHtcbiAgICBfYW1wQ29kZXMgPSBfZ2VuZXJhdGVBbXBNYXAoKTtcbn1cbmZ1bmN0aW9uIF9IYW5kbGVBbXBFbnRpdGllcyhmb3VuZCwgZGVjaW1hbFZhbHVlLCBoZXhWYWx1ZSwgd29yZFZhbHVlKSB7XG4gICAgaWYgKHdvcmRWYWx1ZSkge1xuICAgICAgICBpZiAoIV9hbXBDb2Rlcykge1xuICAgICAgICAgICAgX2FtcENvZGVzID0gX2dlbmVyYXRlQW1wTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlcyA9IF9hbXBDb2Rlcy5nZXQod29yZFZhbHVlKTtcbiAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ29kZVBvaW50KHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cbiAgICBpZiAoZGVjaW1hbFZhbHVlKSB7XG4gICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludChkZWNpbWFsVmFsdWUsIDEwKSk7XG4gICAgfVxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNvZGVQb2ludChwYXJzZUludChoZXhWYWx1ZSwgMTYpKTtcbn1cbnZhciBYbWxQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFhtbFBhcnNlcihvbkV2ZW50LCBvbkVycm9yLCBwcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmFtZXNwYWNlcyA9IHByb2Nlc3NOYW1lc3BhY2VzO1xuICAgICAgICB0aGlzLl9wYXJzZXIgPSBuZXcgZWFzeXNheC5FYXN5U0FYUGFyc2VyKCk7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwic3RhcnROb2RlXCIsIGZ1bmN0aW9uIChlbGVtLCBhdHRyLCB1cSwgdGFnZW5kLCBzdHIsIHBvcykge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBhdHRyKCk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNba2V5XSA9IFhtbFBhcnNlci5fZGVyZWZlcmVuY2VFbnRpdGllcyhhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lc3BhY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGVsZW07XG4gICAgICAgICAgICBpZiAodGhhdC5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2tFbnRyeSA9IFhtbFBhcnNlci5fZ2V0TmFtZXNwYWNlc1N0YWNrRW50cnkoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgdGhhdC5fbmFtZXNwYWNlU3RhY2sucHVzaChzdGFja0VudHJ5KTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWQgPSB0aGF0Ll9yZXNvbHZlTmFtZXNwYWNlKG5hbWUpO1xuICAgICAgICAgICAgICAgIHByZWZpeCA9IHJlc29sdmVkLnByZWZpeDtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2UgPSByZXNvbHZlZC5uYW1lc3BhY2U7XG4gICAgICAgICAgICAgICAgbmFtZSA9IHJlc29sdmVkLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50LCBwb3MoKSwgcHJlZml4LCBuYW1lc3BhY2UsIG5hbWUsIGF0dHJpYnV0ZXMsIHVuZGVmaW5lZCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwidGV4dE5vZGVcIiwgZnVuY3Rpb24gKHRleHQsIHVxLCBwb3MpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gdXEoWG1sUGFyc2VyLl9kZXJlZmVyZW5jZUVudGl0aWVzKHRleHQpKTtcbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5UZXh0LCBwb3MoKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJlbmROb2RlXCIsIGZ1bmN0aW9uIChlbGVtLCB1cSwgdGFnc3RhcnQsIHN0ciwgcG9zKSB7XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIG5hbWVzcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZWxlbTtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZCA9IHRoYXQuX3Jlc29sdmVOYW1lc3BhY2UobmFtZSk7XG4gICAgICAgICAgICAgICAgcHJlZml4ID0gcmVzb2x2ZWQucHJlZml4O1xuICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHJlc29sdmVkLm5hbWVzcGFjZTtcbiAgICAgICAgICAgICAgICBuYW1lID0gcmVzb2x2ZWQubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50LCBwb3MoKSwgcHJlZml4LCBuYW1lc3BhY2UsIG5hbWUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKSk7XG4gICAgICAgICAgICBpZiAodGhhdC5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICB0aGF0Ll9uYW1lc3BhY2VTdGFjay5wb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcImNkYXRhXCIsIGZ1bmN0aW9uIChkYXRhLCByZXMsIHBvcykge1xuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLkNEQVRBLCBwb3MoKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJjb21tZW50XCIsIGZ1bmN0aW9uICh0ZXh0LCB1cSwgcG9zKSB7XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuQ29tbWVudCwgcG9zKCksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGV4dCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhcnNlci5vbihcImVycm9yXCIsIGZ1bmN0aW9uIChtc2csIHBvcykge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKG1zZyksIHBvcygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShYbWxQYXJzZXIucHJvdG90eXBlLCBcImFuZ3VsYXJTeW50YXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXJzZXIuYW5ndWxhclN5bnRheDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhcnNlci5hbmd1bGFyU3ludGF4ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFhtbFBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoeG1sU3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLl9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgdGhpcy5fbmFtZXNwYWNlU3RhY2sgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYXJzZXIucGFyc2UoeG1sU3RyaW5nKTtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5fZ2V0TmFtZXNwYWNlc1N0YWNrRW50cnkgPSBmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgc3RhY2tFbnRyeSA9IHt9O1xuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGFja0VudHJ5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lO1xuICAgICAgICB2YXIgbmFtZXNwYWNlUHJlZml4O1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWUgPSBrZXk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlTmFtZS5pbmRleE9mKFwieG1sbnNcIikgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hbWVzcGFjZVByZWZpeCA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlTmFtZS5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2VQcmVmaXggPSBhdHRyaWJ1dGVOYW1lLnNwbGl0KFwiOlwiKVsxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YWNrRW50cnlbbmFtZXNwYWNlUHJlZml4XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhY2tFbnRyeTtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5wcm90b3R5cGUuX3Jlc29sdmVOYW1lc3BhY2UgPSBmdW5jdGlvbiAoZnVsbE5hbWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsgcHJlZml4OiB1bmRlZmluZWQsIG5hbWVzcGFjZTogdW5kZWZpbmVkLCBuYW1lOiB1bmRlZmluZWQgfTtcbiAgICAgICAgcmVzdWx0LnByZWZpeCA9IFwiXCI7XG4gICAgICAgIGlmIChmdWxsTmFtZS5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IGZ1bGxOYW1lLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgIHJlc3VsdC5wcmVmaXggPSBzcGxpdFswXTtcbiAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gc3BsaXRbMV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQubmFtZSA9IGZ1bGxOYW1lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGFja0VudHJ5O1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbmFtZXNwYWNlU3RhY2subGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHN0YWNrRW50cnkgPSB0aGlzLl9uYW1lc3BhY2VTdGFja1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdGFja0VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzdGFja0VudHJ5Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucHJlZml4ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWVzcGFjZSA9IHN0YWNrRW50cnlba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5fZGVyZWZlcmVuY2VFbnRpdGllcyA9IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHMgPSBTdHJpbmcocyk7XG4gICAgICAgIGlmIChzLmxlbmd0aCA+IDMgJiYgcy5pbmRleE9mKFwiJlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UoX2VudGl0eVNlYXJjaFJlZ0V4LCBfSGFuZGxlQW1wRW50aXRpZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzO1xuICAgIH07XG4gICAgcmV0dXJuIFhtbFBhcnNlcjtcbn0oKSk7XG5leHBvcnRzLlhtbFBhcnNlciA9IFhtbFBhcnNlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhtbC5qcy5tYXAiLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJ2YXIgZztcblxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcbmcgPSAoZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzO1xufSkoKTtcblxudHJ5IHtcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXG5cdGcgPSBnIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59IGNhdGNoIChlKSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKSBnID0gd2luZG93O1xufVxuXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGc7XG4iXSwic291cmNlUm9vdCI6IiJ9